# 基本原理

初见可以看看，其他随意


所谓SQL注入，就是通过把SQL命令插入到Web表单递交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令，比如先前的很多影视网站泄露VIP会员密码大多就是通过WEB表单递交查询字符暴出的，这类表单特别容易受到SQL注入式攻击．当应用程序使用输入内容来构造动态sql语句以访问数据库时，会发生sql注入攻击。如果代码使用存储过程，而这些存储过程作为包含未筛选的用户输入的字符串来传递，也会发生sql注入。


SQL注射能使攻击者绕过认证机制，完全控制远程服务器上的数据库。 SQL是结构化查询语言的简称，它是访问数据库的事实标准。目前，大多数Web应用都使用SQL数据库来存放应用程序的数据。几乎所有的Web应用在后台 都使用某种SQL数据库。跟大多数语言一样，SQL语法允许数据库命令和用户数据混杂在一起的。如果开发人员不细心的话，用户数据就有可能被解释成命令， 这样的话，远程用户就不仅能向Web应用输入数据，而且还可以在数据库上执行任意命令了。





SQL注入式攻击的主要形式有两种。一是直接将代码插入到与SQL命令串联在一起并使得其以执行的用户输入变量。由于其直接与SQL语句捆绑，故也被称为直接注入式攻击法。二是一种间接的攻击方法，它将恶意代码注入要在表中存储或者作为原书据存储的字符串。在存储的字符串中会连接到一个动态的SQL命令中，以执行一些恶意的SQL代码。注入过程的工作方式是提前终止文本字符串，然后追加一个新的命令。如以直接注入式攻击为例。就是在用户输入变量的时候，先用一个分号结束当前的语句。然后再插入一个恶意SQL语句即可。由于插入的命令可能在执行前追加其他字符串，因此攻击者常常用注释标记“—”来终止注入的字符串。执行时，系统会认为此后语句位注释








总的来说，就是用户输入了一个数据，服务器将他生硬的拼接成了一条SQL语句。然后放在服务器上面去执行并反馈给攻击者。如果查询语句可以被控制，相当于攻击者能够拿到后台数据库中的全部数据（通常也包含账号和密码），危害严重。

## 基本SQL注入

SQL注入的核心是闭合，通过传输数据修改，操纵服务器端的sql语句


挖掘时的总体思路


1：寻找到SQL注入的位置


2：判断服务器类型和后台数据库类型（mysql最多，不过sqlite最近也多了起来）


3：针对不同的服务器和数据库特点进行SQL注入攻击（会有些差别，但基本的还是要会的，变不离其宗）


进入举例


```plain
"select * from user_table where username=' username ' and password='  password '";

```



这条语句就是普通的查询语句，从数据库中取出username和password。


没有的话就出错，登录不了，非常简单


也就是说现在username和password的参数我们可以控制


然后我们输入语句


username=1' or 1=1--


稍微分析一下


--表示注释，会忽略掉后面的语句


整个sql注入语句就变成了


```plain
select * from user_table where username='1' or 1=1--[[[[[' and password='  password ']]]]]意思一下，表注释--其实也可以用#来替代

```



我们发现，前面的一个在原语句中的引号和我们输入的一个引号一起组成了username后面又多了了一个1=1，这是一定会成立的。然后整句话的逻辑，由于或（or）的出现，一定为真，好的，整条语句有可能就在代码里返回ture，然后身份认证通过。这就是相对简单的sql注入。


这里没有一点过滤，而且可以执行


如果我们输入1'; drop database()--或者其他爆出数据库的语句。


这样的攻击对于一个网站或者是服务器，杀伤力不言而喻。


而且sql注入并不是因为某些底层出现了漏洞，单纯是管理员的配置不当


R.I.P.



